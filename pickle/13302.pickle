(lp0
((dp1
S'text'
p2
(lp3
VSince you mention Resharper, I assume you're using Visual Studio - if so, there's a "Text-Transformation Templating Toolkit" (a
p4
aVk
p5
aVa "T4") built into VS 2008 and higher
p6
aVIt's somewhat similar to CodeSmith and others - much less powerful for more, though - but it's right in the box, free, and works wonders for easy tasks
p7
aVSee more info on it here and here
p8
as(dp9
S'author'
p10
V13302
p11
stp12
a((dp13
g2
(lp14
VWell, the whole setup seems a bit twisted :-) as others have already pointed out
p15
aVIf you really cannot change the requirements and the whole setup: why don't you explore components such as Aspose
p16
aVCells or Syncfusion XlsIO, native
p17
aVNET components, that allow you to read and interpret native Excel (XLS) files
p18
aVI'm pretty such with either of the two, you should be able to read your binary Excel into a MemoryStream and then feed that into one of those Excel-reading components, and off you go
p19
aVSo with a bit of
p20
aVNET development and SQL CLR, I guess this should be doable - not sure if it's the best way to do it, but it should work
p21
as(dp22
g10
V13302
p23
stp24
a((dp25
g2
(lp26
VIf going to SQL Server 2008 is an option for you, there's a new feature called "Table-valued parameters" to solve this exact problem
p27
aVCheck out more details on TVP here and here or just ask Google for "SQL Server 2008 table-valued parameters" - you'll find plenty of info and samples
p28
aVHighly recommended - if you can move to SQL Server 2008
p29
as(dp30
g10
V13302
p31
stp32
a((dp33
g2
(lp34
VYou really need to keep two separate issues apart:
p35
aV1) the primary key is a logical construct - one of the key candidates that uniquely and reliably identifies a row in your table
p36
aVThis can be anything, really - an INT, a GUID, a string - pick what makes most sense for your scenario
p37
aV2) the clustering key (the column or columns that define the "clustered index" on the table) - this is a physical storage-related thing, and here, a small, stable, ever-increasing data type is your best pick - INT or BIGINT as your default option
p38
aVBy default, the primary key on a SQL Server table is also used as the clustering key - but that doesn't need to be that way
p39
aVI've personally seems massive performance gains over time when breaking up the previous GUID-based Primary Clustered Key into two separate key - the primary (logical) key on the GUID, and the clustering (ordering) key on a separate INT IDENTITY(1,1) column
p40
aVThe index fragmentation was down to minimal levels, and thus the index seek performance was was up - highly recommended
p41
aVMarc
p42
as(dp43
g10
V13302
p44
stp45
a((dp46
g2
(lp47
VThis may fight your bill - SQL LOB Editor
p48
aVThe other option you might want to look at is EMS SQL Studio for SQL Server
p49
aVMarc
p50
as(dp51
g10
V13302
p52
stp53
a((dp54
g2
(lp55
VAre you aware of a freeware tool on Codeplex called TreeSurgeon
p56
aVIt does provide a way to "click'n'create" Visual Studio projects - I am uncertain as to how flexible it is in being adapted / tweaked to your particular needs, though
p57
aVCertainly worth a look, I'd say
p58
aVMarc
p59
as(dp60
g10
V13302
p61
stp62
a((dp63
g2
(lp64
VIf you work on
p65
aVNET 3
p66
aV5 or newer, you can use the  namespace and easily verify your credentials:
p67
aVIt's simple, it's reliable, it's 100% C# managed code on your end - what more can you ask for
p68
aV:-)
p69
aVRead all about it here:
p70
aVManaging Directory Security Principals in the
p71
aVNET Framework 3
p72
aV5
p73
aVMSDN docs on System
p74
aVDirectoryServices
p75
aVAccountManagement
p76
as(dp77
g10
V13302
p78
stp79
a((dp80
g2
(lp81
VIf you're right about only about 5% of your row actually having additional image/binary data, then I'd definitely say use the one table approach, combined with the hint Murthy gave - make sure not to do SELECT * on this table, but only request those columns that you really need - leave out the BLOB columns as often as possible
p82
aVIf your database grows, you might also want to check out a separate filegroup for the BLOB data to keep things separated and clean (but that's really only when you're dealing with hundreds of thousands of rows or more, and if you can split the filegroups onto several separate disks)
p83
aVKISS - Keep It Smart and Simple - whenever possible
p84
aV:-)
p85
aVMarc
p86
as(dp87
g10
V13302
p88
stp89
a((dp90
g2
(lp91
VI'm flattered to see my ADSISearch component mentioned here :-), but in order to simply validate user credentials, you're probably even better off using the "LogonUser" Win32 API
p92
aVI'm pretty sure (not doing any Delphi work anymore myself) that there's an implementation of that floating around somewhere - probably in the JVCL library or somewhere else
p93
as(dp94
g10
V13302
p95
stp96
a((dp97
g2
(lp98
VBasically, in SQL Server, a unique constraint is indeed realized by means of a unique index
p99
aVThe differences between a UNIQUE constraint and a UNIQUE INDEX are quite subtle, really
p100
aVIf you create a UNIQUE INDEX, you can reference that in a foreign key constraints from another table (doesn't work if you create a UNIQUE constraint
p101
aVSo what's the difference
p102
aVWell - a unique constraint really is more of a logical thing on a table - you want to express the intent that the contents of a given column (or group of columns) is unique
p103
aVA unique index (like most indices) is more of a "behind-the-scenes" implementation detail
p104
aVFrom my point of view, unless you really have a problem with it, I'd always use a UNIQUE INDEX - the benefit of being part of a referential integrity constraint is quite valid and can be very useful in certain cases
p105
aVFunctionally, in practice, there's no difference between using a Unique Constraint vs
p106
aVUnique Index, really
p107
as(dp108
g10
V13302
p109
stp110
a((dp111
g2
(lp112
Vkey fields have to be everithing in
p113
aVthe where clause
p114
aVNo, that would be overkill
p115
aVIndexing a field really only works if a) your WHERE clause is selective enough (that is: only selects out about 1-2% of the values; an index on a "Gender" field which can be only one of two or three possible values is pointless), and b) your WHERE clause doesn't involve function calls or other magic
p116
aVIn your case, TBL
p117
aVStatus might be a candidate - how many possible values are there
p118
aVYou select the '1' and '2' value - if there are hundreds of possible values, then it's a good choice
p119
aVOn a side note:
p120
aVthis clause here:   (TBL
p121
aVLogin IS NULL AND TBL
p122
aVLogin <> 'dev' )   is pretty pointless - if the value of TBL
p123
aVlogin IS NULL, then it's DEFINITELY not 'dev'
p124
aVso just the "IS NULL" will be more than sufficient
p125
aVThe other field you might want to consider putting an index on is the TBL
p126
aVDate, since you seem to select a range of dates here - that might be a good choice
p127
aVAlso, on a general note: whenever possible, DO NOT use a SELECT * FROM
p128
aVto select your fields
p129
aVThis causes a lot of overhead for SQL Server
p130
aVSPECIFY your columns - and ONLY select those that you REALLY NEED - not just all of them for the heck of it
p131
as(dp132
g10
V13302
p133
stp134
a((dp135
g2
(lp136
VIf you have the opportunity to define and control the whole database management and db creation process, have a serious look at DB Ghost - it's more than just a tool - it's a process
p137
aVIf you like it and can implement it, you'll get great returns on it - but it's a bit of a "all-or-nothing" kind of approach
p138
aVRecommended
p139
as(dp140
g10
V13302
p141
stp142
a((dp143
g2
(lp144
VWell, I guess, I would try to do something like this:
p145
aVbind to the top-level first (that's LDAP://
p146
aVcreate the first OU
p147
aVthen recursively
p148
aVbind to the container just created
p149
aVadd the next level down
p150
aVrepeat until you're done
p151
aVSomething like this (untested - I don't have a server here to check it out):
p152
aVThere's one catch I see: if you create a new OU, you might not be able to bind to it right away - sometimes it takes a moment to propagate into the directory
p153
aVDoes this help
p154
aVMarc
p155
as(dp156
g10
V13302
p157
stp158
a((dp159
g2
(lp160
VThe other answers are SQL Server specific, using sysobjects or sys
p161
aV* catalog views - you could also consult the ISO standard INFORMATION_SCHEMA views
p162
aVThese are supported across multiple database vendors, e
p163
aVg
p164
aVSQL Server, MySQL, PostgreSQL and more
p165
aVThe one you're most likely looking for is:
p166
aVwhich will list out unique, primary key and foreign key constraints - everything that gets turned into an index on SQL Server
p167
as(dp168
g10
V13302
p169
stp170
a((dp171
g2
(lp172
VI guess your problem is the fact that AD can store multiple values in a single field (quite contrary to the very first normalization rule in relational databases)
p173
aVNot sure what your query looks like - but could you possibly try to add a "[0]" indexer to the description attribute, by any chance
p174
aVMarc
p175
as(dp176
g10
V13302
p177
stp178
a((dp179
g2
(lp180
VYou can also e
p181
ag164
aVcall an external Webservice from a SQLCLR method - not exactly possible in T-SQL :-)
p182
aVMarc
p183
as(dp184
g10
V13302
p185
stp186
a((dp187
g2
(lp188
VBasically, to get a XSD validation going, you'll need to use a XmlReader with ReaderSettings that define what XSD file to validate against, and events to respond / catch validation errors
p189
aVTo read the XSD file, use something like this:
p190
aVand the event handler to catch any errors that might show up while reading the XSD (e
p191
ag164
aVif it in itself is invalid) would have this signature:
p192
aVThe error message is in e
p193
aVMessage
p194
aVOnce you have the XSD loaded in memory, instantiate your XmlReader and use the proper settings to enforce XSD validation:
p195
aVThis error event handler has the same signature as the one above
p196
aVThen actually read the file from beginning to end:
p197
aVIf any validation errors occured, your event handler was called, and you can capture the error messages in there and e
p198
ag164
aVdisplay them to the user (or just have a flag indicating whether validation was successful or not - your call :) )
p199
as(dp200
g10
V13302
p201
stp202
a((dp203
g2
(lp204
VWhat do table1 and table2 look like
p205
aVCan you paste a create script
p206
aVI would STRONGLY recommend to use the proper JOIN syntax:
p207
aVselect * from table1
p208
aVinner join table2 on table1
p209
aVuser_id = table2
p210
aVid
p211
aVwhat datatypes is "table1
p212
aVcontent"
p213
aVYou can most definitely have a lot more than just 2 AND statements in a SQL query - any database that really support any of the SQL-xx standards will support this
p214
as(dp215
g10
V13302
p216
stp217
a((dp218
g2
(lp219
VThere's a pretty good article and library on CodeProject by Yogesh Jagota:
p220
aVExcel XML Import-Export Library
p221
aVI've used it to export data from SQL queries and other data sources to Excel - works just fine for me
p222
aVCheers
p223
as(dp224
g10
V13302
p225
stp226
a((dp227
g2
(lp228
VWell, Excel (XLS) is very popular with a lot of management and project planning folks - hardcore developer will probably prefer the straight XML
p229
aVXLS is ok - but it's a bit messy to deal with and to create and read (before the Excel 2007 XLSX xml-based format)
p230
aVSo - if you're exchanging data and/or keeping track of data to display in a drop down list - use a proper database table, or if that's not possible, I'd recommend XML over Excel (XSL)
p231
as(dp232
g10
V13302
p233
stp234
a((dp235
g2
(lp236
VNo, I'm afraid not - SQL Server 2000 doesn't have any of the 2005 niceties like Common Table Expression (CTE) and such
p237
aVthe method described in the Google link seems to be one way to go
p238
aVMarc
p239
as(dp240
g10
V13302
p241
stp242
a((dp243
g2
(lp244
VLet's see - the button on your page probably has an event associated with it to respond to it being clicked, right
p245
aVCan't you just reload and re-assign the data to the dropdown in the button  event
p246
aVOr am I missing something
p247
as(dp248
g10
V13302
p249
stp250
a((dp251
g2
(lp252
VIf your data is mostly in XML, you could also look at a XSL-FO solution - we're using Alt-Soft's Xml2Pdf with great success
p253
aVThe "server" version is a bit of a misnomer - it's really just a single DLL you need to include in your Winforms, WPF or ASP
p254
aVNET app - that's all
p255
aVWorks like a charm (if you're familiar with XSLT and XSL-FO, or willing to learn it)
p256
aVMarc
p257
as(dp258
g10
V13302
p259
stp260
a((dp261
g2
(lp262
VThere are several ways you can do this - as JFV mentioned, you can ship a MDF/LDF database and re-attach it after installation
p263
aVOr you could wrap up your database creation scripts into a
p264
aVNET project and/or stand-alone EXE with something like Red-Gate's SQL Packager
p265
aVOr yet again, on SQL Server Express, you could simply add your MDF file to a directory and use the "attach local database file" mechanism in ADO
p266
aVNET to connect to your database file
p267
aVYour connection string would look something like:
p268
aVServer=
p269
aV\u005cSQLExpress;AttachDbFilename=c:\u005cmydbfile
p270
aVmdf;Database=dbname;Trusted_Connection=Yes;
p271
aVYour choice
p272
aV:-)
p273
as(dp274
g10
V13302
p275
stp276
a((dp277
g2
(lp278
VWell, if you know where your user lives in the AD hierarchy (e
p279
ag164
aVquite possibly in the "Users" container, if it's a small network), you could also bind to the user account directly, instead of searching for it
p280
aVAnd if you're on
p281
aVNET 3
p282
aV5 already, you could even use the vastly expanded System
p283
aVDirectorySrevices
p284
aVAccountManagement namespace with strongly typed classes for each of the most common AD objects:
p285
aVThere's loads of information out there on System
p286
aVDirectoryServices
p287
aVAccountManagement - check out this excellent article on MSDN by Joe Kaplan and Ethan Wilansky on the topic
p288
as(dp289
g10
V13302
p290
stp291
a((dp292
g2
(lp293
VThere's two set of enhancements I use a lot for Visual Studio (being a Delphi-convert myself):
p294
aVPowerCommands v1
p295
aV1 for VisualStudio 2008 adds lots of interesting and helpful bells'n'whistles, mostly to the Solution Explorer
p296
aVVisual Studio 2008 SourceCode Outliner PowerToy
p297
aVBoth are free, behave well, and are indispensable IMHO :-)
p298
as(dp299
g10
V13302
p300
stp301
a((dp302
g2
(lp303
VThe basic  is easier to deal with - just slap in a  entry and you're done
p304
aVThe downside is: there's no type-checking, e
p305
ag164
aVyou cannot safely assume your number that you wanted to configure there really is a number - someone could put a string into that setting
p306
aVyou just access it as  and then it's up to you to know what you're dealing with
p307
aVAlso, over time, the  can get rather convoluted and messy, if lots of parts of your app start putting stuff in there (remember the old windows
p308
aVini file
p309
aV:-))
p310
aVIf you can, I would prefer and recommend using your own configuration sections - with
p311
aVNET 2
p312
aV0, it's really become quite easy, That way, you can:
p313
aVa) Define your configuration settings in code and have them type-safe
p314
aVand checked
p315
aVb) You can cleanly separate YOUR settings from everyone
p316
aVelse's
p317
aVAnd you can reuse your config code, too
p318
aVThere's a series of really good articles on you to demystify the
p319
aVNET 2
p320
aV0 configuration system on CodeProject:
p321
aVUnraveling the mysteries of
p322
aVNET 2
p323
aV0 configuration
p324
aVDecoding the mysteries of
p325
aVNET 2
p326
aV0 configuration
p327
aVCracking the mysteries of
p328
aVNET 2
p329
aV0 configuration
p330
aVHighly recommended
p331
aVJon Rista did a great job explaining the configuration system in
p332
aVNET 2
p333
aV0
p334
as(dp335
g10
V13302
p336
stp337
a((dp338
g2
(lp339
VWhat's your database - SQL Server
p340
aVYou can achieve a lot of XML flexibility with the SELECT
p341
aVFOR XML statement in SQL Server (most definitely in 2005 and up)
p342
aVAnd if that's not flexible enough, then I'd second "peeles" recommendation - do a SELECT
p343
aVFOR XML first and transform the output using XSLT
p344
aVMarc
p345
as(dp346
g10
V13302
p347
stp348
a((dp349
g2
(lp350
VThere are quite a few really good tools - some require adoption of a database change management process (like DBGhost), while others are less restrictive, but require more work (and efforts) on your side, e
p351
ag164
aVRed-Gate's SQL Packager, which allows you to package your database creation and change scripts into
p352
aVNET projects and/or stand-alone EXE files
p353
as(dp354
g10
V13302
p355
stp356
a((dp357
g2
(lp358
VThere are lots of ways you can do this - either build up your own homegrown version somehow (e
p359
ag164
aVwe are currently packaging database change scripts into a DLL as embedded resources, and have an engine that'll run those on the client machine at install and/or update time), or you can look at readily available
p360
aVNET products like Red-Gate SQL Packager which can save you lots of time and effort
p361
as(dp362
g10
V13302
p363
stp364
a((dp365
g2
(lp366
VI really like the Apex SQL tools - it's always a bit of a toss-up whether I prefer the Red-Gate or the Apex tool for the same job :-)
p367
as(dp368
g10
V13302
p369
stp370
a((dp371
g2
(lp372
VYes- RootDSE is not a container - but it holds a number of interesting properties which you can query for - e
p373
ag164
aVthe name of your domain controller(s)
p374
aVYou can check these out by using code like this:
p375
aVOr save yourself the trouble and go grab my "Beavertail ADSI Browser" in C# source code - shows in detail how to connect to RootDSE and what it offers
p376
as(dp377
g10
V13302
p378
stp379
a((dp380
g2
(lp381
VAnother option you might want to look at is computed columns, especially if you have one or a few columns that you need frequently
p382
aVA computed column in general is just that - a column that has a value computed from something else, and that is up to date at any time without you having to refresh it all the time
p383
aVIn conjunction with XML, you can write a small stored function and use that to create a computed column on your "base" table, so that you can query and order by that column without having to "reach into" the XML all the time
p384
aVIn your case here, you could write a stored function to retrieve the "BusinessName" and make it available on your UserProfile table like this:
p385
aVThis defines a stored function that will take your profile XML and go look for the "property" with the "id" of "Business Name" and returns its "name" attribute back
p386
aVTo add this to your UserProfile table, use this SQL code:
p387
aVWith this, you add a new computed field called "BusinessName" to your table, and from now on, you can select and order by using this new field, e
p388
ag164
aVEnjoy
p389
aVPS: A word about performance: I have found in many cases, this is much faster than constantly keeping to query your XML in an XML field
p390
aVSo if you have certain elements in your XML that you need access to frequently, or that might show up in an ORDER BY statement, using a computed column can actually speed things up considerably
p391
as(dp392
g10
V13302
p393
stp394
a((dp395
g2
(lp396
VPros: as mentioned before - a familiar UI for admins
p397
aVUsing MMC snap-ins, an admin can stitch together custom admin "shells" with just the snap-ins (s)he needs
p398
aVThat's a BIG plus for an admin
p399
aVCons: less flexibility in terms of the UI, and a more "complicated" (e
p400
ag164
aVpre-defined) way of building your app
p401
aVIf you're really serious about targeting admins in a big way --> definitely go MMC (or possibly offer an MMC and a custom version - that way your users can pick the one they prefer)
p402
aVMarc
p403
as(dp404
g10
V13302
p405
stp406
a((dp407
g2
(lp408
VI've been longing to do the same - basically even one step further: put my WCF config in a database table (since I can change that - can't access the file system on my hosted provider to change config files :-()
p409
aVUnfortunately, this seems less than simple
p410
aVBasically, it boils down to having to write your own custom "ServiceHost" descendant which can handle the configuration as needed
p411
aVHere's an example of loading WCF configuration from a custom config location
p412
aVThis might get you going
p413
aVI'm still hoping I'll be able to figure out the "loading my config from a database table" some day
p414
aVjust need to quiet week at work, I guess :-)
p415
as(dp416
g10
V13302
p417
stp418
a((dp419
g2
(lp420
VYou will not be able to retrieve passwords from AD - by design and for security reasons
p421
aVYou can check your credentials (username and password the user has entered) against AD - but you cannot extract the passwords from AD - no can do
p422
aVTo check the credentials, you can use the "ValidateUser" method on the ActiveDirectoryMembershipProvider in
p423
aVNET - this will tell if you a username/password is valid
p424
as(dp425
g10
V13302
p426
stp427
a((dp428
g2
(lp429
VCheck out the excellent FileHelpers library - there an article on CodeProject about it, and it's hosted here
p430
aVIt's pure C#, and it can import just about any flat-file, CSV, and it deals with Excel, too
p431
aVThe import is totally configurable - you can define things like delimiters, rows and/or columns to skip, and so on - lots of options
p432
aVI've successfully used it in various projects and it just works flawlessly - highly recommended
p433
as(dp434
g10
V13302
p435
stp436
a((dp437
g2
(lp438
VIf you want to check for the Proxy settings in IE, you could also peek into the registry: check the  branch of the registry tree - lots of options and settings there
p439
aVMost notably:  (a DWORD, 0 = no proxy, 1 = proxy enabled)
p440
as(dp441
g10
V13302
p442
stp443
a((dp444
g2
(lp445
VAside from the clustering issue (which doesn't seem to be a problem if you set your indexes up properly),
p446
aVGUID as indexes will always be terribly cluttered - there's no "proper" setup to avoid that (unless you use the NEWSEQUENTIALGUID function in the SQL Server engine)
p447
aVThe biggest drawback IMHO is size - a GUID is 16 byte, an INT is 4
p448
aVThe PK is not only stored in the tree of the primary key, but also ON EVERY non-clustered index entry
p449
aVWith a few thousand entries, that might not make a big difference - but if you have a table with millions or billions of entries and several non-clustered indices, using a 16-byte GUID vs
p450
aVa 4-byte INT as PK might make a HUGE difference in space needed - on disk and in RAM
p451
aVMarc
p452
as(dp453
g10
V13302
p454
stp455
a((dp456
g2
(lp457
VWell yes - T4 is a template-based approach that can pull information from a variety of sources - typically from a database (table or system catalogs)
p458
aVT4 is built into VS 2008 - you can define a
p459
aVtt file inside VS2008 and have it generate its output inside VS
p460
aVXSLT has one requirement - input must be XML, and XSLT itself also is XML, so there's a number of challenges and possible drawbacks there
p461
aVXSLT is stand-alone - you can install and use any number of XSL engines
p462
aVAll in all: T4 to me is more of a "inside VS" code-generation tool (to quickly create C# or other files), while XSLT is more of a data-processing/data-transformation tool to turn data from XML into another format (typically HTML or PDF using XSL-FO)
p463
aVMarc
p464
as(dp465
g10
V13302
p466
stp467
a((dp468
g2
(lp469
VJeff,
p470
aVwe currently use a XML field in the Products table to handle all product-specific data
p471
aVSo our Products table has a few common fields that all products share, an XML which contains whatever a particular product needs additionally, and a few computed fields that grab into the XML and surface some of the frequently queried fields as "virtual" fields on the Products table (e
p472
ag164
aV"Style" would be set to whatever the current product defines, or NULL, if the product doesn't have a Style property)
p473
aVSo far, we've been quite flexible with that approach - if you create some decent XSD schemas for your XML, you can even create C# proxy classes for these fields
p474
aVWorks nicely for us - joining the best of both the relational and XML worlds
p475
aVMarc
p476
as(dp477
g10
V13302
p478
stp479
a((dp480
g2
(lp481
VI don't think the built-in VS2008 query designer is intended or designed for that task
p482
aVIt works well for designing and tweaking queries - but if you need to really extract the data, I would recommend going to the MS SQL Server Management Studio (if you're using SQL Server) or any other dedicated front-end for your database system
p483
as(dp484
g10
V13302
p485
stp486
a((dp487
g2
(lp488
VAs long as you can make sure to use proper XHTML, you could also use a product like Alt-Soft's Xml2PDF to convert XML (XHTML) into PDF by means of XSLT/XSL-FO
p489
aVIt takes a bit of a learning curve to master, but it works very well once you've "got" it
p490
aVMarc
p491
as(dp492
g10
V13302
p493
stp494
a((dp495
g2
(lp496
VWell, as far as I remember, a buddy of mine that this once with regular ASMX webservices, and it was quite a hack
p497
aVHow about just serializing the result you get back into XML
p498
aVThat might do the trick
p499
aVSomething along the lines of (totally untested and from memory):
p500
aVWould that work
p501
aVMarc
p502
as(dp503
g10
V13302
p504
stp505
a((dp506
g2
(lp507
VWCF seems like another
p508
aVoption, but I am not familiar with it
p509
aVand it seems far more complicated than
p510
aVthe functionality I need
p511
aVI would strongly urge you to take a really good look at WCF - yes, it might be a bit more daunting at first, but it gives you a lot of flexibility by means of configuration, rather than having to code to a particular transport medium (e
p512
ag164
aVweb service vs
p513
aVmessage queue)
p514
aVSince you're saying explicitly that the client will send requests to a queue on the server - why not just use a queue-based messaging system like MSMQ in the first place
p515
aVWith WCF on the server and client, you have the ability to quickly switch between using MSMQ vs
p516
aVusing a "regular" HTTP SOAP call vs
p517
aVusing e
p518
ag164
aVa REST call - all in the config
p519
aVThis kind of flexibility is worth investing a bit of time getting to learn it, IMHO
p520
as(dp521
g10
V13302
p522
stp523
a((dp524
g2
(lp525
VIf you want to learn quickly about how NHibernate works, go have a look at the excellent video series by Stephan Bohlen called Summer of NHibernate
p526
aVHe shows everything from the very simple NHibernate setup, all the way to using NHibernate in complex environments
p527
aVNHibernate keeps track of the objects it queried in a "session", and that's how it knows whether or not objects have been changed
p528
aVAdditionally, you will most likely define a primary key on your objects and define a value that signals to NHibernate that this is a new object that hasn't ever been saved to the database (e
p529
ag164
aVhaving a "0" in an ID field might signal --> this is a new object)
p530
aVAll this is shown and explained in great detail in the Summer of NHibernate series - worth watching
p531
aVMarc
p532
as(dp533
g10
V13302
p534
stp535
a((dp536
g2
(lp537
VNot 100% sure what you're really asking for :-), but assuming you're interested in knowing how to programatically execute a SQL query, you'll need (assuming SQL Server as the backend):
p538
aVa "using System
p539
aVData;" and "using System
p540
aVData
p541
aVSqlClient;" using clause
p542
aVa "SqlConnection" object to establish your connection to SQL Server (usually combined with a ConnectionString, stored in some form of a config file)
p543
aVa "SqlCommand" object to formulate your SQL query and execute it
p544
aVsome way of dealing with possible results from that query
p545
aVYou'll have something like:
p546
aVplus of course, some error handling
p547
aV:-)
p548
aVDoes that help that at all
p549
as(dp550
g10
V13302
p551
stp552
a((dp553
g2
(lp554
VAre you running a x64 OS on your box
p555
aVThere appear to be problems with BatchParser
p556
aVdll in 64-bit environments - usually it is recommended to download the SMO x64 Package (SQLServer2005_XMO_x64
p557
aVmsi) from Microsoft
p558
aVSee information about this here
p559
as(dp560
g10
V13302
p561
stp562
a((dp563
g2
(lp564
VIf you do use SQL Server 2008 (or could opt to use it), there's a new "MERGE" statement that basically does all that
p565
aVIn that case, you could write all your data into a temporary table (in memory or on disk), and then update and insert your data into the target table with a single MERGE statement
p566
aVHere are some info posts on SQL Server 2008's MERGE:
p567
aVSQL Server 2008 - The Power of Merge (requires free registration)
p568
aVSQL Server 2008 MERGE
p569
aVUsing SQL Server 2008's MERGE statement
p570
aVSQL Server 2008 Merge Statement
p571
aVSQL Server 2008 - Intro to MERGE
p572
as(dp573
g10
V13302
p574
stp575
a((dp576
g2
(lp577
VThere are a number of issues that come to mind:
p578
aVNULL handling - a lot of folks have trouble understanding that NULL is a very different beast than "0" (zero), and that you CANNOT usually compare IF myCol = NULL - you need to use "IS NULL" or "IS NOT NULL" and so forth
p579
aVNULL has its place - when it really means the absence of a choice or value - but in many cases, you're probably better off defining a default value (on an INT column often "0") that will represent "nothing" or "no choice has been made" etc
p580
aVIndexing - a lot of confusion around indexing and what the pros and cons, benefits and drawbacks are
p581
aVThere's no point in indexing every column - and even if you've identified a column to be used often in a SELECT
p582
aVWHERE clause, if the selectivity of the column is not sufficiently small (some experts say if a single value of a column doesn't select out 1% or less of your data, don't bother indexing), often it won't really help since a full-table scan (index scan) will be cheaper
p583
aVAnd also, with indexing - if you use T-SQL functions in your WHERE clauses, like "UPPER(myCol) = (value)" or "LEFT(myCol, 10) = (value)", then you will not see the intended benefit from an index, either
p584
aVIndexing can be a huge boost to your performance - but index wisely
p585
as(dp586
g10
V13302
p587
stp588
a((dp589
g2
(lp590
VYou should rewrite your query as:
p591
aVSHould be the same in terms of selection, just a bit faster and easier to understand, I think
p592
aVMarc
p593
as(dp594
g10
V13302
p595
stp596
a((dp597
g2
(lp598
VNo, as far as I know, you cannot do this - you'll have to first remove all computed columns referencing a function, alter the function, and then recreate the computed columns
p599
aVMaybe MS will give us a "CREATE OR ALTER FUNCTION" command in SQL Server 2010/2011
p600
aV:-)
p601
aVMarc
p602
as(dp603
g10
V13302
p604
stp605
a((dp606
g2
(lp607
VIf you search for an exact match, you can use both,  = and LIKE
p608
aVUsing "=" is a tiny bit faster in this case (searching for an exact match) - you can check this yourself by having the same query twice in SQL Server Management Studio, once using "=", once using "LIKE", and then using the "Query" / "Include actual execution plan"
p609
aVExecute the two queries and you should see your results twice, plus the two actual execution plans
p610
aVIn my case, they were split 50% vs
p611
aV50%, but the "=" execution plan has a smaller "estimated subtree cost" (displayed when you hover over the left-most "SELECT" box) - but again, it's really not a huge difference
p612
aVBut when you start searching with wildcards in your LIKE expression, search performance will dimish
p613
aVSearch "LIKE Mill%" can still be quite fast - SQL Server can use an index on that column, if there is one
p614
aVSearching "LIKE %expression%" is horribly slow, since the only way SQL Server can satisfy this search is by doing a full table scan
p615
aVSo be careful with your LIKE's
p616
aVMarc
p617
as(dp618
g10
V13302
p619
stp620
a((dp621
g2
(lp622
VAre you looking at doing this in code, or using a template-driven generator
p623
aVSeveral choices:
p624
aVinside Visual Studio, you could use a T4 template to achieve this
p625
aVyou could use a code generator such as CodeSmith, MyGeneration or others
p626
aVyou could write your own little program to do this (in C#, VB - anything)
p627
aVWhich of these are you really looking for
p628
aVMarc
p629
as(dp630
g10
V13302
p631
stp632
a((dp633
g2
(lp634
VThere's at least ONE good reason for having multiple (at least two) file groups in SQL Server 2008 : if you want to use the FILESTREAM feature, you have to have a dedicated and custom filegroup for your FILESTREAM data :-)
p635
aVMarc
p636
as(dp637
g10
V13302
p638
stp639
a((dp640
g2
(lp641
VIn your shoes, I'd probably just create the database and try to fill it with a representative sample of data and then check what the table sizes look like
p642
aVThis SQL script does it over all tables - you don't have to call sp_spaceused on each and every single table:
p643
as(dp644
g10
V13302
p645
stp646
a((dp647
g2
(lp648
VAs for your second question in the "EDIT" section:
p649
aVIf I'm not mistaken, the classes generated by EF are not sealed, and they are PARTIAL classes, so you could easily extend those without touching the generated files themselves
p650
aVThe generated class will be:
p651
aVso you can easily create your own "PlanetAddons
p652
aVcs" (or whatever you want to call it) to extend this class:
p653
aVPretty neat, eh
p654
aVNo need to derive and create artificial object hierarchies
p655
aVMarc
p656
as(dp657
g10
V13302
p658
stp659
a((dp660
g2
(lp661
VYou can always inspect the INFORMATION_SCHEMA views to find all the interesting information about tables and their columns
p662
aVIt's not called "describe" per se - but this query will show you lots of information:
p663
aVMarc
p664
as(dp665
g10
V13302
p666
stp667
a((dp668
g2
(lp669
VYou could check your DMV's (Dynamic Management Views)
p670
aVIf your tables all have a primary key, there's a primary key index, and if that index is never being read, your table is not being used at all
p671
aVBut mind you: these are dynamic management views - they get reset to 0 each time SQL Server starts up
p672
aVYou might want to look into either the SQL Server 2008 Performance DAta Collector or the SQL DMV Stats project for SQL Server 2005 to capture DMV data over an extended period of time before dropping a table :-)
p673
aVMarc
p674
as(dp675
g10
V13302
p676
stp677
a((dp678
g2
(lp679
VDoes it need to be persisted between sessions
p680
aVThen you could check out the ASP
p681
aVNET User Profile services - works very nicely, highly configurable
p682
aVSee these articles on it:
p683
aVPersonalization and User Profiles in ASP
p684
aVNET 2
p685
ag334
aVProfiles In ASP
p686
aVNET 2
p687
ag334
aVASP
p688
aVNET 2
p689
aV0 Quickstart Tutorials
p690
aVMarc
p691
as(dp692
g10
V13302
p693
stp694
a((dp695
g2
(lp696
VAs far as I know, there's nothing "out of the box" to allow you to do this
p697
aVOn the other hand - you could always expose those strings you might wish to override in your class library as public properties, and initialize them inside your class library to your default strings from the resources, but since they're public properties, the calling web app could always override them and set new values
p698
aVMarc
p699
as(dp700
g10
V13302
p701
stp702
a((dp703
g2
(lp704
VAs long as you can make sure to use proper XHTML, you could also use a product like Alt-Soft's Xml2PDF to convert XML (XHTML) into PDF by means of XSLT/XSL-FO
p705
aVIt takes a bit of a learning curve to master, but it works very well once you've "got" it
p706
aVMarc
p707
as(dp708
g10
V13302
p709
stp710
a((dp711
g2
(lp712
VIf you have the "UserTbl" and "RolesTbl" in your database, you should also have two classes called "UserTbl" and "RolesTbl" in your LINQ-to-SQL model
p713
aVTo store a role in the database, instantiate one of thouse "RolesTbl" objects, set it's properties, and then add it to the LINQ data context
p714
aVSame with the "UserTbl" object
p715
aVEDIT: here's the code sample requested - assuming you have set up your database, your LINQ-to-SQL model and used all the default names:
p716
aVDoes that help at all
p717
aVMarc
p718
as(dp719
g10
V13302
p720
stp721
a((dp722
g2
(lp723
VWell, there's a lot of options - so it really depends on what your most pressing needs are :-)
p724
aVOne approach might be to create SQL statements as text files inside your VS solution, and mark them as "embedded resource" in the "build action"
p725
aVThat way, the SQL is included in your resulting assembly, and can be retrieved from it at runtime using the ResourceManifestStream of the
p726
aVNET framework:
p727
aVYou need to replace "ConsoleApplication1" with your actual namespace, in which the sql statement files reside
p728
aVYou need to reference them by means of the fully qualified name
p729
aVThen you can load your SQL statement with this line:
p730
aVThis however makes the queries rather "static", e
p731
ag164
aVyou cannot configure and change them at runtime - they're baked right into the compiled binary bits
p732
aVBut on the other hand, in VS, you have a nice clean separation between your C# program code, and the SQL statements
p733
aVIf you need to be able to possibly tweak and change them at runtime, I'd put them into a single SQL table which contains e
p734
ag164
aVa keyword and the actual SQL query as fields
p735
aVYou can then retrieve them as needed, and execute them
p736
aVSince they're in the database table, you can also change, fix, amend them at will - even at runtime - without having to re-deploy your whole app
p737
aVMarc
p738
as(dp739
g10
V13302
p740
stp741
a((dp742
g2
(lp743
VSomething like:
p744
aVMarc
p745
as(dp746
g10
V13302
p747
stp748
a((dp749
g2
(lp750
VI second Craig's suggestion - option 4
p751
aVYou can always use the GUID column, populated by the middle-tier, as your PRIMARY KEY (that's a LOGICAL construct)
p752
aVTo avoid massive index (thus: table) fragmentation, use some other key (ideally an INT IDENTITY column) as the CLUSTERING KEY - that's a physical database construct, which CAN be separated from the primary key
p753
aVBy default, the primary key is the clustering key - but that doesn't have to be that way
p754
aVIn fact, I improved performance and drastically lowered fragmentation by doing just that on a database I "inherited" - add a INT IDENTITY column and put the clustering key on that small, ever-increasing, never-changing INT - works like a charm
p755
aVMarc
p756
as(dp757
g10
V13302
p758
stp759
a((dp760
g2
(lp761
VWhenever dealing with dates and SQL Server (which I assume you are here, too), I would recommend using the ISO-8601 format - it should work regardless of your language, culture or other settings
p762
aVISO-8601 defines the date format to be:    YYYY-MM-DD (with or without the dashes; YYYYMMDD is also acceptable)
p763
aVDoes this work
p764
aVfor a date of March 6, 2009
p765
aVAlso see:  http://www
p766
aVw3
p767
aVorg/TR/NOTE-datetime
p768
aVand: http://www
p769
aVcl
p770
aVcam
p771
aVac
p772
aVuk/~mgk25/iso-time
p773
aVhtml
p774
as(dp775
g10
V13302
p776
stp777
a((dp778
g2
(lp779
VWhy don't you just query the database using standard SQL for the contents of the XML column, and grab that in a page and stream that string back to the user
p780
aVSomething like:
p781
aVand then just stream back the XML to the user, e
p782
ag164
aVusing Response
p783
aVWrite(xmlContents) - something roughly along those lines (no error handling included - I'll leave that up to you to handle :-) )
p784
aVDoes that help any
p785
aVMarc
p786
as(dp787
g10
V13302
p788
stp789
a((dp790
g2
(lp791
VEric White just posted a blog article to do exactly that - convert XElement to XmlNode and back
p792
aVCheck it out here
p793
aVMarc
p794
as(dp795
g10
V13302
p796
stp797
a((dp798
g2
(lp799
VWell, in SQL Server 2008, there's a new datatype called "DATE" - you could use that column and create an index on that
p800
aVYou could of course also add a computed column of type "DATE" to your table and just fill the date portion of the DATETIME column into that computed column, make it PERSISTED, and index it
p801
aVShould work just fine
p802
aVSomething like that:
p803
aVMarc
p804
as(dp805
g10
V13302
p806
stp807
a((dp808
g2
(lp809
VI would investigate the "NetNamedPipes" transport protocol in WCF which is specifically designed for same-machine, inter-process communication and which has the least overhead possible (including fast binary serialization)
p810
aVMarc
p811
as(dp812
g10
V13302
p813
stp814
a((dp815
g2
(lp816
VCheck out this site listing all the MSI-predefined directories - I would think you should find the one you're looking for in there somewhere :-)
p817
aVThis one here possibly
p818
aVFull path to the directory that serves as a data repository for local (non-roaming) applications
p819
as(dp820
g10
V13302
p821
stp822
a((dp823
g2
(lp824
VUnfortunately, these bits of information such as output path are all stored inside the individual *
p825
aVcsproj files
p826
aVIf you want to batch-update a whole bunch of those, you'll have to revert to some kind of a text-updating tool or create a script to touch each of those files
p827
aVFor things like this (apply changes to a bunch of text files at once) I personally use WildEdit by Helios Software - works like a charm and it's reasonably priced
p828
aVBut I'm sure there are tons of free alternatives out there, too
p829
as(dp830
g10
V13302
p831
stp832
a((dp833
g2
(lp834
VI am not aware of any tools out there at this time that do this reliably, unfortunately
p835
aVThere was an XSDObjectGen (or something like that) but that tool seems to have vanished from the face of the cyberspace :-(
p836
aVI saw one approach use XSDTidy to apply a sort of a replacement of all int[] into List over the output of the XSD tool - seems to have worked, but seemed a bit clunky
p837
aVHere's a CodeProject article on XSDTidy
p838
aVThe thing I've been trying to find again is a blog post by a gentleman who basically dissected the inner workings of XSD in Reflector, and then used the knowledge he gained on that to build his own tool, using a lot of
p839
aVNET core classes
p840
aVIf I remember correctly, it was this blog post here ("writing your own xsd
p841
aVexe")
p842
aVMike isn't exactly doing what you're looking for (creating List instead of arrays), but it could be a starting point
p843
aVMarc
p844
as(dp845
g10
V13302
p846
stp847
a((dp848
g2
(lp849
VSure, there are tasks in MS Build that can do all you need to build an MSI from WiX
p850
aVCan you integrate this on a build / integration server
p851
aVNewer builds of Wix actually include a file called "wix
p852
aVtargets", which should get you started
p853
aVAlso check out these fine articles on the topic:
p854
aVBuilding with Wix
p855
aVTargets (by Heath Stewart)
p856
aVWix Target for MSBuild (by Willem Meints)
p857
aVAutomate Releases With MSBuild And Windows Installer XML (by Sayed Ibrahim Hashimi)
p858
aVThey cover the topic in much more detail and are extremely helpful to get started
p859
as(dp860
g10
V13302
p861
stp862
a((dp863
g2
(lp864
VIt depends on your version of SQL server - in 2000, you're probably out of luck
p865
aV"Image" really is just a binary blob - no string functions or anything will work on it
p866
aVIn SQL Server 2005, you could possibly convert this (either in the database schema or on the fly, with a CAST) to VARCHAR(MAX) - a text type up to 2 GB, which can deal with the normal string functions, and can be searched using WHERE CAST(blob AS VARCHAR(MAX)) LIKE '
p867
aVIt won't be exactly lightning swift - but it might work
p868
aVI would prefer changing the datatype of that column to VARCHAR(Max), though - all just text, up to 2 GB supported - should be good enough for a few HTML documents
p869
aVMarc
p870
as(dp871
g10
V13302
p872
stp873
a((dp874
g2
(lp875
VI don't quite understand your question - can you clarify a bit
p876
aVYou're logged in with a Windows account - so does that Windows account (or a Windows group it belongs to) have a "login" in SQL Server
p877
aVHow do you try to login with the new "testuser"
p878
aVHow are you trying to connect
p879
aVFrom an ADO
p880
aVNET application
p881
aVSQL Server Management studio
p882
aVError 18456 can mean "login failed" - does your "testuser" have a SQL login
p883
aVAnd is that login allowed to use the database you're trying to use
p884
aVPlease give us a bit more information to go on - thanks
p885
aVMarc
p886
as(dp887
g10
V13302
p888
stp889
a((dp890
g2
(lp891
VWell, there are lots of comparisons out there on DataContractSerializer vs
p892
aVXmlSerializer
p893
aVI guess the main points in my opinion are:
p894
aVDataContract is "opt-in" - you need to explicitly add a [DataMember] attribute to any field or property (public, private, internal or whatever) to serialize - if you don't have, it won't be in there
p895
aVThe XmlSerializer will just serialize all public properties
p896
aVDataContract allows you to specify a specific order of the data elements - XmlSerializer is just using the order in which they appear in your source code
p897
aVXmlSerializer requires a public, parameter-less constructor for your class
p898
aVIn simple examples, these advantages of the DataContractSerializer might not seem like much, really - but it can be a distinct advantage in larger scale apps if your data object do not have to have a public parameter-less constructor, and that you do not have to "artificially" surface elements as public properties just to include them in serialization
p899
aVMarc
p900
as(dp901
g10
V13302
p902
stp903
a((dp904
g2
(lp905
VCouldn't you just add the '' / '' as fixed texts in your select
p906
aVSomething like:
p907
aVMarc
p908
as(dp909
g10
V13302
p910
stp911
a((dp912
g2
(lp913
VNo, as far as I know, there's no feature in SQL Server that enables automatic table index creation
p914
aVI wouldn't think it to be a good idea, either, because getting the right indexes in place will depend on a multitude of factors, hardly any of which can be really truly automated
p915
aVSure - you can place a primary key on any column called "ID" - until you run into a case where you need a primary key on something else
p916
aVSure, it makes sense to index foreign key columns in the child table - but sometimes, the added overhead for INSERTs can more than offset the gains of having the index
p917
aVGetting the right indices in place is just way too dependant on your actual usage and a lot of dynamic, usage parameters (and design decisions on your part, too) so I'd be surprised if any solution would really work all that well
p918
aVMarc
p919
as(dp920
g10
V13302
p921
stp922
a((dp923
g2
(lp924
VI don't know of any way to edit the files "in place" once they're compiled - but why not just make your changes, precompile the web again, and then just deploying the App_GlobalResources
p925
aVcompiled and App_GlobalResources
p926
aVdll separately to your website
p927
aVThat should update the global resource DLL and should achieve what you're looking for, I think
p928
aVMarc
p929
as(dp930
g10
V13302
p931
stp932
a((dp933
g2
(lp934
VNo, not LINQ per se
p935
aVThe "Language Integrated Query" is here to stay
p936
aVThere's some talk about MS giving up on "Linq-to-SQL" (the SQLServer-only database version of LINQ) in favour of the ADO
p937
aVNET Entity Framework, but even that's still a bit unclear
p938
aVSee this post in the MS ADO
p939
aVNET team blog and these comments here by Oren Eini and David Hayden
p940
aVAnd while I think Linq-To-Sql probably won't receive big updates anymore, I highly doubt it'll be physically removed from the product, so there's always opportunity for third-party developers to step in and make it great nonetheless
p941
as(dp942
g10
V13302
p943
stp944
a((dp945
g2
(lp946
VSomething like this:
p947
aVMarc
p948
as(dp949
g10
V13302
p950
stp951
a((dp952
g2
(lp953
VI've done it several times on SQL Server 2005 and 2008 - without any problems as far as I can tell
p954
aVSo based on my experience, I wouldn't expect any troubles as long as you don't have any old things like extended stored procs that might be dependant on 32- vs
p955
aV64-bits
p956
aVThe database parts should be just fine
p957
aVMarc
p958
aVFollow-up: referring to the other answer - I didn't have either SQL Mail nor large amounts of DTS packages to upgrade, so I cannot comment on those
p959
as(dp960
g10
V13302
p961
stp962
a((dp963
g2
(lp964
VWhat version of the
p965
aVNET framework are you working against
p966
aVThe AD stuff has been revamped quite extensively in
p967
aVNET 3
p968
aV5, and offers strongly typed constructs for User and groups and stuff like that now
p969
aVCheck out the excellent article "Managing Directory Security Principals in the
p970
aVNET Framework 3
p971
aV5" by my buddies Joe Kaplan and Ethan Wilansky on MSDN
p972
aVExcellent stuff indeed
p973
aVFirst of all, you get a class called UserPrincipal which is strongly typed, e
p974
ag164
aVall the basic properties are properties on your object
p975
aVVery helpful indeed
p976
aVSecondly, you get a nice "query-by-example" method using PrincipalSearcher - check out this sample from Joe and Ethan's article:
p977
aVIf there's any chance at all, try to get to
p978
aVNET 3
p979
aV5 for your AD stuff
p980
aVMarc
p981
as(dp982
g10
V13302
p983
stp984
a((dp985
g2
(lp986
VYou cannot determine the width of a column to be displayed on screen just from the Sql Data Reader - after all, the width of the column is heavily dependant on what screen font you're using, what size, bold or not and so forth
p987
aVWhat you need to do is render the text into your UI where you want to display it - there, on the UI side of things, you can measure the space needed to display a given text using a given font, size, and font characteristics
p988
aVMarc
p989
as(dp990
g10
V13302
p991
stp992
a((dp993
g2
(lp994
VIf you catch a SqlException, you should be able to enumerate the "Errors" collection holding a number of "SqlError" objects
p995
aVThe SqlError has among other things properties like "Class" and "Number" - unique key violations are class = 14 and number = 2601
p996
aVCheck for those numbers to find your error precisely
p997
aVThose are the same error codes you get when you try to execute the query in SQL Management Studio:
p998
aVMsg 2601, Level 14, State 1, Line 1
p999
aVCannot insert duplicate key row in
p1000
aVobject
p1001
aVThe statement has been terminated
p1002
aVThe "Msg" translates to the "Number" property on SqlError, the "Level" to "Class"
p1003
aVThat way, you can easily and EXACTLY identify a "unique constraint violated" error
p1004
aVMarc
p1005
as(dp1006
g10
V13302
p1007
stp1008
a((dp1009
g2
(lp1010
VCan you publish the table schema and the index definitions
p1011
aVWhat do you queries look like
p1012
aVThe amount of Reads would hint at massive I/O operations - so maybe due to your table and index setups and/or the way you query, even though you have indices, they're not being used
p1013
aVDo you regularly run maintenance plans on the database
p1014
aVE
p1015
ag164
aVdo your indices get reorganized and/or rebuilt when index fragmentation gets too high
p1016
aVYou could always use SQL's Database Tuning Advisor to try and get hints about how to optimize certain queries - or better yet, collect some real-life usage data using a SQL Trace and analyze that for potential tuning steps
p1017
aVMarc
p1018
as(dp1019
g10
V13302
p1020
stp1021
a((dp1022
g2
(lp1023
VYes, one single file seems like a bad choice in a moderately-sized app or bigger :-)
p1024
aVWe basically use this approach:
p1025
aVeach webform has its own local resources for buttons, labels and so forth
p1026
aVthere are a number of global resources, organized by topic - e
p1027
ag164
aVa "general" resource for things like "yes", "no", and so forth; one for error messages that keep popping up all over the place, and so forth - a few global resources based on area of use
p1028
aVany other code (more business code rather than ASPX/ASCX code behind) has their own resource files
p1029
aVIt's always a balancing act between having hoodles of files vs
p1030
aVhaving files with way too many entries, though :-)
p1031
aVMarc
p1032
as(dp1033
g10
V13302
p1034
stp1035
a((dp1036
g2
(lp1037
VI would say quite the contrary - it's extremely helpful to remove unneeded, unnecessary using statements
p1038
aVImagine you have to go back to your code in 3, 6, 9 months - or someone else has to take over your code and maintain it
p1039
aVIf you have a huge long laundry list of using statement that aren't really needed, looking at the code could be quite confusing
p1040
aVWhy is that using in there, if nothing is used from that namespace
p1041
aVI guess in terms of long-term maintainability in a professional environment, I'd strongly suggest to keep your code as clean as possible - and that includes dumping unnecessary stuff from it
p1042
aVLess clutter equals less confusion and thus higher maintainability
p1043
aVMarc
p1044
as(dp1045
g10
V13302
p1046
stp1047
a((dp1048
g2
(lp1049
VI don't think you'll be able to achieve this with T-SQL, unfortunately
p1050
aVThe closest you could get is this:
p1051
aVif you adapt your query to be:
p1052
aVSorry I can't be of more help here - guess that's a feature Microsoft hasn't really considered (so far)
p1053
aV:-)
p1054
aVMarc
p1055
as(dp1056
g10
V13302
p1057
stp1058
a((dp1059
g2
(lp1060
VWell, by default, a new user will also be member of the "public" server and database role
p1061
aVThe objects in the sys
p1062
aVand INFORMATION_SCHEMA schemas are visible to members of the public role
p1063
aVYou can either explicitly deny your own role access to those schemas, or you could remove the public role from your login user
p1064
aVMarc
p1065
as(dp1066
g10
V13302
p1067
stp1068
a((dp1069
g2
(lp1070
VNo, I wouldn't expect that - adding new functionality / new service methods that does NOT alter any of the existing methods / function calls will not affect "old" clients
p1071
aVOf course, they won't know about the new methods until their proxies have been recreated from metadata, or adapted manually
p1072
aVBut existing calls should be unaffected, as long as their signature (the data they exchange) stays the same
p1073
aVMarc
p1074
as(dp1075
g10
V13302
p1076
stp1077
a((dp1078
g2
(lp1079
VWell, NULL is always a bit of an oddball in databases
p1080
aVI don't think it has too much of a performance impact in your case - but of course, you'll have to deal with all the NULL values separately
p1081
aVWhenever possible, I strive to use a default value instead, so if you have e
p1082
ag164
aVsome ID value of type INT, you could use 0 or -1 as a "no value present" indicator
p1083
aVThat way, you can avoid having to do checks for value (field < 0) and check for NULL separately (field IS NULL or IS NOT NULL)
p1084
aVMarc
p1085
as(dp1086
g10
V13302
p1087
stp1088
a((dp1089
g2
(lp1090
VAs for the number of logins on SQL Server 2005 / 08 - I don't think anyone has ever run into a hard limit here
p1091
aVA few thousand will NOT be any problem at all
p1092
aVWhat you could consider for this scenario might be one schema inside your single DB per customer, e
p1093
ag164
aVcustomer "Miller" has a "miller" schema, with its objects inside, and customer "Brown" will have a "brown" schema
p1094
aVAnd contrary to what HLGEM just responded - no, customers won't see each others data, if you specify proper permissions - each customer (and its users) into its own schema only - should work just fine
p1095
aVMarc
p1096
as(dp1097
g10
V13302
p1098
stp1099
a((dp1100
g2
(lp1101
VNot sure, but you could also have a look at the Apex SQL tools - Apex SQL Diff and Apex SQL DataDiff
p1102
aVThere website is here
p1103
aVThey don't specifically mention SQL Server Compact - but I'm sure you could inquire with them
p1104
aVRed-Gate and Apex are my #1 choices for any kind of SQL tools :-)
p1105
aVMarc
p1106
as(dp1107
g10
V13302
p1108
stp1109
a((dp1110
g2
(lp1111
VPerhaps like this:
p1112
aVMarc
p1113
as(dp1114
g10
V13302
p1115
stp1116
a((dp1117
g2
(lp1118
VI am not sure if you can do it in the ADO
p1119
aVNET environment directly, somehow - but you could always query the "sys" system views to get that information:
p1120
aVMarc
p1121
as(dp1122
g10
V13302
p1123
stp1124
a((dp1125
g2
(lp1126
VThere's also the preferred "sys
p1127
aVtriggers" catalog view:
p1128
aVor call the sp_Helptrigger stored proc:
p1129
aVBut other than that, I guess that's about it :-)
p1130
aVMarc
p1131
aVUpdate (for Jakub Januszkiewicz):
p1132
aVIf you need to include the schema information, you could also do something like this:
p1133
as(dp1134
g10
V13302
p1135
stp1136
a((dp1137
g2
(lp1138
VDo your simple schema changes possibly mean that you're reordering the columns of a table
p1139
aVIn that case, what SQL Management Studio does behind the scenes is create a new table, move all the data from the old table to the newly created table, and then drop the old table
p1140
aVThus, if you reorder columns on a table with lots of data, lots of indices or both, you CAN incur a massive amount of "reorganization" work without really realizing it
p1141
aVMarc
p1142
as(dp1143
g10
V13302
p1144
stp1145
a((dp1146
g2
(lp1147
VAlan already gave you the right answer - use the  to filter your user
p1148
aVI would add a recommendation on your use of  - if you only want one or two pieces of information, add them into the  collection of the
p1149
aVInstead of retrieving the whole big user object and then picking out one or two items, this will just return exactly those bits you need
p1150
aVSample:
p1151
aVThose are just the usual AD/LDAP property names you need to specify
p1152
as(dp1153
g10
V13302
p1154
stp1155
a((dp1156
g2
(lp1157
VYou might want to check out Umbraco - completely written in C#/
p1158
aVNET, with a very powerful programming API (using lots of XSLT for transformations)
p1159
aVThey offer both a free community edition as well as commercial versions
p1160
aVMarc
p1161
as(dp1162
g10
V13302
p1163
stp1164
a((dp1165
g2
(lp1166
VI don't think you can do that using the DataContractSerializer
p1167
aVMarc
p1168
as(dp1169
g10
V13302
p1170
stp1171
a((dp1172
g2
(lp1173
VMaybe you could create your "ExtendedWindowsPrincipal" as a derived class based on WindowsPrincipal, and just add your extra data to the derived class
p1174
aVThat way, your ExtendedWindowsPrincipal would still be recognized anywhere where a WindowsPricinpal is needed
p1175
aVOR: since you're talking about using Windows Authentication, you're probably in a Windows network - is there an Active Directory or a user database somewhere, where you could look up your e-mail address that you're interested in instead of storing it in the principal
p1176
aVMarc
p1177
as(dp1178
g10
V13302
p1179
stp1180
a((dp1181
g2
(lp1182
VSince you don't specify what SQL backend you're going against, this will be hard to properly answer
p1183
aVAs far as I can tell, you will not be able to do this neither against MS SQL Server, nor against Interbase/Firebird
p1184
aVI can't speak for other backend servers, though
p1185
aVMarc
p1186
as(dp1187
g10
V13302
p1188
stp1189
a((dp1190
g2
(lp1191
VI think this is one of the rather useful new features in SQL Server 2008 - SQL Server Audit
p1192
aVBut as it's a new feature in SQL Server 2008 - it's not in SQL Server 2005 :-(
p1193
aVMarc
p1194
as(dp1195
g10
V13302
p1196
stp1197
a((dp1198
g2
(lp1199
VAn eternal question that keeps popping up
p1200
aVI guess just about any serious ASP
p1201
aVNET developer has banged his head against this in some ways
p1202
aVFor ASP
p1203
aVNET 4
p1204
aV0, there's some help on its way - the improved web deployment options will offer a feature called "web
p1205
aVconfig transformations"
p1206
aVCheck out this Channel 9 video on the topic - haven't found any decent written reference just yet
p1207
aVMarc
p1208
as(dp1209
g10
V13302
p1210
stp1211
a((dp1212
g2
(lp1213
VI'm afraid probably not - as far as I understand it, the EDMX designer will generate a single (albeit partial) class for each table/entity, and you can't really "inject" any common base tables into the mix
p1214
aVWhat you could investigate is possibly putting your common data into an interface (ICommonData) and then have the classes implement that interface
p1215
aVNot sure how you'd inject that interface into the EDMX designer's process, though :-(
p1216
aVMarc
p1217
as(dp1218
g10
V13302
p1219
stp1220
a((dp1221
g2
(lp1222
V[quote]could do it manually, and horribly, by
p1223
aVadding all such attributes to the XSD
p1224
aVwhen I generate it, something like
p1225
aVthis:[/quote]
p1226
aVI'm afraid this is your only "proper", XSD-schema compatible way to do it
p1227
aVXSD can be convoluted to author at times - but it helps keeping things safe :-)
p1228
aVMarc
p1229
as(dp1230
g10
V13302
p1231
stp1232
a((dp1233
g2
(lp1234
VWell, you will have to create proxy - either statically by adding a service reference or running svcutil on your service metadata, or you can construct it dynamically totally in code, if you wish
p1235
aVIn that case, you'd have to have your service contract (ISomethingService) at hand, and check out the ChannelFactory < ISomethingService > () concept - that should get you started
p1236
aVMarc
p1237
as(dp1238
g10
V13302
p1239
stp1240
a((dp1241
g2
(lp1242
VIf you're doing your design / coding in C# classes, adorned with [ServiceContract] and [OperationContract], then I don't know of any way to export documentation you might have on those classes and methods into the WSDL, unfortunately
p1243
aVI was appalled by that too - I expected any /// comments on my classes and methods to show up in the WSDL - no luck :-(
p1244
aVOur solution now is this:
p1245
aV1) we create a basic "mockup" of our service interface with all operations in C#
p1246
aV2) we compile that into an assembly
p1247
aV3) we extract the metadata (WSDL, XSD) from that assembly and then throw away the C# "prototype"
p1248
aV4) we manually add comments (xs:annotation/xs:documentation) to the WSDL and XSD
p1249
aV5) from now on, the WSDL/XSD are the master - and we generate our interface from those descriptions
p1250
aVCumbersome and annoying, but it works fairly ok for us
p1251
aVI sure hope VS2010 / WCF 4
p1252
aV0 will bring us a bit more support in this area
p1253
aVMarc
p1254
as(dp1255
g10
V13302
p1256
stp1257
a((dp1258
g2
(lp1259
VCould it be that your database table has a "DATETIME" or "SMALLDATETIME" column and you're trying to insert an out-of-range date
p1260
aVDATETIME covers 1753-1-1 through 9999-12-31, while SMALLDATETIME covers 1900-1-1 through 2079-6-6 only
p1261
aVThe new SQL Server 2008 DATETIME2 data type will cover 0001-1-1 through 9999-12-31
p1262
aVMarc
p1263
as(dp1264
g10
V13302
p1265
stp1266
a((dp1267
g2
(lp1268
VI don't quite understand what you mean by "automatically stub" the event handlers
p1269
aVLike typing the "override" and getting Intellisense telling what event handlers are available
p1270
aVAfraid that's not there
p1271
aVHere are a number of good articles showing what's avaialble, though:
p1272
aVCodeToad
p1273
aVmha
p1274
aVdk
p1275
aVCan't seem to find any definitive, complete listing anywhere, though :-(
p1276
aVMarc
p1277
as(dp1278
g10
V13302
p1279
stp1280
a((dp1281
g2
(lp1282
VEven if you use the table rarely, only once a year, a well designed clustered index and possibly a few non-clustered indices as well will help you speed up your queries, allowing you to spend less time waiting for your queries and reports to finish and giving you more spare time - how's that for an argument
p1283
aV:-)
p1284
aVMarc
p1285
aVPS: Oh yeah, and to (loosely) cite Joe Celko:
p1286
aVif it doesn't have a primary key, it's not a table" :-)
p1287
as(dp1288
g10
V13302
p1289
stp1290
a((dp1291
g2
(lp1292
VI'm not aware of any tools that will do it just like that - but you could always use SMO (the SQL Server Management Objects) to read your DataSet's structure and create database tables from that
p1293
aVMarc
p1294
as(dp1295
g10
V13302
p1296
stp1297
a((dp1298
g2
(lp1299
VThere's a XSLT called "xs3p" which can be downloaded from xml
p1300
aVfiforms
p1301
aVorg/xs3p
p1302
aVYou can use any XSLT processor to convert your XSD into HTML - I use "nxslt3" by Oleg Tkachenko
p1303
aVA second step would then be to combine several HTML into a CHM using some Html Help builder
p1304
aVMarc
p1305
aVPS: forgot to mention - both tools are free, of course :-)
p1306
as(dp1307
g10
V13302
p1308
stp1309
a((dp1310
g2
(lp1311
VIf your app is an ASP
p1312
aVNET app, you could investigate the Server
p1313
aVMapPath call - if you're using the same virtual directory as the main app
p1314
aVOtherwise, I'd suggest storing the "base path" (that corresponds to the virtual directory path) in a config for your external app and just concatenating that base path and the file path into a complete path
p1315
aVMarc
p1316
as(dp1317
g10
V13302
p1318
stp1319
a((dp1320
g2
(lp1321
VYou could wrap the code to find your department ID into a stored function and use that in your DEFAULT constraint statement:
p1322
aVAnd then:
p1323
aVDoes that help
p1324
aVMarc
p1325
as(dp1326
g10
V13302
p1327
stp1328
a((dp1329
g2
(lp1330
VYes, there's an event hook on the SqlCommand object called SqlInfoMessage, which you can hook into:
p1331
aVThe event handler will look like this:
p1332
aVThe "e
p1333
aVMessage" is the message printed out to the message window in SQL Server Mgmt Studio
p1334
aVMarc
p1335
as(dp1336
g10
V13302
p1337
stp1338
a((dp1339
g2
(lp1340
VAccording to this blog entry, it's currently (v1) not possible to create the database from an entity model
p1341
aVAbout half way down, under the heading of "2
p1342
aVProcess and tooling issues", you'll find:
p1343
aVIt is not currently possible to create the database schema
p1344
aVautomatically from the Entity Model
p1345
aVThis is simply extraordinary - as it
p1346
aVseems to easy to do
p1347
aVLet's hope for EF v2 (in
p1348
aVNET 4
p1349
aV0 / VS2010)
p1350
aVMarc
p1351
as(dp1352
g10
V13302
p1353
stp1354
a((dp1355
g2
(lp1356
VAs of SQL Server 2005, you should basically create users in two steps:
p1357
aVcreate a "login" to your SQL Server as a whole
p1358
aVcreate users for this login in each database needed
p1359
aVYou'd go about doing this like so:
p1360
aVAnd the "USE" your database and create a user for that login:
p1361
aVMarc
p1362
as(dp1363
g10
V13302
p1364
stp1365
a((dp1366
g2
(lp1367
VCheck out:
p1368
aVHelp and Manual
p1369
aVHelpScribble
p1370
aVDoc-o-Matic
p1371
aVThese tools should be able to create help files, and quite possibly also use XMLDoc as their input (both are Delphi-compatible or even written in Delphi)
p1372
aVMarc
p1373
as(dp1374
g10
V13302
p1375
stp1376
a((dp1377
g2
(lp1378
V[there is a clustered index with 6 fields, and two other indexes on single fields
p1379
aVWithout knowing any details about the fields, I would try to find a way to make the clustered index smaller
p1380
aVWith SQL Server, all the clustered-key fields will also be included in all the non-clustered indices (as a way to do the final lookup from non-clustered index to actual data page)
p1381
aVIf you have six fields at 8 bytes each = 48 bytes, multiply that by two more indices times 77 million rows - and you're looking at a lot of wasted space which translates into a lot
p1382
aVof I/O operations (and thus degrades performance)
p1383
aVFor the clustered index, it's absolutely CRUCIAL for it to be unique, stable, and as small as possible (preferably a single INT or such)
p1384
aVMarc
p1385
as(dp1386
g10
V13302
p1387
stp1388
a((dp1389
g2
(lp1390
VYou have plenty of options
p1391
aV:-)
p1392
aVYou mention you want to use the data access layer (DAL) from asp
p1393
aVnet and web services
p1394
aVNo problem
p1395
aVBasically, what you need to figure out is a basic design you want to follow, and encapsulate the DAL into its own assembly which can be used / referenced from various consumers
p1396
aVThere are numerous ways of doing this:
p1397
aVcreate a Linq-to-SQL mapping for your tables, if you're using SQL Server as your backend, and use the Linq-to-SQL entities and methods
p1398
aVcreate a repository pattern (for each "entity", you have an "EntityRepository" class, which can be used to retrieve entities, e
p1399
ag164
aVEntityReposity
p1400
aVGetByID(int id), or EntityRepository
p1401
aVGetByForeignKey(string fk) or whatever
p1402
aVuse some other means of accessing the data (NHibernate, your own ADO
p1403
aVNET based mapper)
p1404
aVyou could actually also use webservice calls as your data providers
p1405
aVYour biggest challenge is to define a standard way of doing things, and sticking to it
p1406
aVSee some articles - maybe they'll give you an idea:
p1407
aVCreating a Data Access Layer in
p1408
aVNET - Part 1
p1409
aVBuilding a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP
p1410
aVNET 2
p1411
ag334
as(dp1412
g10
V13302
p1413
stp1414
a((dp1415
g2
(lp1416
VOne approach would be to include the SQL Server 2008 Express install package and then use a custom action in your Windows installer to fire off the silent, background installation of SQL Server 2008 Express
p1417
aVThe package is a standard MSI package - you should be able to set a boatload of properties on the command-line, when installing the MSI
p1418
aVHere's a sample I found:
p1419
aVThe full list of command line properties ought to be available at Microsoft or in the help file for SQL Server 2008 Express somewhere, I'm sure
p1420
aVMarc
p1421
as(dp1422
g10
V13302
p1423
stp1424
a((dp1425
g2
(lp1426
VThe basic normal proxy generated by svcutil will use the DataContractSerializer, which uses these Order=x attributes
p1427
aVIf you wish, you could also use the straight XmlSerializer instead, which will not decorate your properties with an Order=x attribute
p1428
aVUse:
p1429
aVto achieve this
p1430
aVMarc
p1431
as(dp1432
g10
V13302
p1433
stp1434
a((dp1435
g2
(lp1436
VAre you aware of "LINQ to Active Directory"
p1437
aVCheck it out on Codeplex
p1438
aVThat might be a good starting point
p1439
aVMarc
p1440
as(dp1441
g10
V13302
p1442
stp1443
a((dp1444
g2
(lp1445
VTry:
p1446
aVOxygen XML Schema Editor
p1447
aVLiquid Technologies' XML / XSD Editor
p1448
aVThere are plenty others, too - but I prefer one of those two
p1449
aVMarc
p1450
as(dp1451
g10
V13302
p1452
stp1453
a((dp1454
g2
(lp1455
VXSL could be something like this:
p1456
aVOF course, you'll want to prettify it :-) but it basically works
p1457
aVWhether it's the right choice and best technology to use for this, is totally up to you :-) But it can be done - no problem
p1458
aVMarc
p1459
as(dp1460
g10
V13302
p1461
stp1462
a((dp1463
g2
(lp1464
VAnother possible solution you could investigate is serializing the objects into a stream, and then reconstructing them from that same stream into new instances
p1465
aVThis often works wonders when everything else seems awfully convoluted and messy
p1466
aVMarc
p1467
as(dp1468
g10
V13302
p1469
stp1470
a((dp1471
g2
(lp1472
VAdditionally, there's also the WCF Security Guidance by Microsoft's Patterns & Practices group
p1473
aVCheck it out
p1474
aVMarc
p1475
as(dp1476
g10
V13302
p1477
stp1478
a((dp1479
g2
(lp1480
VIf you want to run the two services on separate endpoints / ports, do something like this:
p1481
aVServer-side:
p1482
aVClient-side:
p1483
aVThat should give you two separate, individual endpoints on the server and a client that will talk to both
p1484
aVMarc
p1485
as(dp1486
g10
V13302
p1487
stp1488
a((dp1489
g2
(lp1490
VYou can use it when you're only reading data, and you don't really care about whether or not you might be getting back data that is not committed yet
p1491
aVIt can be faster on a read operation, but I cannot really say by how much
p1492
aVIn general, I recommend against using it - reading uncommitted data can be a bit confusing at best
p1493
aVMarc
p1494
as(dp1495
g10
V13302
p1496
stp1497
a((dp1498
g2
(lp1499
VSure, no problem
p1500
aVThe only rule is: you cannot have two endpoints with the same address and protocol, e
p1501
ag164
aVyou cannot have two HTTP endpoint on localhost:8000
p1502
aVMarc
p1503
as(dp1504
g10
V13302
p1505
stp1506
a((dp1507
g2
(lp1508
VFor one thing, I would AVOID making the clustered index wider than it absolutely has to be
p1509
aVMaking it into five parts seems about contra-productive
p1510
aVAre ALL the columns in this compound clustered index stable, e
p1511
ag164
aVnever change
p1512
aVIf not, I would avoid them at all costs
p1513
aVA clustered index should be:
p1514
aVunique
p1515
aVstable
p1516
aVas narrow as possible
p1517
aVYou can change your non-clustered indices - no problem
p1518
aVBut avoid making the clustered index messy
p1519
aVThat'll definitely bring down your performance
p1520
aVCheck out Kimberly Tripp's excellent blog articles on indexing:
p1521
aVmain link here
p1522
aVbest practices for clustering index here
p1523
aVMarc
p1524
as(dp1525
g10
V13302
p1526
stp1527
a((dp1528
g2
(lp1529
VTemp tables are always on disk - so as long as your CTE can be held in memory, it would most likely be faster (like a table variable, too)
p1530
aVBut then again, if the data load of your CTE (or temp table variable) gets too big, it'll be stored on disk, too, so there's no big benefit
p1531
aVIn general, I prefer a CTE over a temp table since it's gone after I used it
p1532
aVI don't need to think about dropping it explicitly or anything
p1533
aVSo, no clear answer in the end, but personally, I would prefer CTE over temp tables
p1534
as(dp1535
g10
V13302
p1536
stp1537
a((dp1538
g2
(lp1539
VHave you tried putting your extension method into a separate assembly and referencing it that way
p1540
aVMarc
p1541
as(dp1542
g10
V13302
p1543
stp1544
a((dp1545
g2
(lp1546
VI would recommend checking out WCF instead of
p1547
aVNET webservices - it gives you more flexibility, more options, e
p1548
ag164
aV"reliable sessions" (which will deal with short network hiccups), and it gives you easy support for MTOM encoding for large messages, and even supports streaming, if you plan on serving up e
p1549
ag164
aVvideo or other content
p1550
aVMarc
p1551
as(dp1552
g10
V13302
p1553
stp1554
a((dp1555
g2
(lp1556
VNot sure if this is true for all ODBC drivers connecting to SQL Server 2005, but DataDirect does claim to support pretty much all SQL Server 2005 and even most of the new SQL Server 2008 features
p1557
aVSee their listing here
p1558
aVAh, and here's Microsoft comment on it:
p1559
aVIf you are developing a COM-based application and need to access the new features of SQL Server 2005, you should use SQL Native Client
p1560
aVIf you don't need access to the new features of SQL Server 2005, you can continue to use Microsoft Data Access Components (MDAC)
p1561
aVSo I guess, if you use the SQL Native Client ODBC driver, you should be able to use the XML data type
p1562
aVMarc
p1563
as(dp1564
g10
V13302
p1565
stp1566
a((dp1567
g2
(lp1568
VWell, in a more advanced setting: VS Setup Projects cannot be automated, e
p1569
ag164
aVyou cannot put your project and the VS Setup Project on a build server and have them built automatically
p1570
aVThis might not be an issue for a smaller shop or a single developer, but for a larger enterprise-level development environment, this alone can be quite a killer criteria
p1571
aVIn order to get around this, we use WiX for our setups - more work once up front, but works nicely with continuous integration
p1572
aVMarc
p1573
as(dp1574
g10
V13302
p1575
stp1576
a((dp1577
g2
(lp1578
VNot to my knowledge, no
p1579
aVThe only reason I can think of is that SQL Server would internally sort the data in order to detect and filter out duplicates, and thus return it in a "pre-sorted" manner
p1580
aVBut I wouldn't rely on that "side effect" :-)
p1581
as(dp1582
g10
V13302
p1583
stp1584
a((dp1585
g2
(lp1586
VWhat I am missing is a measure for the needed / required / defined level of reliability
p1587
aVWhile you could probably spec out a big honking machine to handle all the load, depending on your reliabiltiy requirements, you might rather want to invest in smaller, but multiple machines, and into safer disk subsystems (RAID 5)
p1588
aVMarc
p1589
as(dp1590
g10
V13302
p1591
stp1592
a((dp1593
g2
(lp1594
VBy default, class libraries don't parse their own mylibrary
p1595
aVdll
p1596
aVconfig - they will use the host's config file (app
p1597
aVconfig or web
p1598
aVconfig) instead
p1599
aVWhat you could do is check out the ConfigurationManager and see the methods for loading specific / other config files from disk (OpenMappedExeConfiguration)
p1600
aVThat way, you could probably get at your library's config settings and use them
p1601
aVThere are quite a few postings on using this OpenMappedExeConfiguration here on Stackoverflow or elsewhere
p1602
aVMarc
p1603
as(dp1604
g10
V13302
p1605
stp1606
a((dp1607
g2
(lp1608
VYou have plenty of ways of getting it
p1609
aV"gbn" showed one way - two other are here
p1610
aVIf you want the whole "row" (I assumed you'll put these things into a  tag), try this:
p1611
aVIf you want just the "Name" attribute from the  tag, use this:
p1612
aVIf you need to access a whole bunch of attributes and/or subelements, use gbn's approach with the "CROSS APPLY xmldoc
p1613
aVnodes(
p1614
aVEnjoy
p1615
aVXML Support in SQL Server 2005 is really quite extensive and useful
p1616
aVMarc
p1617
as(dp1618
g10
V13302
p1619
stp1620
a((dp1621
g2
(lp1622
VNot sure if it's really a problem, but I see you have the same name for your binding configuration ()
p1623
aVI usually try to call my endpoints something like "UserServiceBasicHttp" or something similar (the "Binding" really doesn't have anything to do here), and I try to call my binding configurations something with "
p1624
aVConfiguration", e
p1625
ag164
aV"UserServiceDefaultBinding", to avoid any potential name clashes
p1626
aVMarc
p1627
as(dp1628
g10
V13302
p1629
stp1630
a((dp1631
g2
(lp1632
VWell, check out Oleg Sych's blog - he's the author of T4 Toolbox, and he shows how you can output to multiple files
p1633
aVNot sure if the T4Toolbox also includes support for configuration - worth a look
p1634
aVHis blog is great - and has lots of T4 stuff in it
p1635
aVMarc
p1636
as(dp1637
g10
V13302
p1638
stp1639
a((dp1640
g2
(lp1641
VIn SQL Server 2005 and up, you can create one or multiple projects and group your scripts into SQL Server projects
p1642
aVQuite handy
p1643
aVOr use the SQL Server templates in the Template Explorer - extremely helpful for keeping (nearly) every-day scripts at your finger tips
p1644
aVMarc
p1645
as(dp1646
g10
V13302
p1647
stp1648
a((dp1649
g2
(lp1650
VHave you tried removing the "@" from your XPath strings
p1651
aVThat should work - does work for me on a daily basis :-)
p1652
aVMarc
p1653
as(dp1654
g10
V13302
p1655
stp1656
a((dp1657
g2
(lp1658
VThere are several commercial tools out there that can create database scripts, e
p1659
ag164
aVApexSQL's SQL Script
p1660
aVEMS DB Extract
p1661
aVHere's an article showing off a free tool - however, it will only script ALL objects from your database: Eric Moreau's blog
p1662
aVIf you want to "roll your own", have a look at the Server Management Objects (SMO) - those allow you to inspect your database and create scripts from them
p1663
aVSee info here, here or here
p1664
aVMarc
p1665
as(dp1666
g10
V13302
p1667
stp1668
a((dp1669
g2
(lp1670
VThere are plenty of tools - I personally really like SQL Doc (by Red-Gate; mentioned before), but also ApexSQL's ApexSQL Doc
p1671
aVBut a lot of other tools also will read and document database schemas - if you already have a help writer, check it out - it might even support database documentation, too
p1672
aVMarc
p1673
as(dp1674
g10
V13302
p1675
stp1676
a((dp1677
g2
(lp1678
VYes of course - the service being hosted on
p1679
aVNET 3
p1680
aV5 doesn't require the same version of the
p1681
aVNET framework on the client
p1682
aVHeck - you can even call such a service from Java or PHP
p1683
aVThat's the whole POINT of Service Oriented Architecture
p1684
aV:-)
p1685
aVYou need to define your service contract (what's the service called; what methods are available to be called on it) and you need to decide how to host it, e
p1686
ag164
aVat what address can you call this service, and what parameters are required (e
p1687
ag164
aVHTTP vs
p1688
aVTCP, secured or not secured etc
p1689
aV- that's a lot of work, even in WCF
p1690
aVHere are three introductory articles for WCF - check them out
p1691
aVMSDN
p1692
aVCodeProject
p1693
aVDennis van der Stelt's Blog
p1694
aVBut calling that service from a
p1695
aVNET 2
p1696
aV0 client is ABSOLUTELY no problem
p1697
aVMarc
p1698
as(dp1699
g10
V13302
p1700
stp1701
a((dp1702
g2
(lp1703
VIf you want to use the XML in some form, you could mark it as a "embedded resource" in the properties window, and then access it from your code like so:
p1704
aVOnce you're done, you have the XML file's contents in "xmlContents", if all goes well
p1705
aVMarc
p1706
as(dp1707
g10
V13302
p1708
stp1709
a((dp1710
g2
(lp1711
VSQL Server 2005 and up have a datatype called "XML" which you can store XML in - untyped or typed with a XSD schema
p1712
aVYou can basically fill columns of type XML from an XML literal string, so you can easily just use a normal INSERT statement and fill the XML contents into that field
p1713
aVMarc
p1714
as(dp1715
g10
V13302
p1716
stp1717
a((dp1718
g2
(lp1719
VIf your table is getting up to 1 TB in size and probably has LOTS of rows in it, I would strongly recommend NOT making the clustered index that much fatter
p1720
aVFirst of all, dropping and recreating the clustered index will shuffle around ALL your data at least once - that alone will take ages
p1721
aVSecondly, the big compound clustered index you're trying to create will significantly increase the size of all your non-clustered indices (since they contain the whole clustered index value on each leaf node, for the bookmark lookups)
p1722
aVThe question is more: why are you trying to do this
p1723
aVCouldn't you just add another non-clustered index with those columns, to potentially cover your queries
p1724
aVWhy does this have to be the clustered index
p1725
aVI don't see any advantage in that
p1726
aVFor more information on indexing and especially the clustered index debate, see Kimberly Tripp's blog on SQL Server indexes - very helpful
p1727
aVMarc
p1728
as(dp1729
g10
V13302
p1730
stp1731
a((dp1732
g2
(lp1733
VTry this - worked for me:
p1734
aVTrick is -  first, before you do any other processing
p1735
aVMarc
p1736
as(dp1737
g10
V13302
p1738
stp1739
a((dp1740
g2
(lp1741
VI have used two:
p1742
aVAlt-Soft's Xml2PDF (which also converts XHTML to PDF)
p1743
aVExpertPDF's Html-to-PDF
p1744
aVBoth worked quite okay, but have their quirks and troubles
p1745
aVMarc
p1746
as(dp1747
g10
V13302
p1748
stp1749
a((dp1750
g2
(lp1751
VNo - why should it be
p1752
aVIf I can get a tool to do the annoying, boring code for me - I can do more interesting stuff in the mean time
p1753
aVMarc
p1754
as(dp1755
g10
V13302
p1756
stp1757
a((dp1758
g2
(lp1759
VWell, with the XML datatype in SQL Server 2005 and up, you always HAVE your raw XML - no need to "get it" - it's right there, in the column, stored for your convenience
p1760
aVYou can of course also query it using XQuery and XPath, and even update it while it's stored inside the database
p1761
aVIf you can - definitely use the XML data type
p1762
aVYou can use it "untyped" or associate it with a XML schema to add validation
p1763
aVMarc
p1764
as(dp1765
g10
V13302
p1766
stp1767
a((dp1768
g2
(lp1769
VDepends on your set up - do you do "per call" conversations
p1770
aVThen you don't really get any "client now connected" message per se
p1771
aVDo you do session-based conversations
p1772
aVYour "ServiceHost" class has two events "Opening" and "Opened", which you can hook into, especially if you self-host your service
p1773
aVWhat exactly is it you want to achieve by trapping this event
p1774
aVMarc
p1775
as(dp1776
g10
V13302
p1777
stp1778
a((dp1779
g2
(lp1780
VDo something like this:
p1781
aVOf course it would be a whole lot easier and faster with SQL Server 2008's "DATE" datatype, or if you could store day, month, year in "Holidays" separately
p1782
aVMarc
p1783
as(dp1784
g10
V13302
p1785
stp1786
a((dp1787
g2
(lp1788
VSomething like this should help:
p1789
aVMarc
p1790
as(dp1791
g10
V13302
p1792
stp1793
a((dp1794
g2
(lp1795
VI want a dropdown on top with option "GMAT", "GRE", "LSAT", "MCAT"
p1796
aVRight now, you could only select those items based on string-parsing the ImageTitle and finding substring in it - less than optimal
p1797
aVIf there's any chance at all, I'd recommend adding a tag  (or whatever you want to call it) to your data, something like this:
p1798
aVThat way, selecting the proper elements would be as easy a very simple XPath expression:
p1799
aVonce you have loaded your data file into an XmlDocument (or you the Linq-to-XML way, if you prefer that)
p1800
aVMarc
p1801
as(dp1802
g10
V13302
p1803
stp1804
a((dp1805
g2
(lp1806
VLDAP is inherently NOT compliant with even the first-normal form - some of its attribute can contain multiple values
p1807
aVLDAP is a system designed for optimal read-/lookup performance, e
p1808
ag164
aVit's more appropriate in a scenario where you'll be reading / looking up the data way more than changing it (--> directories; your company phonebook won't be changing dozens times a day)
p1809
aVLDAP is not geared towards or designed for replacing or competing with standard relational database system which excel at data entry / transformation, where a large number of your operations will be inserting and/or updating data
p1810
aVThat's what RDBMS are perfectly suited for
p1811
aVSo, in closing: LDAP vs
p1812
aVRDBMS is really a non-starter - and the two worlds are quite distinct and quite different in their style of working
p1813
aVI would not recommend trying to blindly apply something from one world to the other - it will be a bad match
p1814
aVAs for inspiration for LDAP schema design - I would definitely look at Microsoft's Active Directory, Novell's eDirectory (or whatever it's called these days), and possibly other LDAP directories, and learn from their designs
p1815
aVMarc
p1816
as(dp1817
g10
V13302
p1818
stp1819
a((dp1820
g2
(lp1821
VI had a similar problem where I could only validate parts of my XML document
p1822
aVI came up with this method here:
p1823
aVBasically, I pass it an XmlNode (which I select from the entire XmlDocument by means of
p1824
aVSelectSingleNode), and an XML schema which I load from an embedded resource XSD inside my app
p1825
aVAny validation errors that might occur are being stuffed into a "errors" string builder, which I then read out at the end, to see if there were any errors recorded, or not
p1826
aVWorks for me - your mileage may vary :-)
p1827
as(dp1828
g10
V13302
p1829
stp1830
a((dp1831
g2
(lp1832
VWhy are you considering putting each operation into its own service contract
p1833
aVWhat do you intend to gain from that
p1834
aVBasically, a service contract can have as many operations marked [OperationContract] as you wish
p1835
aVThat would probably make more sense
p1836
aVIf you have disparate functions, you can always define more than one ServiceContract (as an interface), and have your service class implement them all and host the one service class (with all the ServiceContract interfaces) on one single address (including port)
p1837
aVMarc
p1838
as(dp1839
g10
V13302
p1840
stp1841
a((dp1842
g2
(lp1843
VThat's going to be really tough, if not impossible, to get done properly and reliably
p1844
aVThe trouble is: there's no indication of an index or type on the many  and  nodes as to what their type / position is - you have to more or less guess
p1845
aVIt would be a different story if the  at least had an additional attribute, something like  and  and so forth - that way one might be able to somehow associate those together
p1846
aVIs there any chance at all you could "massage" the original data a bit
p1847
aVOtherwise, I'd probably say you'll have to load it in C# and parse it and do a lot of manual processing to get what you want
p1848
aVMarc
p1849
as(dp1850
g10
V13302
p1851
stp1852
a((dp1853
g2
(lp1854
VCheck out  - you can call it with a type
p1855
aVor with an assembly and type name as
p1856
aVThis will give you an instance of the type you need
p1857
aVIf you need the  rather than the instance, use the  method and the fully qualified name of the type you're interested in, e
p1858
ag164
aV:
p1859
aVThat'll give you the  in question
p1860
as(dp1861
g10
V13302
p1862
stp1863
a((dp1864
g2
(lp1865
VCould it be that your new XML has XML namespaces in it, that your XSLT dosen't deal with properly
p1866
aVCan you show us relevant parts of your XML and XSLT files
p1867
aVMarc
p1868
as(dp1869
g10
V13302
p1870
stp1871
a((dp1872
g2
(lp1873
VWe currently use this template for any queries that we execute (you could leave out the Transaction stuff, if you don't need it in e
p1874
ag164
aVa DDL statement):
p1875
aVOf course, you could easily insert the caught exception into your error log table
p1876
aVIt works really well for us
p1877
aVYou could probably even automate some of the conversion from your old stored procs to a new format using Code Generation (e
p1878
ag164
aVCodeSmith) or some custom C# code
p1879
as(dp1880
g10
V13302
p1881
stp1882
a((dp1883
g2
(lp1884
VYes, SQL Server 2005 introducted the "DDL Triggers" - read an excellent article on it here at SQL Team
p1885
aVThis article shows nicely that they are two scopes for DDL triggers - server-wide, or database-wide
p1886
aVThose that are database-wide cannot be applied to the whole server - you'd have to set them up in each database
p1887
aVMarc
p1888
as(dp1889
g10
V13302
p1890
stp1891
a((dp1892
g2
(lp1893
VYes, definitely
p1894
aVXML namespaces are optional - you can leave them out if you wish to do so, and if you don't get into any trouble with ambigious XML elements in your "XML world" :-)
p1895
aVMarc
p1896
as(dp1897
g10
V13302
p1898
stp1899
a((dp1900
g2
(lp1901
VThe DataContract serializer was optimized for speed, and it seems the designer decided supporting attributes on XML nodes was not good for their speed requirements
p1902
aVThe DataContract serializer does not support attributes - if you need those, use the venerable XmlSerializer instead
p1903
aVMarc
p1904
as(dp1905
g10
V13302
p1906
stp1907
a((dp1908
g2
(lp1909
VBasically, you cannot do what you would like - but you can get the right tools to help you out making things a bit easier
p1910
aVIf you look at Red-Gate's SQL Prompt, you can type "SELECT * FROM MyTable", and then move the cursor back after the "*", and hit  to expand the list of fields, and remove those few fields you don't need
p1911
aVIt's not a perfect solution - but a darn good one
p1912
aV:-) Too bad MS SQL Server Management Studio's Intellisense still isn't intelligent enough to offer this feature
p1913
aVMarc
p1914
as(dp1915
g10
V13302
p1916
stp1917
a((dp1918
g2
(lp1919
VDoes this query come back quickly
p1920
aVIf so I would definitely say there's a lock of some sort on your table / index, as has been suggested
p1921
aVMarc
p1922
as(dp1923
g10
V13302
p1924
stp1925
a((dp1926
g2
(lp1927
VAre you including enough of the options in the SQL Profiler to see the BatchCompleted events, too
p1928
aVMarc
p1929
as(dp1930
g10
V13302
p1931
stp1932
a((dp1933
g2
(lp1934
VYou could use something like this (it looks like pretty standard basicHttpBinding):
p1935
aVThis works as long as you have a DLL which contains the contract ("MyService
p1936
aVMyServiceInterface") available and you can reference it in your client
p1937
aVIf you need this on the service side, you'll have to use some different classes etc - but the basics are the same (create a binding, create one or more endpoint addresses, bind them)
p1938
aVMarc
p1939
aVPS: Sorry, I just noticed you use a https:// address - that might require some additional security configuration in code
p1940
as(dp1941
g10
V13302
p1942
stp1943
a((dp1944
g2
(lp1945
VIt's the blocks of T-SQL statements that make up a stored procedure, a stored function, a trigger or a view definition
p1946
aVFrom "Books Online" in the "CREATE PROCEDURE" section:
p1947
aVGetting Information About Stored
p1948
aVProcedures To display the definition
p1949
aVof a Transact-SQL stored procedure,
p1950
aVuse the sys
p1951
aVsql_modules catalog view
p1952
aVin the database in which the procedure
p1953
aVexists
p1954
aVIn sys
p1955
aVsql_modules, you'll find the actual T-SQL code
p1956
aVMarc
p1957
as(dp1958
g10
V13302
p1959
stp1960
a((dp1961
g2
(lp1962
VAre you talking about when to create a WCF service yourself (over web service), or when to consume an existing web service using WCF instead of
p1963
aVNET 2
p1964
aV0 ASMX clients
p1965
aVAs for creating a WCF service yourself:
p1966
aVGives you a lot more options in terms of hosting (in an app, Windows Service, IIS, WAS)
p1967
aVGives you a lot more security options
p1968
aVGives you a lot more protocol options (besides just HTTP, you can also use WS-*, TCP, Named Pipes, MSMQ and more)
p1969
aVAllows you to write your service once, and expose it on multiple end-points with different protocols at the same time
p1970
aVAs for using WCF to talk to an existing HTTP (ASMX) web service - I don't see a whole lot of massive benefits, except WCF uses more configuration over code, and it can be good to standardize on one way of doing things, if you already use other WCF services, anyway
p1971
aVMarc
p1972
as(dp1973
g10
V13302
p1974
stp1975
a((dp1976
g2
(lp1977
VWhat version of SQL Server are you on
p1978
aVI would recommend replacing TEXT with VARCHAR(MAX), if you ever can (SQL Server 2005 and up)
p1979
aVWhat makes you say that full text won't work
p1980
aVHow have you set up fulltext, and what do your fulltext queries look like
p1981
aVMarc
p1982
as(dp1983
g10
V13302
p1984
stp1985
a((dp1986
g2
(lp1987
VAre you only ever going to have to check for "IsFemale" true/false
p1988
aVWouldn't a column like "PersonType" or something like that be more appropriate
p1989
aVThat way, you could have "female", "male", "company" and so forth - more possible values
p1990
aVMarc
p1991
aVPS: but if you choose to use a "bit" (boolean) column, then the "Is" or "Has" prefix is a good choice, in my opinion - makes it quite clear it's a boolean
p1992
as(dp1993
g10
V13302
p1994
stp1995
a((dp1996
g2
(lp1997
VHave you looked at Pascal Analyzer or the free limited version, Icarus, from Peganza Software
p1998
aVThey will create "uses reports" telling you what module uses what others, so that should give you the info you're after
p1999
aVMarc
p2000
as(dp2001
g10
V13302
p2002
stp2003
a((dp2004
g2
(lp2005
VAccording to Microsoft's T-SQL docs:
p2006
aVIDENT_CURRENT is similar to the SQL
p2007
aVServer 2000 identity functions
p2008
aVSCOPE_IDENTITY and @@IDENTITY
p2009
aVAll
p2010
aVthree functions return last-generated
p2011
aVidentity values
p2012
aVHowever, the scope
p2013
aVand session on which last is defined
p2014
aVin each of these functions differ:
p2015
aVIDENT_CURRENT returns the last
p2016
aVidentity value generated for a
p2017
aVspecific table in any session and any
p2018
aVscope
p2019
aV@@IDENTITY returns the last identity
p2020
aVvalue generated for any table in the
p2021
aVcurrent session, across all scopes
p2022
aVSCOPE_IDENTITY returns the last
p2023
aVidentity value generated for any table
p2024
aVin the current session and the current
p2025
aVscope
p2026
aVSo I would say, no, IDENT_CURRENT does not guarantee to give you back the right value
p2027
aVIt could be the last IDENTITY value inserted in a different session
p2028
aVI would make sure to use SCOPE_IDENTITY instead - that should work reliably
p2029
aVMarc
p2030
as(dp2031
g10
V13302
p2032
stp2033
a((dp2034
g2
(lp2035
VI don't think you can use SQL SMO from Visual Studio 2003 /
p2036
aVNET 1
p2037
aV1 - SQL SMO requires at least
p2038
aVNET 2
p2039
ag334
aVMarc
p2040
as(dp2041
g10
V13302
p2042
stp2043
a((dp2044
g2
(lp2045
VWhat version of SQL Server are you using in the background
p2046
aVIf you're using SQL Server 2008, I would recommend bulk-loading the tags and news for each day into a temporary working table, and then using the MERGE statement to update the actual Tags and News table from those working tables
p2047
aVI'd use the C# "SqlBulkCopy" class for that
p2048
aVMERGE allows you to easily insert only those items that have changed, and possibly update those that already exist, all in one single, handy SQL statement
p2049
aVIf you're on SQL Server 2005 or below, you can do basically the same, but you'll have to write some code (C# or T-SQL) to manually check what needs to be inserted from your temp bulkload tables, and what is already present
p2050
aVMarc
p2051
as(dp2052
g10
V13302
p2053
stp2054
a((dp2055
g2
(lp2056
VIs there a (propertyname)Specified property of type boolean
p2057
aVDo you have a "MyEnumValueSpecified" of type bool in your WCF proxy
p2058
aVWCF uses this to define whether or not a particular property has been specified or not
p2059
aVThat way, even if the property is of type "Enum
p2060
aVit can be "nullable"
p2061
aVMarc
p2062
as(dp2063
g10
V13302
p2064
stp2065
a((dp2066
g2
(lp2067
VWEll, for one - ASP
p2068
aVNET Dynamic Data is part of the basic ASP
p2069
aVNET package that you get - IronSpeed is a commercial add-on with a fairly hefty price tag
p2070
aVSo I would assume for a lot of folks, this question is a no-brainer as long as ASP
p2071
aVNET Dynamic Data is halfway useful (and it is
p2072
aVPlus - the two are really totally different beasts - this is like comparing apples to elephants
p2073
aVIronSpeed is a complete web app generation package - a lot more than "just" scaffolding your tables with a base admin UI, I would say
p2074
aVASP
p2075
aVNET Dynamic Data on the other hand isn't a complete application framework - it's a great tool to get basic admin and/or prototype UI's up and running, but it's not the finished app, really
p2076
aVMarc
p2077
as(dp2078
g10
V13302
p2079
stp2080
a((dp2081
g2
(lp2082
VSMO (SQL Server Management Objects) was released with SQL Server 2005, and requires
p2083
aVNET 2
p2084
aV0 at least
p2085
aVVS 2003 only supports
p2086
aVNET 1
p2087
aVx
p2088
aVIn
p2089
aVNET 1
p2090
aVx, you'll have to revert to SQL-DMO - a COM based set of components for managing SQL Server database objects
p2091
aVMarc
p2092
as(dp2093
g10
V13302
p2094
stp2095
a((dp2096
g2
(lp2097
VI think Michael's answer with the auto-increment should work well - your customer will get "01000" and then "01001" and then "01002" and so forth
p2098
aVIf you want to or have to make it more random, in this case, I'd suggest you create a table that contains all possible values, from "01000" through "99999"
p2099
aVWhen you insert a new customer, use a technique (e
p2100
ag164
aVrandomization) to pick one of the existing rows from that table (your pool of still available customer ID's), and use it, and remove it from the table
p2101
aVAnything else will become really bad over time
p2102
aVImagine you've used up 90% or 95% of your available customer ID's - trying to randomly find one of the few remaining possibility could lead to an almost endless retry of "is this one taken
p2103
aVYes -> try a next one"
p2104
aVMarc
p2105
as(dp2106
g10
V13302
p2107
stp2108
a((dp2109
g2
(lp2110
VWell, that might be a bit tricky since the preferred way of calling WCF services is on a "per-call" basis, e
p2111
ag164
aVyou don't really have anything that's "started" and then just hangs around, really
p2112
aVIf you're hosting your service in IIS or WAS, it's even "on-demand loading" of your service host - when a message arrives, the host is instantiated and handles the request
p2113
aVIf you self-host, you either have a console or Winforms app - so you could hook into there to know when they start
p2114
aVIf you have a Windows service to host your service host, you most likely override the OnStart and OnStop methods on the ServiceBase class --> hook into there
p2115
aVThe question is more: what exactly are you trying to accomplish
p2116
aVJust logging or something like that, or do you want to have something built up in memory to stick around
p2117
aVMarc
p2118
as(dp2119
g10
V13302
p2120
stp2121
a((dp2122
g2
(lp2123
VMike Pone's answer works, because he joins the "Categories" table with the "SuperCategories" table as a "LEFT OUTER JOIN" - this will take all entries from "Categories" and add columns from "SuperCategories" to those where the link exists - where it does not exist (e
p2124
ag164
aVwhere there is no entry in "SuperCategories"), you'll get NULLs for the SuperCategories columns - and that's exactly what Mike's query then checks for
p2125
aVIf you would write the query like so:
p2126
aVyou would get something like this:
p2127
aVSo this basically gives you your answer - all the rows where the ID_Super on the LEFT OUTER JOIN is NULL are those who don't have any entries in the SuperCategories table
p2128
aVAll clear
p2129
aV:-)
p2130
aVMarc
p2131
as(dp2132
g10
V13302
p2133
stp2134
a((dp2135
g2
(lp2136
VHow are you trying to connect
p2137
aVJust a regular ADO
p2138
aVNET connection
p2139
aVIf so, what's your connection string
p2140
aVAre you trying to use SMO (SQL Mgmt Objects)
p2141
aVThis sounds like some of your SMO objects aren't available for some reason - you might want to download and reinstall those SMO components from here
p2142
aVThe files you want are quite a bit down the page, under the heading of "Microsoft SQL Server 2005 Management Objects Collection" - files are called "SQLServer2005_XMO
p2143
aVmsi" (with some x64 variations)
p2144
aVDoes installing that MSI help at all
p2145
aVMarc
p2146
aVPS: okay, thanks, based on your comment - can you try this connection string here:
p2147
as(dp2148
g10
V13302
p2149
stp2150
a((dp2151
g2
(lp2152
VIf you have properties that MUST be set on your object for it to work properly, one way is to expose just a single constructor which requires those mandatory properties as parameters
p2153
aVIn that case, you cannot create your object without specifying those mandatory properties
p2154
aVSomething like that cannot be enforced by object initializers
p2155
aVObject initializers are really just a "syntax convenience" to shorten initial assignments
p2156
aVNice, but not really very functionally relevant
p2157
aVMarc
p2158
as(dp2159
g10
V13302
p2160
stp2161
a((dp2162
g2
(lp2163
VWhat is your back-end database layer look like
p2164
aVIf you're using LINQ (-to-SQL or -to-Entities), you could implement paging through WCF by specifying the page size and the page number you want, and then use LINQ's "Skip" and "Take" operators to fetch the page requested - something roughly like:
p2165
aVand then implement it something like this (simplified):
p2166
aVWould that be helpful for you
p2167
aVMarc
p2168
as(dp2169
g10
V13302
p2170
stp2171
a((dp2172
g2
(lp2173
VIf you're using SQL Server, I would strongly recommend NOT using VARCHAR(8000) or VARCHAR(MAX) for all fields
p2174
aVyou need to let common sense prevail here - make the field as big as you think you'll probably need it, add a little extra for unexpected length, and you're done :-)
p2175
aVAlso, I think it's a good idea to keep it to a few lengths that you use over and over again
p2176
ag1015
ag164
aVI use VARCHAR(255) for most fields like street address or e-mail etc
p2177
aVthat could be a bit longer, VARCHAR(50) for things like phone numbers etc
p2178
aV, and VARCHAR(20) for short strings like zip code and such
p2179
aVBe pragmatic about it - find a style that works for you
p2180
aVDon't over-optimize, but don't go nuts the other way, either
p2181
aVMarc
p2182
as(dp2183
g10
V13302
p2184
stp2185
a((dp2186
g2
(lp2187
VCheck out some of the MANY resources on execution plans on the web, e
p2188
ag164
ag1859
aVExecution plan basics
p2189
aVGraphical execution plans for simple queries
p2190
aVGo to http://www
p2191
aVsimple-talk
p2192
aVcom and search for execution plans - there are many more articles and samples and even a free e-book on execution plans
p2193
aVMarc
p2194
as(dp2195
g10
V13302
p2196
stp2197
a((dp2198
g2
(lp2199
VIf you want to be more or less database-vendor independent, you can use the SQL Standard catalog views called INFORMATION_SCHEMA - they're implemented in SQL Server, MySQL and many other system:
p2200
aVIf you get back a row, the stored proc is still in the system - if not, it's gone
p2201
aVMarc
p2202
as(dp2203
g10
V13302
p2204
stp2205
a((dp2206
g2
(lp2207
VYes, there is a way to create Sandcastle docs inside Visual Studio: DocProject
p2208
aVTo quote the project web site:
p2209
aVDocProject drives the Sandcastle help
p2210
aVgeneration tools using the power of
p2211
aVVisual Studio 2005/2008 and MSBuild
p2212
aVChoose from various project templates
p2213
aVthat build compiled help version 1
p2214
ag2088
aVor 2
p2215
aVx for all project references
p2216
aVDocProject facilitates the
p2217
aVadministration and development of
p2218
aVproject documentation with Sandcastle,
p2219
aVallowing you to use the integrated
p2220
aVtools of Visual Studio to customize
p2221
aVSandcastle's output
p2222
aVMarc
p2223
as(dp2224
g10
V13302
p2225
stp2226
a((dp2227
g2
(lp2228
VYou will definitely have service contracts - a must - in some shape or form
p2229
aVThis just defines your service and the operations (methods) on it (OperationContract)
p2230
aVIf it's an internal "behind-the-firewall" system, you could look at a duplex binding, e
p2231
ag164
aVhave the Master call the Slave, and the Slave report back on a duplex channel when it's done
p2232
aVOut of the box, there's only the WsDualHttpBinding to support duplex, but since you're internal, behind-the-firewall, you might want to look at creating your own TCP-based duplex binding (it's not as hard as it might sound at first
p2233
aVIn this scenario, both involved apps really are server and client at the same time
p2234
aVYou will have DataContracts in some way, shape or form to define the DATA that is being moved around between Master and Slave - so again, yes, you will have to have Data Contracts
p2235
aVEDIT:
p2236
aVOf course, another approach might be to use two MSMQ message queues; the Master drops his "job" request into a queue, which the Slave listens on and picks up the job request
p2237
aVWhen the Slave is done, it in turn drops a response into the response queue to which the Master is a listener, and gets notified of the job being done that way
p2238
aVMarc
p2239
as(dp2240
g10
V13302
p2241
stp2242
a((dp2243
g2
(lp2244
VYou should be able to get your results by doing this:
p2245
aVgives you the option to pick one of the elements, and making the xs:choice appear many times allows you to pick each element as many times as you like
p2246
aVMarc
p2247
as(dp2248
g10
V13302
p2249
stp2250
a((dp2251
g2
(lp2252
VCan you give us a bit more information
p2253
aVWhat kind of binding are you using
p2254
aVWhat does the service config and the client config look like
p2255
aVWhere do you get your data from that gets returned
p2256
aVCould it be the service on the VM just doesn't get any data
p2257
aV(e
p2258
ag164
aVqueries a database that just doesn't have the data requested
p2259
aVMarc
p2260
as(dp2261
g10
V13302
p2262
stp2263
a((dp2264
g2
(lp2265
VYou need to "free" the resident reference from the site - e
p2266
ag164
aVmake it a ResidentID and make sure each ResidentID is globally unique within the Resident table
p2267
aVEvery Site must also have a globally unique SiteID within the Site table
p2268
aVThen and only then will you be able to create a good db schema
p2269
aVThe Residency table will provide the link between residents (identified uniquely by their ResidentID) and the sites (again - uniquely identified by their SiteID)
p2270
aVMarc
p2271
as(dp2272
g10
V13302
p2273
stp2274
a((dp2275
g2
(lp2276
VSearch for "Identifiers" in your SQL Books online, and you should find:
p2277
aVRules for Regular Identifiers
p2278
aVThe rules for the format of regular identifiers depend on the database
p2279
aVcompatibility level
p2280
aVThis level can be set by using sp_dbcmptlevel
p2281
aVWhen the compatibility level is 90, the following rules apply:
p2282
aVThe first character must be one of the following:
p2283
aVA letter as defined by the Unicode Standard 3
p2284
aV2
p2285
aVThe Unicode    definition of letters includes Latin characters from a through z,
p2286
aVfrom A through Z, and also letter characters from other languages
p2287
aVThe underscore (_), at sign (@), or number sign (#)
p2288
aVCertain symbols at the beginning of an identifier have special
p2289
aVmeaning in SQL Server
p2290
aVA regular identifier that starts with the at
p2291
aVsign always denotes a local variable or parameter and cannot be  used
p2292
aVas the name of any other type of object
p2293
aVAn identifier that  starts
p2294
aVwith a number sign denotes a temporary table or procedure
p2295
aVAn
p2296
aVidentifier that starts with double number signs (##) denotes a  global
p2297
aVtemporary object
p2298
aVAlthough the number sign or double number  sign
p2299
aVcharacters can be used to begin the names of other types of objects,
p2300
aVwe do not recommend this practice
p2301
aVSome Transact-SQL functions have names that start with double at signs
p2302
aV(@@)
p2303
aVTo avoid confusion with these functions, you should not use
p2304
aVnames that  start with @@
p2305
aVSubsequent characters can include the following:
p2306
aVLetters as defined in the Unicode Standard 3
p2307
ag2285
aVDecimal numbers from either Basic Latin or other national scripts
p2308
aVThe at sign, dollar sign ($), number sign, or underscore
p2309
aVThe identifier must not be a Transact-SQL reserved word
p2310
aVSQL Server
p2311
aVreserves both the uppercase and lowercase versions of reserved words
p2312
aVEmbedded spaces or special characters are not allowed
p2313
aVSupplementary
p2314
aVcharacters are not allowed
p2315
aVSearch for "delimited identifiers" in your SQL Books online, and you should find:
p2316
aVThe body of the identifier can contain
p2317
aVany combination of characters in the
p2318
aVcurrent code page, except the
p2319
aVdelimiting characters themselves
p2320
aVFor
p2321
aVexample, delimited identifiers can
p2322
aVcontain spaces, any characters valid
p2323
aVfor regular identifiers, and any one
p2324
aVof the following characters
p2325
aVMarc
p2326
as(dp2327
g10
V13302
p2328
stp2329
a((dp2330
g2
(lp2331
VYou might want to check out this three part series by Jon Rista on
p2332
aVNET Configuration on Codeproject:
p2333
aVUnravelling the mysteries of
p2334
aVNET 2
p2335
aV0 configuration
p2336
aVDecoding the mysteries of
p2337
aVNET 2
p2338
aV0 configuration
p2339
aVCracking the mysteries of
p2340
aVNET 2
p2341
aV0 configuration
p2342
aVReally really helpful and very well written indeed
p2343
aVHelped me a whole lot
p2344
as(dp2345
g10
V13302
p2346
stp2347
a((dp2348
g2
(lp2349
VYou will need to retrieve the "memberOf" attribute from your user to get a list of groups he's a direct member of
p2350
aVI say direct because there are nested groups (User being member of Group A, which in turn is member of Group B) and those won't be returned
p2351
aVAlso, the primary group (usually "Users") is not being returned by the "memberOf" attribute either
p2352
aVMarc
p2353
aVPS: If you can use
p2354
aVNET 3
p2355
aV5, there's a newer AD interface exposing users as strongly typed objects - see the excellent article by Joe Kaplan and Ethan Wilansky
p2356
aVThere, you can grab a user and then just call
p2357
aVGetAuthorizationGroups on the user object and you're done
p2358
as(dp2359
g10
V13302
p2360
stp2361
a((dp2362
g2
(lp2363
VThe
p2364
aVElements operation returns a LIST of XElements - but what you really want is a SINGLE element
p2365
aVAdd this:
p2366
aVThis way, you tell LINQ to give you the first (or NULL, if none are there) from that LIST of XElements you're selecting
p2367
aVMarc
p2368
as(dp2369
g10
V13302
p2370
stp2371
a((dp2372
g2
(lp2373
VThere's nothing built-in - but it's easy enough to create:
p2374
aVEDIT : adapted to your special rounding needs :-)
p2375
aVUse the DECIMAL or MONEY data type - whatever suits you best
p2376
aVUse it like this:
p2377
aVWhich gives you 1
p2378
aV50, 1
p2379
aV50, 7
p2380
aV30, 7
p2381
aV40, 7
p2382
aV40 as results
p2383
aVMarc
p2384
as(dp2385
g10
V13302
p2386
stp2387
a((dp2388
g2
(lp2389
VNot really - you can either use C# (or VB
p2390
aVNET) and SMO (SQL Management Objects) to script out your database objects (tables and all), or you can use SQL to get the list of columns for a table:
p2391
aVBut I don't know of any easy way in SQL itself to create Create/Alter scripts for database objects, sorry
p2392
aVMarc
p2393
as(dp2394
g10
V13302
p2395
stp2396
a((dp2397
g2
(lp2398
VFirst off, you would have to use transactional service calls here - and since you have a "initializing" call, a bunch of intermediary calls, and then possibly one to end all the calls, I would recommend you have a look at the "IsInitiating" and "IsTerminating" attributes on the OperationContract for the methods - this will allow you to specify one method to start your session, and one that will finish it
p2399
aVNext, make sure to configure your service as a transactional service by putting the "TransactionFlow" attribute on either the service or all operations - whichever you prefer
p2400
aVIn your client code, you'll have to use System
p2401
aVTransactions to create a TransactionScope, which will wrap your service calls
p2402
aVThis is a lightweight or a fully two-phased distributed transaction coordinator - depending on what your calls do in detail
p2403
aVSomething along those lines:
p2404
aV1) Mark your binding as transactional:
p2405
aV2) Service contract:
p2406
aV3) In your client code:
p2407
aVDoes that help you for the time being to get you started
p2408
aVMarc
p2409
as(dp2410
g10
V13302
p2411
stp2412
a((dp2413
g2
(lp2414
VAs others have already pointed out - when you do a SELECT DISTINCT (typename) over your table, you'll end up with a full table scan no matter what
p2415
aVSo it's really a matter of limiting the number of rows that need to be scanned
p2416
aVThe question is: what do you need your DISTINCT typenames for
p2417
aVAnd how many of your 200M rows are distinct
p2418
aVDo you have only a handful (a few hundred at most) distinct typenames
p2419
aVIf so - you could have a separate table DISTINCT_TYPENAMES or something and fill those initially by doing a full table scan, and then on inserting new rows to the main table, just always check whether their typename is already in DISTINCT_TYPENAMES, and if not, add it
p2420
aVThat way, you'd have a separate, small table with just the distinct TypeName entries, which would be lightning fast to query and/or to display
p2421
aVMarc
p2422
as(dp2423
g10
V13302
p2424
stp2425
a((dp2426
g2
(lp2427
VIf the fields are actually of type XML, then this query will give you what you're looking for:
p2428
aVMarc
p2429
as(dp2430
g10
V13302
p2431
stp2432
a((dp2433
g2
(lp2434
VIf you want to explicitly stop your windows service, just call the
p2435
aVStop() method on your service class
p2436
aVWindows services can be configured to automatically restart on error - so just letting the SqlException flow to the top might not achieve what you want
p2437
aVMarc
p2438
as(dp2439
g10
V13302
p2440
stp2441
a((dp2442
g2
(lp2443
VWhen dealing with datetime strings in SQL Server, I would always use the ISO-8601 date format
p2444
aVwhich should work no matter what language or regional settings you have
p2445
aVTry your select as:
p2446
aVMarc
p2447
as(dp2448
g10
V13302
p2449
stp2450
a((dp2451
g2
(lp2452
VThe temporary tables are defined in "tempdb", and the table names are "mangled"
p2453
aVThis query should do the trick:
p2454
aVMarc
p2455
as(dp2456
g10
V13302
p2457
stp2458
a((dp2459
g2
(lp2460
VActive Directory really doesn't have a concept of a hierarchy in terms of membership
p2461
aVA user is member of one, several, many groups - but just that
p2462
aVHe's member of the "Admin" group - yes or no
p2463
aVHe might also be member of GRoup A, Gropu B, Group F and Group M - but there's no real "role hierarchy" as you're looking for
p2464
aVI guess, in a way, having the ability to just combine any number of group memberships is probably even more flexible and reliable than having a hierarchy, in my opinion
p2465
aVMarc
p2466
as(dp2467
g10
V13302
p2468
stp2469
a((dp2470
g2
(lp2471
VIt will require updating the clustered index, yes - this IS the table data, after all
p2472
aVBut I don't see why any of the non-clustered indices would have to updated - your new column won't be member of any of the non-clustered indices
p2473
aVAlso, I don't see how dropping and recreating the indices would benefit you in this scenario
p2474
aVIf you were bulk-loading several million existing rows from another table or database - yes, then it might be faster (due to the INSERTs being much faster) - but adding a column doesn't really suffer from any indices or constraints being around, I don't think
p2475
aVMarc
p2476
as(dp2477
g10
V13302
p2478
stp2479
a((dp2480
g2
(lp2481
V"idforstackoverflow" is exactly right:
p2482
aVMaster is the "system" database so to speak
p2483
aVModel" on the other hand is the template for new databases
p2484
aVChanges to Model will propagate to new databases when they're created - existing ones are unaffected by those changes
p2485
aVMarc
p2486
as(dp2487
g10
V13302
p2488
stp2489
a((dp2490
g2
(lp2491
VDid you take the up to 15 minutes of time into account that AD requires to propagate changes like that throughout the network
p2492
aVMarc
p2493
as(dp2494
g10
V13302
p2495
stp2496
a((dp2497
g2
(lp2498
VThe "sp_executesql" stored proc expects a single string parameter @statement to execute
p2499
aVYour string is totally out of whack here
p2500
aVyou need to prefix any "fixed" string parts with a N'
p2501
aVto make them Unicode strings, but this is definitely not properly the case here
p2502
aVI think you might want to try this:
p2503
aVDoes this work and do what you expect it to do
p2504
aVExplanation: the N'
p2505
aVdelimits the whole string which contains the SQL statement
p2506
aVAny apostrophe inside that has to be duplicated ("escaped")
p2507
aVI hope I understood your logic correctly
p2508
aVMarc
p2509
as(dp2510
g10
V13302
p2511
stp2512
a((dp2513
g2
(lp2514
VYou could potentially use the DTS (Data Transformation Services) of SQL Server 2000 and just export everything into an Excel sheet, no
p2515
aVMarc
p2516
as(dp2517
g10
V13302
p2518
stp2519
a((dp2520
g2
(lp2521
VEasy - check into the "SQL management objects" SMO that come with SQL Server - nice C# / VB
p2522
aVNET classes and methods to do all of this
p2523
aVSee:  SMO - manage your SQL Server
p2524
aVor:
p2525
aVSQL Server 2005 Database Backup and Restore using C# and
p2526
aVNET 2
p2527
ag334
aVMarc
p2528
as(dp2529
g10
V13302
p2530
stp2531
a((dp2532
g2
(lp2533
VHow many additional properties does a distributor have
p2534
aVjust one or two
p2535
aV--> go with a discriminator
p2536
aVIf you have plenty of new properties: how many of your customers will be distributors
p2537
aVjust a few --> make a separate distributors table with the additional properties
p2538
aVBut if half your customers will be distributors, then it's probably easier to have it all in one table and just have a "customer type" discrimator
p2539
aVMarc
p2540
as(dp2541
g10
V13302
p2542
stp2543
a((dp2544
g2
(lp2545
VOne way would be to have a stored proc that will delete your child records directly on the DB and include it in your EF model; then just call it from your DataContext
p2546
as(dp2547
g10
V13302
p2548
stp2549
a((dp2550
g2
(lp2551
VTry something like this:
p2552
aVTrouble is - this also selects the "id" node :-(
p2553
aVMarc
p2554
as(dp2555
g10
V13302
p2556
stp2557
a((dp2558
g2
(lp2559
VI doubt you could do that - WCF will always have to use its defined endpoints - TCP, HTTP - whatever
p2560
aVI am not aware of any telnet binding or raw connection, as you mention it
p2561
aVFrom my perspective, why not create a service contract for admin purposes and just hit that with HTTP and/or TCP from a console app
p2562
aVSeems easier than trying to "bolt on" something that's not really been thought of
p2563
aVMarc
p2564
as(dp2565
g10
V13302
p2566
stp2567
a((dp2568
g2
(lp2569
VI don't see any  elements in your WSDL - that might be the problem
p2570
aVAlso, are you creating your service from a live URL, or some files on disk
p2571
aVIf you're using "on disk" files: did you also get the "wsdl0" file as referenced in this line here:
p2572
aVMarc
p2573
as(dp2574
g10
V13302
p2575
stp2576
a((dp2577
g2
(lp2578
VYou should also check out Simple-Talk - a neat programming web site on
p2579
aVNET and SQL
p2580
aVThey have excellent articles on many topics, including query plans:
p2581
aVExecution plan basics
p2582
aVGraphical execution plans for simple queries
p2583
aVUnderstanding more complex query plans
p2584
aVHighly recommended
p2585
aVMarc
p2586
as(dp2587
g10
V13302
p2588
stp2589
a((dp2590
g2
(lp2591
VYou should also check out Jon Rista's three-part series on
p2592
aVNET 2
p2593
aV0 configuration up on CodeProject
p2594
aVUnraveling the mysteries of
p2595
aVNET 2
p2596
aV0 configuration
p2597
aVDecoding the mysteries of
p2598
aVNET 2
p2599
aV0 configuration
p2600
aVCracking the mysteries of
p2601
aVNET 2
p2602
aV0 configuration
p2603
aVHighly recommended, well written and extremely helpful
p2604
aVMarc
p2605
as(dp2606
g10
V13302
p2607
stp2608
a((dp2609
g2
(lp2610
VClustered index SCAN scans the whole clustered index (= data table) from beginning to end
p2611
aVClustered index SEEK only scans a (hopefully small) part / section of that index --> much faster
p2612
aVMarc
p2613
as(dp2614
g10
V13302
p2615
stp2616
a((dp2617
g2
(lp2618
VYour mdf file is where your data is stored - it should grow roughly according to your data load
p2619
aVBut as "ck" already pointed out - SQL Server allows you to specify a certain growth pattern, e
p2620
ag164
aVthe mdf file doesn't grow byte by byte whenever you insert a row
p2621
aVSo depending on your setting, it will take "jumps" in size, when it needs more space
p2622
aVThis has nothing to do with whether you load your data with a regular INSERT statement or SqlBulkLoad
p2623
aVMarc
p2624
as(dp2625
g10
V13302
p2626
stp2627
a((dp2628
g2
(lp2629
VSomething like that should do the trick:
p2630
aVMarc
p2631
as(dp2632
g10
V13302
p2633
stp2634
a((dp2635
g2
(lp2636
VMaybe a silly idea : could you schedule a console app to hit your service at e
p2637
ag164
aV5:30am in the morning, so that this request would take a long time to run, and your regular users coming in after that won't have that problem
p2638
aVSure - it's not dealing with the root cause, but for the time being, it might be a useful workaround - no
p2639
aVMarc
p2640
as(dp2641
g10
V13302
p2642
stp2643
a((dp2644
g2
(lp2645
VFields of type CHAR(x) in SQL Server will be padded with spaces to their fixed length, e
p2646
ag164
aVif you have CHAR(20) and you have a date like "2009-04-20" in it, the field will really contain "2009-04-20          " and that might cause trouble when converting to datetime
p2647
aVAlso, if your CHAR field is totally empty, it might not be able to convert to a valid datetime, either
p2648
aVSolutions:
p2649
aVa) You could change the datatype for your columns to VARCHAR(x) and thus get rid of the most likely unnecessary padding:
p2650
aVb) You could make sure to check for empty CHAR(x) field values and not convert those (or pick a default datetime value for those)
p2651
aVc) You could trim the CHAR(x) fields to remove unnecessary padding:
p2652
as(dp2653
g10
V13302
p2654
stp2655
a((dp2656
g2
(lp2657
VYou can definitely do all that in a very basic WCF scenario - if you like, you can do all your setup and configuration in code as opposed to configuration
p2658
aVYou need on the server side:
p2659
aV1) a service contract IMyService that defines the function calls
p2660
aV2) a service implementation MyService that implements that interface
p2661
aV3) a service host that will host your service - this is the part where you'll have to define things like bindings (what protocol to use) and endpoint (what address to use)
p2662
aVYou need on the client side:
p2663
aV1) access to the IMyService interface (put that into its own, separate interface assembly)
p2664
aV2) Create a ChannelFactory
p2665
aV3) Have the channel factory give you a channel to communicate with the service
p2666
aVThis can all be done in code - no external config to speak of
p2667
aVAaron Skonnard of Pluralsight has had a great series of 5-15min
p2668
aVscreen casts on how to create your WCF services - usually showing both how to do it in code, as well as how to do it with config
p2669
aVThe show "Endpoint
p2670
aVTV" on Channel 9 was actually intermixed with workflow stuff, too - but you should be able to find the basic WCF screencasts in there, too
p2671
aVCheck it out
p2672
aVMarc
p2673
aVPS: If you're serious about learning about WCF (and I would definitely recommend that
p2674
aV, you should check out Michle Leroux Bustamante's book Learning WCF - A Hands On Guide - highly recommended
p2675
as(dp2676
g10
V13302
p2677
stp2678
a((dp2679
g2
(lp2680
VNo, I don't think you can do that with attributes
p2681
aVYou could wrap two  into a  - but for attributes, there's no equivalent construct, I'm afraid
p2682
aVMarc
p2683
as(dp2684
g10
V13302
p2685
stp2686
a((dp2687
g2
(lp2688
VMicrosoft was at one point telling programmers not to inherit directly from Exception, but instead to use ApplicationException as their base class
p2689
aVNot sure if that opinion still holds true, though
p2690
aVAnd if a pre-defined exception already exists that covers your exact error condition (like "NullReferenceException", or "InvalidArgumentException" etc
p2691
aV- by all means, throw those instead of re-inventing them inside your own code
p2692
aVMarc
p2693
as(dp2694
g10
V13302
p2695
stp2696
a((dp2697
g2
(lp2698
VYes, there's an event hook on the SqlCommand object called SqlInfoMessage, which you can hook into:
p2699
aVThe event handler will look like this:
p2700
aVThe "e
p2701
aVMessage" is the message printed out to the message window in SQL Server Mgmt Studio
p2702
aVMarc
p2703
as(dp2704
g10
V13302
p2705
stp2706
a((dp2707
g2
(lp2708
VWhat is your SQL 2008 installation instance called
p2709
aVWhat does your connection string for the membership provider look like
p2710
aVAs far as I know, there is (or was) a glitch in the SQL Server 2008 Express installation that even if you chose to install as "default" instance, it would still make it a "named instance" called "
p2711
aV\u005cSQLExpress" instead
p2712
aVCould that be the problem
p2713
aVMarc
p2714
as(dp2715
g10
V13302
p2716
stp2717
a((dp2718
g2
(lp2719
VUsing SMO, you could do this:
p2720
aVMarc
p2721
as(dp2722
g10
V13302
p2723
stp2724
a((dp2725
g2
(lp2726
VThere are two "sys" catalog views you can consult:
p2727
aVThose will give you just about any info you could possibly want about indices and their columns
p2728
aVEDIT: okay, how about this query
p2729
aVIt's getting pretty close to what you're looking for, right
p2730
as(dp2731
g10
V13302
p2732
stp2733
a((dp2734
g2
(lp2735
VCheck out this article - it shows in great detail how the filestream operations with SQL Server 2008 work
p2736
aVMarc
p2737
as(dp2738
g10
V13302
p2739
stp2740
a((dp2741
g2
(lp2742
VI would recommend changing that datatype to VARCHAR(50) - up to about 10 characters, the CHAR(x) might make sense since it's a tad faster and has less overhead - but with 50 characters, unless all the columns are fully used up to 50 chars, this is a major overhead, especially since this column is also used in indices
p2743
aVChanging it to VARCHAR(50) would possibly quite significantly reduce the space needed for the table (depending on your amount of data and how much of the 50 chars are really used), and all the indices involved would also get a lot smaller - plus you wouldn't need this COALESCE, LTRIM, RTRIM stuff anymore :-)
p2744
aVMarc
p2745
as(dp2746
g10
V13302
p2747
stp2748
a((dp2749
g2
(lp2750
VIf you want to check out the WCF webservice world (and I would definitely recommend that), go check out Aaron Skonnard's many-parts intro at "Endpoint TV" on Channel9:
p2751
aVhttp://channel9
p2752
aVmsdn
p2753
aVcom/shows/Endpoint/
p2754
aVHe has a lot of intro screencast tutorials from very basic to fairly advanced, he covers all of WCF, even the latest greatest REST interfaces and stuff - highly recommended
p2755
aVMarc
p2756
as(dp2757
g10
V13302
p2758
stp2759
a((dp2760
g2
(lp2761
VIt's actually beneficial to leave the dbo
p2762
aVprefix in place - after all, in SQL Server, you could have several schemas (the "dbo
p2763
aVthingie) with the same table name, e
p2764
ag164
aVdbo
p2765
aVMyTable, joe
p2766
aVMyTable, frank
p2767
aVMyTable
p2768
aVIf you then issue a SELECT (list of fields) FROM MyTable, SQL Server has to first figure out which of the "MyTable" tables you really mean --> this costs time, specifying right off the bat you want "dbo
p2769
aVMyTable" will SAVE you time
p2770
aVOK, not a lot on a single query - but SELECT queries are QUITE frequent and it all adds up
p2771
aVMarc
p2772
as(dp2773
g10
V13302
p2774
stp2775
a((dp2776
g2
(lp2777
VWell, the benefit is - it's somewhat "generic" - depending on what gets passed in
p2778
aVBut that's its biggest weakness too, at the same time
p2779
aVSince it's so generic and all-purpose, you can't really enforce a lot of constraints and/or validity checks, really
p2780
aVI've seen this approach in many places - web services, database schemas - and they usually work fine for two or three separate "things" but begin to fall apart the more complex they get
p2781
aVI would strongly recommend creating specific, well-checked methods for each thing you want to do
p2782
aVMarc
p2783
aVPS: also - extending an existing service with additional methods while not changing any of the existing interfaces can be done very easily and without any change to the clients, too - so you can always easily extend your service as your requirements grow, without breaking backwards compatibility
p2784
as(dp2785
g10
V13302
p2786
stp2787
a((dp2788
g2
(lp2789
VYou cannot create a column at a specific ordinal location in the table structure - plus, why would you want to
p2790
aVThe order of the columns in SQL Server is totally irrelevant
p2791
aVSQL Server Management Studio has a design view which seemingly allows you to create a column at any location in the list of columns - but what really happens here in the background is that the new table with the new columns gets created and the old one gets dropped
p2792
aVThere are no SQL DDL commands to create a column at a specific location or to "reorder" columns
p2793
aVIt's really not needed
p2794
aVMarc
p2795
as(dp2796
g10
V13302
p2797
stp2798
a((dp2799
g2
(lp2800
VJohn Saunders has it almost right :-)
p2801
aVThis works for me (SQL Server 2005 and 2008)
p2802
aVMarc
p2803
as(dp2804
g10
V13302
p2805
stp2806
a((dp2807
g2
(lp2808
VIt means : return the first value (e
p2809
ag164
aV"formsAuth") if it's NOT NULL, or else the second value (new FormsAuthenticationService()):
p2810
aVMarc
p2811
as(dp2812
g10
V13302
p2813
stp2814
a((dp2815
g2
(lp2816
VCheck out the free Actipro CodeHighlighter for ASP
p2817
aVNET - it can neatly display XML and other formats
p2818
aVOr are you more interested in actually formatting your XML
p2819
aVThen have a look at the XmlTextWriter - you can specify things like Format (indenting or not) and the indent level, and then write out your XML to e
p2820
ag164
aVa MemoryStream and read it back from there into a string for display
p2821
aVMarc
p2822
as(dp2823
g10
V13302
p2824
stp2825
a((dp2826
g2
(lp2827
VASP
p2828
aVNET webservices is OKAY - but it's limited to HTTP hosted in IIS only, and has other problems
p2829
aVWCF supports way more transport protocols (HTTP in various ways, TCP, MSMQ and more), has a lot richer security model (credentials, federated security), and offer options for hosting - self-hosting in a Windows app or service, in IIS or WAS and more
p2830
aVIn short: if you're starting now - go learn WCF by all means
p2831
aVMarc
p2832
as(dp2833
g10
V13302
p2834
stp2835
a((dp2836
g2
(lp2837
VWell, I finally got it working - with a bit of help from everyone who responded, and by consulting some of the WiX tutorials and help pages out there on the web
p2838
aVMSI installer stuff isn't easy to figure out and learn
p2839
aVBasically, I changed execution of my custom action to "deferred" (as suggested by Rob) and I moved the point in the sequence where it gets executed to "After=InstallFiles"
p2840
aVI also changed the condition in the  tag to "NOT Installed" which seems to work just fine in my scenario
p2841
aVContrary to Rob's fear, the Db Update Manager and its UI come up quite nicely this way, and the process of updating our database is now completed before any of our services (that depend on the database) get started
p2842
aVLooking forward to a full RTM release of WiX 3
p2843
aV0 (and its future)
p2844
aVThanks to everyone - unfortunately, I could only accept one answer - all would have deserved it
p2845
aVMarc
p2846
as(dp2847
g10
V13302
p2848
stp2849
a((dp2850
g2
(lp2851
VKeeping databases in sync and up to date is hard - luckily, there are quite a few tools to help
p2852
aVAs many folks have mentioned, there's a slew of good "SQL Diff" tools that allow you to take a difference snapshot between two versions of your database
p2853
aVAlso, Red-Gate has a "SQL Packager" tool which allows you to package up the difference between version A and version A+1 of your database into a stand-alone EXE, or a C# project or a SQL script - whichever works for you
p2854
aVWith this, you could easily package up a "upgrade my database from v1 to v2" EXE file in your install and run it to handle the updates
p2855
aVA fairly more complete, holistic approach to the whole story of DB update management is the DB Ghost product line by Innovartis in the UK
p2856
aVIt's really more of a mindset and tools to support it
p2857
aVI like the approach - each dev works on his own local DB copy, checks in any changes to the database into a source control system
p2858
aVWhen a release to TEST or PROD is due, a release master can grab the latest "SQL source" from the source control system and generate a stand-alone EXE to create that database from scratch, or upgrade an existing one to that new version
p2859
aVIt looks all very slick and convincing (at least to me), but you'll have to sell your boss on the whole idea - seems like a "either believe in it or not" kinda story
p2860
aVBut definitely worth checking out
p2861
aVMarc
p2862
as(dp2863
g10
V13302
p2864
stp2865
a((dp2866
g2
(lp2867
VYou can consult the two system catalogs sys
p2868
aVserver_principals to check for server logins, or sys
p2869
aVdatabase_principals in your specific database for users of your database:
p2870
aVMarc
p2871
as(dp2872
g10
V13302
p2873
stp2874
a((dp2875
g2
(lp2876
VYou can query the "sys
p2877
aVsql_modules" catalog view to find the SQL source code for your stored procs and stored funcs:
p2878
aVMarc
p2879
as(dp2880
g10
V13302
p2881
stp2882
a((dp2883
g2
(lp2884
VYou cannot - plain and simple
p2885
aVThe attribute are needed for the DataContractSerializer to pick up which elements to serialize
p2886
aVIn contract  to the XmlSerializer, which basically just serializes everything (unless you explicitly tell it to ignore it), the DataContractSerializer is "opt-in" - you have to explicitly tell it (by means of the attributes) which fields and/or properties to serialize
p2887
aVUPDATE: As several folks have pointed out, with
p2888
aVNET 3
p2889
aV5 SP1, Microsoft loosened those rules up a bit - any public read/write property will be serialized automatically by the DataContractSerializer
p2890
aVAt the same time, your class also needs to have a parameterless default constructor - sounds like the exact requirements we had for XmlSerializer way back when
p2891
aVOf course, this:
p2892
aVdoesn't allow you to serialize something private - if you want to serialize it, you have to expose it as public read/write property
p2893
aVdoesn't allow you to specify a defined chosen ordering of the parameters - it will just use them in the order they appear in the class
p2894
aVnow requires you to have a parameterless constructor in your class again for deserialization
p2895
aVI still think these thing ought to be explicit and clear, making those no longer required opens up the path for lazy/sloppy programming - I don't like it
p2896
aVBut if you want to, you can use it now without explicitly marking your properties with [DataMember]
p2897
aVMarc
p2898
as(dp2899
g10
V13302
p2900
stp2901
a((dp2902
g2
(lp2903
VI don't think any final word has been said on this, but based on the fact that VS2010 seems to be a major rewrite (all the code editor stuff is WPF-based), the fact that MEF is being introduced as its extensibility model, and based on experience with earlier VS upgrades, I would highly doubt that all your plugins will just keep working
p2904
aVsome might - but a lot of them will require an upgrade, I'm afraid
p2905
aVMarc
p2906
as(dp2907
g10
V13302
p2908
stp2909
a((dp2910
g2
(lp2911
VYou could possibly declare a [MessageContract] and define a header in there, which your Silverlight app could set to a known, defined value
p2912
aVMarc
p2913
as(dp2914
g10
V13302
p2915
stp2916
a((dp2917
g2
(lp2918
VYou might want to have a look at Active Directory Lightweight Directory Services (AD LDS) - formerly known as AD/AM (Active Directory/Application Mode)
p2919
aVIt basically allows you to create an AD instance on a dev box and program against it almost as if it were a full-blown AD
p2920
aVHowever: AD LDS cannot be used to authenticate users - so maybe that won't really be helpful in your scenario then :-(
p2921
aVMarc
p2922
as(dp2923
g10
V13302
p2924
stp2925
a((dp2926
g2
(lp2927
VYou could check out some articles on CodeProject on the topic and maybe use one of those tools / component for your needs
p2928
aVUniversal Database Admin for ASP
p2929
aVNET and SQL Server (Reloaded)
p2930
aVASP
p2931
aVNET Database Admin Control
p2932
aVWeb SQL Utility
p2933
aVMost of those come with full source and could also serve you as a starting point for a custom version of your own
p2934
aVMarc
p2935
as(dp2936
g10
V13302
p2937
stp2938
a((dp2939
g2
(lp2940
VIf you need to run your service only once or twice a day (or even only once a week), I'd create a console app and schedule it to run at these chosen times using Windows "Scheduled Tasks"
p2941
aVThat way, only the Windows system itself will be checking whether or not the "right" time was already arrived to wake up your service and do the processing
p2942
aVIf you have a service that needs to run around the clock and e
p2943
ag164
aVonly process messages during a given window of time, then a Windows (NT) Service might be your choice, which runs in the background, runs on a server without a user being logged on, and can do all sorts of things, like check the time to see whether or not it needs to work, and if not, it can keep on sleeping on :-)
p2944
aVFrom my experience, services are a bit trickier to program and to debug - if you can package your logic into a standalone console app and run it as scheduled tasks, I'd prefer that solution
p2945
aVIt's easier and still does the trick nicely
p2946
aVMarc
p2947
as(dp2948
g10
V13302
p2949
stp2950
a((dp2951
g2
(lp2952
VIf you can't set the [DataContract] and [DataMember] attributes on your object, you'll have to find a way to expose them using the XmlSerializer
p2953
aVYou can define a service or an operation to use the XmlSerializer by specifying the [XmlSerializerFormat] attribute on either your Service contract, or an individual OperationContract
p2954
aVDoes that help maybe
p2955
aVMarc
p2956
as(dp2957
g10
V13302
p2958
stp2959
a((dp2960
g2
(lp2961
VCan you tell us what values exactly you're sending into the
p2962
aVThe creation of the PrincipalContext seems to be just fine, and if it can validate the user credentials, your connection should be fine, too
p2963
aVQuite possibly there's something wrong with the parameters being passed into FindByIdentity
p2964
aVMarc
p2965
as(dp2966
g10
V13302
p2967
stp2968
a((dp2969
g2
(lp2970
VYou cannot - svcutil cannot know that MyAbstract class is abstract
p2971
aVThe metadata that's being exchanged between server and client just doesn't support such a concept
p2972
aVThe SOA world doesn't always support everything the OO world has in store
p2973
aVThe service metadata only knows about things like services, method calls, and data contracts - anything else is not part of the service metadata
p2974
aVYou will need to add some extra logic and tweaking to the client code, once it's been creating, if that's a real requirement on your side
p2975
aVMarc
p2976
as(dp2977
g10
V13302
p2978
stp2979
a((dp2980
g2
(lp2981
VNo, there are no compelling reasons to use sys
p2982
aVobjects directly
p2983
aVAs a matter of fact, use of these sys views is being discouraged - so if you can avoid it, do so
p2984
aVInstead, INFORMATION_SCHEMA schema views are supposed to be used where possible - this is a standard SQL-92 mechanisms for exposing metadata about your server (rather than a Microsoft-specific way of using the sys
p2985
aV* views)
p2986
aVMarc
p2987
as(dp2988
g10
V13302
p2989
stp2990
a((dp2991
g2
(lp2992
VI'm pretty sure this will work, yes - it does in MS SQL Server anyway
p2993
aVHowever, this index doesn't help you if you need to select on just the date, e
p2994
ag164
aVa date range
p2995
aVIn that case, you might need to create a second index on just the date to make those queries more efficient
p2996
aVMarc
p2997
as(dp2998
g10
V13302
p2999
stp3000
a((dp3001
g2
(lp3002
VOne possible approach would be to "externalize" certain parts of your  configuration into external files, one per environment
p3003
ag1015
ag164
aVwe have "bindings
p3004
aVdev
p3005
aVconfig" and "bindings
p3006
aVtest
p3007
aVconfig", which we then reference in our main web
p3008
aVconfig like this:
p3009
aVThat way, all you need to change from DEV to PROD is this one line of config XML
p3010
aVBasically, in
p3011
aVNET 2
p3012
aV0 config, any configuration element can be "externalized"
p3013
aVYou cannot however externalize configGroups (such as "system
p3014
aVserviceModel") directly - you have to be on the "configuration element" level
p3015
aVMarc
p3016
aVEDIT: OK, so NO config edit changes to switch between environments
p3017
aVIn that case, you probably have to dream up a naming scheme, e
p3018
ag164
aVname your bindings, behaviors and endpoints in such a way, that you can distinguish them at runtime
p3019
aVSomething like:
p3020
aVthat way, you could build up the name of the element you want (e
p3021
ag164
aVbinding "Default_PROD") from your code and the environment you're running in, and then grab the according config from the config file which contains all the config settings for all environments
p3022
as(dp3023
g10
V13302
p3024
stp3025
a((dp3026
g2
(lp3027
VHave you had a look at the great WiX Tutorial which has a UI page here
p3028
aVAs far as I remember, there UI sample which you can download from there has a bunch of UI dialogs in it
p3029
aVNot sure if it's the "complete" and ultimate list - but certainly quite a nice list, if I recall correctly
p3030
aVEDIT: really seems awfully hard to find a complete list of those dialogs
p3031
aVHey Rob - if you read this - this would be a GREAT addition to your WiX Help file and FAQ on wix
p3032
aVsourceforge
p3033
aVnet
p3034
aVI couldn't even find anything in the source at all
p3035
aVBut digging up some code I had, some time, I must have found a "WiXUI
p3036
aVwxi" fragment file, since I tweaked the list of dialogs to remove the "License agreement" dialog
p3037
aVOther than that, my list here should be complete, I think:
p3038
aVOf course, the order in which these dialogs appear, is controlled by the "UI sequences" in your install
p3039
aVMarc
p3040
as(dp3041
g10
V13302
p3042
stp3043
a((dp3044
g2
(lp3045
VJust how "auto"-update does it have to be
p3046
aV:-)
p3047
aVWe use WiX (2
p3048
aV0) for an app that needs to be installed over and over again
p3049
aVAs long as you go with "major upgrades" from version to version, that works just fine - you can uninstall the old version and then re-install the new one - no major problems here
p3050
aVThe key is to have a stable "UpgradeCode" (a GUID in your WiX) that never changes - it's the key for your app - and to have a new ProductCode for every release
p3051
aVThen, in your wxs file, you need two bits:
p3052
aVThat should do it
p3053
aVOther than that - nothing really much to say - it just works :-)
p3054
aVMarc
p3055
as(dp3056
g10
V13302
p3057
stp3058
a((dp3059
g2
(lp3060
VHow about this:
p3061
aVThat should do it
p3062
aVFor more details on how to deal with XML in SQL Server 2005 and up, I keep going back to this article at 15 seconds which shows really nicely how to insert, modify, and delete XML fragments inside your SQL server fields, using XML DML statements
p3063
aVMarc
p3064
as(dp3065
g10
V13302
p3066
stp3067
a((dp3068
g2
(lp3069
VYou could also check out the "ServiceThrottling" behavior, which allows you to specify on the server side how many concurrent instances, concurrent calls and concurrent sessions you want to support - set them all to 1, and you should have your behavior
p3070
aVMarc
p3071
as(dp3072
g10
V13302
p3073
stp3074
a((dp3075
g2
(lp3076
VJust as a general observation and not based on any practical experience with Linq-To-Entities (yet): having four nested subqueries inside a single query doesn't look like it's awfully efficient and speedy to begin with
p3077
aVI think your very broad statement about the (lack of) quality of the SQL generated by Linq-to-Entities is not warranted - and you don't really back it up by much evidence, either
p3078
aVSeveral well respected folks including Rico Mariani (MS Performance guru) and Julie Lerman (author of "Programming EF") have been showing in various tests that in general and overall, the Linq-to-SQL and Linq-to-Entities "engines" aren't really all that bad - they achieve overall at least 80-95% of the possible peak performance
p3079
aVNot every
p3080
aVNET app dev can achieve this :-)
p3081
aVIs there any way for you to rewrite that query or change the way you retrieve the bits and pieces that make up its contents
p3082
aVMarc
p3083
as(dp3084
g10
V13302
p3085
stp3086
a((dp3087
g2
(lp3088
VThe only other way (other than using fulltext indexing) you could improve performance is to use "LIKE ABC%" - don't add the wildcard on both ends of your search term - in that case, an index could work
p3089
aVIf your requirements are such that you have to have wildcards on both ends of your search term, you're out of luck
p3090
aVMarc
p3091
as(dp3092
g10
V13302
p3093
stp3094
a((dp3095
g2
(lp3096
VI don't have a ready-made answer for your particular scenario - but just a question: have you checked out ADO
p3097
aVNET Data Services (f
p3098
ag5
aVa
p3099
aV"Astoria")
p3100
aVThey're built on top of Entity Framework, WCF's RESTful interface, and they offer a client-side experience, plus they also seem to have a decent story for not just querying, but also updating, inserting records into databases
p3101
aVCould this be an option
p3102
aVCheck them out on MSDN, at David Hayden's blog, on Channel9, or see some of the excellent sessions at MIX08 and MIX 09
p3103
aVMarc
p3104
as(dp3105
g10
V13302
p3106
stp3107
a((dp3108
g2
(lp3109
VMichele Leroux Bustamante also has a great site accompanying her book "Learning WCF" at http://www
p3110
aVthatindigogirl
p3111
aVcom
p3112
aVI really learned a lot of useful information about WCF from her 15-part MSDN screencast series "WCF Top to Bottom"
p3113
aVYou can get links to all webcasts online from here:
p3114
aVhttp://www
p3115
aVdasblonde
p3116
aVnet/WCFWebcastSeries
p3117
aVaspx
p3118
aVHighly recommended
p3119
aVMarc
p3120
as(dp3121
g10
V13302
p3122
stp3123
a((dp3124
g2
(lp3125
VIf you want to or have to adhere to the MSI standard installs for the Windows platform, I'd second Martin Peck's recommendation for WiX
p3126
aVIt's basically the same technology the VS-setup projects and Installshield use - with all its pros and cons
p3127
aVIf you do not need to be on the MSI train, you could also look at simpler alternatives - my favourite here would be InnoSetup
p3128
aVIt's free, it's totally easy to use, it's open source (Pascal/Delphi), it can install your apps in a fraction of a second, it JUST WORKS
p3129
aV:)
p3130
aVMarc
p3131
as(dp3132
g10
V13302
p3133
stp3134
a((dp3135
g2
(lp3136
VWell it's clear you're not getting any space back
p3137
aV:-)
p3138
aVWhen you changed your text fields to CHAR(60), they are all filled up to capacity with spaces
p3139
aVSo ALL your fields are now really 60 characters long
p3140
aVChanging that back to VARCHAR(60) won't help - the fields are still all 60 chars long
p3141
aVWhat you really need to do is run a TRIM function over all your fields to reduce them back to their trimmed length, and then do a database shrinking
p3142
aVAfter you've done that, you need to REBUILD your clustered index in order to reclaim some of that wasted space
p3143
aVThe clustered index is really where your data lives - you can rebuild it like this:
p3144
aVBy default, your primary key is your clustered index (unless you've specified otherwise)
p3145
aVMarc
p3146
as(dp3147
g10
V13302
p3148
stp3149
a((dp3150
g2
(lp3151
VYes, you should be able to do this, as long as you can get Delphi 2007 to communicate with the Windows named pipes
p3152
aVHere's an article at Delphi 3000 about how to use Delphi to communicate with named pipes, including some code samples
p3153
aVSince named pipes are a basic core feature of Windows NT/XP/Vista, Delphi should be able to communicate with those no problem (reading + writing)
p3154
aVDoes that help at all
p3155
aVMarc
p3156
as(dp3157
g10
V13302
p3158
stp3159
a((dp3160
g2
(lp3161
VYes, you can - even with a "website"
p3162
aVWhat you need to do is add the "Web Deployment Project" and set it up so it will grab all the files from the website, compile them, and using something like WiX, you can create an installer for the files to be able to easily deploy your web site and all its files needed to a customer's computer
p3163
aVMarc
p3164
as(dp3165
g10
V13302
p3166
stp3167
a((dp3168
g2
(lp3169
VThe GetSchema call of DbConnection unfortunately doesn't retrieve the DB owner for you :-(
p3170
aVBut you can try this on SQL Server:
p3171
aVIf you want to connect to SQL Server from
p3172
aVNET, you could use the SMO (SQL Management Objects) and find your owner like this:
p3173
aVMarc
p3174
as(dp3175
g10
V13302
p3176
stp3177
a((dp3178
g2
(lp3179
VFrederik sums it up nicely, and that's really what Kimberly Tripp also preaches: the clustering key should be stable (never changes), ever increasing (IDENTITY INT), small and unique
p3180
aVIn your scenario, I'd much rather put the clustering key on the BIGINT column rather than the VARCHAR(80) column
p3181
aVFirst of all, with the BIGINT column, it's reasonably easy to enforce uniqueness (if you don't enforce and guarantee uniqueness yourself, SQL Server will add a 4-byte "uniquefier" to each and every one of your rows) and it's MUCH smaller on average than a VARCHAR(80)
p3182
aVWhy is size so important
p3183
aVThe clustering key will also be added to EACH and every one of your non-clustered indexes - so if you have a lot of rows and a lot of non-clustered indexes, having 40-80 byte vs
p3184
aV8 byte can quickly make a HUGE difference
p3185
aVAlso, another performance tip: in order to avoid the so-called bookmark lookups (from a value in your non-clustered index via the clustering key into the actual data leaf pages), SQL Server 2005 has introduced the notion of "included columns" in your non-clustered indexes
p3186
aVThose are extremely helpful, and often overlooked
p3187
aVIf your queries often require the index fields plus just one or two other fields from the database, consider including those in order to achieve what is called "covering indexes"
p3188
aVAgain - see Kimberly Tripp's excellent article - she's the SQL Server Indexing Goddess
p3189
aV:-) and she can explain that stuff much better than I can
p3190
aVSo to sum it up: put your clustering key on a small, stable, unique column - and you'll do just fine
p3191
aVMarc
p3192
as(dp3193
g10
V13302
p3194
stp3195
a((dp3196
g2
(lp3197
VI think you need to add just one line of code to make it work:
p3198
aVMarc
p3199
as(dp3200
g10
V13302
p3201
stp3202
a((dp3203
g2
(lp3204
VWhen dealing with dates in SQL Server, the ISO-8601 format is probably the best way to go, since it just works regardless of your language and culture settings
p3205
aVIn order to INSERT data into a SQL Server table, you don't need any conversion codes or anything at all - just specify your dates as literal strings
p3206
aVand you're done
p3207
aVIf you need to convert a date field to ISO-8601 format on SELECT, you can use conversion code 126 or 127 (with timezone information) to achieve the ISO format
p3208
aVshould give you:
p3209
aVMarc
p3210
as(dp3211
g10
V13302
p3212
stp3213
a((dp3214
g2
(lp3215
V will allow 0 digits after the decimal point
p3216
aVUse something like  instead that should do just fine
p3217
aVThat gives you a total of 18 digits, 4 of which after the decimal point (and 14 before the decimal point)
p3218
as(dp3219
g10
V13302
p3220
stp3221
a((dp3222
g2
(lp3223
VOK, so you have a complete IGreatService interface with lots of methods, which are implemented on a MyGreatService class
p3224
aVHow about this: you create a new, second interface IMyServiceB which has only those few methods you want to expose to the second group of users
p3225
aVYou make it so your service implements both IGreatService and IMyServiceB (that's absolutely possible, no problem):
p3226
aVService B basically then just calls those few methods in the service implementation that you want to expose - let's say, you have MethodA on IGreatService that you want to expose on IMyServiceB as well (as MethodB) - implement it like that:
p3227
aVThat way, you get two separate interfaces (= services), but basically you write your code only once
p3228
aVYou can then expose IMyServiceB on a distinct and separate endpoint, so that users who are supposed to only see IMyServiceB can just connect to that separate endpoint, and they'll only get whatever they need to use your service-B operations
p3229
aVCould that work
p3230
aVMarc
p3231
as(dp3232
g10
V13302
p3233
stp3234
a((dp3235
g2
(lp3236
VAnother one besides the excellent Red-Gate SQL Compare is ApexSQL's SQL Diff
p3237
aVApexSQL also has a SQL Data Diff if you also need to compare and synchronize data from various sources
p3238
aVHighly recommended
p3239
aVMarc
p3240
as(dp3241
g10
V13302
p3242
stp3243
a((dp3244
g2
(lp3245
VLinq to Entities (the Entity Framework) is a lot more complex than Linq-To-SQL - but it's more complex because it allows a lot more flexibility
p3246
aVIn Linq-to-SQL, you basically get a 1:1 mapping between database tables and your
p3247
aVNET classes in memory
p3248
aVThat's fine for a lot of simpler scenarios, and that's where Linq-to-SQL really shines
p3249
aVBut in larger, more complex enterprise scenarios, this might not be sufficient
p3250
aVThe Entity Framework and thus Linq-to-Entities allows you to have a separate conceptual model (your
p3251
aVNET objects) that is not necessarily tied to your database structure on a 1:1 basis (inheritance, merging multiple tables into a single object and more of those)
p3252
aVWhile this may sound too complicated and too complex, in many advanced scenarios, this is a life-saver and a must-have-feature
p3253
aVSo I don't think you can compare Linq-to-SQL and Linq-to-Entities (the EF) against one another - they're really made for different, separate problem spaces, with different requirements and thus also different approaches / styles of programming
p3254
aVIf Linq-To-SQL is good enough for you and your requirements - great - use it, by all means
p3255
aVMarc
p3256
as(dp3257
g10
V13302
p3258
stp3259
a((dp3260
g2
(lp3261
VYes, AddToUsers only adds your object into the in-memory entity context - it isn't saved on disk just yet, and thus your new identity value hasn't been assigned yet
p3262
aVOnly calling
p3263
aVSaveChanges() will actually write the changes to the database - and then and only then, the identity value (if your field is of type INT IDENTITY) will get generated
p3264
aVMarc
p3265
as(dp3266
g10
V13302
p3267
stp3268
a((dp3269
g2
(lp3270
VYour service implementation is just a
p3271
aVNET class - you need to have a runtime environment for it, so it can be executed somehow
p3272
aVThat's what the ServiceHost is for - it will load your service class, set up the endpoints and channel listeners and all that stuff, and thus give your service class an "ecosystem" to live and operate in
p3273
aVYou can either instantiate a ServiceHost class yourself in a console app, a Windows service, or even a Winforms app, and thus make your WCF service class available to the outside world - or you can delegate that work to IIS or WAS
p3274
aVEven IIS or WAS will use a ServiceHost to host your WCF service - they just do it automagically behind the scenes, and "on demand" - whenever a request for your WCF service comes in
p3275
aVMarc
p3276
as(dp3277
g10
V13302
p3278
stp3279
a((dp3280
g2
(lp3281
VAs a general rule of thumb: if the circumstances do not allow you to complete the request successfully, throw an exception
p3282
aVIf you want to communicate back other information, such as an order number etc
p3283
aVthen use a return value
p3284
aVIt is not generally a good idea to signal back a complete failure via a boolean return value - that could be ignored / not checked by the caller
p3285
aVNow since it's a WCF service that is being used by outside sources, you shouldn't just throw an exception - that's a
p3286
aVNET specific thing - but rather throw a SOAP fault
p3287
aVYou should declare these faults as part of your service contract on every operation your service offers, by adding one or more FaultContract attribute to your operations:
p3288
aVYou can do this easily in
p3289
aVNET WCF by throwing a FaultException or a more specific FaultException (a generic variant in which you can specify the exakt type of fault)
p3290
aVMarc
p3291
as(dp3292
g10
V13302
p3293
stp3294
a((dp3295
g2
(lp3296
VWCF packages up its WSDL and XSD (XML schema to describe the data being sent around) into various pieces, as you've already noticed
p3297
aVThose are referenced from your main WSDL with additional href's
p3298
aVOr even better: you can run the "svcutil -metadata" command on the command line against the DLL or EXE which contains your service implementation - this will create all the needed files (typically several WSDl and several XSD) in the directory where you run the svcutil command
p3299
aVThat's usually a more reliable way than piecing together the WSDL and XSD files from the
p3300
aVwsdl URL  (you usually end up missing one or two files)
p3301
aVMarc
p3302
as(dp3303
g10
V13302
p3304
stp3305
a((dp3306
g2
(lp3307
VLet's assume you have an employee table like so:
p3308
aVYou would have the primary clustered key on EmployeeID, and possibly a non-clustered key on (LastName,FirstName) in order to be able to find employees by name
p3309
aVNow if you need to find "Joe Murphy" and retrieve his hire date and salary, what happens is an index seek in your name-based non-clustered key (which is good), but then in order to fetch the hire date and salary, SQL Server needs to do a so-called bookmark lookup into the actual table data to get the record for Joe Murphy
p3310
aVThis will most likely incur one or several physical disk accesses (which is bad in terms of performance)
p3311
aVHOWEVER: if your name-based non-clustered index also specifies "INCLUDE (HireDate, Salary)":
p3312
aVthen SQL Server is done once it's looked up Joe Murphy in the non-clustered name index --> all the fields to satisfy your query are in the non-clustered index, so there's no more need to do a disk-intensive bookmark lookup and your queries will be potentially much faster
p3313
aVThe downside of INCLUDE columns are increased disk-space need by non-clustered indexes, since they will have the included columns in their leaf-level nodes
p3314
aVIt's a trade-off between speed and size (as usual)
p3315
aVMarc
p3316
as(dp3317
g10
V13302
p3318
stp3319
a((dp3320
g2
(lp3321
VThere are plenty of database schemas out there, I'd say
p3322
aVSQL Server 7/2000 schipped with "pubs" and "Northwind" which you can still download from CodePlex
p3323
aVSQL Server 2005 shipped with AdventureWorks, which is quite extensive and available in various versions (OLTP, OLAP, Light) - also available from CodePlex
p3324
aVMany bloggers have sample databases they use for their blogs and their screencasts, e
p3325
ag164
aVRob Bagby has one for school data and one for a winery on his blog
p3326
aVThere are several more (aimed at finally getting rid of using the notorious Northwind database for demos) on Codeplex
p3327
aVMarc
p3328
as(dp3329
g10
V13302
p3330
stp3331
a((dp3332
g2
(lp3333
VAre you absolutely sure that on a German-language system, the "BUILTIN\u005cAdministrators" will not work
p3334
aVI would have imagined even then, these basic group names should be valid
p3335
aVYes, in your admin tools, it will show "Vordefiniert\u005cADministratoren" - but I would be surprised if the PrincipalPermission attribute would be language-dependant
p3336
aVMArc
p3337
as(dp3338
g10
V13302
p3339
stp3340
a((dp3341
g2
(lp3342
VCheck out this article here: Read WCF Configuration from a Custom Location
p3343
aVIt basically involves creating a custom ServiceHost that will read the configuration from a different file which you can specify, rather than from web
p3344
aVconfig or app
p3345
aVconfig
p3346
aVHere's another excellent article on using custom config files for WCF services hosted in IIS:
p3347
aVhttp://blogs
p3348
aVmsdn
p3349
aVcom/dotnetinterop/archive/2008/09/22/custom-service-config-file-for-a-wcf-service-hosted-in-iis
p3350
aVaspx
p3351
aVMarc
p3352
as(dp3353
g10
V13302
p3354
stp3355
a((dp3356
g2
(lp3357
VSomething like that maybe
p3358
aVhttp://www
p3359
aVcodeproject
p3360
aVcom/KB/dialog/CRHYesNoToAllDialog
p3361
aVaspx
p3362
aVOr this:   Using Windows Hooks to Enhance MessageBox in
p3363
aVNET
p3364
aVMarc
p3365
as(dp3366
g10
V13302
p3367
stp3368
a((dp3369
g2
(lp3370
VA bookmark lookup is the process of finding the actual data in the SQL table, based on an entry found in a non-clustered index
p3371
aVWhen you search for a value in a non-clustered index, and your query needs more fields than are part of the index leaf node (all the index fields, plus any possible INCLUDE columns), then SQL Server needs to go retrieve the actual data page(s) - that's what's called a bookmark lookup
p3372
aVIn some cases, that's really the only way to go - only if your query would require just one more field (not a whole bunch of 'em), it might be a good idea to INCLUDE that field in the non-clustered index
p3373
aVIn that case, the leaf-level node of the non-clustered index would contain all fields needed to satisfy your query (a "covering" index), and thus a bookmark lookup wouldn't be necessary anymore
p3374
aVMarc
p3375
as(dp3376
g10
V13302
p3377
stp3378
a((dp3379
g2
(lp3380
VNo, not really - or not much, anyway
p3381
aVThe Stored Proc is precompiled on the server - and it's not being sent back and forth between server and client - so it's size is really not all that relevant
p3382
aVIt's more important to have it set up in a maintainable and easy to read way
p3383
aVMarc
p3384
as(dp3385
g10
V13302
p3386
stp3387
a((dp3388
g2
(lp3389
VWell, you could "externalize" certain parts of the config's into separate
p3390
aVconfig files, and use them from both places
p3391
ag1015
ag164
aVyou could externalize your connection string settings like so:
p3392
aVand then have the "connectionString
p3393
aVconfig" file like this:
p3394
aVBasically, any ConfigurationSection has such a "configSource" setting, which allows you to specify an external file to use
p3395
aVThat way, you might be able to share common parts of the two config files
p3396
aVMarc
p3397
as(dp3398
g10
V13302
p3399
stp3400
a((dp3401
g2
(lp3402
VI would definitely create a new branch
p3403
aVIf the two variations of the project still share a lot of common code, and there's still even a remote likeliness they might be merged back together, I don't see any benefit in separating them into two totally independent projects
p3404
aVI'd go with a branch - it gives you the options to later merge stuff back together, if needed
p3405
aVMarc
p3406
as(dp3407
g10
V13302
p3408
stp3409
a((dp3410
g2
(lp3411
VYes of course it's possible
p3412
aVAny ConfigurationSection in any of your config files can be "externalized" by means of the configSource="otherConfigFile
p3413
aVconfig" attribute
p3414
aVIt would be even better if I could
p3415
aVforce Settings class to use
p3416
aVappSettings not applicationSettings
p3417
aVIn order to do that, you need to get away from using the nice visual "Settings" classes in
p3418
aVNET and use the ConfigurationManager directly
p3419
aVThat way, you can put your settings into  and read them in using ConfigurationManager
p3420
aVAppSettings["keyname"]
p3421
aVMarc
p3422
as(dp3423
g10
V13302
p3424
stp3425
a((dp3426
g2
(lp3427
VI use two XSL files - one to document the WSDL for the operations, one to document the XSD for the data being passed around
p3428
aVUnfortunately, so far, I haven't found a single cohesive solution, so I work with two XSLT files which transform the WSDL and the XSD respectively into HTML documentation
p3429
aVWSDL Viewer does the job for the WSDL and produces a first HTML document, and xs3p does the same for the data contain in the XSD file
p3430
aVWorks for me, at least for now :-)
p3431
aVMarc
p3432
as(dp3433
g10
V13302
p3434
stp3435
a((dp3436
g2
(lp3437
VAre you on
p3438
aVNET 3
p3439
ag73
aVIf so - AD has great new features in
p3440
aVNET 3
p3441
aV5 - check out this article Managing Directory Security Principals in
p3442
aVNET 3
p3443
aV5 by Ethan Wilanski and Joe Kaplan
p3444
aVOne of the big new features is a "PrincipalSearcher" class which should greatly simplify finding users and/or groups in AD
p3445
aVIf you cannot use
p3446
aVNET 3
p3447
aV5, one thing that might make your life easier is called "Ambiguous Name Resolution", and it's a little known special search filter that will search in just about any name-related attribute all at once
p3448
aVSpecify your LDAP search query like this:
p3449
aVAlso, I would recommend filtering on the "objectCategory" attribute, since that's single-valued and indexed by default in AD, which is a lot faster than using "objectClass"
p3450
aVMarc
p3451
as(dp3452
g10
V13302
p3453
stp3454
a((dp3455
g2
(lp3456
VNo, I don't think so - InnoSetup is expressly NOT an MSI-based installer
p3457
aVYou will need to first properly uninstall your old MSI-based installation using e
p3458
ag164
aVmsiexec /X (product-code or MSI file name), and then you can install the new stuff using InnoSetup
p3459
aVMarc
p3460
as(dp3461
g10
V13302
p3462
stp3463
a((dp3464
g2
(lp3465
VYou could try something like this - create a separate complexType for your "informationSet" elements, and limit the attribute to a list of valid strings:
p3466
aVOf course, you can extend that list of valid attribute names if you wish - just add more elements to the restriction-enumeration list there
p3467
aVMarc
p3468
as(dp3469
g10
V13302
p3470
stp3471
a((dp3472
g2
(lp3473
VCheck out Richard Mueller's Hilltop Lab where he has lots of spreadsheets showing all the properties the various providers expose
p3474
aVIn particular, his list of properties that the WinNT provider exposes shows that there's no such things as a user's "GUID" or OID or anything like that exposed
p3475
aVMind you - the WinNT provider is only used for backward compatibility, and really only works well on local machine accounts
p3476
aVIf you want to access DOMAIN accounts, you should by all means use the LDAP provider instead - it'll give you access to all the LDAP properties on a user account
p3477
aVMarc
p3478
as(dp3479
g10
V13302
p3480
stp3481
a((dp3482
g2
(lp3483
VWhen you created your custom binding in code, did you also implement a "YourBindingElement" (deriving from StandardBindingElement) and a "YourBindingCollectionElement" (deriving from StandardBindingCollectionElement) along with it
p3484
aVIf so - use that to configure your custom binding, as if it were any other binding
p3485
aVThe first step is to register your binding in the app
p3486
aVconfig or web
p3487
aVconfig file in the extensions section of
p3488
aVNow, your new binding is registered as a "normal" available binding in WCF
p3489
aVSpecify your specifics in the bindings section as for other bindings, too:
p3490
aVSpecify other parameters here, as defined in your "
p3491
aVBindingElement" class
p3492
aVLastly, use your binding like a normal binding in your services and/or client sections in system
p3493
aVserviceModel:
p3494
aVI couldn't really find a lot of resources on how to write your own binding in code on the web - Microsoft has a WCF/WPF/WF sample kit which includes a few samples from which I basically learned enough to figure it out :-)
p3495
aVThere's one really good article by Michele Leroux Bustamante on creating your custom bindings - part 2 of a series, but part 1 is not available publicly :-(
p3496
aVHere's a sample custom binding in code for which you can download the complete source code: ClearUserNameBinding
p3497
aVMarc
p3498
as(dp3499
g10
V13302
p3500
stp3501
a((dp3502
g2
(lp3503
VIF you ever want to self-host the service instead of hosting it inside IIS, or if you ever want to share the service interface as an assembly for some reason, it will probably be easier to have it in a separate assembly
p3504
aVI would recommend one assembly for the service interface(s) (including data contracts and such), one for the service implementation, and another (if needed) for a self-host (e
p3505
ag164
aVWindows NT service or command-line app)
p3506
aVThat's the cleanest separation and there's no real reason not to go that way, IMHO
p3507
aVMarc
p3508
as(dp3509
g10
V13302
p3510
stp3511
a((dp3512
g2
(lp3513
VIt depends - if you connect from a command-line or Winforms app DIRECTLY to your SQL Server, you EITHER specify "Integrated Security=SSPI;" and then use your Windows credentials as logon credentials, OR you specify "user id=
p3514
aV;pwd=
p3515
aV- but that's then a SQL logon - NOT your Windows logon
p3516
aVYou mention "impersonate and then connect" - that seems to indicate ASP
p3517
aVNET - that's a totally different story again
p3518
aVIf you impersonate, then you're basically using your Windows credentials, e
p3519
ag164
aVthe web server will "impersonate" you and log on as you (using your Windows credentials)
p3520
aVIn that case, again, no "uid=
p3521
aV;pwd=
p3522
aVneeds to be specified (if it is, it will be ignored)
p3523
aVAs that link you mentioned clearly shows - if you can connect directly, and you specify "Integrated Security=SSPI;", then this takes precedence over any uid=
p3524
aV;pwd=
p3525
aVwhich you might also specified and logs you in using your Windows credentials; those extra uid=
p3526
aV;pwd=
p3527
aVpieces are ignored
p3528
aVMarc
p3529
as(dp3530
g10
V13302
p3531
stp3532
a((dp3533
g2
(lp3534
VAssuming you're on
p3535
aVNET 2
p3536
aV0 and higher, have you checked out the "Settings" files
p3537
aVThose are being stored inside your app
p3538
aVconfig - application settings in  sections, user-definable settings in , which incidentally have the  setting you mentioned
p3539
aVMaybe that could be an approach
p3540
aVThose user settings are a defined type, which you could definitely reuse under a different name, if needed ("mySettings")
p3541
aVMarc
p3542
as(dp3543
g10
V13302
p3544
stp3545
a((dp3546
g2
(lp3547
VThat should do the trick and be compatible with SQL Server 2000, I hope
p3548
aVIf you additionally need the table and column information in SQL Server 2000, it gets a bit more involved; you need to join the  and  catalog views like so:
p3549
aVAnd if you want to leverage the INFORMATION_SCHEMA views which ARE indeed available in SQL Server 2000, use this query:
p3550
aVMarc
p3551
as(dp3552
g10
V13302
p3553
stp3554
a((dp3555
g2
(lp3556
VYour client tries to connect to:
p3557
aVwhile your server exposes the service at:
p3558
aVThese two need to match
p3559
aV:-)
p3560
aVSo you can either use Rodrigo's answer and add an relative  to your server's endpoint, or you could change the client's endpoint to point to the same URL as the server exposes right now
p3561
aVMarc
p3562
as(dp3563
g10
V13302
p3564
stp3565
a((dp3566
g2
(lp3567
VDoes your table have a date/time-stamp column of type DATETIME
p3568
aVOtherwise you're probably out of luck
p3569
aVMarc
p3570
as(dp3571
g10
V13302
p3572
stp3573
a((dp3574
g2
(lp3575
VI stand corrected - yes, you CAN have both - an OUTPUT parameter as well as a set of rows being returned
p3576
aVYou learn something new every day :-)
p3577
aVAs to why a timeout happens - hmm
p3578
aVhard to tell
p3579
aVA quickie little sample works fine for me
p3580
aVCan you post your stored proc (at least relevant bits of it)
p3581
aVHow many rows are we talking about, that get returned here
p3582
aVAt what point in your stored proc are you calculating the number of rows that you need to return back as OUTPUT parameter
p3583
aVWhat if you try to add another parameter  to your one SProc as a test and do a  on your data
p3584
aVDoes that return quickly
p3585
aVMarc
p3586
as(dp3587
g10
V13302
p3588
stp3589
a((dp3590
g2
(lp3591
VAre you aware that you can easily transform your XSD - even with the cumbersome annotation and documentation tags - into a fairly nicely readable HTML documentation file
p3592
aVThe magic is called xs3p and it's a fairly substantial XSLT file to convert your XSD (which is just another XML after all) into nicely structured, very useful documentation HTML
p3593
aVIt's free, it works - just great
p3594
aV:-)
p3595
aVOf course - you still have to add the annotation/documentation to your XSD, but it might be a better solution than having a XSD and a separate documentation file (which most likely will be out of sync sooner or later
p3596
aVMarc
p3597
as(dp3598
g10
V13302
p3599
stp3600
a((dp3601
g2
(lp3602
VThe main drawback is a potential vulnerability to attacks - e
p3603
ag164
aVa malicious source can now flood your webserver with message up to 2 GB in size and potentially bring it down
p3604
aVOf course, allowing 2 GB messages also puts some strain on your server in terms of memory consumption, since those messages need to be assembled in memory, in full (unless you use streaming protocols in WCF)
p3605
aVIf you have 10 clients sending you 2 GB messages, you'll need plenty of RAM on your server
p3606
aV:-)
p3607
aVOther than that, I don't see any real issues
p3608
aVMarc
p3609
as(dp3610
g10
V13302
p3611
stp3612
a((dp3613
g2
(lp3614
VDo I understand your requirements correctly
p3615
aVYou want to have a  and optionally an  before that (but not required)
p3616
aVHow about this schema then
p3617
aVDefine a sequence where the first element, , is optional () while the second one is not optional
p3618
aVDoes that solve your requirement
p3619
aVMarc
p3620
as(dp3621
g10
V13302
p3622
stp3623
a((dp3624
g2
(lp3625
VWell, the client endpoint in the config specifies this URL:
p3626
aVbut in your code sample, you create:
p3627
aVThe addresses must match - if the one in the config works, you'll need to change your code to:
p3628
aVMind you - there are various little typos in your code sample (my
p3629
aVuri
p3630
aVcom vs
p3631
aVwww
p3632
aVmyuri
p3633
aVcom, /service
p3634
aVsvc instead of /Services/Services
p3635
aVsvc)
p3636
aVDoes it work with the corrected endpoint address
p3637
aVMarc
p3638
as(dp3639
g10
V13302
p3640
stp3641
a((dp3642
g2
(lp3643
VA foreign key is a constraint, a relationship between two tables - that has nothing to do with an index per se
p3644
aVBut it is a known fact that it makes a lot of sense to index all the columns that are part of any foreign key relationship, because through a FK-relationship, you'll often need to lookup a relating table and extract certain rows based on a single value or a range of values
p3645
aVSo it makes good sense to index any columns involved in a FK, but a FK per se is not an index
p3646
aVCheck out Kimberly Tripp's excellent article "When did SQL Server stop putting indexes on Foreign Key columns
p3647
as(dp3648
g10
V13302
p3649
stp3650
a((dp3651
g2
(lp3652
VMy recommendation is for SourceGear Vault
p3653
aVIt's close enough to Visual Source(un)Safe to feel "comfortable" with right away, it's rock-solid (built on SQL Server which solves your backup hassles, too), it's very reliable, has great support for branching and merging - all around good stuff
p3654
aVIt's free for teams up to 2 devs and reasonably priced for larger teams - much less $$$ than Team System (also it's only a Source Control, of course - not a whole team dev system)
p3655
aVWe use it in conjunction with Fogbugz bug and issue tracker and that combo gives up all the bang we need for much less buck
p3656
aVHighly recommended
p3657
aVMarc
p3658
as(dp3659
g10
V13302
p3660
stp3661
a((dp3662
g2
(lp3663
VChris shows one way to "externalize" part of your configuration
p3664
aVThat works fine for certain scenarios
p3665
aVIf you need more, you'll need to dig in a bit deeper
p3666
aVFor that, you should definitely check out Jon Rista's three-part series on
p3667
aVNET 2
p3668
aV0 configuration up on CodeProject
p3669
aVUnraveling the mysteries of
p3670
aVNET 2
p3671
aV0 configuration
p3672
aVDecoding the mysteries of
p3673
aVNET 2
p3674
aV0 configuration
p3675
aVCracking the mysteries of
p3676
aVNET 2
p3677
aV0 configuration
p3678
aVHighly recommended, well written and extremely helpful
p3679
aVHe shows how to create and use custom configuration sections, and goes on to explain how to use your own  instead of or in addition to standard
p3680
aVNET config files
p3681
aVMarc
p3682
as(dp3683
g10
V13302
p3684
stp3685
a((dp3686
g2
(lp3687
VI doubt you could come up with a cohesive way to pass a delegate from a C# client to a Java service implementation and have it properly executed
p3688
aVWCF is not a strict
p3689
aVNET implementation and thus has to deal with interop issues
p3690
aVIt cannot rely on the assumption that both ends of the conversation are in
p3691
aVNET - that's why you shouldn't throw around custom exceptions between server and client either (exceptions are a
p3692
aVNET construct) - you need to use SOAP faults instead (which are interoperable)
p3693
aVSo I don't think what you want to do can be done with a delegate - you'll have to come up with another way to achieve your goal
p3694
aVMarc
p3695
as(dp3696
g10
V13302
p3697
stp3698
a((dp3699
g2
(lp3700
VNo, you can't really throw an exception or SOAP fault since all you have really is HTTP
p3701
aVSo if your service fails, the only way it can communicate that back to the HTTP client is by means of a HTTP status code
p3702
aVYou could try making the code more meaningful, e
p3703
ag164
aVdon't always return a 500 but split it up into more detail, or you could possibly include more descriptive error messages (at least for development and testing) to give you a hint what went wrong
p3704
aVBut the basic mechanism is : you only use HTTP for the GET, you only have HTTP to return status and error codes
p3705
aVMarc
p3706
as(dp3707
g10
V13302
p3708
stp3709
a((dp3710
g2
(lp3711
VCould you just turn your "nationality" thingie into its own complexType and then use that new complex type inside your xs:all
p3712
aVI don't have anything at hand to test this, so this is really just off the top of my head
p3713
aVgive it a try
p3714
aVEDIT: tested it by now - it works, the only minor price to pay is that your XML will have to look something like this:
p3715
aVSo you get an extra  node that will contain the arbitrary long list of  items
p3716
aVMarc
p3717
as(dp3718
g10
V13302
p3719
stp3720
a((dp3721
g2
(lp3722
VYou should definitely check out Jon Rista's three-part series on
p3723
aVNET 2
p3724
aV0 configuration up on CodeProject
p3725
aVUnraveling the mysteries of
p3726
aVNET 2
p3727
aV0 configuration
p3728
aVDecoding the mysteries of
p3729
aVNET 2
p3730
aV0 configuration
p3731
aVCracking the mysteries of
p3732
aVNET 2
p3733
aV0 configuration
p3734
aVHighly recommended, well written and extremely helpful
p3735
aVHe shows how to create and use custom configuration sections, and goes on to explain how to use your own custom
p3736
aVconfig instead of or in addition to standard
p3737
aVNET config files
p3738
aVMarc
p3739
as(dp3740
g10
V13302
p3741
stp3742
a((dp3743
g2
(lp3744
VExcept for a few very rare cases (possibly a many-to-many relationship table, or a table you temporarily use for bulk-loading huge amounts of data), I would go with the saying:
p3745
aVIf it doesn't have a primary key, it's not a table
p3746
aVMarc
p3747
as(dp3748
g10
V13302
p3749
stp3750
a((dp3751
g2
(lp3752
VWell, the wsHttpBinding requires you to connect to your service using SOAP - a web browser alone won't cut it, so that's why it's not working when you browse to the
p3753
aVsvc file
p3754
aVNothing wrong there, really
p3755
aVYou need to create a real full-fledged SOAP client to connect to your service and test it
p3756
aVAlternatively, you could also use the  test client which sits in your  folder
p3757
aVMarc
p3758
as(dp3759
g10
V13302
p3760
stp3761
a((dp3762
g2
(lp3763
VIf you are using the  as you mentioned, then you have to decorate your structure with  and  attributes - not  and  and so forth (those are used for regular and XML serializers)
p3764
aVThe DataContractSerializer is a strictly "opt-in" serializer - only those fields and/or properties that you specifically mark with  will end up being serialized; as opposed to the XmlSerializer which is opt-out - it serializes everything unless it's marked with
p3765
aVMarc
p3766
as(dp3767
g10
V13302
p3768
stp3769
a((dp3770
g2
(lp3771
VIf you can upgrade to SQL Server 2008, there's a new feature called Table-Valued Parameter exactly for this very purpose
p3772
aVSee the Books Online section about it
p3773
aVIt basically allows you to create a table-valued user-defined type, which can then be used as a readonly input parameter into any stored procedure
p3774
aVFrom
p3775
aVNET, you can simple use a  instance and pass it arbitrary numbers of rows inside that data table
p3776
aVMarc
p3777
as(dp3778
g10
V13302
p3779
stp3780
a((dp3781
g2
(lp3782
Vin the ServiceReferences
p3783
aVClientConfig file of
p3784
aVthe Silverlight client app that the "Binding" tag only allows
p3785
aVbasicHttpBinding and NOT wsHttpBinding
p3786
aVDoes this mean that you can not secure a Silverlight-Enabled
p3787
aVWCF Service
p3788
aVNo, it doesn't mean that
p3789
aVYou can have a  and still assign transport-level security (HTTPS with SSL) to it
p3790
aVThat shouldn't be a problem
p3791
aVMarc
p3792
aVPS: Many one of those links gives you more insight and the proverbial "AHA
p3793
aV:-)
p3794
aVhttp://winterdom
p3795
aVcom/2007/11/basichttpbindingwithtransportsecurity
p3796
aVhttp://silverlight
p3797
aVnet/forums/p/13275/44170
p3798
aVaspx
p3799
aVhttp://kevindockx
p3800
aVblogspot
p3801
aVcom/2009/02/username-authentication-with
p3802
aVhtml
p3803
aVhttp://www
p3804
aVpixel73
p3805
aVcom/blog/Default
p3806
aVaspx
p3807
aVg=posts&t;=4173
p3808
aVhttp://community
p3809
aVirritatedvowel
p3810
aVcom/blogs/pete_browns_blog/archive/2008/03/19/WCF-Integration-in-Silverlight-2-Beta-1
p3811
aVaspx
p3812
aVhttp://geekswithblogs
p3813
aVnet/scottthompson/archive/2009/03/25/setting-up-ssl-between-silverlight-and-wcf-under-iis7
p3814
aVaspx
p3815
as(dp3816
g10
V13302
p3817
stp3818
a((dp3819
g2
(lp3820
VWell, it would appear that the authorization elements are indeed not part of the WSDL which is a bit odd
p3821
aVEven funnier - the Amazon docs talks about providing that information in the SOAP header - yet, their sample clearly puts it in the  element
p3822
aVWhat happens if you manually add those additional elements either in Delphi code, or in the WSDL itself
p3823
aVCan you tweak it to be so that the SimpleDB service is happy with it
p3824
aVMarc
p3825
as(dp3826
g10
V13302
p3827
stp3828
a((dp3829
g2
(lp3830
VThere's a number of things you could do:
p3831
aVadd a certificate to each and every machine that's allowed to use your service, and check for that certificate
p3832
aVThat only allows you to exclude "unauthorized" machines - you cannot limit it to a specific application
p3833
aVsame as above, but include the certificate embedded in your winforms app and send it from there (do not store it in the machine's certificate store)
p3834
aVrequire a username / password that only that particular app of yours knows about and can transmit to your service; e
p3835
ag164
aVsomeone else would not be able to present the appropriate credentials
p3836
aVEDIT 2: OK, so the username/password approach seems to get out of hand
p3837
aVwhat if you just have basic transport security (SSL) for basic protection, and then use the  to define header and body of your SOAP message, include a specific value in the header, and then just check for that presence of the element in the header in your service
p3838
aVSomething like that:
p3839
aVAnd then on your server in your code just check for the presence and the validity of that  code:
p3840
aVThat might end up being a lot easier than the username/password security scenario
p3841
aVMarc
p3842
as(dp3843
g10
V13302
p3844
stp3845
a((dp3846
g2
(lp3847
VJSON-enabled WCF services are REST-based - those basically transmit everythign in clear text, so in order to get any protection against snooping, you'd have to secure the transport layer using e
p3848
ag164
aVSSL encryption
p3849
aVMarc
p3850
as(dp3851
g10
V13302
p3852
stp3853
a((dp3854
g2
(lp3855
VIn this case here, every single method call will be authenticated
p3856
aVWhat you're talking about would be what is called "secure sessions", where the client authenticates once against the server and then a common token is used for subsequent exchanges
p3857
aVThat secure sessions features however is only available with wsHttpBinding - not with basicHttpBinding
p3858
aVMarc
p3859
as(dp3860
g10
V13302
p3861
stp3862
a((dp3863
g2
(lp3864
VYes - in the future :-) The current Entity Framework doesn't support the "domain-first" approach - but the next version (EF v4) will
p3865
aVThis will ship with
p3866
aVNET 4
p3867
aV0 / Visual Studio 2010 - but don't ask me, when
p3868
aVI don't know (neither does Microsoft)
p3869
aVMarc
p3870
as(dp3871
g10
V13302
p3872
stp3873
a((dp3874
g2
(lp3875
VDo you have a network with several DC (domain controllers)
p3876
aVThey might be out of sync since the LastLogonTimeStamp will be updated on the DC that the user actually logs on, and synchronization might take some time
p3877
aVMarc
p3878
as(dp3879
g10
V13302
p3880
stp3881
a((dp3882
g2
(lp3883
VSure - you can run the command-line utility  against your service (directly using the URL or the WSDL as a file)
p3884
aVThis will by default generate a  config file which contains all the necessary settings in the  section
p3885
aVJust copy & paste into your new or existing web
p3886
aVconfig
p3887
aVMarc
p3888
aVEDIT: From comments below, the answer is no in the case of the server side config
p3889
as(dp3890
g10
V13302
p3891
stp3892
a((dp3893
g2
(lp3894
VSomething like this might work:
p3895
aVI'm not 100% sure about whether the "weekday" numbers are fixed or might depend on your locale on your SQL Server
p3896
aVCheck it out
p3897
aVMarc
p3898
as(dp3899
g10
V13302
p3900
stp3901
a((dp3902
g2
(lp3903
VI dabbled in T4 for a bit - hey, if it's free and included in VS2008, use it, right
p3904
aVMy basic idea was to create a set of templates to read a database table, and create our own "roll-your-own" ORM classes from it
p3905
aVI gave up on T4, frustrated and unable to get even the most basic things to work that are a piece of cake in CodeSmith
p3906
aVEven a simple task such as selecting what server, database, and table to use cannot be done in T4 efficiently from "outside" the template itself
p3907
aVYes, you can hard-code all these values as string values into a T4 template - but c'mon, that's really not a solution, is it
p3908
aVCodeSmith has great support for picking server, database, and tables, and you can set those as properties on the template and just pick what you want and let the template do your stuff on that particular table you picked
p3909
aVMy conclusion: T4 is promising, but "not there" just yet
p3910
aVIt might work for very simple scenarios, but right now, it's in my opinion nowhere near as flexible and powerful as Codesmith
p3911
aVFor for a scenario such as
p3912
aVnetTiers, I'd stick with Codesmith for the time being
p3913
aVMarc
p3914
as(dp3915
g10
V13302
p3916
stp3917
a((dp3918
g2
(lp3919
VYes sure - WCF itself will run on Windows only - but the services it provides can be accessed from any other language / tool
p3920
aVAnd using WCF as a client, you can also access any other tool's services, e
p3921
ag164
aVyou can access a webservice written in PHP, Java, etc
p3922
aVThat's the whole point of SOA
p3923
aV:-)
p3924
aVMarc
p3925
as(dp3926
g10
V13302
p3927
stp3928
a((dp3929
g2
(lp3930
VASP
p3931
aVNET really doesn't have a "compile to a single DLL" approach (unfortunately - I had wished for it myself many times
p3932
aVAs you noted, the Web Application helps reduce clutter somewhat
p3933
aVWeb Deployment also helps, in that the code of the web pages is compiled into a single DLL and you can actually remove the  files from your installation (if it's non-updateable), but you still have plenty of  files lying around
p3934
aVSo unfortunately, I think, at this point in time, there's no "out-of-the-box" solution for your requirement (and as far as I've heard so far, nothing like that is planned for VS2010 / ASP
p3935
aVNET 4
p3936
aV0 either)
p3937
aVMarc
p3938
as(dp3939
g10
V13302
p3940
stp3941
a((dp3942
g2
(lp3943
VIf you're only talking about the backups, there's a few SQL Backup solutions out there that offer backup compression
p3944
aVSQL Server 2008 also has backup compression built-in
p3945
aVSee:    Red Gate's SQL Backup Pro
p3946
aVor here is a list of various products: http://www
p3947
aVmssqltips
p3948
aVcom/products
p3949
aVasp
p3950
aVcatid=15
p3951
aVIf you're talking about actually reducing the size of the database per se - pick the right (= minimal) data types, use maintenance plans to compress and reclaim space from the database, don't over-index (that always uses lots of space) etc
p3952
aVMarc
p3953
as(dp3954
g10
V13302
p3955
stp3956
a((dp3957
g2
(lp3958
VOf course, TableX, TableY and TAbleZ might also be related in some other way (not INNER JOIN)
p3959
aVIf you cannot find any relation between the tables AT ALL, you could also do three separate
p3960
aVand then an insert like this:
p3961
aVThat's the ultimate last resort, you can can't express everything in a single  statement
p3962
aVMarc
p3963
as(dp3964
g10
V13302
p3965
stp3966
a((dp3967
g2
(lp3968
VIt will NOT work on  since that's a configuration SectionGroup - not a configuration Section
p3969
aVIt WILL work just fine at runtime on anything below  - we do this all the time
p3970
aVMartin's answer shows it nicely - his sample will work
p3971
aVMarc
p3972
as(dp3973
g10
V13302
p3974
stp3975
a((dp3976
g2
(lp3977
VVARCHAR(MAX) column values will be stored IN the table row, space permitting
p3978
aVSo if you have a single VARCHAR(MAX) field and it's 200, 300 byte, chances are it'll be stored inline with the rest of your data
p3979
aVNo problem or additional overhead here
p3980
aVOnly when the entire data of a single row cannot fit on a single SQL Server page (8K) anymore, only then will SQL Server move VARCHAR(MAX) data into overflow pages
p3981
aVSo all in all, I think you get the best of both worlds - inline storage when possible, overflow storage when necessary
p3982
aVMarc
p3983
aVPS: As Mitch points out, this default behaviour can be turned off - I don't see any compelling reasons to do so, however
p3984
as(dp3985
g10
V13302
p3986
stp3987
a((dp3988
g2
(lp3989
VOne word: DON'T
p3990
aVThis is very bad practice - columns have ONE SINGLE DATATYPE for a reason
p3991
aVDo not abuse this and make everything into variants
p3992
aVMarc
p3993
as(dp3994
g10
V13302
p3995
stp3996
a((dp3997
g2
(lp3998
VYou should also check out Jon Rista's three-part series on
p3999
aVNET 2
p4000
aV0 configuration up on CodeProject
p4001
aVUnraveling the mysteries of
p4002
aVNET 2
p4003
aV0 configuration
p4004
aVDecoding the mysteries of
p4005
aVNET 2
p4006
aV0 configuration
p4007
aVCracking the mysteries of
p4008
aVNET 2
p4009
aV0 configuration
p4010
aVHighly recommended, well written and extremely helpful
p4011
aVMarc
p4012
as(dp4013
g10
V13302
p4014
stp4015
a((dp4016
g2
(lp4017
VDo you specify a user name and password to log on
p4018
aVWhat exactly is your complete command line
p4019
aVIf you're running on your own box, you can either specify a username/password, or use the  parameter to log on with your Windows credentials (if those are permitted in your SQL server installation)
p4020
aVMarc
p4021
as(dp4022
g10
V13302
p4023
stp4024
a((dp4025
g2
(lp4026
VWell, if you create your own custom validation events, along with custom validation event args, I would assume you'd prefer to pass back status/error codes rather than throwing exceptions if something doesn't validate
p4027
aVIn this case, if you want to have validation that will not throw exceptions, then yes, I'd add those fields you need to your custom event args - they're custom already, so there's no reason not to extend them to suit your needs :-)
p4028
aVMarc
p4029
as(dp4030
g10
V13302
p4031
stp4032
a((dp4033
g2
(lp4034
VI haven't experienced this problem myself, but my questionn is: why on earth do you specify a "ProtectionLevel=None" in your fault contract
p4035
aVAny particular reason for that
p4036
aVIf not, I'd strongly recommend not specifying that at all - the default is ProtectionLevel=EncryptAndSign and that's usually your best bet all around
p4037
aVTry it, unless you have a very strong and explicit reason against it
p4038
aVMarc
p4039
as(dp4040
g10
V13302
p4041
stp4042
a((dp4043
g2
(lp4044
VYes, you can use a generic  type for WCF projects, which can be anything, really
p4045
aVHowever, this imposes a lot of work on you, both on the client side creating the message object (you basically have to manually create the XML that makes up the generic message), as well as the server side, since you can't rely on the nice XML serialization/deserialization anymore
p4046
aVYou're dealing with basic, raw angle-bracket soup (straight XML)
p4047
aVIt works and it could be a solution - but maybe there are others, more elegant and useful solutions
p4048
aVIs that inheritance really needed at all
p4049
aVThink about your systems design
p4050
aVMarc
p4051
as(dp4052
g10
V13302
p4053
stp4054
a((dp4055
g2
(lp4056
VWell, based on the practice by many larger corporations and organizations to wait until a service pack 1 is available for any given Microsoft product, it might still be a while before you can deploy SQL Server 2010 - pardon me: 2008 R2 :-)
p4057
aVSQL Server 2008 is indeed quite an extensive update, and if you have the option to deploy it, I personally would definitely recommend doing so
p4058
aVIt does have a plethora of new features that no doubt will make your life easier one way or another
p4059
aVMarc
p4060
as(dp4061
g10
V13302
p4062
stp4063
a((dp4064
g2
(lp4065
VWCF is an extension - it's a web service, but you can expose it over TCP/IP, or named pipes, in addition to just using HTTP
p4066
aVAlso, WCF has lots more options for security and so on
p4067
aVYou can also host a WCF service inside your own app - you don't have to use IIS for hosting the web service (ASMX)
p4068
aVIn conclusion: WCF IS web services - just much more flexible and much more useful than straight ASMX web services
p4069
aVMarc
p4070
as(dp4071
g10
V13302
p4072
stp4073
a((dp4074
g2
(lp4075
VOut of the box, there's no role provider to use Active Directory directly
p4076
aVYou can use the role table in the ASP
p4077
aVNET membership- and role-system, or you can use Authorization Manager (AzMan)
p4078
aVThere's an article on CodeProject which shows the implementation of a role provider which works against the Active Directory - with full source code
p4079
aVMaybe this helps
p4080
aVMarc
p4081
as(dp4082
g10
V13302
p4083
stp4084
a((dp4085
g2
(lp4086
VWe need more info to see what's happening:
p4087
aVWhat binding are you using
p4088
aVWhat do your server and client config files look like
p4089
aVMarc
p4090
as(dp4091
g10
V13302
p4092
stp4093
a((dp4094
g2
(lp4095
VWell, your problem appears to be this:
p4096
aVon the server side, you use a default netTCP binding with no parameters - you don't change anything on it
p4097
aVnetTCP defaults to transport-level security with Windows credentials
p4098
aVon your client however, you explicitly turn OFF any security on the netTCP binding
p4099
aVSo the two don't match and don't agree on what to do
p4100
aVEither you need to turn OFF all security on BOTH ends - server AND client - or you need to just use the secure defaults (with Windows credentials)
p4101
aVMarc
p4102
as(dp4103
g10
V13302
p4104
stp4105
a((dp4106
g2
(lp4107
VWell, your web service will most likely be hosted on a Windows server, right
p4108
aVYou could do any number of things:
p4109
aVlaunch a Windows workflow
p4110
aVwrite an entry to a database table, which then gets scanned by another app / process that then does something based on the entry (e
p4111
ag164
aVsends email etc
p4112
aVkick off a console app
p4113
aVcall another service on the same or a different server
p4114
aVI think your options are really quite endless
p4115
aVHowever - they're not directly part of the webservice per se - you'd have to kick them off before the web service call ends
p4116
aVThere's really nothing in either ASMX or WCF which allows you to "send request and then continue executing" - your service method send the response when it is done
p4117
aVMarc
p4118
as(dp4119
g10
V13302
p4120
stp4121
a((dp4122
g2
(lp4123
VUsing Referential Integrity (foreign keys)
p4124
aVOne of the mainstays of a good DB design is to make sure relationships between data tables and/or data tables and lookup tables are "secured" by means of referential integrity (using foreign key relationships)
p4125
aVThis helps ensure data integrity, avoids "stale" or wrong data
p4126
as(dp4127
g10
V13302
p4128
stp4129
a((dp4130
g2
(lp4131
VThat's a thorny issue at best
p4132
aV:-)
p4133
aVYou could export your WCF service description to a WSDL file and enrich it with  and  elements, and then convert that to a readable HTML document using an XSLT transformation - but that's less than great and useful, really
p4134
aVHere's a link that shows how to do that:
p4135
aVhttp://andrewtokeley
p4136
aVnet/archive/2008/10/30/adding-wsdl-documentation-to-your-wcf-services
p4137
aVaspx
p4138
aVSeveral of the XML tools out there also offer ways to document WSDL files - often also from those documentation and annotation tags - one example is here: http://www
p4139
aVoxygenxml
p4140
aVcom/doc/ug-oxygen/generate-wsdl-documentation
p4141
aVhtml
p4142
aVHere's an online version (and a downloadable XSLT transformation) to convert the documentation and annotation elements out of your WSDL: http://tomi
p4143
aVvanek
p4144
aVsk/index
p4145
aVphp
p4146
aVpage=wsdl-viewer
p4147
aVI don't really have the ultimate answer here - but an avid interest in the topic, too
p4148
aVMarc
p4149
as(dp4150
g10
V13302
p4151
stp4152
a((dp4153
g2
(lp4154
VI would think the SID is probably your best bet in any user- and group-related scenario here
p4155
aVThere's really no other unique identifier - especially not with the WinNT provider
p4156
aVFor more info on the WinNT vs
p4157
aVLDAP discussion and for great reference Excel sheets on what properties each of those providers really expose (and what their names are), visit Richard Mueller's Hilltop Lab
p4158
aVRichard is an ADSI MVP and has excellent contents for anyone interested in Active Directory and LDAP
p4159
aVMarc
p4160
as(dp4161
g10
V13302
p4162
stp4163
a((dp4164
g2
(lp4165
VThere's nothing really stopping any object to create an instance of ServiceHost
p4166
aVThe big question then is - can you guarantee that your object containing the service host is "alive"
p4167
aVOr was it garbage collected by any chance
p4168
aVWe use Windows (NT) Services to host our own custom service host classes to provide around-the-clock availability for WCF services - works just fine
p4169
aVMarc
p4170
as(dp4171
g10
V13302
p4172
stp4173
a((dp4174
g2
(lp4175
VI use Notepad2 for that and many other editing purposes
p4176
aVFreeware, totally usable, quick and light - all you can ask for
p4177
aVHighly recommended
p4178
aVMarc
p4179
as(dp4180
g10
V13302
p4181
stp4182
a((dp4183
g2
(lp4184
VAre you doing streaming on the response side
p4185
aVThat would explain it - when you use streaming, only headers will be logged (not the streamed data)
p4186
aVMarc
p4187
as(dp4188
g10
V13302
p4189
stp4190
a((dp4191
g2
(lp4192
VXML schema for SQL Server XML column - yes, absolutely
p4193
aVWhat you'll need to do is create a schema collection (you can have multiple schemas in a collection)
p4194
aVand then when you define the XML column, you need to reference that XML schema collection to bind" the XML column to that schema collection:
p4195
aVThe XPath thing - not sure, but I don't think so - XML really is nothing but strings in the end, right
p4196
aVMarc
p4197
as(dp4198
g10
V13302
p4199
stp4200
a((dp4201
g2
(lp4202
VYou would have to try something like this: (the @name attribute is on the "Item" element - not the "Items"
p4203
aVMarc
p4204
as(dp4205
g10
V13302
p4206
stp4207
a((dp4208
g2
(lp4209
VI can wholeheartedly recommend FogBugz - its big strength being: it just works
p4210
aVIt's easy to use, easy to understand - it just plain works
p4211
aVFogbugz does have some project planning stuff included - most notably a feature called "evidence based scheduling" - but its big strength (and origin) definitely is bug- and issue-tracking which it totally excels at
p4212
aVMarc
p4213
aVPS: also, there is mounting evidence that there will be a FogBugz 7 release sometime Real Soon Now, and it's a good bet the project planning and management stuff probably will be one of the areas being improved (just my guess)
p4214
as(dp4215
g10
V13302
p4216
stp4217
a((dp4218
g2
(lp4219
VI would definitely recommend looking at Interbase by Embarcadero or the open-source sibling, Firebird
p4220
aVBoth are very well supported by Delphi by means of native, high-performance db-access components and such
p4221
aVInterbase is a totally rock-solid database - I would put it on a par with SQL Server or Oracle
p4222
aVIt's totally capable of handling medium to high traffic for at least 50-100 users concurrently, no problem at all
p4223
aVAnother two worth competitor would be Elevate DB and Nexus DB
p4224
aVBoth grew out of Delphi file-based database systems, and both have been around for quite some time (in one form or another) and are well proven, widely used, well tested
p4225
aVMarc
p4226
as(dp4227
g10
V13302
p4228
stp4229
a((dp4230
g2
(lp4231
VDon't try to make your system idiot-proof - idiots are extremely ingenious
p4232
aV:-)
p4233
aVWhat would stop them to just simply add WHERE 1=1 to every query - possibly even from a template
p4234
aVI don't think this would accomplish anything at all
p4235
aVMarc
p4236
as(dp4237
g10
V13302
p4238
stp4239
a((dp4240
g2
(lp4241
VMaybe something like this might work for you
p4242
aVMarc
p4243
as(dp4244
g10
V13302
p4245
stp4246
a((dp4247
g2
(lp4248
VWhat you're trying to do is establish a "secure session" between your client and your service
p4249
aVThis is a concept that will only work with the wsHttpBinding - so if you're not using that particular binding, it won't work
p4250
aVTo establish a secure session, you need to set a number of specific config properties in the client and server's config files - you can certainly find those settings by reading the docs (look for "establishSecurityContext") or check out Michele Leroux Bustumante's excellent WCF screencast on security fundamentals on MSDN
p4251
aVBut really: I wouldn't recommend trying to use secure session by all means
p4252
aVUnder normal circumstances, using per-call services is the preferred option, and the overhead for re-authenticating with each service call is really negligable
p4253
aVMarc
p4254
as(dp4255
g10
V13302
p4256
stp4257
a((dp4258
g2
(lp4259
VYou've hit one of the weak points of EF v1
p4260
aVFor now, yes, going the route with AutoMapper certainly allows you to convert your EF entities to "straight" business entities and use them in your higher-up layer
p4261
aVAlso, EF v4 which is due with
p4262
aVNET 4
p4263
aV0 / Visual Studio 2010 should bring a lot of relieve in many of the problem areas - support for your own, straight POCOs (Plain Old CLR Objects), and a great many more
p4264
aVCheck out the EF Design Blog
p4265
aVThe team has posted a number of very interesting, very promising posts lately, with regards to EF v4
p4266
aVI'm looking forward to it
p4267
aVMarc
p4268
as(dp4269
g10
V13302
p4270
stp4271
a((dp4272
g2
(lp4273
VI don't think you can do this - you need to conform to the XML schema for configuration files if you play around in the *
p4274
aVconfig files - and this means, you need to have your sections according to the specified schema, and if that's the case, ConfigurationManager will be able to parse them (and will do so)
p4275
aVIf you need extra config information that doesn't conform to the standard
p4276
aVNET config schema, you'll have to use extra, separate config files - I don't see any other way, sorry
p4277
aVMarc
p4278
as(dp4279
g10
V13302
p4280
stp4281
a((dp4282
g2
(lp4283
VWell, even the  will be fairly inefficient, especially on large tables, since SQL Server really can't do anything but do a full table scan (clustered index scan)
p4284
aVSometimes, it's good enough to know an approximate number of rows from the database, and in such a case, a statement like this might suffice:
p4285
aVThis will inspect the dynamic management view and extract the number of rows and the table size from it, given a specific table
p4286
aVIt does so by summing up the entries for the heap (index_id = 0) or the clustered index (index_id = 1)
p4287
aVIt's quick, it's easy to use, but it's not guaranteed to be 100% accurate or up to date
p4288
aVBut in many cases, this is "good enough" (and put much less burden on the server)
p4289
aVMaybe that would work for you, too
p4290
aVOf course, to use it in EF, you'd have to wrap this up in a stored proc or use a straight "Execute SQL query" call
p4291
aVMarc
p4292
as(dp4293
g10
V13302
p4294
stp4295
a((dp4296
g2
(lp4297
VThe big question is: do you have any kind of transport-level or message-level security enabled on your binding
p4298
aVWhat binding are you using
p4299
aVIf you have transport-level security (typically through using HTTPS over SSL), then you have a point-to-point encrypted transport channel which I would deem very safe
p4300
aVIf you have message-level security using a certificate on the client, too, and you do encrypt the whole message, then you should be safe, too
p4301
aVIt really boils down to what binding you're using and what security settings you're using on that binding
p4302
aVShow us the server's config
p4303
aVMarc
p4304
as(dp4305
g10
V13302
p4306
stp4307
a((dp4308
g2
(lp4309
VThe show endpoint
p4310
aVtv on Channel9 had a plethora of screencast by Aaron Skonnard on using WCF - including a whole bunch of screencasts on using the REST features of WCF
p4311
aVHighly recommended
p4312
aVCheck them out, well worth your time
p4313
aVMarc
p4314
aVEDIT:
p4315
aVIf you - for whatever reason - really cannot use the REST starter kit, you might want to look at the ADO
p4316
aVNET Data Services, as mentioned here: http://stackoverflow
p4317
aVcom/questions/60477/getting-started-with-rest
p4318
aVThat's basically REST based on WCF, exposed as ATOM feeds
p4319
as(dp4320
g10
V13302
p4321
stp4322
a((dp4323
g2
(lp4324
VI am no expert on Windows authentication schemes in the wild, but I would assume that the server that implements a given service must have a way to validate the Windows credentials passed to it - either by being on the same domain and having access to the same Active Directory as the caller, or at least by having a trust relationship to the caller's domain (not sure if that'll work, though)
p4325
aVYou most certainly cannot use Windows credentials if the caller and the server are on two totally separate Windows domains that aren't even in a trust relationship, IMHO
p4326
aVMarc
p4327
as(dp4328
g10
V13302
p4329
stp4330
a((dp4331
g2
(lp4332
VYou answered your question already - the app
p4333
aVconfig is added because the web reference needs to store the URL to the service somewhere
p4334
aVIt's better stored in a config file rather than hardcoded into your *
p4335
aVcs file, no
p4336
aVIf you have dependant assemblies all used from a main app, only the main app's app
p4337
aVconfig (renamed to mainapp
p4338
aVexe
p4339
aVconfig) will be used - the dependant assemblies will use the main app's config file
p4340
aVThe app
p4341
aVconfig created by adding a web reference only exists as a place where you can check out what settings need to go into your main app
p4342
aVconfig
p4343
aVIf you have a separate place where you configure all your webservice URL's (e
p4344
ag164
aVa database table or something), you can toss out the generated app
p4345
aVconfig's - no problem there
p4346
aVMarc
p4347
as(dp4348
g10
V13302
p4349
stp4350
a((dp4351
g2
(lp4352
VAs soon as you define your XML namespace used in the XML elements, you can easily import this - no problem
p4353
aVYou need to have your XML look something like this:
p4354
aVAfter I do this, your two lines of code work like a charm and the data gets imported, no problem (into 5 tables inside the DataSet)
p4355
aVMarc
p4356
as(dp4357
g10
V13302
p4358
stp4359
a((dp4360
g2
(lp4361
VNo, the order of the columns in a SQL database table is totally irrelevant - except for display / printing purposes
p4362
aVThere's no point in reordering columns - most systems don't even provide a way to do that (except dropping the old table and recreating it with the new column order)
p4363
aVMarc
p4364
aVEDIT: from the Wikipedia entry on relational database, here's the relevant portion which to me clearly shows that column order should never be of concern:
p4365
aVA relation is defined as a set of n-tuples
p4366
aVIn both mathematics and the relational database model, a set is an unordered collection of items, although some DBMSs impose an order to their data
p4367
aVIn mathematics, a tuple has an order, and allows for duplication
p4368
ag1015
aVF
p4369
aVCodd originally defined tuples using this mathematical definition
p4370
aVLater, it was one of E
p4371
ag4369
aVCodd's great insights that using attribute names instead of an ordering would be so much more convenient (in general) in a computer language based on relations
p4372
aVThis insight is still being used today
p4373
as(dp4374
g10
V13302
p4375
stp4376
a((dp4377
g2
(lp4378
VThere are quite a few:
p4379
aVstatic client-side ID's
p4380
aVbetter dynamic data support
p4381
aVbetter support for the routing feature (made popular by ASP
p4382
aVNET MVC) for webforms apps
p4383
aVmany Ajax enhancements
p4384
aVRead Scott Hanselman's excellent blog post (series) on
p4385
aVNET 4 here
p4386
aVAnd checkout a great whitepaper on ASP
p4387
aVNET 4
p4388
aV0 here
p4389
aVMarc
p4390
as(dp4391
g10
V13302
p4392
stp4393
a((dp4394
g2
(lp4395
VYes, I don't see any reason why this wouldn't work over netTcp Binding
p4396
aVBy default, netTcp is using transport level security already, but also Windows credentials
p4397
aVJust turn those off, and you should be good to go
p4398
aVMarc
p4399
as(dp4400
g10
V13302
p4401
stp4402
a((dp4403
g2
(lp4404
VIf you have the luxury of doing new development, DEFINITELY go with WCF
p4405
aVIt offers much more functionality, much more options for security, bindings, and way more extension points should you need to tweak your system
p4406
aVWCF also support way more industry-standard interoperability scenarios than anything else before, so you should be more than covered in this area, too
p4407
aVHere are a few articles specifically on WCF security:
p4408
aVFundamentals of WCF Security
p4409
aVProgramming WCF Security
p4410
aVWCF Security Guidance
p4411
aVNo question here - it's a slam dunk - go with WCF
p4412
aVMarc
p4413
as(dp4414
g10
V13302
p4415
stp4416
a((dp4417
g2
(lp4418
VFirst off - I've never done this myself
p4419
aVThere's a really excellent series (14
p4420
aVparts) on the whole topic of ASP
p4421
aVNET 2
p4422
aV0 membership, roles and profile provider systems by Scott Mitchell at 4 Guys from Rolla
p4423
aVAccording to my understanding, you should be able to configure this behavior you are looking for by using basically these two sections in your web
p4424
aVconfig:
p4425
aVI would think this ought to work :-)
p4426
as(dp4427
g10
V13302
p4428
stp4429
a((dp4430
g2
(lp4431
VVisual Studio has been shipped with a fairly nice collection of bitmaps and icons for quite some time now - a well-hidden and often unknown treasure
p4432
aVThere's a ZIP file (almost 10 MB
p4433
aVcontaining those stock icons and bitmaps at  (for VS 2008 - similar path for VS 2005), but as far as I know, it's an optional installation component - so you might not have it installed
p4434
aVThese icons and bitmaps are actually really quite nice
p4435
aVAnd as far as I understand the rules (but the standard I-am-not-a-lawyer disclaimer applies) these icons and bitmaps can be used in your Visual Studio projects
p4436
aVMarc
p4437
as(dp4438
g10
V13302
p4439
stp4440
a((dp4441
g2
(lp4442
VI'm actually looking forward to using Entity Framework in its v4 version hopefully Real Soon Now
p4443
aVGranted, in our case it's accompanied by getting rid of a god-awful-in-house ORM which is no longer supported, which is worse than the plague - so EF v4 looks like a god-send to me
p4444
aV:-)
p4445
aVMarc
p4446
as(dp4447
g10
V13302
p4448
stp4449
a((dp4450
g2
(lp4451
VI have done this based on Will's work
p4452
aVbut I want to verify that this is the
p4453
aVcorrect approach before posting the
p4454
aVcode
p4455
aVI think this is a great approach (kudos to Will for this posting
p4456
aVI don't think Will or you have missed anything here
p4457
aVImplementing IErrorHandler is the preferred way of capturing all possible server-side exceptions that could otherwise cause the communication channel to be faulted (torn down) and thus it's a natural place to hook in some logging like ELMAH
p4458
aVMarc
p4459
as(dp4460
g10
V13302
p4461
stp4462
a((dp4463
g2
(lp4464
VYour client's config file could look something like this:
p4465
aVThen in code, you can create such an endpoint (client proxy) based on its name and thus you can pick whichever location you need
p4466
aVThere's nothing stopping you from creating multiple client proxies, either
p4467
aVSo you can connect to multiple server endpoints using multiple client proxies, no problem
p4468
aVAlternatively, you can of course also create an instance of "WsHttpBinding" and "EndpointAddress" in code, and set the necessary properties (if any), and then call the constructor for the client proxy with this ready made objects, thus overriding the whole app
p4469
aVconfig circus and creating whatever you feel is needed:
p4470
aVMarc
p4471
as(dp4472
g10
V13302
p4473
stp4474
a((dp4475
g2
(lp4476
VWCF offers much nicer extension points than ISAPI filters
p4477
aVYou could e
p4478
ag164
aVcreate a client side message inspector that gets called just before the message goes out to the server, and then also gets called when the response comes back, and thus you could fairly easily measure the time needed for a service call from a client perspective
p4479
aVCheck out the  interface - that might be what you're looking for
p4480
aVAlso see this excellent blog entry on how to use this interface
p4481
aVMarc
p4482
as(dp4483
g10
V13302
p4484
stp4485
a((dp4486
g2
(lp4487
VI don't know what exactly your requirements are, and how many documents and what sizes we're talking about here
p4488
aVSQL Server 2005 does allow you to specify XML schemas so you can definitely get some validation into the equation which is certainly beneficial
p4489
aVAs for XML indexing - you can index on three different strategies once you've created a basic primary XML index
p4490
aVthe first index type more for optimizing the XPath to a single XML node when you do lots of XPath-based queries for nodes ()
p4491
aVthe second index type more for optimizing access to values inside your XML nodes, when you search more based on values in the XML document ()
p4492
aVthe third is somewhat of a hybrid of the two above (which I never quite groked myself, to be honest; )
p4493
aVThe XML indexes worked quite well in our samples, but the main drawback in our case was the sheer size of the indexes on disk
p4494
aVOur 1
p4495
aV3 GB database grew to over 11 GB just by adding a PRIMARY XML and a XML FOR PATH index to roughly 45'000 entries with an XML field
p4496
aVDue to disk constraints, we ended up having to take down those indices :-(
p4497
aVThis is really not all that surprising considering how the XML index will be built-up with entries for each XML node, attribute and so forth - it's just lots of data
p4498
aVWhat we've done in the end is create a number of stored functions that reach into the XML from our  table, and we extract those bits and pieces that we need most often
p4499
aVThose are now stored on the table as computed, persisted properties
p4500
aVThis is as fast as "proper" fields on the  table, it's always up to date and gets set automatically when new data is inserted, and we hardly ever need to really use any significant XQuery requests anymore
p4501
aVWhat I can say from personal experience is that the XML support in SQL Server 2005 is really quite profound and well thought out, in my opinion
p4502
aVSo all in all, I would say - go give it a try
p4503
aVYou won't really be able to tell whether it works and scales nicely enough in your specific case until you've given it a try
p4504
aVMarc
p4505
as(dp4506
g10
V13302
p4507
stp4508
a((dp4509
g2
(lp4510
VThe general best practive for WCF services would be to have the per-call, single-instance model whenever possible
p4511
aVThis gives you the best throughput, the best and simplest behavior in the service instance
p4512
aVSo whenever possible, and unless you have a really compelling reason, use this model
p4513
aVIt seems that in your case, creating the service instance is a rather expensive operation
p4514
aVMaybe you need to get this cleaned up somehow - make the actual service instance very lean and lightweight so it can be created and disposed of in a blink of an eye (or less), and then have some background worker processes (or possibly a pool of those, as suggested by Anthony) which you can then call from your actual service instances
p4515
aVMarc
p4516
as(dp4517
g10
V13302
p4518
stp4519
a((dp4520
g2
(lp4521
VYou could definitely try to increase the  and  in your service throttling behavior to the standard values of 30 or so and see if that makes the error go away
p4522
aVServer too busy would seem to indicate that more requests have come in than area allowed by your service throttling behavior, and they've been discarded since no service instance became available to service them within the given timeout period
p4523
aVMarc
p4524
as(dp4525
g10
V13302
p4526
stp4527
a((dp4528
g2
(lp4529
VWhat version of the
p4530
aVNET framework can you use
p4531
aVSearching and looking up stuff in AD has become extremely easy in
p4532
aVNET 3
p4533
aV5 - see this great MSDN article by Ethan Wilanski and Joe Kaplan on using the security principals API for that
p4534
aVIf you're not on
p4535
aVNET 3
p4536
aV5 yet, you'll have to use the  class and set up the search filters as you need
p4537
aVGetting the LDAP filter right is probably the biggest obstacle
p4538
aVRobbie Allen also has two great intro article on System
p4539
aVDirectoryServices programming:
p4540
aV- Part 1
p4541
aV- Part 2
p4542
aVThere are some really good resources at http://www
p4543
aVdirectoryprogramming
p4544
aVnet (Joe Kaplan's site - he's a Microsoft Active Directory MVP), and Richard Mueller has some great reference excel sheets on what properties are available for each of the ADSI providers, and what they mean, and how their LDAP name is - see http://www
p4545
aVrlmueller
p4546
aVnet
p4547
aVMarc
p4548
aVEDIT: Ok- here's the
p4549
aVNET 2
p4550
aV0 / 3
p4551
aV0 approach:
p4552
aVHope this helps
p4553
aVMarc
p4554
as(dp4555
g10
V13302
p4556
stp4557
a((dp4558
g2
(lp4559
VIf you want to stick to Winforms by all means, there are quite a few third-party solutions out there (for instance Empinia or the Genesis Hybrid Smartclient Framework being shown on CodeProject) as well besides the Smart Client Software Factory
p4560
aVThe question here remains whether they're stable enough and have enough stamina to still be around in 3-4 years
p4561
aVOn the other hand, if you're looking at this fairly long time frame, considering WPF might really pay off
p4562
aVYes, it's a learning curve, and yes, the tool support in VS 2008 isn't quite up to snuff just yet
p4563
aVBut things will get a lot better with VS 2010, and Microsoft will be investing a lot of manpower in WPF - VS 2010 itself is written in WPF
p4564
aVFor WPF, there's P&P; guidance in the form of Prism, which is very promising and looks very well thought out
p4565
aVGoing into WPF also brings you additional benefits of basically knowing Silverlight "for free" (it's a subset of WPF, at its core)
p4566
aVSo that might be an additional benefit
p4567
aVMarc
p4568
as(dp4569
g10
V13302
p4570
stp4571
a((dp4572
g2
(lp4573
VSeveral database systems (since you didn't specify yours, I'll keep this general) do offer the SQL:2003 Standard statement called  which will basically allow you to
p4574
aVinsert new rows into a target table from a source which don't exist there yet
p4575
aVupdate existing rows in the target table based on new values from the source
p4576
aVoptionally even delete rows from the target that don't show up in the import table anymore
p4577
aVSQL Server 2008 is the first Microsoft offering to have this statement - check out more here, here or here
p4578
aVOther database system probably will have similar implementations - it's a SQL:2003 Standard statement after all
p4579
aVMarc
p4580
as(dp4581
g10
V13302
p4582
stp4583
a((dp4584
g2
(lp4585
VYes, GUID's are really bad for clustered indexes, since the GUIDs is by design very random and thus leads to massive fragmentation and thus performance problems
p4586
aVSee Kim Tripp's blog - most notably "The CLustered Index Debate continues" and "GUIDs as PRIMARY and/or CLUSTERED key" - for a lot of valuable background info
p4587
aVIf you really need to have an index on these TWO columns, I'd suggest a non-clustered index - it can be a primary index - just better not a clustered index
p4588
aVMarc
p4589
as(dp4590
g10
V13302
p4591
stp4592
a((dp4593
g2
(lp4594
VThere's a really good book my Michele Leroux Bustamante called Learning WCF (something like a pre-cursor to Juwal Lowy's more advanced book)
p4595
aVShe goes into great detail on all topics of WCF, even some very advanced ones (like federated authentication)
p4596
aVMichele has also recorded a 15-part screencast series on MSDN called "WCF Top-to-Bottom" which is a really great way to get started into WCF programming
p4597
aVCheck out her link collection for that series
p4598
aVMarc
p4599
as(dp4600
g10
V13302
p4601
stp4602
a((dp4603
g2
(lp4604
VAccording to this article on MSDN, it looks as if you need to specify your credentials differently:
p4605
aVCould you try to use this code and try to pass the Windows credentials into
p4606
aVDoes that work
p4607
aVMarc
p4608
as(dp4609
g10
V13302
p4610
stp4611
a((dp4612
g2
(lp4613
VYou have two identical base addresses defined:
p4614
aVThat is the cause of your problems - when connecting to , WCF doesn't know which service you mean
p4615
aVThe base address must be UNIQUE within its "schema" (e
p4616
ag164
aVhttp, net
p4617
aVtcp etc
p4618
aVMarc
p4619
aVEDIT: if you want to be able to retrieve your metadata using the browser and navigating to a URL to get it, you'll need to activate the  in your service behavior option
p4620
aVOtherwise, you'll only be able to get at your metadata using a SOAP call over net
p4621
aVtcp - e
p4622
ag164
aVusing the "WcfTestClient
p4623
aVexe" app which is in your Visual Studio 9/Common7/IDE folder
p4624
aVEDIT 2: you have defined a number of extra bindings and behaviors for MEX, but since none of your mex endpoints is actually referencing any of those settings, they're not being used
p4625
as(dp4626
g10
V13302
p4627
stp4628
a((dp4629
g2
(lp4630
VNo, not at all
p4631
aVNegative values are just as valid as INTegers as positive ones
p4632
aVNo problem
p4633
aVBasically, internally, they're all just 4 bytes worth of zeroes and ones :-)
p4634
aVMarc
p4635
as(dp4636
g10
V13302
p4637
stp4638
a((dp4639
g2
(lp4640
VYou might also want to check out this excellent article Managing Directory Security Principals in the
p4641
aVNET 3
p4642
aV5 Framework by AD MVP's Ethan Wilanski and Joe Kaplan in MSDN Magazine - if you can use
p4643
aVNET 3
p4644
ag73
aVHighly recommended - excellent read
p4645
aVMarc
p4646
as(dp4647
g10
V13302
p4648
stp4649
a((dp4650
g2
(lp4651
VFor a simple enough application, the big plus of using the LINQ entities directly is - simplicity
p4652
aVYou can avoid having Yet Another Layer in your code, you can avoid having to write a lot of boilerplate logic to map from your business object to your LINQ entities (although there are tools like AutoMapper which can help a lot here)
p4653
aVOn the other hand, as you say - your database probably isn't a spitting image of your domain model
p4654
aVThen again, if you need this capability to map between a given physical database model and your logical domain model, maybe you should have a look at the Entity Framework instead
p4655
aVThat's exactly the mainstay of EF - these two models and the mapping layer between them
p4656
aVMarc
p4657
as(dp4658
g10
V13302
p4659
stp4660
a((dp4661
g2
(lp4662
VYes, an "AFTER UPDATE" trigger on that particular table and field might give you some clues as to when and why the field gets changed
p4663
aVFrom Books Online:
p4664
aVA trigger can execute basically any T-SQL code - if you have database mail set up correctly, it could send you an e-mail, yes
p4665
aVOr it can write an audit entry into another table or something like that
p4666
aVEDIT: If you need to find out which statements updated your column, you might be actually better off running a trace on the server, limited to that specific table, and just trace what's happening there
p4667
aVI don't think a trigger can give you that information (which code caused the update to happen)
p4668
aVMarc
p4669
as(dp4670
g10
V13302
p4671
stp4672
a((dp4673
g2
(lp4674
VI would think you need to set your elementFormDefault to "unqualified" if you want to avoid the prefixes on your XML elements
p4675
aVThe rest should be fine, I think - the namespace is the same between your master and your imported XSD - that's fine
p4676
aVYou specify the xmlns= without a prefix - that's fine
p4677
aVYou should be good to go
p4678
aVMarc
p4679
as(dp4680
g10
V13302
p4681
stp4682
a((dp4683
g2
(lp4684
VWell, there's two parts to the equation:
p4685
aVyou could have a server certificate which the service uses to authenticate itself to the clients (to prove it's really the service it claims to be)
p4686
aVyou could have a client certificate which the client needs to prove its identity to the server
p4687
aVWhich are you interested in
p4688
aVTypically, if you have a server/service certificate, the client will either "know" the server's public key (it could be installed in the client's certificate store, e
p4689
ag164
aVby an installation program or by downloading and installing it), or it will inquire about the server's certificate at the time the proxy gets created and stores the server's public key in the local client config file for later use
p4690
aVThis config will then again be installed with the app on the client
p4691
aVIf the client wants to authenticate itself against the service, it will definitely need to have its client certificate installed locally on the client machine's cert store
p4692
aVI'd recommend checking out the WCF Security Guidance - it's a great resource, and they can explain how to do certain scenarios much better than I can
p4693
aVOn a all-Windows environment with everyone in the same domain, this seems like a bit of overkill - why not just use the built-in, Windows-provided credentials
p4694
aVThat would be a lot easier, I would think
p4695
aVMarc
p4696
as(dp4697
g10
V13302
p4698
stp4699
a((dp4700
g2
(lp4701
VGoing to straight "naked" ADO
p4702
aVNET and doing all the DAL work manually in code seems like a lot of effort
p4703
aVI would definitely recommend looking at an OR-mapper such as have been recommended by others (NHibernate, Subsonic etc
p4704
aVIf your backend in SQL Server and you're on
p4705
aVNET 3
p4706
aV0 or higher, you could also look into Linq2SQL (rumors of its death are greatly exaggerated) for simpler scenarios (1:1 mapping from database tables to your database-layer objects), or Entity Framework for more advanced scenarios (lots of tables, lots of object inheritance in your domain model, complicated mapping scenarios)
p4707
aVEF has been getting a lot of bad rap lately, which is only partly justified, IMHO, and the new version, EF v4 (due out with
p4708
aVNET 4
p4709
aV0 and VS 2010 sometime this or next year) looks really promising
p4710
aVMarc
p4711
as(dp4712
g10
V13302
p4713
stp4714
a((dp4715
g2
(lp4716
VYou will need to manually create the associations between the tables in your EF model
p4717
aVIn the Entity Framework designer surface, you basically right-click on your table and from the context menu, you need to choose the "Add -> Association" option
p4718
aVIn the dialog box that pops up, you can establish the association between your two tables - even without foreign key relationship in the underlying database
p4719
aVMarc
p4720
as(dp4721
g10
V13302
p4722
stp4723
a((dp4724
g2
(lp4725
VI would favor using the more focused "sys" views - sys
p4726
aVprocedures instead of sys
p4727
aVobjects
p4728
aVYou'll need to join it with the sys
p4729
aVschemas view to get schema name and such
p4730
aVI would start to get away from using "sysobjects" since Microsoft clearly states in Books Online that "sysobjects" is subject to removal in a future release:
p4731
aVThis SQL Server 2000 system table is included as a view for backward compatibility
p4732
aVWe recommend that you use the current SQL Server system views instead
p4733
aVTo find the equivalent system view or views, see Mapping SQL Server 2000 System Tables to SQL Server 2005 System Views
p4734
aVThis feature will be removed in a future version of Microsoft SQL Server
p4735
aVAvoid using this feature in new development work, and plan to modify applications that currently use this feature
p4736
aVMarc
p4737
as(dp4738
g10
V13302
p4739
stp4740
a((dp4741
g2
(lp4742
VStandard net
p4743
aVtcp binding uses Windows credentials by default, and those really require client and service to be in the same Windows domain
p4744
aVIs this the case here
p4745
aVOK, sorry, you mentioned security=None (your listings weren't properly formatted so I only saw a fraction of the actual config)
p4746
aVI guess your problem really lies in the addresses used:
p4747
aVWhen using net
p4748
aVtcp binding, you have to specify that before the address, so change this on both the client and the server to:
p4749
aVAlso, what I don't quite understand is your title: it mentions "streaming" - have you specified streaming mode anywhere
p4750
aVIn your config or your service contracts
p4751
aVMarc
p4752
as(dp4753
g10
V13302
p4754
stp4755
a((dp4756
g2
(lp4757
VMy question is whether it makes sense to split the contract and implementation into separate DLLs, and whether the application(s) should reference the Common/Impl libraries, or if the application(s) should just make a service reference (using "Create Service Reference" or SvcUtil)
p4758
aVI'm thinking it might make sense for the apps to just make a service refernce, so you don't couple the Common/Impl to the app
p4759
aVIn this case, does it even make sense to create a client class in MyService
p4760
aVImpl
p4761
aVBingo - you "got" it
p4762
aVEven when theoretically, technically can share contracts and interfaces using shared assemblies, I would rather recommend not to
p4763
aVFirst of all, other clients (e
p4764
ag164
aVJava, PHP, Ruby) won't be able to use shared
p4765
aVNET assemblies
p4766
aVSo suddenly they use a different interface than your client which might cause subtle variations which could be hard to debug
p4767
aVSecondly, SOA is all about decoupling parts of your system into separate, distinct entities with well defined service borders
p4768
aVSharing assemblies introduces dependencies you're trying to avoid
p4769
aVSo therefore I would agree you're on the right track - whether or not to separate the contract interfaces from their concrete implementation can be debated
p4770
aVOne benefit might be if you ever need to create a second, third implementation of the same interfaces, or if you have certain commonly used helper interfaces in a separate assembly used by various of your services
p4771
aVOne more assembly doesn't really hurt - my recommendation would be to do exactly as you outlined in your post
p4772
aVMarc
p4773
as(dp4774
g10
V13302
p4775
stp4776
a((dp4777
g2
(lp4778
VI totally agree with Josh - the positions of the fields are indeed such as you specify them in your SQL query text
p4779
aVBUT: I would still prefer to use the column names, since it's more robust
p4780
ag1015
ag164
aVwhat if you need to add a field to your SQL query
p4781
aVNow suddenly you have to rewrite all your code to change the positions
p4782
aVWhat I normally do outside the loop that enumerates through all the rows returned by the data reader is determine the positions of each field I'm interested in:
p4783
aVand then I use these positions inside my loop handling the data to get quick access to the individual fields
p4784
aVThat way you determine the positions only once, but you're using positions in your looping over the data - the best of both worlds
p4785
aV:-)
p4786
aVMarc
p4787
as(dp4788
g10
V13302
p4789
stp4790
a((dp4791
g2
(lp4792
VThe timeout is called "sendTimeout" and you can configure it on your binding section in your config file, or in code - your choice
p4793
aVconfig:
p4794
aVThis will set the timeout to 3 minutes
p4795
aVMarc
p4796
as(dp4797
g10
V13302
p4798
stp4799
a((dp4800
g2
(lp4801
VMy recommendation: make them just as big as you REALLY need them
p4802
ag1015
ag164
aVfor a zip code column, 10-20 chars are definitely enough
p4803
aVDitto for a phone number
p4804
aVE-Mails might be longer, 50-100 chars
p4805
aVNames - well, I usually get by with 50 chars, ditto for first names
p4806
aVYou can always and easily extend fields if you really need to - that's no a big undertaking at all
p4807
aVThere's really no point in making all varchar/nvarchar fields as big as they can be
p4808
aVAfter all, a SQL Server page is fixed and limited to 8060 bytes per row
p4809
aVHaving 10 fields of NVARCHAR(4000) is just asking for trouble
p4810
aV(since if you actually try to fill them with too much data, SQL Server will barf at you)
p4811
aVIf you REALLY need a really big field, use NVARCHAR/VARCHAR(MAX) - those are stored in your page, as long as they fit, and will be sent to "overflow" storage if they get too big
p4812
aVNVARCHAR vs
p4813
aVVARCHAR: this really boils down to do you really need "exotic" characters, such as Japanese, Chinese, or other non-ASCII style characters
p4814
aVIn Europe, even some of the eastern European characters cannot be represented by VARCHAR fields anymore (they will be stripped of their hachek (
p4815
aVspelling
p4816
aVWestern European languages (English, German, French, etc
p4817
aVare all very well served by VARCHAR
p4818
aVBUT: NVARCHAR does use twice as much space - on disk and in your SQL Server memory - at all times
p4819
aVIf you really need it, you need it - but do you REALLY
p4820
aV:-) It's up to you
p4821
aVMarc
p4822
as(dp4823
g10
V13302
p4824
stp4825
a((dp4826
g2
(lp4827
VYou cannot - a XSD describes the DATA aspects e
p4828
ag164
aVof a webservice - the WSDL describes the FUNCTIONS of the web services (method calls)
p4829
aVYou cannot typically figure out the method calls from your data alone
p4830
aVThese are really two separate, distinctive parts of the equation
p4831
aVFor simplicity's sake you would often import your XSD definitions into the WSDL in the  tag
p4832
aVMarc
p4833
aV(thanks to Cheeso for pointing out my inaccurate usage of terms)
p4834
as(dp4835
g10
V13302
p4836
stp4837
a((dp4838
g2
(lp4839
VYes, definitely go with WCF
p4840
aVIf you have the option to create a new webservice, there's really no point to use ASMX anymore (unless you're stuck on
p4841
aVNET 1
p4842
aVx/2
p4843
aVx)
p4844
aVAnd WCF is ALSO the better choice if you need to support Interop with non-
p4845
aVNET clients like Java or PHP or whatever else you might need to support
p4846
aVIt supports the WS-* webservice specifications (ASMX webservices don't) and has many more ways to tweak its communication with clients
p4847
aVIt's more robust, it has way more support for security settings - it's just plain better all around
p4848
aVUse WCF - you won't regret it
p4849
aVMarc
p4850
as(dp4851
g10
V13302
p4852
stp4853
a((dp4854
g2
(lp4855
VAs Emmanuel points out - MSMQ messages are by design one-way and have no response, really
p4856
aVYour best solution would be to have a response queue where the "other service" can drop his response messages into
p4857
aVYour client would then have to monitor that queue, e
p4858
ag164
aVcheck it once in a while (every minute, every 30 minutes - whatever makes sense for you) for new messages, and handle those
p4859
aVThere's no duplex (two-way) MSMQ channels - but you can easily create a pair of separate queues for both directions
p4860
aVMarc
p4861
as(dp4862
g10
V13302
p4863
stp4864
a((dp4865
g2
(lp4866
VYou will need to create a stored function for that:
p4867
aVYou can then use this stored function like this:
p4868
aVMarc
p4869
as(dp4870
g10
V13302
p4871
stp4872
a((dp4873
g2
(lp4874
VThe S
p4875
aVDS
p4876
aVAM namespace was introduced in
p4877
aVNET 3
p4878
aV5, and unfortunately, there's no 2
p4879
aV0 version of it
p4880
aVYou can query the current Windows user in an ASP
p4881
aVNET app using WindowsIdentity
p4882
aVGetCurrent()
p4883
aVName - this gives you DOMAIN\u005cUserName
p4884
aVThen you'd have to do a user search in AD for that user with a DirectorySearcher object in order to find the corresponding DirectoryEntry
p4885
aVThis will give you all the bits and pieces of that user
p4886
aVIt's a bit complicated and involved in
p4887
aVNET 2
p4888
aV0 - can't change that :-(
p4889
aVMarc
p4890
as(dp4891
g10
V13302
p4892
stp4893
a((dp4894
g2
(lp4895
VThere's two things you can do:
p4896
aVeither just generate the GUID in your C# client side code and use that value
p4897
aVcreate a DEFAULT constraint on the GUID column in SQL Server that defaults to  for the column - the SQL Server will make SURE to always add a default - unless you specify a value yourself
p4898
aVAs for the self-updating date/time columns - here you probably have to use either client-side logic to do that, or if you want to do it on SQL Server, you'll have to write a trigger
p4899
aVThat's really the only way to update a specific column everytime the row gets updated - there's no "autoupdate" constraint or anything like this (and the default constraint only work on INSERTs, not updates)
p4900
aVSomething like this might work:
p4901
aVMarc
p4902
as(dp4903
g10
V13302
p4904
stp4905
a((dp4906
g2
(lp4907
VBesides all the other excellent points that have already been made, I would add one more word of caution against using large fields as clustering keys in SQL Server (if you're not using SQL Server, then this probably doesn't apply to you)
p4908
aVI add this because in SQL Server, the primary key on a table by default also is the clustering key (you can change that, if you want to and know about it, but most of the cases, it's not done)
p4909
aVThe clustering key that determines the physical ordering of the SQL Server table is also being added to every single non-clustered index on that table
p4910
aVIf you have only a few hundred to a few thousand rows and one or two indices, that's not a big deal
p4911
aVBut if you have really large tables with millions of rows, and potentially lots of indices to speed up the queries, this will indeed cause a lot of disk space and server memory to be wasted unnecessarily
p4912
ag1015
ag164
aVif your table has 10 million rows, 10 non-clustered indices, and your clustering key is 26 bytes instead of 4 (for an INT), then you're wasting 10 mio
p4913
aVby 10 by 22 bytes for a total of 2
p4914
aV2 billion bytes (or 2
p4915
aV2 GBytes approx
p4916
aV- that's not peanuts anymore
p4917
aVAgain - this only applies to SQL Server, and only if you have really large tables with lots of non-clustered indices on them
p4918
aVMarc
p4919
as(dp4920
g10
V13302
p4921
stp4922
a((dp4923
g2
(lp4924
VThe basic best practice recommendation would be to use per-call, single instance services
p4925
aVThat's the easiest to create, no concurrency nightmares etc
p4926
aVBUT: of course each time you call the service, a service instance is created and the database backend is queried
p4927
aVIf ever possible, try to stick with this
p4928
aVTry to put the caching logic into the database - if you have enough RAM, most of your frequently requested data will stay in memory
p4929
aVGoing to a ConcurrencyMode = multiple in your WCF services causes all sorts of concurrency problems to show up that you need to be extremely careful with
p4930
aVTry to avoid this whenever possible
p4931
aVTry per-call, single-instance first and ONLY optimize if you REALLY have to
p4932
aVMarc
p4933
as(dp4934
g10
V13302
p4935
stp4936
a((dp4937
g2
(lp4938
VPlease - do not go around using cursors again
p4939
aV:-) SQL is set-based - avoid cursors whenever you can
p4940
aVAnd here you can - easily
p4941
aVSo for each customer, you need to determine the number of users first, and then do a simple calculation, and update the customer
p4942
aVMy suggestion would be:
p4943
aVcreate a little function that calculates the number of users for a given customer
p4944
aVcreate a second little function to do the same to calculate the total disk usage
p4945
aVwrite your stored proc as a simple update statement that does the calculation
p4946
aVCREATE PROCEDURE dbo
p4947
aVUpdateCustomers()
p4948
aVAS BEGIN
p4949
aVUPDATE Customers
p4950
aVSET y = (dbo
p4951
aVGetTotalDiskUsage(CustomerID) - dbo
p4952
aVGetTotalUsers(CustomerID) * 200) / 50
p4953
aVEND
p4954
aVSeems too easy, almost :-)
p4955
aVMarc
p4956
as(dp4957
g10
V13302
p4958
stp4959
a((dp4960
g2
(lp4961
VNo, not really - Entity Framework is basically a fairly strict layer above your actual database
p4962
aVYour queries are formulated in ESQL - Entity SQL - which is first of all targeted towards your entity model, and since EF supports multiple database backends, you can't really send "native" SQL directly to your backend
p4963
aVThe NOLOCK query hint is a SQL Server specific thing and won't work on any of the other supported databases (unless they've also implemented the same hint - which I strongly doubt)
p4964
aVMarc
p4965
as(dp4966
g10
V13302
p4967
stp4968
a((dp4969
g2
(lp4970
VIt's actually really easy to do :-) SqlDbType is an enum, and there's a nice static function on the Enum class which accomplishes just what your looking for:
p4971
aVWith this, you should have no trouble converting the output from your INFORMATION_SCHEMA query into a collection of SqlParameters
p4972
as(dp4973
g10
V13302
p4974
stp4975
a((dp4976
g2
(lp4977
VSure - you can load a service model configuration from any config file you wish :-) No problem at all
p4978
aVIf you need to do this frequently, you might want to consider creating your own custom ServiceHost class
p4979
aVOn how to do this, see this excellent blog post, or this one in particular for hosting a service inside IIS
p4980
aVMarc
p4981
as(dp4982
g10
V13302
p4983
stp4984
a((dp4985
g2
(lp4986
VThe fact you're using GUID's as a clustered index will most definitely negatively impact your performance
p4987
aVEven with the NEWSEQUENTIALGUID, the GUIDs aren't really sequential - they're only partially so
p4988
aVTheir randomness by nature will definitely lead to higher index fragmentation and thus to less optimal seek times
p4989
aVAdditionally, if you have a 16-byte GUID as your clustered key, it will be added to any non-clustered index on that table
p4990
aVThat might not sound so bad, but if you have 10 mio
p4991
aVrows, 10 non-clustered indices, using a 16-byte GUID vs
p4992
aVa 4-byte INT will cost you 1
p4993
aV2 GByte of storage wasted - and not just on disk (which is cheap), but also in your SQL server's memory (since SQL server always loads entire 8k pages into 8k blocks of memory, no matter how full or empty they are)
p4994
aVI can see the point of using a GUID as a primary key - they're almost 100% guarantee to be unique is appealing to developers
p4995
aVBUT: as a clustered key, they're a nightmare for your database
p4996
aVMy best practice: if I really need a GUID as primary key, I add a 4-byte INT IDENTITY to the table which then serves as the clustered key - the results are way better that way
p4997
aVIf you have a non-clustered primary key, your queries using list of GUIDs will be just as fast as if it where a clustered primary key, and by not using GUIDs for your clustered key, your table will perform even better in the end
p4998
aVRead up more on clustered key and why it's so important to pick the right one in Kimberly Tripps' blog - the the Queen of Indexing and can explain things much better than I do:
p4999
aVGUIDs as PRIMARY KEY and/or clustered key
p5000
aVThe clustered index debate continues
p5001
aVEver-increasing clustering key - the Clustered Index Debate
p5002
aVagain
p5003
aVMarc
p5004
as(dp5005
g10
V13302
p5006
stp5007
a((dp5008
g2
(lp5009
VSoemthing like this would work on MS SQL Server:
p5010
aVThe DATEADD function call basically subtracts (day-1) DAYS from the current date --> you always get the first of whatever month that date is in
p5011
aVSort by it and you're done
p5012
aV:-)
p5013
aVADditionally, you could also add this functionality to your table as a "computed column" and then use that for easy acccess:
p5014
aVThen your query would be even simpler:
p5015
aVMarc
p5016
as(dp5017
g10
V13302
p5018
stp5019
a((dp5020
g2
(lp5021
VYes, the wsHttpBinding protocol supports what is called "reliable sessions", where intermittent network blackouts can be caught and handled
p5022
aVThe sender might need to resend certain bits of the information, but basically, this will give you a certain level of safety
p5023
aVCheck out Michele Leroux Bustamante's 15-part series "WCF Top To Bottom" for more information - installment no
p5024
aV12 deals specifically with Reliable Messaging
p5025
aVOr check out the MSDN introduction to reliable messaging in WCF
p5026
aVMarc
p5027
as(dp5028
g10
V13302
p5029
stp5030
a.