(lp0
((dp1
S'text'
p2
(lp3
VUse the  method
p4
aVYou can reach the response object via the request object
p5
aVThe latter you can reach via acquisition (), or in views by accessing the passed-in request object, usually via :
p6
aVwhere  end up as extra cookie parameters
p7
aVThus, turning a cookie into a non-session cookie requires a  keyword, limiting the cookie to a path is a  keyword to the  method
p8
aVThe usual browser cookie rules apply here
p9
aVTo expire a cookie already set in the browser, you could either use a  keyword, or you could use the  method, which does this for you:
p10
aVIn this case you can still include options like the  or other cookie flags, but the method will override the  and  options to ensure the cookie is deleted by the browser
p11
aVAlthough you could use Zope's  support, you really need to think through the scalability issues
p12
aVFor example, you need to think through how session data will be shared across a cluster if you use ZEO or RelStorage
p13
aVIt is generally preferable to avoid using  altogether if scalability is going to be an issue
p14
as(dp15
S'author'
p16
V100297
p17
stp18
a((dp19
g2
(lp20
VUse Products
p21
aVsignalstack; it was designed for just this purpose
p22
aVSend a USR1 signal to your Zope server and it'll immediately dump stack traces for all threads to the console
p23
aVIt'll do this even if all Zope threads are locked up
p24
as(dp25
g16
V100297
p26
stp27
a((dp28
g2
(lp29
VUse an attribute filter, in particular the attributeEquals filter:
p30
aVTo select all the other nodes, use the attributeNotEquals filter:
p31
aVYou can then apply jQuery manipulations to move these nodes elsewhere
p32
aVNote that XPath-style selectors where deprecated in version 1
p33
aV2, and have been removed altogether in jQuery 1
p34
aV3
p35
aVIf you can influence what the server sends, you may want to switch to using JSON instead, you may find it easier to parse
p36
as(dp37
g16
V100297
p38
stp39
a((dp40
g2
(lp41
VYou are missing the  layer in your skins
p42
aVGo to the ZMI (via site setup or by adding /manage to your Plone homepage), find the portal_skins tool, and check your skin layers in the properties tab
p43
aVMake sure the  layer is listed before the custom layer and you should be set to go
p44
aVIn future, you can use a command line tool like find to locate missing skin methods; I found this one in a buildout by using the following command:
p45
aVYou can automate this with the following Python Script:
p46
aVThis script loops over all skins in the skins tool, and will insert  into any one of them where it is missing; either just after the  layer, or at the end if there is no  layer present
p47
aVThe reason you want your  layer to be first is that this layer by custom (no pun intended) holds customized versions of skin assets
p48
aVIf you were to customize an asset from the  layer through the ZMI then the customized version will be put in the  layer
p49
aVBecause skin lookup rules will look through the layer stack top-to-bottom, you want to make sure your customized versions in the  layer are found before the originals in the lower layers
p50
as(dp51
g16
V100297
p52
stp53
a((dp54
g2
(lp55
VFrom your code example it looks like  inside the cancel and save handlers is the  element, so you can traverse to all it's children from there
p56
aVIt would be far more robust to use a selector instead of traversal however
p57
aVSomething like  should work
p58
aVUsing selectors would make your code more robust as it'll continue to work even if you add additional elements to your dialog
p59
aVAs some commenters have pointed out, giving the file upload control a unique ID would make it easier to select it with a simple selector
p60
aVIf you need the code to work for multiple dialog boxes with different ids for the upload field you can use a class or other specific selectors, like the :file selector mentioned above, combined with the
p61
aVfind method on a specific context
p62
aVTo help you further we may need a bit more context, like what are the contents of the #dialog element
p63
aVPerhaps mentioning the jQuery plugin that defines the
p64
aVdialog method would be helpful
p65
as(dp66
g16
V100297
p67
stp68
a((dp69
g2
(lp70
VIf you want your click handler to run only once, use the  method to bind your handler
p71
aVThis guarantees it will only be called once, as your handler unbound automatically as the event takes place, just before running your code
p72
aVSee the
p73
aVone documentation on docs
p74
aVjquery
p75
aVcom
p76
aVExample usage:
p77
aVUsing this method you don't need to track the state at all, jQuery takes care of this for you
p78
as(dp79
g16
V100297
p80
stp81
a((dp82
g2
(lp83
VThere are 2 problems with your translation
p84
aVFirst of all, the second mention of  has extra parenthesis around it making it a conditional expression, not a named expression
p85
aVNext is that you didn't translate the  backreference, Python uses  to match the same
p86
aVThe following compiles for me:
p87
aVIf I were you, I'd use re
p88
aVVERBOSE to split this expression over multiple lines and add copious documentation so you can keep understanding the expression in the future if this is something that needs to remain maintainable though
p89
aV(edited after realising the second  reference was a conditional expression, and to properly translate the backreference)
p90
as(dp91
g16
V100297
p92
stp93
a((dp94
g2
(lp95
VYou need to tell plone
p96
aVrecipe
p97
aVzope2install where to download Zope
p98
aVAlso, you'll need a zope2instance section, to create a Zope instance for you
p99
aVThese recipes are only needed for Zope up to version 2
p100
aV11, as of 2
p101
aV12 Zope has been fully eggified
p102
aVHere is a minimal Zope 2
p103
aV11 buildout
p104
aVcfg:
p105
aVNote that the  part pulls in the  part automatically as it depends on information provided by that part
p106
aVAs of Zope 2
p107
aV12 installation is fully egg based
p108
aVThe following sample buildout
p109
aVcfg is all you need to install the latest beta:
p110
aVNote the extends; it pulls in a list of versions for all Zope2 egg dependencies from the Zope subversion tag for 2
p111
aV12
p112
aV0b3, to make sure you get a stable combination of eggs
p113
aVWithout it you may end up with newer egg versions that have introduced incompatibilities
p114
as(dp115
g16
V100297
p116
stp117
a((dp118
g2
(lp119
VYou can simply omit the wildcard as it is optional in this case, but keep the space:
p120
aVAlternatively, use the
p121
aVnot() method to filter out the select after selecting all children:
p122
aVIf your problem is that children of  are still included, you could explicitly filter those out with the
p123
aVnot() method:
p124
aVor select direct children only:
p125
aVYou can try out jQuery selectors at the interactive jQuery selector tester for quick feedback; try for example  or  to get a feel for what difference the direct child () selector makes
p126
as(dp127
g16
V100297
p128
stp129
a((dp130
g2
(lp131
VFirebug Lite has some XHR support
p132
aVI am still a bit hazy on how to use it though; I think you give it a javascript variable reference that resolves to a XHR object and Firebug will then follow that element
p133
aVYou can of course also sprinkle firebug console messages throughout your code to try and follow what is going on with IE XHR calls
p134
as(dp135
g16
V100297
p136
stp137
a((dp138
g2
(lp139
VIt looks like you hit a Safari bug here; you are redirecting any visiting browser to /entry while setting the cookie at the same time, and Safari is ignoring the Set-Cookie header when encountering the 302 HTTP status:
p140
aVTechnically, this would be a bug in Apple's Foundation Classes, I've found a WebKit bug that states this is the case
p141
aVI suppose the workaround is to set the cookie not in index_html but in entry instead
p142
as(dp143
g16
V100297
p144
stp145
a((dp146
g2
(lp147
VIf you read the grp module documentation you'll see that grp
p148
aVgetgrnam(groupname) will return one entry from the group database, which is a tuple-like object
p149
aVYou can either access the information by index or by attribute:
p150
aVOther entries are the name, the encrypted password (usually empty, if using a shadow file, it'll be a dummy value) and all group member names
p151
aVThis works fine on any Unix system, including my Mac OS X laptop:
p152
aVThe module also offers a method to get entries by gid, and as you discovered, a method to loop over all entries in the database:
p153
aVLast but not least, python offers similar functionality to get information on the password and shadow files, in the pwd and spwd modules, which have a similar API
p154
as(dp155
g16
V100297
p156
stp157
a((dp158
g2
(lp159
VI must say I doubt DocumentTemplate from Zope will work standalone
p160
aVYou are welcome to try though
p161
aV:-)
p162
aVNote that DT_Util imports C extensions:
p163
aVYou'll need to make sure those are compiled
p164
aVMy guess is that importing the  module fails and thus the import of  fails
p165
as(dp166
g16
V100297
p167
stp168
a((dp169
g2
(lp170
VI am afraid your analysis of the buildout variable substitution code (which collective
p171
aVrecipe
p172
aVtemplate relies on) is correct
p173
aVThere is no syntax for escaping a  variable substitution and your solution of providing a  substitution is the best workaround I can think of
p174
aVYou could of course also propose a patch to the zc
p175
aVbuildout team to add support for escaping the variable substitution syntax
p176
aV:-)
p177
as(dp178
g16
V100297
p179
stp180
a((dp181
g2
(lp182
VHow do you need to use the output
p183
aVIf you only need to iterate over it, you are better off creating an iterable, one that yields your groups:
p184
aVUsage example:
p185
aVThis uses far less memory than trying to construct the whole list in memory at once, if you are only looping over the result, because it only constructs one subset at a time:
p186
as(dp187
g16
V100297
p188
stp189
a((dp190
g2
(lp191
VFirst of all, why not restructure your site to put all these pages that require authentication in locations you can protect with Zope permissions
p192
aVA custom (local) workflow can apply permissions on a state-by-state and location-by-location basis, thus using Zope's own automatic authentication framework
p193
aVIf you don't use a workflow, a custom type can still apply permissions that are acquired by anything below it in URL space
p194
aVYou can create a method (a Zope3 view, a Python Script in a skin layer, a method on a content class in your acquisition context, an External Method, in rough order of best practices) that is called from your special_template macro by means of a tal:define statement
p195
aVI'll assign the output to a dummy variable here because you don't care about that, we'll use it for it's side effects
p196
aVThe following example assumes you've gone the Z3 view way:
p197
aVThis will instanciate the view registered with the name
p198
aVIn the view you can then test if your web visitor has been authenticated, using standard Zope API methods or a test for a cookie, depending on your application
p199
aVHere is a standard API example, it'll raise Unauthorized to force a login
p200
aVIf all you want is a redirect to another location, simply use response
p201
aVredirect():
p202
aVIf you want to test for cookies first, cookies are part of the request variables:
p203
as(dp204
g16
V100297
p205
stp206
a((dp207
g2
(lp208
VThe events portlet uses a view to provide it with data, and the expression 'view/all_events_link' calls a method on that view to provide it with a link
p209
aVYou have 2 options to replace that link:
p210
aVRegister your own event portlet that subclasses the old one, and replaces the all_events_link method
p211
aVThis in the heavy customization option, and requires Python coding
p212
aVSee this mail thread on some general pointers on how to achieve this
p213
aVReplace just the template with a portlet renderer
p214
aVMartin Aspeli has documented this method on Plone
p215
aVorg; this only requires some ZCML configuration to get working
p216
aVYou can then copy the events
p217
aVpt template and replace the portlet footer with one that links to the right location
p218
as(dp219
g16
V100297
p220
stp221
a((dp222
g2
(lp223
Vzerokspot
p224
aVrecipe
p225
aVdistutils is fundamentally broken in that it adds a dependency on zc
p226
aVbuildout in it's setup
p227
aVpy, as follows:
p228
aVimports  from
p229
aVAll of  is defined in it's , including
p230
aVin  imports
p231
aVWhy the author defines  is a mystery to me; best practice keeps a simple version string in  itself and lets setuptools deal with dev versions (through ), and distutils for version metadata extraction
p232
aVGenerally it is not a good idea to import the whole package in  as that would require all the package dependencies to be present at install time
p233
aVObviously the author of the package has zc
p234
aVbuildout installed as a site-wide package and didn't notice his oversight
p235
aVYour best bet is to fork the package on github, remove the get_version dependency, and propose the change to the original author while you use your fork instead
p236
as(dp237
g16
V100297
p238
stp239
a((dp240
g2
(lp241
VI always have to look this up too
p242
aVThe syntax is very simple, and  is not part of the syntax, I am afraid
p243
aVAs you can see from the documentation in the zope
p244
aVconfiguration source code, the syntax is always of the form , where verb is one of , ,  and
p245
aVand  test for a registered feature
p246
aVA registered feature is simply an opaque string that has been registered with a  tag
p247
aVUse it to flag that something has been included without tying it to a particular implementation
p248
aVExample:
p249
aVand  simply try to import the named package; if the import succeeds so does the  test
p250
aVExample:
p251
as(dp252
g16
V100297
p253
stp254
a((dp255
g2
(lp256
VYou can't put tags inside of a  tag, and the strict ZPT parser is complaining about that
p257
aVYou'll have to somehow escape the contents, like with a tal:content="structure string:" construct:
p258
as(dp259
g16
V100297
p260
stp261
a((dp262
g2
(lp263
VYou can add any python package hosted on git-hub by adding a find-links url pointing to the project tarball URL plus a  postfix
p264
aVFor pyfacebook that is:
p265
aVSo a simple buildout would be:
p266
as(dp267
g16
V100297
p268
stp269
a((dp270
g2
(lp271
VSee my answer to this SO question, use Products
p272
aVsignalstack
p273
aVIt registers the same handler as the answer you already found, at Product registration time
p274
aVPerhaps it works better for you
p275
aVIf not, you probably have a OS-level I/O problem on your hands, and your only hope is attaching gdb to the process
p276
aVSearch Stack Overflow for gdb answers; there is a wealth of information here
p277
as(dp278
g16
V100297
p279
stp280
a((dp281
g2
(lp282
VThe documentation states you'll have to tell Google Prettify to start highlighting during onLoad
p283
aVAdd an extra Javascript file to your plone project (custom skin folder, as a browser resource or skin file in your on-disk package/product, etc) that contains the following:
p284
aVand register that file to be included after the prettify
p285
aVjs file in portal_javascripts
p286
aVIt'll execute the prettyprint function when the DOM is loaded, and is the equivalent of the  example in the Prettify documentation
p287
as(dp288
g16
V100297
p289
stp290
a((dp291
g2
(lp292
VYou can access views from page templates with the @@ syntax: context/@@viewname:
p293
as(dp294
g16
V100297
p295
stp296
a((dp297
g2
(lp298
VYes,  (a direct subclass of ) is emitted when an Archetypes content object is being changed
p299
aVHowever, the event itself will not tell you if a new file was uploaded
p300
aVIt should be possible however, to obtain the request (context
p301
aVREQUEST should give you the current request through acquisition, for example) and see if there is a file object there matching the field
p302
aVIf so, the user uploaded a new file for that field and the  will have been updated
p303
as(dp304
g16
V100297
p305
stp306
a((dp307
g2
(lp308
VThe PIL version packaged on pypi (by the author) is incompatible with setuptools and thus not easy_installable
p309
aVPeople have created easy_installable versions elsewhere
p310
aVCurrently, you need to specify a find-links URL and use  get a good package:
p311
aVBy using  with the  you avoid running the risk of finding the PyPI (non-fixed) original of PIL
p312
aVIf you were to use , you must use a direct link to the source tarball of a corrected version; easy_install stubbornly still uses the PyPI link over the find-links URL:
p313
aVTo include PIL in a buildout, either specify the egg with the same version pin or use a versions section:
p314
aVEdit March 2011: Fixes to address the packaging issues have been merged into PIL's development tree now, so this workaround may soon be obsolete
p315
aVEdit February 2013: Just use Pillow and be done with it
p316
aV:-) Clearly waiting for the original package to be fixed has not paid off
p317
as(dp318
g16
V100297
p319
stp320
a((dp321
g2
(lp322
VNewer DateTime implementations (2
p323
aV11 and up) have a  method that returns a python datetime
p324
aVdatetime instance:
p325
as(dp326
g16
V100297
p327
stp328
a((dp329
g2
(lp330
VWhen we create a buildout for a customer, we want that buildout to run on arbitrary hosting environments with minimal dependencies, all satisfiable with system packages
p331
aVBy including supervisord in the buildout, we eliminate the need for it to be installed system-wide and can tweak it's parameters finely, without having to ask a system admin to change settings for us
p332
aVIt's easy to get supervisor to run at boot time from a buildout, using the usercrontab recipe:
p333
aVThe above part will add an entry to the crontab that causes supervisor to run at boot time
p334
as(dp335
g16
V100297
p336
stp337
a((dp338
g2
(lp339
VPython Scripts in Plone are restricted and have no access to the filesystem
p340
aVThe open call is thus not available
p341
aVYou'll have to use an External Method or full python module to have full access to the filesystem
p342
as(dp343
g16
V100297
p344
stp345
a((dp346
g2
(lp347
VThere are two ways you could go about this
p348
aVI use both, depending on the context the buildout is being used for:
p349
aVUse mr
p350
aVdeveloper to include packages from a version control system (mr
p351
aVdeveloper support a wide range of systems, including git)
p352
aVI use this when developing
p353
aVBuild a private package repository
p354
aVA simple directory listing in Apache is enough
p355
aVAdd the URL to your private repository as a  entry:
p356
aVIn this example I also included a username and password (buildout then will authenticate) and a path on the server that is project specific
p357
aVYou can also just build one big private repository for all your projects, of course
p358
aVIn that repository you either put complete eggs, or just a tarball of the package
p359
aVRepositories named in  are searched before PyPI
p360
aVI use this method for deployment buildouts
p361
aVThis way the software will use released packages, which makes release management much clearer and simpler
p362
aVHosting your own forks of OSS packages is perfectly fine
p363
aVThis is one of the freedoms you get when using OSS
p364
aVNote that when you fork GPL code like this, and are distributing it to a third party, you need to make your changes available to them
p365
aVA package repository is one way of doing complying with this
p366
as(dp367
g16
V100297
p368
stp369
a((dp370
g2
(lp371
VUse CSS
p372
aVSimply tag your  tag with classes based on the current section / faculty / aspect of your choice and alter your images based on those classes
p373
aVKeep visual design separate from your content
p374
as(dp375
g16
V100297
p376
stp377
a((dp378
g2
(lp379
VUse mr
p380
aVdeveloper: http://pypi
p381
aVpython
p382
aVorg/pypi/mr
p383
aVdeveloper
p384
aVIt manages develop eggs beautifully, including adding them to develop-eggs in the first place
p385
as(dp386
g16
V100297
p387
stp388
a((dp389
g2
(lp390
VNo, the ZODB is a python-specific object database
p391
aVIt uses Python-specific tricks to load and store object state, something the JPA cannot provide (it is designed to map objects to relational databases)
p392
as(dp393
g16
V100297
p394
stp395
a((dp396
g2
(lp397
VPlone 4 requires python 2
p398
aV6, so it won't work with python 2
p399
aV4
p400
aVSee http://plone
p401
aVorg/documentation/faq/plone-versions
p402
as(dp403
g16
V100297
p404
stp405
a((dp406
g2
(lp407
VYou need to make sure you have the canonical object first:
p408
aVYou can then link your translation by calling  on the translation:
p409
aVThat's all
p410
aVThe LinguaPlone API is rather under-documented, your best bet is to look at the I18NBaseObject source code
p411
aVThe most important thing to remember is that there is always one canonical object, with any translations linked to it via references, where the reference points from translations to the canonical object
p412
as(dp413
g16
V100297
p414
stp415
a((dp416
g2
(lp417
VThe PYTHON_EGG_CACHE is only used for zipped eggs, your best bet is to have zc
p418
aVbuildout install all required eggs unzipped:
p419
aVIf your system python has zipped eggs installed that still require unzipping for resource access, and setting the PYTHON_EGG_CACHE in your scripts is your only option (as opposed to setting the environment variable for your user), you could try to use the  option of zc
p420
aVrecipe
p421
aVegg to add arbitrary Python code to your scripts:
p422
as(dp423
g16
V100297
p424
stp425
a((dp426
g2
(lp427
VI would advise you to switch to using mr
p428
aVdeveloper for external SCM-managed dependencies in a buildout
p429
aVmr
p430
aVdeveloper lets you pull in dependencies (eggs or otherwise) from Mercurial repositories as well as Git, Bazaar, Darcs, Subversion and even CVS repositories
p431
aVYou can treat these dependencies as development eggs that other python eggs can depend on in setup
p432
aVpy
p433
aVTo use mr
p434
aVdeveloper, add it as a buildout extension:
p435
aVYou tell mr
p436
aVdeveloper about resources using a  section:
p437
aVWith mr
p438
aVdeveloper, you now get a command line tool to manage these repositories; you can check them out, update them, and most importantly, build them as development eggs for the buildout
p439
aVTo check out such sources automatically, and have them built as development eggs, list them in the  option in the  section:
p440
aVWhen you now run buildout both pack1 and pack2 will be checked out, built as eggs, and when used as dependencies elsewhere, used to fill those dependencies
p441
aVSo if either 'pack1' or 'pack2' is listed on an  line or as a dependency of another egg in setup
p442
aVpy, zc
p443
aVbuildout will pick the versions checked out by mr
p444
aVdeveloper
p445
aVThe  command line tool gives you full control over these options, please read the PyPI page for mr
p446
aVdeveloper
p447
as(dp448
g16
V100297
p449
stp450
a((dp451
g2
(lp452
VYou are misunderstanding how buildout works
p453
aVNormally, buildout will try and find all eggs needed to build your parts for you
p454
aVIt does so by searching for the eggs (optionally pinned to specific versions) in your site-packages, on PyPI or in any additional web locations (using )
p455
aVIt will do so recursively until all dependencies are met
p456
aVSo if you specify you want to use an egg called  that depends on , which in turn depends on  and , buildout will locate those four eggs for you
p457
aVNote that eggs are special python packages, using the
p458
aVegg extension
p459
aVIf there is a python package with a setup
p460
aVpy file instead, that specifies the correct name, then that setup
p461
aVpy is executed to create an egg on the fly
p462
aVThis is were development eggs come in; they are python packages that do not need to be downloaded from elsewhere, because they are already present on the filesystem
p463
aVTheir version requirements are not enforced, and if present they take precedence over other versions of the egg found elsewhere
p464
aVWhen buildout runs, their setup
p465
aVpy is run to build an egg in-place; you'll find a
p466
aVegg-info directory in that package when buildout has run and some more metadata is stored in the develop-eggs directory of your buildout
p467
aVIn your examples you use mr
p468
aVdeveloper to manage your development eggs, loading them from a mercurial repository first
p469
aVBuildout itself doesn't really care about this, it's just a (clever) means of loading python packages from a SCM repository and treating them as python eggs
p470
aVAll you need to do is list all dependencies coming from mercurial in  and in  (one per line)
p471
aVIn your case the dependencies run  ->  -> , and by listing  and  both in mr
p472
aVdeveloper-controlled configurations you ensure that buildout will find development eggs for both of these
p473
aVIn all this it is important to remember that one buildout configuration is all that is needed; buildout does not run buildout configuration files found inside packages
p474
aVIt only deals with python eggs, not other buildout configurations
p475
aVYou do sometimes find buildout configuration files inside python eggs, but these are there for the developer of the egg, to run tests and aid development, not to pull in dependencies when used as an egg in your own projects
p476
as(dp477
g16
V100297
p478
stp479
a((dp480
g2
(lp481
VYou should pin your eggs to specific versions, that way you can control what eggs are used every single time you run the buildout:
p482
aVThe  option in the  section lets you name a section that contains version pins for your packages
p483
aVIn this example I named that section , but you can use any name you like; imagine if you will a  and  section, with the  option pointing to either one to select a specific combination of version pins
p484
aVWhen an egg is pinned to a specific version like this, only that version of the egg can satisfy the requirements of this buildout
p485
aVIf your find-links points to a location that contains that version then the egg will be downloaded from there and not from PyPI
p486
aVThere are 2 more buildout features that can help manage version pins
p487
aVThe first is a default buildout option called :
p488
aVThe default setting is  which means buildout can pick a version for you that otherwise satisfies all the requirements
p489
aVWhen you set this to , for any egg that has no version pin buildout will throw an error
p490
aVUse this to detect that you need to pin down eggs still
p491
aVThe other option would be to use the buildout
p492
aVdumppickedversions extension to buildout:
p493
aVWhen added to your buildout like that, every time you run your buildout a list of picked versions is listed at the end, for any egg that wasn't pinned, in a format directly suitable for inclusion in your buildout configuration
p494
aVThat way you can let buildout find out what eggs to use, then pin them down to those versions
p495
as(dp496
g16
V100297
p497
stp498
a((dp499
g2
(lp500
VThe best option is to not develop Zope applications through-the-web anymore
p501
aVUse proper python packages, and you'll get to use your favourite tools without difficult integration with the server
p502
as(dp503
g16
V100297
p504
stp505
a((dp506
g2
(lp507
VYou must use the department ID ( in your PHP code example) to set the chosen option in your select, since that's what you set for the option  attribute
p508
aVwould select the "Select A Department" option, for example
p509
aVI've created a jsfiddle example for you that illustrates this
p510
aVThere is also a stray  in your example, right after the closing  tag of your "Select A Department" null option
p511
aVYou did not share the code for getUserDepartment
p512
aVphp in your example, so I cannot verify if that method is indeed returning the row id and not the row  column
p513
as(dp514
g16
V100297
p515
stp516
a((dp517
g2
(lp518
VPretty complex, but I'll try and boil the rules down to English
p519
aVThere is only one tilde (~) allowed in the name, but it is optional
p520
aVIf there is a tilde, it must not be the first character in the name, it must have at least 1 and at most 100 letters, numbers or dashes in front of it
p521
aVThere is only one colon (:) allowed in the name, and it is optional
p522
aVIf there is a colon, it must:
p523
aVa
p524
aVcome after the tilde, if present
p525
aVb
p526
aVcome after 1 or more letters, numbers, dashes or full stops
p527
aVc
p528
aVthe group of letters, numbers, dashes and full stops cannot start with a dash
p529
aVThe rest of the name can contain any letter, number or dashes, up to a hundred characters
p530
aVThe optional tilde and colon sections must come before it, and it cannot start with a dash
p531
aVYou must use at least one character, and at most 100
p532
aVSome examples that are allowed:
p533
aVfoo~bar
p534
aVbaz:spam-eggs
p535
aVsomething:other-
p536
aVwhomever~thought-this-was-a-good-idea
p537
aVtogether
p538
aVwe
p539
aVstand:strong
p540
aVsimply-should-work
p541
aV-starting-dash~as
p542
aVlong
p543
aVas
p544
aVthere
p545
aVis
p546
aVa:tilde-after-it
p547
aVSome examples that won't be allowed:
p548
aV-no-starting-dash
p549
aV-no-starting-dash:with-a-colon-but-no-tilde
p550
aVno
p551
aVfull
p552
aVstops
p553
aVwithout
p554
ag524
aVcolon
p555
aVafter
p556
aVit
p557
aV~no-tilde-at-the-start
p558
aV:no-colon-at-the-start
p559
aVmore~than~one:tilde:or:colon
p560
as(dp561
g16
V100297
p562
stp563
a((dp564
g2
(lp565
VI don't think such a product already exists
p566
aVIt should be trivial to create a package that adds a content rule condition, that would let you write a content rule for the  event
p567
aVThe Plone knowledgebase documents how to create such a package
p568
as(dp569
g16
V100297
p570
stp571
a((dp572
g2
(lp573
VShort answer: Yes, you can, by using the console
p574
aVLonger answer: Take a look at the What's new in Firebug 1
p575
aV6 video, it gives an excellent demonstration on what you can do with the console, including auto-completion of the available variables
p576
aVEverything that's available globally in the current document is available to the console
p577
aVSo if you included jQuery on the current page, it'll be accessible from the console too
p578
as(dp579
g16
V100297
p580
stp581
a((dp582
g2
(lp583
VEdit: go with @Tobu's advice, Don't Do This
p584
aVMy answer below is incorrect but left in place for completeness sake
p585
aVIt is incorrect because the zope
p586
aVinterface
p587
aVimplements metaclass shuffle hasn't processed the interface info as yet
p588
aVI think the approach is certainly sane
p589
aVYou do not need to pass in the provided interface or the adapted specs to provideAdapter, the registration method will figure those out as long as there is only one interface implemented:
p590
aVIf you want to support classes that implement more than one interface (by direct declaration or via inheritance) you'll have to come up with semantics to determine what interface gets selected as the adapter target interface
p591
aVIn that case simply give the selected interface to registerAdapter via the provides= keyword parameter
p592
aVI would advise you to use the zope
p593
aVinterface introspection APIs (zope
p594
aVinterfaces
p595
aVimplementedBy) to find the provided interfaces rather than directly grabbing them from the internal datastructures on the class
p596
as(dp597
g16
V100297
p598
stp599
a((dp600
g2
(lp601
VLook for an id attribute on a div, using the closest method:
p602
aVThe  brackets there is what's called the Has Attribute Selector
p603
as(dp604
g16
V100297
p605
stp606
a((dp607
g2
(lp608
VIf you used the Unified Installer, you simply delete the directory and you are done
p609
aVPlone does not install anything outside of that
p610
aVIf you used another method to install Plone, you'll need to give more details than that, including the OS you installed it on
p611
as(dp612
g16
V100297
p613
stp614
a((dp615
g2
(lp616
VThe ZODB does not support multi-process access
p617
aVThis is why you get the lock error; the ZODB file storage has been locked by one process to prevent other processes altering it
p618
aVThere are several ways around this
p619
aVThe easiest option is to use ZEO
p620
aVZEO extends the ZODB machinery to provide access to objects over a network, and you can easily configure your ZODB to access a ZEO server instead of a local FileStorage file:
p621
aVAnother option is to use RelStorage, which stores the ZODB data in a relational database
p622
aVRelStorage supports PostgreSQL, Oracle and MySQL backends
p623
aVRelStorage takes care of concurrent access from different ZODB clients
p624
aVHere is an example configuration:
p625
aVRelStorage requires more up-front setup work but can outperform ZEO in many scenarios
p626
as(dp627
g16
V100297
p628
stp629
a((dp630
g2
(lp631
VThe python built-in hash function is not intended for secure, cryptographic hashing
p632
aVIt's intention is to facilitate storing Python objects into dictionaries efficiently
p633
aVThe internal hash implementations are too predictable (too many collisions) for secure uses
p634
aVFor example, the following assertions are all true:
p635
aVThis sequential nature makes for great dictionary storage behaviour, for which it was designed
p636
aVTo create a secure hash, use the hashlib library instead
p637
as(dp638
g16
V100297
p639
stp640
a((dp641
g2
(lp642
VNote: this is a revised answer after the question was updated with a traceback and version info
p643
aVYour pack fails during garbage collection because you have a corrupted pickle in your ZODB database
p644
aVYou can verify this by running the  script on your Data
p645
aVfs
p646
aVIf you have a  or similar part in your buildout (a script that just runs the arguments as a python script with the sys
p647
aVpath extended with all your eggs), you can do this:
p648
aVThat's the full path to the fsrefs
p649
aVpy script
p650
aVIt'll only confirm if there is a pickle error
p651
aVMost likely this is problem with an old transaction you don't care about anymore, and you can fix this problem by editing the  module to ignore this particular pickle error
p652
aVYou'll find the path to it at the end of your traceback
p653
aVEdit the  function (line 608 and on) to catch the exception in question
p654
aVOriginally the top of that function looks like this:
p655
aVChange it to:
p656
aVThe risk is that the garbage collection algorithm will not detect a set of objects that are still in use and thus pack away too much, but that risk diminishes with the age of the affected transaction
p657
aVThe risk appears minimal, after all that pickle is already broken and any application code won't be able to reach any object referenced through whatever that pickle held anyway
p658
as(dp659
g16
V100297
p660
stp661
a((dp662
g2
(lp663
VThe Domain Auth Plugin uses the  method to determine the IP address of the client, which in turn uses both the  variable and the  header
p664
aVNormally, you cannot rely on the  header, seeing as just about anyone could have set it
p665
aVBut you can configure Zope to trust that header from a given set of trusted proxies
p666
aVUsing the list of trusted proxies, the  IP address will be replaced with the next address given in the  header, until you run out of addresses to trust
p667
aVThe last IP address found is then the new client address
p668
aVThis allows you to chain a set of proxies and still be able to trust you get the correct client address to base your roles on
p669
aVTo configure Zope to trust a proxy's  header, set the  configuration parameter in the  file
p670
aVIf your nginx server runs on the same host, just set it to localhost:
p671
aVYou specify more than one name by adding multiple entries:
p672
aVtakes both ip addresses and hostnames
p673
as(dp674
g16
V100297
p675
stp676
a((dp677
g2
(lp678
VThe Zope Database Adapters (DA) code base is some of the oldest code still in use in Zope, and is thus somewhat archaic
p679
aVWhen you call a Zope DA, you get a database connection object (a DB instance) that in turn has a query method:
p680
aVThe query method is not exactly a Python database API standard method
p681
aVIt accepts multiple SQL statements separated by  null characters, but won't support SELECTs if there is more than one statement
p682
aVThe ZPsychoDA query method also accepts query parameters:
p683
aVbut more importantly, the ZPsychoDA adapter also gives you access to a regular database cursor:
p684
aVMy advise is to just use that and do regular Python DB API calls via the database cursor you get there
p685
as(dp686
g16
V100297
p687
stp688
a((dp689
g2
(lp690
VThis certainly can be done
p691
aVWe already use this in a 4
p692
aV0 Plone project, where a colleague created a base  and  implementations using  and  base classes respectively
p693
aVNote that this is Plone 4
p694
aV0, not 3
p695
aVx, so your mileage may vary
p696
aVThe implementation is a basic reimplementation of their zope
p697
aVformlib originals, with simple buttonAndHandler handlers to handle the Add (add form), Save (edit form) and Cancel (both) buttons
p698
aVI believe we have plans to contribute the base form implementations back to plone
p699
aVapp
p700
aVportlets, I'll ask him about it
p701
as(dp702
g16
V100297
p703
stp704
a((dp705
g2
(lp706
VCreate a  object in your skin and use that as a function
p707
aVTALES expressions are limited for a reason: they are there only to help you create HTML or XML markup, not do full-scale business logic
p708
aVBetter still, create a proper browser view and avoid the severe restrictions laid on Through-The-Web editable code
p709
aVAlso, you are misrepresenting or misunderstanding TALES
p710
aVYou can use builtin methods like sorted and set
p711
aVAnd instead of  you can use test(condition, iftrue, iffalse) or a good old  with the limitation that the result of  must itself evaluate to true
p712
aVEven better, you can access a limited set of Python modules via the  dictionary, such as
p713
aVYou'll need to make additional security declarations in a filesystem python module to extend this though
p714
aVSee the Python TALES expression section of the TAL documentation
p715
aVNote that the list of built-ins accessible to TALES listed there has since been expanded to cover newer python versions
p716
as(dp717
g16
V100297
p718
stp719
a((dp720
g2
(lp721
VYou'll need an easy way to select the other radio buttons
p722
aVIt sounds from your description that the values for all radio buttons with the same label will also have the same value, so you can select on that
p723
aVGroup your radio buttons in divs with a shared class:
p724
aVYou can now select the other radio button groups and disable all radio buttons with the same value:
p725
aVAlternatively you can use the  filter to remove the current input selector from the group:
p726
as(dp727
g16
V100297
p728
stp729
a((dp730
g2
(lp731
VI'd term this a resource, which is data that your application relies on, but not the data your application manages
p732
aVImages, CSS, and templates are similar resources, and you keep them all version controlled
p733
aVIn this case, you could split out your data into a separate package
p734
aVIn python distribution terms, use a separate egg that your application depends on; package deployment tools such as pip and buildout will pull in the dependency automatically
p735
aVThat way you can version it independently, you can have other tools depend on it, etc
p736
aVLast, choose a format that can be managed effectively by a source control system
p737
aVThat means a textual format
p738
aVYou can initiate parse that format on start-up, but by keeping it textual you can manage it properly through changes to it
p739
aVThis could be a SQL dump (CREATE TABLE and INSERT statements) to be loaded into a sqlite database on start-up, or some other python-based structure
p740
aVYou can also choose to load data on demand, caching it in-memory as needed
p741
aVHave a look at the pytz timezone database for a great example of how another resource project manages such structures
p742
as(dp743
g16
V100297
p744
stp745
a((dp746
g2
(lp747
VTake a look at SkimpyGimpy, it's a python package that let's you generate CAPTCHA images and audio files
p748
aVThis is the package most framework-specific captcha generators that do not use re-captcha rely on
p749
aVIt's a bit primitive, you may want to look at the source of collective
p750
aVcaptcha as an example of how to use SkimpyGimpy in your own code
p751
aVObligatory disclaimer: I am the original author of the collective
p752
aVcaptcha package
p753
aVYour mileage may vary
p754
aVDon't code and drive, especially based on the say-so from others
p755
as(dp756
g16
V100297
p757
stp758
a((dp759
g2
(lp760
VWhat you are looking for is , possibly combined with the  and  prefixes:
p761
aVAlternatively, you can use the  operator, which acts like an if operator, testing existence of the first element
p762
aVIf it doesn't exist, it'll use the next expression, and so on:
p763
aVThe  attribute means something very different
p764
aVIf it's expression evaluates to , then the tag, and only the tag itself, is omitted from the output
p765
aVThis is best illustrated with an example:
p766
aVRendering that piece of pagetemplate results in:
p767
aVThe surrounding  tag was omitted, but the contents were preserved
p768
as(dp769
g16
V100297
p770
stp771
a((dp772
g2
(lp773
VFirst of all: there is a big difference between the concepts of providing and implementing an interface
p774
aVBasically, classes implement an interface, instances of those classes provide that interface
p775
aVAfter all, classes are the blueprints for instances, detailing their implementations
p776
aVNow, an interface describes the implementation provided by instances, but the  method is not a part of instances
p777
aVIt is part of the interface directly provided by classes instead (a classmethod in Python terminology)
p778
aVIf you were to define an  method in your interface, you are declaring that your instances have (provide) a  method as well (as an instance method)
p779
aVSo interfaces describe what kind of instances you get, not how you get them
p780
aVNow, interfaces can be used for more than just describing what functionality an instance provides
p781
aVYou can also use interfaces for any kind object in Python, including modules and classes
p782
aVYou'll have to use the  method to assign an interface to these, as you won't be calling these to create an instance
p783
aVYou can also use  or  from within a class or module declaration to get the same results
p784
aVWhat you want in this case is a factory definition; classes are factories that when called, produce an instance, so a factory interface must provide a  method to indicate they are callable
p785
aVHere is your example set up with a factory interface:
p786
aVThe  package provides you with a convenience class and interface for factories, adding a  method and a title and description to make discovery and introspection a little easier
p787
aVYou can then just subclass the  interface to document your  parameters a little better:
p788
aVYou could now register that factory as a  utility, for example, allowing other code to find all ITestFactory providers
p789
aVI used  here to mark the factory instance with your subclassed ITestFactory interface, as  instances normally only provide the  interface
p790
as(dp791
g16
V100297
p792
stp793
a((dp794
g2
(lp795
VWell, it'll be easy to define a  view that then uses the Authenticated User to render it's contents, which could be a simple delegation to an ordered folder that is stored at /site/users/user/folder
p796
aVThe one thing that you have to remember is that user authentication happens after traversal
p797
aVThis means that when a view is instantiated (it's  method is called) there is no user determined yet because that happens during traversal
p798
aVLook up your user in the view  or from it's template instead
p799
as(dp800
g16
V100297
p801
stp802
a((dp803
g2
(lp804
V only depends on CMFCore, not Plone
p805
aVI do have plans to make that dependency optional though, I simply haven't had the time to do so yet
p806
as(dp807
g16
V100297
p808
stp809
a((dp810
g2
(lp811
VThe  comes from older Plone versions (version 3
p812
aV0 and earlier, it was removed in the 3
p813
aV1 line)
p814
aVIt uses the old-style  API to read a version
p815
aVtxt file from the Zope2 module directory, but that is not always written
p816
aVI do not see it in my Zope2 installs installed with the plone
p817
aVrecipe
p818
aVzope2install recipe in any case
p819
aVThis log message is otherwise harmless provided you do use Zope 2
p820
aV10
p821
aV4 or newer
p822
aVWith the advent of a proper Zope2 egg, Plone now uses the  module to make this test and in Zope 2
p823
aV12 the  API uses  internally as well
p824
aVThe collective
p825
aVmonkeypatcher precondition test also uses  to introspect package versions
p826
aVFrom your  log entry I infer that you are using an older Plone version (3
p827
aV0 or older) and thus you are most likely using Zope 2
p828
aV10
p829
aVZope 2
p830
aV10 is not an egg, so there is no egg metadata for  to get a version from
p831
aVThus the version test fails for any Zope version before 2
p832
aV12
p833
aVThe obvious work-around is to not use the package defining the monkeypatch on Zope servers older than 2
p834
aV12
p835
aVBut you can also generate a fake egg with the version information included with the  recipe:
p836
aVFake eggs provide enough metadata for pkg_resources to get a version number, but the zope2install recipe writes a default Zope2 fake egg with a 0
p837
aV0 version
p838
aVBy defining the fake egg with a version number you end up with pkg_resources giving you enough information to satisfy the precondition
p839
aVYou may have to upgrade your  version, I see some refactoring and bug-fixes have been applied to the way fake eggs are generated that may affect you
p840
as(dp841
g16
V100297
p842
stp843
a((dp844
g2
(lp845
VYou ran Zope on a server with the clock way off into the future, and the ZODB really doesn't like that
p846
aVSomeone once wrote a patch to auto-correct for this situation, see:
p847
aVhttp://www
p848
aVmail-archive
p849
aVcom/zodb-dev@zope
p850
aVorg/msg03916
p851
aVhtml
p852
aVYMMV applying that one though
p853
as(dp854
g16
V100297
p855
stp856
a((dp857
g2
(lp858
VYou can force unbuffered I/O from within your Python script by re-opening stdin or stdout using os
p859
aVfdopen on the filenumber:
p860
aVYou can then reassign sys
p861
aVstdout if you want to use other modules or build-ins that use stdout or stdin:
p862
aVAlso see unbuffered stdout in python (as in python -u) from within the program
p863
as(dp864
g16
V100297
p865
stp866
a((dp867
g2
(lp868
VUnfortunately, python-twitter does not yet support the Twitter Retweet REST call
p869
aVYou'll have to make that call directly yourself (using direct calls to api
p870
aV_FetchURL) or apply the patch in issue 130 to add support
p871
aVYou're better off with using tweepy; read the API documentation, there is a handy  method for retweeting
p872
aVQuick and dirty example:
p873
aVThis will retweet the last 20 statuses from
p874
aVYou'll want to do some more coding to prevent it from retweeting those same messages again next time you run the script though
p875
aVEdit: Twitter no longer accepts BasicAuth authentication, and you'll have to use the OAuth authentication exchange to get a authorisation token
p876
aVChanging the example above to use OAuth would detract from the retweet API point I was trying to make, see the Tweepy OAuth tutorial for an extensive tutorial
p877
as(dp878
g16
V100297
p879
stp880
a((dp881
g2
(lp882
VRelStorage stores only Python pickles in BLOBs, the rest is transaction metadata in the form of integers and boolean flags
p883
aVAt no time will you see raw object contents appear in the database and there are no character columns in the RelStorage schema
p884
aVAs such, it makes no difference whatsoever what encoding you use for PostgreSQL
p885
as(dp886
g16
V100297
p887
stp888
a((dp889
g2
(lp890
VBest practice is to have your javascript merged with as many other scripts as possible
p891
aVJust load it either without a condition or only for authenticated users
p892
aVAll javascript code pertaining to editing included in Plone already loads for all authenticated users regardless
p893
as(dp894
g16
V100297
p895
stp896
a((dp897
g2
(lp898
VYou can't without additional coding
p899
aVYou'd have to manually sort the catalog query results after retrieving them, as the Zope catalog does not support multi-level sorting by itself
p900
aVDepending on your result set size, this could be quite in-effecient as well
p901
aVIf you want to go this route, you would have to either subclass the ATContentTypes
p902
aVcontent
p903
aVtopic
p904
aVATTopic class and override the queryCatalog method, or create new skin versions of the topic views to call a different method that in turn then calls queryCatalog so you can apply additional sorting to it
p905
aVNeedless to say, this requires some Plone and python expertise
p906
as(dp907
g16
V100297
p908
stp909
a((dp910
g2
(lp911
VI'm presuming that you would only add  to conditions that already test on items that are not callable in the first place, and that perhaps avoiding the python builtin  test might be give you a performance boost
p912
aVThe short answer to that question is no, that would not help you
p913
aVOn my Macbook Pro laptop, running  a 1000 times clocks in at 119ns per loop, vs
p914
aV71ns per loop for the plain  statement
p915
aVSo for simple python objects, the  test takes a mere 48ns
p916
aVAdding the  to a TALES statement on the other hand, requires extra processing that almost certainly will exceed the 48ns overhead of the  test you just saved
p917
aVThus, adding  for the sake of improving performance would backfire
p918
aVYou'd be better off implementing proper caching (look at plone
p919
aVapp
p920
aVcaching in combination with Varnish), or take a look if Chameleon could work for your use-case
p921
as(dp922
g16
V100297
p923
stp924
a((dp925
g2
(lp926
VSimply call  on your content item
p927
aVA quick-n-dirty script to accomplish this would be something along the lines of:
p928
aVYou'll need to reindex your content after changing the language setting, but the  parameter to the  call ensures that only the Language index get's updated, making the process faster
p929
as(dp930
g16
V100297
p931
stp932
a((dp933
g2
(lp934
VYes, this is normal behaviour
p935
aVThe catalog stores a subset of information that an object provides as a cache, so you can render pages with just catalog results without having to wake up the original objects
p936
aVThis includes the current workflow state for an object
p937
aVWhen reindexing, the catalog must update the metadata too, as it has no means of determining if that data has changed or not
p938
aVIn this particular process, you cannot turn update_metadata off without patching; you'd have to either:
p939
aVpatch Products
p940
aVZCatalog
p941
aVCatalog
p942
aVcatalogObject to switch off update_metadata there,
p943
aVpatch Products
p944
aVArchetypes
p945
aVCatalogMultiplex
p946
aVCatalogMultiplex
p947
aVreindexObject to call catalogObject with the update_metadata flag set to False,
p948
aVpatch the workflow tool to call reindexObjectSecurity instead of reindexObject
p949
aVYou'd have to audit your catalog schema (metadata) columns to see if nothing will indeed change when you update workflow security
p950
as(dp951
g16
V100297
p952
stp953
a((dp954
g2
(lp955
VWe use zc
p956
aVbuildout to create repeatable development and deployment setups
p957
aVDuring development, mr
p958
aVdeveloper is an unmissable extension
p959
aVIt's important you use a versions section to pin all egg versions though to ensure your buildout is repeatable at all times
p960
aVSetting the allow-picked-versions option to false will alert you to any version pins you may have overlooked
p961
as(dp962
g16
V100297
p963
stp964
a((dp965
g2
(lp966
VMake sure your version number is unique; if you use the same version number in your  URL as the package listed on PyPI, setuptools will happily grab the one found on PyPI instead of the one indicated by
p967
aVWe use a  pattern for private modifications, so a version  repackaged with our changes becomes
p968
aVLater revisions then update the counter (, , etc
p969
aVuntil the forked-package version itself changes
p970
aVIt may well be necessary to set this in setup
p971
aVpy as well as other tools may be querying the package itself for it's version
p972
as(dp973
g16
V100297
p974
stp975
a((dp976
g2
(lp977
VThe collection display takes the dates from the catalog metadata as strings and interprets those as DateTime instances
p978
aVThe event edit form works with the actual DateTime instances
p979
aVClearly something goes wrong with the catalog storage of the start and end dates, and/or with the display
p980
aVYou could check the timezone on your indexed events
p981
aVGo to the ZMI, find the  object, and navigate to it's  tab
p982
aVFind any  there (you can use the path filter to narrow down results), and click on it's hyperlinked path
p983
aVIt'll open a new window with the catalog information for that specific object
p984
aVThe top table holds the catalog metadata on that object, and collections will use the  and  fields to render event info
p985
aVNote that these should include timezone info; in my test setup I see date-time strings like
p986
aVIf these dates look off to you (missing or incorrect timezone), do a full reindex of your site
p987
aVUse the  tab of the  object, there is a  button there
p988
aVI'd set the  value to 1000 objects or so so you get to see the progress in the Zope event log
p989
as(dp990
g16
V100297
p991
stp992
a((dp993
g2
(lp994
VA much better workaround would be to customize the  skin script from the ATContentTypes skin layer
p995
aVReplace the line reading:
p996
aVwith:
p997
aVand the event view tables work again for events
p998
as(dp999
g16
V100297
p1000
stp1001
a((dp1002
g2
(lp1003
VThe goal of toolset
p1004
aVxml is to instantiate tools into the database
p1005
aVIt can also be used to remove tools; this is very useful in upgrade steps for example
p1006
aVExample toolset
p1007
aVxml:
p1008
aVThis example toolset
p1009
aVxml would instantiate the FooTool class as  in it's context, and remove any object with id  if present
p1010
aVNote that you can use a toolset
p1011
aVxml in any GenericSetup profile, not just in the package that defines the tool in the first place, for example, in general policy packages for a site you develop
p1012
as(dp1013
g16
V100297
p1014
stp1015
a((dp1016
g2
(lp1017
VThe difference is explained in: What is the difference between the various ZODB blobstorage layouts
p1018
aVYou don't need to worry about this;  is there only for backwards compatibility
p1019
aVIf you do have a  layout blobstorage (you'll get a warning in the log if you do) and want to migrate to a  layout, use the migrateblobs script; here is a buildout part to create the script:
p1020
aVShut down any instances and ZEO servers, back up your blob storage and run the script on your blobstorage directory:
p1021
aVhas then been migrated to use the  layout
p1022
as(dp1023
g16
V100297
p1024
stp1025
a((dp1026
g2
(lp1027
VYou generally don't need to worry about the layout;  is there only for backwards compatibility
p1028
aVIf you do have a  layout blobstorage (you'll get a warning in the log if you do) and want to migrate to a  layout, use the migrateblobs script; here is a buildout part to create the script:
p1029
aVShut down any instances and ZEO servers, back up your blob storage and run the script on your blobstorage directory:
p1030
aVwill then contain the migrated blobs using the  layout
p1031
as(dp1032
g16
V100297
p1033
stp1034
a((dp1035
g2
(lp1036
VBrowser layer interfaces are simply 'painted' onto the request with
p1037
aVSimply do so in your test setup before you look up the view:
p1038
as(dp1039
g16
V100297
p1040
stp1041
a((dp1042
g2
(lp1043
VYour diagnosis is incorrect; the portal_factory tool is stateless and thus does not require any session affinity
p1044
aVYour error message is also very vague and looks incomplete
p1045
aVHave you checked the instance log for complete tracebacks
p1046
as(dp1047
g16
V100297
p1048
stp1049
a((dp1050
g2
(lp1051
VThe start and end fields are standard Archetypes DateTimeField fields, using the default CalendarWidget widgets
p1052
aVThe CalendarWidget reuses some fairly old and crufty calendar macros from Plone, and these read the range of selectable years from the site properties
p1053
aVYou can change these in the ZMI, find the  tool, then the  property sheet within that
p1054
aVThe two properties to look for are:
p1055
aVcalendar_starting_year
p1056
aVThe starting year to show in the calendar widget
p1057
aVDefault is 2001
p1058
aVcalendar_future_years_available
p1059
aVThe number of future years, after the current year, to show in the calendar widget
p1060
aVDefault is empty, and the widget then falls back to 5 years
p1061
aVAlso see the site properties documentation; you can also use a GenericSetup profile to set these
p1062
aVThese values apply to all usage of the calendar macros
p1063
aVYou can also set this for just the event type, by setting the ,  and/or  properties on the CalendarWidget for the startDate and endDate fields
p1064
aVIf you set an  the  property is ignored
p1065
aVMonkey-patch style altering of the event schema:
p1066
as(dp1067
g16
V100297
p1068
stp1069
a((dp1070
g2
(lp1071
VYou can register your classic portlet trough the  portlet, configured with a template and macro name, using an  element in your portlets
p1072
aVxml file:
p1073
aVSee the Portlets section of the GenericSetup manual on Plone
p1074
aVorg or the original PLIP for details on Portlet assignments and GenericSetup
p1075
aVThe properties match the portlet dataprovider interface, see the Classic Portlet source code for the interface definition for the Classic Portlet
p1076
as(dp1077
g16
V100297
p1078
stp1079
a((dp1080
g2
(lp1081
VNo, Zope 2 does not support WSGI middleware, at least, not out of the box
p1082
aVYou could try and see if repoze
p1083
aVzope2 works for your use-case, as that bolts a WSGI pipeline on top of Zope 2
p1084
aVNote that development for that package stopped in 2009, and the last released version only supports Zope 2
p1085
aV10
p1086
aVYMMV
p1087
aVI suspect that your use-cases may be satisfied in other ways though, but you don't provide enough detail for us to help you
p1088
as(dp1089
g16
V100297
p1090
stp1091
a((dp1092
g2
(lp1093
VFirst of all, as the MutableString documentation states:
p1094
aVIt should be noted that these classes are highly inefficient compared to real string or Unicode objects; this is especially the case for MutableString
p1095
aVand most importantly:
p1096
aVThe main intention of this class is to serve as an educational example for inheritance
p1097
aVIn other words, don't use this class in real world code
p1098
aVTo get the data out, use the  parameter:
p1099
as(dp1100
g16
V100297
p1101
stp1102
a((dp1103
g2
(lp1104
VWell, using  for this problem makes no sense anyway
p1105
aVFor starters, your data isn't sorted ( doesn't sort the groups for you), and the lines are very simple
p1106
aVJust keep count as you process each line
p1107
aVI am assuming you don't know what flags you'll get:
p1108
aVPrinting the info after that is a question of iterating over your counts structure
p1109
aVI am assuming usernames are always 6 characters long:
p1110
aVAll code above is untested, but should roughly work
p1111
as(dp1112
g16
V100297
p1113
stp1114
a((dp1115
g2
(lp1116
VThe first thing I'd check if you have the right version of UberSelectionWidget installed
p1117
aVFrom the documentation for mailtogroup:
p1118
aVThis content rule uses the UberMultiSelectionWidget from plone
p1119
aVapp
p1120
aVform
p1121
aVThis widget is
p1122
aVbroken in version 1
p1123
aV1
p1124
aV7 of plone
p1125
aVapp
p1126
aVform
p1127
aVPlone 3
p1128
ag35
aV4 has this version
p1129
aVAs of version 1
p1130
ag1124
aV8 the widget is working again
p1131
aVTo use the correct version pin down
p1132
aVplone
p1133
aVapp
p1134
aVform:
p1135
aV[versions]
p1136
aVplone
p1137
aVapp
p1138
aVform = 1
p1139
ag1124
aV8
p1140
as(dp1141
g16
V100297
p1142
stp1143
a((dp1144
g2
(lp1145
VYou have 3 options, depending on where you want your buildout configuration to live and what options you have to check out your git repository
p1146
aVNote that as far as Python is concerned, the resulting egg is exactly the same
p1147
aVThe only difference between a development egg and a "normal" egg is that a development egg overrides any version requirements set elsewhere for that egg; it will be used regardless of what other versions of the egg are found elsewhere
p1148
aVInside the development repository
p1149
aVJust use the  option
p1150
aVThis creates a development egg, which is just the same as a normal egg but without a version check, nothing more, nothing less
p1151
aVYour buildout simply needs to list the current directory (where setup
p1152
aVpy lives) as the development egg:
p1153
aVIn a different location
p1154
aVYou'll need to be able to reach the git repository for this to create a new checkout
p1155
aVUse mr
p1156
aVdeveloper to pull in your git repository and automatically mark it as a development egg:
p1157
aVWith this setup, mr
p1158
aVdeveloper will automatically check out the git repository to the  subdirectory and add that to the buildout  option
p1159
aVUsing a tarball download
p1160
aVPlaces like github
p1161
aVcom also offer an option to download a tarball with the current contents of the repository
p1162
aVYou could use that to load that tarball as an egg source with the  option:
p1163
aVBuildout will then use that specific  entry to find the egg, provided it cannot find the egg elsewhere
p1164
as(dp1165
g16
V100297
p1166
stp1167
a((dp1168
g2
(lp1169
VThe ZODB persistence layer detects changes by hooking into the python  hook, marking the persistent object as changed every time you set an attribute
p1170
aVBut if you use a primitive mutable object like a python dictionary, then there is no way for the persistence machinery to detect the changes, as there is no attribute being written
p1171
aVYou have three options to work around this:
p1172
aVUse a persistent mapping
p1173
aVThe persistent package includes a persistent mapping class, which is basically a python dictionary implementation that is persistent and detects changes directly by hooking into  and other mapping hooks
p1174
aVThe  object in your example is basically a persistent mapping
p1175
aVTo use, just replace all dictionaries with persistent mappings:
p1176
aVForce a change detection by triggering the hook
p1177
aVYou could just set the key again, or on a persistent object, set the attribute again to force the object to be changed:
p1178
aVFlag the persistent object as changed
p1179
aVYou can set the  flag on the nearest persistent object
p1180
aVYour root object is the only persistent object you have, everything else is python dictionaries, so you need to flag that as changed:
p1181
as(dp1182
g16
V100297
p1183
stp1184
a((dp1185
g2
(lp1186
VThe cookie is set by the LanguageTool, and is only set when not present yet in the request, or different from what was set in the request
p1187
aVThe LanguageTool normally would only look at that very cookie for deciding what language to use
p1188
aVIn normal Plone use therefor, you will never see that Set-Cookie header on CSS and JS resources
p1189
aVLinguaPlone however, configures the LanguageTool to look at a lot more information, including the URL you were trying to access, to determine a language to use for the response
p1190
aVWith LinguaPlone installed, what the LanguageTool does is to determine the correct language for every resource accessed, as that is the only way to ensure a consistent UI language through-out
p1191
aVThe cookie is normally already set on load of the main page (which subsequently loads JS and CSS with the cookie set)
p1192
aVThus, in the normal scenario your CSS and JS are perfectly cacheable
p1193
aVYou are only seeing the Set-Cookie header because there is no corresponding  header in the request
p1194
aVIf you have to control this for your specific use-cases, you could monkeypatch , which is a before-publishing-traverse hook that will trigger the language determination on every request
p1195
aVI'd recommend using collective
p1196
aVmonkeypatcher for this
p1197
aVHere is what I did in a recent project where the site was migrated with a mixed set of languages throughout the tree (something we'll have to untangle at some point in the future):
p1198
aVconfigure
p1199
aVzcml:
p1200
aVand in the patches
p1201
aVpy module:
p1202
aVNote that the patch deletes the cookie after the fact, unless  was used on the current request
p1203
aVThere are no changes pending for this behaviour for Plone 4
p1204
aVx
p1205
as(dp1206
g16
V100297
p1207
stp1208
a((dp1209
g2
(lp1210
VBuildout specifically supports this scenario
p1211
aVEach part in a buildout can use it's own python interpreter, or you can set one python interpreter globally for all parts
p1212
aVThis defaults to the python used to run buildout
p1213
aVTo set the python interpreter used, set the  option to the name of a part that contains an  option
p1214
aVThis can be a part that builds a whole new python interpreter
p1215
aVHere is an example:
p1216
aVAny other parts in this buildout now will use the python 2
p1217
aV6 executable
p1218
aVYou may want to symlink the python script into the buildout  directory as well; the following part would do that for you:
p1219
as(dp1220
g16
V100297
p1221
stp1222
a((dp1223
g2
(lp1224
VWhat you see a combination of a relative URL (not starting with a  or full URL including protocol and hostname) and acquisition
p1225
aVThe latter means that  can be reached still after traversing over
p1226
aVYou'll have to use absolute URLs in the sidebar
p1227
aVIf you use a templating method to generate the sidebar (a ZPT pagetemplate, XDV, Diazo, etc
p1228
aVyou'll have to ensure you generate an absolute URL by either querying pageA directly for it's absolute url or any of it's ancestors and then add to the URL from there
p1229
aVHere are three TAL snippets that would achieve that:
p1230
aVIf you use an external templating system such as XDV, the same principles apply, but you won't be able to directly query either sectionA or pageA for their absolute URLs, but you will have absolute URLs to reconstruct a URL to them available, like the  in the last example
p1231
as(dp1232
g16
V100297
p1233
stp1234
a((dp1235
g2
(lp1236
VI am afraid that what you want is an impossible task; you are rendering the full chrome for a new context and everything will thus render using that context
p1237
aVYou'd have to redo everything; breadcrumbs, actions, portlets, any other context-sensitive viewlets
p1238
aVI am not sure what your use-case is that you have to support all possible layouts of arbitrary objects, you may have to rethink your options here
p1239
aVIf you do not have a use-case that requires all possible layouts to work, then you can just create a custom view for your canonical object that just re-renders the content well for the other object
p1240
aVMany views for content already include macros you can re-use, for example
p1241
aVTake a look at  for an example template that reuses such macros to render items in a folder for the  template
p1242
as(dp1243
g16
V100297
p1244
stp1245
a((dp1246
g2
(lp1247
VStore the button in a local variable in the outer loop, then refer to that variable in the inner scope of the success handler:
p1248
as(dp1249
g16
V100297
p1250
stp1251
a((dp1252
g2
(lp1253
VIf you are using  (I do hope you are) the easiest way to get all the  dependencies properly included in the python path is to have  create the script for you:
p1254
aVBuildout then will create a new  script for you that includes all the buildout eggs in
p1255
aVAlternatively, you can create a generic python script runner that includes all eggs in your buildout and can run arbitrary scripts; you can use this instead of the bare-bones python interpreter to run arbitrary python scripts with all the buildout eggs in :
p1256
aVThe  script can then be use to run arbitrary python scripts with all your buildout eggs already in , so  should work
p1257
aVNote that the Plone unified installer already comes with the  part included, and my choice of partname for this script was deliberately using the same name
p1258
aVIf you are not using  (and with Plone 4, that's not a good idea on the whole), you can also list the required packages (ZODB3, zope
p1259
aVinterface, RelStorage, psycopg2) in your  environment variable
p1260
as(dp1261
g16
V100297
p1262
stp1263
a((dp1264
g2
(lp1265
VI suspect you hit a bug fixed in newer revisions of Pyramid; your traceback indicates that either  or  is , but that code branch cannot be reached unless  is not , leaving the possibility that  is  instead
p1266
aVI found the following commit to Pyramids that adds a specific test for  being None:
p1267
aVhttps://github
p1268
aVcom/Pylons/pyramid/commit/f168197609169fb01b65adeb3eb59d069000fe2c
p1269
aVI say you have a method without any defaults and only a request parameter (, the work-around would be to add a keyword argument with a default (
p1270
aVDisclaimer: haven't yet had a chance to work with Pyramid, so my analysis is based purely on the Pyramid codebase
p1271
as(dp1272
g16
V100297
p1273
stp1274
a((dp1275
g2
(lp1276
VThe normal way to open a jQueryTools overlay is through  on the overlay API, but
p1277
aVprepOverlay hides all that in it's own wrapper in place for  style overlays
p1278
aVYou can do one of two things:
p1279
aVCall the click handler:
p1280
aVThis will trigger the correct handlers for all click events
p1281
aVCall the  handler directly, binding  to your element:
p1282
aVThis only will trigger the  click handler
p1283
as(dp1284
g16
V100297
p1285
stp1286
a((dp1287
g2
(lp1288
VFirst, use a wildcard DNS entry to point all subdomains to your server
p1289
aVThen in flask, read the request host header, and pull out the subdomain (if any) that was used to access your web app:
p1290
as(dp1291
g16
V100297
p1292
stp1293
a((dp1294
g2
(lp1295
VIf you were to call the original function without , you let JavaScript decide what to bind  to, and that may well be something different from what it would be bound to if you hadn't monkeypatched/duckpunched the original code
p1296
aVUsing , you ensure that the correct value is used for , e
p1297
aVg
p1298
aVthe one the wrapper function is being called with
p1299
as(dp1300
g16
V100297
p1301
stp1302
a((dp1303
g2
(lp1304
V only applies to class inheritance structures, where  and  are subclasses of
p1305
aVIn your example, you use a containment structure,  and  are attributes of , and you have no use for  calls
p1306
aVAlso, you generally really do not want to use a mutable list as a class attribute; appending to it will alter the one copy of the list (defined in the class) globally, not per instance; initiate the list in the  method instead:
p1307
aVThe  function is called to set up a new instance, and by assigning a new empty list to  there, you ensure that each instance has it's own copy
p1308
as(dp1309
g16
V100297
p1310
stp1311
a((dp1312
g2
(lp1313
VUse a replacement function to insert arbitrary substitutions
p1314
aVSee the  documentation for how the function works
p1315
aVHere is an example:
p1316
aVThe  function will be called for each match, and is passed a MatchObject
p1317
aVWe then use the matched value (, etc
p1318
aVto look up the replacement value, which then is inserted into  instead of the matched string
p1319
as(dp1320
g16
V100297
p1321
stp1322
a((dp1323
g2
(lp1324
VNormally, python finds modules and packages via the python path, via the  variable
p1325
aVWhen  creates scripts in the  directory, it'll add to the  variable, listing all the eggs for the given part
p1326
aVIn order for python to find your  module, or your  package, the current directory needs to part of python path too
p1327
aVI find it very surprising that a  module is found for , while the  package is not found; clearly the python paths for both parts are different
p1328
aVYou can look at the top of the generated  and  scripts to see what paths have been added to
p1329
aVIn any case, you can manually add additional paths to  with the  option in the  part
p1330
aVAny path listed there will end up in your generated script
p1331
aVSimply setting this to  is enough:
p1332
as(dp1333
g16
V100297
p1334
stp1335
a((dp1336
g2
(lp1337
VYou most likely do not have the External Editor helper application installed on your computer
p1338
aVThe  link in Plone sends a special file (the mime type data you see in your editor) that normally would be opened by the helper application
p1339
aVWhat platform are you on
p1340
aVYou can download the External Editor package and re-install the helper application for your platform
p1341
aVNote that for Mac, there is a separate package called Zope Edit Manager to install
p1342
aVThere are some rather dated troubleshooting and configuration instructions available for Windows and Unix in case automated installers fail
p1343
aVThese instructions haven't been updated in years though
p1344
as(dp1345
g16
V100297
p1346
stp1347
a((dp1348
g2
(lp1349
VPortlets are registered as utilities with the  interface with the zope component machinery
p1350
aVThese registrations are generated for you when registering portlets with portlets
p1351
aVxml
p1352
aVThe portlet management UI then uses these utility registrations to enumerate portlets you can add
p1353
aVLuckily,  provides a handy API to unregister these portlets again:
p1354
aVThe  parameter is a string, and is the same as used in a portlet
p1355
aVxml registration
p1356
aVFor example, the calendar portlet is registered as:
p1357
aVYou can thus remove the calendar portlet from your site by running the following code snippet:
p1358
aVYou can also just use the GenericSetup portlets
p1359
aVxml file to remove the portlets during setup time, just list the portlets  parameter and add a  attribute to the element:
p1360
aVThanks to David Glick for finding that one for us
p1361
as(dp1362
g16
V100297
p1363
stp1364
a((dp1365
g2
(lp1366
VOut-of-the-box, there is no way to see if users are currently using your site, only if they have just been using it
p1367
aVJust tail the  access logfile
p1368
aVNote that due to the nature of the HTTP protocol, 'current' users of your site do not maintain a connection, and thus, until they are back again for the next request, there is no accurate way to determine if anyone is using the site
p1369
aVThere are work-arounds, such as using sessions and timeouts, that use recency to estimate how many users are still around
p1370
aVis one such approach
p1371
aVNote that such approaches can have a hefty scalability penalty though
p1372
aVIf all you want to do is not inconvenience users during a restart, use a caching frontend and / or a load balancer and more than one instance instead
p1373
aVThat way users see cached content or content generated by an instance still up while you restart your first instance
p1374
as(dp1375
g16
V100297
p1376
stp1377
a((dp1378
g2
(lp1379
VYou have 3 options, and what you choose is dependent on what your skills are and how much time you are willing to invest:
p1380
aVBasic auth
p1381
aVHave your user enter a username and password into the app, and just use HTTP BasicAuth headers to access the site
p1382
aVPlone supports Basic auth authentication out of the box
p1383
aVThis is not the most secure method; passwords are basically sent base64-encoded, so you may want to use HTTPS to communicate with the server
p1384
aVA good idea in any case for authentication anyway
p1385
aVCookie authentication
p1386
aVSend a POST request with  and  items to '/login_form' on your Plone site, and capture the  header on the response, containing the  cookie
p1387
aVThat's a tk-auth authentication token you can use on any subsequent request
p1388
aVThis is a secure cookie, but any attacker sniffing the HTTP communication stream could re-use this, so again HTTPS is the secure way to communicate
p1389
aVOAuth
p1390
aVPlone does not (yet) support OAuth out of the box, but integrating with python-oauth should be trivial
p1391
aVThis would most likely require a PluggableAuthSystem (PAS) plugin to be written
p1392
as(dp1393
g16
V100297
p1394
stp1395
a((dp1396
g2
(lp1397
VYou can easily configure the built-in email notification for Zope, but we found that adding the mailinglogger package makes the emails a lot more managable
p1398
aVThe package adds:
p1399
aVcustomisable and dynamic subject lines for emails sent
p1400
aVemails sent with configurable headers for easy filtering
p1401
aVflood protection to ensure the number of emails sent is not excessive
p1402
aVsupport for SMTP servers that require authentication
p1403
aVconfigurable log entry filtering
p1404
aVThe  buildout recipe supports mailinglogger out of the box; simply define a  variable in your  part and include the mailinglogger egg:
p1405
aVThe package has been invaluable for us on larger clusters, where we configure additional variables per instance to be included in the subject; we can see what instance the problem occurred on directly in the subject
p1406
as(dp1407
g16
V100297
p1408
stp1409
a((dp1410
g2
(lp1411
VYou have an error in your rewrite rule; use  for the regular expression substitution at the end there
p1412
aVIn future, better use the RewriteRule Witch to construct your Zope rewrite rules, it constructs the correct rule flawlessly every time
p1413
as(dp1414
g16
V100297
p1415
stp1416
a((dp1417
g2
(lp1418
V is a function, so the python parser will pass everything between the parenthesis of the  function call as the argument tuple to that function
p1419
aVThus, to pass a literal tuple to a function call you'll always need to add the parenthesis to the tuple for the parser to recognize it as such:
p1420
as(dp1421
g16
V100297
p1422
stp1423
a((dp1424
g2
(lp1425
VIt means that your catalog was inconsistent; it thought it had indexing information for one document, and on un-index it couldn't find that same information anymore
p1426
aVAfter this error, your catalog is actually a little less inconsistent as the document is no longer inconsistently indexed
p1427
aVThe catalog is quite resilient in that way
p1428
aVIf you see the error more often, you'll need to verify that your custom index is taking care of indexing and unindexing properly, as it's internal data structures are getting out of sync more often
p1429
as(dp1430
g16
V100297
p1431
stp1432
a((dp1433
g2
(lp1434
VZMySQLDA is a Zope2 Product; in Zope 3 I'd use SQLAlchemy integrated with zope
p1435
aVsqlalchemy (and optionally z3c
p1436
aVsaconfig) to access MySQL data in your application
p1437
aVNote that your biggest problem is most likely one of being able to find the python MySQL drivers
p1438
aVSee MySQL for Python in Windows for help on that part (scan through the answers for the python-2
p1439
aV4 links)
p1440
as(dp1441
g16
V100297
p1442
stp1443
a((dp1444
g2
(lp1445
VI'd advise you to use archetypes
p1446
aVschemaextender instead of using patches to alter Archetypes content types
p1447
aVThe package includes documentation on how to implement your additional field
p1448
aVAs for your error, you created a tuple with one element, a field:
p1449
aVDelete the trailing comma and your code should work as intended
p1450
as(dp1451
g16
V100297
p1452
stp1453
a((dp1454
g2
(lp1455
VThe  recipe supports the usecase directly, but it's under-documented (the egg does contain full documentation)
p1456
aVSimply set the  option to the directory of your choice:
p1457
aVor simply set it to  to put it in your buildout download cache:
p1458
aVIt's up to individual recipes to support such sharing behaviour
p1459
aVI don't think a wrapping recipe is going to be easy seeing as buildout recipes can pretty much do anything
p1460
as(dp1461
g16
V100297
p1462
stp1463
a((dp1464
g2
(lp1465
VI'd use git or mercurial for this; simply import the project into git or mercurial, and merge the upstream changes into a branch in your project for easy merging into your trunk
p1466
aVIf the upstream project has a repository of their own, the import is even easier
p1467
aVBoth git and mercurial have support for directly importing other version control systems
p1468
aVI did this recently to adapt an existing project that lives in SVN: https://github
p1469
aVcom/mjpieters/rod
p1470
aVrecipe
p1471
aVrabbitmq
p1472
aVNote that that project has an 'upstream' branch
p1473
aVThat particular project has now accepted my proposed changes after reviewing the changes in github
p1474
aVcom
p1475
aVThere are a few questions here on SO on the subject:
p1476
aVFork and sync google code svn into github
p1477
aVTracking upstream svn changes with git-svn and github
p1478
aVBest way to fork SVN project with Git
p1479
aVIt should be trivial to create a similar setup with mercurial
p1480
as(dp1481
g16
V100297
p1482
stp1483
a((dp1484
g2
(lp1485
VThe  method returns the whole matched string, not any groupings you have defined with parenthesis
p1486
aVIf you want to return just a grouping in a regular expression, you'll have to use the  method multiple times, and extract the matched group from the resulting array:
p1487
aVThis works because the  flag is used on the regular expression
p1488
aVEvery time you call  on the  regular expression, it's  attribute is set to the next matching substring and that in turn makes sure that the next call to  starts searching at the next match
p1489
aVThe resulting array contains the whole matched string at index 0, then every matched group at subsequent positions
p1490
aVYour group is thus returned as index 1 of the array
p1491
as(dp1492
g16
V100297
p1493
stp1494
a((dp1495
g2
(lp1496
VMembers of a module are just attributes on that module, so you can use  on the module object to retrieve them
p1497
aVThe module objects themselves are stored in the  dictionary:
p1498
as(dp1499
g16
V100297
p1500
stp1501
a((dp1502
g2
(lp1503
VEmail addresses never start with an @, while twitter ids always do
p1504
as(dp1505
g16
V100297
p1506
stp1507
a((dp1508
g2
(lp1509
VUse another regular expression to collapse multiple dashes:
p1510
as(dp1511
g16
V100297
p1512
stp1513
a((dp1514
g2
(lp1515
VThe installation instructions on http://plone
p1516
aVorg/products/plone-true-gallery assume that you know how to add an egg to a Plone buildout; the instructions there are in addition to the normal egg installation procedures
p1517
aVAdd the egg to the  part:
p1518
as(dp1519
g16
V100297
p1520
stp1521
a((dp1522
g2
(lp1523
VUse the python-dateutil module, it's  method can detect and parse many different date formats
p1524
aVNote that python-dateutil is quite specific in how it'll deal with ambiguous dates (year, month or day first) and let's you tweak how you parse these
p1525
aVThis of course depends on what your data looks like; you may have to test some samples and hand-verify
p1526
as(dp1527
g16
V100297
p1528
stp1529
a((dp1530
g2
(lp1531
VTake a look at zope
p1532
aVsqlalchemy; it integrates SQLAlchemy into the Zope transaction manager
p1533
aVSQLAlchemy in turn lets you access many different databases, including MySQL, PostgreSQL and MS Server
p1534
aVThe zope
p1535
aVsqlalchemy package explains how to obtain a SQLAlchemy session
p1536
aVFrom there on out you use bog-standard SQLAlchemy operations for which there are plenty of tutorials and help here on SO
p1537
aVSQLAlchemy can also take care of setting up the database schema for you, if that is needed
p1538
as(dp1539
g16
V100297
p1540
stp1541
a((dp1542
g2
(lp1543
VZope3 (or Zope Toolkit, ZTK) is a collection of Python libraries, used by various projects, with BlueBream being one of them, classic Zope2 another
p1544
aVAs such, there is no need to provide specialized "Products" for these anymore
p1545
aVYou use the libraries like you would use other Python libraries; e
p1546
ag1298
aVyou write integration code that uses these libraries to build your application
p1547
aVThere may be server-specific packages, such as for Plone, BlueBream or Grok, that depend on features provided by those servers
p1548
aVThe fact that those servers rely heavily on the Zope Toolkit is a happistance that has nothing to do with providing add-ons for those servers
p1549
as(dp1550
g16
V100297
p1551
stp1552
a((dp1553
g2
(lp1554
VYour source code and your error do not match, the error states you didn't define the variable
p1555
aVI am guessing that what you want is:
p1556
as(dp1557
g16
V100297
p1558
stp1559
a((dp1560
g2
(lp1561
VCreate a sliding window, and test on that:
p1562
as(dp1563
g16
V100297
p1564
stp1565
a((dp1566
g2
(lp1567
VNot an approach I'd recommend, but you can access both the local and global namespaces as dictionaries; e
p1568
ag1298
aVyou can add arbitrary variables to those namespaces using the familiar dict interface:
p1569
aVYou will run into naming conflicts though
p1570
aVAlso, how will the rest of your code know what global variables contain your results
p1571
aVThey'll have to do indirect look-ups too
p1572
aVYou better just use one dictionary containing your results, and let that be the namespace instead of the global namespace
p1573
as(dp1574
g16
V100297
p1575
stp1576
a((dp1577
g2
(lp1578
VDo you require shared access to the database during unit tests
p1579
aVIf not, use a in-memory SQLite database for those tests
p1580
aVFrom the SQLAlchemy documentation:
p1581
aVThe sqlite :memory: identifier is the default if no filepath is present
p1582
aVSpecify sqlite:// and nothing else:
p1583
aVNo need to manage temporary files, no locking semantics, guaranteed a clean slate between unit tests, etc
p1584
as(dp1585
g16
V100297
p1586
stp1587
a((dp1588
g2
(lp1589
VI do not have an answer for you; this should not really happen
p1590
aVI certainly have not seen this
p1591
aVYou'll need to gather more information to troubleshoot this, and that perhaps requires interactive access to experts, and SO is not the place for such troubleshooting
p1592
aVAll I can do is advice that you gather as much information as possible, including a full trail of the user interaction from the various logs, including HAProxy and the ZEO server
p1593
aVIt may require additional instrumentation at the server level (when the NotFound error occurs, dump additional information about what is present, etc)
p1594
as(dp1595
g16
V100297
p1596
stp1597
a((dp1598
g2
(lp1599
VYou could add configuration sections to your zope
p1600
aVconf file via the zope-conf-additional section of the plone
p1601
aVrecipe
p1602
aVzope2instance part:
p1603
aVAny named product-config section is then available as a simple dictionary to any python product that cares to look for it; the above example creates a 'foobar' entry which is a dict with a 'spam': 'eggs' mapping
p1604
aVHere is how you then access that from your code:
p1605
as(dp1606
g16
V100297
p1607
stp1608
a((dp1609
g2
(lp1610
VYou can use the  instead of the default
p1611
aVIt takes a  attribute that controls the formatting of the value, and it'll use the request locale to format the date
p1612
aVmust be one of 'full', 'long', 'medium', 'short', or None and refers to the date formats defined in ; the default is None, which I think means 'short' but this is unclear from the code
p1613
aVThe exact formatting is taken from the request locale, which in turn is based on the language set for the Plone site by the portal_languages tool
p1614
aVThus setting the language of the site also determines what date formats the  will use; these are defined in the  package in the  directory, in a set of XML files (look for the  element)
p1615
aVIf this isn't satisfactory then you'll have to create a custom browser widget
p1616
aVYour best bet is to subclass the  yourself and provide a new  method to format the dates the way you want
p1617
as(dp1618
g16
V100297
p1619
stp1620
a((dp1621
g2
(lp1622
VThis works:
p1623
aVThis query finds the rows with the highest average per person (based on ID1), then deletes all the other rows
p1624
as(dp1625
g16
V100297
p1626
stp1627
a((dp1628
g2
(lp1629
VThe ECMAScript defines several properties for each property found on objects such as in prototypes
p1630
aVOne of these is the  property, and if it is set to , then that property will be skipped
p1631
aVYou can actually manipulate these properties using the  function:
p1632
aVThis method allows precise addition to or modification of a property on an object
p1633
aVNormal property addition through assignment creates properties which show up during property enumeration (for
p1634
aVin loop), whose values may be changed, and which may be deleted
p1635
aVThis method allows these extra details to be changed from their defaults
p1636
as(dp1637
g16
V100297
p1638
stp1639
a((dp1640
g2
(lp1641
VNo
p1642
aVExternal Methods are "old tech", pre-dating the Zope Component Architecture by several years
p1643
aVYou can easily add a GenericSetup import step that creates ExternalMethod objects on demand, but since only python modules located in the  directories (inside Products and the  location, you may as well just enumerate those locations via the usual Python file-access methods, add everything you find there and not use a registry at all
p1644
aVHowever, are you absolutely certain you want to use an ExternalMethod
p1645
aVWouldn't a simple utility or view be easier
p1646
as(dp1647
g16
V100297
p1648
stp1649
a((dp1650
g2
(lp1651
VI suspect you need to tell the PyQT configure where to find the sip libraries and include headers:
p1652
aVUpdated: Update my answer to include the PYTHONPATH environment var so  will load the correct sipconfig module
p1653
as(dp1654
g16
V100297
p1655
stp1656
a((dp1657
g2
(lp1658
VYou have indeed got too many closing parenthesis in your statement
p1659
aVYou are missing the opening parenthesis around the sub-query:
p1660
as(dp1661
g16
V100297
p1662
stp1663
a((dp1664
g2
(lp1665
VThere is no space before  in , while your generated regular expressions require there to be a space
p1666
aVYou can modify the test to match either after a space or at the beginning of a line:
p1667
as(dp1668
g16
V100297
p1669
stp1670
a((dp1671
g2
(lp1672
VAs long as you use the decorator only on methods, they'll be passed  as the first argument:
p1673
aVUpdated: The wrapper now uses  by default, but if you use this on a  class (as in your original question), it'll use the  attribute of the instance instead
p1674
aVI've used an  test to determine that a  attribute will be present, but you could use duck-typing instead (); the  variable is so generic however that you most likely will get unexpected results when used on arbitrary class methods
p1675
as(dp1676
g16
V100297
p1677
stp1678
a((dp1679
g2
(lp1680
VPython gives you loads of options to deal with such a situation
p1681
aVIf you have example code we could narrow that down for you
p1682
aVOne option you could look at is the  operator:
p1683
aVYou could also check for the length of the filtered list:
p1684
aVIf you are using a  construct you can exit the loop early if you come across negative test:
p1685
aVThe  function above will return False on the first value that's 2 or lower, for example, while it'll return True only if all values were larger than 2
p1686
as(dp1687
g16
V100297
p1688
stp1689
a((dp1690
g2
(lp1691
VYou are trying to strip the whole all characters present in the  string from your values
p1692
aVtreats this value as a set, it'll remove any , , , , or  from your string
p1693
aVSo, using  (and  and ) is only suitable if you want to remove sets of characters, not a multi-character string as a whole
p1694
aVIf you want to remove  from the start and  from the end, you could use the following:
p1695
aVIf you need to remove these from elsewhere in the string, you need to use :
p1696
aVor you could look into regular expressions
p1697
as(dp1698
g16
V100297
p1699
stp1700
a((dp1701
g2
(lp1702
VThe modes with which the blobstorage writes it's directories and files is hardcoded in
p1703
aVSpecifically, the standard  class creates secure directories (only readable and writable for the current user) by default
p1704
aVYou could provide your own implementation of  that would either make this configurable, or just sets the directory modes to , and then patch  to use your class instead of the default:
p1705
aVQuite a hand-full, you may want to make this a feature request for ZODB3 :-)
p1706
as(dp1707
g16
V100297
p1708
stp1709
a((dp1710
g2
(lp1711
VYou have several options; the condition expression can be extended almost infinitely
p1712
aVBy folder id
p1713
aVThe obvious test would be to test for a set of folder ids:
p1714
aVUse collective
p1715
aVflag
p1716
aVcollective
p1717
aVflag let's your content editors determine where the tab should show up
p1718
aVIt adds a simple boolean checkbox to your content, and you could easily test for that flag being set on your folders
p1719
aVThe flag only shows up on content types that have the correct interface, so you could easily do this
p1720
aVUse a script test
p1721
aVYou can use any acquirable method for your test, including a Python script in the skin
p1722
aVNot the best practice, but it may just give you the extra flexibility you need
p1723
aVJust remember to test for conditions on
p1724
as(dp1725
g16
V100297
p1726
stp1727
a((dp1728
g2
(lp1729
VHere is a generator that gives you  spanning the months between start and end (inclusive)
p1730
aVDemonstration:
p1731
as(dp1732
g16
V100297
p1733
stp1734
a((dp1735
g2
(lp1736
VYou may want to double-check this, but it looks like your tests are importing the  package in the  directory, instead of the package-under-test from the  directory
p1737
aVWhy do you need to use a package with the same name as the package-under-test
p1738
aVI'd simply move the testcore module up to the tests directory, or rename the  package and avoid the potential naming conflict altogether
p1739
aVIn any case, you want to insert a  line just before the failing import and play around with different import statements to see what is being imported from where ( is your friend) so you get a better insight into what is going wrong
p1740
as(dp1741
g16
V100297
p1742
stp1743
a((dp1744
g2
(lp1745
VGenericSetup profiles need to be explicitly loaded, they are not loaded on start-up
p1746
aVYou can do this by either reinstalling your package in the QuickInstaller
p1747
aVAlternatively, you can just re-import just viewlets
p1748
aVxml via the setup tool
p1749
aVYou'll find that tool in the ZMI (look for the  tool):
p1750
aVOnce there you select the  tab:
p1751
aVYou'll then have to find your package profile in the drop-down list:
p1752
aVThe tab will automatically reload once you make your choice
p1753
aVScroll down to the "Viewlet Settings" step and check it's checkbox:
p1754
aVThen finally, uncheck the "Include dependencies
p1755
aVcheckbox at the bottom and click the "Import selected steps" button:
p1756
as(dp1757
g16
V100297
p1758
stp1759
a((dp1760
g2
(lp1761
VHow about only calling the decorated method if it has been validated
p1762
aVYou can pass the return value of the  method along if you like:
p1763
aVThe key here is adding  to the  function
p1764
aVWhat happens is that your decorated functions do not get bound to the instance (and become methods), but the function returned by the decorator ( in the above example) get's bound instead
p1765
aVSo this function will get the  (the instance) parameter passed in when called
p1766
aVIt's important to remember that what a  does is simply call  passing in the function you are decorating, and then replace the function you are decorating with whatever the decorator returned
p1767
aVIn your example this is , and to the class, there is no difference between that and the original function before decorating
p1768
aVIn the above example, I declared  explicitly
p1769
aVIf we hadn't, we could also have just taken it from :
p1770
aVAlso note that we pass an extra keyword argument to the wrapped method, named
p1771
aVThis is entirely optional, you can just drop the  and  parts from the example
p1772
as(dp1773
g16
V100297
p1774
stp1775
a((dp1776
g2
(lp1777
VHiding a field from the  form and only show it on the  form is not supported out-of-the-box, only the other way around
p1778
aVYou'll have to customize either the one or the other form to accomplish this; customize plone
p1779
aVapp
p1780
aVusers
p1781
aVbrowser
p1782
aVpersonalpreferences
p1783
aVUserDataPanel to remove your field or provide a new version of plone
p1784
aVapp
p1785
aVusers
p1786
aVbrowser
p1787
aVregister
p1788
aVRegistrationForm to add your field there
p1789
aVHere's how I'd do it:
p1790
aVNote the , I had to guess at the name of your extra field
p1791
aVYou can then register this customized panel with ZCML against your theme browser layer, or directly on your Plone site or a custom interface
p1792
aVHere I take the easy way out and register it for the Plone site object:
p1793
aVThis should work for both Plone 4
p1794
aV0 and 4
p1795
aV1, as this particular class did not change
p1796
as(dp1797
g16
V100297
p1798
stp1799
a((dp1800
g2
(lp1801
VBest practice is to use jQuery
p1802
aVdata(), as this follows the HTML5 standard for such information
p1803
as(dp1804
g16
V100297
p1805
stp1806
a((dp1807
g2
(lp1808
VThe sys
p1809
aVstd* objects are standard Python file objects, so they have a  attribute and a  method:
p1810
aVShort of telling you exactly what TTY device you got, that's the extend of the API offered by Python
p1811
as(dp1812
g16
V100297
p1813
stp1814
a((dp1815
g2
(lp1816
VNote: This answer is outdated as of Celery 3
p1817
aV0, where you now use  to get your per-task logger set up
p1818
aVPlease see the Logging section of the What's new in Celery 3
p1819
aV0 document for details
p1820
aVCelery has dedicated support for logging, per task
p1821
aVSee the Task documentation on the subject:
p1822
aVYou can use the workers logger to add diagnostic output to the worker log:
p1823
aVThere are several logging levels available, and the workers loglevel setting decides
p1824
aVwhether or not they will be written to the log file
p1825
aVOf course, you can also simply use print as anything written to standard out/-err will be
p1826
aVwritten to the log file as well
p1827
aVUnder the hood this is all still the standard python logging module
p1828
aVYou can set the  option to False to allow your own logging setup to work, otherwise Celery will configure the handling for you
p1829
aVHowever, for tasks, the  call does allow you to set up a separate log file per individual task
p1830
aVSimply pass in a  argument and it'll route log messages to that separate file:
p1831
aVLast but not least, you can just configure your top-level package in the python logging module and give it a file handler of it's own
p1832
aVI'd set this up using the  signal; here I assume all your modules live in a package called  (as in  and ):
p1833
aVNow any logger whose name starts with  will have all it's messages sent to  instead of to the root logger (which doesn't see any of these messages because  is False)
p1834
as(dp1835
g16
V100297
p1836
stp1837
a((dp1838
g2
(lp1839
VDistribute the source tarball only; easy-install (or pip or buildout, or whatever package dependency manager / installer you use) will create an egg for you for the python version used to install it
p1840
aVYou only ever need to create eggs for distribution only for packages with C-extensions, and then only for Windows because most Windows system lack the tools needed to build the egg themselves
p1841
aVTake a look at PyPI to see many examples of this, like the zope
p1842
aVinterface page
p1843
aVNote that there are only
p1844
aVegg distributions there for python versions 2
p1845
aV4, 2
p1846
aV5 and 2
p1847
aV6 for Windows
p1848
aVEverything else just uses the  tarball download and builds the  locally as needed
p1849
aVYou build a source tarball using the  command
p1850
aVPersonally, I use jarn
p1851
aVmkrelease; it automates much of the process for you (like uploading the source distribution to a distribution server)
p1852
as(dp1853
g16
V100297
p1854
stp1855
a((dp1856
g2
(lp1857
VNote that you have 2 different  locations; one is  and the other is
p1858
aVThe egg in the latter location is being preferred over the egg in the first location when the latter location comes first in your
p1859
aVIn iPython, you can check the python path by printing ; install the new egg in the second location to have iPython use it, or remove the old egg from that location altogether
p1860
aVIf you do this manually, don't forget to update the  file in the affected  directory
p1861
as(dp1862
g16
V100297
p1863
stp1864
a((dp1865
g2
(lp1866
VAll ways are valid and depend completely on your subject domain and the compartmentalisation of functionality, the separation of concerns
p1867
aVIn other words, it depends
p1868
aVFor example, you could have a class whose public API has 2 methods that both depend on a 3rd method, that you deem to be private
p1869
aVIt is your choice as a developer not to make that 3rd method part of the public API, yet it's there in your source code:
p1870
aVIn that case, there is absolutely no need for users of your API to call  directly and pass it's return value to either
p1871
aVHowever, if you feel that consumers of your API should provide your method with specific information for which there is an easy default method that could calculate that specific information for them in most cases, you would want to pass in the return value of that default method
p1872
aVThat way, those consumers can also use their own method of calculation and use those values instead:
p1873
aVAnd when to use instance variables
p1874
aVOnly when the return values of a function are to persist with the instance, when they reflect the internal state of that instance
p1875
aVFor example, if your class represents a car, it may make sense for your application to store the location of the car between operations on that car
p1876
aVSo if you want to know if it needs to stop for a traffic light right now, call the  method first, then use another method to calculate the distance from the traffic light
p1877
aVYou wouldn't pass the output of the  call to the distance calculation method, you would just keep the position updated in the instance
p1878
aVIf however, you need to update the position of the car in a collision, you'll need to take data from the car (based on return values from methods called on the car), combined with external information (position of other object, resistance of the road surface, etc
p1879
aVto feed back into the  method on the car
p1880
aVBecause you now need to add additional information from outside the car instance, you'll have to pass in the values from one method call to the other via your public API
p1881
aVRemember, software development is more an artform than a strict engineering discipline, and thus the answer as to how to do this varies from developer to developer and from software project to software project
p1882
aVThere never is no one answer
p1883
aVJust try to make it explicit and obvious, natural
p1884
as(dp1885
g16
V100297
p1886
stp1887
a((dp1888
g2
(lp1889
VThe  iterator returns tuples of the outcome of the grouping function and a new iterator that is tied to the same "outer" iterator the  operator is working on
p1890
aVWhen you apply  to the iterator returned by  without consuming this "inner" iterator,  will have to advance the "outer" iterator for you
p1891
aVYou have to realize that the  function does not act on a sequence, it turns any such sequence to an iterator for you
p1892
aVPerhaps this is better explained with some metaphors and handwaving
p1893
aVPlease follow along as we form a bucket line
p1894
aVImagine iterators as a person drawing water in buckets from a well
p1895
aVHe has an unlimited number of buckets to use, but the well may be finite
p1896
aVEvery time you ask this person for a bucket of water, he'll draw a new bucket from the well of water and pass it to you
p1897
aVIn the  case, you insert another person into your budding bucket chain
p1898
aVThis person doesn't immediately pass buckets at all
p1899
aVHe passes you the outcome of instructions you gave it plus another person every time you ask for a bucket, whom will then pass you buckets via the  person to whomever is asking, as long as they match the same outcome to the instructions
p1900
aVThe  bucket passer will stop passing these buckets if the outcome of the instructions changes
p1901
aVSo  gives buckets to , who passes this to a per-group person, , , and so on
p1902
aVIn your example, the water is numbered, but there can only be 1000 buckets drawn from the well
p1903
aVHere is what happens when you then pass the  person to the  call:
p1904
aVYour  call asks  for a bucket
p1905
aVNow,  asks for one bucket from the person at the well, remembers the outcome of the instructions given, holding on to the bucket
p1906
aVTo  he'll pass the outcome of the instructions () plus a new person,
p1907
aVThe outcome is stored as the key, and the  person, who wants to pull buckets is stored as the value
p1908
aVThis person is not yet asking for buckets however, because no-one is asking it to
p1909
aVYour  call asks  for another bucket
p1910
aVhas these instructions, and goes looking for the next bucket where the outcome changes
p1911
aVIt was still holding on to the first bucket, no-one asked for it, so it throws away this bucket
p1912
aVInstead, it asks for the next bucket from the well and uses his instructions
p1913
aVThe outcome is the same as before, so it throws this new bucket away too
p1914
aVMore water goes over the floor, and so go the next 499 buckets
p1915
aVOnly when the bucket with number 501 is passed does the outcome change, so now  finds another person to give instructions to (person ), together with the new outcome, , passing these two on to
p1916
aVYour  call stores  as a key, and person  as the value
p1917
aVdoes nothing, no-one is asking it for water
p1918
aVYour  asks for another bucket
p1919
aVspills more water, until it holds bucket with the number 999, and the person at the well shrugs his shoulders and states that now the well is empty
p1920
aVtells  the well is empty, no more buckets are coming, could he please stop asking
p1921
aVIt still holds the bucket with number 999, because it never has to make space for the next bucket from the well
p1922
aVNow you come along, asking  for the thing associated with the key , which is person
p1923
aVYou pass  to , which will therefore ask  for all the buckets  can get
p1924
aVgoes back to , who holds one bucket only, the bucket with number 999, and the outcome of the instructions for this bucket match what  is looking for
p1925
aVSo this one bucket  gives to , then shrugs his shoulders because there are no more buckets, because  told him so
p1926
aVYou then ask  for the person associated with the key , which is person
p1927
aVBy now,  has nothing to give any more, the well is dry and he's standing in a puddle of 999 buckets of water with numbers floating around
p1928
aVYour second  gets nothing
p1929
aVThe moral of this story
p1930
aVImmediately ask for all buckets of water when talking to , because he'll spill them all if you do not
p1931
aVIterators are like the brooms in fantasia, diligently moving water without understanding, and you better hope you run out of water if you do not know how to control them
p1932
aVHere is code that would do what you expect (with a little bit less water to prevent flooding):
p1933
as(dp1934
g16
V100297
p1935
stp1936
a((dp1937
g2
(lp1938
VYou can access the object just fine that way, but you get an unwrapped object
p1939
aVIn Zope, the object is normally retrieved via traversal, and every next object you retrieve this way is wrapped in the correct acquisition context
p1940
aVThis context tells every object what it's parent object is, and this is in turn used to calculate the object's absolute URL and it's security context
p1941
aVYou would be better off using the Zope intid facilities (via it's five
p1942
aVintid integration layer); that gives you a unique integer ID for each object, and the utility not only keeps track of the object  but also of it's path, so you can get the object back with the correct context
p1943
as(dp1944
g16
V100297
p1945
stp1946
a((dp1947
g2
(lp1948
VYour setuptools installation is broken
p1949
aVThe  script in your  directory, is only a wrapper that loads the actual  module in your Python installation, and the latter is missing
p1950
aVPresumably uninstalling  either broke the pointer to it (usually in the form of a  file in your  directory) or removed the whole package but didn't remove the  wrapper script
p1951
aVYour best bet is to re-install `` from scratch again, by following the instructions on the setuptools PyPI page
p1952
as(dp1953
g16
V100297
p1954
stp1955
a((dp1956
g2
(lp1957
Veasy_install expects to find either a source distribution, or an egg
p1958
aVIt's best to upload source distributions () to PyPI (or whatever distribution server you are using), and only upload eggs if your python package contains C extensions, and then only for Windows eggs (see my answer to Can I create a single egg for multiple versions of python
p1959
aVThe  command, without additional configuration, creates a  or  archive containing the compiled python files (and any C extensions compiled) for your current platform, sans installer (so not including the  file)
p1960
aVIt's intended for unpacking by hand in your site-packages location and pre-dates distribution via eggs
p1961
aVIf you were to unzip it, you'll notice it even included the full, absolute path to your site-packages directory in the tarball
p1962
aVYou can configure  to generate a RPM or a
p1963
aVdeb file, or a simple Windows installer, but these are again aimed at providing installation bundles for other distribution systems not related to PyPI and easy_install
p1964
aVSo, to summarize, in most cases it's best to upload an  source distribution and have easy_install do the python compilation (into an egg) on installation
p1965
aVIf you do want to upload a pre-compiled distribution (which is then tied to specific Python version and the platform for which it was compiled), use the  command instead
p1966
as(dp1967
g16
V100297
p1968
stp1969
a((dp1970
g2
(lp1971
VIf you are dealing with one SQLite database at a time, there is no limit on the number of database files you can handle
p1972
aVJust make sure you clean up properly (close each database connection) before you open the next database and you should see no problems whatsoever
p1973
aVOpening one database at a time makes this no different from using just one database file
p1974
aVSQLite is a great format, I have yet to see any integrity issues, and I've abused the format quite extensively, including rsyncing an updated database in place before re-opening the database (the overwritten database was only ever read from), or perform a complete clear and rebuild from a second process (wrapped in one big transaction, again the first process only ever read from it)
p1975
aVThe one thing you shouldn't do with it is store it on a network share
p1976
aVAs for size limits, take a look at http://www
p1977
aVsqlite
p1978
aVorg/limits
p1979
aVhtml; the SQLite project takes it's testing serious and the database limits are included
p1980
aVWith a maximum BLOB size of 2 GB this means they test databases that are at least that large in their test suite, so databases of up to 500MB should be a breeze to deal with
p1981
as(dp1982
g16
V100297
p1983
stp1984
a((dp1985
g2
(lp1986
VThat's because normally,  is set to  for  elements
p1987
aVSee the W3C CSS3 specification: http://www
p1988
aVw3
p1989
aVorg/TR/css3-lists/#declaring-a-list-item
p1990
aVTo declare a list item, the \u2018display\u2019 property should be set to \u2018list-item\u2019
p1991
aVNote that you can give arbitrary HTML elements the same behaviour; set  on a  for example
p1992
as(dp1993
g16
V100297
p1994
stp1995
a((dp1996
g2
(lp1997
VIndeed, your changesets are timestamped (internally stored as seconds-since-the-UNIX-epoch and a timezone offset), and when displaying changeset, they are ordered by timestamp and your changesets will be displayed in the incorrect place as their timestamps are be incorrect
p1998
aVSee http://mercurial
p1999
aVselenic
p2000
aVcom/wiki/ChangeSet
p2001
aVThis is not really that much of a problem though; timestamps have no bearing on how your changes are merged with those of your colleague
p2002
aVOnly the changeset IDs matter here and when merging a common ancestor is used
p2003
aVIt'll follow the graph of your changesets down looking for a changeset ID that your colleague also has and then merges your and his changes from the on forward
p2004
aVSee http://mercurial
p2005
aVselenic
p2006
aVcom/wiki/Merge
p2007
aVSo, merges are not affected, only the display of changesets, where your changesets will be sorted into the wrong location
p2008
aVIt'll confuse  you and your colleague, but your changes themselves are safe
p2009
as(dp2010
g16
V100297
p2011
stp2012
a((dp2013
g2
(lp2014
VThis is a bug you'll need to report with the authors of the quintagroup
p2015
aVtransmogrifier package
p2016
aVPaths must always be ASCII bytestrings, not Unicode objects
p2017
aVAll sections in collective
p2018
aVtransmogrifier (the underlying engine that quintagroup
p2019
aVtransmogrifier uses) encode paths to ASCII
p2020
aVHere is a code snippet from collective
p2021
aVtransmogrifier
p2022
aVsections
p2023
aVconstructor for example:
p2024
aVReport it to the dedicated issue tracker on Plone
p2025
aVorg so the authors can fix it for you
p2026
as(dp2027
g16
V100297
p2028
stp2029
a((dp2030
g2
(lp2031
VHere is what I think differs: The version of docutils in both python installations
p2032
aVThere is still constant work being done on the docutils package and that project releases the current Subversion HEAD as a snapshot on a regular basis
p2033
aVThe line numbers in your Python 2
p2034
aV7 traceback seem to match the latest snapshot (which according to the headers on the download was released the 1st of September 2010)
p2035
aVI am reasonably sure that the Python 2
p2036
aV6 site-packages directory differs from the one in your Python 2
p2037
aV7 installation
p2038
aVRun:
p2039
aVto confirm this
p2040
aVIf I'm right, just copy over the version in the 2
p2041
aV6 tree to the 2
p2042
aV7 tree, and have Python 2
p2043
aV7 re-compile them on import, or use the  script:
p2044
as(dp2045
g16
V100297
p2046
stp2047
a((dp2048
g2
(lp2049
VOh my
p2050
aVI looked into the setup
p2051
aVpy for SCons, and it is a bit of a mess
p2052
aVIt even stubbornly only installs in  when installing on a Mac
p2053
aVIt certainly is not suitable for use with setuptools (and thus zc
p2054
aVbuildout)
p2055
aVYou can use  to run the setup
p2056
aVpy script with  and configure it to install in a  subdir, then use a separate part to symlink all the scripts into :
p2057
aVSo, we ignore setuptools altogether, do not build an egg, but instead just download the tarball, run  manually, then symlink the interesting parts
p2058
as(dp2059
g16
V100297
p2060
stp2061
a((dp2062
g2
(lp2063
VOn Zope, you control access to views via permissions, but to permit someone to access a given permission, you must grant such permissions to a role
p2064
aVAnyone in the Plone administrators group has been granted the  role (on Plone 4
p2065
aV2 that'll change to the  role) generally have access to most permissions
p2066
aVThere is also the automatic  role, which is given to anyone that has been authenticated (has logged in)
p2067
aVThe latter doesn't have many default permissions though
p2068
aVPermissions are generally named after the action you want to permit
p2069
aVIf your view's goal is to manage some aspect of your Plone portal, then the  permission is probably what you want
p2070
aVYou can check the full list of default permissions if you need another one
p2071
aVThere is some excellent documentation on how security works in Plone, which includes information on how to define new permissions too, and how to assign existing permissions to roles
p2072
as(dp2073
g16
V100297
p2074
stp2075
a((dp2076
g2
(lp2077
VThe page contains only letters
p2078
aVSo the simplest solution is to look for uppercase letters flanked by lowercase characters:
p2079
aVLook-ahead and look-behind is just making it difficult for yourself
p2080
as(dp2081
g16
V100297
p2082
stp2083
a((dp2084
g2
(lp2085
VYou can pin any and all eggs (regardless of what they are used for) with a  section
p2086
aVYou have to explicitly declare such a section, but then it applies to recipe eggs as well:
p2087
aVYou can name the part that specifies version pins any way you want, but most people just name it
p2088
as(dp2089
g16
V100297
p2090
stp2091
a((dp2092
g2
(lp2093
VNo, you can safely delete it; it's a backup of the database from before the pack
p2094
aVIf the pack went haywire for some reason, you could use it to restore the database to the state it was before packing, by simply moving it back to
p2095
as(dp2096
g16
V100297
p2097
stp2098
a((dp2099
g2
(lp2100
VYou can add any python package hosted on git-hub by adding a find-links url pointing to the project tarball URL plus a #egg=packagename postfix
p2101
aVAs you already discovered, for mongokit that is:
p2102
aVYou can add a version number to that URL to provide buildout with a reason to prefer the github URL over the one found on PyPI
p2103
aVThis is needed when the version numbers match, as is the case for mongokit at the time of answering
p2104
aVThe version is appended with a dash:
p2105
aVI've added a marker to the version number and a counter; the addition of the marker means that the github version will be deemed newer than the version found on PyPI, but if 0
p2106
aV7 was released, it would be the newer one
p2107
aVYou can make  anything you like, and you can upgrade the number if you needed to get the latest changes from github (the egg will be cached locally otherwise)
p2108
aVI'd also pin that version in the buildout
p2109
aVSo a simple buildout would be:
p2110
aVFrom there on out you can use mongokit as a setuptools dependency ()
p2111
as(dp2112
g16
V100297
p2113
stp2114
a((dp2115
g2
(lp2116
VUse viewlets for both usecases
p2117
aVA viewlet can be inserted in different parts of the rendered page, depending on both the viewlet manager you register it to and and what interfaces the viewlet applies to
p2118
aVThe viewlet manager determines the location the viewlet is inserted at, and the interface you register the viewlet for determines on what kind of URL the viewlet will be visible at
p2119
aVRegistering for  means show everywhere, and registering it for  means it'll only be visible when viewing a Page
p2120
aVTo see what viewlet managers are available and what viewlets are registered there, for any given URL, just add "/@@manage-viewlets" to the URL
p2121
aVThere you can see that there is a  and a  viewlet manager that would enable you to insert HTML there
p2122
aVMost of these are defined in the  package, and you'll need to find the interface that is registered with that name there (find it in your eggs directory of the buildout)
p2123
aVYou register a viewlet using ZCML, so you need to already have a python package that is loaded for your site
p2124
aVTo insert an arbitrary template, simply register it with the  directive:
p2125
aVNow, a viewlet based on the  template is registered for the  viewlet manager
p2126
aVThat template is a full zope page template, so you can use things like internationalisation in there:
p2127
aVYou can also add a full browser view class to back up the viewlet, and the template can access that class via the "view/" namespace, so you could add a method there to return random text to be inserted
p2128
aVYou can either manually enable the viewlet via the aforementioned '/@@manage-viewlets' URL or you can use a GenericSetup profile, where viewlets
p2129
aVxml let's you manage the registrations and ordering of viewlets:
p2130
aVFor more information, I refer you to the viewlets tutorial on Plone
p2131
aVorg
p2132
as(dp2133
g16
V100297
p2134
stp2135
a((dp2136
g2
(lp2137
VIt's a shortcoming in zc
p2138
aVrecipe
p2139
aVcmmi; it cannot handle environment variables without spaces
p2140
aVThere is a patch available in the bugtracker for the recipe
p2141
aVI am not currently aware of a workaround for this other than applying the patch
p2142
aVYou can apply the patch on existing eggs using the  recipe, which should work in this case too (untried):
p2143
aVThis assumes you have a  suddirectory with the patch from the bug downloaded
p2144
aVThe part needs to be listed before your cmmi part to be executed before that part (or you can fabricate a dependency)
p2145
as(dp2146
g16
V100297
p2147
stp2148
a((dp2149
g2
(lp2150
VYou are trying to pass an object to a task that cannot be serialized
p2151
aVTry to pass simpler data (information that let's you recreate the complex objects when the task is run)
p2152
aVNot sure if that's the actual cause of your error, but you should not pass Django models to tasks anyway
p2153
aVYou will run into race conditions otherwise
p2154
aVSee the Celery documentation on the subject:
p2155
aVThey shouldn\u2019t be passed on as arguments to tasks
p2156
aVIt\u2019s almost always better to re-fetch the object from the database when the task is running instead, as using old data may lead to race conditions
p2157
aVPass the unique key for the user object and whatever you need to identify the Facebook Like interaction as simple python types instead, and use that information from within the task to recreate what you need to do the task instead
p2158
as(dp2159
g16
V100297
p2160
stp2161
a((dp2162
g2
(lp2163
VThe error is related to Python, not RelStorage
p2164
aVSee http://bugs
p2165
aVpython
p2166
aVorg/issue1722344 for the bugreport I think is relevant here
p2167
aVThat bug applies to Python 2
p2168
aV5 and 2
p2169
aV6, but may also be applicable to Python 2
p2170
ag400
aVTry upgrading Python 2
p2171
aV4 to the latest if it is not already
p2172
aVIn any case, the message is harmless in this case
p2173
aVPacking only uses one thread, and you do get the success message at the end ( will only be displayed if the pack was successful)
p2174
aVYou could also try upgrading to RelStorage 1
p2175
aV5
p2176
aV0 (it came out last week); packing was significantly improved to handle larger scale databases and busy sites
p2177
as(dp2178
g16
V100297
p2179
stp2180
a((dp2181
g2
(lp2182
VThe MailHost
p2183
aVsend command takes both python (unicode) strings and email
p2184
aVMessage objects
p2185
aVThat means you can use the python email package to construct a proper MIME message with attachments
p2186
aVThe standard library includes a great page of examples; any text can still be generated by templates just like in the documentation you linked
p2187
as(dp2188
g16
V100297
p2189
stp2190
a((dp2191
g2
(lp2192
V is a wrapper around mechanize, and you can reach the wrapped mechanize browser via the  attribute:
p2193
aVNot tested, but the above should work
p2194
as(dp2195
g16
V100297
p2196
stp2197
a((dp2198
g2
(lp2199
VUse the  method instead:
p2200
aVNote that the @@language-controlpanel view uses the  module to provide translated languages; but that list is so incomplete that the languages list is not translated for most of UI languages
p2201
aVApparently italian is one language where this is translated
p2202
aVYou can reach the locales structure via the request, or via the  view
p2203
aVThe  dictionary maps language code (2 letters) to local language name:
p2204
aVAs you can see, the language names are lowercased, not properly capitalized
p2205
aVAlso, the data is expensive to parse (the package contains XML files parsed on first access) so it can take several moments before this data is available to you on first access
p2206
aVYour best bet would be to use Babel, as Hanno states, as it actually has far more current information available, and not just for a handful of languages
p2207
as(dp2208
g16
V100297
p2209
stp2210
a((dp2211
g2
(lp2212
VYou need to import all classes you are using in a python module
p2213
aVIn your first module () you are not using , only , so you can omit it there
p2214
aVdoes not need to know how s are defined at all
p2215
aVIn  however, you do need to import , as you are basing your  class on the  class, so it needs to have access to the definition there
p2216
aVI'd recommend you use a tool like pyflakes to check your files for errors like these
p2217
aVYou can hook such a script up with various editors to be run automatically, giving you instant feedback whenever you save your python files
p2218
as(dp2219
g16
V100297
p2220
stp2221
a((dp2222
g2
(lp2223
VThis happens when the field hasn't been bound or is missing the context
p2224
aVNormally validation will happen against a "bound" field () so that your context-aware vocabulary can be turned into a static vocabulary for this context
p2225
aVIt'll still be a function (not called with the context) when this didn't take place
p2226
aVI am not familiar enough with the datagrid widget setup to pinpoint where this goes wrong, but it appears that it generates widgets on-the-fly and I suspect it doesn't bind the fields for these correctly
p2227
aVTake a look at  method of the  module and try to figure out what's going on there with a debugger and / or file a bug with the authors of the package
p2228
as(dp2229
g16
V100297
p2230
stp2231
a((dp2232
g2
(lp2233
VBuildout does much more than pip; each part is a separate recipe which can run arbitrary python code to get your tasks accomplished
p2234
aVCoupled with dependencies between the parts and update detection, zc
p2235
aVbuildout is more comparable to make than to pip
p2236
aVFor example, using the  recipe, you can download and compile arbitrary "configure; make; make install" packages
p2237
aVThere are recipes to generate files from templates, or create symlinks, or install specific software packages and configure these with buildout-controlled settings all in one step
p2238
aVInstalling eggs according to dependencies is just one of the tricks that zc
p2239
aVbuildout supports
p2240
as(dp2241
g16
V100297
p2242
stp2243
a((dp2244
g2
(lp2245
VThere appears to be a corrupted portlet manager in your site; it is missing the "group" category
p2246
aVThis doesn't normally happen, though
p2247
aVYou could open the plone
p2248
aVapp
p2249
aVportlets
p2250
aVbrowser
p2251
aVmanage module, and insert a PDB debug prompt, to see what manager this is
p2252
aVLook for the  egg in your bin/instance script to find its path, then open the  that in your favourite text editor
p2253
aVInsert your  line before line 213, run your plone site in foreground mode () and start poking around
p2254
aVshould be interesting, for example, to figure out what manager this is
p2255
aVYou could then try to repair this by inserting an empty category mapper:
p2256
aVYou may want to be careful with that, though; there may be other things broken here
p2257
as(dp2258
g16
V100297
p2259
stp2260
a((dp2261
g2
(lp2262
VCreate an interface for this:
p2263
aVYou then assign this interface to your various content types, and register the view for that interface instead directly for a type:
p2264
as(dp2265
g16
V100297
p2266
stp2267
a((dp2268
g2
(lp2269
VPython is inherently flexible, and any object can be a base class as long as it looks like a base class
p2270
aVAs is always the case with Python, that means implementing some attributes that are expected to be found on a Python classes
p2271
aVThe Interface class (or it's bases Specification and Element) sets several
p2272
aVLook for any variables set starting with a double underscore () to gain an understanding:
p2273
aV: A string containing the python path module
p2274
aV: The name under which the class was defined
p2275
aV: The base classes of this class
p2276
aV: (optional) The docstring of the class
p2277
aVIn addition, the InterfaceClass  method will be called when used as a base class; Python basically treats base classes as metaclasses, and a new instance of the base class's class (metaclass) will be created whenever we use it in a class definition
p2278
aVThis means that the  method will be passed the new  and  values, as well as all the new class attributes as keyword arguments (including  and an optional )
p2279
aVThis is all documented in the Standard type hierarchy section of the Python Data Model document (look for the 'classes' paragraph on special attributes), and in the same document, in the Customizing class creation section (base classes with a  attribute are deemed a type)
p2280
aVSo, any python instance that defines at least ,  and  attributes, and a suitable  method will work as a base class for other classes
p2281
aVPython does the rest
p2282
as(dp2283
g16
V100297
p2284
stp2285
a((dp2286
g2
(lp2287
VUse the standard  blueprint to generate the paths; it accepts python expressions and can replace keys in-place:
p2288
aVThis thus takes the output of the  python expression (which uses the item  and stores it back under the same key
p2289
as(dp2290
g16
V100297
p2291
stp2292
a((dp2293
g2
(lp2294
VYou do not want to do that
p2295
aVThe  attribute is meant for application use, not end-users, and needs to be stable
p2296
aVIf you translate it, then you'll have to translate all named look-ups through-out your code too
p2297
aVTitles and descriptions can be translated, using the  marker on the  element
p2298
as(dp2299
g16
V100297
p2300
stp2301
a((dp2302
g2
(lp2303
VCurrently this is not supported out-of-the-box
p2304
aVObject identifiers () are only indexed as field values and thus can only be looked up as whole strings
p2305
aVYou'd need to add separate index to the catalog to support your use-case
p2306
aVYou could add a new TextIndexNG2 index with a new name indexing just the getId method
p2307
aVIn the ZMI, find the portal_catalog, then it's 'Indexes' tab, then on the right-hand-side you'll find a drop-down menu for adding a new index
p2308
aVPick a memorable name ('fullTextId' for example) and use  as the indexed attribute
p2309
aVYou'll need to do a reindex, but only for that index
p2310
aVOnce added, select it in on the Indexes tab (tick the check-box) and select 'Reindex' at the bottom of that page
p2311
aVNow you can use this index in your custom searches with a wildcard search
p2312
as(dp2313
g16
V100297
p2314
stp2315
a((dp2316
g2
(lp2317
VRegister it for a more specific interface
p2318
aVSay zope
p2319
aVinterface
p2320
aVInterface, or Products
p2321
aVArchetypes
p2322
aVinterfaces
p2323
aVIBaseContent instead
p2324
as(dp2325
g16
V100297
p2326
stp2327
a((dp2328
g2
(lp2329
VPlone redirects to the login form because you raise Unauthorized
p2330
aVIf you want different behaviour you'll need to do something different
p2331
aVIn this case, you could directly redirect the user to a new page with an error message tailored to the situation
p2332
as(dp2333
g16
V100297
p2334
stp2335
a((dp2336
g2
(lp2337
VThis is what the  architecture solves, but you must register all uses of an interface
p2338
aVBy itself,  does not keep track of what objects implement a given interface
p2339
aVWhat you are looking for is utility registrations; all implementations of a given service as defined by an interface
p2340
as(dp2341
g16
V100297
p2342
stp2343
a((dp2344
g2
(lp2345
VI don't think it's bad practice at all, I do similar things for similar situations
p2346
aVYou could use an attribute annotation, which would help prevent conflicts with other attributes, but that's a style and performance choice more than anything
p2347
aVAttribute annotations are stored in their own ZODB persistent record, so it depends on how often this attribute will change compared to the other attributes on the folder what impact this has
p2348
aVLast but not least, I would probably encapsulate the behaviour in an adapter, to make the implementation flexible for future uses
p2349
aVYou can either register the adapter to the ATFolder interface, or to IAttributeAnnotatable, depending on how much your implementation relies on what the adapted object needs to provide
p2350
aVOther notes: We've also used  connections between objects in the past (maintained outside the object schema, like your attribute), but found  (the underlying machinery  relies on) to be too fragile and would use simple UID attributes with catalog searches in the future
p2351
aVIn reference to Ross's answer, if the information in question doesn't need to be end-user editable, a schemaextender attribute is overkill
p2352
as(dp2353
g16
V100297
p2354
stp2355
a((dp2356
g2
(lp2357
VAll you need to do is call the field accessor with a file-like object, preferably one that includes the file mime-type ( or  in your case)
p2358
aVZope's OFS
p2359
aVFile
p2360
aVFile provides such info
p2361
aVLet's say your file field is simply called  (so it's setter is called ) and you have your image in a string variable named  containing a PNG image:
p2362
aVNote that you may want to change your field to type  though; it provides a richer interface for images, including HTML tag generation and scaling
p2363
as(dp2364
g16
V100297
p2365
stp2366
a((dp2367
g2
(lp2368
VIt is indeed okay to delete these
p2369
aV:-) They just contain the log output of your GS import runs
p2370
as(dp2371
g16
V100297
p2372
stp2373
a((dp2374
g2
(lp2375
VYou cannot use a Controller Page Template () as a macro, unchanged
p2376
aVFirst of all, a Controller Python Script expects a few parameters in it's "environment" (the  structure is one of these) that you don't have present when re-using it's TAL statements
p2377
aVYou'll have to rework the template to not rely on those parts
p2378
aVSecondly, this is a HTML form, and a form requires a target to send it's data to
p2379
aVIn a Controller Page Template this is controlled with the  file, you'll have to set it's target explicitly
p2380
as(dp2381
g16
V100297
p2382
stp2383
a((dp2384
g2
(lp2385
VThis happens when there is a discrepancy between the current Plone setup profile version number and the upgrade steps final version number
p2386
aVBecause there is no step from 4017 to 4018 you get this error message
p2387
aVThis is not necessarily a problem
p2388
aVYour upgrade to version 4017 worked without a hitch
p2389
aVWhat exact Plone version are you upgrading to, 4
p2390
aV0
p2391
aV9
p2392
aVIt may be worth reporting this as a (low priority) bug, but I doubt there is anything there to prevent you from using your site
p2393
aVTo illustrate, I see this all the time when using the latest development version of the  package, because that'll be one version 'tick' further than the latest release of the  package can upgrade me to
p2394
as(dp2395
g16
V100297
p2396
stp2397
a((dp2398
g2
(lp2399
VEither one, depending on how often your data changes and how big it is
p2400
aVIt's all about how the ZODB stores this information
p2401
aVStoring data directly on the object using setattr means that data is stored in the persistent record for that object
p2402
aVIf that's a big object that means there is a big transaction going to take place for that write
p2403
aVStoring data in a zope
p2404
aVannotations annotation means you get a separate persistent record for each annotation entry, so any changes to your data will result in a smaller transaction
p2405
aVBut if you want to access this data often, that extra persistent record will need to be loaded, on top of all the other persistent records
p2406
aVIt'll take a slot in your ZODB cache, your ZEO server or RelStorage server will need to serve it, etc
p2407
aVuses setattr because it is generally generated only once for a given object, usually at a time it is being created already
p2408
aVIt is also a piece of data that is accessed often and quite small
p2409
aVSo, by putting it directly on the object itself it'll be loaded as soon as you load that object, no extra trips to the ZODB required, and it'll only be changed once in it's lifetime
p2410
aVNote: the above presumes that the annotations are stored with the AttributeAnnotations adapter, which is the most common method and the default for Plone content
p2411
as(dp2412
g16
V100297
p2413
stp2414
a((dp2415
g2
(lp2416
VAs the traceback indicates, this is a problem with your SMTP server, not Plone
p2417
aVIt is most likely refusing the sender
p2418
aVThe last few steps show that Python's  module managed to connect successfully to your server, as the  call only is executed if the server has already accepted the credentials
p2419
aVThe fact that  then tries to send a  means something did go wrong with the  command; generally this means that the sender was refused
p2420
aVYour SMTP server then rudely closed the connection, not bothering to wait for a
p2421
aVYou'll need to look into your SMTP server configuration to see what would make it accept your sender
p2422
as(dp2423
g16
V100297
p2424
stp2425
a((dp2426
g2
(lp2427
VWe have used an external log analyser for a client project (a large private intranet)
p2428
aVArchitecture:
p2429
aVA js library adds a 'web bug', an empty gif with additional query parameters, loaded from a dedicated nginx server
p2430
aVA log processor picks up the nginx logs, rotates them, and parses the lines into a database, counting access together with the additional metadata
p2431
aVThe entries in the db include the UID of the content, among other interesting angles
p2432
aVThe site has read-only access to the same database, to make stats queries
p2433
aVPage counts are then easy, just query the database for the right UID
p2434
aVRanked lists are not much harder; query the statistics, then use the UIDs to attach catalog data to the result set
p2435
aVThe biggest problem we face now is a lack of data warehousing know-how (turning individual access rows in the database into efficient aggregates), and we are looking into retooling this setup to use Piwik as the statistics engine instead
p2436
aVWe cannot use Google Analytics in this particular case, but if you do not have such a restriction, I'd certainly would advise you to look into collective
p2437
aVgoogleanalytics and see if you can make it fit your use case
p2438
as(dp2439
g16
V100297
p2440
stp2441
a((dp2442
g2
(lp2443
VYou need to look at the  module for details; the sharing tab in Plone is a friendly wrapper around that API
p2444
aVTo add roles for a given userid, call :
p2445
aVThe other two important methods are  (replace the current set of roles completely) and  (delete all roles)
p2446
aVcould be handy too, to see what local roles are already defined
p2447
aVYou want to reindex security information after such changes:
p2448
as(dp2449
g16
V100297
p2450
stp2451
a((dp2452
g2
(lp2453
VThe base directory for buildout is always the directory that the starting configuration file is found in, so in your case that's in
p2454
aVThere are two work-arounds for this, one easy, one harder
p2455
aVThe first is to just place a bare  file in the root, and have it include the file in :
p2456
aVAlternatively, you can set the  options in your  file for each of the , ,  and  directories:
p2457
aVThat'll set the these directories to the parent of your  directory; e
p2458
ag1298
aVthe same directory your bootstrap file is in
p2459
aVHowever, any recipe that still refers to  will still use the  directory insead of your project root dir
p2460
aVYou cannot set that option to a relative path, you must either let buildout set it for you or specify a full path:
p2461
aVIn my opinion, you are best off using the first option, it makes running the bootstrap script easier anyway as it by default looks for a  file in the current directory
p2462
as(dp2463
g16
V100297
p2464
stp2465
a((dp2466
g2
(lp2467
VMost likely, your site has been compromised by an automated script exploiting CVE-2011-2528
p2468
aVThe script adds accounts, changes passwords of existing accounts, and customizes your  macro
p2469
aVIn order to clean this up, you need to:
p2470
aVInstall the Plone Hotfix
p2471
aVReset your session secrets to prevent reuse of old session cookies the attacker may still have
p2472
aVAudit the accounts present, removing any you do not know, especially if they Administrator access
p2473
aVClean up your  macro
p2474
aVIf you never customized it through the web, simply delete it from your  folder (go to the ZMI, select , select , and delete), otherwise edit it and remove the hidden links at the bottom
p2475
as(dp2476
g16
V100297
p2477
stp2478
a((dp2479
g2
(lp2480
VMake sure you include  in your eggs list
p2481
aVEither add it to the  section:
p2482
aVor to the  section:
p2483
as(dp2484
g16
V100297
p2485
stp2486
a((dp2487
g2
(lp2488
VFirebug shows all resource responses, including those taken from the browser cache
p2489
aVThe way to differentiate between the two is the colour of the entry; black means it required network access (e
p2490
ag1298
aVthe browser asked the server), gray is a cached response
p2491
aVIn other words, just because you see resources listed in Firebug, does not mean Firefox actually asked the server
p2492
aVThe  and  otherwise look correct, your browser should be caching these results
p2493
as(dp2494
g16
V100297
p2495
stp2496
a((dp2497
g2
(lp2498
VYou will need to return a vocabulary object, not a list:
p2499
aVThe  class implements the correct methods for this case
p2500
as(dp2501
g16
V100297
p2502
stp2503
a((dp2504
g2
(lp2505
VThe method you are looking for is  on the folder
p2506
aVIf you have the right to set the default page through the web with your user, you have the same right via XML-RPC, access control is method agnostic
p2507
aVtakes the id of the page object as an argument
p2508
aVis part of the  interface, take a look at that for more details
p2509
as(dp2510
g16
V100297
p2511
stp2512
a((dp2513
g2
(lp2514
VYou need to pin the version in a versions section:
p2515
as(dp2516
g16
V100297
p2517
stp2518
a((dp2519
g2
(lp2520
VUnless explicitely configured to do so, plone
p2521
aVapp
p2522
aVcaching will not overwrite cache control headers for arbitrary views
p2523
aVIn other words, unless you create a cache rule for the  view to tell plone
p2524
aVapp
p2525
aVcaching to do otherwise, the Cache-Control header set by that view will be left untouched
p2526
as(dp2527
g16
V100297
p2528
stp2529
a((dp2530
g2
(lp2531
VWhat you are experiencing is called Acquisition; attributes inherited from an object's containment rather than from it's class hierarchy
p2532
aVYou do not need to worry that this removes the security containment from your sites
p2533
aVUsers defined in either site1 or site2 do not gain additional permissions to access the acquired site, and only anonymous (public) information and methods can be accessed this way
p2534
aVIf you access either site with a user defined at the top level (so the root Zope object containing the two sites), then you can access protected information on either site, acquired or not
p2535
aVThe only risk at cross-talk, is if your sites rely on being able to access a skin method or object with the same id as the other site object, and that skin method or object is gone (deleted, for example)
p2536
aVYour code could then end up accessing the acquired site object instead, with unpredictable results as the acquired site is obviously not the same thing as your code would expect
p2537
aVFor skin methods and such, security would not permit you from doing any harm
p2538
aVBrowser views and other python-level code, could of course end up doing harm, but this should be quite a rare combination of circumstances
p2539
aVIf your sites do not have ids likely to clash with your site contents there is no need to be concerned about this
p2540
as(dp2541
g16
V100297
p2542
stp2543
a((dp2544
g2
(lp2545
VFile fields do not support a  method; instead, through acquisition you inherit the method from the object itself, hence the results you see
p2546
aVMoreover, calling  will return the actual downloadable contents of the field, not the field itself which could provide such information
p2547
aVInstead, you should use the  script appended to the object URL, followed by the field id:
p2548
aVYou can also re-use the Archetypes widget for the field, by passing the field name to the  method:
p2549
aVThis will display the file size, icon (if available), the filename and the file mime type
p2550
aVIn both these examples, I assumed the name of the field is 'first_field'
p2551
as(dp2552
g16
V100297
p2553
stp2554
a((dp2555
g2
(lp2556
VThere is no easy one-on-one way to determine this
p2557
aVIn Plone 4, there are basically three different ways that an index in the catalog can obtain the information from your content type
p2558
aVIndex configuration
p2559
aVFirst and foremost, indexes can optionally be configured with the name(s) of the attributes or methods to index on a given object
p2560
aVIndexes generally have a  method that'll tell you what items they'll index
p2561
aVUsually this is the same as the index id, but this is not a given
p2562
aVGenerally, if your field accessor is listed in the result of  then that index will be indexing that field for a given type:
p2563
aVIn the above examples, I assumed you already have a hold of your field object in the variable , with an actual instance of your type in the variable
p2564
aVCustom indexing adapters
p2565
aVWhen an object is indexed, the catalog also constructs a wrapper around the object and will look up indexing adapters for your object
p2566
aVThese adapters are registered both for the indexed name (so the name listed in ) and an interface or class
p2567
aVIf your content class implements that interface or has an indexing adapter directly registered for it's class or a base class, the indexing adapter can be brought into play
p2568
aVIndexing adapters are arbitrary snippets of code, and thus could call any field on your content object to produce their results
p2569
aVThere is no programmatic way for you to determine if a given field on your content type will be used, or if any fields will be used at all
p2570
aVThe  module lists several examples of indexing adapters, these are all registered for , meaning all objects:
p2571
aVcollects security information about your object
p2572
aVdetermines the position of the current object in it's container
p2573
aVThus, this indexer does not need any information from the object itself to determine it's value
p2574
aVtakes your content  value and generates a value suitable for sorting catalog search results with
p2575
aVIt normalizes the value, lowercases it, and prefixes numbers with leading zeros to make sorting on numbered titles easier
p2576
aVDirect method access
p2577
aVFields are basically generated methods on your content object
p2578
aVBut your content class can also implement methods on it's class
p2579
aVThe same remarks as for custom indexing adapters apply here; these are arbitrary Python code so they could be using your content type fields, aggregating and mangling the information before passing it to the index
p2580
aVThe Archetypes  class (used in all Archetypes content types) defines the  method for example
p2581
aVThis method takes all available fields with the  property set to True, tries to get each field value as plain text, and aggregates the results for the  index
p2582
aVConclusion
p2583
aVYou can only make educated guesses about index contents as they relate to your fields
p2584
aVBy introspecting index configuration, you won't see if there might be a custom indexer adapter masking your field (register a  index adapter and it'll be used instead of directly calling )
p2585
aVCustom indexers and class methods can still access your fields and pass on the information to a catalog index
p2586
as(dp2587
g16
V100297
p2588
stp2589
a((dp2590
g2
(lp2591
VYou can't
p2592
aVDue to Zope's security model, the user is determined after traversal, because this information depends on the context of the published object
p2593
aVYou can only rely on  when the object is being published; after traversal, authentication and authorization take place, and then publication, which in views means invoking the  method
p2594
aVBecause  is called as part of the traversal stage, you cannot know the authenticated user in that method either
p2595
aVYou'll have to re-think your view to not rely on the authenticated user being known during that stage
p2596
as(dp2597
g16
V100297
p2598
stp2599
a((dp2600
g2
(lp2601
VCheck  (from the ZMI) if base
p2602
aVcss is enabled
p2603
aVAlso note that in development mode, all the CSS files are served separately, but in production mode, CSS files are merged and compressed
p2604
aVThe URLs for the merged resources are based on the first CSS file included in the bundle, so a URL ending in  could still also include base
p2605
aVcss
p2606
aVYou can see if resources are merged in the  tool (checkbox at the top of the page)
p2607
as(dp2608
g16
V100297
p2609
stp2610
a((dp2611
g2
(lp2612
VYou are not overriding the original JavaScript file, only adding a new one
p2613
aVYou can do two different things here:
p2614
aVRemove the original table_sorter
p2615
aVjs from portal_javascript:
p2616
aVBecause the original table_sorter
p2617
aVjs file is server through a skin layer, you can put a new file with the same name in your own skin layer to override the original
p2618
as(dp2619
g16
V100297
p2620
stp2621
a((dp2622
g2
(lp2623
VI am not yet aware of any switch to get it to do this
p2624
aVInstead, I've manually debugged the process from the python debugger, which not something I can recommend you do unless you enjoy exploring the deep, dark, twisted passages of easy_install, all alike
p2625
as(dp2626
g16
V100297
p2627
stp2628
a((dp2629
g2
(lp2630
VIn Plone 4, the cookie function is handled by plone
p2631
aVsession
p2632
aVIt uses a tk-auth compatible cookie, meaning you can generate these cookies if you have the shared secret
p2633
aVThe package page contains a lot of information on how to use this for a SSO setup
p2634
as(dp2635
g16
V100297
p2636
stp2637
a((dp2638
g2
(lp2639
VYou could check the owner of the folder:
p2640
as(dp2641
g16
V100297
p2642
stp2643
a((dp2644
g2
(lp2645
VDid you register your type with the factory tool
p2646
aVAdd a  file to your GenericSetup profile with the following contents to make sure:
p2647
aVOtherwise, what happens is that an empty copy is created with a generated id, and you edit that in place
p2648
aVThe factory tool creates this type within it's managed boundaries and will only move it into place when you save the first time, thus ensuring no copy is already there when you hit
p2649
as(dp2650
g16
V100297
p2651
stp2652
a((dp2653
g2
(lp2654
VThe error message you posted is an archaic one from the deep depths of Zope, but it is clear in your case
p2655
aVYou are trying to copy something into a place that doesn't support copying
p2656
aVMost skin layer folders in the ZMI reflect a filesystem directory on your disk
p2657
aVThey are not showing you ZODB persisted objects, so you cannot add or remove items there through the ZMI
p2658
aVIf you want to copy a skin item for customization, use the 'customize' button at the bottom of their view to create a persistent copy in the ZODB, usually in the special  folder, which you can then alter
p2659
aVOr you can find the file on the filesystem and make a copy there (into your own skins layer folder, for example)
p2660
as(dp2661
g16
V100297
p2662
stp2663
a((dp2664
g2
(lp2665
VAre you interpolating catalog search results
p2666
aVThose are, by necessity (the catalog cannot handle unicode) UTF-8 encoded
p2667
aVJust use the  method on strings to turn them into unicode again:
p2668
as(dp2669
g16
V100297
p2670
stp2671
a((dp2672
g2
(lp2673
VArchetypes use the  method to create the id on creation
p2674
aVYou can override this on your own types
p2675
aVHere is the default implementation so you can see how it is supposed to work:
p2676
aVAs you can see, the default implementation defers to the  adapter (if a request is available) and the  utility if not; you could also provide your own implementations of those; see the  package on GitHub for more detail on how these work
p2677
aVYou cannot distinguish on type or location with those though
p2678
aVDexterity content uses the  interface instead, for which the  package provides an implementation that uses the same  infrastructure
p2679
as(dp2680
g16
V100297
p2681
stp2682
a((dp2683
g2
(lp2684
VYou can open the ZODB with python and inspect the data, yes
p2685
aVTo do so while you also run the web site, you'll need to use a concurrency layer like ZEO or RelStorage; plain FileStorage does not support concurrent access otherwise
p2686
as(dp2687
g16
V100297
p2688
stp2689
a((dp2690
g2
(lp2691
VThe catalog returns items in internal order unless you explicitly request an order
p2692
aVYou can do so with the  parameter, which should be the name of an index to use for the sorting
p2693
aVMost indexes can be used for sorting, with the notable exception being full text indexes (which is why there is a  index in the Plone catalog)
p2694
aVYou probably want to sort on the  index, which holds the index of each object in it's container:
p2695
as(dp2696
g16
V100297
p2697
stp2698
a((dp2699
g2
(lp2700
VSimply store them in a BTree (part of the ZODB package) and you should be fine; the BTree structures are highly efficient for sequential and random access
p2701
as(dp2702
g16
V100297
p2703
stp2704
a((dp2705
g2
(lp2706
VTo build acquisition chains, you need to use the  method of the Acquisition wrapper:
p2707
aVSee the Acquisition chapter of the Zope2 documentation for more information
p2708
as(dp2709
g16
V100297
p2710
stp2711
a((dp2712
g2
(lp2713
VProvided your elements inside the list are themselves inheriting from , they will be loaded on demand
p2714
aVPrimitive types and classes that do not inherit from , however, are loaded into memory together with the PersistentList instance
p2715
aVPersistentList is basically a subclass of  (and ) that sets  when altered, so that changes to the list are translated into a ZODB commit for it's record
p2716
as(dp2717
g16
V100297
p2718
stp2719
a((dp2720
g2
(lp2721
VYou'll have to use a python expression here, as the  pipe operator only kicks in on  or , but in your case "y_width" will be :
p2722
as(dp2723
g16
V100297
p2724
stp2725
a((dp2726
g2
(lp2727
VYou can't
p2728
aVIn Zope, DateTime objects must have a month and day to work at all, and what would they be set to if you only supply a year
p2729
aVYou can, however, use a simple StringField with a dynamic vocabulary to let users pick a year from a drop-down list, then use a custom method on your content class to return a DateTime object for getItem_publication_date() where you take the year for the return value from that field
p2730
as(dp2731
g16
V100297
p2732
stp2733
a((dp2734
g2
(lp2735
VThe GS structure importer doesn't support this; it has no idea about the (Plone specific) Dynamic Layout support
p2736
aVYou'll have to write your own custom GS step to do this, I am afraid, or perhaps use something like plone
p2737
aVapp
p2738
aVtransmogrifier (it includes support for browser defaults and collective
p2739
aVtransmogrifier includes a GS step) to configure this
p2740
as(dp2741
g16
V100297
p2742
stp2743
a((dp2744
g2
(lp2745
VYou could define a base, or abstract, interface for IUser:
p2746
aVBecause  is a subclass of , objects implementing the former also satisfy the latter interface
p2747
aVEdit: You can always still apply sdupton's dynamic after-the-fact alteration of the IGroup interface after you defined IUser:
p2748
aVI'd still use the  interface pattern to facilitate better code documentation
p2749
as(dp2750
g16
V100297
p2751
stp2752
a((dp2753
g2
(lp2754
VThe  package alreade declares the  egg as a  dependency, but doesn't give  time to install it
p2755
aVSimply listing them in  but still attempting to import them at module scope (as  does) is not enough
p2756
aVThe  module would have to be restructured to not import the  dependency until the  line has been parsed and the dependencies listed there have been made available
p2757
aVBasically, it needs to define it's own  class that, when instantiated, imports the  dependency and wraps that class at that time, and not before
p2758
aVIt may be that you could create a custom buildout recipe that uses  as a dependency that then can install the  dependency with  installed by buildout as it executes your recipe, but that is a plaster on this wound that  should deal with, really
p2759
as(dp2760
g16
V100297
p2761
stp2762
a((dp2763
g2
(lp2764
VYou are not saving the file on the filesystem, but in the Zope object database
p2765
aVYou'd have to use python code (not a python script) to open a filepath with the  built-in function to save the data to
p2766
as(dp2767
g16
V100297
p2768
stp2769
a((dp2770
g2
(lp2771
VA  is simply a implementation of the python  type (via the standard library  base class) adjusted for the Persistence semantics of the ZODB; it saves from having to set the  flag on the nearest class that inherits from  every time you alter the
p2772
aVA  is a much richer type, implementing events, integration with the Zope web interface (ZMI), through-the-web arbitrary properties (attributes with type validation), management of Zope permissions, validation of sub-item ids, import/export, etc
p2773
aVSub-items folders are stored as attributes on the object itself, with some metadata stored in a private dict on the instance
p2774
aVUse a  when you need any of those extra services (delegation of permissions, id validation, etc), use a  otherwise
p2775
aVPerformance wise looking up or storing items is not going to differ much; one is a straight python  underneath, the other is the instance  storing the items
p2776
aVIf you are looking for conflict avoidance, you should look into BTrees, the  class is basically a persistent mapping where values are stored in persistent buckets, avoiding collisions in most cases, and providing conflict resolution for the rest
p2777
aVIf you want  semantics with  storage semantics, look at Products
p2778
aVBTreeFolder2, and add-on that implements the  interfaces but stores sub-objects in a  instead of as attributes directly on the instances
p2779
as(dp2780
g16
V100297
p2781
stp2782
a((dp2783
g2
(lp2784
VSupport for string exceptions was removed from Python 2
p2785
aV6; you'll need to use a proper exception class for  instead
p2786
aVYou'll need to mark that exception as importable by restricted code before you can then import it into your Controller Script
p2787
aVHere is an example definition for such an exception:
p2788
aVWith the  information in place you can now import this exception into your script:
p2789
aVand catch that instead in your  block; the code that throws this exception will need to be updated too, of course
p2790
as(dp2791
g16
V100297
p2792
stp2793
a((dp2794
g2
(lp2795
VYou can create an alias for backward compatibility, by fudzing with
p2796
aVDo this in your package :
p2797
aVThis way the persistence machinery can find your classes still
p2798
aVWhat happens is that when your Archetypes instances are persisted in the ZODB, the persistence machinery stores a module path for the class (a dotted python path such as ) in the stored data
p2799
aVWhen restoring an object from the ZODB, that same path is then used to re-create your instances
p2800
aVWhen you rename your package, all these references are broken
p2801
aVWith the above trick, the nice thing is that if your object were changed and written to the ZODB again in a transaction, the new module path will be stored
p2802
aVYou could thus conceivable cause a write to all your Archetypes instances from this package to make the migration permanent so you can remove the above work-around again
p2803
as(dp2804
g16
V100297
p2805
stp2806
a((dp2807
g2
(lp2808
VZope supports type conversion out-of-the-box, including list conversion:
p2809
aVIf a user were to check one or two of the above items, the resulting  entry in the request will be a list, regardless of the number of items in the list:
p2810
aVIn the above example, I used the postfix  to accomplish this
p2811
aVSee the Argument Conversion section of the Object Publishing chapter of the Zope dev book for further details
p2812
as(dp2813
g16
V100297
p2814
stp2815
a((dp2816
g2
(lp2817
VJust replace  with a reference to your Collection:
p2818
aVThere is nothing magical about the queryCatalog method, but you do need to call it on the Collection instance itself, not on an arbitrary context
p2819
aV:-)
p2820
as(dp2821
g16
V100297
p2822
stp2823
a((dp2824
g2
(lp2825
VThere may be an easier way to approach this
p2826
aVPlone workflows can be stacked; e
p2827
ag1298
aVyou can assign more than one workflow to a content type
p2828
aVThis means you can assign both a nurse and a doctor workflow, each handing out specific permissions
p2829
aVIf you set up your roles correctly per workflow, your use-case should be easy to implement; just split Roles into those for nurses and doctors
p2830
aVSo, where a default workflow uses Reviewer, Editor, Contributor, Member, etc, use DoctorReviewer, NurseReviewer, DoctorEditor, NurseEditor, etc
p2831
aVThat way the two workflows will handle two sets of parallel permissions, transitions and states
p2832
aVI do not know enough about your use-cases if this will solve your problems at all, but I just wanted to make sure you knew about the option before exploring complex custom plugins
p2833
as(dp2834
g16
V100297
p2835
stp2836
a((dp2837
g2
(lp2838
VWhat version of mr
p2839
aVdeveloper are you using
p2840
aVVersion 1
p2841
aV20, released 3 weeks ago (late February 2012) includes a refactoring of the thread-lock handling
p2842
aVFrom the original pull request that lead to the refactor:
p2843
aVlately, I noticed a very strange behavior in which, when using mr
p2844
aVdeveloper, the buildout would sometimes hang on forever and never complete, right when it was checking out packages
p2845
aVThat sounds like exactly the kind of problems you are seeing
p2846
aVEdit: Version 1
p2847
aV21 is now out and adds thread-control to the configuration
p2848
aVYou can now create a  file that sets the number of threads to 1 to avoid this problem altogether:
p2849
aVThe default is 5
p2850
as(dp2851
g16
V100297
p2852
stp2853
a((dp2854
g2
(lp2855
VThe TALES Provider Expression subclasses String Expression, so you should be able to do this:
p2856
aVNote the string expression is superfluous, I moved and simplified the  variable interpolation; for more complex string interpolations, use the  syntax (e
p2857
ag1298
aV)
p2858
as(dp2859
g16
V100297
p2860
stp2861
a((dp2862
g2
(lp2863
VApart from the fact that this is a bad idea (all your URLs break every time you edit a title), I'd do this with a custom event
p2864
aVYou'll have to copy some of the functionality built into Archetypes used when renaming objects on create, because you don't want to rename every time you edit:
p2865
as(dp2866
g16
V100297
p2867
stp2868
a((dp2869
g2
(lp2870
VYup, it's possible
p2871
aVThe filename is just the package name plus the original template file name, just like other z3c
p2872
aVjbot files
p2873
aVFor example, the  template in  becomes  to override the original
p2874
as(dp2875
g16
V100297
p2876
stp2877
a((dp2878
g2
(lp2879
VThe ZODB provides connections with a consistent view from the moment a transaction begins
p2880
aVThat means most of all that a thread will not see changes in the database made by other threads until a new transaction begins
p2881
aVThis is fundamental feature of databases called Multiversion Concurrency Control
p2882
aVIn other words, if you want your application threads to not conflict by using locking, you also need to start a new transaction when the lock becomes available
p2883
aVIn my opinion, locking is a performance bottleneck that you want to avoid
p2884
aVThe longer you hold the lock, the larger the chance you run into inconsistent data (your starting state vs
p2885
aVthe database state)
p2886
aVIn Zope, an optimistic approach is used instead: when a conflict error is raised, the transaction is aborted, and retried anew, from the start, instead
p2887
aVIf your transactions are short, fast affairs, you avoid most locking problems, and instead you just recompute your changes to the database whenever the persistent change has changed to cause a conflict
p2888
as(dp2889
g16
V100297
p2890
stp2891
a((dp2892
g2
(lp2893
VAs documented in the python reference, the  statement takes up to 3 expressions to create the exception being raised:
p2894
aVraise_stmt ::=  "raise" [expression ["," expression ["," expression]]]
p2895
aVIn python 2, if the first expression is a tuple, python will 'unwrap' the tuple recursively, taking the first element until it finds something other than a tuple
p2896
aVThis behavior is being removed from Python 3 (see PEP 3109
p2897
aVThe following is legal:
p2898
aVThe documentation explains the rest in more detail, but the raise statement expects the first value to be a Exception class, the second value is seen as the value of the exception (the message) and the third value is a traceback
p2899
aVPython fills in  for the latter two values if missing
p2900
aVIf the first value is a instance instead, the second value must be None:
p2901
aVIf you use a tuple of more than 3 items, it'll raise a syntax error:
p2902
aVIn your case however, you raised neither a class nor an instance, so that's what Python found to be incorrect first; if I use a string it'll complain too:
p2903
aVThe correct syntax is of course:
p2904
as(dp2905
g16
V100297
p2906
stp2907
a((dp2908
g2
(lp2909
VYou need to install it at the python site-packages level; easy_install (used under the hood by buildout) needs it available before it'll install anything else
p2910
aVThat said, the  stanza should have installed it just fine; check by running the following test:
p2911
aVThat should print the installation path of the module, like it did for me in the above example
p2912
aVYou could try to use pip or easy_install for automatic download:
p2913
aVor
p2914
aVYou can do that in a virtualenv if you want to isolate the installation
p2915
aVBecause this is basically a dependency for svn 1
p2916
aV7, installing this at the same level as the svn binary (usually system wide) is certainly acceptable and the norm
p2917
aVNote that the  error message will not disappear, but your buildout will otherwise succeed
p2918
aVThe message is printed no matter what as easy_install first tries the internal  parser before deferring to the external plugin
p2919
aVIf you really, really want to verify if the plugin is installed, run the following python code:
p2920
aVOn my system this prints:
p2921
as(dp2922
g16
V100297
p2923
stp2924
a((dp2925
g2
(lp2926
VYou can use any ordered dict implementation out-of-the-box in the ZODB, but you'll have to mark the parent object (the object that refers to the ordered dict instance) as changed by using either  every time you change it or by setting  to
p2927
aVThis will, of course, result in a new persistent record for the parent together with the ordered dict instance
p2928
aVIf you want the ordered dict instance itself to detect changes automatically, you'll probably have to build your own class as I am not aware of any current implementations
p2929
aVThat said, it is probably exceedingly easy to do so, especially if you use the ZODB  class as a template on how to build a ordered version of the same
p2930
aVYou can't use that class as a mixin, unfortunately, as it refers directly to UserDict methods instead of using  calls ( is not a new-style class)
p2931
aVPython 2
p2932
aV7 has a ordered dict class in the standard library
p2933
aVPresumably you are still using Python 2
p2934
aV6 in Plone, so you'd have to backport it
p2935
aVOnce you've got it backported however, a  implementation should be a straight copy from the  source code, with all instances of  replaced with your OrderedDict port
p2936
as(dp2937
g16
V100297
p2938
stp2939
a((dp2940
g2
(lp2941
VMark Ransom's answer isn't quite correct as it'll not encode codepoints over U+7fff correctly, nor will it escape characters below 0x20 as recommended by the RTF standard
p2942
aVI've created a simple module that encodes python unicode to RTF control codes called , and wrote about the subject on my blog
p2943
aVIn summary, my method uses a regular expression to map the right codepoints to RTF control codes suitable for inclusion in either PyRTF or pyrtf-ng
p2944
as(dp2945
g16
V100297
p2946
stp2947
a((dp2948
g2
(lp2949
VThat information is not available; you'd have to customize the registration process to add that data
p2950
aVYour other option is to implement members as content (using ) at which point the usual Plone content fields for  and  will work
p2951
as(dp2952
g16
V100297
p2953
stp2954
a((dp2955
g2
(lp2956
VFirst of all, file a bug report; the upstream developers would probably like to know about this
p2957
aVUse z3c
p2958
aVjbot to override the template in your own package
p2959
aVCreate a  subdirectory, register it and put a file named  in that subdirectory
p2960
aVThat file will be used to replace the original template
p2961
aVRegistration of the directory with  is simple, read the instructions on the PyPI page
p2962
as(dp2963
g16
V100297
p2964
stp2965
a((dp2966
g2
(lp2967
VApart from "don't do that, you are painting yourself into a corner", you could also postpone the import of B until you need it
p2968
aVFile :
p2969
aVClass  won't be imported until you instantiate class , by which time the module already has been imported fully by module
p2970
aVYou can also use a common base class and test for that
p2971
as(dp2972
g16
V100297
p2973
stp2974
a((dp2975
g2
(lp2976
VYou add the packages to your buildout
p2977
aVcfg
p2978
aVPresumably there is a  entry in that file, either at the global level (in the  section) or at the individual recipe level
p2979
aVAdding extra lines is easy, it should end up looking something like this:
p2980
aVThe egg names are white-space separated, new lines that are indented count as part of the initial line that is not (standard  format)
p2981
aVTo differentiate between production and development configurations, simply create separate buildout configurations; I always use a  and a  (and , individual cluster machine
p2982
aVcfgs, etc)
p2983
aVBuildout configurations can include and override other configurations, so your  could simply include  and add eggs and/or alter settings
p2984
aVSee the buildout website for more information
p2985
aVIf you want a complex example, look at the Jarn Plone bootstrap buildout; it uses separate  and  setups
p2986
as(dp2987
g16
V100297
p2988
stp2989
a((dp2990
g2
(lp2991
VYou can specify the executable to be used by many recipes, including :
p2992
aVThat should install the  scripts with python 3
p2993
ag35
aVThe key here is the  key, which points to a section that should have a  option, which is a path to the python executable you want to use
p2994
aVThe executable key is then used by the  module internal to  to run the  script and install the egg
p2995
as(dp2996
g16
V100297
p2997
stp2998
a((dp2999
g2
(lp3000
VYou would have to query for both formats; once the UID field has been assigned it should not be changed, really
p3001
aVYour options are thus:
p3002
aVCreate a method that given a UID returns a tuple with both dashed and non-dashed versions, then use to query the catalog:
p3003
aVWith that method in place the query simply becomes:
p3004
aVMake your database use dashed versions where the Plone UID has dashes, non-dashed versions where older Plone content still has a UID without dashes
p3005
aVIn other words, treat the UID as a opaque string
p3006
aVThe UIDs in Plone are not going to change in any case, so you won't have to search for the non-dashed version when a dashed version has been generated
p3007
aVOnce a UID has been assigned to an object, it never changes, and never will gain the dashes
p3008
aVNOT recommended Iterate through your ZODB and replace all UIDs without dashes with the dashed equivalent
p3009
aVThis most likely will break anything else linking by UID to those items
p3010
as(dp3011
g16
V100297
p3012
stp3013
a((dp3014
g2
(lp3015
VSounds like the  skin layer hasn't been properly registered
p3016
aVCheck your skin  layer configurations (in ZMI ->  -> properties)
p3017
aVDisclaimer: I have never used this add-on, I only looked over the BitBucket source repository
p3018
as(dp3019
g16
V100297
p3020
stp3021
a((dp3022
g2
(lp3023
VPutting the direct egg link in  works just fine, but you must remember to also pin the version of the egg
p3024
aVWhat happens is that the link you provide for the egg is taken into consideration as one option
p3025
aVIf buildout finds a newer version of the egg elsewhere, it'll ignore the directly linked version still
p3026
aVExample, no version pin:
p3027
aVWith a version pin:
p3028
as(dp3029
g16
V100297
p3030
stp3031
a((dp3032
g2
(lp3033
VUse Products
p3034
aVLinguaPlone; it is the defacto extension to use for multi-lingual sites
p3035
aVTo start with, you site will be configured with top-level, per-language root folders
p3036
aVAny visitor will be redirected to one of these folders (e
p3037
ag1298
aVhttp://example
p3038
aVcom/en/, http://example
p3039
aVcom/fr/, etc
p3040
aV, providing you with per-language metadata including title and description
p3041
as(dp3042
g16
V100297
p3043
stp3044
a((dp3045
g2
(lp3046
VI think your best bet is to switch the session implementation to using Beaker instead, via Products
p3047
aVBeakerSessionDataManager
p3048
aVIt is a drop-in replacement for the default Zope2 session manager, but performs much better under high load and certainly won't suffer from ConflictErrors
p3049
as(dp3050
g16
V100297
p3051
stp3052
a((dp3053
g2
(lp3054
VNot sure you can do this with a content rule; there is no code running at that exact time
p3055
aVYou'd need to run an external cron job to trigger a scan for expired events
p3056
aVWhy not just use a collection to list expired events in the other location
p3057
as(dp3058
g16
V100297
p3059
stp3060
a((dp3061
g2
(lp3062
VAs of Zope 2
p3063
aV13, you can register scripts for the  entry point
p3064
aVThese will be treated as new commands on the  controller script
p3065
aVFor example, the following will tie callables in your egg to commands:
p3066
aVYour callable will be passed the root-level application object, and the remaining command line arguments:
p3067
aVUse the args to implement command-line switches for your script
p3068
aVSee the Configuring and Running Zope documentation; note that your command names cannot use dashes () in the name
p3069
as(dp3070
g16
V100297
p3071
stp3072
a((dp3073
g2
(lp3074
VThe GenericSetup install profile lists a dependency that's not available to GenericSetup
p3075
aVEither remove the dependency from your profile's metadata
p3076
aVxml or install  into your buildout
p3077
as(dp3078
g16
V100297
p3079
stp3080
a((dp3081
g2
(lp3082
VWhat part in your buildout actually uses the egg
p3083
aVNowhere is the tan
p3084
aVadapter egg actually included in a part, which is where dependencies would be pulled in
p3085
as(dp3086
g16
V100297
p3087
stp3088
a((dp3089
g2
(lp3090
VI, like Martin Aspelli, use the SublimeCodeIntel plugin; together with collective
p3091
aVrecipe
p3092
aVomelette this fills all my code-completion needs
p3093
aVMartin blogged about his setup, including a little script that sets up the CodeIntel configuration file for you:
p3094
aVhttp://www
p3095
aVmartinaspeli
p3096
aVnet/articles/sublime-text-2-for-zope-and-plone
p3097
as(dp3098
g16
V100297
p3099
stp3100
a((dp3101
g2
(lp3102
V applies actions based on the presence of the action name in the request; usually this is done by giving the submit button the name of the action
p3103
aVBy including that name in your GET request you thus invoke the action
p3104
aVNote that actions are prefixed by both the form identifier and the 'action' keyword, so the  action will generally be using the parameter name :
p3105
aV@@page
p3106
aVparam1=myparam1&param2;=myparam2&form
p3107
aVaction
p3108
aVsave;=Save
p3109
aVEasiest way to discover the exact name of your action parameters is to just look at the output generated for your form and look for the  names
p3110
as(dp3111
g16
V100297
p3112
stp3113
a((dp3114
g2
(lp3115
VYou can call the special KSS view  for loading portlets over AJAX
p3116
aVThe response is a XML document with a  element containing the new HTML snippet
p3117
aVYou can call this on the site root or on the current context, whatever works better for your cachability
p3118
aVThe following is taken from a production site, and is not entirely complete, but should give you an idea:
p3119
aVThe variable  refers to the  div:
p3120
aVNote that we use the portlet hash from the  attribute, which is how the KSS  view knows how to render just the portlet
p3121
aVI store the portlet base url on the wrapper in a data attribute in a certain to make sure I retrieve the portlets in the right context as it'd would display the wrong info otherwise
p3122
as(dp3123
g16
V100297
p3124
stp3125
a((dp3126
g2
(lp3127
VHave you tried Babel
p3128
aVIt supports a plugin system for extracting messages from various sources
p3129
aVlingua provides plugins for ZPT and zope
p3130
aVi18nmessageid, giving you all the functionality of i18ndude, but with a reasonably active Open Source community
p3131
aVTo use babel in your project, you'll need to configure your setup
p3132
aVpy to use babel commands, then run those functions as setup
p3133
aVpy commands; e
p3134
ag1298
aVProvided the  egg is available as a dependency, you can then it's plugins in the  structure in your setup
p3135
aVpy to tell Babel how to extract i18n messages from your source files:
p3136
aVNote that you cannot include Babel as a setup_requires dependency, as the setup
p3137
aVpy script only works if it can actually import babel
p3138
aVYou could try and work around this by creating shims for the cmdclass entries, but I haven't tried this myself yet
p3139
aVFor now, just install the Babel egg in your virtualenv or globally
p3140
aVIf you want to use the  CLI option instead of the  entry, that option expects an INI-style file format with  headers:
p3141
aVEach section can contain options to be passed to the extractor function (each  line becomes a key-value pair in the options dict passed to it), but I don't think the lingua_* methods take any options
p3142
aVThe extractor configurations are then used for every input dir you mention on the command line, or each package mentioned in the setup
p3143
aVpy  option
p3144
as(dp3145
g16
V100297
p3146
stp3147
a((dp3148
g2
(lp3149
VThis is entirely normal, if somewhat irritating
p3150
aVYour setup
p3151
aVpy file pulls these in with the  and  sections:
p3152
aVThe ZopeSkel paster recipes use these eggs to let you add snippets to your generated egg at a later date
p3153
aVRemove the above two entries and the eggs if you do not need this feature
p3154
as(dp3155
g16
V100297
p3156
stp3157
a((dp3158
g2
(lp3159
VBecause your source is a class, you need to instantiate it:
p3160
aVIn certain circumstances, such as with using sub forms or complex form widgets (widget within a widget for list selections, etc), you need to follow the  pointers to a proper outer context for getting back to the Plone context
p3161
as(dp3162
g16
V100297
p3163
stp3164
a((dp3165
g2
(lp3166
VI haven't tried this myself yet, but it should work just fine using , which is what Plone 4
p3167
aVx uses for all the pop-ups
p3168
aVIf you do not expect KSS to work, this should all work fine, including validation
p3169
aVThe overlay is loaded into a , not an
p3170
aVFor the overlay, you simply specify a formselector to pick out what part of the page is the edit form, and tell the tool what to do when you run out of forms (e
p3171
ag1298
aVthe edit was successful)
p3172
aVPresumably you'd want to reload the current page
p3173
aVSomething like this'd do the trick:
p3174
as(dp3175
g16
V100297
p3176
stp3177
a((dp3178
g2
(lp3179
VI never bother for such one-off JS resources
p3180
aVJust load your JS directly with the specific view
p3181
aVYou can always instruct the few users of that view to CTRL-Reload
p3182
aVCluttering up portal_javascript will only make the maintenance burden higher, as you need to make sure you do not break up the mergeability of the global JS resources
p3183
as(dp3184
g16
V100297
p3185
stp3186
a((dp3187
g2
(lp3188
VThere isn't such a short-cut; your first example is adapting a tuple (a general case that needs to be supported too)
p3189
aVThis has been discussed numerous times on the lists, but I cannot recall the ins and outs of the details
p3190
aVYou could start with the following thread if you have to know: http://tech
p3191
aVgroups
p3192
aVyahoo
p3193
aVcom/group/zope/message/185605
p3194
as(dp3195
g16
V100297
p3196
stp3197
a((dp3198
g2
(lp3199
VYou are trying to open the ZODB from multiple processes; presumably in development you only use one WSGI process
p3200
aVThis is basically a dupe of zc
p3201
aVlockfile
p3202
aVLockError in ZODB
p3203
aVYour options are:
p3204
aVLimit your production environment to only one process
p3205
aVUse ZEO, see the referenced question; the zodburi equivalent is
p3206
aVUse RelStorage
p3207
aVYou can use the ZConfig URI scheme to connect up, provided the RelStorage egg is available
p3208
aVThis is documented in the RelStorage documentation under the old  name
p3209
as(dp3210
g16
V100297
p3211
stp3212
a((dp3213
g2
(lp3214
VHide the viewlet altogether
p3215
aVAdd  to the URL to access the viewlet management view, locate the  entry and click the "Hide" link
p3216
aVAlternatively, you could include a  file in your policy product's GenericSetup profile with:
p3217
aVThat'll mark the viewlet as hidden for a given skin name
p3218
aVFor folder views, you'll have to customize these individually; the  template (the "Summary" display) for example, has a  section you would have to adjust (it only displays authors for News Items)
p3219
as(dp3220
g16
V100297
p3221
stp3222
a((dp3223
g2
(lp3224
VI am guessing you are running Plone behind Apache, ngnix, varnish or similar proxying web server
p3225
aVThe view just took longer to do it's work than the front-end time-out allowed, but the server will continue it's work in the background
p3226
aVTo prevent the 502 Bad Gateway error, access the server directly (port 8080, probably)
p3227
as(dp3228
g16
V100297
p3229
stp3230
a((dp3231
g2
(lp3232
VUse :
p3233
aVWorks for both dates and datetime objects
p3234
aVYour second example:
p3235
as(dp3236
g16
V100297
p3237
stp3238
a((dp3239
g2
(lp3240
VCall  on the Canvas:
p3241
aVThe rectangle is the clickable area, so you'd have to match that to the drawn rectangle
p3242
aVSee more examples in this blog post: http://www
p3243
aVhoboes
p3244
aVcom/Mimsy/hacks/adding-links-to-pdf/
p3245
as(dp3246
g16
V100297
p3247
stp3248
a((dp3249
g2
(lp3250
VThe  method takes a filename:
p3251
aVOnly if you do not specify the filename does it generate one for you in a temporary directory
p3252
aVThe mechanize  method is basically the same as ()[http://docs
p3253
aVpython
p3254
aVorg/library/urllib
p3255
aVhtml#urllib
p3256
aVurlretrieve] so you can see how to use  by reading the urllib documentation
p3257
aVEnjoy your newspaper
p3258
as(dp3259
g16
V100297
p3260
stp3261
a((dp3262
g2
(lp3263
VI suspect your view is raising an AttributeError or KeyError when rendered, which would also cause Plone to display a NotFound error
p3264
aVPut a debug breakpoint in your view  and / or  methods to see if your view is being looked up and called
p3265
aVThat, or your  is not being loaded at all; make sure your package is included somewhere, perhaps in the  variable in the  part of your buildout, or in a  statement in another configure
p3266
aVzcml file
p3267
as(dp3268
g16
V100297
p3269
stp3270
a((dp3271
g2
(lp3272
VInclude the db_array[k][0] value in your dict generator expression:
p3273
aVNote that I updated the default value to  (and used a variable for that to increase readability) if the key is not already present in either dict
p3274
aVNote that for the first item in the list we fall back to result_array if the key was not present in db_array; the key is always present in at least one of the two dicts, this way you do not end up with empty string values
p3275
aVIf the key were not in the  dict, then your original default would cause problems, as you use an int  to then index as an array:
p3276
aV(Updated to reflect your comment showing your original code)
p3277
as(dp3278
g16
V100297
p3279
stp3280
a((dp3281
g2
(lp3282
VYou are importing  which is importing , which is then asked to import , and  then tries to import , but it wasn't done importing yet
p3283
aVDon't do this, you are creating a circular dependency here
p3284
aVAlso see Circular import dependency in Python
p3285
as(dp3286
g16
V100297
p3287
stp3288
a((dp3289
g2
(lp3290
VYou've imported the  module with the  line, but you are not referencing the  function in that module
p3291
aVDo this instead:
p3292
aVor this:
p3293
as(dp3294
g16
V100297
p3295
stp3296
a((dp3297
g2
(lp3298
VAre you sure that supervisord is installed and running
p3299
aVIs there a socket file in present at
p3300
aVThe error indicates that , the control CLI, cannot reach the UNIX socket to communicate with , the daemon
p3301
aVYou could also check  and see if the values for the  and  sections match
p3302
aVNote that this is a Ubuntu-level problem, not a problem with Python, Django or nginx and as such this question probably belongs on ServerFault
p3303
as(dp3304
g16
V100297
p3305
stp3306
a((dp3307
g2
(lp3308
VHow would you like them to be serialized
p3309
aVJSON doesn't specify how to handle dates, so the python  library cannot make the decision on how to then represent these for you
p3310
aVThat completely depends on how the other side (browser, script, whatever) handles dates in JSON as well
p3311
as(dp3312
g16
V100297
p3313
stp3314
a((dp3315
g2
(lp3316
VUse the 'a' append mode instead:
p3317
aVIf you still see previous content overwritten, perhaps Windows needs you to explicitly seek to the end of the file; open as 'r+' or 'w' and seek to the end of the file:
p3318
as(dp3319
g16
V100297
p3320
stp3321
a((dp3322
g2
(lp3323
VSet  to  and create your set in  if still , to give each class it's own copy:
p3324
as(dp3325
g16
V100297
p3326
stp3327
a((dp3328
g2
(lp3329
VNot something I'd do, but you could use  to introspect the arguments your method takes:
p3330
aVThis can then be combined with  to rebuild your arguments:
p3331
aVHowever, you really only need such magic when doing advanced function decorators and the like
p3332
aVI think it's overkill here
p3333
as(dp3334
g16
V100297
p3335
stp3336
a((dp3337
g2
(lp3338
V does not test for members of a dictionary
p3339
aVUse the  operator instead, or the  method:
p3340
aVBut note that  has been deprecated, is recommended against by the PEP 8 style guide and has been removed altogether in Python 3
p3341
aVIncidentally, you'll run into problems by using a mutable class variable:
p3342
aVInitialize it in your  instead:
p3343
as(dp3344
g16
V100297
p3345
stp3346
a((dp3347
g2
(lp3348
VDecorators are simply callables that return a replacement, optionally the same function, a wrapper, or something completely different
p3349
aVAs such, you could create a conditional decorator:
p3350
aVNow you can use it like this:
p3351
as(dp3352
g16
V100297
p3353
stp3354
a((dp3355
g2
(lp3356
VBest practice is to have a  module, that includes all documented interfaces and corresponding exceptions, constants and events
p3357
aVThis way, you define the API of your package in one well-defined place, and someone looking up an interface can see that any exceptions being thrown are defined in the same location
p3358
aVHere are some example interface
p3359
aVpy files from various projects:
p3360
aVtransaction
p3361
aVplone
p3362
aVapp
p3363
aViterate
p3364
aVzope
p3365
aVcomponent
p3366
as(dp3367
g16
V100297
p3368
stp3369
a((dp3370
g2
(lp3371
VYou can just use the default session pattern; add the object, and then flush to save the object to the database
p3372
aVDo not commit the transaction, let Zope handle that:
p3373
aVYour object will be added to the database in the current transaction, and thus the primary key will be known
p3374
as(dp3375
g16
V100297
p3376
stp3377
a((dp3378
g2
(lp3379
VThe script in question isn't very smart and builds the POST body in memory
p3380
aVThus, to POST a 1GB file, you'll need 1GB of memory just to hold that data, plus the HTTP headers, boundaries, and python and the code itself
p3381
aVYou'd have to rework the script to use mmap instead, where you first construct the whole body in a temp file before handing that file wrapped in a  value to passing it to
p3382
aVSee Python: HTTP Post a large file with streaming for hints on how to achieve that
p3383
as(dp3384
g16
V100297
p3385
stp3386
a((dp3387
g2
(lp3388
VUse bitwise AND and the constants in the  module:
p3389
aVSo much more readable
p3390
as(dp3391
g16
V100297
p3392
stp3393
a((dp3394
g2
(lp3395
VYou'll need to create an application-level API to retrieve the database whenever someone calls that method
p3396
aVWhen using  to integrate SQLAlchemy with Zope, for example, the database is registered with the Zope Component Architecture as a utility, so whenever I need the session I use a getUtility lookup:
p3397
aVIn this case, the ZCA  is the application-specific API to look up the database connection, where sessions are bound to threads
p3398
as(dp3399
g16
V100297
p3400
stp3401
a((dp3402
g2
(lp3403
VI don't think it's anything to do with Bottle or jQuery
p3404
aVPerhaps an cloud email provider like GMail or HotMail that inserted these strings for internal tracking though, because the only other reference I can find in google is a reposted forum post with two such nodes in the body text, right after an email address:
p3405
aVhttp://baexpats
p3406
aVorg/expat-life/930-storage-awhile
p3407
aVhtml
p3408
as(dp3409
g16
V100297
p3410
stp3411
a((dp3412
g2
(lp3413
VKeep your ids in a list, then use the  index to map these back to the row ids, as long as you keep the ordering the same
p3414
aVIn your example,  is the second choice in your list, so if selected  returns
p3415
aVIf you have a  list in the same order,  will be :
p3416
aVSlightly more efficient than mapping names to rowids in a dictionary
p3417
as(dp3418
g16
V100297
p3419
stp3420
a((dp3421
g2
(lp3422
VYour  directory cannot be written to by the user your ZEO server runs as, or you previously ran ZEO as a different user and the  file it created is not writeable by the current user
p3423
aVFix this by adjusting the permissions on that directory, or if the  file exists, the lock file itself
p3424
as(dp3425
g16
V100297
p3426
stp3427
a((dp3428
g2
(lp3429
VYour real problem is that you were missing a parens at the end of your  call
p3430
aVYou can remove the parens on your  line; python does not use parens around if test suites
p3431
aVBetter not to use built-in type names for variables, so  is a bad name for a variable
p3432
aVAnd if you want to strip off characters at the start of a string, you can use indexing:
p3433
aVPresumably your code was not yet complete or you haven't discovered this yet due to the error, but your loop will never end as you are not incrementing
p3434
aVLast but not least: do not use ; it is a security hole waiting to happen
p3435
as(dp3436
g16
V100297
p3437
stp3438
a((dp3439
g2
(lp3440
VMy commiserations
p3441
aVYou'd be better off parsing your HTML with BeautifulSoup
p3442
aVAs the homepage states:
p3443
aVYou didn't write that awful page
p3444
aVYou're just trying to get some data
p3445
aVout of it
p3446
aVBeautiful Soup is here to help
p3447
aVSince 2004, it's been
p3448
aVsaving programmers hours or days of work on quick-turnaround screen
p3449
aVscraping projects
p3450
aVand more importantly:
p3451
aVBeautiful Soup parses anything you give it, and does the tree
p3452
aVtraversal stuff for you
p3453
aVYou can tell it "Find all the links", or
p3454
aV"Find all the links of class externalLink", or "Find all the links
p3455
aVwhose urls match "foo
p3456
aVcom", or "Find the table heading that's got bold
p3457
aVtext, then give me that text
p3458
as(dp3459
g16
V100297
p3460
stp3461
a((dp3462
g2
(lp3463
VYour function invokes something called , which python looks up in the enclosing scope
p3464
aVUntil the statement ,  is still bound to the unwrapped function, so that's what is getting called
p3465
as(dp3466
g16
V100297
p3467
stp3468
a((dp3469
g2
(lp3470
VHave you looked at psphere at all
p3471
aVIt's a python project to provide native bindings for the vSphere Web Services SDK
p3472
aVYou may be able to get your problems solved quicker with a dedicated library, rather than struggle with suds, SOAP and WDSL issues
p3473
aVIt actually uses suds under the hood, but provides you with a pythonic API instead
p3474
as(dp3475
g16
V100297
p3476
stp3477
a((dp3478
g2
(lp3479
VEscape codes in python need a backslash:
p3480
aVYou are sending two characters instead, a '/' and the letter 'r':
p3481
as(dp3482
g16
V100297
p3483
stp3484
a((dp3485
g2
(lp3486
VDon't use a MANIFEST
p3487
aVin but use  instead; with that package all files included in your git repository will also be part of the egg, and any files listed in  will not be
p3488
aVI have the package installed globally, in my python's site-packages, but it should be enough to list it in your  in the  structure:
p3489
as(dp3490
g16
V100297
p3491
stp3492
a((dp3493
g2
(lp3494
VPython 2
p3495
aV7 and Python 3, dict comprehension:
p3496
aVor unpack your structures:
p3497
aVPython 2
p3498
aV6 and before, generator expression:
p3499
aVor again unpack:
p3500
aVSince your data is already in the form of (key, value) sequences, you can just generate a dict in one go by passing the structure to the dict type without an explicit dict or generator expression:
p3501
as(dp3502
g16
V100297
p3503
stp3504
a((dp3505
g2
(lp3506
VOnce you read a complete file into memory, reading some more from that file will result in an empty string being returned:
p3507
aVIn other words, you have reached the end of the file
p3508
aVYou have three alternatives here:
p3509
aVRe-open the file for each complete read
p3510
aVUse  to go to the start of the file again:
p3511
aVStore the contents of the file in a variable, thus caching it in memory, then use that instead of re-reading the file
p3512
as(dp3513
g16
V100297
p3514
stp3515
a((dp3516
g2
(lp3517
VThe easiest way is to use effbot
p3518
aVorg's  module:
p3519
aVBy specifying  for the second (line) argument you are addressing the last line of the console
p3520
aVTo get this to work on UNIX terminals as well, you should take a look at the  library, which provides a partial  implementation that'll work on Windows
p3521
aVYou'd drive it the same as the stdlib  module; use the first on Windows, the latter on UNIX
p3522
as(dp3523
g16
V100297
p3524
stp3525
a((dp3526
g2
(lp3527
VYou generally do not want to do this
p3528
aVProvide proper dependencies in your  file instead, and let tools like ,  or  do the dependency work for you
p3529
aVPeople deploying the code need to be able to control where dependencies are installed, for example, to keep conflicting versions separate
p3530
as(dp3531
g16
V100297
p3532
stp3533
a((dp3534
g2
(lp3535
VYou could make the counter a list with one element, effectively making it a mutable:
p3536
aVI am not sure if that makes your code any more readable, as explicit is better than implicit
p3537
aVOr if use python 2
p3538
aV7 or newer (or use a convenient backport), you could use a  object:
p3539
aVNote that by using a  you have a dictionary that automatically gives you a default value of 0
p3540
aVIt otherwise acts like a dictionary holding integer values, so you can increment and decrement these values any way you like (including adding more than 1)
p3541
aVThe same effect can be had with , also in the collections module, but note that the  class offers functionality
p3542
aVis present in python 2
p3543
aV5 and up; example:
p3544
aVAlternatively, you could just dispense with the setdefault altogether, as you are always assigning back to the mapping anyway:
p3545
as(dp3546
g16
V100297
p3547
stp3548
a((dp3549
g2
(lp3550
VYes, it's a python thing; by default  opens files in text mode, where line endings are translated depending on what platform your code is running on
p3551
aVYou'll have to open the file in binary mode ('b') to prevent this
p3552
aVFrom the documentation on :
p3553
aVThe most commonly-used values of mode are 'r' for reading, 'w' for writing (truncating the file if it already exists), and 'a' for appending (which on some Unix systems means that all writes append to the end of the file regardless of the current seek position)
p3554
aVIf mode is omitted, it defaults to 'r'
p3555
aVThe default is to use text mode, which may convert '\u005cn' characters to a platform-specific representation on writing and back on reading
p3556
aVThus, when opening a binary file, you should append 'b' to the mode value to open the file in binary mode, which will improve portability
p3557
aV(Appending 'b' is useful even on systems that don\u2019t treat binary and text files differently, where it serves as documentation
p3558
as(dp3559
g16
V100297
p3560
stp3561
a((dp3562
g2
(lp3563
VUse ; the library can make an attempt at parsing your invalid XML and clean it up, by setting the  flag:
p3564
as(dp3565
g16
V100297
p3566
stp3567
a((dp3568
g2
(lp3569
VYour python string is being joined together without newlines, thus there is no space before the  keyword
p3570
aVBetter use triple-quoted strings when working with multi-line string literals:
p3571
aVTriple-quoted strings maintain newlines:
p3572
aVIf this is a one-of you do not necessarily need to use SQLAlchemy, but as your project grows you'll find that that library offers many advantages, including making conditional logic much easier (adding further WHERE clauses based on if/then branches, etc)
p3573
as(dp3574
g16
V100297
p3575
stp3576
a((dp3577
g2
(lp3578
VThe only thing the two implementations you point to do over normal s is to return a  when accessing a non-existing key
p3579
aVYou want to revert that again, thus leaving you again with the default  type:
p3580
aVIf you want to return None instead of a dict, then just use  instead:
p3581
aVNote that you cannot have it both ways; Python first must find the first key and resolve that to a  before it can look up the second key:
p3582
as(dp3583
g16
V100297
p3584
stp3585
a((dp3586
g2
(lp3587
VYou cannot prevent Python from loading
p3588
aVpyc files if it finds them in it's path, no
p3589
aVYou have a few options:
p3590
aVImport the offending module and figure out what it's path is:
p3591
aVUse a script to walk your PYTHONPATH and delete stale bytecode files
p3592
aVThe linked script removes all  files for which there is no corresponding  file present
p3593
aVWipe all
p3594
aVpyc files in your PYTHONPATH, and have Python regenerate them with the  module:
p3595
aVthen remove that one file
p3596
aVDo note that the last two options could result in the removal of legitimate python modules
p3597
aVSome python modules (especially commercially licenced) are distributed as compiled bytecode only
p3598
as(dp3599
g16
V100297
p3600
stp3601
a((dp3602
g2
(lp3603
VYou could try Urwid instead
p3604
aVUrwid provides a higher-level toolkit on top of curses and includes an event loop to handle keyboard and mouse input
p3605
aVIt either uses it's own select-based event loop, or can hook into gevent or Twisted
p3606
aVIn addition to handling keyboard input efficiently you'll also have a host of options to handle user input with edit boxes, list controls and more
p3607
as(dp3608
g16
V100297
p3609
stp3610
a((dp3611
g2
(lp3612
VIf MySQL cannot handle UTF-8 codes of 4 bytes or more then you'll have to filter out all unicode characters over codepoint ; UTF-8 encodes codepoints below that threshold in 3 bytes or fewer
p3613
aVYou could use a regular expression for that:
p3614
aVAlternatively, you could use the  function with a mapping table that only contains  values:
p3615
aVHowever, creating the translation table will eat a lot of memory and take some time to generate; it is probably not worth your effort as the regular expression approach is more efficient
p3616
aVThis all presumes you are using a UCS-4 compiled python
p3617
aVIf your python was compiled with UCS-2 support then you can only use codepoints up to  in regular expressions and you'll never run into this problem in the first place
p3618
as(dp3619
g16
V100297
p3620
stp3621
a((dp3622
g2
(lp3623
VUse  instead:
p3624
aVOutput:
p3625
aVwith  defined as:
p3626
as(dp3627
g16
V100297
p3628
stp3629
a((dp3630
g2
(lp3631
VYou need to join the dirname and filename into one complete path:
p3632
as(dp3633
g16
V100297
p3634
stp3635
a((dp3636
g2
(lp3637
VYou are setting a non-existing header instead of the  header:
p3638
aVChange that to:
p3639
aVinstead
p3640
aVYour biggest problem however is that you are not uploading a multipart POST, but rather just the file itself as the POST body, while your server is expecting only a multipart upload
p3641
aVTake a look at this SO answer for a very simple way to generate a proper multipart POST body: http://stackoverflow
p3642
aVcom/a/681182/100297
p3643
aVNote that you'll have to adjust your Content-Type header accordingly
p3644
as(dp3645
g16
V100297
p3646
stp3647
a((dp3648
g2
(lp3649
VAs long as you use the same connection, the database should show you a consistent view on the data, e
p3650
ag1298
aVwith all changes made so far in this transaction
p3651
aVOnce you commit, the changes will be written to disk and be visible to other (new) transactions and connections
p3652
as(dp3653
g16
V100297
p3654
stp3655
a((dp3656
g2
(lp3657
VJust use a ; it'll take any amount of whitespace and split on that (ignoring leading and trailing whitespace altogether):
p3658
aVIf you need floats instead of strings, simply apply  to each value using :
p3659
as(dp3660
g16
V100297
p3661
stp3662
a((dp3663
g2
(lp3664
VThe  library follows the  closely
p3665
aVAll attributes returned by that API are available on the result objects; so for status messages you need to look at the  object description to see they have an  parameter:
p3666
aVStore the most recent  to poll for updates
p3667
as(dp3668
g16
V100297
p3669
stp3670
a((dp3671
g2
(lp3672
VYou are running this on a Windows machine, but if this from a shared Ubuntu drive then the cStringIO extension will not import; it'll be compiled for running on Linux, not Windows
p3673
as(dp3674
g16
V100297
p3675
stp3676
a((dp3677
g2
(lp3678
VIf you used a skin script, then yes, that is run as restricted python as well
p3679
aVIt is the filesystem-stored equivalent of the ZMI python script
p3680
aVBest practice is to use a browser view; it is simply a callable object that has a request and context associated to it:
p3681
aVRegister this in your configure
p3682
aVzcml:
p3683
aVafter which it'll be available as  for PloneFormGen
p3684
aVHowever, if this is the only thing you are creating a custom package for then by all means use an external method
p3685
as(dp3686
g16
V100297
p3687
stp3688
a((dp3689
g2
(lp3690
VI don't think there really is
p3691
aVfiles are cached bytecode files, and you save startup time as Python does not have to recompile your python files every time you start the interpreter
p3692
aVAt most, switching off bytecode compilation lets you measure how much time the interpreter spends on this step
p3693
aVIf you want to compare how much time is saved, remove all the  files in your project, and time Python by using the -B switch to the interpreter:
p3694
aVthen run again without the -B switch:
p3695
aVIt could be that the user under which you want to run your program does not have write access to the source code directories; for example a web server where you do not want remote users to have any chance of altering your source code through a vulnerability
p3696
aVIn such cases I'd use the included  module to bytecompile everything using a priviledged user rather than forgo writing  files
p3697
as(dp3698
g16
V100297
p3699
stp3700
a((dp3701
g2
(lp3702
V is just a preset on :
p3703
aVwhere BuiltinFilter is a simple customization subclass of Kernel that bypasses the constructor,  contains , , ,
p3704
aVIn other words,  in the equivalent of:
p3705
aVThe scale is set to the default (, the sum of the 25 weights), as is the offset
p3706
aVYou could try and use a smaller kernel instead:
p3707
aVor play with the scale and offset values
p3708
as(dp3709
g16
V100297
p3710
stp3711
a((dp3712
g2
(lp3713
VYou need to move the  declaration inside your function:
p3714
as(dp3715
g16
V100297
p3716
stp3717
a((dp3718
g2
(lp3719
VYou are not changing types, you are assigning a different value to a variable
p3720
aVYou are also hitting on one of the fundamental differences between python 2
p3721
aVx and 3
p3722
aVx; grossly simplified the 2
p3723
aVx type  has replaced the  type, which itself has been renamed to
p3724
aVIt happens to work in your code as more recent versions of Python 2 have added  as an alias for  to ease writing code that works under both versions
p3725
aVIn other words, your code is working as expected
p3726
as(dp3727
g16
V100297
p3728
stp3729
a((dp3730
g2
(lp3731
VClosures are only introduced if there are variables to be referenced outside of the global (module) scope:
p3732
aVOnly when the inner function refers to a variable in the surrounding scope are closures generated:
p3733
aVNote that you actually have to refer to a variable in the surrounding scope
p3734
aVSimply ignoring the scope gives you  again:
p3735
aVIn your first example,  is a module-scope variable, only in your second example do you introduce a new scope by wrapping the code in a new function
p3736
as(dp3737
g16
V100297
p3738
stp3739
a((dp3740
g2
(lp3741
VRemove the ;  already returns a list
p3742
aVYou are turning the first element of the fields into a list:
p3743
aVIf you want to have the first column as a list, you can build a list as you go:
p3744
aVThis can be simplified into a list comprehension:
p3745
as(dp3746
g16
V100297
p3747
stp3748
a((dp3749
g2
(lp3750
VAre you certain that owner (taken from ) and the slug are correct
p3751
aVThe Twitter response is telling you that the resource (list in this case) is not found, so one of these is incorrect
p3752
as(dp3753
g16
V100297
p3754
stp3755
a((dp3756
g2
(lp3757
VTo convert from an UTF-8 bytestring to a unicode object, you need to decode:
p3758
aVAlso, when executing a raw  through , SQLAlchemy has no metadata to work out that your query is returning utf-8 data, so it is not converting this information to unicode for you
p3759
aVIn other words,  only works if you use the SQLAlchemy SQL expression API or the ORM functionality
p3760
aVEDIT: As pointed out, your data is not even UTF-8 encoded;  in UTF-8 would indicate a character between  and , which are CJK unified ideographs while you said it was a latin-1 character, whose UTF-8 code would start with
p3761
aVThis is probably  (latin-1) or similar instead:
p3762
aVThe conclusion then is to tell SQLAlchemy to connect with a different character set, using the  parameter, as pointed out by @mata
p3763
as(dp3764
g16
V100297
p3765
stp3766
a((dp3767
g2
(lp3768
VFrom the  documentation:
p3769
aVBy default, packages are installed to the running Python installation's site-packages directory, unless you provide the -d or --install-dir option to specify an alternative directory, or specify an alternate location using distutils configuration files
p3770
aV(See Configuration Files, below
p3771
aVBy default, any scripts included with the package are installed to the running Python installation's standard script installation location
p3772
aVHowever, if you specify an installation directory via the command line or a config file, then the default directory for installing scripts will be the same as the package installation directory, to ensure that the script will have access to the installed package
p3773
aVYou can override this using the -s or --script-dir option
p3774
as(dp3775
g16
V100297
p3776
stp3777
a((dp3778
g2
(lp3779
VIf you take a look at the  module you'll find that the  class has a  interface definition
p3780
aVIt documents the  method as follows:
p3781
aVTo thus expand on your example:
p3782
as(dp3783
g16
V100297
p3784
stp3785
a((dp3786
g2
(lp3787
VYou only duplicate the outer list, but the values of that list are left untouched
p3788
aVThus, all (both) outer lists contain references to the same inner, mutable list
p3789
aVBetter create the inner lists in a loop:
p3790
aVor, illustrated with the python prompt again:
p3791
as(dp3792
g16
V100297
p3793
stp3794
a((dp3795
g2
(lp3796
VUse the  (the Zope Object Database) instead
p3797
aVBacked with ZEO it fulfills your requirements:
p3798
aVTransparent persistence for Python objects
p3799
aVZODB uses pickles underneath so anything that is pickle-able can be stored in a ZODB object store
p3800
aVFull ACID-compatible transaction support (including savepoints)
p3801
aVThis means changes from one process propagate to all the other processes when they are good and ready, and each process has a consistent view on the data throughout a transaction
p3802
aVZODB has been around for over a decade now, so you are right in surmising this problem has already been solved before
p3803
aV:-)
p3804
aVThe ZODB let's you plug in storages; the most common format is the FileStorage, which stores everything in one Data
p3805
aVfs with an optional blob storage for large objects
p3806
aVSome ZODB storages are wrappers around others to add functionality; DemoStorage for example keeps changes in memory to facilitate unit testing and demonstration setups (restart and you have  clean slate again)
p3807
aVBeforeStorage gives you a window in time, only returning data from transactions before a given point in time
p3808
aVThe latter has been instrumental in recovering lost data for me
p3809
aVZEO is such a plugin that introduces a client-server architecture
p3810
aVUsing ZEO lets you access a given storage from multiple processes at a time; you won't need this layer if all you need is multi-threaded access from one process only
p3811
aVThe same could be achieved with RelStorage, which stores ZODB data in a relational database such as PostgreSQL, MySQL or Oracle
p3812
as(dp3813
g16
V100297
p3814
stp3815
a((dp3816
g2
(lp3817
VThis depends on how you connect to remote servers via Python
p3818
aVThe  and  libraries will honour the  environment variables (e
p3819
ag1298
aV, , etc
p3820
aVFrom the  documentation page:
p3821
aVThe urlopen() function works transparently with proxies which do not require authentication
p3822
aVIn a Unix or Windows environment, set the http_proxy, or ftp_proxy environment variables to a URL that identifies the proxy server before starting the Python interpreter
p3823
aVNote that you can also use the  environment variable to list exceptions
p3824
aVYou'll need to be more specific about your Python network usage to be any more specific
p3825
as(dp3826
g16
V100297
p3827
stp3828
a((dp3829
g2
(lp3830
VYou can pass command line options to the python script, just like you can with other command line programs
p3831
aVDepending on which button was pressed, pass different switches to your program
p3832
aVIn your case, it may be simplest just to pass in one value on the command line depending on the button that was pressed and pick this from the  variable:
p3833
aV(You could use a dict to look up methods but that may be too advanced, don't know how comfortable you are with Python)
p3834
aVSo, if you call this script with  the  function will be called
p3835
aVIf this is going to grow to more than just two buttons, I'd use the  module to define your options and run different code paths depending on the options chosen
p3836
aVIf you upgrade to Python 2
p3837
aV7, then use the new (better)  module instead
p3838
as(dp3839
g16
V100297
p3840
stp3841
a((dp3842
g2
(lp3843
VExceedingly simple, just use a list comprehension to loop over the source list and convert each element to a tuple, by directly passing the items to the  builtin:
p3844
aVAlternatively, if you like functional programming, use  instead:
p3845
as(dp3846
g16
V100297
p3847
stp3848
a((dp3849
g2
(lp3850
VUse sets to find all equivalents:
p3851
aVThe  operator here gives you the intersection of both sets; alternatively you could write:
p3852
aVNote that this does create full copies of both dicts so if these are very large you this may not be the best approach
p3853
aVA shortcut would be to only test the keys:
p3854
aVHere you only copy the keys of each dict to reduce the memory footprint
p3855
aVWhen using Python 2
p3856
aV7, the dict type includes additional methods to create the required sets directly:
p3857
aVThese are technically dictionary views but for the purposes of this problem they act the same
p3858
as(dp3859
g16
V100297
p3860
stp3861
a((dp3862
g2
(lp3863
VGlobal variables are not shared between multiple processes; you are manipulating a global list in a sub-process only, the parent process won't see the changes
p3864
aVReview the documentation on sharing state for options on how to pass information between processes
p3865
aVYou probably want a  instance to share your list
p3866
as(dp3867
g16
V100297
p3868
stp3869
a((dp3870
g2
(lp3871
VIf you adding static keys, why not just directly put them in the dict constructor
p3872
aVor, if your keys are not always also valid python identifiers:
p3873
aVIf, on the other hand, your keys are not static or easily stored in a sequence, looping over the keys could be more efficient if there are a lot of them
p3874
aVThe following example still types out the  variable making this no more efficient than the above methods, but if  were generated in some way this could be more efficient:
p3875
as(dp3876
g16
V100297
p3877
stp3878
a((dp3879
g2
(lp3880
VThe RTF standard uses UTF-16, but shaped to fit the RTF command sequence format
p3881
aVDocumented at http://en
p3882
aVwikipedia
p3883
aVorg/wiki/Rich_Text_Format#Character_encoding
p3884
aVpyRTF doesn't do any encoding for you, unfortunately; handling this has been on the project's TODO but obviously they never got to that before abandoning the library
p3885
aVThis is based on code I used in a project recently
p3886
aVI've now released this as  on PyPI, with support for Python 2 and 3; the python 2 version:
p3887
aVInstead of encoding to "iso-8859-15" you can then encode to 'rtfunicode' instead:
p3888
aVEncode any text you insert into your RTF document this way
p3889
aVNote that it only supports UCS-2 unicode (, 2 bytes), not UCS-4 (, 4 bytes); apparently you can use UTF-16 surrogate pairs for those but I haven't yet figured out how to include those
p3890
as(dp3891
g16
V100297
p3892
stp3893
a((dp3894
g2
(lp3895
VI would parse the document using the iterative parser instead, calling  on any element you are done with; that way you avoid having to load the whole document in memory in one go
p3896
aVYou can limit the iterative parser to only those tags you are interested in
p3897
aVIf you only want to parse  tags, tell your parser so:
p3898
aVBy clearing the element in the loop, you free it from memory
p3899
as(dp3900
g16
V100297
p3901
stp3902
a((dp3903
g2
(lp3904
VTake a look at the python buildout, a  setup for building python versions 2
p3905
aV4-2
p3906
aV7, 3
p3907
aV2 and 3
p3908
ag35
aVOriginally conceived for building multiple python versions on Mac, I believe it should work on Linux just as well
p3909
as(dp3910
g16
V100297
p3911
stp3912
a((dp3913
g2
(lp3914
VYes and no; the email address you see in the Plone UI is just a piece of metadata, it doesn't auto-magically email all the members of the group
p3915
aVYou'd have to add each and every user you assign to that group to an email list (be it with a list manager or a manually administered alias) by separate means for that to work
p3916
aVHowever, you could loop over all group members, get an email address for each (provided they have one registered), and then email them all:
p3917
as(dp3918
g16
V100297
p3919
stp3920
a((dp3921
g2
(lp3922
VNot without additional development; you'd have to extend the File type with a validator to restrict the mime types allowed
p3923
aVWithout going into the full detail (try for yourself and ask more questions here on SO if you get stuck), here are the various moving parts I'd implement if I were faced with this problem:
p3924
aVCreate a new  class to check for allowed content types:
p3925
aVRegister an instance of your validotor with the register:
p3926
aVCreate a new subclass of the ATContentTypes ATFile class, with a copy of the baseclass schema, to add the validator to it's validation chain:
p3927
aVor just alter the ATFile schema itself if you want this to apply to all File objects in your deployment:
p3928
aVAdd a field to Folders or a custom sub-class to store a list of locally allowed content types
p3929
aVI'd probably use  for this
p3930
aVThere is plenty of documentation on this these days,  for example
p3931
aVYou'd have to make a policy decision on how you let people restrict mime-types here of course; wildcarding, free-form text, a vocabulary, etc
p3932
as(dp3933
g16
V100297
p3934
stp3935
a((dp3936
g2
(lp3937
VThe  explains that you need to list the variables as comma-separated key/value pairs:
p3938
aVenvironment
p3939
aVA list of key/value pairs in the form KEY=val,KEY2=val2 that will be placed in the supervisord process\u2019 environment (and as a result in all of its child process\u2019 environments)
p3940
aVThis option can include the value %(here)s, which expands to the directory in which the supervisord configuration file was found
p3941
aVNote that subprocesses will inherit the environment variables of the shell used to start supervisord except for the ones overridden here and within the program\u2019s environment configuration stanza
p3942
aVThe  also uses commas:
p3943
aVInternally this is  using the python  lexer, so it'll deal with quoting properly
p3944
aVIt'll also strip whitespace, so to make things more readable, you could divide things over multiple lines:
p3945
aVNote that a trailing comma is optional; it won't make a difference in the output
p3946
aVMissing a comma after KEY1 however could lead to weird values (the above example, minus the comma after  would give you  as the environment dict) as the equals sign requirement isn't rigorously checked
p3947
aVI've submitted a pull request to remedy that
p3948
as(dp3949
g16
V100297
p3950
stp3951
a((dp3952
g2
(lp3953
VUse :
p3954
aVThis module provides a simple way to time small bits of Python code
p3955
aVIt has both command line as well as callable interfaces
p3956
aVIt avoids a number of common traps for measuring execution times
p3957
aVYou'll need a python statement in a string; if you have a main function in your code, you could use it like this:
p3958
aVThe second string provides the setup, the environment for the first statement to be timed in
p3959
aVThe second part is not being timed, and is intended for setting the stage as it were
p3960
aVThe first string is then run through it's paces; by default a million times, to get accurate timings
p3961
aVIf you need more detail as to where things are slow, use one of the :
p3962
aVA profiler is a program that describes the run time performance of a program, providing a variety of statistics
p3963
aVThe easiest way to run this is by using the  module from the command line:
p3964
as(dp3965
g16
V100297
p3966
stp3967
a((dp3968
g2
(lp3969
VTwo options:
p3970
aVInclude 'print' in your timed code
p3971
aVUgly, but hey
p3972
aVIf all you do is run your function once, then dispense with the  module altogether and time the code directly using the same method:
p3973
aVIf you want to run the code multiple times, and produce the output, why not run the code once outside the timeit function
p3974
aVYou are calling it more than once then already anyway:
p3975
as(dp3976
g16
V100297
p3977
stp3978
a((dp3979
g2
(lp3980
VThere is no "authenticated" permission, all permissions are for specific actions only and if an authenticated user needs to be able to execute that action then you should assign the corresponding permission to the 'Authenticated' role
p3981
aVTo get a quick list of (Zope2 string-based) permissions for the 'Authenticated' role, use the following ZMI view:
p3982
aVwhere I assume you run your site on port 8080 and you named the Plone object
p3983
aVIt shows all permissions in a multi-select list with those currently assigned activated
p3984
aVOn a default site, this list is pretty meagre, only ,  and  are assigned
p3985
aVFor the first two, Zope3 equivalents are defined in Products
p3986
aVCMFCore; they are , and ; the third one doesn't have a Zope3 equivalent at the moment, but would be easy to define, just add this to a ZCML file somewhere:
p3987
aVZope3 permissions are simply aliases for their Zope2 counterparts using valid python ids
p3988
aVI really do not know what you want to do with your view, but your best bet is to either find an appropriate permission and assign it to the 'Authenticated' role, or create a new permission
p3989
aVThe latter is really easy, actually
p3990
aVSay I want to create a 'Access foo bar' permission, I'd simply register it directly with a Zope3 identifier in a ZCML file:
p3991
aVThat's all there is to it; the "Access foo bar" permission will now be visible in the ZMI
p3992
aVIf you want to give this permission to specific roles by default, list them as contained elements:
p3993
aVThis only works for 'global' roles (defined at the Zope root), such as 'Manager', 'Anonymous' and 'Authenticated'
p3994
aVOptionally, list it in a GenericSetup profile using the rolemap
p3995
aVxml file to assign this new permission to the Authenticated role:
p3996
aVYou'll need to use the latter only if you want to assign permissions defined at the Plone level, such as 'Site Administrator' or 'Editor'
p3997
as(dp3998
g16
V100297
p3999
stp4000
a((dp4001
g2
(lp4002
VI'd use a set for quick and easy testing:
p4003
aVFirst, I've pulled the query outside of the filename loop; no point in querying the same set of rows each time
p4004
aVSecondly, I'll let MySQL generate filenames for me using  for ease of collecting the information into a set
p4005
aVThirdly, because we now have a set of filenames, testing each individual filename against the set is a simple  test
p4006
aVAnd finally, I've simplified your filename splitting logic to one line
p4007
aVNow, if all you want is a set of filenames that are not present yet in the database (rather than enumerate which ones are and which ones are not), just use a set operation:
p4008
aVHere we use the  operation (with the  operator) to remove all the filenames for which there are already rows in the database, in one simple operation
p4009
as(dp4010
g16
V100297
p4011
stp4012
a((dp4013
g2
(lp4014
VThe names in the GenericSetup xml file are either view names or skin items; view names are looked up using the same traversal mechanisms as when you direcly name the view in the URL
p4015
aVSo, anything you can reach with a URL can be used as a view method
p4016
aVThat includes views that dispatch to other views in the  method:
p4017
aVThis example view looks up other views by their name, and renders them in place to return as the result of the dispatcher itself
p4018
aVNote that generally, I make sure that if a view is being used I make sure to include the  view namespace in front of it's name to prevent that a skin item with the same name accidentally is being used
p4019
as(dp4020
g16
V100297
p4021
stp4022
a((dp4023
g2
(lp4024
VNormally, when setting up a LinguaPlone site you let LinguaPlone create top-level per-language folders that act as navigation roots
p4025
aVThe root of the site itself is set up to redirect visitors to one of these roots depending on their language preferences and other factors, using a language selector
p4026
aVTake a look at http://www
p4027
aVnorden
p4028
aVorg/ for an example of such a site
p4029
aVNotice that when you visit that URL you are automatically redirected to one of the supported languages, usually to http://www
p4030
aVnorden
p4031
aVorg/en/ for english
p4032
aVYou can switch between the available languages on the top left, and you'll see that the first element of the URL changes between the language codes
p4033
aVThose are the top-level folders
p4034
aVThe advantage here is that each of these folders can have it's own default view
p4035
aVAnother is that URLs are always crystal clear for visitors; switch from "About this website" (http://www
p4036
aVnorden
p4037
aVorg/en/about-this-website) to the Norwegian translation and you end up on on http://www
p4038
aVnorden
p4039
aVorg/no/om-nettstedet; anyone can see that the new URL is in the Norwegian language even if they do not understand that language
p4040
aVYou can set up these language folders after the fact, as documented in the LinguaPlone installation instructions; simply visit the URL:
p4041
aVbut be sure to backup your site first and to adjust the address for your local situation
p4042
as(dp4043
g16
V100297
p4044
stp4045
a((dp4046
g2
(lp4047
VI am one of the original authors of Reflecto
p4048
aVFrom the PyPi page for Reflecto:
p4049
aVReflecto is a tool to incorporate part of the file system into a Plone site
p4050
aVIt allows you to browse through a filesystem hierarchy and access the files in it
p4051
aVFiles are represented as simple downloadable object, not as full CMF or Plone content types
p4052
aVSo Reflecto is meant to show filesystem content inside a Plone website, but it clearly states that these files are not full Plone content types
p4053
aVI'm not sure what requirements you have or exactly what you mean by version control; as a software developer I define that as revision control, and because you are dealing with a full filesystem here I'd use a current revision control package such as SVN, git or mercurial for such a task
p4054
aVThat of course does not integrate into Plone; Reflecto does not give you that level of integration
p4055
aVAs such it sounds like Reflecto is the wrong package for your problem
p4056
aVPerhaps you should look into importing your content into Plone to turn the files into full-blown content items
p4057
as(dp4058
g16
V100297
p4059
stp4060
a((dp4061
g2
(lp4062
VHow are you calling the script
p4063
aVYou need to invoke it directly from a URL, not from your template
p4064
aVInclude a download URL in your template that points to your python script:
p4065
as(dp4066
g16
V100297
p4067
stp4068
a((dp4069
g2
(lp4070
VSee my answer on How can I add translations to a Plone site front-page; you need to run the LinguaPlone setup:
p4071
as(dp4072
g16
V100297
p4073
stp4074
a((dp4075
g2
(lp4076
VYou could try to set the git repository using a command-line switch:
p4077
aVneeds to point to an actual git directory ( in a working tree)
p4078
aVNote that for some commands you also need to set a  option too
p4079
aVAnother way to set the directory is using the  environment variable:
p4080
aVApparently hooks already set  but obviously this is incorrect for your case (it could be relative); the above code sets it to a full, explicit path
p4081
aVSee the  manpage
p4082
aVEdit: Apparently it only works for the OP when specifying both a cwd and overriding the  var:
p4083
as(dp4084
g16
V100297
p4085
stp4086
a((dp4087
g2
(lp4088
VYou do not need both
p4089
aVApparently,  has some improvements over :
p4090
aVThe interpreter generated by the script supports all interpreter options, as opposed to the subset provided by zc
p4091
aVrecipe
p4092
aVegg
p4093
aVBoth scripts and interpreters from this recipe can optionally choose to include site-packages, and even sitecustomize
p4094
aVThese options are described in more detail on the  PyPI page
p4095
aVIf you do not understand what these options mean, you probably do not need to use  at all; just stick with , which is maintained as part of the  core
p4096
as(dp4097
g16
V100297
p4098
stp4099
a((dp4100
g2
(lp4101
VYou could the 'unicode_escape' codec:
p4102
aVAlternatively, 'string-escape' will give you a classic python 2 string (bytes in python 3):
p4103
as(dp4104
g16
V100297
p4105
stp4106
a((dp4107
g2
(lp4108
VSimply use the built-in  functionality in zope
p4109
aVconf; list them in the  option of :
p4110
aVThe above snippet will call  every 2 hours, with the Host header set to  with the configured user and password
p4111
aVThe clock-server was added to Zope 2
p4112
aV10; before this it was a separate product by Chris McDonough
p4113
aVI generally created dedicated views for such tasks
p4114
aVThe alternative is to use a cron job to call either a view (usually with  or ) or a zopectl command line script
p4115
aVI use this when I need precise control over when the script needs to be executed, such as at midnight every day
p4116
as(dp4117
g16
V100297
p4118
stp4119
a((dp4120
g2
(lp4121
VUse the  call for obtaining file properties like the modification time
p4122
aVis a float value on python 2
p4123
aV5 and up, representing seconds since the epoch; use the  or  modules to interpret these for display purposes or similar
p4124
aVDo note that the value's precision depends on the OS you are using:
p4125
aVThe exact meaning and resolution of the st_atime, st_mtime, and st_ctime attributes depend on the operating system and the file system
p4126
aVFor example, on Windows systems using the FAT or FAT32 file systems, st_mtime has 2-second resolution, and st_atime has only 1-day resolution
p4127
aVSee your operating system documentation for details
p4128
aVIf all you are doing is get the modification time, then the  method is a handy shortcut; it uses the  method under the hood
p4129
aVNote however, that the  call is relatively expensive (file system access), so if you do this on a lot of files, and you need more than one datapoint per file, you are better off using  and reuse the information returned rather than using the  convenience methods where  will be called multiple times per file
p4130
as(dp4131
g16
V100297
p4132
stp4133
a((dp4134
g2
(lp4135
VNope, you can't
p4136
aVSorry
p4137
aVThe python  statement only supports one module to import statements from at a time
p4138
aVIf you could do this, hypothetically speaking, what would the following mean:
p4139
aVwhat module would  be imported from
p4140
aVBoth modules define such a class
p4141
aVPython prefers explicit over implicit; you select one source from which to import at a time as that results in the least surprise and the greatest clarity as to what is happening
p4142
as(dp4143
g16
V100297
p4144
stp4145
a((dp4146
g2
(lp4147
VPyramid INI files can hold arbitrary configuration entries, so why not include a flag in your files that distinguishes between production and development deployments
p4148
aVI'd do it like this; in your production
p4149
aVini file:
p4150
aVPass this value on to the Pyramid Configurator:
p4151
aVYou can now access the settings from just about anywhere in your Pyramid code
p4152
aVFor example, in a request handler:
p4153
aVHowever, I'd also use more finegrained settings in this case; a flag for enabling Google Analytics, one for minifying resources, etc
p4154
aVThat way you can test each individual setting in your development environment, write unit tests for these switches, etc
p4155
as(dp4156
g16
V100297
p4157
stp4158
a((dp4159
g2
(lp4160
VYou can assign local roles to both individual users and groups
p4161
aVLet's assume you have a ProjectManager role, and a Participant role, then you can assign the ProjectManager role locally (a local role) to an individual user, and the Participant role to a whole group of users; each member of that group would have the Participant role within that location
p4162
as(dp4163
g16
V100297
p4164
stp4165
a((dp4166
g2
(lp4167
VTake a look at buildout; together with a buildout plugin called mr
p4168
aVdeveloper you can put together a deployment system that'll do all that you ask for
p4169
aVThere are plenty of examples and presentations on buildout configurations on the web, here are a few to get you started:
p4170
aVAn introductionairy presentation on buildout: http://www
p4171
aVslideshare
p4172
aVnet/djay/buildout-how-to-maintain-big-app-stacks-without-losing-your-mind
p4173
aVIncludes a YouTube video of the presentation, so you can listen along
p4174
aVExcellent blog post on how to use buildout to develop a Django application
p4175
aVIncludes details on how buildout and setup
p4176
aVpy interplay
p4177
aVThe configuration for planet
p4178
aVplone
p4179
aVorg: https://github
p4180
aVcom/plone/planet
p4181
aVplone
p4182
aVorg/blob/master/buildout
p4183
aVcfg
p4184
aVThis builds a venus RSS aggregator with configuration, style, apache config and cronjobs, pulling in eggs as needed
p4185
aVThe Plone core development buildout: https://github
p4186
aVcom/plone/buildout
p4187
aVcoredev
p4188
aVComplex buildout that pulls in all the sources needed to develop the Plone CMS; this is a complex beast but it shows off what you can do with
p4189
as(dp4190
g16
V100297
p4191
stp4192
a((dp4193
g2
(lp4194
VYou could loop over each generated permutation and append the static 1:
p4195
aVOr, to make this a little more explicit:
p4196
aVBoth variations produce the desired output and close in efficiency to your  original
p4197
as(dp4198
g16
V100297
p4199
stp4200
a((dp4201
g2
(lp4202
VTake a look at
p4203
aVYou can use it to count your word frequencies, and it'll help you print out the list in sorted order, with the  method
p4204
aV(No example code as this is a homework question, you'll have to do some work yourself)
p4205
as(dp4206
g16
V100297
p4207
stp4208
a((dp4209
g2
(lp4210
VFrom the ElementTree documentation on XPath support
p4211
aV:
p4212
aVElementTree provides limited support for XPath expressions
p4213
aVThe goal is to support a small subset of the abbreviated syntax; a full XPath engine is outside the scope of the core library
p4214
aVYou've just discovered a limitation in the implementation
p4215
aVYou could use lxml instead; it provides a ElementTree-compatible interface with complete XPath 1
p4216
aV0 support
p4217
as(dp4218
g16
V100297
p4219
stp4220
a((dp4221
g2
(lp4222
VIf you were to modify your data method like so:
p4223
aVyou'll see why there are multiple calls to the data method; it is called for every line of text data between the tags:
p4224
aVThe XMLParser methods are based on the Expat parser
p4225
aVIn my experience, any streaming XML parser will treat text data as a series of chunks and you have to concatenate any and all data events together until you hit the next starttag or endtag event
p4226
aVOften the parser breaks up chunks at whitespace boundaries but that is not a given
p4227
as(dp4228
g16
V100297
p4229
stp4230
a((dp4231
g2
(lp4232
VYou are passing in a set of keyword arguments to the  method, and only the last value is considered the target for the string interpolation:
p4233
aVThere is no need to use string interpolation here; just pass all the arguments on to the  method:
p4234
as(dp4235
g16
V100297
p4236
stp4237
a((dp4238
g2
(lp4239
VFirstly, the  function is deprecated and merely an alias for , you may want to adjust your import path
p4240
aVSecondly, you are passing in a byte string into the parse method
p4241
aVIf you pass in a regular (unicode) string instead the  method returns regular strings:
p4242
aVSo you'll need to decode your file-read byte string to a regular string first
p4243
as(dp4244
g16
V100297
p4245
stp4246
a((dp4247
g2
(lp4248
VYou'll need to delete the key from the  dict:
p4249
aVBy setting  you are only creating a new variable that points to the same value as , but deleting  will not remove the dict from the parent structure
p4250
aVTo replace the dict altogether, you again need to manipulate the parent dict:
p4251
aVIf you execute  what you are doing is assigning a reference to a new  value to the variable , replacing the reference to the  ; you are not manipulating the original value in the  dict
p4252
aVis just a subclass of  that gives warnings for attribute access, which is now deprecated; otherwise it acts just like a regular  type
p4253
as(dp4254
g16
V100297
p4255
stp4256
a((dp4257
g2
(lp4258
VUse a GET request instead:
p4259
aVAs the  documentation states:
p4260
aVdata may be a string specifying additional data to send to the server, or None if no such data is needed
p4261
aVCurrently HTTP requests are the only ones that use data; the HTTP request will be a POST instead of a GET when the data parameter is provided
p4262
aVYou were passing in  as POST data by passing it to the  method as the second positional argument
p4263
aVConcatenating it to the URL with a  instead makes it a GET request
p4264
as(dp4265
g16
V100297
p4266
stp4267
a((dp4268
g2
(lp4269
VThat 'bunch of python scripts' is called a python package; there should be a  file in there somewhere
p4270
aVTogether they form a coherent whole, a namespaced set of modules
p4271
aVYou can just import the  class from the  package:
p4272
aVSee the documentation for more info
p4273
as(dp4274
g16
V100297
p4275
stp4276
a((dp4277
g2
(lp4278
VUse :
p4279
aVCounters are basically a subclass of , so you can still do everything else with them you'd normally do with that type, such as iterate over their keys and values
p4280
as(dp4281
g16
V100297
p4282
stp4283
a((dp4284
g2
(lp4285
VFrom the MIME media types RFC 2046:
p4286
aVThe canonical form of any MIME "text" subtype MUST always represent a
p4287
aVline break as a CRLF sequence
p4288
aVYour code uses carriage returns ('\u005cr') only; you need to add line feeds () as well
p4289
as(dp4290
g16
V100297
p4291
stp4292
a((dp4293
g2
(lp4294
VThe Pyramid project is known for it's excellent documentation, and there is a Internationalization and Localization section available
p4295
aVPyramid does not, however, dictate what form framework you use in your applications
p4296
aVLocalization services themselves are generally deferred to Babel, including number and date formatting routines
p4297
aVYou'd have to either tie these into your form framework of choice or find a framework that already ties into Babel for this work (I know of none but that doesn't say much)
p4298
as(dp4299
g16
V100297
p4300
stp4301
a((dp4302
g2
(lp4303
VYou have a few options:
p4304
aVPack your ZODB if you haven't already
p4305
aVRemoving old transaction data will also result in the BLOB files for those transactions being removed
p4306
aVOf course, packing removes history, so if you need to be able to undo transactions you may want to only pack until 30 days ago or similar
p4307
aVUse a dedicated ZEO server with higher virtual server file limits to store your ZODB and the blobstorage, then use a blob cache on the client(s)
p4308
aVUse a non-shared blobstorage; your Zope servers will pull in BLOBs over the network from the ZEO server to be stored in the local blob cache, which can be limited in total disk space
p4309
aV(A shared blobstorage is a directory shared over NAS or something similar defeating the purpose here)
p4310
aVThis does not lower the number of BLOB files to back up but perhaps makes it more manageable for you as the ZEO server can be spec-ed for disk space instead of CPU and memory load
p4311
aVThe blob caches on the client machines need not be backed up at all
p4312
aVRe-tool your application to not have so many BLOBs or to not alter them so often
p4313
aVUltimately, that's where all your blob files come from; the ZODB uses one blob file per ZODB blob per transaction that alters them
p4314
as(dp4315
g16
V100297
p4316
stp4317
a((dp4318
g2
(lp4319
VThe  documentation does state it's a mapping:
p4320
aVA mapping object representing the string environment
p4321
aVAs such it behaves according to the python mapping documentation of which  is the standard implementation
p4322
aVtherefor behaves just like the standard dict, it has all the same methods:
p4323
aVThe  method is documented on the same page as the rest of the mapping methods, and you can use it just fine as is
p4324
as(dp4325
g16
V100297
p4326
stp4327
a((dp4328
g2
(lp4329
VChange Module B to not import class  until the last possible moment, inside the :
p4330
aVNote that because  instantiates  and vice-versa, you'll end up with an infinite recursion problem, but I'll charitably assume that you don't have that problem outside of your illustration example
p4331
as(dp4332
g16
V100297
p4333
stp4334
a((dp4335
g2
(lp4336
VNope, and in python 2 you can't at all without resorting to using tricks with mutables:
p4337
aVNormally, python will only look in the surrounding scope for a variable if it is not being assigned to locally; as soon as the bytecompiler sees a direct assignment () and no  statement to persuade it otherwise, a variable is considered local
p4338
aVBut in the above code we never assign to  in the  function
p4339
aVYes, we do change  but the value stored in  itself, a list, does not change
p4340
aVIn python 3, just use the  statement to have python look in it's closure for the variable:
p4341
as(dp4342
g16
V100297
p4343
stp4344
a((dp4345
g2
(lp4346
VThe  method let's you find tags by XPath 1
p4347
aV0 expressions:
p4348
aVIn the above example, the XPath expression in  gives you all  elements that are children of , with a sibling  tag with text , as ElementTree  instances, thus making it trivial to replace their text content
p4349
as(dp4350
g16
V100297
p4351
stp4352
a((dp4353
g2
(lp4354
VISO dates are text sortable:
p4355
as(dp4356
g16
V100297
p4357
stp4358
a((dp4359
g2
(lp4360
VThe python module  is imported automatically whenever the python interpreter is run
p4361
aVThis module attempts to import another, named
p4362
aVYou could put your functions in there, adding them to the  mapping with:
p4363
aVNote that this only works on cpython, where  is a mutable dict
p4364
aVDoing so will automatically make these functions available to all your python code for this installation
p4365
aVI strongly would discourage you from doing so
p4366
aVImplicit is never better than explicit, and anyone maintaining your code will wonder where the hell these came from
p4367
aVYou'd be better off with a  import in your modules
p4368
as(dp4369
g16
V100297
p4370
stp4371
a((dp4372
g2
(lp4373
VThe generic term for such URL-safe values is "slug", and the process of generating one is called "slugification", or "to slugify"
p4374
aVPeople generally use a regular expression to do so; here is one (sourced from this article on the subject), using only stdlib modules:
p4375
aVThe linked article has another 2 alternatives requiring additional modules
p4376
as(dp4377
g16
V100297
p4378
stp4379
a((dp4380
g2
(lp4381
VBoth options are well documented (see Subprocess Environment and the configuration file documentation)
p4382
aVWhat it comes down to is that these two options let you set the current working directory and the full environment for the subprocesses that supervisord starts
p4383
aVThese are two basic UNIX concepts and many processes may behave differently depending on how these are set
p4384
aVSee Working directory and Environment variable on Wikipedia for in-depth discussion of those concepts
p4385
aVGenerally, if your uwsgi process is running properly, there is no need to tinker with these at all
p4386
aVIf you do need to set them, just add the entries to your configuration, setting  to an existing path on your system and the  value to a set of KEY=VALUE pairs joined by commas
p4387
as(dp4388
g16
V100297
p4389
stp4390
a((dp4391
g2
(lp4392
V is a one-value option; every time you specify it on the command line, the previous value get's overwritten
p4393
aVUse  instead:
p4394
aV--extra-index-url=URL
p4395
aVExtra URLs of package indexes to use in addition to --index-url
p4396
aVFrom the install documentation:
p4397
aVIf you have your own package index with a few additional packages, you may want to to specify additional index URLs while still also using PyPI:
p4398
aV$ pip install --extra-index-url http://my
p4399
aVpackage
p4400
aVrepo/ SomePackage
p4401
as(dp4402
g16
V100297
p4403
stp4404
a((dp4405
g2
(lp4406
VUse bitmasks and bitshifting:
p4407
aVThe trick here is to know that 31 is a 5-bit bitmask:
p4408
aVAs you can see you could also just use the  binary number literal notation if you find that easier to work with
p4409
aVSee the Python Wiki on bit manipulation for more background info
p4410
as(dp4411
g16
V100297
p4412
stp4413
a((dp4414
g2
(lp4415
V is not UTF8; it's using the python unicode escape format
p4416
aVUse the  codec instead:
p4417
aVHere is the UTF-8 encoding of the above phrase, for comparison:
p4418
as(dp4419
g16
V100297
p4420
stp4421
a((dp4422
g2
(lp4423
VNo need to put in the  keyword, it's a no-op
p4424
aVUse a  instead:
p4425
aVWhat is happening is that you never define any keys for , you just expect them to be lists by default
p4426
aVThe  type gives you a dict that does just that; when a key is not yet found in  a new  instance will be used as the starting value instead of raising a KeyError
p4427
as(dp4428
g16
V100297
p4429
stp4430
a((dp4431
g2
(lp4432
VYou probably need to set a Content-Type response header; that'd be my first guess:
p4433
as(dp4434
g16
V100297
p4435
stp4436
a((dp4437
g2
(lp4438
Vbfgshell will use IPython when installed, or the  InteractiveInterpreter otherwise
p4439
aVYou can test for either one with:
p4440
as(dp4441
g16
V100297
p4442
stp4443
a((dp4444
g2
(lp4445
VMD5 hashes are always 16 bytes long, and Base64 encodes groups of 3 bytes to 4 characters; thus (16 / 3 rounded up) => 6 groups of 3, times 4 = 24 characters for a MD5 hash encoded to Base64
p4446
aVHowever, note that the above linked Wikipedia page states:
p4447
aVHowever, it has since been shown that MD5 is not collision resistant
p4448
aVSo you cannot count on this method giving you unique usernames from email addresses
p4449
aVProducing them is very easy with the help of the  module:
p4450
as(dp4451
g16
V100297
p4452
stp4453
a((dp4454
g2
(lp4455
VYou need to specify all the arguments separately:
p4456
aVYou could grep through the output in python just fine too
p4457
aVAs an aside:  tells you the current platform architecture you are running scons on, nothing about the binaries you are producing or even how the python version was compiled
p4458
aVIt can provide this info for other binaries, but only if the executable points to the Python interpreter, and probably not on Windows as there is no equivalent of the  command present there
p4459
as(dp4460
g16
V100297
p4461
stp4462
a((dp4463
g2
(lp4464
VUpgrade your  library
p4465
aVThere was a bug when the request fails that would cause the specific error you see, but that has since been corrected
p4466
aVThe fix is part of version 1
p4467
aV6 and up
p4468
as(dp4469
g16
V100297
p4470
stp4471
a((dp4472
g2
(lp4473
VTake a look at scrapy instead; it'll make this task a lot easier
p4474
aVYou define items to scrape from that site:
p4475
aVthen define a loader with XPath expressions to fill these items
p4476
aVAfterwards you can use these items directly, or produce JSON output or similar
p4477
as(dp4478
g16
V100297
p4479
stp4480
a((dp4481
g2
(lp4482
VGPX is an XML format, so use a fitting module like lxml or the included ElementTree XML API to parse the data, then output to CSV using the python  module
p4483
aVTutorials covering these concepts:
p4484
aVlxml
p4485
aVetree tutorial
p4486
aVElementTree tutorial
p4487
aVDive into Python 3 on XML processing
p4488
aVHandling CSV Files in Python
p4489
aVI also found a python GPX parsing library called gpxpy that perhaps gives a higher-level interface to the data contained in GPX files
p4490
as(dp4491
g16
V100297
p4492
stp4493
a((dp4494
g2
(lp4495
VI'd fully expect this to work, so something else must be wrong
p4496
aVPython expressions such as yours are commonplace; there are several examples on the internet to show they do normally work
p4497
aVTry further debugging the values with  and  statements and similar to be 100% certain of what your data structures look like
p4498
as(dp4499
g16
V100297
p4500
stp4501
a((dp4502
g2
(lp4503
VThis is usually a bad idea, but in your case it doesn't work because you encode newlines as well
p4504
aVIn UTF-16, every character is encoded to two bytes, including the newline you wrote
p4505
aVBecause you read your file line by line, python will give you all data from the file up to the next newline byte, but in UTF-16 that could mean that one of the two bytes is still included in the returned data resulting in an incomplete UTF-16 byte stream
p4506
aVTo understand this, you need to understand UTF-16 encoding in more detail
p4507
aVWhen writing 16-bit data as 2 bytes of 8 bits, computers need to decide which byte to write to the file first
p4508
aVThis decision can go two ways, and is called endianess; like Gulliver's Lilliputs, computer systems prefer either Big or Little endian ordering
p4509
aVAn UTF-16 data stream is thus written in one of two orderings, and a Byte Order Mark or "BOM" is written first to flag which one was choosen
p4510
aVYour newline is thus either encoded as  or , and on reading that null byte () is either part of the UTF-16 data you decode, or the UTF-8 data (where it is ignored)
p4511
aVSo, if you encode UTF-16 as big endian, things work (but you have a stray null byte), but if you encode as little endian, things break
p4512
aVBasically, encoded data should be treated strictly as binary data and you should use a different method to delineate different pieces of encoded text, or you should only use encodings where newlines are strictly encoded as newlines
p4513
aVI'd use a length prefix, read that first, then read that number of bytes from the file for each encoded piece of data
p4514
aVI've used the  module to write fixed-length length data
p4515
aVNote that I write the file as binary, too
p4516
aVReading:
p4517
aVAgain the file is opened in binary mode
p4518
aVIn a real-life application you probably have to include the encoding information per entry as well
p4519
as(dp4520
g16
V100297
p4521
stp4522
a((dp4523
g2
(lp4524
VThe result of the  call is passed literally to the translation machinery
p4525
aVmatches it's keys against what  generates, and if there is a match, the original attribute on the element is ignored (see this I18N article on the Zope 3 wiki
p4526
aVThis means that the result of "Cette etape fait partie du troncon ${troncon/nom}" will be looked up for translation, requiring you to provide translations for each variation of the sentence that can be made with all possible values of
p4527
aVTo get support for proper placeholders in this string you are better off creating a message id in the code that generates the  structure and translate it there, presumably in your view
p4528
aVYou need:
p4529
aVA message id with the placeholder
p4530
aVAttach the  value to the message id
p4531
aVTranslate this message to the currently selected language
p4532
aVInclude the result in your  structure
p4533
aVI generally do this is one step:
p4534
aVDo note that you need a request for the translation function to pick the correct language
p4535
as(dp4536
g16
V100297
p4537
stp4538
a((dp4539
g2
(lp4540
VDuring import the ZODB has to remap the persistent ids in the dumped pickles, and to do so it has to 'load' all the entries in your export file
p4541
aVDuring that remapping process it thus will try and import every referenced class
p4542
aVYour export still holds references to  classes, and that's why you get the error during import
p4543
aVThere are two things you can do:
p4544
aVInstall  into your buildout just for this import to work
p4545
aVThere is no need to run install code or anything, the Zope process just needs to be able to import the class during the import process
p4546
aVYou can remove it again afterwards
p4547
aVFill in the missing imports with empty stubs
p4548
aVThis is a bit more involved, as you'll need to create a dummy module that you'll insert into  to be loaded for this process
p4549
aVThe dummy module could look like this; I've named it 'placeholder
p4550
aVpy':
p4551
aVAnd you stub out missing imports with:
p4552
aVIt is quite likely you'll need to stub out more such classes, based on the  package layout
p4553
aVUsing this technique does not remove the broken references; it'll only let you import your  file into a new instance
p4554
as(dp4555
g16
V100297
p4556
stp4557
a((dp4558
g2
(lp4559
VYes; you generally put context-specific information like expanded routes into the templates and access this information from your (static) JavaScript libraries
p4560
aVIncluding the context info can be done in various ways, depending on taste:
p4561
aVYou could use a data attribute on a tag in your generated HTML:
p4562
aVwhich you then, in your static JS code load with the jQuery  function:
p4563
aVUse a made-up LINK tag relationship to include links in the document head:
p4564
aVwhich can be retrieved using , or
p4565
aVThis only really works for URL information
p4566
aVGenerate JS variables straight in your template, to be referenced from your static code:
p4567
aVand these variables are referable directly with
p4568
as(dp4569
g16
V100297
p4570
stp4571
a((dp4572
g2
(lp4573
VThe first day of the month is easy to construct, as is the first day of the next month
p4574
aVOnce you have those, the rest is even easier
p4575
aVAs pointed out by the OP, the  function gives us the most readable method to get the last day of a month
p4576
aVTo combine these techniques into one function:
p4577
aVOutput:
p4578
aVI'm not sure if you want to add  to each of these two values; currently the first day of the month (first example) gives you  as the first value and (days-in-the-month - 1) as the second value, as this is the difference in days from those points
p4579
aVIt's trivial to add  twice on the last line of the  function if you need these
p4580
aVAs a historic note, a previous version of this answer used a different method to calculate the last day of a month without the calendar module:
p4581
aVThis function uses the  builtin function to handle the 'current month is December' edge-case; in that case the next month is not , but  and we'd need to increase the year by one as well
p4582
aVRolling over a number back to the 'start' is the modulus of the number, but the  function gives us the divisor as well, which happens to be  if the current month is
p4583
aVThis gives us a handy indicator when to increase the year
p4584
as(dp4585
g16
V100297
p4586
stp4587
a((dp4588
g2
(lp4589
VYou need to pass in unicode to the findAll method:
p4590
aVNote the  unicode literal marker in front of the title value
p4591
aVYou do need to specify an encoding on your source file for this to work (the  comment at the top of the file), or switch to unicode escape codes instead:
p4592
aVInternally, BeautifulSoup uses unicode, but you are passing it a byte-string with non-ascii characters in them
p4593
aVBeautifulSoup tries to decode that to unicode for you and fails as it doesn't know what encoding you used
p4594
aVBy providing it with ready-made unicode instead you side-step the issue
p4595
aVWorking example:
p4596
as(dp4597
g16
V100297
p4598
stp4599
a((dp4600
g2
(lp4601
VThe events system used by Pyramid fulfils the exact same use-cases as the Signals system
p4602
aVYour application can define arbitrary events and attach subscribers to them
p4603
aVTo create a new event, define an interface for it:
p4604
aVYou then define an actual implementation of the event:
p4605
aVThe interface is actually optional, but helps documentation and makes it easier to provide multiple implementations
p4606
aVSo you could get away with omitting the interface definition and  parts altogether
p4607
aVWherever you want to signal this event, use the  method; here I assume you have a request available to reach the registry:
p4608
aVThis'll send the request to any subscribers you've registered; either with  or with :
p4609
aVYou can also use the  interface instead of the  class and your subscriber will be notified of all events that implement the interface, not just your specific implementation of that event
p4610
aVNote that notifying subscribers never catches exceptions (like  in Django would do)
p4611
as(dp4612
g16
V100297
p4613
stp4614
a((dp4615
g2
(lp4616
VThe Google Custom Search API let's you search the Google indexes for a specific website only, and you will not find any results from anywhere else on the internet
p4617
aVThe  parameter tells Google what website you want to search
p4618
aVFrom the Google Custom Search Engine page:
p4619
aVWith Google Custom Search, add a search box to your homepage to help people find what they need on your website
p4620
aVYou could use the deprecated Google Web Search API (JavaScript API, should work until November 2013), or you'd have to scrape the HTML UI provided to your browser instead (also see Google web search API deprecated - what now
p4621
as(dp4622
g16
V100297
p4623
stp4624
a((dp4625
g2
(lp4626
VPython comes with batteries included, and a  is part of the stdlib:
p4627
aVThe above set of methods are shortcuts for the  method, which takes arbitrary (integer) levels, and the  module defines ,  and other levels
p4628
aVThe methods support lazy evaluation of python string formatting templates; extra arguments are interpolated only when the log level of the message actually exceeds the logging level being recorded:
p4629
aVThe above message will be logged with the equivalent of  only if the log message actually reaches a handler
p4630
as(dp4631
g16
V100297
p4632
stp4633
a((dp4634
g2
(lp4635
VThe  module provides you with similar conversions, including converting bytes representing integers into Python  instances
p4636
as(dp4637
g16
V100297
p4638
stp4639
a((dp4640
g2
(lp4641
VAn  in lxml is a full tree, so you can use the  or  methods at will:
p4642
aVIn other words, it works just the same as for finding your order element in the first place
p4643
as(dp4644
g16
V100297
p4645
stp4646
a((dp4647
g2
(lp4648
VThe  module is not Python 3 compatible, but should give you a good start on how to talk to the Twitter API from python
p4649
aVEssentially, the Twitter API is called over HTTP and returns JSON, so you'll need to read up on the  and either the  or the  modules ( uses the python 2 equivalent of the  module, )
p4650
aVNote that the API method you link to, , does not give you arbitrary mentions, only those for the current twitter user
p4651
aVSo if I were to log in, it would show mentions for
p4652
aVTo show mentions for  you'd have to do a search for that string via the  API instead
p4653
as(dp4654
g16
V100297
p4655
stp4656
a((dp4657
g2
(lp4658
VYou'll need to import the  configuration
p4659
aVThe most direct way is via the  tool in the ZMI
p4660
aVFind your product name on the "Import" tab (in the Select Profile or Snapshot select box), then when the page has reloaded (shows 'Available Import Steps for "Name of your product profile"') you need to look up the Portlets import step in the list ("Import portlet managers, types, assignments and blacklistings"), tick it's box, and hit the "Import selected steps" button at the bottom
p4661
aVThe WebLion tutorial documented this a little vaguely as "The configuration is now complete
p4662
aVUninstall your theme, restart Zope and reinstall your theme
p4663
aVThe Plone
p4664
aVorg documentation appears to omit it entirely
p4665
as(dp4666
g16
V100297
p4667
stp4668
a((dp4669
g2
(lp4670
VYou could pad them out to 4-byte single-precision floats; there are a few people who already have done the gruntwork for you:
p4671
aVhttp://forums
p4672
aVdevshed
p4673
aVcom/python-programming-11/converting-half-precision-floating-point-numbers-from-hexidecimal-to-decimal-576842
p4674
aVhtml
p4675
aVhttp://davidejones
p4676
aVcom/blog/1413-python-precision-floating-point/
p4677
aVhttp://fpmurphy
p4678
aVblogspot
p4679
aVno/2008/12/half-precision-floating-point-format_14
p4680
aVhtml
p4681
aVThey all parse out the format into it's constituents as documented on the Wikipedia article on the format, padding out the 2 bytes to a 4 bytes single-precision float, then feed that back to the python struct module for converting that to a python float
p4682
as(dp4683
g16
V100297
p4684
stp4685
a((dp4686
g2
(lp4687
VThere is no need to loop over all values of , just look up  directly:
p4688
aVYou can probably omit the test for  being present, your example list always contains a  entry, but I thought it better to be safe
p4689
aVLooking up the code in the referencedict structure assumes that all possible codes are available
p4690
aVI used  here; the opposite is just as valid (), but this way you can more easily remove the line if you do not need it, and you save yourself an indent level
p4691
as(dp4692
g16
V100297
p4693
stp4694
a((dp4695
g2
(lp4696
VUse  with an empty  instance:
p4697
aVIf you like to use a constant instead, use :
p4698
as(dp4699
g16
V100297
p4700
stp4701
a((dp4702
g2
(lp4703
VYou need to use a flag to toggle when to do your replacements; you set it when you have seen the  line and you reset it again when you a  is seen
p4704
aVThen you only look for the line to fix when your context flag is True:
p4705
aVNote that the above overwrites the file in-place; this only works when your replacements are exactly the same length as the replaced text
p4706
aVIf your going to change the length of the lines (shorter, longer) you need to write this to a new file (or ):
p4707
as(dp4708
g16
V100297
p4709
stp4710
a((dp4711
g2
(lp4712
VThe (untested) equivalent in chameleon is:
p4713
aVThe  attribute is optional; it drops the  tag from the output, as it is only used as dummy tag to attach the repeat to
p4714
aVBy dropping it the output of the Chameleon template will match the Mako example
p4715
aVSee the Chameleon documentation for an introduction and full specification of how the template language works
p4716
as(dp4717
g16
V100297
p4718
stp4719
a((dp4720
g2
(lp4721
VWhen you pass in both a filename and a cid, TurboMail ignores the cid and uses the basename of the file instead
p4722
aVI suspect your filenames have extensions and your cids do not:
p4723
aVIf so, the images are embedded with a cid of  instead
p4724
aVYou could pass in an open image file instead; TurboMail will then not ignore the name:
p4725
aVI'd use  instead; it's the new name for the same package but the  method has been made a little saner in it's handling of embedded images and cids
p4726
aVan earlier revision of this answer had marrow and TurboMail confused, referring to the marrow  signature instead
p4727
as(dp4728
g16
V100297
p4729
stp4730
a((dp4731
g2
(lp4732
VYou can use the  module:
p4733
aVNote the use of a tuple to test against multiple types
p4734
aVUnder the hood,  is just an alias for , etc
p4735
ag4212
aVThe  type requires that your python was compiled with support for complex numbers; if you want to guard for this use a try/except block:
p4736
aVor if you just use the types directly:
p4737
aVLast but not least, you can use the  abstract base type (new in Python 2
p4738
aV6) to also support custom numeric types that don't derive directly from the above types:
p4739
aVThis module does make the assumption that the  type is enabled; you'll get an import error if it is not
p4740
as(dp4741
g16
V100297
p4742
stp4743
a((dp4744
g2
(lp4745
VInstall both
p4746
aVPython 3 uses a different executable name so the two won't conflict and the Debian python policy (adopted by Ubuntu) states that the two major versions are to be kept as separate architectures
p4747
aVPython versions are installed with the major and minor version number (python2
p4748
aV7, python3
p4749
aV2), but Ubuntu will create  and  aliases for your python 2 and python 3 installations (linked to  and  respectively)
p4750
aVYour Django development will continue to use  and your Python 3 program will use
p4751
as(dp4752
g16
V100297
p4753
stp4754
a((dp4755
g2
(lp4756
VBoth date and datetime objects have a  attribute, which is a number
p4757
aVJust add 1:
p4758
aVIf you have the current year in a variable, just add 1 directly, no need to bother with the datetime module:
p4759
aVIf you have the date in a string, just select the 4 digits that represent the year and pass it to :
p4760
aVYear arithmetic is exceedingly simple, make it an integer and just add 1
p4761
aVIt doesn't get much simpler than that
p4762
aVIf, however, you are working with a whole date, and you need the same date but one year later, use the components to create a new  object with the year incremented by one:
p4763
aVor you can use the  function, which returns a copy with the field you specify changed:
p4764
aVNote that this can get a little tricky when  is February 29th in a leap year
p4765
aVThe absolute, fail-safe correct way to work this one is thus:
p4766
as(dp4767
g16
V100297
p4768
stp4769
a((dp4770
g2
(lp4771
VUse the  builtin:
p4772
aVWe do several things:
p4773
aVretrieve the correct columns with a slice operator
p4774
aVmap all these values to a boolean (testing the float() against 95)
p4775
aVcheck that all results of the test are True
p4776
as(dp4777
g16
V100297
p4778
stp4779
a((dp4780
g2
(lp4781
VThe portlet category is only available from the portlet retriever
p4782
aVYou can look it up by looping over the  method of the retriever
p4783
aVAs the information that method returns deals with assignments, you'll need the portlet assignment ( on a renderer), to pick out the correct entry:
p4784
as(dp4785
g16
V100297
p4786
stp4787
a((dp4788
g2
(lp4789
VYou can search for both types, but to search for  entries requires custom handling of the internal catalog data structures
p4790
aVIndexes take the value from an object, and index that
p4791
aVIf there is an  or similar, the index does not store anything for that object, and if the same field is part of the returned columns, in that case a  will be given to indicate the index is empty for that field
p4792
aVIn the following examples I assume you have a variable  that points to the site's portal_catalog tool; e
p4793
ag1298
aVthe result of  or similar
p4794
aVSearching for None
p4795
aVYou can search for None in many indexes just fine:
p4796
aVThe problem is that most indexe types ignore  as a value
p4797
aVThus, searching for  will fail on Date and Path indexes; they ignore None on index, and Boolean indexes; they turn None into False when indexing
p4798
aVKeyword indexes ignore  as well, unless it is part of a sequence
p4799
aVIf the indexed method returns  it'll happily be indexed, but  on it's own won't be
p4800
aVField indexes do store  in the index
p4801
aVNote that each index can show unique values, so you can check if there are  values stored for a given index by calling:
p4802
aVSearching for missing values
p4803
aVThis is a little trickier
p4804
aVEach index does keep track of what objects it has indexed, to be able to remove data from the index when the object is removed, for example
p4805
aVAt the same time, the catalog keeps track of what objects it has indexed as a whole
p4806
aVThus, we can calculate the difference between these two sets of information
p4807
aVThis is what the catalog does all the time when you call the published APIs, but for this trick there is no such public API
p4808
aVWe'll need to reach into the catalog internals and grab these sets for ourselves
p4809
aVLuckily, these are all BTree sets, and the operations are thus relatively efficient
p4810
aVHere is how I'd do it:
p4811
aVThe  method returns an IISet of catalog ids and it's length; each is a pointer to a catalog record for which the named index has no entry
p4812
aVYou can then use  to turn that into a full path to objects, or use  to get a dictionary of metadata values, or use  to get the original object itself, or use  to get catalog brains
p4813
aVThe following method will give you a catalog result set, just like you would get from a regular catalog search:
p4814
as(dp4815
g16
V100297
p4816
stp4817
a((dp4818
g2
(lp4819
VChameleon expects templates to be well-formed, and is less forgiving of unbalanced tags and incorrect attribute markup as DreamWeaver is
p4820
aVNote that the error doesn't necessarily mean that there is a  tag too many
p4821
aVIf the opening  has a syntax error such as a missing  on an attribute declaration (e
p4822
ag1298
aVthen the opening tag is not recognized and the corresponding closing tag is going to be flagged as well
p4823
aVYou could run your template through an XML validator, there are several available online (such as http://www
p4824
aVvalidome
p4825
aVorg/xml/, http://www
p4826
aVxmlvalidation
p4827
aVcom/ and http://xmlgrid
p4828
aVnet/, Google lists many more)
p4829
aVThese are bound to give you a slightly more helpful message as to what is wrong with your template
p4830
as(dp4831
g16
V100297
p4832
stp4833
a((dp4834
g2
(lp4835
VInstead of using a event handler, you could customize the  actions; these can be altered through the web even, and can be customized per type
p4836
aVThe  script is a CMF Form Controller script and there are several options to alter it's behaviour
p4837
aVCurrently, the actions are defined as such:
p4838
aVYou could add a type specific action by defining , for example
p4839
aVTo do so through-the-web, visit the ZMI and find the  tool, then click the  tab:
p4840
aVAs you can see in this screenshot there is also documentation on the tool available here
p4841
aVOn the actions tab there is a form to add new actions:
p4842
aVAs you can see, the context type is a drop-down with all existing type registrations to make it easier to specify a type-specific action
p4843
aVI've copied in the regular action (a  action specified by a  expression and added an extra  to select the container parent
p4844
aVYou could also add such an action with the  method on the tool:
p4845
aVLast, but not least, you can specify such custom actions in the  file in a GenericSetup profile; here is an example based on the above action:
p4846
aVThis format is one of those under-documented things in Plone; I got this from the CMFFormController sourcecode for the GS import and export code
p4847
as(dp4848
g16
V100297
p4849
stp4850
a((dp4851
g2
(lp4852
VIf  or  is installed you can use the  command with the  option to install the egg unzipped:
p4853
aVso you can still edit the installed source code
p4854
as(dp4855
g16
V100297
p4856
stp4857
a((dp4858
g2
(lp4859
VIn python  only matches at the start of the string
p4860
aVWhat you want to use is instead is
p4861
aVMoreover, you do not need to include the '/' characters, and you need to use a separate argument to re
p4862
aVcompile to make the search case insensitive:
p4863
aVIn JavaScript, the slashes are the equivalent of calling
p4864
aVI can recommend reading up on the python regular expression module, there is even an excellent HOWTO
p4865
as(dp4866
g16
V100297
p4867
stp4868
a((dp4869
g2
(lp4870
VMake sure you start your Zope server with , most likely the name of the script if you used the Plone universal installer buildout
p4871
aVTo see changes in python code you'll either need to restart the server (CTRL-C then start again) or use something like  to request a reload of changed code
p4872
aVWhen starting your server with the  command, it is automatically running in debug mode and any templates, resources and skin items are reloaded automatically
p4873
aVStart the server with  or  and it'll run in production mode and templates and such are loaded from disk only once
p4874
aVSee the Plone
p4875
aVorg documentation on buildout for more information
p4876
aVThe  command has a built-in help command, try:
p4877
aVfor a list of supported commands or run:
p4878
aVto get help on a specific command; the above example will print the help on the  command
p4879
as(dp4880
g16
V100297
p4881
stp4882
a((dp4883
g2
(lp4884
VThis is one of those places where a regular expression is just the thing:
p4885
aVLittle demo:
p4886
aVYou could use the  method with  as described in @Wallacolloo's answer, but that's slower than the simple regular expression:
p4887
aVThe  method is on par with the regular expression:
p4888
aVBut things get worse if the digits appear late in the text:
p4889
aVTimings tested on python 2
p4890
aV6 on Mac OS X 10
p4891
aV7
p4892
as(dp4893
g16
V100297
p4894
stp4895
a((dp4896
g2
(lp4897
VYou could look into using the ZODB in combination with the included  implementation
p4898
aVWhat that gives is a mapping-like structure that writes individual entries separately to the object store
p4899
aVYou'd need to use savepoints or plain transactions to flush data out to the storage, but you can handle huge amounts of data this way
p4900
as(dp4901
g16
V100297
p4902
stp4903
a((dp4904
g2
(lp4905
VTry , with a try/except on :
p4906
aVWithout catching  it is the equivalent of , sorta-kinda
p4907
aVDo note that python will only execute the module code once (making this more a  or  statement
p4908
aVFunctions in the module can be called more than once, of course
p4909
as(dp4910
g16
V100297
p4911
stp4912
a((dp4913
g2
(lp4914
VBeautifulSoup works with Unicode internally; it'll try and decode non-unicode responses from UTF-8 by default
p4915
aVIt looks like the site you are trying to load is using a different encode; for example, it could be UTF-16 instead:
p4916
aVIt could be  too:
p4917
aVBut I have way too little information about what kind of site you are trying to load nor can I read the output of either encoding
p4918
aV:-)
p4919
aVYou'll need to decode the result of  before passing it to BeautifulSoup:
p4920
aVGenerally, the website will return what encoding was used in the headers, in the form of a  header (probably  or similar)
p4921
as(dp4922
g16
V100297
p4923
stp4924
a((dp4925
g2
(lp4926
VThe JSON was encoded twice, and the result of  is a string
p4927
aVStrings in python are sequences thus the first character is a
p4928
aVDecode the item again:
p4929
aVNow your main
p4930
aVpy output should look like:
p4931
aVand you can access the streams and format parameters by name:
p4932
aVPro tip: use the  module to format python structures nicely:
p4933
as(dp4934
g16
V100297
p4935
stp4936
a((dp4937
g2
(lp4938
VWhen using buildout we use  to produce JUnit-style XML output, perhaps it's source code or the module itself could be of help
p4939
as(dp4940
g16
V100297
p4941
stp4942
a((dp4943
g2
(lp4944
VThat is indeed rather messed up
p4945
aVA quick fix would be to replace the offending separators with a regular expression:
p4946
aVYou'll also need to remove the last comma:
p4947
aVWith these operations the example loads as json:
p4948
aVIt should handle nested mappings as well
p4949
aVThis does assume there are no escaped  quotes in the values themselves though
p4950
aVIf there are you'll need a parser anyway
p4951
as(dp4952
g16
V100297
p4953
stp4954
a((dp4955
g2
(lp4956
VSets are by definition not ordered:
p4957
aVA set object is an unordered collection of distinct hashable objects
p4958
aVYou want to use a list or tuple instead, and perhaps make your  objects sortable (implement a  method, or use an appropriate key function; see the Python sorting HOWTO)
p4959
as(dp4960
g16
V100297
p4961
stp4962
a((dp4963
g2
(lp4964
VThat package is part of the Spectral Python project
p4965
aVThe  method is documented here:
p4966
aVPerforms Gram-Schmidt Orthogonalization on a set of vectors
p4967
aVIt is installable via pip and easy_install
p4968
as(dp4969
g16
V100297
p4970
stp4971
a((dp4972
g2
(lp4973
VWhat an indexer does is to get the attribute directly from the object being indexed
p4974
aVIn Plone that is as special wrapper, one that will use registered indexers (as created with the  decorator) if they exist
p4975
aVHowever, if you index happens to index  and that is also an attribute on your  objects directly, any contained objects will have that attribute through acquisition as well
p4976
aVRegistering an indexer for  does not prevent this
p4977
aVThere are a few ways around this:
p4978
aVUse a different name for your indexer, one that doesn't match the attribute name
p4979
aVNote that if all you do is index an attribute the indexer is redundant though, the index could just as well retrieve the attribute directly
p4980
aVRegister a "catch all" indexer:
p4981
aVInstead of direct attribute access, now this indexer method will be used instead for Photos, causing the indexer to not register a value for
p4982
as(dp4983
g16
V100297
p4984
stp4985
a((dp4986
g2
(lp4987
VYour goal is to make your process manageable within memory constraints
p4988
aVTo be able to do this with the ZODB as a tool you need to understand how ZODB transactions work, and how to use them
p4989
aVWhy your ZODB grows so large
p4990
aVFirst of all you need to understand what a transaction commit does here, which also explains why your Data
p4991
aVfs is getting so large
p4992
aVThe ZODB writes data out per transaction, where any persistent object that has changed gets written to disk
p4993
aVThe important detail here is persistent object that has changed; the ZODB works in units of persistent objects
p4994
aVNot every python value is a persistent object
p4995
aVIf I define a straight-up python class, it will not be persistent, nor are any of the built-in python types such as int or list
p4996
aVOn the other hand, any class you define that inherits from  is a persistent object
p4997
aVThe  set of classes, as well as the  class you use in your code do inherit from
p4998
aVNow, on a transaction commit, any persistent object that has changed is written to disk as part of that transaction
p4999
aVSo any  object that has been append to will be written in it's entirety to disk
p5000
aVhandle this a little more efficient; they store Buckets, themselves persistent, which in turn hold the actually stored objects
p5001
aVSo for every few new nodes you create, a Bucket is written to the transaction, not the whole BTree structure
p5002
aVNote that because the items held in the tree are themselves persistent objects only references to them are stored in the Bucket records
p5003
aVNow, the ZODB writes transaction data by appending it to the  file, and it does not remove old data automatically
p5004
aVIt can construct the current state of the database by finding the most recent version of a given object from the store
p5005
aVThis is why your  is growing so much, you are writing out new versions of larger and larger  instances as transactions are committed
p5006
aVRemoving the old data is called packing, which is similar to the  command in PostgreSQL and other relational databases
p5007
aVSimply call the  method on the  variable to remove all old revisions, or use the  and  parameters of that method to set limits on how much history to retain, the first is a  timestamp (seconds since the epoch) before which you can pack, and  is the number of days in the past to retain from current time or  if specified
p5008
aVPacking should reduce your data file considerably as the partial lists in older transactions are removed
p5009
aVDo note that packing is an expensive operation and thus can take a while, depending on the size of your dataset
p5010
aVUsing transaction to manage memory
p5011
aVYou are trying to build a very large dataset, by using persistence to work around constraints with memory, and are using transactions to try and flush things to disk
p5012
aVNormally, however, using a transaction commit signals you have completed constructing your dataset, something you can use as one atomic whole
p5013
aVWhat you need to use here is a savepoint
p5014
aVSavepoints are essentially subtransactions, a point during the whole transaction where you can ask for data to be temporarily stored on disk
p5015
aVThey'll be made permanent when you commit the transaction
p5016
aVTo create a savepoint, call the  method on the transaction:
p5017
aVIn the above example I set the  flag to True, meaning: I do not intent to roll back to this savepoint; some storages do not support rolling back, and signalling you do not need this makes your code work in such situations
p5018
aVAlso note that the  happens when the whole data set has been processed, which is what a commit is supposed to achieve
p5019
aVOne thing a savepoint does, is call for a garbage collection of the ZODB caches, which means that any data not currently in use is removed from memory
p5020
aVNote the 'not currently in use' part there; if any of your code holds on to large values in a variable the data cannot be cleared from memory
p5021
aVAs far as I can determine from the code you've shown us, this looks fine
p5022
aVBut I do not know how your operations work or how you generate the nodes; be careful to avoid building complete lists in memory there when an iterator will do, or build large dictionaries where all your lists of lists are referenced, for example
p5023
aVYou can experiment a little as to where you create your savepoints; you could create one every time you've processed one , or only when done with a  loop like I've done above
p5024
aVYou are constructing a list per , so it would be kept in memory while looping over all the  anyway, and flushing to disk would probably only make sense once you've completed constructing it in full
p5025
aVIf, however, you find that you need to clear memory more often, you should consider using either a  class or a  class instead of a  to break up your data into more persistent objects
p5026
aVA  is ordered but not (easily) indexable, while a  could be used as a list by using simple incrementing index keys:
p5027
aVThe above code uses a BTree instead of a PersistentList and creates a savepoint every 100  processed
p5028
aVBecause the BTree uses buckets, which are persistent objects in themselves, the whole structure can be flushed to a savepoint more easily without having to stay in memory for all  to be processed
p5029
as(dp5030
g16
V100297
p5031
stp5032
a((dp5033
g2
(lp5034
VWhat kind of javascript
p5035
aVDynamically generated, or static
p5036
aVWhen static, just serve it like CSS and images, using a static view
p5037
aVIf dynamic, use a template to generate the javascript file and serve with the correct content type; here is an example using the Chameleon text renderer, but you can use your own preferred templating engine of course:
p5038
aVNote that I set the  attribute on the Response object to make sure browsers recognize your generated JavaScript
p5039
aVYour template then can access the values in the  you returned plus some additional system values, just like any other template
p5040
aVNote that best practice is to minimize the use of dynamic JavaScript, and to serve as much of it as possible statically
p5041
aVAny (dynamic) context information should really be included in the HTML you generate which your static JavaScript can then load and use
p5042
aVYour static JavaScript can then be cached by all your visitors, improving performance considerably
p5043
aVSee Chameleon templates for javascript files
p5044
aVfor some tips on how to achieve that
p5045
as(dp5046
g16
V100297
p5047
stp5048
a((dp5049
g2
(lp5050
VThe  method should return just that, unicode:
p5051
as(dp5052
g16
V100297
p5053
stp5054
a((dp5055
g2
(lp5056
VUse  instead of , most importantly in , here:
p5057
aVdoesn't create the whole list in memory, while range does, but you are not using the results after you iterated over them
p5058
aVAnother tip: just test for , there is no need to see if it is equal to , that is what  does
p5059
aV:-)
p5060
as(dp5061
g16
V100297
p5062
stp5063
a((dp5064
g2
(lp5065
VBrowsers use RSS feed auto-discovery and Atom feed auto-discovery to find feeds on a given web page
p5066
aVFor example, the django question lists are available via an Atom feed which is linked in the HTML header of the associated pages with:
p5067
aVYou'll need to parse out the  tags in a given page to discover these; anything with an  or  type fits
p5068
as(dp5069
g16
V100297
p5070
stp5071
a((dp5072
g2
(lp5073
VYou misplaced a closing parenthesis:
p5074
aVNote that the  group construct should include the  characters you are trying to match
p5075
aVIn your incorrect regular expression you define a group that doesn't include any matched characters, thus always the empty string
p5076
as(dp5077
g16
V100297
p5078
stp5079
a((dp5080
g2
(lp5081
VSimply list it as an attribute:
p5082
aVThis is the same way you'd create an alias of a function in a module; creating an alias of a method within a class body works the same
p5083
as(dp5084
g16
V100297
p5085
stp5086
a((dp5087
g2
(lp5088
VLinguaPlone would handle this case the same way: Make all content 'language neutral', except for where there is a translation
p5089
aVBy marking all your content 'language neutral', it'll be found and displayed to the end-user no matter what language preference has been set
p5090
aVNow, if any of your content does have a translsation, you do need to set English as the language for the original version so that it'll only be displayed when English is selected
p5091
aVTo do this, you probably can use a subscriber to the
p5092
aVAs for the creation of  and  locations for your content, that's the task of the  adapter (from , you can override that adapter to provide your own choices
p5093
aVSee the default implementations for how this currently works
p5094
as(dp5095
g16
V100297
p5096
stp5097
a((dp5098
g2
(lp5099
VYou can alter the way defaults are formatted by setting the  option
p5100
aVI'd subclass the HelpFormatter class to alter the way it formats your  values
p5101
aVThis class is officially an "implementation detail" but I doubt it'll change much with newer python versions
p5102
aVThe  method formats the  string and your subclass could override that:
p5103
aVAnother option is to not use the  argument for such a large range, and instead define a new argument type
p5104
aVThis is just a callable, passed a string, that raises ,  or  if the string cannot be converted to the target type, or the converted value otherwise:
p5105
aVYou can use this as the argument type like this:
p5106
aVand adjust your help message to indicate what values are acceptable
p5107
as(dp5108
g16
V100297
p5109
stp5110
a((dp5111
g2
(lp5112
VSo, for every contained dict, loop over it's items, and if the key starts with , delete the key from the dictionary, and store the value under a new key with the dash removed
p5113
aVDemo:
p5114
as(dp5115
g16
V100297
p5116
stp5117
a((dp5118
g2
(lp5119
VPyramid doesn't dictate how a locale should be negotiated
p5120
aVBasing your site language on the "Accept-Language" header can cause problems as most users do not know how to set their preferred browser languages
p5121
aVMake sure your users can switch languages easily and use a cookie to store that preference for future visits
p5122
aVYou either need to set a  key on the request (via an event handler, for example), or provide your own custom locale negotiator
p5123
aVHere's an example using the  event and the  header, which is an instance of the webob  class:
p5124
as(dp5125
g16
V100297
p5126
stp5127
a((dp5128
g2
(lp5129
VYou did not override the  method, so your  is a :
p5130
aVHere is a off-the-cuff version:
p5131
as(dp5132
g16
V100297
p5133
stp5134
a((dp5135
g2
(lp5136
VYou should use  instead; you can add a  keyword to select a specific control if there is ambiguity
p5137
aVIn your case, the  and  keywords should do
p5138
aVAlso note that a file control doesn't take a ; use  instead and pass in an open file object:
p5139
aVSee the documentation on forms in mechanize
p5140
as(dp5141
g16
V100297
p5142
stp5143
a((dp5144
g2
(lp5145
VYou need to send JSON in a POST, not URL encoded data:
p5146
as(dp5147
g16
V100297
p5148
stp5149
a((dp5150
g2
(lp5151
VWhat you posted in your question is called a "Traceback", and it shows only one error:
p5152
aVxml
p5153
aVetree
p5154
aVElementTree
p5155
aVParseError: not well-formed (invalid token): line 164, column 8
p5156
aVAll the lines before it show how python got there; in the file , on line 378 some code was executed (shown in the traceback), which then led to line 280 of the same file, where something else was called, etc
p5157
aVEvery time Python calls a function the current state is pushed onto the stack to make room for the next context, and when an exception occurs python can show you this stack to help you diagnose your problem
p5158
aVIn this case, you are trying to feed an XML document to the XML parser that has an error in it; by the time the parser gets to line 164, column 8, it found something it didn't expect
p5159
aVYou'll need to inspect that document to see what the problem is, it'll be around that area
p5160
as(dp5161
g16
V100297
p5162
stp5163
a((dp5164
g2
(lp5165
VYou can achieve this by using a  hook on a metaclass
p5166
aVDemo:
p5167
aVNote that we set the result of the  call straight onto the class, effectively caching it for future lookups
p5168
aVIf you need to regenerate the class method on every call instead, use the same method to bind a function to an instance but with the class and metaclass instead (using  to be consistent with metaclass subclassing:
p5169
aVFor static methods just return the function directly in all cases, no need to muck with the  decorator or
p5170
as(dp5171
g16
V100297
p5172
stp5173
a((dp5174
g2
(lp5175
VShuffling a list changes it in-place, and you are creating 3 references to the same list
p5176
aVCreate a copy of the list before shuffling:
p5177
aVI've simplified your loop as well; just use
p5178
aVOr, to place this in the context of your full method:
p5179
aVYou can further simplify the above by using a  to weed out dupes:
p5180
aVThis uses a tuple copy of the random genes list to fit the hashable constraint of set contents
p5181
aVYou can then even ensure that you return 2000 unique items regardless:
p5182
as(dp5183
g16
V100297
p5184
stp5185
a((dp5186
g2
(lp5187
VTake a look at the documentation for Distribute, it's a lot better
p5188
aVThe section you want to look at is Dynamic Discovery of Services and Plugins:
p5189
aVThe entry_points argument to setup() accepts either a string with
p5190
aVini-style sections, or a dictionary mapping entry point group names to either strings or lists of strings containing entry point specifiers
p5191
aVAn entry point specifier consists of a name and value, separated by an = sign
p5192
aVThe value consists of a dotted module name, optionally followed by a : and a dotted identifier naming an object within the module
p5193
aVAnother good explanation can be found on the  Hitchhiker\u2019s Guide to Packaging; there is a section dedicated to the entry_points feature:
p5194
aVEntry points are a Setuptools/Distribute feature that\u2019s really handy in one specific case: register something under a specific key in package A that package B can query for
p5195
as(dp5196
g16
V100297
p5197
stp5198
a((dp5199
g2
(lp5200
VAs long as the python program uses the  method from the logging module, then yes, you can alter logging configuration by editing a file
p5201
aVGenerally, the main function of a larger program would call it like this:
p5202
aVThe documentation on the file format is pretty comprehensive
p5203
as(dp5204
g16
V100297
p5205
stp5206
a((dp5207
g2
(lp5208
VThe codeintel libraries originate from the Komodo IDE, and and solutions that work for that IDE also work with SublimeCodeIntel
p5209
aVWhat you need are CIX (codeintel XML) files that describe the binary libraries in question
p5210
aVAnd as it happens, someone has created such files for PyQT4 and linked to them from a StackOverflow answer: Autocompletion not working with PyQT4 and PyKDE4 in most of the IDEs
p5211
aVThe Komodo team themselves have also generated such files, and provided a FAQ entry for them
p5212
aVThe trick, of course, is how to get SublimeCodeIntel to acknowledge these catalogs
p5213
aVAny CIX files placed in the  path should be loaded by the codeintel library
p5214
aVUsually this is located within your Sublime Packages directory, reachable from the  menu (look for )
p5215
aVI do not think there is any way to configure SublimeCodeIntel to look in additional paths for these
p5216
as(dp5217
g16
V100297
p5218
stp5219
a((dp5220
g2
(lp5221
VYou'll need to include the full path to the filenames you are trying to rename:
p5222
aVThe  function intelligently joins path elements into a whole, using the correct directory separator for your platform
p5223
as(dp5224
g16
V100297
p5225
stp5226
a((dp5227
g2
(lp5228
VI suspect you want to use collections
p5229
aVCounter; it let's you handle most counting use cases with ease
p5230
aVOutput:
p5231
aVOr, to format it a little for you:
p5232
aVOutput:
p5233
aVOr, to match your output exactly:
p5234
aVHere we sorted on the key (numbers 1 through 5)
p5235
as(dp5236
g16
V100297
p5237
stp5238
a((dp5239
g2
(lp5240
VPython C extension modules like  cannot be re-used between python versions
p5241
aVYou'll have to install the  module for 2
p5242
aV7 separately
p5243
aVGenerally, different python installations (such as 2
p5244
aV6 or 2
p5245
aV7, or 3
p5246
aV2) use separate module import locations, and you normally install extensions per python setup
p5247
as(dp5248
g16
V100297
p5249
stp5250
a((dp5251
g2
(lp5252
VMake sure to install pyserial with the included  script, or better still, use  or  to install the package for you
p5253
aVThe pyserial code base is written for python 2 but the 2to3 code translator will be run on the code base when installing with python 3
p5254
as(dp5255
g16
V100297
p5256
stp5257
a((dp5258
g2
(lp5259
VThere are currently two tal implementations for Java that I know of:
p5260
aVJava ZPT
p5261
aVJPT
p5262
as(dp5263
g16
V100297
p5264
stp5265
a((dp5266
g2
(lp5267
VYou can use  multiple times to define the various parts of your class string, then construct the actual attribute from those parts:
p5268
aVThis could result in an empty class attribute, which is harmless
p5269
aVAs for additional documentation; Chameleon is an implementation of TAL, originally developed for Zope Page Templates
p5270
aVAs such, you'll find a lot of documentation for the latter also applies to Chameleon, as long as you take into account that Chameleon's default TALES modus is , while ZPT defaults to  instead
p5271
aVThe Advanced Page Templates chapter of the Zope Book applies to Chameleon as well, for example
p5272
as(dp5273
g16
V100297
p5274
stp5275
a((dp5276
g2
(lp5277
VAll Chameleon versions work on Python 2
p5278
aV6
p5279
aVFrom the Chameleon documentation:
p5280
aVThe language used is page templates, originally a Zope invention, but available here as a standalone library that you can use in any script or application running Python 2
p5281
aV5 and up (including 3
p5282
aVx and pypy)
p5283
aVOn python 2
p5284
aV5 and 2
p5285
aV6 there are some dependencies you need:
p5286
aVThere are no required library dependencies on Python 2
p5287
aV7 and up
p5288
aVOn 2
p5289
aV5 and 2
p5290
aV6, the ordereddict and unittest2 packages are set as dependencies
p5291
aVA quick scan of the changelog shows that this support has been constant throughout the 2
p5292
aVx series of Chameleon, with minor compatibility fixes here and there, with 2
p5293
ag5279
aV2 fixing Python 3
p5294
aV3 support
p5295
aVJust use the latest version and you should be more than fine
p5296
as(dp5297
g16
V100297
p5298
stp5299
a((dp5300
g2
(lp5301
VPyramid and Chameleon and Jinja2 all support python 3 (see the Python 3 porting page on the Pyramid project wiki); your problem resides with  instead, I think
p5302
aVInstall either distribute or pip, which both work properly on Python 3
p5303
aVIf you still encounter errors when easy_installing packages, post those as new questions here on SO to see if we can help you
p5304
aVDo note that many instrumental packages you may need for your web application may not yet have been ported to python 3 (or have python 3 counterparts), and thus it may be a good idea to stay on python 2
p5305
aV7 for a little while yet
p5306
as(dp5307
g16
V100297
p5308
stp5309
a((dp5310
g2
(lp5311
V is a dict (or dict-like) object, so you can just use  with a default value:
p5312
as(dp5313
g16
V100297
p5314
stp5315
a((dp5316
g2
(lp5317
VLet's take a look at what your code does; all you have to do to use macros outside of pyramid is to replicate this
p5318
aVWhen you call  in pyramid, you are essentially retrieving a  instance with the correct template path loaded
p5319
aVThe  event let's you modify the dict response from a view, and in your  event handler you add a new entry named
p5320
aVCombine these two to get the same effect in your own code, passing in a  macro template when calling your  template:
p5321
aVThat's all there is to it, really
p5322
as(dp5323
g16
V100297
p5324
stp5325
a((dp5326
g2
(lp5327
VThe main top-level data structure of the JSON data you linked has only one  key, so it should be trivial to get this information:
p5328
aVYou can use the  function to get a quick feel of the data structure:
p5329
aVYou can then see that the other  entries are part of the  ->  structure, which is a list:
p5330
as(dp5331
g16
V100297
p5332
stp5333
a((dp5334
g2
(lp5335
V from collections is your friend:
p5336
as(dp5337
g16
V100297
p5338
stp5339
a((dp5340
g2
(lp5341
VLet's pass in iterators and see what happens:
p5342
aVConclusion: you need to turn the arguments into tuples to capture all the values of the iterators
p5343
aVIt is even easier to illustrate when using only one iterator and the repeat option:
p5344
as(dp5345
g16
V100297
p5346
stp5347
a((dp5348
g2
(lp5349
VWhat happens if the user provides you with a CSV file with fewer columns
p5350
aVAre default values used instead
p5351
aVIf so, why not extend the row with null values instead
p5352
aVNow bar and baz will at least be  and the exception handler will take care of any rows longer than 3 items
p5353
as(dp5354
g16
V100297
p5355
stp5356
a((dp5357
g2
(lp5358
VYou can test for the other variables in your property method and use them as part of a cache key:
p5359
aVNow you defer calculation until you actually need the expensive value and var1 or var2 have changed
p5360
as(dp5361
g16
V100297
p5362
stp5363
a((dp5364
g2
(lp5365
VI think you are misunderstanding how string formatting works
p5366
aVYou need to put the address and query together still:
p5367
as(dp5368
g16
V100297
p5369
stp5370
a((dp5371
g2
(lp5372
VThe join method works the other way around; call it on the space string:
p5373
aVIt works on any sequence, so there is no need to convert tuples to lists here
p5374
aVNote that you can dispense with the  tests for your columns; the empty string is considered boolean False as well:
p5375
aVFinally, because you are already iterating over the wordlist, just leave it a generator and dispense with the list call altogether
p5376
as(dp5377
g16
V100297
p5378
stp5379
a((dp5380
g2
(lp5381
VAdd sentinels, then limit the list to 3 elements:
p5382
aVNow a, b and c are at the very least set to None, and if the number of items is more than three only the first three values are used
p5383
aVDemo:
p5384
aVIf you need at least 2 elements, use fewer None values and catch ValueError:
p5385
as(dp5386
g16
V100297
p5387
stp5388
a((dp5389
g2
(lp5390
VUse sets or key views (python 2
p5391
aV7):
p5392
aVBefore 2
p5393
aV7:
p5394
aVIn python 3, you can use the  method for such operations directly, as they are implemented as views:
p5395
aVDemo (python 2
p5396
aV7):
p5397
aVThe  operator on either two sets or on a dict view creates the intersection of both sets; all keys that are present in both sets
p5398
aVBy using an intersection of the keys, this code will work even if either dictA or dictB has keys that do not appear in the other dictionary
p5399
aVIf you are absolutely sure the keys will always match, you could just iterate over either dict directly without the intersection:
p5400
as(dp5401
g16
V100297
p5402
stp5403
a((dp5404
g2
(lp5405
VThe  module's functions are implemented in C:
p5406
aVIt provides access to the mathematical functions defined by the C standard
p5407
aVBy using an efficient algorithm in C, you get fast results
p5408
aVIf you are asking why this particular operation is so fast, then see Why is math
p5409
aVfactorial much slower in Python 2
p5410
aVx than 3
p5411
ag1205
aVand the C code itself
p5412
as(dp5413
g16
V100297
p5414
stp5415
a((dp5416
g2
(lp5417
VBuildout doesn't know about anything , as that's a Debian and Ubuntu specific addition to Python
p5418
aVIf buildout doesn't exclude it when you exclude , then is not the only package to have this 'problem'; virtualenv doesn't know about it either, see Ubuntu + virtualenv = a mess
p5419
aVvirtualenv hates dist-packages, wants site-packages
p5420
aVFeel free to file an issue in the buildout issue tracker to request that dist-packages is included when ignoring site-packages
p5421
aVNote that on my Debian system however, the  directory is being excluded
p5422
aVBuildout normally determines what the  directories are by determining the difference between the following two commands:
p5423
aVand
p5424
aVIf the latter still includes the  directory for you, then I'd classify this as a Ubuntu or Debian bug
p5425
aVOn Debian 6
p5426
ag2391
aV5, with zc
p5427
aVbuildout 1
p5428
ag2176
aV2 that path is not included
p5429
aVThe  directory is normally added via the  module (which the  switch above disables)
p5430
aVDebian and Ubuntu have patched that module
p5431
as(dp5432
g16
V100297
p5433
stp5434
a((dp5435
g2
(lp5436
VYou will loose a large chunk of your module search path when you do this:
p5437
aVDepending on your system, that can have major consequences as to what modules are available
p5438
aVOther things that may break are the locale (set to the system default by site
p5439
aVpy) and, on windows, some codecs will not be available (they are aliased by site
p5440
aVpy)
p5441
as(dp5442
g16
V100297
p5443
stp5444
a((dp5445
g2
(lp5446
VHere's a start: http://wiki
p5447
aVzope
p5448
aVorg/zope2/TestLayersHowTo/
p5449
aVYou are looking for test layers; setUp and tearDown for a group of tests, so you can set up your test fixtures for more than one test at a time
p5450
aVTest layers also let you create layers of test fixtures; one layer depending on another
p5451
as(dp5452
g16
V100297
p5453
stp5454
a((dp5455
g2
(lp5456
VYou are confusing 'strongly typed' with 'dynamically typed'
p5457
aVI cannot change the type of  by adding the string , but I can choose what types I store in a variable and change that during the program's run time
p5458
aVThe opposite of dynamic typing is static typing; the declaration of variable types doesn't change during the lifetime of a program
p5459
aVThe opposite of strong typing is weak typing; the type of values can change during the lifetime of a program
p5460
as(dp5461
g16
V100297
p5462
stp5463
a((dp5464
g2
(lp5465
VLook at:
p5466
aVHere you have several statements that always evaluate to True; each of  is a a non-empty string
p5467
aVIt doesn't matter what values  or  have
p5468
aVThis means python sees that line as the equivalent of
p5469
aVWhat you want to do instead is use the  operator to test if your  is part of a list of options:
p5470
aVThe same problem applies to your  statement
p5471
as(dp5472
g16
V100297
p5473
stp5474
a((dp5475
g2
(lp5476
VI strongly recommend you follow the Pyramid SQLAlchemy tutorial
p5477
aVIt teaches you how to use SQLAlchemy with Pyramid in a simple Wiki application
p5478
aVYou'll note that tutorial a  module is created which defines a  item
p5479
aVThis gives you access to the SQLAlchemy session, scoped to a Pyramid thread and tied to the Pyramid transaction model, and which is imported whenever you need the session:
p5480
aVIn  the DBSession variable is defined as follows:
p5481
aVNote the ; Pyramid automatically starts a new transaction with each request, committing it on successful responses, aborting it when an exception occurs
p5482
aVThis relieves you of most transaction handling duties
p5483
aVJust remember to  your session when you need to see updates to the database (such as auto-incrementing primary keys)
p5484
aVAgain, the tutorial expands on all this and more
p5485
as(dp5486
g16
V100297
p5487
stp5488
a((dp5489
g2
(lp5490
VAre you certain it's not the sorting that's killing your memory
p5491
aVNote that I'd expect that each PersistentList has to fit into memory; it is one persistent record so it'll be loaded as a whole on access
p5492
aVI'd modify your code to run like this and see what happens:
p5493
aVNow you process the whole list in one go and sort it; after all, it's already loaded into memory in one
p5494
aVAfter processing, you tell the ZODB you are done with this stage and the whole changed list will be flushed to temporary storage
p5495
aVThere is little point flushing it when only half-way done
p5496
aVIf this still doesn't fit into memory for you, you'll need to rethink your data structure and split up the large lists into smaller persistent records so you can work on chunks of it at a time without loading the whole thing in one
p5497
as(dp5498
g16
V100297
p5499
stp5500
a((dp5501
g2
(lp5502
VATContentTypes registeres a  validator:
p5503
aVwhere  defaults to "no limit" but you can alter that by copying  to  and setting the  parameter:
p5504
aV(the format supports  as well, but the default file doesn't include that in the list)
p5505
aVIf you have custom File fields (the above only applies to the default Archetypes ATFile schema), you can either re-use that validator or create your own
p5506
aVTo reuse the above validator, simply add it to the  attribute:
p5507
aVTo use a different maximum size that you configure independently, use the same  that ATContentTypes uses and register it under a new name, then use that validator instead of the  validator; the value you specify is the number of mebibytes (10242 bytes):
p5508
as(dp5509
g16
V100297
p5510
stp5511
a((dp5512
g2
(lp5513
VI recently coded up an extension to quodlibet capturing multimedia keys; for your setup the same process applies
p5514
aVI used the Quartz  hook and event loop, and the Cocoa AppKit framework to decipher key codes to achieve this
p5515
aVThe following code registers a python callback which is passed global key presses, and starts the event loop:
p5516
aVI defined a tap for system defined keys only (media keys); you'll have to specify a different event mask ( with one or more Event Types); e
p5517
ag1298
aVfor key up events
p5518
aVThe callback should have the following signature (it implements the  method from the Quartz API:
p5519
aVI converted the Quartz event into a , because all the information I could find on Mac multimedia keys was referring to that class
p5520
aVIn principle you can achieve the same thing with the AppKit APIs too, but then your Python application is treated as a Mac Application (visible in the Dock with an icon and everything), while I wanted this to be kept in the background altogether
p5521
as(dp5522
g16
V100297
p5523
stp5524
a((dp5525
g2
(lp5526
VThe spaces in the filenames are not the problem;  returns filenames, not full paths
p5527
aVYou'll need to add them to your filenames to test them;  will do this for you with the correct directory separator for your platform:
p5528
aVNote that I also simplified your filename tests; instead of using  I use the  operator
p5529
as(dp5530
g16
V100297
p5531
stp5532
a((dp5533
g2
(lp5534
VThe  function is a decorator itself, and like most decorators, they need to be applied to functions only
p5535
aVLuckily, class methods are basically functions that are bound to an instance when an instance is created
p5536
aVThus, you can apply your decorator to any class method by putting it in the class definition by the methods themselves:
p5537
aVIf you use python 2
p5538
aV6 or up, you can also create a class decorator and apply the  decorator to all methods on any given class
p5539
aVYou'd apply it by placing the decorator right before the class definition:
p5540
aVSuch a decorator could look something like this:
p5541
aVThis decorator only applies the  wrapper to direct methods, not any inherited from the base class
p5542
as(dp5543
g16
V100297
p5544
stp5545
a((dp5546
g2
(lp5547
VYou must open your files as binary:
p5548
aVNote the  mode there; otherwise the file could be opened with native line endings, and the CSV reader doesn't handle the various forms very well
p5549
aVCertainly the copy of  that I downloaded has clean  line endings
p5550
aVThis is documented for the
p5551
aVreader() method:
p5552
aVIf csvfile is a file object, it must be opened with the \u2018b\u2019 flag on platforms where that makes a difference
p5553
aVIf, however, your csv file is so corrupted as to still contain unexpected newline characters in unexpected places, use this  subclass instead as a stop-gap measure:
p5554
aVThis class guarantees there will be no newlines anywhere in the returned results except as the very last character (just the way the csv module wants it)
p5555
aVUse it instead of the  call; the  mode modifier becomes optional in this case:
p5556
as(dp5557
g16
V100297
p5558
stp5559
a((dp5560
g2
(lp5561
VThe  method has a handy  keyword argument, that let's you specify a function to call to determine on what information a list should be sorted
p5562
aVSorting your lists is as easy as writing a function that returns the float value contained in each sub list:
p5563
aVNote that I simply return a  of all the float values; much easier than having to return just one
p5564
aVThis'll work even if there are 0 float values in the sublist
p5565
aVSort your list like this:
p5566
aVI've cloned your example and updated it with the above method: http://ideone
p5567
aVcom/u8ufK
p5568
aVOutput generated:
p5569
aVNote that the  method sorts the list in-place
p5570
aVYou can also use the  function to generate a new list that has been sorted; it takes the same argument:
p5571
aVbut note that in-place sorting is always faster
p5572
as(dp5573
g16
V100297
p5574
stp5575
a((dp5576
g2
(lp5577
VUse the  method to merge dicts:
p5578
aVNote that if a key is repeated across different invocations of  that the value stored in  in the end will be the last one returned for that key
p5579
aVIf you don't mind that your values are stored as lists; you'll have to merge your dicts manually with the values appended one by one to a defaultdict:
p5580
aVNow your  dict will contain a list for each key, with the various values collected together
p5581
aVYou could use a set as well, use  and  instead
p5582
as(dp5583
g16
V100297
p5584
stp5585
a((dp5586
g2
(lp5587
VFiles in python have a "current position"; it starts at the beginning of the file (position 0), then, as you read the file, the current position pointer moves along until it reaches the end
p5588
aVYou'll need to put that pointer back to the beginning before the lxml parser can read the contents in full
p5589
aVUse the  method for that:
p5590
aVYou only need to do this if you need  somewhere else too; you could alternatively pass it into the  method if wrapped in a  object to provide the necessary file object methods:
p5591
aVIf you are not using  for anything else, then you do not need the extra  call either, and subsequently won't have problems parsing it with lxml; just omit the call altogether, and you won't need to move the current position pointer back to the start either:
p5592
aVTo learn more about  (and it's counterpart, ), read up on file objects in the Python tutorial
p5593
as(dp5594
g16
V100297
p5595
stp5596
a((dp5597
g2
(lp5598
VUse the  module instead; it's  can easily meet your needs and more
p5599
as(dp5600
g16
V100297
p5601
stp5602
a((dp5603
g2
(lp5604
VPython converts the result of the whole expression to a string before printing, not individual items
p5605
aVConvert your object instance to a string before concatenating:
p5606
aVPython is a strongly typed language and won't convert items to strings automatically when using operators like the '+' sign
p5607
as(dp5608
g16
V100297
p5609
stp5610
a((dp5611
g2
(lp5612
VYou are constructing strings in  and storing them in ; store a list instead:
p5613
as(dp5614
g16
V100297
p5615
stp5616
a((dp5617
g2
(lp5618
VEasy enough:
p5619
aVThis matches only for strings that are exactly 32 hexadecimal characters, provided you use the  method (searches from the start of the string, see  vs
p5620
ag2858
aVThe  matches the end of the string (vs
p5621
aVwhich would match at the end of a string or a newline)
p5622
as(dp5623
g16
V100297
p5624
stp5625
a((dp5626
g2
(lp5627
VWith  you can specify the number of times a pattern can repeat, and the  character class matches all digits
p5628
aVThe  character class matches anything that is not whitespace
p5629
aVUsing these your regular expression can be simplified to:
p5630
aVNote also the  anchor, making the  expression match all the way to the end of the string
p5631
aVNo whitespace (newlines, tabs, etc
p5632
aVare allowed here
p5633
aVIf you combine this with the  method you assure that all characters in your tested string conform to the pattern, nothing more, nothing less
p5634
aVSee  vs
p5635
aVfor more information on
p5636
aVA small demonstration:
p5637
as(dp5638
g16
V100297
p5639
stp5640
a((dp5641
g2
(lp5642
VThe simplest method would be to generate your 'common' information in one method, returning a dict, then updating your local view dict with that information
p5643
aVAnother method is to use something like the  (documentation now located at a new location), where you delegate the rendering of common 'snippets' of your pages to separate views
p5644
aVOne such view could take care of the common user information you want to render, and be reused everywhere
p5645
as(dp5646
g16
V100297
p5647
stp5648
a((dp5649
g2
(lp5650
VBecause Plone is a server built with Python, there is no special  command
p5651
aVPresumably you used the Plone Unified installer, creating a ZEO installation
p5652
aVBecause it was installed in  I am also assuming you installed it as root
p5653
aVInformation on how to run Plone after installation is found on the Installation Quick Guide (under "Last steps"); you simply run the command , or, with your full path:
p5654
aVIf you are not logged in as root still, you'll need to run that command with ; the server will automatically switch to the dedicated  user installed by the Unified Installer
p5655
as(dp5656
g16
V100297
p5657
stp5658
a((dp5659
g2
(lp5660
VYou'll need to poll the backend from the browser periodically to see if there are any updates
p5661
aVThis does assume that the long-running script is running asynchronously
p5662
aVThe periodic update is akin to a log file tail, once in a while you check if new information has been added to the log
p5663
aVThere are several existing jQuery plugins that'll help you build this; PeriodicalUpdater for jQuery is a nice one, in that it'll adjust the poll interval if the server response doesn't change in a while
p5664
aVBasically, with such a plugin, you'll need a Django view that returns the current status, the log file output of your process so to speak, and have PeriodicalUpdater poll that view
p5665
aVIn the callback function for PeriodicalUpdater you'll need to add a check that the process is complete, of course; perhaps your server view could end with an easy to detect "Process complete" line at the end of the "log", or return a response that only consists of the final status
p5666
as(dp5667
g16
V100297
p5668
stp5669
a((dp5670
g2
(lp5671
VThe python default operator methods ( and such) are hard-wired; python will look for them because the operator implementations look for them
p5672
aVHowever, there is nothing stopping you from defining a  function that does the same thing; look for  or  on the objects passed to it:
p5673
as(dp5674
g16
V100297
p5675
stp5676
a((dp5677
g2
(lp5678
VYou are not supposed to care; the typical case is that your waiting thread checks some shared state until that state matches some condition
p5679
aVThe documentation example is thus:
p5680
aVand the documentation also states:
p5681
aV[\u2026] threads that are interested in a particular change of state call wait() repeatedly until they see the desired state
p5682
aVIf you do have a pressing need to distinguish between a timeout and a signal, you'll need to use  objects instead; the  call on an  object returns  if the flag wasn't set (which only happens when the timeout was reached)
p5683
as(dp5684
g16
V100297
p5685
stp5686
a((dp5687
g2
(lp5688
VFrom the command line help ():
p5689
aVtail [-f]  [stdout|stderr] (default stdout)
p5690
aVEx:
p5691
aVtail -f           Continuous tail of named process stdout
p5692
aVCtrl-C to exit
p5693
aVtail -100         last 100 *bytes* of process stdout
p5694
aVtail  stderr      last 1600 *bytes* of process stderr
p5695
aVSo by default, the  command tails the process stdout
p5696
aVIf you need to get the full log, the  option of the  section determines where that is stored; there is a  option as well
p5697
aVIf that option is not set or set to , a logfile will be created when the process starts, but cleaned up whenever supervisord restarts
p5698
aVThis file is created in the directory set by the   option (which is your platform's  directory by default), and have a generated filename of the form , e
p5699
ag1298
aVThus, if you want to access the whole stdout log, you need to at the very least set the  option to a fixed directory to save you from having to search for the right temporary directory
p5700
as(dp5701
g16
V100297
p5702
stp5703
a((dp5704
g2
(lp5705
VTo replace parts of a python list, you can use slice assignment:
p5706
aVYou can use slice assignment to replace any part of a list, including insertion of lists where you do not replace existing elements:
p5707
aVHere the  slice selects an empty part of  and "replaces" it with the new elements
p5708
as(dp5709
g16
V100297
p5710
stp5711
a((dp5712
g2
(lp5713
VUse slice assignment:
p5714
aVor using local variables to add your  only once:
p5715
aVYou may want to store the upper bound as non-inclusive, to play better with python and avoid all the  counts
p5716
aVDemo:
p5717
as(dp5718
g16
V100297
p5719
stp5720
a((dp5721
g2
(lp5722
VIt is not a real problem, unless you use the  transform (nothing in stock Plone uses it, and other transforms provide  to  too)
p5723
aVYou have two options to deal with it:
p5724
aVRemove the  transform
p5725
aVGo to the ZMI, find the  tool, check the box by the  entry, and hit the  button at the bottom of the form
p5726
aVThis is harmless if you don't use the transform
p5727
aVInstall the  command
p5728
aVshould do
p5729
as(dp5730
g16
V100297
p5731
stp5732
a((dp5733
g2
(lp5734
VThe  module sets up your python module search path and some other things
p5735
aVIt is somewhat crucial to the normal operation of python
p5736
aVYou can download a new copy from the python source repository:
p5737
aVFor python 2
p5738
ag4892
aVFor python 3
p5739
aV2
p5740
aVFor other python versions, generally the URL is  for the correct tagged version, then select the  link in the left-hand menu
p5741
aVIf you installed python from a linux distribution package on Ubuntu or Debian, then this file has been customized and you'll need to re-install the appropriate python-minimal package
p5742
as(dp5743
g16
V100297
p5744
stp5745
a((dp5746
g2
(lp5747
VYou are trying to mix Python code and SQL; your Vertica server is trying to interpret the  information as a SQL schema, and it fails
p5748
aVUse parameters instead:
p5749
as(dp5750
g16
V100297
p5751
stp5752
a((dp5753
g2
(lp5754
VThe  escape matches at word boundaries, but the $ sign is not considered part of word you can match
p5755
aVMatch on the start or spaces instead:
p5756
aVI've used a backslash escape for the dollar here instead of a character class, and the  word character class with a minimum of 1 character to better reflect your intent
p5757
aVDemo:
p5758
as(dp5759
g16
V100297
p5760
stp5761
a((dp5762
g2
(lp5763
VThis is standard behaviour; supervisord does not detect changes in code
p5764
aVIt only restarts processes if they themselves stop or die
p5765
aVJust instruct supervisord to restart the application whenever you push changes
p5766
aVis fine, no need to kill and restart supervisord itself
p5767
aVIf the supervisord configuration changed, use
p5768
as(dp5769
g16
V100297
p5770
stp5771
a((dp5772
g2
(lp5773
VNope, we are still stuck with this syntax
p5774
aVThey cannot be converted to decorators so easily because they are a class-level declaration, not actually attached to the methods
p5775
aVYou'd need to play nasty tricks with the calling frame to get back to the class declaration and the  object to make this work
p5776
aVThus, there is a step where the  object is processed to turn the declarations into class attributes that Zope2 recognizes; this step is these days automatically taken care of by the archetypes  call
p5777
as(dp5778
g16
V100297
p5779
stp5780
a((dp5781
g2
(lp5782
VMore than one page is checked for possible downloadable targets
p5783
aVIf one of those is down or generates an error you get to see this warning
p5784
aVBut it's only a warning, you'll get a proper error if things really go south
p5785
aVThe warning is issued to let you know setuptools may have selected a different version of a package than it would otherwise have; it collects a list of versions for the package from pypi and pages linked from there, and one of those pages timing out could mean a "better" version was not selected this time
p5786
aVIn other words: don't worry, status-by-design
p5787
as(dp5788
g16
V100297
p5789
stp5790
a((dp5791
g2
(lp5792
VYou are getting an , which means that  has no  attribute as it has become , not that  has no  key, that'd be a  instead
p5793
aVClearly we are missing some code here, where  is set to `None
p5794
aVYou are not printing the result of your  calls, so there is nothing in your code (as shared with us here) that prints
p5795
aVThe  calls could be working fine for all we know
p5796
aVReading between the lines and speculating a little, you are assigning the result of  back to , and your XPath expression didn't match anything and returned None
p5797
aVThe next time into the loop, you now have  instead of an , so the  call fails with an
p5798
as(dp5799
g16
V100297
p5800
stp5801
a((dp5802
g2
(lp5803
VUse the  module instead; it outputs valid JavaScript expressions after all
p5804
aVJSON (JavaScript Object Notation) is a subset of JavaScript syntax (ECMA-262 3rd edition) [\u2026]
p5805
aVQuick example:
p5806
aVPut that straight into your template
p5807
aVI use this all the time to put valid JavaScript data structures into my generated web pages all the time
p5808
as(dp5809
g16
V100297
p5810
stp5811
a((dp5812
g2
(lp5813
VThe  URL leads to a FTP directory, not an HTML page
p5814
aVYour browser could generate HTML based on the FTP directory contents, but the server does not send you HTML when you load that resource with
p5815
aVYou probably want to use the  module directly instead to read the directory listing, or inspect the return value of  first
p5816
as(dp5817
g16
V100297
p5818
stp5819
a((dp5820
g2
(lp5821
VWhen an attribute listed in  is set to None, the attribute is omitted:
p5822
aVThe same applies to a path expression to a non-existing object:
p5823
aVNow the  attribute will only be set if there is a title key or attribute on item
p5824
aVNote that if  resolves to , the attribute is omitted as well
p5825
aVFrom the TALES 1
p5826
aV4 specification,  section:
p5827
aVIf the expression associated with an attribute assignment evaluates to nothing, then that attribute is deleted from the statement element
p5828
aVWhere python  is interpreted as "nothing"
p5829
as(dp5830
g16
V100297
p5831
stp5832
a((dp5833
g2
(lp5834
VI suspect there is so little data transferred that the speed results are skewed by the connection handshake and python execution times
p5835
aVYou are not just measuring throughput but the full round-trip time in your code
p5836
as(dp5837
g16
V100297
p5838
stp5839
a((dp5840
g2
(lp5841
VThis is not a Plone-only problem
p5842
aVPython uses OpenSSL for the  module, and the OpenSSL libraries on your system do not provide functions that it needs
p5843
aVNormally the sha256, sha384 and sha512 algorithms are supposed to be present by default but they are not on your system, and/or python is being linked to the wrong system libraries
p5844
aVHow to solve this depends on your OS, for which you didn't provide any details
p5845
aVYou could check the list of requirements for the installer and doublecheck you have everything you need
p5846
as(dp5847
g16
V100297
p5848
stp5849
a((dp5850
g2
(lp5851
VUnfortunately,  up to version 1
p5852
ag2176
aV2 doesn't support this use-case
p5853
aVEither the addition or the subtraction will succeed
p5854
aVWhat happens internally is this:
p5855
aVFor each key, value pair defined in the inheriting section:
p5856
aVIf the key is using , take the inherited value, add things, and store it as the new value
p5857
aVIf the key is using , take the inherited value, remove things, and store it as the new value
p5858
aVAfter these updates the inherited section is copied, updated with the new values and this is used as the final result
p5859
aVThe ordering is defined by the usual python mapping semantics, thus undefined; either the addition or the subtraction runs last
p5860
aVBecause both operations take their input from the inherited section, modify it, then store it as the new value, the operation that runs last overwrites the result of the operation that ran before
p5861
aVI've committed a fix for this; I don't have rights to release a new version of  to pypi though, I'll have to poke those who do
p5862
aVEdit:  version 1
p5863
aV6 contains this fix
p5864
as(dp5865
g16
V100297
p5866
stp5867
a((dp5868
g2
(lp5869
VThere is no support for arbitrary length unpacks (the  operator)
p5870
aVYou'll have to specify a repeater manually
p5871
aVLuckily the struct module does let you specify a fixed length, and the hashlib module tells you how many bytes to expect
p5872
aVBy putting an integer number before the  you specify the number of times to apply the pattern
p5873
aVAnd a specific hash in the  library has a  attribute that tells you how many bytes long a specific hash is
p5874
aVTo combine these:
p5875
aVIf you don't even want to hardcode the  there, you can ask  for the size of an  unsigned long as well:
p5876
aVIn fact, on 64 bit platforms like my Mac,  is 8 bytes, so the latter calculation matters enormously if you are deploying across different architectures
p5877
as(dp5878
g16
V100297
p5879
stp5880
a((dp5881
g2
(lp5882
VYou are not passing the Render method UTF-8; you are passing it a unicode literal
p5883
aVYou'll need to encode it to UTF-8:
p5884
aVI can heartily recommend you read this article on the subject of Unicode and encodings to help understand the difference
p5885
as(dp5886
g16
V100297
p5887
stp5888
a((dp5889
g2
(lp5890
VThe server you are calling is telling you that the POST method is not allowed for the URL you are trying to call
p5891
aVBy passing in the path portion of your URL as the  object data parameter you are making this a POST instead of a GET
p5892
aVI suspect you wanted to send a GET request instead:
p5893
as(dp5894
g16
V100297
p5895
stp5896
a((dp5897
g2
(lp5898
VVery simple:
p5899
aVParts are the building blocks of your buildout
p5900
aVDifferent parts run different tasks, based on the recipe that is declared for them and the settings configured in that part
p5901
aVThe  subdirectory hold the bookkeeping information for each part
p5902
aVIt depends on the recipe what is stored here
p5903
aVA CMMI recipe might install the result of the config/make/make install cycle here, for example
p5904
aVEggs are python package distributions
p5905
aVBuildout uses code from eggs to provide recipe implementations, and most buildouts specify eggs for parts to use in the applications and scripts being built
p5906
aVIt is perfectly legal to have a buildout that doesn't build anything that uses eggs itself
p5907
aVBut for buildout to run the parts, eggs are going to be involved, under the hood
p5908
aVThe  subdirectory usually holds the eggs used for both recipes and anything that requires eggs to run
p5909
as(dp5910
g16
V100297
p5911
stp5912
a((dp5913
g2
(lp5914
VLook at:
p5915
aVHere you have several statements that always evaluate to True; each of 'internet' or 'Chrome' or 'Google chrome' is a a non-empty string
p5916
aVIt doesn't matter what values  has
p5917
aVThis means python sees that line as the equivalent of if something or True
p5918
aVWhat you want to do instead is use the  operator to test if  is one of several options:
p5919
aVNote that I lowercased all options in the list to test; after all, you lowercase your input as well, so it'll never match "Chrome"; it'll be "chrome" or something else
p5920
aVThe same applies to your  line
p5921
as(dp5922
g16
V100297
p5923
stp5924
a((dp5925
g2
(lp5926
VIt is the bitwise shift-to-right operator
p5927
aVIt shifts the bits of the integer argument to the right by the number on the right-hand side of the expression:
p5928
aVor illustrated in binary:
p5929
aVYour code example is actually doubly confusing as it mixes arithmetic and bitwise operations
p5930
aVIt should use the '//' integer division operation instead:
p5931
as(dp5932
g16
V100297
p5933
stp5934
a((dp5935
g2
(lp5936
VAll your arguments are positional, you don't need to use keywords at all:
p5937
aVI think you are confusing local variables (what you pass into the function) and the argument names of the function
p5938
aVThey happen to match in your code, but there is no requirement that they do match
p5939
aVThe following code would have the same effect as your first example:
p5940
aVIf you do want to use keyword arguments, that's fine, but they cannot be followed by positional arguments
p5941
aVYou can then alter the ordering and python will still match them up:
p5942
aVHere I moved  to the front of the keyword arguments, but Python will still match it to the last argument of the  method
p5943
as(dp5944
g16
V100297
p5945
stp5946
a((dp5947
g2
(lp5948
VI don't think this was ever meant to work; I don't recall covering the use case when developing Reflecto in any case
p5949
aVI haven't touched the product in years though, and I didn't do any more than glance at the code base to remind myself
p5950
aVWhat I suspect in your test case is that the sharing information is set (via acquisition) on the reflector object, but the directory proxy for baz is being reindexed
p5951
aVIf you were to reindex the reflector the sharing settings would no longer be ignored
p5952
aVIf so, then the presence of the sharing tab on the directory proxies is the real bug here
p5953
as(dp5954
g16
V100297
p5955
stp5956
a((dp5957
g2
(lp5958
VNope, BeautifulSoup, by itself, does not support XPath expressions
p5959
aVAn alternative library, lxml, does support XPath 1
p5960
ag2391
aVIt has a BeautifulSoup compatible mode where it'll try and parse broken HTML the way Soup does
p5961
aVHowever, the default lxml HTML parser does just as good a job of parsing broken HTML, and I believe is faster
p5962
aVOnce you've parsed your document into an lxml tree, you can use the  method to search for elements
p5963
aVOf possible interest to you is the CSS Selector support; the  class translates CSS statements into XPath expressions, making your search for  that much easier:
p5964
aVComing full circle: BeautifulSoup itself does have pretty decent CSS selector support:
p5965
as(dp5966
g16
V100297
p5967
stp5968
a((dp5969
g2
(lp5970
VFrom the python design FAQ:
p5971
aVThe reason for not allowing assignment in Python expressions is a common, hard-to-find bug in those other languages, caused by this construct:
p5972
aVThe error is a simple typo: x = 0, which assigns 0 to the variable x, was written while the comparison x == 0 is certainly what was intended
p5973
aVAs explained in the FAQ, most "use cases" for using assignment in an expression can be covered by using iterators instead
p5974
as(dp5975
g16
V100297
p5976
stp5977
a((dp5978
g2
(lp5979
VYup, this can be done
p5980
aVIn python strings are sequences so you can slice up your rows into columns using fixed indices:
p5981
aVNow all you have to do is pick your columns:
p5982
aVI can imagine that the above code looks like gibberish to you still though; I strongly recommend you start reading up on learning to program
p5983
aVPython is an excellent language to begin with, start with http://wiki
p5984
aVpython
p5985
aVorg/moin/BeginnersGuide and work your way up from there
p5986
as(dp5987
g16
V100297
p5988
stp5989
a((dp5990
g2
(lp5991
VNo, SQL doesn't provide you with any syntax to do such a select
p5992
aVWhat you can do is ask MySQL for a list of column names first, then generate the SQL query from that information
p5993
aVlet's you select the column names
p5994
aVThen you can do, in Python:
p5995
aVInstead of using string concatenation, I would recommend using SQLAlchemy instead to do the SQL generating for you
p5996
aVHowever, if all you are doing is limit the number of columns there is no need to do a dynamic query like this at all
p5997
aVThe hard work for the database is selecting the rows; it makes little difference to send you 5 columns out of 10, or all 10
p5998
aVIn that case just use a  and use Python to pick out the columns from the result set
p5999
as(dp6000
g16
V100297
p6001
stp6002
a((dp6003
g2
(lp6004
VIf all you are doing is limiting the number of columns returned there is no need to do a dynamic query
p6005
aVThe hard work for the database is in selecting the rows matching your  clause; it makes little difference to send you 5 columns out of 10, or all 10
p6006
aVJust use a "SELECT * FROM
p6007
aVand use Python to pick out the columns from the result set
p6008
aVYou'll use just one query to the database, so MySQL only has to work once, then filter out your columns:
p6009
aVYou may have to use  instead depending on your MySQL python module
p6010
as(dp6011
g16
V100297
p6012
stp6013
a((dp6014
g2
(lp6015
VUse  to implement the nonzero test, and simply cache it on creation:
p6016
aVLittle demo:
p6017
aVThis version of the NonZeroIterable caches the flag; it thus only tells you if the iterator was non-empty at the start
p6018
aVIf you need to be able to test the iterable at other points in it's lifecycle, use Sven's version instead; there the  flag will tell you after every iteration if there are more items to come still
p6019
aVSide note on your example
p6020
aVYour sample code is way too simple and not a good argument for your usecase; you first test for non-emptyness (which potentially iterates over the input list to seach for an odd number) but then exhaust the whole iterator anyway
p6021
aVThe following code would be just as efficient and wouldn't require you to invent ways to break python idioms:
p6022
as(dp6023
g16
V100297
p6024
stp6025
a((dp6026
g2
(lp6027
VTo compile all modules beforehand, run the following command:
p6028
aVThe python  module takes care of the compilation, the  switch makes it output
p6029
aVpyo files
p6030
aVHowever, you cannot force Python to use these unless the  switch is given for every run or the  environment var is set
p6031
aVNote that all the -O flag does is disable the  statement
p6032
aVSpecify -OO and docstrings are dropped
p6033
aVThese do not make for much speed difference or space savings
p6034
aVSee: What does Python optimization (-O or PYTHONOPTIMIZE) do
p6035
as(dp6036
g16
V100297
p6037
stp6038
a((dp6039
g2
(lp6040
VLooking over the source code I think you have hit a bug here
p6041
aVThe code expects the HTML being input to be a unicode string, but this is not the case for you, and re-encoding it to ASCII fails
p6042
aVYou'll need to file a bug report with your traceback in the collective
p6043
aVsendaspdf issue tracker on GitHub
p6044
as(dp6045
g16
V100297
p6046
stp6047
a((dp6048
g2
(lp6049
VThis PHP script seems to indicate you'll need to set some cookies before Google gives you results:
p6050
aVThis is corroborated by Python recipe for Google Scholar comment, which includes a warning that Google detects scripts and will disable you if you use it too prolifically
p6051
as(dp6052
g16
V100297
p6053
stp6054
a((dp6055
g2
(lp6056
VJust prepend a null byte () before unpacking:
p6057
aVThe null byte pads your length bytes out to 4 bytes without altering the meaning
p6058
aVThe largest value the 3 size bytes can hold is 224 equals 16777216 bytes; adding the padding is not going to alter that limit in any way
p6059
as(dp6060
g16
V100297
p6061
stp6062
a((dp6063
g2
(lp6064
VLet's say I use a generator to handle adding information to a database; I use this to store network-received information, and by using a generator I can do this efficiently whenever I actually receive data, and do other things otherwise
p6065
aVSo, my generator first opens a database connection, and every time you send it something, it'll add a row:
p6066
aVThat is all fine and well; every time I  my data it'll insert a row
p6067
aVBut what if my database is transactional
p6068
aVHow do I signal this generator when to commit the data to the database
p6069
aVAnd when to abort the transaction
p6070
aVMoreover, it is holding an open connection to the database, maybe I sometimes want it to close that connection to reclaim resources
p6071
aVThis is where the  method comes in; with  I can raise exceptions in that method to signal certain circumstances:
p6072
aVThe  method on a generator does essentially the same thing; it uses the  exception combined with  to close a running generator
p6073
as(dp6074
g16
V100297
p6075
stp6076
a((dp6077
g2
(lp6078
VThe expression  is always True; perhaps you meant:
p6079
aVinstead
p6080
aVSince you 'pass' if that expression is True, you may as well reverse it:
p6081
aVI suspect that  and  are either strings with length > 0 or None, in which case that can be further simplified to:
p6082
aVLast but not least, you need to make sure that  (or  after your edit) actually returns something to write to out_buf
p6083
aVIf all it returns is an empty string, for example, you won't see any results
p6084
as(dp6085
g16
V100297
p6086
stp6087
a((dp6088
g2
(lp6089
VJust replace the  part:
p6090
aVYou may have to omit the  call depending on the configuration of your company email server
p6091
aVIt also depends on your email server whether or not it'll allow sending without logging in
p6092
aVThe SMTP standard does not demand you log in, but company policy may
p6093
aVNote that just because you have to log in to the mail server, you may still be able to send email using whatever  address you choose
p6094
aVEnforcing limitations on the from address is another policy decision a mail server can make
p6095
as(dp6096
g16
V100297
p6097
stp6098
a((dp6099
g2
(lp6100
VClearly, your list of  attributes is not homogeneous; at least one of the attributes you list there is a function, while at least one other is a dict
p6101
as(dp6102
g16
V100297
p6103
stp6104
a((dp6105
g2
(lp6106
VYou are trying to call  on a string object
p6107
aVYou either got your arguments mixed up (you'll need to call , not ) or you accidentally re-used the same variable for both your open destination file object and storing a string
p6108
as(dp6109
g16
V100297
p6110
stp6111
a((dp6112
g2
(lp6113
VMay as well make it random:
p6114
as(dp6115
g16
V100297
p6116
stp6117
a((dp6118
g2
(lp6119
VThe function doesn't just return tuple elements; it returns the path to any item in the nested structure, plus it's value
p6120
aVYou can use that path to get at the value and change it:
p6121
aVSo, for every value that is an integer, use the path to find the parent of that value, then replace the current value with it's hex equivalent
p6122
aVThe output you get from the above method:
p6123
as(dp6124
g16
V100297
p6125
stp6126
a((dp6127
g2
(lp6128
VBeautifulSoup itself doesn't parse CSS style declarations at all, but you can extract such sections then parse them with a dedicated CSS parser
p6129
aVDepending on your needs, there are several CSS parsers available for python; I'd pick cssutils (requires python 2
p6130
aV5 or up (including python 3)), it is the most complete in it's support, and supports inline styles too
p6131
aVOther options are css-py and tinycss
p6132
aVTo grab and parse such all style sections (example with cssutils):
p6133
aVWith  you can then combine these, resolve imports, and even have it fetch external stylesheets
p6134
as(dp6135
g16
V100297
p6136
stp6137
a((dp6138
g2
(lp6139
VBuildout only let's you pin (exact) versions by using a  section:
p6140
aVwhere the  key in the  section names a section to be used for the pins (most just call that section  as well)
p6141
aVIf you need to pin that to a version that differs from machine to machine, you'll have to use a recipe that generates versions based on external parameters
p6142
aVIn the following example I am using the  recipe to run some python to fetch the version pin for me:
p6143
aVThe example above uses the  utility to determine the version of the python-ldap package on Debian or Ubuntu; adjust as needed for your own platform
p6144
as(dp6145
g16
V100297
p6146
stp6147
a((dp6148
g2
(lp6149
VIn this case, it would be easier to handle tuples directly in the  structure traverser
p6150
aVHere is a modified version that converts tuples to lists before traversing over them to find nested elements:
p6151
aVUsing a slightly modified example from your previous question, and the same  solution I gave you in that question:
p6152
as(dp6153
g16
V100297
p6154
stp6155
a((dp6156
g2
(lp6157
VYou are testing against an empty list
p6158
aVThe expression is evaluated in full first before assigning it as the new value of , which thus remains empty until the full list expression has been evaluated
p6159
aVTo put it differently, the expression  is executed in isolation
p6160
aVIt might help if you view your code in a slightly modified fashion:
p6161
aVThe above is the moral equivalent of directly assigning the result of the list expression to , but I have more clearly separated assigning the result by using a second variable
p6162
as(dp6163
g16
V100297
p6164
stp6165
a((dp6166
g2
(lp6167
VJust refer to the last line outside the for loop:
p6168
aVThe  variable is still available outside the for loop:
p6169
aVNote that if your file is empty (no iterations through the loop)  will not be set; this is why we set  before the loop and test for  afterwards
p6170
aVIf you must have the last item that matched your test, store that in a new variable:
p6171
aVDemonstration of the second option:
p6172
as(dp6173
g16
V100297
p6174
stp6175
a((dp6176
g2
(lp6177
V is a fork of  with better perhaps documentation
p6178
aVYou basically have  (stdlib) and  as your choices
p6179
aVSince  doesn't let you specify dependencies, only  is left
p6180
aVYou generally list all dependencies, and document the installation procedure clearly (including in the long_description field pushed to PyPI)
p6181
aVInclude the OS-level installed packages, most distributions include the egg information when installing these
p6182
as(dp6183
g16
V100297
p6184
stp6185
a((dp6186
g2
(lp6187
VUse defaultdict instead:
p6188
aVThis way you don't have to initialize all the keys you want to use to lists beforehand
p6189
aVWhat is happening in your example is that you use one (mutable) list:
p6190
aVwould output
p6191
as(dp6192
g16
V100297
p6193
stp6194
a((dp6195
g2
(lp6196
VSupervisor only supports expansions with environment variables in a limited number of locations, each of which is documented in the configuration documentation
p6197
aVUnfortunately, the   option is not one of those; it only supports the  variable, nothing else
p6198
aVYou could file a feature request for this in the supervisord issue tracker if this an important issue for you
p6199
aVIn my projects, we generally use zc
p6200
aVbuildout to make deployment and development environment setup predictable and repeatable, and generate the supervisor configuration from a template
p6201
aVThere is a specialized buildout recipe to make this task easier
p6202
as(dp6203
g16
V100297
p6204
stp6205
a((dp6206
g2
(lp6207
VYou'll need to specify an ordering in your relationship definition, using the  parameter:
p6208
as(dp6209
g16
V100297
p6210
stp6211
a((dp6212
g2
(lp6213
VFrom the top of the PySqlite page on the Trac site:
p6214
aVIf you're using Python 2
p6215
aV5 and up, you already have a working version of pysqlite 2, bundled as sqlite3
p6216
aVYou can stop here ;-)
p6217
aVYou are using python 2
p6218
aV7, so there is no need to install a custom version
p6219
aVpysqlite comes bundled with your python version already
p6220
aVis the "glue" that makes sqlite available to python
p6221
aVYour system sqlite itself needs to be upgraded, not the glue library
p6222
aVSee How can I upgrade the sqlite3 package in Python 2
p6223
ag5279
as(dp6224
g16
V100297
p6225
stp6226
a((dp6227
g2
(lp6228
VMost likely you have a second  module or package in your python path
p6229
aVIf you created a  file or a  directory containing an  file, python could find that before it finds the normal module in the standard python library
p6230
aVNaming a local module or package  is the equivalent of naming a local variable  or  or ; you are masking the built-in name with a local redefinition
p6231
aVRename that module or package to something else to fix this
p6232
as(dp6233
g16
V100297
p6234
stp6235
a((dp6236
g2
(lp6237
V takes a key argument, with it you can tell max how to calculate the value for each item in an iterable
p6238
aVwill do nicely here:
p6239
aVDemo:
p6240
aVIf you need to use a different method of summing your items, you can specify your own functions too; this is not limited to the python built-in functions:
p6241
as(dp6242
g16
V100297
p6243
stp6244
a((dp6245
g2
(lp6246
VYes,  removes the first matching value, not a specific index:
p6247
aVremoves a specific index:
p6248
aVand  returns the removed element:
p6249
aVTheir error modes are different too:
p6250
as(dp6251
g16
V100297
p6252
stp6253
a((dp6254
g2
(lp6255
VThe pip, easy_install and virtualenv commands are installed per python version (python 2
p6256
aV6, 2
p6257
aV7, etc)
p6258
aVYou'll have to install a new copy of  for your python version (see the setuptools installation instructions, or you could install distribute instead, which is a fork of setuptools), or do the same for  by installing it directly
p6259
aVYou can then use this new installation, tied to python 2
p6260
aV7, to install
p6261
aVThe new commands are likely, to have been installed as  or ; see the  documentation on multiple python versions,  and  themselves are  likely to be a symlinks to their 2
p6262
aV6 versions
p6263
aVTry and run  or
p6264
aVIf that doesn't work for you, you can always use the  switch instead:
p6265
as(dp6266
g16
V100297
p6267
stp6268
a((dp6269
g2
(lp6270
VI see nothing in your example code or copy of the cookies
p6271
aVtxt file that is obviously wrong
p6272
aVI've checked the source code for the  method, which throws the exception that you see
p6273
aVThe first thing this method does, is read the first line of the file you specified (using ) and use  to look for the regular expression pattern
p6274
aVThis is what fails for your file
p6275
aVIt certainly looks like your  would match that format, so the error you see is quite surprising
p6276
aVNote that your file is opened with a simple  call earlier on, so it'll be opened in text mode with universal line ending support, meaning it doesn't matter that you are running this on Windows
p6277
aVThe code will see  newline terminated strings, regardless of what newline convention was used in the file itself
p6278
aVWhat I'd do in this case is tripple-check that your file's first line is really correct
p6279
aVIt needs to either contain "# HTTP Cookie File" or "# Netscape HTTP Cookie File" (spaces only, no tabs, between the words, capitalisation matching)
p6280
aVTest this with the python prompt:
p6281
aVPython echoed the line representation back to me when I typed  at the prompt, including the  newline character
p6282
aVAny surprises like tab characters or unicode zero-width spaces will show up there as escape codes
p6283
aVI also verified that the regular expression used by the  code matches
p6284
aVYou can also use the  python debugger to verify what the  module really does:
p6285
aVIn the above sample pdb session I used a combination of the  and  commands to verify that the regular expression test () actually passed
p6286
as(dp6287
g16
V100297
p6288
stp6289
a((dp6290
g2
(lp6291
VKeywords are indeed not expressions, but  is
p6292
aVRemove the quotes:
p6293
aVAlso, why are you basing your custom  class on
p6294
aVI haven't used deform yet myself, but from a quick glance at the documentation suggest strongly you should be inheriting from  instead
p6295
aVLast but not least, you could fall back to the pyramid thread-local request instead:
p6296
aVYes, this is often frowned upon, but could be easier in your case to deal with
p6297
as(dp6298
g16
V100297
p6299
stp6300
a((dp6301
g2
(lp6302
VWhen writing raw bytestrings, you want to open the file in binary mode:
p6303
aVOtherwise the  call opens the file in text mode and expects unicode strings instead, and will encode them for you
p6304
aVTo decode, is to interpret an encoding (like utf-8) and the output is unicode text
p6305
aVIf you do want to decode first, specify an encoding when opening the file in text mode:
p6306
aVIf you don't specify an encoding Python will use a default, which usually is a Bad Thing
p6307
aVNote that since you are already have UTF-8 encoded byte strings to start with, this is actually useless
p6308
aVNote that python file operations never transform existing unicode points to XML character entities (such as ), other code you have could do this but you didn't share that with us
p6309
aVI found Joel Spolsky's article on Unicode invaluable when it comes to understanding encodings and unicode
p6310
as(dp6311
g16
V100297
p6312
stp6313
a((dp6314
g2
(lp6315
VYou'd have to store a pointer back to the App object in the Method:
p6316
aVIf you have an absolute need to avoid passing the  pointer in App, you'll need to inspect the stack to retrieve it instead
p6317
aVThe following is discouraged and only works when you instantiate  objects in a method of :
p6318
as(dp6319
g16
V100297
p6320
stp6321
a((dp6322
g2
(lp6323
VIf ordering doesn't matter, use a set:
p6324
aVIf ordering does matter, use an OrderedDict:
p6325
as(dp6326
g16
V100297
p6327
stp6328
a((dp6329
g2
(lp6330
VI use SQLAlchemy for direct queries all the time
p6331
aVPrimary advantage: it gives you the best protection against SQL injection attacks
p6332
aVSQLAlchemy does the Right Thing whatever parameters you throw at it
p6333
aVI find it works wonders for adjusting the generated SQL based on conditions as well
p6334
aVDisplaying a result set with multiple filter controls above it
p6335
aVJust build your query in a set of if/elif/else constructs and you know your SQL will be golden still
p6336
aVHere is an excerpt from some live code (older SA version, so syntax could differ a little):
p6337
aVThe code where this comes from is a lot more complex, but I wanted to highlight the date range code here
p6338
aVIf I had to build the SQL using string formatting, I'd probably have introduced a SQL injection hole somewhere as it is much easier to forget to quote values
p6339
as(dp6340
g16
V100297
p6341
stp6342
a((dp6343
g2
(lp6344
VYou should cut + paste +
p6345
aVThat's the only API you have available
p6346
aV:-)
p6347
aVI often use a helper method for the job:
p6348
as(dp6349
g16
V100297
p6350
stp6351
a((dp6352
g2
(lp6353
VPython Scripts in Zope are sandboxed (via RestrictedPython, which means that any module imports have to be declared safe first
p6354
aVAdding modules to the declared-safe list is generally a Bad Idea unless you know what you are doing
p6355
aVTo declare a module as importable into Python Scripts, you'll need to create a python package, then add the following code to it so it is executed when Zope starts:
p6356
aVThis'll allow any import from that module (use with caution)
p6357
aVIt's better to allow only specific methods and classes from a module; use a  declaration for that:
p6358
aVThis is documented in the Security chapter of the Zope Developers Guide, specifically the section on module security assertions
p6359
aVNote that it nearly always is a better idea to do all this work in a tightly constrained method in unrestricted code (e
p6360
ag1298
aVa regular python package), then allow that method to be used from a python script instead
p6361
as(dp6362
g16
V100297
p6363
stp6364
a((dp6365
g2
(lp6366
VWhen you want to move a complete instance, you need to copy over the same data as you would back up
p6367
aVThat means you'll need to copy over:
p6368
aVThe  object storage file
p6369
aVThe  directory
p6370
aVAll your customizations and installed packages, beyond Plone
p6371
aVSee the Plone FAQ and Backing up (and restoring) a Plone instance
p6372
as(dp6373
g16
V100297
p6374
stp6375
a((dp6376
g2
(lp6377
VYour  is only calculated for  while  is only calculated for
p6378
aVEverything else is discarded, as you replace  and  in each loop
p6379
aVYou want to find the set of values where your condition is true
p6380
aVUse  to put lows and highs together:
p6381
as(dp6382
g16
V100297
p6383
stp6384
a((dp6385
g2
(lp6386
VYou need to double the slashes in the python literal, they are being interpreted as the start of an escape code otherwise:
p6387
aVNotice how in the first example (from your code) python has interpreted the  entries as a hex 07 character instead, the ASCII code for BELL
p6388
aVThe alterative is to use a raw python string literal, by prefixing it with the letter :
p6389
aVSee the string literals documentation for more info on how string escapes work in string literals
p6390
as(dp6391
g16
V100297
p6392
stp6393
a((dp6394
g2
(lp6395
VUse sets:
p6396
aVThe  operator means "give me the intersection of these two sets"; alternatively you can use the  method:
p6397
as(dp6398
g16
V100297
p6399
stp6400
a((dp6401
g2
(lp6402
VSince this is the challenge I won't give you a complete answer
p6403
aVYou are on the right track however
p6404
aVThe  method returns  instances
p6405
aVYou want to look at the  method on these and read the documentation carefully
p6406
aVThink about what the difference is between  and  there; plain  is the same as
p6407
aVAs for the  escape character; because that particular escape combination has no meaning as a python string escape character, Python ignores it and leaves it as a backslash and letter
p6408
aVIt would indeed be better to use the  literal string format, as it would prevent nasty surprises when you do want to use a regular expression character set that also happens to be an escape sequence python does recognize
p6409
aVSee the python documentation on string literals for more information
p6410
aVYour  with the  expression returns 2 elements per match as you have 2 groups in your pattern; the outer, whole group matching  and the inner group matching
p6411
aVFrom the  documentation:
p6412
aVIf one or more groups are present in the pattern, return a list of groups; this will be a list of tuples if the pattern has more than one group
p6413
as(dp6414
g16
V100297
p6415
stp6416
a((dp6417
g2
(lp6418
VUse the  method with an empty  instance:
p6419
aVAlternatively, you can use the  constant:
p6420
aVBoth  and  represent midnight (00:00:00)
p6421
as(dp6422
g16
V100297
p6423
stp6424
a((dp6425
g2
(lp6426
VYou do not need to use the  command to read the table you created from python
p6427
aVThe  command is intended to import tabular text data (CSV data)
p6428
aVThe python  module however writes native SQLite database files
p6429
aVJust open the  file with the sqlite3 command:
p6430
as(dp6431
g16
V100297
p6432
stp6433
a((dp6434
g2
(lp6435
VYour buildout ran successfully, there were no problems there
p6436
aVSome of the packages you picked were not pinned, so your buildout reported what versions it choose for you
p6437
aVYour server itself is not indeed running because the Python LDAP egg you installed seems to be incorrectly installed
p6438
aVThe  library file is missing
p6439
aVRemove the whole egg () make sure you have the OpenLDAP 2
p6440
aVx library and headers installed on your system (on Ubuntu and Debian the  should be enough)
p6441
aVThen re-run buildout to reinstall the egg
p6442
aVAlternatively, you could try and install the system  package (remove the egg) and see if buildout picks that up instead
p6443
as(dp6444
g16
V100297
p6445
stp6446
a((dp6447
g2
(lp6448
VThe content rules framework is built on Zope events; when content is modified an event is sent out, and the content rules subscribes to that event, is notified and performs configured actions
p6449
aVUnfortunately, neither the sharing tab nor the underlying Zope access control framework emit events (that part of Zope pre-dates events by quite a few years)
p6450
aVYou'd have to:
p6451
aVCustomize the Sharing tab view () to emit a custom event when a roles are added or removed
p6452
aVRegister this event type with the content rules engine; you need to register the event interface with a :
p6453
aVCreate a condition that can be triggered by the new event type
p6454
aVThis procedure is documented in this Plone
p6455
aVorg knowledgebase article
p6456
as(dp6457
g16
V100297
p6458
stp6459
a((dp6460
g2
(lp6461
VPython dictionaries have a key and a value, what you are asking for is what key(s) point to a given value
p6462
aVYou can only do this in a loop:
p6463
aVNote that there can be more than one key per value in a dict;  is perfectly legal
p6464
aVIf you want ordering you either need to use a list or a OrderedDict instance instead:
p6465
as(dp6466
g16
V100297
p6467
stp6468
a((dp6469
g2
(lp6470
VYou cannot loop through a file and then loop through the same file again without seeking to the start
p6471
aVEither re-open file2, call  on file2 or load all lines into a list and loop over that instead
p6472
aVIn your specific case, using a  for the names is probably going to be the fastest:
p6473
aVYou can do the same with the lines in file1 and do a set intersection, provided that lines are unique in both file1 and file2
p6474
as(dp6475
g16
V100297
p6476
stp6477
a((dp6478
g2
(lp6479
VConfigParser does not automatically write back to the file on disk
p6480
aVUse the  method for that; it takes an open file object as it's argument
p6481
as(dp6482
g16
V100297
p6483
stp6484
a((dp6485
g2
(lp6486
VUse the   class method:
p6487
aVthen use the  method to format the output:
p6488
aVYou can also use the  function:
p6489
as(dp6490
g16
V100297
p6491
stp6492
a((dp6493
g2
(lp6494
VYou are confusing classes with methods
p6495
aVis a method on an instance of , not a nested class
p6496
aVIt could return another instance
p6497
aVTake a look at the source code of SQLAlchemy; it does exactly that; generate SQL from a structure python classes, where you can refine a query by calling methods on instances in just such a manner
p6498
aVA series of joins for example, can be chained:
p6499
as(dp6500
g16
V100297
p6501
stp6502
a((dp6503
g2
(lp6504
VThe standard library only supports the standard C library strftime formatting codes, which are rather weak when it comes to localization
p6505
aVgives you the full month name in the locale your program is running under; if that's the English locale it'll give you 'April', but it could just as well give you 'Avril' if you are running on a french computer
p6506
aVFor web applications, you really want to use an external library like Babel to do that instead; Babel provides you with extra routines for formatting python  instances in different languages:
p6507
aVwhere  is defined as a language-specific pattern
p6508
aVBabel uses the Unicode Locale Data markup language to define these patterns giving you access to large pre-defined locale libraries that define these patters for you
p6509
aVNote that the grammatically correct way is to use cardinal, not ordinal numbers when formatting dates; British English allows for both ordinal and cardinal dates
p6510
aVAs such the Unicode standard does not include ordinal post-fixes for dates
p6511
as(dp6512
g16
V100297
p6513
stp6514
a((dp6515
g2
(lp6516
VYou need to know what kind of information is stored in each field for the  module to make sense of each field
p6517
aVFor example, the first field at offset 0 is 4 bytes long, which means it could be an  (ranges from \u22122,147,483,648 to +2,147,483,647) or it could be a  instead (ranges from 0 to 4,294,967,295)
p6518
aVIt could also be a single-precision floating point number
p6519
aVYou probably also need to figure out the endianness of your file format
p6520
aVIf this is not explicitly named you need to experiment a little, or infer from context what it would be (a Windows file format is almost always little-endian, for example)
p6521
aVIf you want to unpack the first 4 values only, you read the correct number of bytes (8 in your format) and pass this to the  function together with a set of formatting characters to tell struct what types to expect
p6522
aVIf we assume little-endian data, and the first four fields represent an unsigned int, an unsigned short and two unsigned chars, respectively, you'd use:
p6523
as(dp6524
g16
V100297
p6525
stp6526
a((dp6527
g2
(lp6528
VYour string is encoded using the Quoted-printable format for MIME headers
p6529
aVThe  module handles this for you:
p6530
as(dp6531
g16
V100297
p6532
stp6533
a((dp6534
g2
(lp6535
VZope pagetemplates do not support a  syntax at all
p6536
aVHowever, you can loop over your python list in the  just fine:
p6537
aVI suspect however, that you want to let the portal_catalog do the sorting instead, using the  parameter (see the Plone KB article on the catalog):
p6538
aVIf you want to do anything more complex, use a browser view to do the list massaging for you
p6539
as(dp6540
g16
V100297
p6541
stp6542
a((dp6543
g2
(lp6544
VJust pass the string to :
p6545
aVLike  it takes a string representation of a complex number and parses that
p6546
aVYou can use  to do so for a list:
p6547
as(dp6548
g16
V100297
p6549
stp6550
a((dp6551
g2
(lp6552
V is your friend:
p6553
aVThis produces tuples; if lists are fine, use Jon Clement's variation of the same technique
p6554
as(dp6555
g16
V100297
p6556
stp6557
a((dp6558
g2
(lp6559
VI'd use an event handler to hook into site traversal, with a toggle:
p6560
aVNow  will be executed only once for each Plone site, and is very cheap to execute
p6561
aVYou could reduce this (much further) if you only had to deal with one Plone site per instance; simply unsubscribe your handler after firing the first time
p6562
aVThis works better than handling a  event as then you'd have to set up the local registry (call ) on each and every Plone site before you can even access the registry utility
p6563
as(dp6564
g16
V100297
p6565
stp6566
a((dp6567
g2
(lp6568
VYou have your repeaters wrong I'm afraid:
p6569
aVThe correct syntax is  for minimum and maximum digits, or  for an exact match
p6570
aVThe  character class is also easier to use that ; it means the same thing for regular (non-Unicode) matching
p6571
as(dp6572
g16
V100297
p6573
stp6574
a((dp6575
g2
(lp6576
VAttributes on form elements are not passed on to the server when forms are submitted; only input element values are
p6577
aVThe way to add extra information to be sent back to a server on a form submit is by adding additional  elements to your form, specifically  elements
p6578
aVE
p6579
ag1298
aVadds a new field  to your form data with the value
p6580
as(dp6581
g16
V100297
p6582
stp6583
a((dp6584
g2
(lp6585
VWhat you are asking is not Plone or Zope specific, you are dealing with a TALES statement here, which, together with TAL and METAL form the page template language implemented by Zope Page Templates (and, incidentally, also by chameleon, plus several other implementations in different programming languages)
p6586
aVYou are using a TALES path expression when you use the  character, and it is not the same as a Python  expression
p6587
aVEach path named in the expression will by resolved, and only if it doesn't exist will the next path be used
p6588
aVFrom the specification:
p6589
aVWhen a TALES path expression is evaluated, it attempts to traverse each path, from left to right, until it succeeds or runs out of paths
p6590
aVSince all your paths resolve to existing variable names, they all exist and the first one will be used, regardless of it's value
p6591
aVYou want to use a  expression instead:
p6592
aVNote that in TAL there rarely is a need for the  keyword
p6593
aVYou probably want to define these items on your root element of your document instead; variables are visible within the same scope as the XML or HTML element they are defined on:
p6594
as(dp6595
g16
V100297
p6596
stp6597
a((dp6598
g2
(lp6599
VYes, you can install multiple python versions on your computer without problems
p6600
aVPython 2
p6601
aV7 is backwards compatible with 2
p6602
ag2176
aVCode that works on 2
p6603
aV5 will work on 2
p6604
aV7 just fine
p6605
aVUse the Python 2
p6606
aV7 binary in your SDK, switch all apps to the  runtime and don't look back
p6607
aVThere is no need to switch back and forth
p6608
as(dp6609
g16
V100297
p6610
stp6611
a((dp6612
g2
(lp6613
VBCD codes work with 4 bits per number, and normally encode only the digits 0 - 9
p6614
aVSo each byte in your sequence contains 2 numbers, 1 per 4 bits of information
p6615
aVThe following method uses a generator to produce those digits; I am assuming that a 0xF value means there are no more digits to follow:
p6616
aVHere I use a right-shift operator to move the left-most 4 bits to the right, and a bitwise AND to select just the right-most 4 bits
p6617
aVDemonstration:
p6618
aVThe method works with the  output; you can skip the  call in the method if you pass integers directly (but use the  unsigned variant instead)
p6619
aVAlternatively, you could just read those 16 bytes straight from your file and apply this function to those bytes directly without using struct
p6620
as(dp6621
g16
V100297
p6622
stp6623
a((dp6624
g2
(lp6625
VUse the  method instead
p6626
aVFormsDict is a subclass of MultiDict and can store more than one value per key
p6627
aVThe standard dictionary access methods will only return a single value, but the MultiDict
p6628
aVgetall() method returns a (possibly empty) list of all values for a specific key
p6629
as(dp6630
g16
V100297
p6631
stp6632
a((dp6633
g2
(lp6634
VThe parenthesis can be omitted when used in function calls with only one argument, the generator expression syntax specifically allows for it
p6635
aVThe parentheses can be omitted on calls with only one argument
p6636
aVSee section Calls for the detail
p6637
as(dp6638
g16
V100297
p6639
stp6640
a((dp6641
g2
(lp6642
VNo, the  part is a boolean expression;  is a sequence operator that tests if  is a member of the sequence
p6643
aVThe parenthesis are actually redundant there and could be omitted
p6644
as(dp6645
g16
V100297
p6646
stp6647
a((dp6648
g2
(lp6649
VPlone does not set any requirements beyond lxml itself
p6650
aVSo, if you meet the requirements listed on the lxml installation page, you meet the requirements for Plone 4
p6651
ag5740
aVIn summary, lxml requires libxml 2
p6652
ag5279
aV21 or later, and libxslt 1
p6653
ag1124
aV15 or later
p6654
aVIn detail, I quote the lxml installation page:
p6655
aVlibxml 2
p6656
ag5279
aV21 or later
p6657
aVIt can be found here: http://xmlsoft
p6658
aVorg/downloads
p6659
aVhtml
p6660
aVWe recommend libxml2 2
p6661
ag4892
aV8 or a later version
p6662
aVIf you want to use XPath, do not use libxml2 2
p6663
ag5279
aV27
p6664
aVIf you want to use the feed parser interface, especially when parsing from unicode strings, do not use libxml2 2
p6665
ag4892
aV4 through 2
p6666
ag4892
ag5279
aVlibxslt 1
p6667
ag1124
aV15 or later
p6668
aVIt can be found here: http://xmlsoft
p6669
aVorg/XSLT/downloads
p6670
aVhtml
p6671
aVWe recommend libxslt 1
p6672
ag1124
aV26 or later
p6673
aVDebian and Ubuntu have libxml2 2
p6674
ag4892
aV8 (Ubuntu has had that version since Natty), and libxslt1
p6675
aV1 1
p6676
ag1124
aV26 (all the way back to Lucid); most other Linux distributions will have matching packages
p6677
aVOn Windows, the lxml egg has been statically linked against the correct libxml and libxslt versions, so you don't need to bother with versions there
p6678
as(dp6679
g16
V100297
p6680
stp6681
a((dp6682
g2
(lp6683
VYou did not actually get an error, your buildout completed fine
p6684
aVWhen installing eggs, any  files are compiled to  cached byte-code files
p6685
aVHowever, Python Script files in Plone skin layers are a special form of Python that are treated as functions, and byte-compiling these always fails
p6686
aVThis is a side-effect and can be ignored, see Buildout and Syntax Errors
p6687
aVThe unified installer buildout configuration has been set up to inform you if buildout had to pick versions for you if not explicitly pinned to one
p6688
aVThe output you see tells you exactly what versions it picked, and you can re-use that output to set the pins yourself
p6689
aVFind the file  and add the lines below the  block in that file, below the same  section you'll find in that file
p6690
aVFor more information on such version pinning and other buildout issues, see:
p6691
aVBrief version pinning tutorial
p6692
aVBuildout troubleshooting manual
p6693
aVThe Unified Installer manual
p6694
aVIf you do run into problems with these packages and get errors when you run your Zope instance, errors will be logged either to the console (when run in foreground mode) or the errors log
p6695
aVSee Add on product installation fails for help with troubleshooting these
p6696
as(dp6697
g16
V100297
p6698
stp6699
a((dp6700
g2
(lp6701
VYou are converting to a binary representation of the number, not so much a hex representation (although Python will display the bytes as hex)
p6702
aVUse the  module for such conversions
p6703
aVDemonstration:
p6704
aVNote that the ASCII code for '4' is 0x34, python only displays bytes with a  escape if it is a non-printable character
p6705
aVBecause 0x34 is printable, python outputs that as  instead
p6706
aV>' in the formatting code above means 'big endian' and 'I' is an unsigned int conversion (4 bytes)
p6707
as(dp6708
g16
V100297
p6709
stp6710
a((dp6711
g2
(lp6712
V is a keyword argument with a mutable default, which is indeed mutated in the function body
p6713
aVThis'll store  instances permanently in that mutable keyword argument
p6714
aVThis is not so much a leak as a misunderstanding of the longevity of mutable keyword arguments
p6715
aVThe function itself could still call  to delete these objects
p6716
aVSee "Least Astonishment" in Python: The Mutable Default Argument for more information on the subject
p6717
as(dp6718
g16
V100297
p6719
stp6720
a((dp6721
g2
(lp6722
VTake a look at the  method on regular expression  results
p6723
aVYour regular expression has an explicit group match group (the part in  parethesis), and the  method gives you direct access to the string that was matched within that group
p6724
aVare returned by several  functions and methods, including the  and  functions
p6725
aVDemonstration:
p6726
aVFrom the Regular Expression syntax documentation on the  parenthesis syntax:
p6727
aVMatches whatever regular expression is inside the parentheses, and indicates the start and end of a group; the contents of a group can be retrieved after a match has been performed, and can be matched later in the string with the \u005cnumber special sequence, described below
p6728
aVTo match the literals '(' or ')', use \u005c( or \u005c), or enclose them inside a character class: [(] [)]
p6729
as(dp6730
g16
V100297
p6731
stp6732
a((dp6733
g2
(lp6734
VYou create only one column, then append it to your rows
p6735
aVAppending a list to another list does not make a new copy, but re-uses the same list over and over
p6736
aVAppend a copy instead by using the  slice syntax or a  call:
p6737
aVHere is an example of what happens for you:
p6738
aVIf we use a copy on the other hand, the copies do not change when we alter the original:
p6739
aVI used both methods of creating a (shallow) copy of the original columns list in the above example
p6740
aVIf you need to create a deep copy (a list containing other mutable items such as lists or dicts), use the  utility instead
p6741
as(dp6742
g16
V100297
p6743
stp6744
a((dp6745
g2
(lp6746
VYou cannot monkeypatch either  or, by extension,  on instances because these methods are treated as class methods instead as a CPython internal optimization (see Special method lookup for new-style classes for an in-depth rationale as to why this is)
p6747
aVIf you need to monkeypatch these methods, you'll need to set them directly on the class instead:
p6748
aVThe above will work; note that I set  to the unbound function , not to the bound method
p6749
as(dp6750
g16
V100297
p6751
stp6752
a((dp6753
g2
(lp6754
VPlease read Unicode filenames, part of the Python Unicode how-to
p6755
aVMost importantly, filesystem encodings are not necessarily the same as the current LANG setting in the terminal
p6756
aVSpecifically,  is built upon , and will thus switch between unicode and 8-bit bytes depending on wether or not you give it a unicode path
p6757
aVPass it an 8-bit path instead, and your code will work properly, then decode from UTF-8 or ISO 8859-1 as needed
p6758
as(dp6759
g16
V100297
p6760
stp6761
a((dp6762
g2
(lp6763
VYou are missing something
p6764
aVIn the narrative documentation on static assets it states:
p6765
aVInstead of representing a URL prefix, the  argument of a call to  can alternately be a URL
p6766
aVEach of examples we\u2019ve seen so far have shown usage of the  argument as a URL prefix
p6767
aVHowever, when  is a URL, static assets can be served from an external webserver
p6768
aVIn this mode, the  is used as the URL prefix when generating a URL using
p6769
aVIn the API documentation similar wording is used:
p6770
aVWhen  is called with a  argument that represents a URL prefix, as it is above, subsequent calls to  with paths that start with the  argument passed to  will generate a URL something like , which will cause the  file in the images subdirectory of the  package to be served
p6771
aVUsing a URL switches the behaviour of  altogether and the  argument is interpreted as a symbolic path only for the  method
p6772
aVThat latter detail is perhaps not described as explicitly in the documentation, you could file an issue in the pyramid issue tracker if you feel strongly about that
p6773
as(dp6774
g16
V100297
p6775
stp6776
a((dp6777
g2
(lp6778
VSimply use the existing python libraries for calling other webservers
p6779
aVOn python 2
p6780
aVx, use , for python 3
p6781
aVx, use  instead
p6782
aVAlternatively, you could install
p6783
aVDo note that calling external sites from your server while serving a request yourself could mean your visitors end up waiting for a 3rd-party web server that stopped responding
p6784
aVMake sure you set decent time outs
p6785
as(dp6786
g16
V100297
p6787
stp6788
a((dp6789
g2
(lp6790
VNo, what you are doing is actually the best way to approach this
p6791
aVUsing marker interfaces is the way I would go about it in any case
p6792
aV:-)
p6793
aVThe alternative would be for you to re-register the viewlet for the interfaces or classes of all the different content types instead:
p6794
aVbut that is a whole lot more verbose
p6795
as(dp6796
g16
V100297
p6797
stp6798
a((dp6799
g2
(lp6800
VYour list contains another list:
p6801
aVSets can only contain items that are hashable; any standard type that cannot be mutated is hashable, but a  is not (it can be mutated)
p6802
aVBy contrast, a  is not mutable and can be stored in a
p6803
aVBugs happen, even in code that has been running fine for a while
p6804
aVDebug it with print statements, or better still, by using a debugger like the pdb
p6805
aVIf your bug only appears intermittently, use a / block to catch the error, then print out information or use a debugger to figure out what is going on:
p6806
as(dp6807
g16
V100297
p6808
stp6809
a((dp6810
g2
(lp6811
VNo, there is no support for such an approach
p6812
aVIt is also a bad idea; you want to leave installation to the specialized tools, which not only manage dependencies but also what versions are installed
p6813
aVWith tools like buildout you can control very precisely what versions are being used
p6814
aVBy bundling a version of a dependency inside, you either force upon your users what version they get to use, or make it harder for such tools to ensure the used versions for a given installation are consistent
p6815
as(dp6816
g16
V100297
p6817
stp6818
a((dp6819
g2
(lp6820
V expects the second argument to be a sequence
p6821
aVYour  is a string, which happens to be a sequence of length 3:
p6822
aVThis is what causes your confusing error message;  sees a 3-element sequency and expected only 1
p6823
aVPass it to  in a one-element tuple:
p6824
aVNote the comma there
p6825
as(dp6826
g16
V100297
p6827
stp6828
a((dp6829
g2
(lp6830
VThe top-level element of your JSON structure is not a list, but a mapping
p6831
aVIt's keys are of the form , , etc
p6832
aVYou need to thus address that structure using the python mapping interface instead:
p6833
aVor as a one-liner:
p6834
aVBoth use the  method on  to loop over all the values in the structure
p6835
as(dp6836
g16
V100297
p6837
stp6838
a((dp6839
g2
(lp6840
VI've built a similar system; it's called
p6841
aVOne of these days I'll make it more generic (it is currently tied to the CMF, one of the underpinnings of Plone)
p6842
aVDecoupling
p6843
aVWhat you need, is a way to decouple the component registration for your pipeline
p6844
aVIn Transmogrifier, I use the Zope Component Architucture (embodied in the  package)
p6845
aVThe ZCA lets me register components that implement a given interface and later look up those components as either a sequence or by name
p6846
aVThere are other ways of doing this too, for example, python eggs have the concept of entry points
p6847
aVThe point is more that each component in the pipeline is referable by a text-only name, de-referenced at construction time
p6848
aV3rd-party components can be slotted in for re-use by registering their own components independently from your pipeline package
p6849
aVConfiguration
p6850
aVTransmogrifier pipelines are configured using a textual format based on the python  module, where different components of the pipeline are named, configured, and slotted together
p6851
aVWhen constructing the pipeline, each section thus is given a configuration object
p6852
aVSections don't have to look up configuration centrally, the are configured on instantiation
p6853
aVCentral state
p6854
aVI also pass in a central 'transmogrifier' instance, which represents the pipeline
p6855
aVIf any component needs to share per-pipeline state (such as caching a database connection for re-use between components), they can do so on that central instance
p6856
aVSo in my case, each section does have a reference to the central pipeline
p6857
aVIndividual components and behaviour
p6858
aVTransmogrifier pipeline components are generators, that consume elements from a preceding component in the pipeline, then yield the results of their own processing
p6859
aVComponents generally thus have a reference to the previous stage, but have no knowledge of what consumes their output
p6860
aVI say 'generally' because in Transmogrifier some pipeline elements can produce elements from an external source instead of using a previous element
p6861
aVIf you do need to alter the behaviour of a pipeline component based on individual items to be processed, mark those items themselves with extra information for each component to discover
p6862
aVIn Transmogrifier, items are dictionaries, and you can add extra keys to a dictionary that use the name of a component so each component can look for this extra info and alter behaviour as needed
p6863
aVSummary
p6864
aVDecouple your pipeline components by using an indirect lookup of elements based on a configuration
p6865
aVWhen you instantiate your components, configure them at the same time and give them what they need to do their job
p6866
aVThat could include a central object to keep track of pipeline-specific state
p6867
aVWhen running your pipeline, only pass through items to process, and let each component base it's behaviour on that individual item only
p6868
as(dp6869
g16
V100297
p6870
stp6871
a((dp6872
g2
(lp6873
VIt looks like the product breaks in combination with CMFEditions
p6874
aVTry editing  to add an import at the top, then alter line 53 to get to the  by a different route
p6875
aVYou'll need to find the file first; search for  in the  script
p6876
aVThat'll give you the location of the egg
p6877
aVWithin the egg, locate the file  and open it in an editor
p6878
aVTo the top, with the other  statements, add the following line:
p6879
aVand alter line 54 (was line 53, but you added a line to the top); it currenntly reads:
p6880
aVwhere you change  to  to make it read:
p6881
aVAltering the egg in this manner is not portable; you'd have to do so for each and every installation of your site
p6882
aVIf the above alteration works for you, please report it to the author of the package so it can be fixed in a new release
p6883
aVThere currently is an issue in the package issue tracker that seems to be related, see issue 7, where you could follow up on this
p6884
aVAlternatively, you could file a ticket in the new GitHub issue tracker for this package
p6885
aVYes, the package author, Nathan van Gheem, frequents Stack Overflow as well, but you should not count on him discovering the issue here
p6886
aVFiling an issue in the supported locations mean more people can find it and help out, too
p6887
as(dp6888
g16
V100297
p6889
stp6890
a((dp6891
g2
(lp6892
VThe error indicates that your the machine you are running this script on cannot reach the destination IP address (10
p6893
ag2391
ag5740
aV2), as it doesn't have a network route configured from one to the other
p6894
aVThis is a problem with your internal network (10
p6895
ag1205
ag1205
aVx IP addresses are always private network addresses)
p6896
aVIf you are running this script on a different network from the machine you are trying to reach, you'll need a public IP address for it instead
p6897
as(dp6898
g16
V100297
p6899
stp6900
a((dp6901
g2
(lp6902
VFirst of all, you normally enable that option in the Security tab of your Plone control panel:
p6903
aVIf you set the option there, it'll also add a 'My Folder' action automatically that uses the  method
p6904
aVonly returns a URL if the folder already exists
p6905
aVIn your case it appears the folder is not yet created for the current member
p6906
aVThe folder is first created when a member logs in but does not have their own folder yet
p6907
aVLogging out then in again should remedy this
p6908
aVIf you accidentally removed the  folder from your Plone setup, you'll need to recreate it
p6909
aVPer-user folder creation would otherwise fail
p6910
aVIf it is missing, simply create a new folder with the id  in the root of your site
p6911
as(dp6912
g16
V100297
p6913
stp6914
a((dp6915
g2
(lp6916
VThis won't work with setuptools; you cannot override dependencies like that, for good reasons
p6917
aVWhat you describe is a broken dependency; you'll have to resolve this manually (probably by pinning package A to v
p6918
ag5740
aV0)
p6919
as(dp6920
g16
V100297
p6921
stp6922
a((dp6923
g2
(lp6924
VYou could loop over the dict to create a generator for the  method:
p6925
as(dp6926
g16
V100297
p6927
stp6928
a((dp6929
g2
(lp6930
VYou'll need to add an external module that provides timezone support; the  module provides you with the necessary timezone database
p6931
aVYou'll either need to parse the timezone by hand to construct a pytz timezone, or use a package like  or  to do the parsing for you:
p6932
as(dp6933
g16
V100297
p6934
stp6935
a((dp6936
g2
(lp6937
VFor reference, you should look at the official TALES specification, or refer to the TALES section of the Zope Page Templates reference
p6938
aVIn this case, you are using a plain python expression, and thus the normal rules of python code apply
p6939
aVThe expression request
p6940
aVform
p6941
aVget('amt', False) would return the request parameter  from the request, and if that's missing, return the boolean , which you then compare to an integer value
p6942
aVThere are 2 things wrong with that expression: first of all you assume that the  parameter is an integer value
p6943
aVEven a PFG integer field however, is still a string in the request object
p6944
aVAs such you'll need to convert in to an integer first before you can compare it
p6945
aVAlso, you fall back to a boolean, which in integer comparisons will be regarded as the equivalent of , better be explicit and use that instead:
p6946
aVNote that for a PFG condition, you can also return a string error message instead of boolean True:
p6947
as(dp6948
g16
V100297
p6949
stp6950
a((dp6951
g2
(lp6952
VSimply address the inner list:
p6953
aVThe first indexing operation  retrieves the first element in the outer list, to which you then apply another indexing operation to get the first element of the contained list
p6954
as(dp6955
g16
V100297
p6956
stp6957
a((dp6958
g2
(lp6959
VEither is fine
p6960
aVChoose the one you find to be most readable
p6961
aVPersonally, I'd go with the first one, the use of the extra variable doesn't add anything for me
p6962
aVThat said, in this context ecatmur is correct that you need to close the  instance after writing all the data to it, as that flushes the compression data to  and adds the gzip CRC and size information
p6963
aVWithout this your data is potentially incomplete
p6964
as(dp6965
g16
V100297
p6966
stp6967
a((dp6968
g2
(lp6969
VThe  suite is guaranteed to be executed, whatever happens in the  suite
p6970
aVUse it to clean up files, database connections, etc:
p6971
aVThis is true regardless of whether an exception handler ( suite) catches the exception or not, or if there is a  statement in your code:
p6972
aVUsing a / statement in a loop, then breaking out of the loop with either  or  would, again, execute the  suite
p6973
aVIt is guaranteed to be executed in all cases
p6974
as(dp6975
g16
V100297
p6976
stp6977
a((dp6978
g2
(lp6979
VYou could invert the tests and return False on sub-sets of the test:
p6980
aVThis way you can break up the long line of tests and make the whole thing a lot more readable
p6981
aVYes, you can use additional parentheses around your boolean tests to allow for newlines in the test, but readability suffers greatly when you have to go across multiple lines
p6982
as(dp6983
g16
V100297
p6984
stp6985
a((dp6986
g2
(lp6987
VCheck your locale
p6988
aVOn the interactive console, run the command
p6989
aVHere is what I get:
p6990
aVPython determines how to interpret filenames based on either the  or  environment variable, and I strongly suspect that one of these is set to a different encoding in your cron environment
p6991
aVIf that's the case, your filenames will have been decoded to unicode using a different encoding, one that then results in filenames that cannot be encoded to UTF-8 or ASCII
p6992
aVSimply set the  variable in your cron definition, either on a line on it's own preceding the time entry, or as part of the command to execute:
p6993
aVAs always with python Unicode issues, the answer lies in the Unicode HOWTO, section on filenames
p6994
as(dp6995
g16
V100297
p6996
stp6997
a((dp6998
g2
(lp6999
VYou need to check your python path; some other  is being found before your module
p7000
aVAlternatively, in a / suite, print out the path of the offending module:
p7001
as(dp7002
g16
V100297
p7003
stp7004
a((dp7005
g2
(lp7006
VYou want to take a look at the  module, the shell lexer
p7007
aVIt specializes in splitting command lines such as yours into it's constituents, including handling quoting correctly
p7008
as(dp7009
g16
V100297
p7010
stp7011
a((dp7012
g2
(lp7013
VUse a grouper, like from Alternative way to split a list into groups of n:
p7014
aVNote that the above code assumes python 2
p7015
aVx; for 3
p7016
aVx you'll need to use  instead
p7017
aVDemo:
p7018
as(dp7019
g16
V100297
p7020
stp7021
a((dp7022
g2
(lp7023
VUse the  method on your string:
p7024
as(dp7025
g16
V100297
p7026
stp7027
a((dp7028
g2
(lp7029
VThe  module source code is informative
p7030
aVBackported from there to determine the machine architecture on a Windows platform, it would use:
p7031
as(dp7032
g16
V100297
p7033
stp7034
a((dp7035
g2
(lp7036
VUse , combined with  to put the various lengths together:
p7037
aVDemonstration:
p7038
aVThis will efficiently produce progressively larger words with the input sets, up to length maxlength
p7039
aVDo not attempt to produce an in-memory list of 26 characters up to length 10; instead, iterate over the results produced:
p7040
as(dp7041
g16
V100297
p7042
stp7043
a((dp7044
g2
(lp7045
VFor file uploads, you need to alter the form enctype to use :
p7046
as(dp7047
g16
V100297
p7048
stp7049
a((dp7050
g2
(lp7051
VUse  to strip away the extra wrapping and restore the object to it's original path
p7052
aVPlease, do not use the single-item list approach as described in the document you link to
p7053
aVTo show one example from the linked document, but corrected with :
p7054
aVAlternatively, you can use the  attribute:
p7055
aVbut that only works on objects that inherit from  or ; the  function returns the passed argument verbatim if it is not a Acquisition-wrapped object
p7056
as(dp7057
g16
V100297
p7058
stp7059
a((dp7060
g2
(lp7061
VYou keep inserting your new row at position 1
p7062
aVWhat happens is that the previously entered data is then moved up one row, at which point you overwrite that data in the next loop
p7063
aVSo, first iteration everything is inserted in row 0, you add a row at index 1
p7064
aVThen you update row 1 with data, and insert another row at position 1, making the previously modified row move to row 2
p7065
aVNext loop, you overwrite the data on row 2, insert another empty row at position 1, moving the row with data to position 3 and you overwrite it again, etc
p7066
aV, etc
p7067
aVSet the row-count to 0 at the start, and insert rows as you need them before you insert your column data:
p7068
aVI am not that familiar with the QtTableWidget, it could be that continually adding rows in not going to perform as well as setting the number of rows up front
p7069
aVIf sqlite's  attribute is properly updated on your query (it not always is), you'd be better off calling  with that value:
p7070
aVIf the  value is not available (set to 1 or similar), perhaps first asking the database for the number of rows can help:
p7071
aVIn all examples above, I also renamed you variables to something a little closer to their use, and used  on the item loop as well
p7072
aVLast, but not least, the cursor can act as an iterator, meaning you can loop over rows directly without calling  and rows will be fetched as needed
p7073
as(dp7074
g16
V100297
p7075
stp7076
a((dp7077
g2
(lp7078
VUse a set and a loop; the set will let you know if you've seen an element before:
p7079
aVNote that for mutable elements such as found in your second list, you want to convert these to non-mutable variants such as tuples first:
p7080
as(dp7081
g16
V100297
p7082
stp7083
a((dp7084
g2
(lp7085
VYour code example is riddled with TAB characters
p7086
aVIf you are mixing tabs with spaces, the error is almost a given
p7087
aVUse the python  to clean up your source-code, switch your editor to use spaces only, then fix your indentations:
p7088
as(dp7089
g16
V100297
p7090
stp7091
a((dp7092
g2
(lp7093
VWhen you connect to a SQLite database file where that file does not yet exist, SQLite will create the file for you
p7094
aVYou'll have to use different means to test for the existence of the file first
p7095
aVA simple  should suffice:
p7096
as(dp7097
g16
V100297
p7098
stp7099
a((dp7100
g2
(lp7101
VYou'll need to run supervisord as root, and configure it to run your various services under non-privileged users instead
p7102
aVIn order for this to work, you cannot set the  option in the  section (otherwise the daemon cannot restart your haproxy server)
p7103
aVYou therefore do want to make sure your supervisord configuration is only writeable by root so no new programs can be added to a running supervisord daemon, and you want to make sure the XML-RPC server options are well protected
p7104
aVThe latter means you need to review any ,  and  sections you have configured to be properly locked down
p7105
aVFor example, use the  and  options for the [] section to limit access to the socket file to privileged users only
p7106
aVAlternatively, you can run a lightweight front-end server with minimal configuration to proxy port 80 to a non-privileged port instead, and keep this minimal server out of your supervisord setup
p7107
aVis an excellent server to do this, for example, installed via the native packaging system of your server (e
p7108
ag1298
aVapt-get on Debian or Ubuntu)
p7109
as(dp7110
g16
V100297
p7111
stp7112
a((dp7113
g2
(lp7114
VThe package includes full documentation built with Sphinx; the latest version is published online at docs
p7115
aVzope
p7116
aVorg
p7117
aVIn addition, there is a chapter on zope
p7118
aVschema published on the Zope3 Wiki, as part of Stephan Richter's Zope3 Book
p7119
aVThe PDF rendering of that chapter is perhaps more readable
p7120
aVThen there is Philipp von Weitershausen's excellent book Web Component development with Zope 3, which covers zope
p7121
aVschema as well
p7122
as(dp7123
g16
V100297
p7124
stp7125
a((dp7126
g2
(lp7127
VThis is not a problem with , or even with Python
p7128
aVYou are most likely using a proxy server that has not been properly configured to handle SSL connections
p7129
aVThe exact problem is very much dependent on the proxy server
p7130
aVA Google search on the  error will give you many hits and discussions on how to diagnose this
p7131
aVNote that even if you have not configured a proxy on your local machine, a corporate firewall could still be forcing HTTPS connections to go over a proxy at the network boundaries
p7132
as(dp7133
g16
V100297
p7134
stp7135
a((dp7136
g2
(lp7137
VWhy limit your  function to command line usage only
p7138
aVBy defining a  function at module scope, you can now wrap your script and alter how it is called
p7139
aVPerhaps you want to set default arguments in sys
p7140
aVargv, perhaps you want to reuse the code in another script
p7141
as(dp7142
g16
V100297
p7143
stp7144
a((dp7145
g2
(lp7146
VConvert the keys to  values; using  would give you tuples of both key and value that you can then sort:
p7147
aVThen index these; data[5][0] is the date, data[5][1] is the dictionary value
p7148
aVIf you need to retain the original date formatting, use the date format parsing only for sorting; here's a one-liner variant of the above that uses a sort key:
p7149
aVHere I use the  function to do the hard work, and the  lambda takes each date string, converting it to a  instance for sorting purposes only
p7150
aVI don't limit this to a  instance as in the first example
p7151
as(dp7152
g16
V100297
p7153
stp7154
a((dp7155
g2
(lp7156
VYes, rsync will be able to copy the Data
p7157
aVfs data over incrementally; it is an append only method, after all
p7158
aVYou do run the risk that the last in-progress transaction is incomplete when being copied over by rsync, but Zope is smart enough to ignore incomplete transactions like that
p7159
aVrsync will have to do a lot of work to find out where to start copying in the Data
p7160
aVfs though, as it doesn't know that the format is append only
p7161
aVSo on every run, it'll analyse the full file from the start, which would consume some CPU and disk access resources
p7162
aVPerhaps using a combination of repozo and rsync would be a better solution
p7163
aVRun repozo to create snapshots (which are much more efficient to create, as repozo does know about the append-only nature of a Data
p7164
aVfs), rsync those over, and 'restore' your cold failover server from these backups automatically
p7165
aVWith  including repozo in your buildout is a snap
p7166
as(dp7167
g16
V100297
p7168
stp7169
a((dp7170
g2
(lp7171
VHTML special characters are escaped automatically to prevent XSS attacks
p7172
aVUse an exclamation mark at the start of your template statement to indicate that you really want to include HTML:
p7173
aVSee the documentation on inline statements
p7174
as(dp7175
g16
V100297
p7176
stp7177
a((dp7178
g2
(lp7179
VBecause there is a lot of re-wrapping going on to make z3c
p7180
aVform forms work with Plone and the main template, your form's class hierarchy has been changed on registration
p7181
aVAs a result,  calls are broken in such forms, and you need to call the unbound method directly:
p7182
as(dp7183
g16
V100297
p7184
stp7185
a((dp7186
g2
(lp7187
VHaving investigated this further, could indeed reproduce the problems you report
p7188
aVI was able to enter pre-epoch (January 1st, 1970) dates just fine on most platforms except Windows
p7189
aVIt is indeed so that Zope's DateTime instances use negative second values for timestamps before the epoch, but Python's  can usually deal with negative values just fine:
p7190
aVI've tested this across several python 2
p7191
aVx releases on Mac, FreeBSD and Linux
p7192
aVWhen you test this on Windows however, you indeed get a ValueError
p7193
aVNote that this is a problem across the python and Plone versions, this is a Windows-specific problem
p7194
aVThe code in question is trying to determine the local timezone for the given date, which could be either summer time (daylight saving time) or winter time
p7195
aVSo, on Windows, we can also swap out the year in the date to the current year, for this calculation to work
p7196
aVIt potentially could get DST calculations wrong, depending on the exact local timezone, but since you cannot get the correct calculation for pre-1970 dates anyway, this is a good compromise
p7197
aVI've committed the following replacement for line 97 to git just now (commit 63b043a7ba):
p7198
aVUse this in your local egg, or wait for a new release of the 2
p7199
aV1 branch of the package
p7200
as(dp7201
g16
V100297
p7202
stp7203
a((dp7204
g2
(lp7205
VThis very much depends on your add-ons you have used on the site
p7206
aVEither the add-ons themselves could be problematic (no 4
p7207
aV2-compatible versions available) or the data they manage is not updated to follow changes in the updated add-on
p7208
aVMostly, though, an upgrade from 2
p7209
aV5 all the way to 4
p7210
aV2 should be fine; try it directly on a 4
p7211
aV2 install (copy over the Data
p7212
aVfs, install compatible versions of your add-ons, upgrade), or use a 3
p7213
aVx intermediary version
p7214
aVThe Plone Upgrade Guide documents the process in detail
p7215
as(dp7216
g16
V100297
p7217
stp7218
a((dp7219
g2
(lp7220
VUse dict views to find the intersection between documents, then a Counter to count their frequencies:
p7221
aVEach entry in Score will be a count of how often each word in a document appears in the other documents
p7222
aVIf you need to include the word count in the current document as well (count + 1), simply remove the  test
p7223
aVIn your own code you confused  and , but in python you usually don't need to manually increment a loop counter in any case
p7224
as(dp7225
g16
V100297
p7226
stp7227
a((dp7228
g2
(lp7229
VThe  test let's you see if a key is part of a dictionary
p7230
aVYou can simply loop through a set of keys to test for:
p7231
aVThe  suite will only be executed if the for loop completed without reaching a  statement, i
p7232
aVe
p7233
aVyou didn't find a matching key
p7234
aVNote that you could still use your exception approach in the loop:
p7235
aVbut I am not so sure that is more readable
p7236
as(dp7237
g16
V100297
p7238
stp7239
a((dp7240
g2
(lp7241
VYour timestamp is expressed in seconds, your timezone in hours and minutes
p7242
aVSimply subtract or add the timezone converted to seconds, then use the time
p7243
aVstrftime function to format that to the string you want:
p7244
as(dp7245
g16
V100297
p7246
stp7247
a((dp7248
g2
(lp7249
VBoth methods will be passed (almost) the same set of arguments, so usually they have matching signatures (the same set of parameters)
p7250
aVI say 'almost' there, because the  method is passed the class as first argument, while the  method is passed the result of the  method; the freshly created instance
p7251
aVIn python, you can use "wildcard" parameters; the  and  (see What does *args and **kwargs mean
p7252
aV, which means that either  or  could use these to only name some of the parameters passed in
p7253
aVWhat happens when the signatures don't match (taking into account the wildcard parameters)
p7254
aVYou get the same result as passing arguments to any python callable whose signature does not match the arguments passed in; you get an exception
p7255
as(dp7256
g16
V100297
p7257
stp7258
a((dp7259
g2
(lp7260
VHexadecimal notation is just that, a way to write down integer numbers
p7261
aVYou can enter  in your source code, or you can write it down as , it means the same thing to the computer
p7262
aVPython supports the same integer literal syntax as C in that respect; list the same attributes on a class definition and you have the Python equivalent of your enum:
p7263
aVThe C# application is probably sending these integers using the standard C byte representations, which you can either interpret using the  module, or, if sent as single bytes, with :
p7264
as(dp7265
g16
V100297
p7266
stp7267
a((dp7268
g2
(lp7269
VYou can ask the catalog to list the contents of a given folder, by using the path index, with a depth limit:
p7270
aVSee quering the catalog for more information
p7271
aVAlternatively, you could traverse to the folder in question and call the  skin method on that:
p7272
aVThe latter does the catalog search for you
p7273
as(dp7274
g16
V100297
p7275
stp7276
a((dp7277
g2
(lp7278
VYes, the  function let's you retrieve frames from the current execution stack, which you can then inspect with the methods and documentation found in the  module; you'll be looking for specific locals in the  attribute, as well as for the  information:
p7279
aVNote that you'll need to take some care to detect what kind of information you find in each frame
p7280
as(dp7281
g16
V100297
p7282
stp7283
a((dp7284
g2
(lp7285
VYou can set the encoding of the SQLAlchemy connection to MySQL in the connection parameters:
p7286
aVSee the SQLAlchemy documentation on MySQL, unicode section
p7287
as(dp7288
g16
V100297
p7289
stp7290
a((dp7291
g2
(lp7292
VIf your executable cannot be run as root itself, run it as as non-privileged user instead
p7293
aVEither configure all of supervisord to run as another user by setting the   option:
p7294
aVor set a  parameter for your executable in it's  section:
p7295
as(dp7296
g16
V100297
p7297
stp7298
a((dp7299
g2
(lp7300
VYou want to customize the way object state is pickled and unpickled, not customize the load and unload functionality
p7301
aVYou'll have to study the Pickling and unpickling normal class instances chapter, in your case defining a  and  method should be enough
p7302
aVWhat happens in your case is that there is a class-level attribute with  instances, which are meant to be constants
p7303
aVBut on unpickling, new  instances are created that are not connected to the class-level attribute anymore
p7304
aVThe  instances do have an  attribute you can use to capture their state as an integer instead of an instance of , which we can use to find the correct constant again when reinstating your instances:
p7305
aVSo, normally, if there is no  the instance  is pickled
p7306
aVWe now do return a copy of that , but we swapped out the  instance for it's index (a simple integer)
p7307
aVOn unpickling, normally the new instance  is updated with the unpickled  we captured on pickling, but now that we have a  defined, we can swap out the enum index back out for the correct  again
p7308
as(dp7309
g16
V100297
p7310
stp7311
a((dp7312
g2
(lp7313
VYou are trying to connect 'localhost', port 25 (the default values for ), and there is no server listening there
p7314
aVThus the connection is refused
p7315
as(dp7316
g16
V100297
p7317
stp7318
a((dp7319
g2
(lp7320
VDecorator  notation is just syntactic sugar for calling the decorator callable with the decorated function and replacing the decorated function with the result
p7321
aVIn other words, the following two examples are the exact same thing:
p7322
aVand the same applies to methods in class definitions
p7323
aVThus, you can simply decorate a class method by replacing the class method with the result of the decorator callable:
p7324
aVThis is the same as if you had written:
p7325
aVNote that in your case  is actually a module, not a class, but the same principles apply
p7326
as(dp7327
g16
V100297
p7328
stp7329
a((dp7330
g2
(lp7331
VYou want to increment the second value of your tuple, not the tuple itself:
p7332
aVYou need to create a new tuple, as illustrated, because tuples are immutable themselves
p7333
as(dp7334
g16
V100297
p7335
stp7336
a((dp7337
g2
(lp7338
VPython can only be introspected from within the interpreter itself; so if you are worried about anything reading the password, that something will either have to gain access to the interpreter or it'll have to dump the process memory somehow
p7339
aVThe interpreter is not going to be breached unless you run some python code that opens a hole
p7340
aVBasically, as long as you do not use anything like the  module (which can load arbitrary python code into the interpreter), or call  or  on arbitrary code, you should be safe
p7341
aVOf course, you cannot avoid having to store the master key in memory, if even for a brief time only
p7342
aVYou can limit the master key being stored until the moment you need it, then wipe the variable by assigning  to it or something
p7343
as(dp7344
g16
V100297
p7345
stp7346
a((dp7347
g2
(lp7348
VDjango  entries are  instances, which have an  attribute (ranging from 0 to 23):
p7349
as(dp7350
g16
V100297
p7351
stp7352
a((dp7353
g2
(lp7354
VSimply substitute the references for the variable names in the last expression:
p7355
aVNot certain that this is more readable though
p7356
as(dp7357
g16
V100297
p7358
stp7359
a((dp7360
g2
(lp7361
VYou can set per-process environment variables in the supervisord configuration in the [] section, these will be passed to the process when it starts:
p7362
aVNote that you need to use a comma between each variable
p7363
aVI used newlines in the above example as well, those are optional
p7364
aVIf you have spaces in your environment values you need to enclose the value in quotes
p7365
aVYou can also set environment variables for all processes in the  section, using the same format
p7366
aVLast but not least, any environment variables set when supervisord starts are passed on to the processes managed by supervisord too
p7367
aVSee the documentation section on environment variables for details
p7368
aVDo note that if you change environment variables configured in the configuration file, you'll need to signal to supervisord to reload the configuration and restart the subprocesses for them to pick up these changes:
p7369
aVIf however you change environment variables outside of supervisord, you'll need to shut down supervisord all together to pick these up:
p7370
as(dp7371
g16
V100297
p7372
stp7373
a((dp7374
g2
(lp7375
VWalk the tree with  set to False instead:
p7376
aVFrom the documentation:
p7377
aVIf optional argument topdown is  or not specified, the triple for a directory is generated before the triples for any of its subdirectories (directories are generated top-down)
p7378
aVIf topdown is , the triple for a directory is generated after the triples for all of its subdirectories (directories are generated bottom-up)
p7379
aVThus, you get to rename sub-directories first, and will see the top-level directories last, and renaming them will no longer affect how the sub-directories are found
p7380
as(dp7381
g16
V100297
p7382
stp7383
a((dp7384
g2
(lp7385
V adds new elements:
p7386
as(dp7387
g16
V100297
p7388
stp7389
a((dp7390
g2
(lp7391
VYou assign something new to :
p7392
aVwhere  is  at some point in your code
p7393
aVYou probably meant to append instead:
p7394
as(dp7395
g16
V100297
p7396
stp7397
a((dp7398
g2
(lp7399
VYou are replacing , with the result of , which is a generator itself
p7400
aVThus, you end up passing  back to  in the form of recursively nested generator expressions
p7401
aVThis construction eventually passes the recursion depth limits
p7402
as(dp7403
g16
V100297
p7404
stp7405
a((dp7406
g2
(lp7407
VThis is a python syntax exception, not a SQL problem
p7408
aVThe line:
p7409
aVis missing a closing parenthesis at the end
p7410
as(dp7411
g16
V100297
p7412
stp7413
a((dp7414
g2
(lp7415
V returns a list of elements that match, not one
p7416
aVLoop over the result set to get the individual items:
p7417
as(dp7418
g16
V100297
p7419
stp7420
a((dp7421
g2
(lp7422
V returns only the filenames, not complete paths
p7423
aVUse  to recreate the correct path:
p7424
as(dp7425
g16
V100297
p7426
stp7427
a((dp7428
g2
(lp7429
VYou're in luck: there is both an API and there is are at least two python libraries (Py-StackExchange and Stack
p7430
aVPY) to use that API
p7431
aVOne caveat: Personal information requires that you use the v2
p7432
aV0 API, but the currently released version of Py-StackExchange only supports up to version 1
p7433
ag1124
aVThe GitHub repository for the library has a updating-2
p7434
aV0 branch that may or may not work for you
p7435
aVStack
p7436
aVPY does support version 2
p7437
aV0 (and 2
p7438
aV1 too
p7439
aVThe API itself is based on HTTP requests with JSON responses, so you could just call the API directly as well
p7440
as(dp7441
g16
V100297
p7442
stp7443
a((dp7444
g2
(lp7445
VUse a nested generator expression:
p7446
aVTo count the items in the first position, a different generator expression gets that item for counting:
p7447
aVDemo:
p7448
as(dp7449
g16
V100297
p7450
stp7451
a((dp7452
g2
(lp7453
VYou need to know what encoding you want to measure your byte size in:
p7454
aVYou really want to review the Python Unicode HOWTO to fully appreciate the difference between a unicode object and it's byte encoding
p7455
aVAnother excellent article is The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p7456
aV, by Joel Spolsky (one of the people behind Stack Overflow)
p7457
as(dp7458
g16
V100297
p7459
stp7460
a((dp7461
g2
(lp7462
VSplit the line on newlines and grab the first item from the result:
p7463
aVFor efficiency's sake, I instructed  to only split on the first newline as we discard the rest
p7464
aVor you could use the  method instead
p7465
as(dp7466
g16
V100297
p7467
stp7468
a((dp7469
g2
(lp7470
VThe python garbage collector will close files when they are no longer referenced
p7471
aVIf your  variable is a local variable in a function, it'll be cleared when the function returns
p7472
aVThus, the file  referred to will be automatically closed during the normal garbage collection cycle
p7473
aVThat said, it's probably better to close the file
p7474
aVYou can use the file as a context manager, and it'll be automatically closed when the context is exited:
p7475
aVIf  is something Django produces for you, open and ready, you can still have it automatically closed with the  decorator:
p7476
aVTo answer the rest of your question: your leak is most likely elsewhere
p7477
as(dp7478
g16
V100297
p7479
stp7480
a((dp7481
g2
(lp7482
VUsing viewkeys (python2
p7483
aV7):
p7484
aVSame in python 3:
p7485
aVYes, I am using a key intersection here; if you are absolutely sure your keys are the same in both, just use :
p7486
aVAnd to be complete, In Python 2
p7487
aV6 and before you'll have to use a  constructor with a generator expression to achieve the same:
p7488
aVwhich generates a sequence of key-value tuples
p7489
as(dp7490
g16
V100297
p7491
stp7492
a((dp7493
g2
(lp7494
VYou are adding your additional dict to each list in the values, which are lists themselves
p7495
aVThese are mutable, so just reference these inner lists directly:
p7496
aVNote the use of  there; we are creating a new copy of the  structure for appending each time, otherwise they will all be the same dict and manipulating one will manipulate all of the references in each list
p7497
as(dp7498
g16
V100297
p7499
stp7500
a((dp7501
g2
(lp7502
VThis is dependent on how you configured your site, between 3 options:
p7503
aVStand-alone, using a Data
p7504
aVfs (the default)
p7505
aVYour only option is to use a  cron job, preferably with a dedicated Zope user whose only permission is to pack
p7506
aVThis is because the Zope process is the only process that has access to the Data
p7507
aVfs
p7508
aVA ZEO setup
p7509
aVNow you can instruct the ZEO server to pack your Data
p7510
aVfs using a cron job (see What is the suggested way to cron-automate ZODB packs for a production Plone instance
p7511
aVA RelStorage setup
p7512
aVRelStorage include it's own packing script; here's a buildout configuration to create it, you can then run this from a cron job:
p7513
as(dp7514
g16
V100297
p7515
stp7516
a((dp7517
g2
(lp7518
VA Plone company called Jarn created a SaaS intranet platform built on Plone, that included a full XMPP stack for in-browser realtime chat (or microblogging, really) and presence management
p7519
aVThis platform was open sourced when the company decided not to pursue that platform anymore, and is available on GitHub: https://github
p7520
aVcom/intranett/intranett
p7521
aVThe core of the XMPP integration is the  package; it provides the presence and messaging components
p7522
aVThe  buildout above shows how to use this component's potential
p7523
aVDisclaimer: I used to be a software engineer at Jarn, the company no longer exists today, this is thus Open Source software without a current maintainer
p7524
as(dp7525
g16
V100297
p7526
stp7527
a((dp7528
g2
(lp7529
VYou can create a  skin method to add extra content in a newly-created member folder
p7530
aVThe script will be called in the context of this new folder
p7531
aVThe reason that this has to be a skin script, and not a view or an event handler, is because this part of Plone stems from an older feature in the CMF, one that hasn't been updated to more modern API standards yet
p7532
aVHere's an example  python skin script:
p7533
aVYou may have to give this script the  proxy role
p7534
aVIf you define this skin script on the filesystem, in your custom skin layer, add a  file (named ) to set this proxy role:
p7535
as(dp7536
g16
V100297
p7537
stp7538
a((dp7539
g2
(lp7540
VYou can choose whatever feels natural to you;  means your instances always sort after other types,  and they'll be sorted before
p7541
aVAlternatively, you can return  (see the  and other comparison methods documentation) to signal the comparison is not supported:
p7542
aVQuoting the documentation:
p7543
aVA rich comparison method may return the singleton  if it does not implement the operation for a given pair of arguments
p7544
aVBy convention,  and  are returned for a successful comparison
p7545
aVHowever, these methods can return any value, so if the comparison operator is used in a Boolean context (e
p7546
ag1298
aV, in the condition of an if statement), Python will call  on the value to determine if the result is true or false
p7547
as(dp7548
g16
V100297
p7549
stp7550
a((dp7551
g2
(lp7552
V never typecasts to bool
p7553
aVRather,  calls  on the result of expressions
p7554
aVAn expression using  (and , for that matter), short-circuits when it can determine that the expression will not evaluate to True or False based on the first operand, and returns the last evaluated value:
p7555
aVThis 'side-effect' is often used in python code
p7556
aVNote that  does return a boolean value
p7557
aVSee the python documentation on boolean operators for the details
p7558
aVThe documentation also explains what constitutes a  or  equivalent for various types, such as , ,  and empty containers being , while most everything else is equivalent to
p7559
aVFor custom classes, you need to define the  method (returns  or ) or a  method (returns an int, where  is  and everything else is ), to influence their boolean equivalent, otherwise they'll always default to
p7560
as(dp7561
g16
V100297
p7562
stp7563
a((dp7564
g2
(lp7565
VThis is exactly how  should behave
p7566
aVWhile the condition is true, it'll return elements from the underlying iterable, and as soon as it's false, it permamently switches to the iteration-done stage
p7567
aVNote that this is how iterators must behave; raising StopIteration means just that, stop iterating over me, I am done
p7568
aVFrom the python glossary on "iterator":
p7569
aVAn object representing a stream of data
p7570
aVRepeated calls to the iterator\u2019s  method return successive items in the stream
p7571
aVWhen no more data are available a  exception is raised instead
p7572
aVAt this point, the iterator object is exhausted and any further calls to its  method just raise  again
p7573
aVYou could combine  with  to see if there are any more results in the next batch:
p7574
aVThis yields generators, so each item yielded is itself a generator
p7575
aVYou do need to consume all elements in these generators for this to continue to work; the same is true for the groupby method listed in another answer
p7576
as(dp7577
g16
V100297
p7578
stp7579
a((dp7580
g2
(lp7581
VYes, set the  property of the field to True
p7582
as(dp7583
g16
V100297
p7584
stp7585
a((dp7586
g2
(lp7587
VThe tripple-quoted string is not a comment; it is the docstring of the method
p7588
aVYou can access it with  later, for example, or have it formatted for you with
p7589
aVTripple-quoting ( or ) is a python-specific method of specifying a string literal where newlines do not need to be escaped
p7590
aVAs such, it is part of the body of the function, and thus needs to be indented to match
p7591
aVIn fact, any string appearing as the first statement of a function is treated as a docstring, single quoting would work too
p7592
aVThe same trick works for classes and modules too
p7593
aVA lot of tools can make use of this documentation string; you can embed doctest tests in this information, for example
p7594
aVSee PEP 257 for conventions on formatting this string
p7595
aVComments on the other hand, are always denoted by a  (where not part of a string literal) and are ignored up to the end of a line
p7596
aVIf all the line contains is a comment, the whole line is thus ignored, as would a line with only whitespace
p7597
aVSee the documentation on comments
p7598
as(dp7599
g16
V100297
p7600
stp7601
a((dp7602
g2
(lp7603
VI personally much prefer the zope
p7604
aVschema route; I can, if I really wanted to, vary the interface attributes dynamically with python, while the XML definition is of course static
p7605
aVAlso, note that to register adapters and views against an XML-defined schema, you need to pull it into python code anyway:
p7606
aVThe XML dialect is part of  package; I was not able to locate any documentation beyond the source code
p7607
as(dp7608
g16
V100297
p7609
stp7610
a((dp7611
g2
(lp7612
VThe  constructor can take other types apart from strings:
p7613
aVFor the bytestring case, however, the two forms are mostly equivalent
p7614
aVSome encoding options are not valid for the  constructor as they do not result in unicode output, but are valid for the  method of bytestrings, such as :
p7615
as(dp7616
g16
V100297
p7617
stp7618
a((dp7619
g2
(lp7620
VYou should load your configuration file using the  API
p7621
aVThat way your eggified code can load the configuration file even when zipped
p7622
aVThe API can check for existence, test for directories, read data or provide you with an open file object for any resource that is part of your egg
p7623
aVThe API takes care of all the details; it'll extract files to a temporary directory for example, if you absolutely must have a filename for a resource but are running from a zipped egg
p7624
aVMost of all, it'll work regardless of whether or not you are in fact installed as an egg or stand-alone
p7625
as(dp7626
g16
V100297
p7627
stp7628
a((dp7629
g2
(lp7630
VDictionaries do not have any ordering
p7631
aVIf you require ordering your options are:
p7632
aVTo use a list of tuples instead
p7633
aVSorting the  when you loop (or  or , depending on your needs)
p7634
aVUse an OrderedDict instead
p7635
as(dp7636
g16
V100297
p7637
stp7638
a((dp7639
g2
(lp7640
VClearly,  returns Unicode, and you need to use the  method instead:
p7641
aVYou really want to review the Python Unicode HOWTO to fully appreciate the difference between a unicode object and it's byte encoding
p7642
aVAnother excellent article is The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p7643
aV, by Joel Spolsky (one of the people behind Stack Overflow)
p7644
as(dp7645
g16
V100297
p7646
stp7647
a((dp7648
g2
(lp7649
VYou'll need to put the data in a  instance and have PIL parse the data from that
p7650
aVassumes raw image data, not PNG-encoded data
p7651
aVThe  object provides a file-like object to wrap your data in, so PIL can work with it
p7652
as(dp7653
g16
V100297
p7654
stp7655
a((dp7656
g2
(lp7657
VThe unit of time is seconds since the UNIX epoch (00:00:00 UTC on 1 January 1970)
p7658
aVUse the  or  modules to interpret these, depending on your needs
p7659
aVThe latter is a higher-level module
p7660
aVExample:
p7661
aVYour  value is thus already the difference between the two timestamps in seconds
p7662
as(dp7663
g16
V100297
p7664
stp7665
a((dp7666
g2
(lp7667
VYour exception has nothing to do with your generated SQL, which is exactly what you wanted
p7668
aVYour database connection is in the wrong state; a transaction was aborted (probably due to an integrity error somewhere) and no new transaction was started, and your database didn't like that
p7669
aVWhile experimenting with SQLAlchemy from an iPython prompt, it's probably better to turn auto-commit on, so you don't have to deal with the intricacies of transaction management
p7670
as(dp7671
g16
V100297
p7672
stp7673
a((dp7674
g2
(lp7675
VTake a close look at the following piece of your code:
p7676
aVNotice how you first call  on  (which you had initialized with a list earlier), then use it as a loop variable nested in the same loop
p7677
aVUse better, meaningful variable names in your code to avoid this class of errors
p7678
aVRename either the loop variable or the module-level list variable
p7679
as(dp7680
g16
V100297
p7681
stp7682
a((dp7683
g2
(lp7684
VYou are not assigning the result of the  to anything, nor are you testing correctly
p7685
aVMoreover, you don't need to loop over your twodee dict at all, simply test if the  value is present in the dict with the  operator:
p7686
aVLast but not least, you want to actually do something with the changed line, here I print it
p7687
aVTo elaborate a little, your two lines with  in them are operations that end up doing nothing:
p7688
aVThe first operation splits the line to a list, selects the first elements and tests if that is equal to the  value
p7689
aVThis'll be either  or , but you don't do anything with than boolean value
p7690
aVIt just is dropped, python doesn't act on it, and the next line is executed regardless
p7691
aVThe second operation again splits the line to a list, selects the 9th element, and replaces that with the value of
p7692
aVBut, the result of  does not magically change the value of , it returns a list, which in this case doesn't get assigned to anything and thus is dropped again
p7693
as(dp7694
g16
V100297
p7695
stp7696
a((dp7697
g2
(lp7698
VOf course you can upload it
p7699
aVThere are plenty of command-line utilities listed on PyPI, including, for example,
p7700
aVIn fact, there are over 2700 packages marked as running in the Console environment
p7701
as(dp7702
g16
V100297
p7703
stp7704
a((dp7705
g2
(lp7706
VYou should either escape the  character or use a  raw string:
p7707
aVWithout the  raw string literal, backslashes are interpreted as escape codes
p7708
aVYou can double the backslash as well:
p7709
aVNote that you replace just the word  there, the  pattern matches 0 characters at minimum
p7710
aVRemove the question mark and it'll match your expected output:
p7711
as(dp7712
g16
V100297
p7713
stp7714
a((dp7715
g2
(lp7716
VA  instance is an open file already
p7717
aVThe  command, on the other hand, only takes filenames, to return an open file
p7718
aVA  instance is not suitable as a filename
p7719
aVAlso, you don't need to close a  instance, so there is no need to use it as a context manager either
p7720
aVIf all your legacy code can take is a filename, then a  instance is not the way to go
p7721
aVUse the  module to generate a temporary filename instead
p7722
aVHere is an example using a contextmanager to ensure the temp file is cleaned up afterwards:
p7723
as(dp7724
g16
V100297
p7725
stp7726
a((dp7727
g2
(lp7728
VYou'll need to open the MP3 file in binary mode:
p7729
aVIf you open the file in textmode (the default) then various line endings are normalized to , which is great for text, but in binary information such as an MP3 file that's a big problem
p7730
aVNote that I use the  function here, not the  constructor; from the  documentation:
p7731
aVWhen opening a file, it\u2019s preferable to use  instead of invoking this constructor directly
p7732
aVis more suited to type testing (for example, writing )
p7733
as(dp7734
g16
V100297
p7735
stp7736
a((dp7737
g2
(lp7738
VParse the numbers as floats, and use a multiplier mapping:
p7739
as(dp7740
g16
V100297
p7741
stp7742
a((dp7743
g2
(lp7744
VInternally, there is an open file pointer called  that get's cleared on close; you can test for that yourself too:
p7745
aVSee the  module source; the  method raises the  exception if  is True
p7746
aVNote that relying on such internal, undocumented implementations can be hairy; if future implementations change your code will break, perhaps in subtle ways
p7747
aVMake sure you have good test coverage for your project
p7748
aVAlternatively, you could create a ZipFile subclass and override the  method to track the state, which would be less at risk of breaking due to internal changes:
p7749
aVand
p7750
aVwith thanks to aknuds1 for the suggestion
p7751
as(dp7752
g16
V100297
p7753
stp7754
a((dp7755
g2
(lp7756
VYou are using the module, not the class within the module
p7757
aVI suspect that you are using it like this:
p7758
aVwhile you meant to use:
p7759
aVThis kind of confusion is one of the reasons that the Python styleguide (PEP 8) recommends using lowercase names for your modules; your import would then be:
p7760
aVand your error would have been easier to spot
p7761
as(dp7762
g16
V100297
p7763
stp7764
a((dp7765
g2
(lp7766
VYou have two options; either handle the exception or test the length:
p7767
aVor
p7768
aVUse the first if there often is no second item, the second if there sometimes is no second item
p7769
as(dp7770
g16
V100297
p7771
stp7772
a((dp7773
g2
(lp7774
VUse :
p7775
aVCounter objects offer various other advantages, such as making it almost trivial to collect the counts in the first place
p7776
as(dp7777
g16
V100297
p7778
stp7779
a((dp7780
g2
(lp7781
VThe link's presence is coupled to there being a workflow transition
p7782
aVThe form it links to offers additional options to set for the transitions that are available on the current object
p7783
aVThere is no permission that controls it's presence; the menu item is hardcoded
p7784
aVFrom the  source:
p7785
aVTo provide your own implementation (perhaps using a subclass that removes the last option again if certain conditions are met), you'd have to use an  to redefine the  registration
p7786
aVIn your  you'd have to point to your own implementation using the following  declaration:
p7787
aVthen in  create a  class, something like:
p7788
as(dp7789
g16
V100297
p7790
stp7791
a((dp7792
g2
(lp7793
VThere is a difference between  (and integer),  (a string), and any custom class whose  method returns the string  when called
p7794
aVThey will all be printed as  in the console, but are not equivalent for dict look-ups
p7795
aVYou need to check that  is indeed an
p7796
aVUpdate: Your  method doesn't return integers, it returns a new instance of your  class
p7797
aVDid you mean to return just the values themselves
p7798
ag6579
ag1298
ag4212
as(dp7799
g16
V100297
p7800
stp7801
a((dp7802
g2
(lp7803
VThe Pyramid documentation includes a tutorial on integrating Pyramid with SQLAlchemy
p7804
aVThere are two special packages that integrate SQLAlchemy transactions and session management with Pyramid,  and
p7805
aVThese together take care of your sessions:
p7806
aVHere we take the configuration settings from your  configuration file; and in :
p7807
aVNote the use of a  there, using the transaction extension to integrate with Pyramid
p7808
aVThen in views, all you need to do is use the  session factory to get your sessions:
p7809
aVCommitting and rolling back will be integrated with the request; commit on 2xx and 3xx, rollback on exceptions, for example
p7810
as(dp7811
g16
V100297
p7812
stp7813
a((dp7814
g2
(lp7815
VIt's a triple-quoted python string literal
p7816
aVYou can use  as well
p7817
aV(The  in front signals the literal is a raw string; e
p7818
ag1298
aVmost escape sequences are ignored; this applies to both single and triple-quoted strings)
p7819
aVThese strings preserve newlines, unlike single-quoted strings, where you'd have to use the  newline escape code instead:
p7820
aVThe format has a miriad of uses
p7821
aVIf I need to define a multi-line constant, I often use a backslash after the opening triple-quote to end up with a very readable string literal:
p7822
aVThe most common usage however, is as a docstring; the first string literal of a function, class or module automatically is assigned to that object's  attribute, for easy retrieval later by other tools (such as pydoc and doctests, especially if you follow the docstring conventions
p7823
aVBy convention these usually are defined using tripple-quoted literals, even if there is only one line of documentation
p7824
as(dp7825
g16
V100297
p7826
stp7827
a((dp7828
g2
(lp7829
VPython is clever; it'll use double quotes for strings that contain single quotes when generating the representation, to minimize escapes:
p7830
aVAdd a double quote in there as well and it'll revert back to single quotes and escape any single quotes contained:
p7831
as(dp7832
g16
V100297
p7833
stp7834
a((dp7835
g2
(lp7836
VNot sure how that'd work with tweepy, but you want to set  to True, and the Twitter API will include the full URLs of  URLs with responses
p7837
aVProbably something like:
p7838
as(dp7839
g16
V100297
p7840
stp7841
a((dp7842
g2
(lp7843
VYou'd need to close the file first, then reopen it for that to work; and use binary mode to open your file
p7844
aVLast but not least, pickle can store instances of classes only, not the classes themselves:
p7845
aVHere I've used the file as a context manager, it'll close automatically when the  suite is exited
p7846
as(dp7847
g16
V100297
p7848
stp7849
a((dp7850
g2
(lp7851
VAn expression using  or  short-circuits when it can determine that the expression will not evaluate to True or False based on the first operand, and returns the last evaluated value:
p7852
aVThis 'side-effect' is often used in python code
p7853
aVNote that  does return a boolean value
p7854
aVSee the python documentation on boolean operators for the details
p7855
as(dp7856
g16
V100297
p7857
stp7858
a((dp7859
g2
(lp7860
V should work just fine for an  test:
p7861
aVAll  does is run the same test as above and set a helpful message if the test fails
p7862
as(dp7863
g16
V100297
p7864
stp7865
a((dp7866
g2
(lp7867
V should be a keyword argument in your declaration of :
p7868
aVSee the documentation on
p7869
aVYou can use a  callable to configure the back reference explicitly, but you'd have to still use the  keyword:
p7870
as(dp7871
g16
V100297
p7872
stp7873
a((dp7874
g2
(lp7875
VYou have two options:
p7876
aVList additional paths in a  file in one of the standard locations (usually your  location)
p7877
aVSee How to add a Python import path using a
p7878
aVpth file as well
p7879
aVAdd additional paths to  in  or  modules (detailed in the  module documentation)
p7880
aVYour  or  could look something like:
p7881
aVwhere the two extra entries would be inserted into  at the front
p7882
aVYou can also call  with a path in such a module, which will add that path to  and process any  files found there
p7883
as(dp7884
g16
V100297
p7885
stp7886
a((dp7887
g2
(lp7888
VYou'd need to augment your list with indices:
p7889
aVIt'll return the index and closest-to-zero value, use  if you only need the index
p7890
aVOn your example:
p7891
aVThis is very efficient (worst-case O(n)); you can use  as well, but that has to go through the list twice in the worst case (O(2n))
p7892
as(dp7893
g16
V100297
p7894
stp7895
a((dp7896
g2
(lp7897
VIf you are willing to switch to  instead, you can use an XPath 1
p7898
aV0 expression to find these:
p7899
aVUsing an lxml XPath expression will be an order of a magnitude faster than using a BeautifulSoup regular-expression match
p7900
as(dp7901
g16
V100297
p7902
stp7903
a((dp7904
g2
(lp7905
VThe  method gives you filenames without paths only, you are probably trying to open a file in the current directory, not in the directory named by
p7906
aVYou have to use the  function to put  and  together:
p7907
as(dp7908
g16
V100297
p7909
stp7910
a((dp7911
g2
(lp7912
VDid you find the Celery periodic tasks documentation
p7913
aVYou'll have to use the identifier of your method to register a scheduler entry
p7914
aVIf your  task lives in a module named , the  value of the  structure should be
p7915
aVCelery will import the task for you, provided that  would work
p7916
aVCheck the  API; the following should execute on weekdays at 07:30 am:
p7917
aVRemember that this task is going to be performed asynchronously
p7918
aVYou cannot query for a database object when you schedule this task and expect it to be there still when the task is called
p7919
aVThus, you should only pass in python values that remain constant, and have your task connect to the database and look things up based on the arguments you pass in
p7920
aVIf this task is only ever going to execute tasks for one specific user, then by all means pass in the identifier for that user (user id, email, whatever you can use to look up the user from the database)
p7921
as(dp7922
g16
V100297
p7923
stp7924
a((dp7925
g2
(lp7926
VThere hardly is a difference in the work python performs for either statement:
p7927
aVThe difference is a  versus a
p7928
aVThe resulting timings are too close to call which one would be faster:
p7929
aVSo, in python, the difference is negligible
p7930
aVDon't worry about it
p7931
as(dp7932
g16
V100297
p7933
stp7934
a((dp7935
g2
(lp7936
VYou probably made a typo in your example; the correct spelling would be , not
p7937
aVSince the latter would produce a name error I'm sure you knew that already
p7938
aV:-)
p7939
aVThere is no point in putting a security declaration on a static method, that's only applicable to class methods (the declaration is stored on the class, not the method)
p7940
aVThe decorator is being applied to the result of the security declaration line, not the function definition below it
p7941
aVIn other words, you now have a  static method on your class
p7942
aVThe usual way to provide such utility methods in Plone is to use a ZCA utility registration though, not a static method
p7943
as(dp7944
g16
V100297
p7945
stp7946
a((dp7947
g2
(lp7948
VYou would have to use a custom subclass of list to detect changes:
p7949
aVYou'd need to override each mutating method, call the original method (through ), then call
p7950
aVFor a list of methods, see the Emulating container types section
p7951
as(dp7952
g16
V100297
p7953
stp7954
a((dp7955
g2
(lp7956
VNo; there is no metadata present to make such a call, so there is nothing  (or any other tool) could use to determine what version of a package would work with your version of python
p7957
aVThe only option you have is to use a version pin when installing:
p7958
aVNote the  switch there; since you already tried to install the latest version, you may need to ignore any installed version to force the downgrade
p7959
aVNote that the Trove python version classifiers () can not be relied upon for this task; they are set by the developer if they remember to do so, but cannot be updated later on to indicate compatibility with new python versions
p7960
aVThey should be seen as a way to help refine searches on PyPI and other package indexes, not as metadata used by installers
p7961
as(dp7962
g16
V100297
p7963
stp7964
a((dp7965
g2
(lp7966
VYes, you could use a  to add additional arguments to your function when using it in a
p7967
aVIt'll be easier to use a list comprehension though:
p7968
aVThe way your string is structured (spaces both between fields and inside of the fields) you'll have to use a method like a regex or dedicated function to split out the fields
p7969
as(dp7970
g16
V100297
p7971
stp7972
a((dp7973
g2
(lp7974
VTwo things might be wrong:
p7975
aVThe DNS lookup is failing for ; test with
p7976
aVThis could be a local problem; test against the Google DNS servers too with  and
p7977
aVIf all these lookups fail, sacrifice a chicken to the Internet Gods and wait for improvement
p7978
aVIf the DNS lookup is not failing, but the install is, then your local DNS cache might be holding on to a negative lookup
p7979
aVFlush it with the command
p7980
as(dp7981
g16
V100297
p7982
stp7983
a((dp7984
g2
(lp7985
VYou are relying on the data from the serial line to contain newlines, you never write your own
p7986
aVIt may be that the serial data contains carriage returns (often interpreted in the same way as newlines) as well, you'd need to clean those out
p7987
aVRemove the carriage returs from the serial data (optional), and add an explicit newline when you write:
p7988
aVNow you always write a newline at the end of each received line (even if the readline() call didn't return one), and you are certain that no  carriage return caused a line break elsewhere
p7989
as(dp7990
g16
V100297
p7991
stp7992
a((dp7993
g2
(lp7994
VUse an auxiliary  to track what filenames you have seen already:
p7995
aVOr, more readable as a loop:
p7996
as(dp7997
g16
V100297
p7998
stp7999
a((dp8000
g2
(lp8001
VMethods have an  attribute, that points to the class in question
p8002
aVYou can use that filter on functions that are members of the class:
p8003
aVThis gives you:
p8004
aVOf course, you can just bypass  altogether then:
p8005
aVgives:
p8006
aVThis applies to bound or unbound methods, they have same  (or , the old name) attribute
p8007
aVThe difference between bound and unbound is the value of the  attribute (None when unbound)
p8008
aVThese "secret" attributes are all documented in the Python Data Model
p8009
as(dp8010
g16
V100297
p8011
stp8012
a((dp8013
g2
(lp8014
VYou are talking about list comprehensions, not generator expressions
p8015
aVYou need to swap your for loops:
p8016
aVYou need to read these as if they were nested in a regular loop:
p8017
aVList comprehensions with multiple loops follow the same ordering
p8018
aVSee the list comprehension documentation:
p8019
aVWhen a list comprehension is supplied, it consists of a single expression followed by at least one  clause and zero or more  or  clauses
p8020
aVIn this case, the elements of the new list are those that would be produced by considering each of the  or  clauses a block, nesting from left to right, and evaluating the expression to produce a list element each time the innermost block is reached
p8021
aVThe same thing goes for generator expressions, of course, but these use  parenthesis instead of square brackets and are not immediately materialized:
p8022
as(dp8023
g16
V100297
p8024
stp8025
a((dp8026
g2
(lp8027
VIn this particular case, I'd actually try and detect the database before selecting the function
p8028
aVCan you reach the database connection from your code
p8029
aVIf so, just switch on the drivername:
p8030
aVThen, when selecting images, use the  value:
p8031
as(dp8032
g16
V100297
p8033
stp8034
a((dp8035
g2
(lp8036
VZope supports your scenario out-of-the-box with some special rewriting, using a  flags in the path
p8037
aVThis ensures that any URLs generated by Zope (and by extension, Plone) are correct for proxied requests as well
p8038
aVYou should use both  and , they'll be working in concert
p8039
aVTo make creating the right rewrite URLs easier, someone built an excellent RewriteRule Witch
p8040
aVPlugging in your specific example outputs:
p8041
aVThus, for any URLs rooted at , rewrite these to be served from the server running on localhost port 8080, making sure that Zope generates URLs with the same root
p8042
aVSee the detailed documentation on the VirtualHostMonster feature on the Zope wiki for more details
p8043
as(dp8044
g16
V100297
p8045
stp8046
a((dp8047
g2
(lp8048
V is the basic object type in python
p8049
aVLike many object types in python, it acts as a constructor for creating new types, but in it's simplest form it'll return the type of existing objects
p8050
aVIt then looks like a function
p8051
aVCompare this to  and , for example
p8052
aVIn python, you can create new types, also called metaclasses, allowing you to do all sorts of powerful and interesting tricks in Python
p8053
aVBasing a class definition on  means you are creating a new metaclass
p8054
aVSee What is a metaclass in Python
p8055
aVfor an in-depth answer on what metaclasses are
p8056
as(dp8057
g16
V100297
p8058
stp8059
a((dp8060
g2
(lp8061
VYour old encoding, presumably, was Latin 1
p8062
aVYou probably can detect when a string was encoded with Latin-1 and not UTF-8 by looking at consecutive bytes
p8063
aVThe UTF-8 standard has a distinctive codepage layout that we could use to detect if a piece of text was encoded with either Latin-1 or UTF-8:
p8064
aVAny byte in the range 00-7F is safe, of course, these are ASCII values and these codepoints match between the two encodings
p8065
aVNo help here, no help needed
p8066
aVThe bytes C0, C1 and F5-FF are illegal in UTF-8 encoding
p8067
aVAny string containing these must be Latin-1 encoded
p8068
aVBytes in the range C2-DF must be followed by a byte in the range 80-BF
p8069
aVIf you have any two bytes that do not match this you probably have a Latin-1 encoded string on your hands
p8070
aVIf all you ever encoded is Latin-1 characters (up to Unicode code point 255) you could stop here; anything containing bytes in the range E0-FF would be old Latin-1 data
p8071
aVIf you did add data in UTF-8 since you switched, that's outside of the Latin-1 range, you need to include the following rules too:
p8072
aVBytes in the range E0-EF mark a 3-byte UTF-8 character
p8073
aVThe next two bytes must fall in the range 80-BF again
p8074
aV3 UTF-8 bytes data covers the rest of the BMP, you are unlikely to encode outside of this
p8075
aVIf you do encode outside of this though, look for:
p8076
aVBytes in the range F0-F4 must be followed by exactly 3 bytes in the range 80-BF
p8077
aVIf all these criteria are matched, you probably have a UTF-8 string, but you can not be 100% certain
p8078
aVIf any of them do not match you definitely have a Latin-1 string
p8079
aVBut, the Latin-1 codepoints C2-DF are unlikely to ever be followed by codepoints 80-BF, as most of the latter are either control codes or more esoteric diacritical marks
p8080
aVPerhaps you can narrow things down further by looking for multiple 2-byte UTF-8 sequences to increase your confidence score
p8081
aVSo, in conclusion (tl;dr): you can find most Latin-1 encoded strings by looking at multi-byte sequences
p8082
aVIf they do not fall within the rigid UTF-8 criteria, you have a Latin-1 string on your hand
p8083
as(dp8084
g16
V100297
p8085
stp8086
a((dp8087
g2
(lp8088
VYou have reached a new level in computer science, and you are coming of age
p8089
aVYou therefore are now ready for the next step
p8090
aVI have been authorized by the BDFL himself to reveal the following Super Secret document to you
p8091
aVThe ancients understood it and deciphered it first, and now, so will you
p8092
aVThe Floating Point Guide
p8093
aVTreat this document with care
p8094
aVOnly share this with people you know have reached the same baffling conclusions
p8095
as(dp8096
g16
V100297
p8097
stp8098
a((dp8099
g2
(lp8100
VNeither will be deprecated
p8101
aVElementTree (xml
p8102
aVetree) is a pythonic API to access XML
p8103
aVDOM (xml
p8104
aVdom) is a cross-platform, language independent standard
p8105
aVUse ElementTree unless you have a compelling reason to use the XML DOM instead
p8106
aVFor python code, the ElementTree API is far easier to use than the DOM API
p8107
aVIf you are not averse to installing extra python libraries, you should take a look at the  library as well; it implements the ElementTree API as well, on top of very fast C libraries, and adds a few more options to work with XML effectively
p8108
as(dp8109
g16
V100297
p8110
stp8111
a((dp8112
g2
(lp8113
VYou'll need to 'unwind', or flatten the nested structure before you can put this in a set
p8114
aVYou can use a generator for that to keep this efficient for large lists:
p8115
aVthen use that generator on your list  to create a set:
p8116
as(dp8117
g16
V100297
p8118
stp8119
a((dp8120
g2
(lp8121
VYou can use a lambda, or anonymous function:
p8122
aVAlternatively, just use a list comprehension:
p8123
as(dp8124
g16
V100297
p8125
stp8126
a((dp8127
g2
(lp8128
VYou'll need to save the request file to a temporary file on disk, as the  library has no other way of opening an Excel file, it appears
p8129
aVHere is a generic solution you can use:
p8130
aVWhat this does is:
p8131
aVCreate a temporary file
p8132
aVCopy the request data into the file
p8133
aVReturn the filename of that temporary file for you to use in the context manager (everything within the  suite)
p8134
aVWhen your context manager is done, it cleans up the temporary file for you
p8135
as(dp8136
g16
V100297
p8137
stp8138
a((dp8139
g2
(lp8140
V only issues encrypted authentication cookies, and are not, in a technical sense, tied to sessions
p8141
aVYou can only use this to identify, securely, that a user is still the same entity that logged in during an earlier HTTP connection
p8142
aVThe cookie contains all the information needed to re-identify the user on every HTTP request
p8143
aVcookies are compatible with the  Apache module
p8144
aVA  session on the other hand, uses a cookie to tie a returning browser connection to some persistent server-side information
p8145
aVUsing such a session allows your application to associate arbitrary data with a website visitor, that is not stored in the browser
p8146
aVSee Webserver Session management on Wikipedia
p8147
as(dp8148
g16
V100297
p8149
stp8150
a((dp8151
g2
(lp8152
VI always use:
p8153
aVas the intid utility is registered with the local component manager
p8154
as(dp8155
g16
V100297
p8156
stp8157
a((dp8158
g2
(lp8159
VFirst of all, locking in any language is a performance bottleneck
p8160
aVMinimize locking where possible; don't use shared directories for example, create a tree instead and have each thread work in a different branch of that tree
p8161
aVSince you'll be doing a lot of I/O, your performance problems will lie there and threading is not necessarily going to improve matters
p8162
aVLook into event-driven architectures first:
p8163
aVThe stdlib  module
p8164
aVThe GIL is not likely to be your problem here; it'll be released whenever a thread enters C code, for example (almost certainly during any I/O call)
p8165
aVIf it ever does become a bottleneck, move to multiple processes
p8166
aVOn a large intranet cluster I administer, for example, we run 6 processes of each 2 threads to make full use of all the CPU cores (2 of the processes carry a very light load)
p8167
aVIf you feel you need multiple processes, either use the  module or make it easy to start multiple instances of your server (each listening on a different port) and use a load balancer such as haproxy to direct traffic to each server
p8168
as(dp8169
g16
V100297
p8170
stp8171
a((dp8172
g2
(lp8173
VThe Tkinter module is a little old-skool; the  value can be accessed via an item lookup:
p8174
aVSee the Setting Options section of the Tkinter documentation
p8175
as(dp8176
g16
V100297
p8177
stp8178
a((dp8179
g2
(lp8180
VYou need to turn everything in the list into strings, using the  constructor:
p8181
aVNote that it's generally not a good idea to use  for a variable name, it'll shadow the built-in  constructor
p8182
aVI've used a generator expression there to apply the  constructor on each and every element in the list
p8183
aVAn alternative method is to use the  function:
p8184
aVThe backticks in your example are another spelling of calling  on a value, which is subtly different from ; you probably want the latter
p8185
aVBecause it violates the Python principle of "There should be one-- and preferably only one --obvious way to do it
p8186
aV, the backticks syntax has been removed from Python 3
p8187
as(dp8188
g16
V100297
p8189
stp8190
a((dp8191
g2
(lp8192
VFirst of all, you don't need to create a  to use ; all you want is a unique filename for the  file to create
p8193
aVdoesn't return a filename
p8194
aVTo focus on that error: You are assuming that the return value of  is a filename you can open; just seek to the start of your file and read instead:
p8195
aVNote that you'll also need to clean up the temporary file you created (you set ):
p8196
aVAlternatively, just omit the  keyword to have it default to  again and only close your file afterwards, no need to unlink
p8197
aVThat just wrote the archive filename to a new file
p8198
aVYou are just writing the new archive name to your temporary file
p8199
aVYou'd be better off just reading the archive directly:
p8200
aVNote that now your temporary file isn't being written to at all
p8201
aVBest way to do this
p8202
aVAvoid creating a  altogether: Use  instead, to generate a temporary directory in which to put your archive, then clean that up afterwards:
p8203
as(dp8204
g16
V100297
p8205
stp8206
a((dp8207
g2
(lp8208
VUse the  function:
p8209
aVwhere  is then the index
p8210
as(dp8211
g16
V100297
p8212
stp8213
a((dp8214
g2
(lp8215
V is not a python module and pip won't ever be able to install it
p8216
aVUse your Operating System's packaging system to install it
p8217
aVOn Ubuntu and Debian that'd be apt, for example
p8218
as(dp8219
g16
V100297
p8220
stp8221
a((dp8222
g2
(lp8223
VNope, there isn't
p8224
aVThe  operator is just not needed that often to justify having to maintain a C-optimized method and adding confusion to the python API
p8225
aVThe  test for lists and tuples does do a full search similar to , albeit in C, btw
p8226
aVIn sets however, the test makes use of the efficient storage algorithm underlying the container and the search takes constant time in the expected case
p8227
aVFor both sets and mappings, keys are supposed to have a stable hash, which in most cases means  should not be needed, really
p8228
aVSo, the correct spelling is:
p8229
as(dp8230
g16
V100297
p8231
stp8232
a((dp8233
g2
(lp8234
VGenerally you don't need to use getters and setters in Python
p8235
aVIf however, you want to expose the result of a procedure as a property, you can use the  decorator:
p8236
aVIt is more common to just store the value of  in an attribute
p8237
aVThis can be calculated in the  instance initializer:
p8238
as(dp8239
g16
V100297
p8240
stp8241
a((dp8242
g2
(lp8243
VYou created a circular import
p8244
aVYou can't do that
p8245
aVAvoid importing  from
p8246
aVWhat is happening is that a module, while being imported, is incomplete until the whole top level has been executed
p8247
aVIf during that execution it imports another module that (directly or indirectly) tries to import the original module again, this will fail
p8248
aVThe original module was not yet done importing yet
p8249
aVIn other words, you are creating a circular graph:
p8250
aVYou need to re-arrange your code to not need to import from  from within your  package
p8251
aVSee What are the \u201cbest practices\u201d for using import in a module
p8252
aVfor some tips on how to handle this
p8253
as(dp8254
g16
V100297
p8255
stp8256
a((dp8257
g2
(lp8258
VChange
p8259
aVto
p8260
aVor
p8261
aVBy passing  to the  you do not create a copy of the list, you just re-use the existing one
p8262
aVBy using  or  you create a copy instead
p8263
as(dp8264
g16
V100297
p8265
stp8266
a((dp8267
g2
(lp8268
VThe global tabs in Plone are navigation roots
p8269
aVYou can detect the current active navigation root in two ways:
p8270
aVThe body HTML tag has a  CSS class, where  varies with the pathname of each section
p8271
aVFrom a viewlet or portlet you can retrieve these classes using the  view:
p8272
aVafter which you'll have to test if a certain  string is present in the bodyClass value
p8273
aVBy retrieving he current navigation root directly from the  view:
p8274
aVYou can then vary your viewlet or portlet based on the
p8275
aVNote however that each navigation root is has a portal type, and possibly an interface declaration, that you could use to register viewlets or portlets for
p8276
aVDetecting the exact navigation is usually not the best option
p8277
as(dp8278
g16
V100297
p8279
stp8280
a((dp8281
g2
(lp8282
VThe external modulename would be
p8283
aVHowever, Heroku runs Python 2
p8284
aV7 and if  is not supported, Heroku will not have the pre-requisite sqlite C libraries installed
p8285
aVI thus suspect that loading the  module will not work either
p8286
aVNote that there is really no point in using sqlite on the Heroku platform, as the filesystem is ephemeral; every time your app starts you have a clean slate and any writes performed by your app disappear once done
p8287
aVSince sqlite can only write to the local filesystem, this means the database will be gone the next time you start your app
p8288
aVSee Using Sqlite3 on Heroku Cedar stack
p8289
as(dp8290
g16
V100297
p8291
stp8292
a((dp8293
g2
(lp8294
V is part of the persistence structure of a ; it exists to try and reduce conflict errors, and it does try and resolve conflicts where possible
p8295
aVThat said, conflicts are not always avoidable, and you should restart your transaction
p8296
aVIn Zope, for example, the whole request is re-run up to 5 times if a  is raised
p8297
aVConflicts are ZODB's way of handling the (hopefully rare) occasion where two different requests tried to change the exact same data structure
p8298
aVRestarting your transaction means calling  and applying the same changes again
p8299
aVThe  will fetch any changes made by the other process and your commit will be based on the fresh data
p8300
as(dp8301
g16
V100297
p8302
stp8303
a((dp8304
g2
(lp8305
VHaven't checked this in-depth, but the form is probably wrapped by the plone  class
p8306
aVLook for a  attribute on the  instance:
p8307
aVIt may be you need to add an additional interface to the request for this to work (the wrapper normally does this for you
p8308
aVI'm a little low on time right now, so you get this untested:
p8309
aVThe Plone Knowledgebase uses this same setup to show a form in a viewlet
p8310
as(dp8311
g16
V100297
p8312
stp8313
a((dp8314
g2
(lp8315
VYou need to specify that the parts are alternatives of one another, e
p8316
ag1298
aVthe  mime type:
p8317
aVThe default is ; see the email library examples
p8318
aVNote that to create an email with both attachments and an alternative (HTML / CSS) option you'll need to have a top-level  container that contains the  parts as the first entry
p8319
as(dp8320
g16
V100297
p8321
stp8322
a((dp8323
g2
(lp8324
VFrom the sqlite FAQ:
p8325
aVFrom within a C/C++ program (or a script using Tcl/Ruby/Perl/Python bindings) you can get access to table and index names by doing a  on a special table named "SQLITE_MASTER"
p8326
aVEvery SQLite database has an  table that defines the schema for the database
p8327
aVThe  table looks like this:
p8328
aVSo to get a list of all table names execute:
p8329
aVTo get column names for a given table, use the  command:
p8330
aVThis pragma returns one row for each column in the named table
p8331
aVColumns in the result set include the column name, data type, whether or not the column can be NULL, and the default value for the column
p8332
aVThis command works just fine from python:
p8333
aVUnfortunately  statements do not work with parameters; you'll have to manually insert the table name (make sure it's not sourced from an untrusted source and escape it properly)
p8334
as(dp8335
g16
V100297
p8336
stp8337
a((dp8338
g2
(lp8339
VI think you need to look into the ZODB
p8340
aVThe ZODB is an object database that uses pickle to serialize data, is very adept at handling hierarchies of objects, and if your objects use the included  base-class, will detect and only save the objects that changed when you commit; e
p8341
ag1298
aVthere is no need to write out the whole hierarchy on every little change
p8342
aVIncluded in the ZODB project is a package called , which are ZODB aware and make storing thousands of objects in one place efficient
p8343
aVUse these for your Region object to store the Columns
p8344
aVWe use BTrees to store millions of datapoints at times
p8345
as(dp8346
g16
V100297
p8347
stp8348
a((dp8349
g2
(lp8350
VPresumably dotcloud and openshift run multiple processes of your code; the dict is not going to be shared between these processes
p8351
aVNote that that also means the extra processes will not have access to your extra tread either
p8352
aVUse an external database for this kind of information instead
p8353
aVFor long-running asynchronous jobs like these you also need to run them in a separate worker process
p8354
aVLook at Celery for an all-in-one solution for asynchronous job handling, for example
p8355
as(dp8356
g16
V100297
p8357
stp8358
a((dp8359
g2
(lp8360
VYou can't, yet
p8361
aVSQLAlchemy up to 0
p8362
ag4892
aVx do not support the  syntax, but it will be supported in the upcoming 0
p8363
ag1140
aV0 release, see issue 2506
p8364
aVThe  keyword is implemented as a select hint:
p8365
as(dp8366
g16
V100297
p8367
stp8368
a((dp8369
g2
(lp8370
VSure you can; you can use a class decorator that takes class A as an argument, then updates the decorated class for you:
p8371
aVThe decorator copies anything that is really an attribute (not a function or a property), and doesn't start with a double underscore
p8372
aVUsage:
p8373
aVTested on the prompt:
p8374
as(dp8375
g16
V100297
p8376
stp8377
a((dp8378
g2
(lp8379
VYou get it because you are decoding from a bytestring without specifying a codec:
p8380
aVAdd a codec there (here I assume your data is encoded in utf-8,  would be the first of a 3-byte character):
p8381
as(dp8382
g16
V100297
p8383
stp8384
a((dp8385
g2
(lp8386
VYou need to start a new transaction before the  call; MySQL sees you reading from the table in this transaction, and locks the table against being dropped:
p8387
aVCommitting a transaction implicitly begins a new transaction
p8388
aVMySQL makes guarantees about transaction isolation; your transaction will read consistent data and won't see changes committed by other transactions until you start a new transaction
p8389
aVA  statement however makes it impossible for MySQL to keep these guarantees so the table is being locked
p8390
aVAlternatively, you could alter the transaction isolation level, telling MySQL you don't care about the isolation guarantees
p8391
aVBecause session connections are pooled, this can only be done for all connections or none at all; use the  argument to :
p8392
aVSee the  documentation for details about each isolation level
p8393
as(dp8394
g16
V100297
p8395
stp8396
a((dp8397
g2
(lp8398
VYou have no  or  in your input string, yet your regular expression requires at least one of those characters to be there ()
p8399
aVUpdate: Your regular expression is suffering from catastrophic backtracking; avoid the nested character-class-or-character-set combination in a group with a wildcard (the  parts inside a  listed above)
p8400
aVYou can put character classes inside a character set to avoid this
p8401
aVAlso note, that you can use the  raw string notation to avoid all the escaped backslashes
p8402
aVThe following works:
p8403
aVbecause it compiles to:
p8404
aVNote that now the branches are gone
p8405
as(dp8406
g16
V100297
p8407
stp8408
a((dp8409
g2
(lp8410
VUse the  function with a generator expression:
p8411
aVWhat this does is loop over , and for each  in  we test if the second value in it is equal to , just like your loop
p8412
aVBut it'll only do this until it finds an element for which this is true, then stop, returning
p8413
aVIf it doesn't find such an element, it'll return  instead
p8414
aVIf, instead, you don't just want to test for the presence of  but also want to know where it is located, the most efficient method is to use a loop like you did
p8415
aVYou can use  to give you both the index and the value in a sequence:
p8416
as(dp8417
g16
V100297
p8418
stp8419
a((dp8420
g2
(lp8421
VDjango is an all-in-one package, while Pyramid and Flask give you more flexibility
p8422
aVTake a look at the Babel project; you can localize your forms using that package with ease
p8423
as(dp8424
g16
V100297
p8425
stp8426
a((dp8427
g2
(lp8428
VWhen you use the  call on a  instance you indeed get an open file handle
p8429
aVHowever, to read a zip file, the  class needs a little more
p8430
aVIt needs to be able to seek on that file, and the object returned by  is not seekable
p8431
aVThe workaround is to read the whole zip entry into memory using , store it in a  object (an in-memory file that is seekable) and feed that to :
p8432
as(dp8433
g16
V100297
p8434
stp8435
a((dp8436
g2
(lp8437
VNormally using weak references means that you cannot prevent objects from being garbage collected
p8438
aVHowever, there is a trick you can use to prevent objects part of a reference cycle from being garbage collected: define a  method on these
p8439
aVFrom the  module documentation:
p8440
aVgc
p8441
aVgarbage
p8442
aVA list of objects which the collector found to be unreachable but could not be freed (uncollectable objects)
p8443
aVBy default, this list
p8444
aVcontains only objects with  methods
p8445
aVObjects that have
p8446
aVmethods and are part of a reference cycle cause the entire reference cycle to be uncollectable, including objects not necessarily
p8447
aVin the cycle but reachable only from it
p8448
aVPython doesn\u2019t collect such
p8449
aVcycles automatically because, in general, it isn\u2019t possible for Python
p8450
aVto guess a safe order in which to run the  methods
p8451
aVIf you
p8452
aVknow a safe order, you can force the issue by examining the garbage
p8453
aVlist, and explicitly breaking cycles due to your objects within the
p8454
aVlist
p8455
aVNote that these objects are kept alive even so by virtue of
p8456
aVbeing in the garbage list, so they should be removed from garbage too
p8457
aVFor example, after breaking cycles, do  to empty the
p8458
aVlist
p8459
aVIt\u2019s generally better to avoid the issue by not creating cycles
p8460
aVcontaining objects with  methods, and garbage can be examined
p8461
aVin that case to verify that no such cycles are being created
p8462
aVWhen you define  as follows:
p8463
aVthen your example script prints:
p8464
aVbut commenting out one of the  calls results in:
p8465
aVIn other words, by simply having defined a  method, we prevented the reference cycle from being garbage collected, but any orphaned objects are being deleted
p8466
aVNote that in order for this to work, you need circular references; any object in your object graph that is not part of a reference circle will be picked off regardless
p8467
as(dp8468
g16
V100297
p8469
stp8470
a((dp8471
g2
(lp8472
VBabel's message extraction is extensible, and you need to create dedicated extractors for new types
p8473
aVYou don't specify what 'serious issues' you (or your friend) found, so it's hard to help you here in more detail, but any issues with specific formats come down to faulty extraction code
p8474
aVBabel supports loading extractors from eggs using , and as a result there is a large list of such extractors listed on PyPI (the linked search lists anything related to Babel, but a large number of those are extractors; there is no Trove classifier for Babel extractors yet)
p8475
aVYou can use additional PyPI searches for specific template systems to see if there are Babel extractors for those
p8476
as(dp8477
g16
V100297
p8478
stp8479
a((dp8480
g2
(lp8481
VUpgrade your copy of SublimeCodeIntel
p8482
aVIn a terminal type:
p8483
aVand restart your Sublime editor
p8484
aVThe latest revision supports version 2
p8485
ag2391
aV24
p8486
aVNot sure how your database was upgraded with your SublimeCodeIntel copy being older; perhaps you ran a copy of the Komodo IDE
p8487
aVIt uses codeintel too; in fact, this is where codeintel stems from
p8488
as(dp8489
g16
V100297
p8490
stp8491
a((dp8492
g2
(lp8493
VI see no problems with using locally-scoped functions like these
p8494
aVUnless the outer function is going to be called a lot the performance impact would be minimal; the code for both functions is already compiled when the outer function is being called, for instance
p8495
aVAll that happens extra is that the code object constant is loaded, attached to a function and that function is stored in a local variable
p8496
aVBy keeping them locally scoped you make it abundantly clear that their utility is to the  scope only
p8497
as(dp8498
g16
V100297
p8499
stp8500
a((dp8501
g2
(lp8502
VYou need to list your type in the  property of the  property sheet in the  tool
p8503
aVTo do this manually, navigate to the ZMI, find the tool and click on it, then click on the  sheet, then find the  entry and add the  of your custom type in that list
p8504
aVTo automate this, add a  file to the GenericSetup profile of your package that defines the type, and make sure it contains the following:
p8505
aV(with your  value filled in) and re-import the profile
p8506
as(dp8507
g16
V100297
p8508
stp8509
a((dp8510
g2
(lp8511
VYou would need to introspect the  method and extract any default values from there
p8512
aVThe  function would be helpful there
p8513
aVThe  function returns (among others) a list of argument names, and a list of default values
p8514
aVYou can combine these to find the default argument specification of a given function, then use that information to set attributes on the object:
p8515
aVWith the above metaclass you can omit any of the arguments and they'll be set on the new instance, or you can override them by passing them in explicitly:
p8516
as(dp8517
g16
V100297
p8518
stp8519
a((dp8520
g2
(lp8521
VYou need to make a subquery where you create member counts, then do a simple divisor query with a  statement, but against a  clause instead of against another table
p8522
aVBecause this is python, you already know the size of the static set
p8523
aVI'll assume you already have a database cursor, and the table is called :
p8524
aVThere is thus no need to use a TEMP table to execute this query
p8525
aVIf you do need a TEMP table for other purposes, inserting a set of rows is easiest with :
p8526
aVNote that  expects a sequence of sequences; each entry is a sequence of row data, which in this case only holds one name each
p8527
aVI generate a list of single-item tuples to fill the table
p8528
aVAlternatively, you can use a sequence of mappings too and use the  parameter syntax (so the row data sequence becomes )
p8529
as(dp8530
g16
V100297
p8531
stp8532
a((dp8533
g2
(lp8534
VSimply subtract a day from the given date, then check if the date is a weekday
p8535
aVIf not, subtract another, until you do have a weekday:
p8536
aVDemo:
p8537
aVAlternatively, use an offset table; no need to make this a mapping, a tuple will do just fine:
p8538
as(dp8539
g16
V100297
p8540
stp8541
a((dp8542
g2
(lp8543
VYou are not quoting the search string, and the database is interpreting it as a column name instead
p8544
aVUse query parameters, these quote your search string automatically:
p8545
aVNext, if the  (column) value is not coming from an untrusted source (such as a web page) you can interpolate it directly into your query:
p8546
aVNow you no longer need all the branching
p8547
aVIf the  value does come from an untrusted source, the simplest thing is to just test if it is an allowed value:
p8548
as(dp8549
g16
V100297
p8550
stp8551
a((dp8552
g2
(lp8553
VYou first reduce  to 2 or lower (), then test if
p8554
aVThat latter test is never going to pass because  will now always be 2 or lower
p8555
aVThat first reduction calculates the fibonacci sequence, and the 6th value in that sequence is 8 (after 1, 1, 2, 3 & 5)
p8556
aVTo avoid your problem, use a simple range loop instead:
p8557
aVNow  will go from 6 to 3 without changing
p8558
as(dp8559
g16
V100297
p8560
stp8561
a((dp8562
g2
(lp8563
V is not supported by the  method used in Python
p8564
aVUse  (microseconds) instead:
p8565
as(dp8566
g16
V100297
p8567
stp8568
a((dp8569
g2
(lp8570
V gives you the attributes of an element, not it's children, and a  element has no  attribute, only  elements
p8571
aVYou'd have to loop over the contained elements of , or use  and  to get individual sub-nodes
p8572
aVDo yourself a big favour though and use the ElementTree API instead; that API is far pythononic and easier to use than the XML DOM API:
p8573
as(dp8574
g16
V100297
p8575
stp8576
a((dp8577
g2
(lp8578
VYou need to set the  keyword to True:
p8579
aVFrom the relevant documentation:
p8580
aVIf  is , the specified command will be executed through the shell
p8581
aVThis can be useful if you are using Python primarily for the enhanced control flow it offers over most system shells and still want access to other shell features such as filename wildcards, shell pipes and environment variable expansion
p8582
aVAliases are a shell feature (e
p8583
ag1298
aVthey are defined and interpreted by the shell)
p8584
aVHowever, the shell (/bin/sh) is executed non-interactively, so no  or  files are read and your alias probably is not going to be available
p8585
aVIf you are reluctant to use the full expanded command into your python script, you'll have to use the  environment variable to make the shell read the file with the alias defined in it anyway:
p8586
as(dp8587
g16
V100297
p8588
stp8589
a((dp8590
g2
(lp8591
VNormally  is the entry point for distribution of distinct packages
p8592
aVAs such, it's hard to then share code between those packages
p8593
aVIf you use  (or it's fork, ) in your , you can specify packages that must be installed when installing your package with the  entry
p8594
aVUnfortunately, your  is executed first; as soon as the  line is parsed, the extra packages listed there will be installed locally, but this may be too late for your needs
p8595
aVThe work-around is to create a separate  object before you call  which defines the  entries:
p8596
as(dp8597
g16
V100297
p8598
stp8599
a((dp8600
g2
(lp8601
VKeys for dictionaries must be hashable items; unfortunately, dictionaries themselves are not hashable (they are mutable, which disqualifies them from being hashable)
p8602
aVUse their item list, converted to a sorted tuple, instead:
p8603
aVMutable objects are not hashable because they can be changed in-place, making later key-lookups fail
p8604
aVWhat would the expected outcome be if you added or removed items from the dictionary you used as the key, for example
p8605
as(dp8606
g16
V100297
p8607
stp8608
a((dp8609
g2
(lp8610
VYou are correct in your first two assumptions
p8611
aVIn C,  exits the function immediately
p8612
aVThe loop is aborted at that point, returning  (which is 5, at that point)
p8613
as(dp8614
g16
V100297
p8615
stp8616
a((dp8617
g2
(lp8618
VThe authorizer callback takes 5 arguments, but yours only accepts four:
p8619
aVThe first argument to the callback signifies what kind of operation is to be authorized
p8620
aVThe second and third argument will be arguments or None depending on the first argument
p8621
aVThe 4th argument is the name of the database (\u201cmain\u201d, \u201ctemp\u201d, etc
p8622
aVif applicable
p8623
aVThe 5th argument is the name of the inner-most trigger or view that is responsible for the access attempt or None if this access attempt is directly from input SQL code
p8624
aVThus, the signature should be:
p8625
aVGenerally, when testing a callback like that, testing is made easy by using a  wildcard parameter:
p8626
aVThe above callback prints out:
p8627
aVwhen I run your test
p8628
aVSee the C reference for SQLite  and the action codes reference for the various constants used
p8629
as(dp8630
g16
V100297
p8631
stp8632
a((dp8633
g2
(lp8634
VPython  objects don't have a time component, so the timestamp you want needs a little qualification
p8635
aVIf midnight suffices, you can use the  method together with the  function to create a timestamp:
p8636
aVIf you need a specific time in the day, use the  class method to construct a , then use the same trick to make it a timestamp:
p8637
aVUse either as a property on your Django model:
p8638
as(dp8639
g16
V100297
p8640
stp8641
a((dp8642
g2
(lp8643
VNo you can't (set permissions for users); that tab sets permissions for roles; see Permissions and roles in the "Understanding permissions" manual
p8644
aVYou can assign roles to individual users and groups
p8645
as(dp8646
g16
V100297
p8647
stp8648
a((dp8649
g2
(lp8650
VYou should (generally) import modules at the top of your own module, not inside functions
p8651
aVA module import binds the imported names to the local scope, which means that if you import things inside a function, the names will only be available to that function and nothing else in your module
p8652
as(dp8653
g16
V100297
p8654
stp8655
a((dp8656
g2
(lp8657
VIndeed,  does not support the  formatter
p8658
aVThe  module includes a parser that does support parsing timezones
p8659
as(dp8660
g16
V100297
p8661
stp8662
a((dp8663
g2
(lp8664
VYou are importing the module datetime, which doesn't have a  function
p8665
aVThat module does have a  object with that method though:
p8666
aVAlternatively you can import the  object from the module:
p8667
aVNote that the  method was added in python 2
p8668
aV5; if you are using an older version use the following code instead:
p8669
as(dp8670
g16
V100297
p8671
stp8672
a((dp8673
g2
(lp8674
VBetter follow the installation instructions; lxml has some C components that require compilation
p8675
aVI am guessing that you are on Windows, in which case the binary egg should work
p8676
aVOn PyPI, the most recent version to include binary eggs for Windows is 2
p8677
aV3, but you can find more recent (unofficial) installers elsewhere
p8678
as(dp8679
g16
V100297
p8680
stp8681
a((dp8682
g2
(lp8683
VYou can't,  only supports the former option
p8684
aVYou can, of course, parse the connection string into it's constituents and use that as a set of keyword parameters for the  function:
p8685
aVThe above splitting method is rather naive however; you probably would need a more sophisticated method that would remove unsupported options, convert certain parameter values (think  and  or ) and allow for escaping of  and  characters where they are part of a parameter value
p8686
aVRefer to the  documentation for supported keyword arguments
p8687
as(dp8688
g16
V100297
p8689
stp8690
a((dp8691
g2
(lp8692
VUse the  module:
p8693
aVYou may want to figure out if your data is a) little or big endian and b) is signed or unsigned; the example above use big-endian ordering and signed values
p8694
aVThe result (in python 3) is a  object
p8695
as(dp8696
g16
V100297
p8697
stp8698
a((dp8699
g2
(lp8700
VYou need to install the MySQLdb module separately; it doesn't come with the Django distribution itself
p8701
aVLike Django, it is available on PyPI, so you can install it with  or
p8702
as(dp8703
g16
V100297
p8704
stp8705
a((dp8706
g2
(lp8707
VYou don't need to call your generator, remove the  brackets
p8708
aVYou are probably confused by the fact that you use the same name for the variable inside the function as the name of the generator; the following will work too:
p8709
aVA parameter passed to the  function is then bound to the local  variable instead of , to make it clear that that local variable is not the same thing as the  function you defined elsewhere
p8710
as(dp8711
g16
V100297
p8712
stp8713
a((dp8714
g2
(lp8715
VThe  parameter can only parse values in the range 0-23
p8716
aVYou'll have to manually deal with those specific time stamps:
p8717
as(dp8718
g16
V100297
p8719
stp8720
a((dp8721
g2
(lp8722
VUser classes are considered mutable
p8723
aVPython doesn't have (absolutely) private attributes, so you can always change a class by reaching into the internals
p8724
aVFor using your class as a key in a   or storing them in a , you can define a  method and a  method, making a promise that your class is immutable
p8725
aVYou generally design your class API to not mutate the internal state after creation in such cases
p8726
aVFor example, if your engines are uniquely defined by their id, you can use that as the basis of your hash:
p8727
aVNow you can use instances of class Engine in sets:
p8728
aVIn the above sample I add another  instance to the set, but it is recognized as already present and the set didn't change
p8729
aVNote that as far as lists are concerned, the  implementation is the important one; lists don't care if an object is mutable or not, but with the  method in place you can test if a given engine is already in a list:
p8730
as(dp8731
g16
V100297
p8732
stp8733
a((dp8734
g2
(lp8735
VWhen using a slice operator on the left-hand side of an assignment, you are telling python to store the sequence on the right-hand side in the selected elements of the list
p8736
aVIn other words, you are not replacing , you are assigning to the elements within
p8737
as(dp8738
g16
V100297
p8739
stp8740
a((dp8741
g2
(lp8742
V is not valid python
p8743
aVRather, it looks like a partial dictionary
p8744
aVSince  code is supposed to return a dict, perhaps you meant the following instead:
p8745
aVAlso note that  means you'll only take the context as an argument
p8746
aVFrom the howto on custom tags:
p8747
aVIf you specify takes_context in creating a template tag, the tag will have no required arguments, and the underlying Python function will have one argument -- the template context as of when the tag was called
p8748
aVThus your tag should be:
p8749
aVand your full method can take the  argument directly from the context:
p8750
as(dp8751
g16
V100297
p8752
stp8753
a((dp8754
g2
(lp8755
VPython variables hold references to values
p8756
aVThus, when you define the  list, you pass in the value referenced by , not the variable itself
p8757
aVYou should imagine values as balloons, with variables being threads tied to those balloons
p8758
aVis a balloon,  is just a thread to that balloon, and the  list has a different thread tied to that same balloon
p8759
aVIn python, a list is simply a series of threads, all numbered starting at 0
p8760
aVWhat you do next is tie the  string to a new balloon , but the list is still holding on to the old thread tied to the  balloon
p8761
aVYou can replace that thread to  held by the list by reassigning the list by index to refer to each thread; in your example that's thread :
p8762
aVHere I simply tied the  thread to the same thing  is tied to, whatever that might be
p8763
aVNote that any collection in python, such as , , , etc
p8764
aVare simply collections of threads too
p8765
aVSome of these can have their threads swapped out for different threads, such as lists and dicts, and that's what makes something in python "mutable"
p8766
aVStrings on the other hand, are not mutable
p8767
aVOnce you define a string like  or , it's one balloon
p8768
aVYou can tie it down with a thread (a variable, a list, or whatever), but you cannot replace letters inside of it
p8769
aVYou can only tie that thread to a completely new string
p8770
aVMost things in python can act like balloons
p8771
aVIntegers, strings, lists, functions, instances, classes, all can be tied down to a variable, or tied into a container
p8772
as(dp8773
g16
V100297
p8774
stp8775
a((dp8776
g2
(lp8777
VUse  to merge  and :
p8778
aVBecause the  constructor also can take a sequence of (key, value) pairs no for loops are needed at all
p8779
as(dp8780
g16
V100297
p8781
stp8782
a((dp8783
g2
(lp8784
VThe  file is a Object Oriented Database file, and it is written by a framework called the ZODB
p8785
aVThe data within it represent python instances, layed out in a tree structure
p8786
aVYou could open this database from a python script, but in order for you to make sense of the contained structures, you'll need access to the original class definitions that make up the stored instances
p8787
aVWithout those class definitions all you'll get is placeholder objects (Broken objects) that are of no use at all
p8788
aVAs such, it's probably easier to just get the Plone instance back up and running, as it'll be easier to export the exact data you want out if you have things like the catalog (basically a specialized database index) to build your export
p8789
aVIt could be that this site is down because of something trivial, something we can help you with here on Stack Overflow, or on the Plone users mailinglists or in the #plone IRC channel
p8790
aVIf you do get it up and running and have some details on what you are trying to export, we certainly can help
p8791
as(dp8792
g16
V100297
p8793
stp8794
a((dp8795
g2
(lp8796
VYou can use the  function:
p8797
as(dp8798
g16
V100297
p8799
stp8800
a((dp8801
g2
(lp8802
VYou need to specify an encoding for your source code, or use a character escape instead
p8803
aVor
p8804
aVYou probably want to use a Unicode literal though (here with a unicode escape character):
p8805
aVPlease do read the Unicode HOWTO to fully understand what goes on here
p8806
aVOther helpful documents:
p8807
aVJoel Spolsky's The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p8808
aVNed Batchelder's Pragmatic Unicode presentation
p8809
aVNote that your specific error doesn't have anything to do with python 2
p8810
aV5 vs
p8811
ag5740
aV7, but everything with the output encoding of whatever you are printing to
p8812
aVOn your server with python2
p8813
aV5, there is either no encoding specified or it is explicitly set to ASCII, but on your local machine with python 2
p8814
aV7, you are most likely dealing with a terminal that supports UTF-8
p8815
as(dp8816
g16
V100297
p8817
stp8818
a((dp8819
g2
(lp8820
VEach  variable is actualy a row, not a single column
p8821
aVSimply select the first value in that row:
p8822
as(dp8823
g16
V100297
p8824
stp8825
a((dp8826
g2
(lp8827
V returns the text within a QListWidgetItem
p8828
aVNote that you need to call  on the original QListWidget instance to get the items contained in the list widget:
p8829
as(dp8830
g16
V100297
p8831
stp8832
a((dp8833
g2
(lp8834
VUse the  module instead; it'll let you control a program with interactive input much better than the subprocess module can
p8835
aVFor windows, you can use  instead, a port of the  module to the Windows console
p8836
as(dp8837
g16
V100297
p8838
stp8839
a((dp8840
g2
(lp8841
VYou can assign list_b to a slice, which happens to be empty but at the start of list_a:
p8842
aVThis is the fastest way to insert a list into another list, at any position
p8843
as(dp8844
g16
V100297
p8845
stp8846
a((dp8847
g2
(lp8848
VYou probably wanted to set the  parameter:
p8849
aVAlternatively, you could override the  method:
p8850
as(dp8851
g16
V100297
p8852
stp8853
a((dp8854
g2
(lp8855
VNo, unless the function definition allows for more parameters (using the  catch-all syntax), you cannot call a method with more arguments than it has defined
p8856
aVYou can introspect the function and remove any arguments it won't accept however:
p8857
aVI'm using the  function to check if the callable supports a  catch-all via , and if it doesn't, I use the  information to remove anything the method won't support
p8858
as(dp8859
g16
V100297
p8860
stp8861
a((dp8862
g2
(lp8863
VFiles on the filesystem are not sorted
p8864
aVYou can sort the resulting filenames yourself using the  function:
p8865
aVNote that the  call in your code is a no-op; with only one argument it doesn't do anything but return that argument unaltered
p8866
aVNote that your files will sort in alphabetical ordering, which puts  before
p8867
aVYou can use a custom key function to improve the sorting:
p8868
aVThe  function splits out any digits in a filename, turns it into an actual number, and returns the result for sorting:
p8869
as(dp8870
g16
V100297
p8871
stp8872
a((dp8873
g2
(lp8874
VThis is why you want to keep your module names lower-cased
p8875
aV:-)
p8876
aVYou imported the module, no the class defined inside of the module
p8877
as(dp8878
g16
V100297
p8879
stp8880
a((dp8881
g2
(lp8882
VYou need to cancel the default action of the form, which is to submit (which cancels any running JavaScript AJAX query in progress):
p8883
aVBy returning  from the click handler, the normal form action, which is for the browser to submit the data to the URL named in the  attribute, is not executed
p8884
as(dp8885
g16
V100297
p8886
stp8887
a((dp8888
g2
(lp8889
VBy using an application server or a webserver configured to run Python scripts
p8890
aVThere are many options to run Python serving web requests
p8891
aVNote that extensions don't mean anything anymore these days; the  extension could even be an internal joke on us all where the pages are really served by Haskell
p8892
as(dp8893
g16
V100297
p8894
stp8895
a((dp8896
g2
(lp8897
VYou are using the right tool, but you told pack to encode 2 arguments, but pass in only one
p8898
aVThe string  means: pack two values, one as an unsigned short, the other as an unsigned byte
p8899
aVPass in two values and it works:
p8900
aVJust keep experimenting, you'll get the hang of it
p8901
aVHere are the first set of values from your example, in Big Endian notation:
p8902
aVNote the '>' at the start, this signals the endianess
p8903
aVThe strings are converted to sequences and applied as individual variables
p8904
aVGenerally, it's easier to just append them though:
p8905
as(dp8906
g16
V100297
p8907
stp8908
a((dp8909
g2
(lp8910
VYou are indeed seeing rounding errors
p8911
aVThe matrix form is the more accurate and much faster algorithm
p8912
aVLiterateprograms
p8913
aVorg lists a good implementation, but it also lists the following algorithm based on Lucas numbers:
p8914
aVTake a look at Lecture 3 of the MIT Open Courseware course on algorithms for a good analysis of the matrix approach
p8915
aVBoth the above algorithm and the matrix approach has \u0398(lg n) complexity, just like the naive recursive squaring method you used, yet without the rounding problems
p8916
aVThe Lucas numbers approach has the lowest constant cost, making it the faster algorithm (about twice as fast as the matrix approach):
p8917
as(dp8918
g16
V100297
p8919
stp8920
a((dp8921
g2
(lp8922
VYou can use the the  function with a sentinel to simplify your loop:
p8923
aVThere is no need to , the  call already updates the position
p8924
as(dp8925
g16
V100297
p8926
stp8927
a((dp8928
g2
(lp8929
VYou are already iterating over the default dicts like a regular dict, but you are printing the defaultdict representation too
p8930
aVTo print these like you would print a regular dict, just turn them back into one:
p8931
aVNote that a  is a direct subclass of , apart from the updated  behaviour and the updated  hook1, a  behaves exactly like a normal  would, certainly when it comes to iterating
p8932
aV1 and  are overridden too, to create a new  when using the  module
p8933
aVA custom  is provided for the  module for the same reasons
p8934
as(dp8935
g16
V100297
p8936
stp8937
a((dp8938
g2
(lp8939
VThe Google App Engine does not support access to your own SQL server, and does not support loading C-API libraries of your own
p8940
aVYou can use the Google Cloud SQL storage, which is implemented with MySQL databases, which you can access via their Cloud SQL API for Python
p8941
aVNote that the  module Google provides implements the PEP 249 Python database API 2
p8942
aV0 specification, just like the pyodbc module, so you should have no problems using it:
p8943
as(dp8944
g16
V100297
p8945
stp8946
a((dp8947
g2
(lp8948
VWith the new and updated unittest module you can skip tests:
p8949
aVWhen the test runner runs these, they are counted separately ("skipped: (n)")
p8950
as(dp8951
g16
V100297
p8952
stp8953
a((dp8954
g2
(lp8955
VYou are setting the system time from the  timestamp
p8956
aVThe latter is adjusted for the local timezone, while  requires you to use the UTC timezone
p8957
aVUse  instead:
p8958
aVYou then also avoid having to deal with whether or not you are in summer time (DST) now, vs
p8959
aVMarch when you would be in winter time
p8960
aVAlternatively you can use a  call and get the millisecond parameter as a bonus:
p8961
aVNote that I left the weekday item set to 0 in both examples; it is ignored when calling
p8962
aVIf it was not ignored, then your code example had the value wrong; the Python value ranges from 0 to 6 for Monday through to Sunday, while the Win32 API wants 1 through to 7 for Sunday through to Saturday
p8963
aVYou'd have to add 2 and use modulo 7:
p8964
as(dp8965
g16
V100297
p8966
stp8967
a((dp8968
g2
(lp8969
VYou don't have a docstring on the  package, thus installation fails
p8970
aVYou can get the same error by just running the  module locally:
p8971
aVAdd a docstring to your  module:
p8972
aVP
p8973
aVS
p8974
aVYou also checked in the  byte-compiled cache files into GitHub, you may want to remove those
p8975
as(dp8976
g16
V100297
p8977
stp8978
a((dp8979
g2
(lp8980
VUnfortunately, the  module uses print statements, so it won't return anything directly useful
p8981
aVEither you have to re-implement the ,  and  functions, or you temporarily replace  with an alternative to capture the output:
p8982
aVThis is actually best done using a context manager:
p8983
aVThat way you are guaranteed to have  restored even if something goes wrong with
p8984
aVA little demonstration:
p8985
as(dp8986
g16
V100297
p8987
stp8988
a((dp8989
g2
(lp8990
VIf you slice a query in SQLAlchemy, it automatically limits the database result set fetched:
p8991
aVIf you were to get a count first, you can easily loop over chunked responses:
p8992
aVNote that this does result in multiple queries to the database
p8993
aVAlternatively you can use a the  function to produce groups of 50 items:
p8994
aVI used  to limit row pre-fetching to the batchsize so you don't pre-fetch more than you need per batch
p8995
aVThe  trick gives you groups of size  out of a base iterator:
p8996
aVNote that the last batch is padded with  values to fill out to the batch size
p8997
as(dp8998
g16
V100297
p8999
stp9000
a((dp9001
g2
(lp9002
VSince a BrowserPage view instance's lifetime is normally the duration of the request already, you generally may just as well use the  memoizing decorator:
p9003
aVAfter all, the BrowserPage is normally looked up for a given URL, instanciated when looked up, and discarded when the view has been produced
p9004
aVA new request will produce a new instance
p9005
aVThe view memoizer stores the cache on the current request, and adds the current context path (or the id of the context, if there is no path) as a cache key
p9006
aVIf the view is looked up in different places during a request you can use that instead of the instance memoizer:
p9007
aVUtility views, like  and such, benefit most from
p9008
aVIf your expensive method is independent of the view context, use the  decorator; this omits the view context path from the cache key:
p9009
aVSo, if  would return the same information regardless of what the context of this view is (be it the site root or somewhere deep in the content tree), use the  variant so you store only one copy of the result
p9010
as(dp9011
g16
V100297
p9012
stp9013
a((dp9014
g2
(lp9015
VIn python, variables can be 'pulled' from the surrounding scope if read from
p9016
aVSo the following will work:
p9017
aVbecause the variable 'spam' is being looked up in the surrounding scope, the  function
p9018
aVHowever, you cannot change the value of a surrounding scope
p9019
aVYou can change global variables (if you declare them as  in your function), but you cannot do that for the variable  in the above function
p9020
aV(Python 3 changes this, it adds a new keyword
p9021
aVIf you define  as  inside of  you can assign to that variable a new value inside of
p9022
aVNow to your list
p9023
aVWhat happens there is that you are not altering the variable  at all
p9024
aVThroughout your code,  points to one list, and only to that list
p9025
aVAs far as python is concerned,  the variable is not altered within the  function
p9026
aVWhat does happen is that you alter the contents of the list
p9027
aVYou can freely assign a new value to , because that's not the variable , it is the list referred to by , first index
p9028
aVPython allows this because it is not a variable assignment, but a list manipulation instead
p9029
aVSo, your 'workaround' is correct, if somewhat obscure
p9030
aVIf you use Python 3, you can declare  as  within  and then things will work without lists too
p9031
as(dp9032
g16
V100297
p9033
stp9034
a((dp9035
g2
(lp9036
VThis could be a place where regular expressions are the correct solution
p9037
aVYou are only searching for text in attributes, and the contents are regular, fitting a pattern
p9038
aVThe following python regular expression would locate these links for you:
p9039
aVThe pattern we look for is something inside a  chunk of text, where that 'something' starts with one or more instances of , followed by , then followed with any text that does not contain a  quote
p9040
aVThe matched text after the equals sign is grouped in group 2 for easy retrieval, group 1 holds the  part
p9041
aVIf all you want to do is remove the  part altogether (so the links point directly to the endpoint instead of going via the redirect page), leave off the first group and do a simple  on your HTML files:
p9042
aVNote that this could also match any body text (so outside HTML tags), this is not a HTML-aware solution
p9043
aVChances are there is no such body text though
p9044
aVBut if there is, you'll need a full-blown HTML parser like BeautifulSoup or lxml instead
p9045
as(dp9046
g16
V100297
p9047
stp9048
a((dp9049
g2
(lp9050
VUse  instead of  for merging lists together
p9051
aVMoreover, you can loop over the keys and values of both  and  together using :
p9052
aVlooks up a key, and sets it to a default if it is not yet there
p9053
aVAlternatively you could use  to do the same implicitly
p9054
aVoutputs:
p9055
aVNote that because we now create a clean new list for each key first, then extend, your original lists in  are unaffected
p9056
aVIn your code you do not create a copy of the list; instead you copied the reference to the list
p9057
aVIn the end both the  and the  dict values point to the same lists, and using append on those lists results in the changes being visible in both places
p9058
aVIt's easy to demonstrate that with simple variables instead of a dict:
p9059
aVBoth  and  refer to the same list, the list was not copied
p9060
aVTo create a copy instead, use the  constructor or use the  slice operator:
p9061
aVNow  is a new copy of the list and changes no longer are visible in
p9062
aVThe memory addresses (the result of the  call) differ for the two lists
p9063
as(dp9064
g16
V100297
p9065
stp9066
a((dp9067
g2
(lp9068
VYou are looking for :
p9069
aVTo quote the documentation:
p9070
aVThis is the counterpart of
p9071
aVThe arguments are an object, a string and an arbitrary value
p9072
aVThe string may name an existing attribute or a new attribute
p9073
aVThe function assigns the value to the attribute, provided the object allows it
p9074
aVFor example,  is equivalent to
p9075
aVNote that since  is a singleton in python, usually one tests for it using the  or  operators:
p9076
aVand the PEP 8 python styleguide discourages compound statements; keep the  suite on it's own line, even if it is just one line
p9077
as(dp9078
g16
V100297
p9079
stp9080
a((dp9081
g2
(lp9082
VYou cannot execute multiple statements in one  call I suspect; web2py uses the DBAPI 2
p9083
aV0  call for sending these to the backend database and that usually supports only single statements:
p9084
as(dp9085
g16
V100297
p9086
stp9087
a((dp9088
g2
(lp9089
VI would not use regular expressions here at all; they are too complex a tool for such a simple job
p9090
aVSimply split on the pipe symbol:
p9091
aVDiscard the first and last values, strip the rest to remove whitespace, and you have your columns:
p9092
aVTo count columns without splitting, simply use the  function, subtract 1:
p9093
aVor take the  of the column output:
p9094
aVWant to count empty columns
p9095
aVSplit on those columns and count the empty ones:
p9096
aVOr for your second line:
p9097
as(dp9098
g16
V100297
p9099
stp9100
a((dp9101
g2
(lp9102
VYou'd need to specify the transition point for day and night, and calculate the delta to that and then the delta to the end-point:
p9103
aVThis is a rather naive setup, as it won't support multiple-day spans and such
p9104
aVConsider it a starting point
p9105
as(dp9106
g16
V100297
p9107
stp9108
a((dp9109
g2
(lp9110
VYou are missing the  C extension for your python installation, and it'll only support the  locale without that
p9111
as(dp9112
g16
V100297
p9113
stp9114
a((dp9115
g2
(lp9116
VTo save and load JSON to and from a file, use an open file object
p9117
aVYour code indicates you tried to save the filename to , which is not a fileobject
p9118
aVThe following code works:
p9119
aVI use the open files as context managers, to ensure they are closed when done reading or writing
p9120
aVYour other attempt, , simply prints the python representation to the file, not JSON:
p9121
aVwhich, when read back from the file would give the error message you indicated:
p9122
aVYou'd have to print the  output instead:
p9123
as(dp9124
g16
V100297
p9125
stp9126
a((dp9127
g2
(lp9128
VUse  to divvie up a string around a regular expression with a group around the whole expression:
p9129
aVYou can use tuple-unpacking to put that into variables if you like:
p9130
aVDo be aware that  will keep on splitting unless you limit it to 1 match with the  parameter:
p9131
as(dp9132
g16
V100297
p9133
stp9134
a((dp9135
g2
(lp9136
VYou need to use the  flag when matching newlines:
p9137
aVand there's no space after UTRESA
p9138
aVDemo:
p9139
as(dp9140
g16
V100297
p9141
stp9142
a((dp9143
g2
(lp9144
VCreate a  from your date:
p9145
aVNow you can subtract it from
p9146
as(dp9147
g16
V100297
p9148
stp9149
a((dp9150
g2
(lp9151
VTo get a proper random distribution across all these files, you'd need to view them as one big set of lines and pick 10 at random
p9152
aVIn other words, you'll have to read all these files at least once to at least figure out how many lines you have
p9153
aVYou do not need to hold all the lines in memory however
p9154
aVYou'd have to do this in two phases: index your files to count the number of lines in each, then pick 10 random lines to be read from these files
p9155
aVFirst indexing:
p9156
aVNow we have a mapping of offsets, pointing to filenames, and a total line count
p9157
aVNow we pick ten random indices, and read these from your files:
p9158
aVNote that you only need the indexing once; you can store the result somewhere and only update it when your files update
p9159
aVAlso note that your tasks are now 'stored' in the  list; these are indices to lines in your files, and I remove the index from that variable when printing the task selected
p9160
aVNext time you run the  choices, the tasks previously picked will no longer be available for picking the next time
p9161
aVThis structure will need updating if your files ever do change, as the indexes have to be re-calculated
p9162
aVThe  will help you with that task, but that is outside the scope of this answer
p9163
aV:-)
p9164
aVIf you need only one 10-item sample, use Blckknght's solution instead, as it only will go through the files once, while mine require 10 extra file openings
p9165
aVIf you need multiple samples, this solution only requires 10 extra file openings every time you need your sample, it won't scan through all the files again
p9166
aVIf you have fewer than 10 files, still use Blckknght's answer
p9167
aV:-)
p9168
as(dp9169
g16
V100297
p9170
stp9171
a((dp9172
g2
(lp9173
VYou'll need to include the quotes in your expression I think
p9174
aVYou can use the  module to output valid JavaScript literals:
p9175
aVand in your template:
p9176
aVThe quotes are then generated by the  function, and the  filter ensures they are not escaped; you've already made your values JavaScript safe, you don't need them HTML-safe either
p9177
aVThe added advantage is that the module will escape any quotes in your JavaScript values as well, and handle unicode properly:
p9178
as(dp9179
g16
V100297
p9180
stp9181
a((dp9182
g2
(lp9183
VThe  statement is supported in Python 2
p9184
aV6, you must have a different error
p9185
aVSee PEP 343 and the python File Objects documentation for the details
p9186
aVQuick demo:
p9187
aVYou are trying to use the  statement with multiple context managers though, which was only added in Python 2
p9188
aV7:
p9189
aVChanged in version 2
p9190
aV7: Support for multiple context expressions
p9191
aVUse nested statements instead in 2
p9192
aV6:
p9193
as(dp9194
g16
V100297
p9195
stp9196
a((dp9197
g2
(lp9198
VThere can be several reasons the catalog doesn't return all entries:
p9199
aVTheir permission doesn't allow you to see them, full stop
p9200
aVUsing the anonymous user certainly doesn't help in that regard
p9201
aV:-)
p9202
aVThe entries are expired; they have a expiration date that is now in the past and you don't have permission to see these
p9203
aVAgain, using a non-privileged user won't help
p9204
aVYou are using a multi-lingual setup and the items are not in the 'current' language
p9205
aVIf your query includes  this filter is disabled
p9206
aVTo set an alternative user (preferably one with the  role) on the console, use the following code:
p9207
aVPersonally, I use the following snippet whenever I use the console; if have this in my Quicksilver Shelf for easy access
p9208
aVFirst I type in:
p9209
aVthen paste:
p9210
aVNow I have readline completion and everything I need to do some real damage in my sites
p9211
as(dp9212
g16
V100297
p9213
stp9214
a((dp9215
g2
(lp9216
VSessions are tracked with a cookie sent to the client
p9217
aVSo your 'client' (the  library) needs to actually send that cookie back again:
p9218
aVBetter still would be to use a  set-up:
p9219
as(dp9220
g16
V100297
p9221
stp9222
a((dp9223
g2
(lp9224
VUse the  formatter:
p9225
aVTo quote the documentation:
p9226
aVThe other formatter class available, , will add information about the default value of each of the arguments
p9227
aVThe exact output for your scan-time option then becomes:
p9228
as(dp9229
g16
V100297
p9230
stp9231
a((dp9232
g2
(lp9233
VYou are comparing strings with python  objects; you need to convert the date object to a string for the comparison, using the  method:
p9234
aVTo illustrate this further:
p9235
aVAlternatively, you can use the  method, which uses the exact same output format:
p9236
as(dp9237
g16
V100297
p9238
stp9239
a((dp9240
g2
(lp9241
VUse the  function:
p9242
aVYou can create a customizable parser with the  function, then alter it's behaviour by setting its attributes
p9243
aVFor example, you can set the  attribute to  to allow commas to delimit words as well
p9244
aVThen simply convert the  instance back to a list to split the input
p9245
as(dp9246
g16
V100297
p9247
stp9248
a((dp9249
g2
(lp9250
VYou can adapt any of the many python  module examples
p9251
aVBecause HTML email usually means sending multipart/alternative messages, things get a little more complicated
p9252
aVThe examples page of the  package
p9253
aVSending HTML email in Python
p9254
aVPython: Sending Multipart html emails which contain embedded images
p9255
aVYou basically have to construct an  object and pass that to
p9256
as(dp9257
g16
V100297
p9258
stp9259
a((dp9260
g2
(lp9261
VSubtracting two  objects gives you a  object, which has a  method (added in Python 2
p9262
aV7)
p9263
aVDivide this by 60 and cast to  to get minutes since your reference date:
p9264
aVor in a python shell:
p9265
aVFor python 2
p9266
aV6 and earlier, you'll have to use the  and  attributes to calculate the minutes:
p9267
aVwhich gives you an integer as well
p9268
as(dp9269
g16
V100297
p9270
stp9271
a((dp9272
g2
(lp9273
VWhen looking at an email in GMail, your local timezone is used when displaying the date and time an email was sent
p9274
aVThe "Tue, 28 Aug 2012 02:49:13 -0500" is parsed, then updated to your local timezone, and formatted in a GMail-specific manner
p9275
aVParsing and formatting the stdlib way
p9276
aVThe  module includes a  function that specifically deals with email headers with timezone offsets
p9277
aVIt returns a tuple compatible with , but with a timezone offset added
p9278
aVAn additional  function converts that tuple to an offset value (time in seconds since the UNIX epoch)
p9279
aVThis value then can be converted to a  type object easily
p9280
aVThe same module also has a  function to convert the UNIX epoch timestamp to a email-compatible date string:
p9281
aVNow we have a formatted date in UTC suitable for outgoing emails
p9282
aVTo have this printed as my local timezone (as determined by my computer) you need to set the  flag to :
p9283
aVParsing and formatting using better tools
p9284
aVNote that things are getting hairy as we try and deal with timezones, and the  function doesn't give you any options to format things a little differently (like GMail does), nor does it let you choose a different timezone to work with
p9285
aVEnter the external  module; it has a parse function that can handle just about anything, and supports timezones properly
p9286
aVThe  function returns a  instance, which makes formatting a lot easier
p9287
aVNow we can use the  function to output this as your email client does:
p9288
aVThat's still in the local timezone, of course; to cast this to your timezone instead, use the  method, with a new  object
p9289
aVThe  package has some handy for us
p9290
aVHere is how you print it in the local timezone (to your machine):
p9291
aVor use a specific timezone instead:
p9292
as(dp9293
g16
V100297
p9294
stp9295
a((dp9296
g2
(lp9297
VYou can create aliases; because one  modules is being split into multiple new modules you can only do this by importing your classes into the old location
p9298
aVBoth methods cause new copies of your instance pickles to refer to the new location; if you can force a write on all instances of the moved classes you don't need to retain the aliases
p9299
aVYou can do this by setting  to  on your instances that you want to be written again
p9300
aVSo, to create the aliases, import your moved classes in the old location:
p9301
aVIf you only rename a module (so the same classes all are found in one new location, could be a set of imports themselves), you can also create a  entry for the old name:
p9302
as(dp9303
g16
V100297
p9304
stp9305
a((dp9306
g2
(lp9307
VFrom the  module documentation:
p9308
aVAlmost all module functions depend on the basic function random(), which generates a random float uniformly in the semi-open range [0
p9309
aV0, 1
p9310
aV0)
p9311
aVPython uses the Mersenne Twister as the core generator
p9312
aVIt produces 53-bit precision floats and has a period of 2**19937-1
p9313
aVThe underlying implementation in C is both fast and threadsafe
p9314
aVThe Mersenne Twister is one of the most extensively tested random number generators in existence
p9315
aVHowever, being completely deterministic, it is not suitable for all purposes, and is completely unsuitable for cryptographic purposes
p9316
aVFrom the Wikipedia article on the Mersenne Twister:
p9317
aVIt provides for fast generation of very high-quality pseudorandom numbers, having been designed specifically to rectify many of the flaws found in older algorithms
p9318
aVIf you have an OS-specific randomness source, available through , then you can use the  class instead
p9319
aVMost of the  module functions are available as methods on that class
p9320
aVIt perhaps would be more suitable for cryptographic purposes, quoting the docs again:
p9321
aVThe returned data should be unpredictable enough for cryptographic applications, though its exact quality depends on the OS implementation
p9322
as(dp9323
g16
V100297
p9324
stp9325
a((dp9326
g2
(lp9327
VPlone uses a  session cookie; any system that supports such session cookies and that is configured with the same secret as Plone can validate the cookies
p9328
aVUnfortunately, I haven't been able to locate a nginx implementation of auth_tkt; the standard originates with the Apache  module, so if Apache is an option you could use that
p9329
aVSee Plone & CGI single-sign-on using mod_auth_tkt for details on how to configure such a setup
p9330
as(dp9331
g16
V100297
p9332
stp9333
a((dp9334
g2
(lp9335
VYour inner loop increments  until it is greater than , but you never set it back to
p9336
aVAlso, with your current indentation, you also increment  in the inner loop, so it'll reach  inside the inner loop causing the outer loop to only be run once too
p9337
aVSo, if  is 4, your values will go:
p9338
aVYou'd be much better off using  loops using , avoiding your mistakes altogether:
p9339
aVWith  the inner loop will always start at , range through to  every time without explicit resets needed
p9340
aVIf you use the  function you can collapse the whole test into one line:
p9341
as(dp9342
g16
V100297
p9343
stp9344
a((dp9345
g2
(lp9346
VTake a look at your test configuration, the  setting has an error in it:
p9347
aVNote that there is no  colon in there
p9348
aVThe memcached module you use, uses regular expressions to try and parse that value, and that method sets  to None when you specify that value as a host:
p9349
aVwhich is the source of your traceback
p9350
aVChange the  dict to read:
p9351
aVand things will work fine:
p9352
as(dp9353
g16
V100297
p9354
stp9355
a((dp9356
g2
(lp9357
VDexterity objects are defined by a schema, which is enumerable:
p9358
aVHere I use the  method, but you can also just use the interface as an iterator if you don't have any methods on your schema:
p9359
aVLast but not least,  has a utility method named  that will filter on  fields in an interface; the above methods also list methods and non-schema attributes,  only lists  specific attribute types:
p9360
aVIf you defined the schema through-the-web, you may not know how to look up the interface for your type
p9361
aVYou can also retrieve the schema interface through the Factory Type Information, or FTI for short:
p9362
aVwhere  now holds your interface
p9363
as(dp9364
g16
V100297
p9365
stp9366
a((dp9367
g2
(lp9368
VBefore python 3
p9369
aV3, you cannot use a custom  subclass for the  value of an exec statement
p9370
aVThe underlying C code that executes the compiled code directly accesses the underlying C structures directly, ignoring any custom hooks you may have implemented
p9371
aVIn other words, when the code does a  operator (as is the case with  in your function ), the C bytecode evaluation loop accessess the  structure in the current frame using the C API, bypassing any python overrides
p9372
aVThis is documented in the  function documentation as:
p9373
aVIf only globals is provided, it must be a dictionary, which will be used for both the global and the local variables
p9374
aVIf globals and locals are given, they are used for the global and local variables, respectively
p9375
aVIf provided, locals can be any mapping object
p9376
aVThis restriction has been loosened in Python 3
p9377
aV3, see issue 14385
p9378
aVThe documentation hasn't been updated yet, but the byte-code evaluation loop has been updated to test for custom mappings before falling back to the C API access
p9379
aVIf a custom mapping is used, the  method is used, which will call  on custom classes
p9380
as(dp9381
g16
V100297
p9382
stp9383
a((dp9384
g2
(lp9385
VUse a requirements file for , or use a deployment tool like buildout, which supports complex installations and can pin versions for you:
p9386
as(dp9387
g16
V100297
p9388
stp9389
a((dp9390
g2
(lp9391
VThe field is interpreted as a TALES expression; the results of that expression are what will be inserted
p9392
aVNone of your examples are TALES expressions; the last 3 each do use TALES expressions as part of a larger TAL template statement though
p9393
aVIn your case, all you need is a  expression to return a static result:
p9394
as(dp9395
g16
V100297
p9396
stp9397
a((dp9398
g2
(lp9399
VIndeed, there is no GenericSetup configuration support included in ; there is currently nothing that'll export it for you, nor anything to then import the settings
p9400
aVYou'd have to write a setup step for it instead, and configure the session plugin manually through that
p9401
aVAdd an import step to your  configuration file:
p9402
aVand add an empty 'sentinel' text file to the same profile directory named
p9403
aVthen add a  module to your package (what  points to in the above example):
p9404
aVNote that we first test if the sentinel file is present; if you reuse your package setup elsewhere the setup step could be run multiple times if you don't do this
p9405
aVYou'll need to refer to the plugin source to get an idea of what you can configure, I'm afraid
p9406
as(dp9407
g16
V100297
p9408
stp9409
a((dp9410
g2
(lp9411
VYour  pattern matches any character that is not the underscore
p9412
aVUse a  or grouping instead:
p9413
aVI used a  non-capturing group there so that it doesn't interfere with your original group indices
p9414
aVDemo:
p9415
aVTo elaborate, when using a character group () and you start that group with the caret () you invert the character group, turning it from matching the listed characters to matching everything else instead:
p9416
as(dp9417
g16
V100297
p9418
stp9419
a((dp9420
g2
(lp9421
VThe error is thrown because Python 3 opens your files with a default encoding that doesn't match the contents
p9422
aVIf all you are doing is copying file contents, you'd be better off using the  function together with opening the files in binary mode
p9423
aVThat way you avoid encoding issues altogether (as long as all your source files are the same encoding of course, so you don't end up with a target file with mixed encodings):
p9424
aVI've cleaned up the code a little to use context managers (so your files get closed automatically when done) and to use  to create the full path for your files
p9425
aVIf you do need to process your input line by line you'll need to tell Python what encoding to expect, so it can decode the file contents to python string objects:
p9426
aVNote that this requires you to know up front what encoding the files use
p9427
aVRead up on the Python Unicode HOWTO if you have further questions about python 3, files and encodings
p9428
as(dp9429
g16
V100297
p9430
stp9431
a((dp9432
g2
(lp9433
VThe module in question isn't compatible with Mac OS X dynamic library conventions
p9434
aVIt tries to load a  file, but on Mac it'll be  instead
p9435
aVYou can verify this by looking at the  directory
p9436
aVThen just edit the  module and replace the  extension with
p9437
aVI'd also report this to the issue tracker of the module; a simple  switch would keep things loadable across platforms
p9438
aVUpdate: Actually, the module stubbornly expects the  module to be located in the  directory instead of with the module itself
p9439
aVIt is thus not easy_install compatible
p9440
aVIt'll work when you move all the files (unaltered) out of the  directory straight into your  directory
p9441
as(dp9442
g16
V100297
p9443
stp9444
a((dp9445
g2
(lp9446
VIf you are adding a simple  attribute, you don't need any knowledge of TAL, TALES or METAL
p9447
aVTAL is a XML-aware templating language, it uses namespaces and XML attributes to 'blend in' into the template structure
p9448
aVAs such, you can add extra attributes to tags outside of the TAL-specific attributes
p9449
aVSimply customize the  file and add the attribute to the body tag:
p9450
aVIf you still want to read up on TAL, TALES and METAL, you can read the Zope 2 book, chapter 10: Using Zope Page Templates, chapter 13: Advanced Page Templates and appendix C: Zope Page Templates Reference
p9451
as(dp9452
g16
V100297
p9453
stp9454
a((dp9455
g2
(lp9456
V contains the 3 values you asked for, so  is the end_out value, while  is
p9457
aVSimply apply your calculation to those two values:
p9458
aVI replaced your  and  dance with a simpler method using the  function; all you need to do is turn the total number of seconds into hours (seconds divided by 60) and remaining seconds (seconds modulo 60), after all
p9459
aVIf you need sum the timedeltas per  entry, order by by that entry and use the  callable to calculate your sums quickly and efficiently:
p9460
aVThe  function gives you sub-lists with matching  values, we simply calculate the  for each entry and use  to calculate the total timedelta
p9461
as(dp9462
g16
V100297
p9463
stp9464
a((dp9465
g2
(lp9466
VYour function returns a generator because it uses  statements
p9467
aVA generator is paused until you request the next value
p9468
aVThis means that a generator function doesn't do anything until you call  it, or use it as an iterator in a loop:
p9469
aVNotice how the message  is not printed until I call  on the generator
p9470
aVYou only call your recursive function, but that returns a generator that you then discard
p9471
aVThe code itself is never executed because it is kept on hold
p9472
aVLoop over the results instead:
p9473
aVNow you actually iterate over the nested generator function results, and pass them on to the caller (the consumer of the outer nested generator function)
p9474
as(dp9475
g16
V100297
p9476
stp9477
a((dp9478
g2
(lp9479
VYou don't need to re-query the second table over and over again, you could just retrieve the one row once and use that as a lookup-table
p9480
aVIf you use the  row factory that is as easy as retrieving one row:
p9481
aVThe  value now holds one  object, whose keys are the column names
p9482
aVWhen now looping over the  results, you can look up the value of any given column directly
p9483
aVIf you are using the  module instead, then there is no easy ready-made row factory that returns a dictionary, but you can easily build the dictionary yourself for one row:
p9484
as(dp9485
g16
V100297
p9486
stp9487
a((dp9488
g2
(lp9489
VNo, you cannot set the docstring of a function from within the body of the function
p9490
aVThe way python normally sets the docstring is to take the first line of the function suite (everything indented under the  line) and if that's a string literal, it removes that from the suite and makes that the docstring
p9491
aVPython then compiles the rest of the suite into the function code object, and creates a new  object by passing in the compiled code object and the docstring (among others)
p9492
aVIf you use an expression that happens to produce a string instead, then that 'trick' doesn't work; python will ignore that expression, leaving it as part of the function suite to compile
p9493
aVBecause the function suite itself is compiled and not executed, you cannot 'reach out' and set the docstring to be used on the function object during compilation time
p9494
aVThe only way you can dynamically set a function's docstring is by referring to a function object directly and setting it's  or  variable (the two are aliases)
p9495
aVNote that when you import a function from a module, you already get the docstring too:
p9496
aVThere is no need to import the docstring separately
p9497
as(dp9498
g16
V100297
p9499
stp9500
a((dp9501
g2
(lp9502
VYou need to create an instance of the API:
p9503
aVA demo is always more instructive:
p9504
as(dp9505
g16
V100297
p9506
stp9507
a((dp9508
g2
(lp9509
VThe package  runs the  converter for you on install, there is no need to run the converter manually
p9510
aVThe following (using my  command installed for python 2
p9511
aV7) works fine for me; using  is the easiest option:
p9512
aVprovided that you have the enchant C libraries installed
p9513
aVAlternatively, the following works as well, provided you have the  python package installed:
p9514
aVbut make sure you do that with a cleanly unpacked distribution (one you didn't try to run the 3to2 converter on)
p9515
as(dp9516
g16
V100297
p9517
stp9518
a((dp9519
g2
(lp9520
VNormally the default file is indeed , but the Debian distribution patches this (link to the gzipped patch as provided by Debian) to look for  first:
p9521
aVSo with that patch, supervisor looks for  in the local directory, in the  subdirectory, then in the global  and  directories
p9522
aVThe default  file installed by Debian has this at the end:
p9523
aVcausing supervisord to load any extra files put in the  directory
p9524
as(dp9525
g16
V100297
p9526
stp9527
a((dp9528
g2
(lp9529
VLet's break this down:
p9530
aV: literal text match, only the word "coding" will do
p9531
aV: character group, either a colon ":" or an equals sign "=" matches
p9532
aV: 0 or more whitespace characters; spaces and tabs, but could match newlines too if so configured
p9533
aV: a matching group, the contents will be available as a match group for further processing
p9534
aV: one or more characters in the group, matching a dash "-", a dot "
p9535
aVor any word character;  is a character class usually matching the letters 'a' through 'z' (upper and lowercase), numbers '0' up to '9' and the underscore "_"
p9536
aVIf you switch on unicode support (on by default in Python 3) the  class captures a lot more though
p9537
aVAny character classified as an alphanumeric in the Unicode database would match
p9538
aVExamples of matches:
p9539
aVcoding=foobar320_42spam_eggs", group would be
p9540
aVcoding: something-or-other", group would be
p9541
aVcoding:  whatever
p9542
aV42", group would be
p9543
as(dp9544
g16
V100297
p9545
stp9546
a((dp9547
g2
(lp9548
VI'd split on the  colon and test if the first part is in the set of allowed prefixes:
p9549
as(dp9550
g16
V100297
p9551
stp9552
a((dp9553
g2
(lp9554
VIf you need the specific functionality of the  function, the source for that module is fairly straightforward and doesn't use any Python 2
p9555
aV7 specific syntax at all; you could simply backport it
p9556
aVYou'd basically need the following definitions and two functions:
p9557
aVYou can cut the long function down to just the branch you need for your platform, of course; for OS X that'd be:
p9558
aVNote that Debian patches this function to return  in the default case, this doesn't apply to OS X
p9559
as(dp9560
g16
V100297
p9561
stp9562
a((dp9563
g2
(lp9564
VThe  class needs a file-like object, something with a  method
p9565
aVA  class would be best here:
p9566
aVI used the C-variant of the  module there; the advantage is speed, the disadvantage that you can use each instance only as a writable or a readable file
p9567
aVSince all you do is write to it before retrieving the written data, that's just fine
p9568
as(dp9569
g16
V100297
p9570
stp9571
a((dp9572
g2
(lp9573
VThere is no such function; the easiest way to do this is to use a dict comprehension:
p9574
aVIn python 2
p9575
aV7, use the  method instead of  to save memory
p9576
aVThe dict comprehension syntax wasn't introduced until python 2
p9577
ag4892
aVNote that there is no such method on lists either; you'd have to use a list comprehension or the  function
p9578
aVAs such, you could use the  function for processing your dict as well:
p9579
aVbut that's not that readable, really
p9580
as(dp9581
g16
V100297
p9582
stp9583
a((dp9584
g2
(lp9585
VSince HTML is not a regular language, you really should use an XML parser instead
p9586
aVPython has several to choose from:
p9587
aVElementTree is part of the standard library
p9588
aVBeautifulSoup is a popular 3rd party library
p9589
aVlxml is a fast and feature-rich C-based library
p9590
as(dp9591
g16
V100297
p9592
stp9593
a((dp9594
g2
(lp9595
VThis is not really a SQLAlchemy question, but a basic relational tables question
p9596
aVYou are either talking about a one-to-many relationship, or a many-to-many relationship, both of which SQLAlchemy supports out-of-the-box
p9597
aVOne-to-many
p9598
aVA one-to-many relationship is one of basic containment; a department has many employees, but each employee has only one department
p9599
aVThe class with only one outgoing relationship gets the foreign key in this case, so employees refer to departments, not the other way around
p9600
aVThe example from the SQLAlchemy documentation is given as:
p9601
aVSo if your  classes can only be part of one  set, use this pattern
p9602
aVMany-to-many
p9603
aVA many-to-many relationship is one where both sides can refer to more than one instance of the other side
p9604
aVThink of employees and projects; an employee can be part of multiple projects, and a project can involve multiple employees
p9605
aVIn SQL, this kind of relationship requires an association table, an extra database table that holds the mapping between the two linked types
p9606
aVThe SQLAlchemy documentation on many-to-many relationships documents clearly how to do this; here is the example:
p9607
aVUse this pattern if each  object can be part of more than one  set
p9608
as(dp9609
g16
V100297
p9610
stp9611
a((dp9612
g2
(lp9613
VA decorator can return either a wrapper, or the decorated function unaltered
p9614
aVUse it to create a better debugger:
p9615
aVThe  function is a decorator factory, when called it produces a decorator function
p9616
aVIf debugging is disabled, it simply returns a lambda that returns it argument unchanged, a no-op decorator
p9617
aVWhen debugging is enabled, it returns a debugging decorator that prints when a decorated function has started and prints again when it returns
p9618
aVThe returned decorator is then applied to the decorated function
p9619
aVUsage:
p9620
aVTo reiterate: when  is set to false, the  remains unaltered, so runtime performance is not affected at all
p9621
as(dp9622
g16
V100297
p9623
stp9624
a((dp9625
g2
(lp9626
VNo, this is correct
p9627
aVForm element values in a web page are always strings, regardless of what you expect the end-users to enter
p9628
aVYou can use collander to automate the conversion on the server side though
p9629
aVYou specify a schema, pass in the decoded JSON data structure and get a nice Python structure back, fully validated
p9630
aVThe simplest possible example for deserializing integers:
p9631
aVbut colander can handle mappings, sequences, booleans, datetime objects, and much more besides
p9632
as(dp9633
g16
V100297
p9634
stp9635
a((dp9636
g2
(lp9637
VActually, 3 cookies are generated; one without a  key, one with, and a 3rd with the wildcard version of your domain (the leading dot)
p9638
aVYour browser usually either merges the two or ignores one of those (which one differs by browser, which is why 2 are set)
p9639
aVThat last cookie is generated when the  option is set on the  (True by default); see the  API
p9640
aVYou need this if your authentication cookie is to be shared between different subdomains (think app1
p9641
aVdomain, app2
p9642
aVdomain); your browser won't share cookies across subdomains without a wildcard cookie
p9643
aVYou need to set the  option on your auth policy for cookies to get the secure flag set
p9644
aVAgain, see the API
p9645
aVNo expiration is set, which means that the cookies are deleted when you close your browser (the end of the session your browser shows you)
p9646
aVIf you want your users to be logged out when they close the browser, leave this as the default
p9647
aVOnly if you want sessions to last across browser closures, set a cookie maximum age, see the  option in the API
p9648
aVThis option will cause browsers to store the cookie on disk to persist between browser closures, and delete them when the maximum age has passed
p9649
aVDo note that the  policy object can manage login sessions in a more fine-grained manner by limiting how long it'll consider any authentication cookie valid, and will let you set up a cookie refresh policy
p9650
aVWith such a refresh policy in place users will receive new (refreshed) cookies as they continuing to use your application, but if they don't connect to your server within a set period of time, their cookie would be considered invalid and they would have to log in again
p9651
aVSee the  and  options in the API documentation for more detail on how to configure this
p9652
aVThe policy object requires several pieces of information from the request to be able to generate the cookies, not least of all the host name of your server
p9653
as(dp9654
g16
V100297
p9655
stp9656
a((dp9657
g2
(lp9658
VBoy, you indeed messed up your installation
p9659
aV"ActiveState" is a python distribution for Windows, so you installed a new python distribution over your old one
p9660
aVWhen you uninstalled, it obligingly removed your python installation, including the default library
p9661
aVYou'll have to reinstall your Python installation, I'm afraid
p9662
aVStart from scratch or backup
p9663
aVYou have my sympathies, if that's any consolation
p9664
as(dp9665
g16
V100297
p9666
stp9667
a((dp9668
g2
(lp9669
VDon't re-assign
p9670
aVInstead, use the  option on the  function:
p9671
as(dp9672
g16
V100297
p9673
stp9674
a((dp9675
g2
(lp9676
VWhen you call  on something without specifying an encoding, the default encoding is used, which depends on the environment your program is running in
p9677
aVIn Eclipse, that's different from the command line
p9678
aVDon't rely on the default encoding, instead specify it explicitly:
p9679
aVYou may want to study the Python Unicode HOWTO to understand what encoding and  do with unicode objects
p9680
aVThe wxPython project has a page on Unicode usage as well
p9681
as(dp9682
g16
V100297
p9683
stp9684
a((dp9685
g2
(lp9686
VDon't use , use  and  instead:
p9687
as(dp9688
g16
V100297
p9689
stp9690
a((dp9691
g2
(lp9692
VYou create a  instance without any arguments, but your constructor expects you to pass in a  parameter
p9693
aVEither pass in the request or remove the parameter requirement:
p9694
aVor:
p9695
aVI don't know how you access your database normally; if the only way to access your database through  then pass on  to your  instances and access  in your  class
p9696
as(dp9697
g16
V100297
p9698
stp9699
a((dp9700
g2
(lp9701
VThe  format in python means: use all elements in the sequence  and pass them as arguments to the function
p9702
aVIn this specific case, that translates to:
p9703
aVThis is easiest demonstrated:
p9704
aVYou can also use the  double star format to pass in keyword arguments:
p9705
aVand you can use the same spelling in a function definition to capture arbitrary positional and keyword arguments:
p9706
as(dp9707
g16
V100297
p9708
stp9709
a((dp9710
g2
(lp9711
VUse a  SQL statement to identify the rows, together with the initial primary key:
p9712
aVThe above query selects the lowest primary key  for each group of (name, price, "new price") rows where there is more than one primary key
p9713
aVFor your sample data, this will return:
p9714
aVYou can then use the returned data to delete the duplicates:
p9715
aVNote that we delete any row where the primary key  is larger than the first  with the same 3 columns
p9716
aVFor the first dupe, only the row with  8 will match, for the second dupe the row with  10 matches
p9717
aVThis does do a separate delete for each dupe found
p9718
aVYou can combine this into one statement with a  sub-select query:
p9719
aVThis instructs PostgreSQL to delete any row for which there are other rows with the same name, price and new price but with a primary key that is higher than the current row
p9720
as(dp9721
g16
V100297
p9722
stp9723
a((dp9724
g2
(lp9725
VYou want to use the product of the lists:
p9726
aVDemo:
p9727
as(dp9728
g16
V100297
p9729
stp9730
a((dp9731
g2
(lp9732
VThe  operator matches on unicode codepoint properties, and is documented on the package index page you linked to:
p9733
aVUnicode codepoint properties, including scripts and blocks
p9734
aVThe entry matches any unicode character whose codepoint has a  property with the value  (there are currently 24941 matches in the Unicode codepoint database, see the Unicode Text Segmentation, Word Boundaries chapter specifiation for details)
p9735
aVThe example you gave also uses standard python string formatting to interpolate a partial expression into the regular expression being compiled
p9736
aVThe "{A}" part is just a placeholder for the  part to fill
p9737
aVThe end result is:
p9738
aVThe  sequence just matches 1 or more  dashes, just like in the python  module expressions, it is not anything special, really
p9739
aVNow, the  before that is more interesting
p9740
aVIt's a possessive quantifier, and using it prevents the regex matcher from trying out all possible permutations of the pattern
p9741
aVIt's a performance optimization, one that prevents catastrophic backtracking issues
p9742
as(dp9743
g16
V100297
p9744
stp9745
a((dp9746
g2
(lp9747
VThe browser includes all file input elements in the form, even when empty, so the  test will always be True, but if empty, it's an empty unicode string ()
p9748
aVA proper file upload has a filename, test for that:
p9749
aVFile uploads are  instances, and the  test is what the  module documentation recommends:
p9750
aVIf a field represents an uploaded file, accessing the value via the value attribute or the getvalue() method reads the entire file in memory as a string
p9751
aVThis may not be what you want
p9752
aVYou can test for an uploaded file by testing either the filename attribute or the file attribute
p9753
as(dp9754
g16
V100297
p9755
stp9756
a((dp9757
g2
(lp9758
VNote that you are not converting to hex, you are converting data to raw bytes
p9759
aVThe console is then echoing those bytes back to you, in a form that can be entered again as python literal strings
p9760
aVSo python is printing the literal byte string, and some of the bytes can be represented as ASCII characters; most bytes in the range 0x21-0x7E can be printed as such:
p9761
aVThus, 'Y', 'z', and 'b' are bytes that fall in that range and python just prints them as ASCII instead of  escapes:
p9762
aVThe rest of your bytes fall outside of the printable ASCII range, so python is representing these as  literals, which happens to use hex notation
p9763
as(dp9764
g16
V100297
p9765
stp9766
a((dp9767
g2
(lp9768
VYou can use the  function to loop over both the matrix values and give you indices:
p9769
aVThis outputs:
p9770
aVBecause you are addressing rows and columns in the new matrix directly, you need to have initialized that new matrix with empty values first
p9771
aVThe list comprehension on the first line of my example does this for you
p9772
aVIt creates a new matrix that is (y, x) in size, given an input matrix of size (x, y)
p9773
aVAlternatively, you can avoid explicit looping altogether by (ab)using the  function:
p9774
aVwhich takes each row of  and groups each column in those rows into new rows
p9775
aVIn the generic case, python  constructs loop over sequences
p9776
aVThe  and  functions can produce numerical sequences for you, these generate a number sequence in much the same way that a  loop in C or JavaScript would produce:
p9777
aVbut the construct is far more powerful than the C-style  construct
p9778
aVIn most such loops your goal is to provide indices into some sequence, the python construct bypasses the indices and goes straight to the values in the sequence instead
p9779
as(dp9780
g16
V100297
p9781
stp9782
a((dp9783
g2
(lp9784
VTo find the implementation of any python operator, first find out what bytecode Python generates for it, using the  function:
p9785
aVThe  operator becomes a  byte code
p9786
aVNow you can trace this in the evaluation loop in :
p9787
aVis defined in the same file, and the  operator is one of the switches:
p9788
aVA quick grep shows us where  is defined, in Objects/abstract
p9789
aVc:
p9790
aVthus uses the  slot on the Sequence object structure or an iterative search otherwise, for Python C objects
p9791
aVFor python 3 unicode string objects, this slot is implemented as  in Objects/unicodeobject
p9792
aVc, in Python 2 you also want to check out  in Objects/stringobject
p9793
ag528
aVBasically just grep for  in the Objects/ subdirectory for the various implementations by the different Python types
p9794
aVFor generic python objects, it's interesting to note that Objects/typeobject
p9795
aVc defers this to the  method on custom classes, if so defined
p9796
as(dp9797
g16
V100297
p9798
stp9799
a((dp9800
g2
(lp9801
VWhen re-opening a pickle file (which is not meant to be a human-readable text format), use :
p9802
aVinstead of your  statements
p9803
aVYour output is the raw contents of a pickle dump, containing your saved results:
p9804
aVThe pickle format might be a little heavy-handed for your purposes
p9805
aVUsing a lighter, human readable format, such as  or  might be a better fit for your needs here
p9806
as(dp9807
g16
V100297
p9808
stp9809
a((dp9810
g2
(lp9811
VYou can limit the split to the first ';' only:
p9812
aVYour static part splitting might take a little more doing, but if you know the number of spaces is going to be static in the first part, perhaps the same trick could work there:
p9813
aVIf the first part of the line is more complex (spaces in the TYPE part) I fear that removing everything before that is going to be a more difficult affair
p9814
aVYour best bet is to figure out the limited set of values  could assume and to use a regular expression with that information to split the static part
p9815
as(dp9816
g16
V100297
p9817
stp9818
a((dp9819
g2
(lp9820
VPython will print newlines just fine, but your browser won't show these
p9821
aVUse  tags instead, or wrap the whole output in / tags
p9822
as(dp9823
g16
V100297
p9824
stp9825
a((dp9826
g2
(lp9827
VYou need to specify the whole path to the directory to be removed
p9828
aVOnly the last part of the path will be deleted, the  part will be untouched
p9829
aVThe deletion refers to any sub-directories contained within the named path, so if there is a  sub-directory it'll be removed together with it's parent
p9830
as(dp9831
g16
V100297
p9832
stp9833
a((dp9834
g2
(lp9835
VThe better solution would be for you to build your own context manager; by far the easiest way would be to use the  decorator:
p9836
aVThen use  as a context manager:
p9837
aVThis is a lot more compact and readable than having to retype the two larger context manager lines and has the added advantage that now you can run multiple commands in that same context
p9838
aVAs for your question; you can easily apply arbitrary arguments to a given function using the  syntax:
p9839
aVSee *args and **kwargs
p9840
aVfor more information on the  arbitrary argument lists tricks
p9841
as(dp9842
g16
V100297
p9843
stp9844
a((dp9845
g2
(lp9846
VThe  hash-bang line doesn't point to your virtualenv python; replace the first line with:
p9847
as(dp9848
g16
V100297
p9849
stp9850
a((dp9851
g2
(lp9852
VOne of your strings is not a unicode value, but a bytestring
p9853
aVYou want to convert that to unicode by decoding it first:
p9854
aVbut you will have to figure out what encoding the bytestring is in in the first place
p9855
aVIf you have defined a source file encoding and you are defining the string as a literal in your code, make sure you define it as a Unicode literal by prefixing the string with a :
p9856
aVI strongly recommend you read up on the Python Unicode HOWTO before you proceed, however
p9857
as(dp9858
g16
V100297
p9859
stp9860
a((dp9861
g2
(lp9862
VIf your output is escaped and you see literal  text in your browser, switch off autoescaping for the variable:
p9863
as(dp9864
g16
V100297
p9865
stp9866
a((dp9867
g2
(lp9868
V is a python function, not anything BS specific
p9869
aVIt let's you join a sequence with the string as a joining value:
p9870
aVis simply the empty string, and makes joining a whole set of strings together into one large one easier:
p9871
aVIn the specific case of your example, the statement finds all text contained in the  element, including any contained HTML elements such as  or  or  and puts them all together into one long string
p9872
aVSo  finds a sequence of python strings, and  then joins those together into one long string
p9873
as(dp9874
g16
V100297
p9875
stp9876
a((dp9877
g2
(lp9878
VUse  for each word and use these as sets:
p9879
aVThe  is a  subclass, but one that counts all the elements of a sequence you initialize it with
p9880
aVThus,  becomes
p9881
aVCounters act like multisets, in that when you use 2 in an intersection like above, their counts are set to the mimimum values found in either counter, ignoring anything whose count drops to 0
p9882
aVIf you were to compute their union, the maximum counts would be used instead
p9883
as(dp9884
g16
V100297
p9885
stp9886
a((dp9887
g2
(lp9888
VGoogle returns JSON, so use the  module instead of the ast module you are using now
p9889
aVYou may also want to study the  module to load the URL response instead of relying on curl
p9890
as(dp9891
g16
V100297
p9892
stp9893
a((dp9894
g2
(lp9895
VI am not experienced enough in the C API myself to give you any advice, but there are plenty of examples in the Python container implementations themselves
p9896
aVPersonally, I'd start with the tuple implementation first, since it's immutable: Objects/tupleobject
p9897
ag528
aVThen move on to the ,  and  implementations for further notes on mutable containers:
p9898
aVObjects/dictobject
p9899
ag528
aVObjects/listobject
p9900
ag528
aVObjects/setobject
p9901
ag528
aVI can't help but notice that there are calls to ,  and  throughout, as well as having  set
p9902
as(dp9903
g16
V100297
p9904
stp9905
a((dp9906
g2
(lp9907
VYou are importing all names from the  module into your local namespace, which means you do not need to prefix them anymore with the module name:
p9908
aVIf you were to import the module with an  statement instead, you added the module itself to your namespace and you do have to use the full name:
p9909
aVNote that the above examples is what I got from my tests in the interpreter
p9910
aVIf you get different results, you are importing the wrong module; check if you have an extra  file in your python package:
p9911
aVYou can also test for the name listing provided by the  module:
p9912
as(dp9913
g16
V100297
p9914
stp9915
a((dp9916
g2
(lp9917
VYou haven't specified by what you mean by 'efficient'
p9918
aVWhat tradeoffs are you willing to make
p9919
aVWould you be prepared to pay a price in performance loss when initializing a new string
p9920
aVWhen starting the search
p9921
aVWould you trade more memory for more speed
p9922
aVThe python developers set clear goals when they developed the python string library:
p9923
aVshould be faster than the current brute-force algorithm for all test cases (based on real-life code), including Jim Hugunin\u2019s worst-case test
p9924
aVsmall setup overhead; no dynamic allocation in the fast path (O(m) for speed, O(1) for storage)
p9925
aVsublinear search behaviour in good cases (O(n/m))
p9926
aVno worse than the current algorithm in worst case (O(nm))
p9927
aVshould work well for both 8-bit strings and 16-bit or 32-bit Unicode strings (no O(\u03c3) dependencies)
p9928
aVmany real-life searches should be good, very few should be worst case
p9929
aVreasonably simple implementation
p9930
aVSo the devs had set some limits on performance for the search case and the setup case, on storage requirements, and also on maintenance efficiency
p9931
aVThose boundaries ruled out Boyer\u2013Moore (as it requires preprocessing on the searched-for string, a startup cost and a storage cost), and although I see no evidence that the devs considered Rabin-Karp, it can be ruled out on the same grounds (you need to create the hashes and store these)
p9932
aVThe boundaries were set based on a lot of python internals and usage experience
p9933
aVThe above summary wasn't pulled out of thin air, it is merely a summary of that experience
p9934
aVNow, if you have a specific case where your trade-offs can be set differently, then sure, a C implementation of a different algorithm could well beat the standard Python implementation
p9935
aVBut it'll be more efficient according to a different set of criteria
p9936
aVIn any case, the Python search algorithm deals with the small strings case
p9937
aVIf you try to apply it to a large body of text, the algorithms will not be able to perform as well as one that makes different choices that work well for large texts
p9938
aVAnd if you had to search for text through 10,000,000 documents you'd want to use some kind of indexing solution instead puny little python string search
p9939
aVCompare that to sorting a list of 100 items with the default sort implementation, vs
p9940
aVsorting 10,000,000,000 integers
p9941
aVIn the latter case there are sorting implementations that can easily beat the default Python offer
p9942
aVIt should also be noted that Python has a history of algorithm innovation; the standard sort algorithm in Python is TimSort, a new algorithm invented by Tim Peters to fit the pragmatic real-life circumstances the Python interpreter has to deal with
p9943
aVThat algorithm has since been made the default in Java and the Android platform as well
p9944
aVThus, I tend to trust the Python core devs decisions
p9945
aVAs far as I know, noone has embedded a different implementation, as replacing the default is not going to work without patching the Python C code
p9946
aVYou can easily create a specialized string type that implements a different search algorithm, of course
p9947
aVThere may well be libraries out there that use C for specialized search algorithms that use Boyer-Moore, Rabin-Karp or any other algorithm, as that might well be the better choice for their specific problem domain
p9948
as(dp9949
g16
V100297
p9950
stp9951
a((dp9952
g2
(lp9953
VThis is not something you can do, with python or any other process
p9954
aVThe process id is assigned by the Linux kernel, and there are guarantees as to the uniqueness of the id
p9955
aVMoreover, if your process is used a child process of another, it's process id lives on in the kernel process table until the parent process has acknowledged that it has read the exit status
p9956
aVThat means you cannot simply re-use the process id at a later time, it may still be reserved in the process table
p9957
aVI'm sure you can devise a creative kill command that'll catch your process every time:
p9958
aVor similar
p9959
as(dp9960
g16
V100297
p9961
stp9962
a((dp9963
g2
(lp9964
VDon't just load the whole SQL result into memory, and expect this to work for all cases
p9965
aVMoreover, use the database to do the sorting for you, that's what it is good at
p9966
aVSimply loop over the cursor and process results one by one, that way you don't have to fill up memory with intermediate results:
p9967
as(dp9968
g16
V100297
p9969
stp9970
a((dp9971
g2
(lp9972
VTAL statements are attributes on existing tags
p9973
aVYou can introduce dummy elements with the  namespace prefix, but the statements like  and  need to expressed as attributes still
p9974
aVAlso, the default TALES expression type is path expressions, but you want to use python expressions
p9975
aVThat's fine, but you need to specify them as such with the  prefix
p9976
aVLast but not least, don't use  unless you absolutely have to, which is really rarely
p9977
aVDefined names live in the scope of the XML element they are defined on, and don't need to live on outside of these
p9978
aVHere is how I'd express the logic:
p9979
aVThis introduces a new  element to define the  boolean variable, determined by a python expression
p9980
aVThen the two variants are switched on or off by the  attributes on each element based on that value being  or
p9981
as(dp9982
g16
V100297
p9983
stp9984
a((dp9985
g2
(lp9986
VThe are essentially the same, except for what you have to escape:
p9987
aVboth work, but to incorporate multiple quote types you must escape the ones used to create the string:
p9988
aVThe two exist to make it easy for you to avoid having to escape your quotes, so the following two are easy:
p9989
aVNote that there are also tripple-quote variants:
p9990
aVThese also allow newlines to be included without escaping:
p9991
aVThat last example would require you to use excessive  escape sequences otherwise
p9992
as(dp9993
g16
V100297
p9994
stp9995
a((dp9996
g2
(lp9997
VYou can make an infinite generator that counts up and down:
p9998
aVwould output:
p9999
aVYou cannot prevent  from trying to consume all memory, no
p10000
aVAs the doctor would say: "Then don't do that
p10001
aVUse  calls instead, or use your generator with another statement that limits the number of times you iterate over the generator
p10002
aVThe  function would do just that:
p10003
as(dp10004
g16
V100297
p10005
stp10006
a((dp10007
g2
(lp10008
VYou need to implement a  handler too:
p10009
aVbut this potentially gives you text in chunks instead of as one block per tag
p10010
aVDo yourself a big favour though and use the ElementTree API instead; that API is far pythononic and easier to use than the XML DOM API
p10011
aVIf all you want is a straight conversion to a dictionary, take a look at this handy ActiveState Python Cookbook recipe: Converting XML to dictionary and back
p10012
aVNote that it uses the ElementTree API as well
p10013
aVIf you have a set of existing elements you want to look for, just use these in the  method:
p10014
as(dp10015
g16
V100297
p10016
stp10017
a((dp10018
g2
(lp10019
VThe settings
p10020
aVpy file is just python, so you can easily switch out statements based on the platform
p10021
aVUse the  module:
p10022
as(dp10023
g16
V100297
p10024
stp10025
a((dp10026
g2
(lp10027
VYou need to use a sentinel to detect that a default value was not set:
p10028
aVThis works because an instance of  will always have it's own memory id and thus  will only return True if the exact value was left in place
p10029
aVAny other value will not register as the same object, including
p10030
aVYou'll see different variants of the above trick in various different python projects
p10031
aVAny of the following sentinels would also work:
p10032
as(dp10033
g16
V100297
p10034
stp10035
a((dp10036
g2
(lp10037
VYou need to put the  keyword after the method positional parameters:
p10038
aVAlternatively, use the  keyword explicitly, or use the  method:
p10039
aVor
p10040
as(dp10041
g16
V100297
p10042
stp10043
a((dp10044
g2
(lp10045
VYou can do this by providing a custom  class; the internals of which are officially undocumented
p10046
aVThis means you are on your own when it comes to compatibility from Python version to version, but I find the interface quite stable:
p10047
aVHere I sort on the option strings (, etc
p10048
aV, but you could take your pick as to what you want to sort on
p10049
aVThis simple sorting option puts the single-dash options last, like the  option
p10050
aVwhich outputs:
p10051
as(dp10052
g16
V100297
p10053
stp10054
a((dp10055
g2
(lp10056
VYou'd need to create a list, append all the mappings to that before conversion to JSON:
p10057
as(dp10058
g16
V100297
p10059
stp10060
a((dp10061
g2
(lp10062
VThere is very little you cannot access in Python, as there are few, if any, private attributes to the Python build-in types
p10063
aVYou really want to go read up on the python datamodel, and study the inspect module (including it's source code)
p10064
aVThat'll tell you all you need to know about what you can and cannot access in python
p10065
as(dp10066
g16
V100297
p10067
stp10068
a((dp10069
g2
(lp10070
VThe M2Crypto module deals exclusively with opaque bytes, which are values between 0 and 255, represented as the python  type
p10071
aVThe Python 2
p10072
aVx  type consists of such bytes, but the  type is a different beast altogether
p10073
aVYou can easily convert between the two by using the  method and it's mirror method
p10074
aVWhen you call  on a  object, it makes the conversion by applying the default encoding, in essence it calls
p10075
aVThat's fine for your all-ASCII email address, but you're bound to run into  exceptions with anything else
p10076
aVBetter stick to using the explicit methods only
p10077
aVNote that you probably have to set the encoding you used on the MIME headers of the email you send
p10078
aVI strongly recommend you read up on the all this in the Python Unicode HOWTO
p10079
as(dp10080
g16
V100297
p10081
stp10082
a((dp10083
g2
(lp10084
VYou are looking for the  dictionary:
p10085
aVThe WebOb project, a lightweight web framework, includes a handy accept parser that you could reuse in this case:
p10086
aVNote that installing the WebOb package won't interfere with Django's functionality, we are just re-using a class from the package here that happens to be very useful
p10087
aVA short demo is always more illustrative:
p10088
as(dp10089
g16
V100297
p10090
stp10091
a((dp10092
g2
(lp10093
VUse  in python 2
p10094
aVx; in python 3
p10095
aVx,  is a view and not a new list
p10096
aVIn python 2
p10097
aV7, you can also use the  method to get the same thing
p10098
aVThere is an equivalent  method, making your utility method redundant
p10099
aV:-) The same remarks apply here for python 3
p10100
aVx and 2
p10101
aV7, see the documentation supplied
p10102
as(dp10103
g16
V100297
p10104
stp10105
a((dp10106
g2
(lp10107
VYou are looping over the list itself, which means you don't need to use the values as an index:
p10108
aVIn python, the  construct doesn't work just with numbers, it works directly with the elements of the sequence you are looping over
p10109
as(dp10110
g16
V100297
p10111
stp10112
a((dp10113
g2
(lp10114
VThe  object has a  attribute that tells you the names of each column, use that to turn a row into a dict:
p10115
aVFor details on the  attribute, see the Python DB API 2
p10116
aV0 specification
p10117
as(dp10118
g16
V100297
p10119
stp10120
a((dp10121
g2
(lp10122
VConvert the underlying bytes to a base64 value, stripping the  padding and the newline
p10123
aVYou probably want to turn any  characters in the output to underscores:
p10124
aVThe reverse:
p10125
aVTo turn that into generic functions:
p10126
aVThis gives you a method to represent the 16-byte UUID in a more compact form
p10127
aVCompress any further and you loose information, which means you cannot decompress it again to the full UUID
p10128
aVYouTube's unique string is thus not based on a full 16-byte UUID, their 11 character ids are probably stored in the database for easy lookup and based on a smaller value
p10129
as(dp10130
g16
V100297
p10131
stp10132
a((dp10133
g2
(lp10134
VThe last two statements compare booleans against an integer:
p10135
aVThe first statement is comparison chaining, which works for all boolean comparisons in Python
p10136
aVNote from the documentation:
p10137
aVComparisons yield boolean values: True or False
p10138
aVBy placing parts of your expression in brackets, those parts get evaluated first and you end up with comparing integers and booleans
p10139
as(dp10140
g16
V100297
p10141
stp10142
a((dp10143
g2
(lp10144
VYou are running the  (download) command under , but the python process itself is running without elevated privileges
p10145
aVRun it like this instead:
p10146
aVAlternatively, use the  command on the  part of the pipe instead:
p10147
as(dp10148
g16
V100297
p10149
stp10150
a((dp10151
g2
(lp10152
VEggs are tied to a specific architecture and python version, and until Python 3
p10153
aV3, if the egg contains C extensions, even the internal Unicode representation size (UCS2 vs
p10154
aVUCS4)
p10155
aVUnfortunately, the latter difference is not captured in the egg metadata; an egg filename contains the architecture and the python version (major
p10156
aVminor, so 2
p10157
aV4 or 3
p10158
aV1) but the unicode byte size is omitted
p10159
aVBecause of this, eggs are not very portable
p10160
aVA  or  distribution on the other hand, is (hopefully) platform agnostic
p10161
aVYour installation tool, be it , ,  or whatever, knows how to compile a python package distribution into an egg for you, so you generally avoid distributing the  files altogether
p10162
aVThe only exception is Windows, where most people will be lacking the toolchain to compile C extensions
p10163
aVAs Windows distributions of Python default to UCS2, you are usually safe to distribute Windows  builds of packages with C extensions, to facilitate installation by automated tools
p10164
aVIf you use the  script to create the distribution, it's trivial to create a source-only package for upload to PyPI
p10165
aVI can recommend the Hitchhiker's Guide to Packaging for more information
p10166
as(dp10167
g16
V100297
p10168
stp10169
a((dp10170
g2
(lp10171
VIf you need a uniform sample of N lines in your file, you need to know the exact number of lines to pick from; seeking at random doesn't do this, longer lines skew the results in favour of lines directly following the longest lines
p10172
aVLuckily, you only need to read your file once to pick those N lines
p10173
aVYou basically pick your N first lines (in random order), then randomly replace picked lines with new ones with a diminishing probability based on the number of lines read
p10174
aVFor N == 1, the chance that the nth line read replaces the previous random pick is , so, the second line has a 50% chance of being picked, the third has a 33
p10175
aV33% chance, etc
p10176
aVFor larger N, replace one of the already picked lines in your set at random as more lines are read, with the same distribution
p10177
aVIn Python random lines from subfolders, Blkknght wrote a very helpful function for picking a random sample of size N from an iterable:
p10178
aVThis is trivial to combine with your requirements to preserve a set of headers:
p10179
aVThis will read your whole file in one go, pick a uniform random sample, and write it out to the output file
p10180
aVThus, this has \u0398(L) complexity, with L being the number of lines in the file
p10181
as(dp10182
g16
V100297
p10183
stp10184
a((dp10185
g2
(lp10186
VUnfortunately,  is probably the wrong approach
p10187
aVIt is intended to control the reflection of an existing database table into a mapper, not make a column 'read-only'
p10188
aVI think a better approach would be to use a hybrid property:
p10189
aVThe original  column is available via a private attribute, and the  property intercepts writes and stores them on the instance to be re-used later, but not written to the database
p10190
as(dp10191
g16
V100297
p10192
stp10193
a((dp10194
g2
(lp10195
VOn windows, the  value does not have enough granularity (only 1/60th of a second)
p10196
aVUse , which on windows has 1/100th of a second resolution, instead:
p10197
aVOr, to make this cross-platform:
p10198
aVThis is the same decision the  module makes; you could use the
p10199
aVdefault_timer() definition instead as well:
p10200
as(dp10201
g16
V100297
p10202
stp10203
a((dp10204
g2
(lp10205
VThe Python  function indeed does not the support  format for timezones (because the underlying  function doesn't support it)
p10206
aVYou have two options:
p10207
aVIgnore the timezone when parsing with :
p10208
aVuse the  module, it's parse function does deal with timezones:
p10209
aVQuick demo on the command prompt:
p10210
as(dp10211
g16
V100297
p10212
stp10213
a((dp10214
g2
(lp10215
VYou are currently retrieving only the text content, not the HTML content (which would include tags)
p10216
aVYou want to retrieve all child nodes of your XPath match instead:
p10217
as(dp10218
g16
V100297
p10219
stp10220
a((dp10221
g2
(lp10222
VThe python compiled code uses indices; the variables are tied to an index into the cells structure
p10223
aVThe  bytecode refences the first cell value
p10224
as(dp10225
g16
V100297
p10226
stp10227
a((dp10228
g2
(lp10229
VYou need to call your function, you are printing just the function object itself:
p10230
aVNote the difference between the the  and  lines
p10231
as(dp10232
g16
V100297
p10233
stp10234
a((dp10235
g2
(lp10236
VYou are slicing your line too short; the second value is exclusive, not inclusive:
p10237
as(dp10238
g16
V100297
p10239
stp10240
a((dp10241
g2
(lp10242
VYou need to specify each argument in a separate item, and long arguments are actually 2 values:
p10243
aVNormally, the shell parses such a command line, splits it on whitespace (except where text has been enclosed in quotes), and passes that on to the new process as the  value
p10244
aVNow, you are creating that  list yourself, and you have to do the splitting yourself
p10245
aVNote that the  argument thus no longer needs to have the shell-level quotes either
p10246
aVA short argument ( or similar) doesn't have that whitespace, so you didn't have a problem with those
p10247
as(dp10248
g16
V100297
p10249
stp10250
a((dp10251
g2
(lp10252
VThe function body is compiled, then it assigned to the local namespace under the variable name
p10253
aVWhen you then run the second  statement a new function is stored under that same name, overwriting the first
p10254
aVYou can preserve the first one by storing a reference to it in a new name:
p10255
aVso you can later on refer to it still as :
p10256
aVYou could also store it in a dictionary, a list, or as an attribute on another object
p10257
as(dp10258
g16
V100297
p10259
stp10260
a((dp10261
g2
(lp10262
VYou can create the object without any values:
p10263
aVYou, however, imported the class datetime from the module, replacing the module itself:
p10264
aVand that has a different signature:
p10265
aVEither import the whole module, or import the contained classes, but don't mix and match
p10266
aVStick to:
p10267
aVif you need both modules
p10268
as(dp10269
g16
V100297
p10270
stp10271
a((dp10272
g2
(lp10273
VEach result in the  list is another element object, so you can do further searches on these:
p10274
aVThis gives me:
p10275
as(dp10276
g16
V100297
p10277
stp10278
a((dp10279
g2
(lp10280
VYou need to seek to the end of the file, then read some chunks in blocks from the end, counting lines, until you've found enough newlines to read your  lines
p10281
aVBasically, you are re-implementing a simple form of tail
p10282
aVHere's some lightly code that does just that:
p10283
as(dp10284
g16
V100297
p10285
stp10286
a((dp10287
g2
(lp10288
VYou'd generally return a  object from the id part of the URL traversal
p10289
aVWhat happens with traversal is that for each element in the URL path, an object is looked up and made the new current object for the next path element lookup
p10290
aVSo for , the root object is asked for something matching that name, and the result of that lookup is made the new "current" object, and  is then looked up on that new object
p10291
aVSo, what you are looking for is a dispatcher object, something that looks up articles based on the longer id you are passed, and that returns your  instances:
p10292
aVNote how I returned a  when you use the  URL path, and also how I set the  and  variables; you'll need those to be able to generate URLs for those instances
p10293
aVThe  object returned now contains the actual article data, and the view can access that information when rendering
p10294
aVYou really want to go and study the Pyramid Traversal tutorial which explains this all in more detail
p10295
as(dp10296
g16
V100297
p10297
stp10298
a((dp10299
g2
(lp10300
VIf any such object is unique based on a combination of columns, you need to mark these as a composite primary key
p10301
aVAdd the  keyword parameter to each of these columns, dropping your  column altogether:
p10302
aVThat way your database can handle these rows more efficiently (no need for an incrementing column), and SQLAlchemy now automatically knows if two instances of  are the same thing
p10303
aVI believe you can then just merge your new  back into the session:
p10304
as(dp10305
g16
V100297
p10306
stp10307
a((dp10308
g2
(lp10309
VNo, Cassandra is a NoSQL storage system, and doesn't support fundamental SQL semantics like joins, let alone SQL queries
p10310
aVSQLAlchemy works exclusively with SQL statements
p10311
aVCQL is only SQL-like, not actual SQL itself
p10312
aVTo quote from the Cassandra CQL documentation:
p10313
aVAlthough CQL has many similarities to SQL, there are some fundamental differences
p10314
aVFor example, CQL is adapted to the Cassandra data model and architecture so there is still no allowance for SQL-like operations such as JOINs or range queries over rows on clusters that use the random partitioner
p10315
aVYou are of course free to store all your data in Casandra, but that means you have to re-think how you store that data and find it again
p10316
aVYou cannot use SQLAlchemy to map that data into Python Objects
p10317
as(dp10318
g16
V100297
p10319
stp10320
a((dp10321
g2
(lp10322
VPyramid uses the  method to define boundaries between different pluggable applications, see Extending An Existing Pyramid Application
p10323
aVThe  method accepts either a callable, or a python path to a callable, so you can use both separate eggs and a set of nested packages inside your main project package
p10324
aVYou'll have to decide for yourself if you need some of these pluggable elements to be separate python components (distributed with a setup
p10325
aVpy, installable as an egg)
p10326
aVIf they are intended to be reusable outside the project, then keep them separate
p10327
as(dp10328
g16
V100297
p10329
stp10330
a((dp10331
g2
(lp10332
VLink integrity works by adding references named  between objects, but it only does this for HTML links within TextFields, whenever an object is modified
p10333
aVTo support individual reference fields, you have 2 options:
p10334
aVAdd  relationships whenever you add your  relationship, remove them again when the  relationship is gone, using events or the extender
p10335
aVLink integrity will then kick in
p10336
aVTrack the removal of an  relationship as an integrity breach
p10337
aVYou'd need to check if the referring object is being removed
p10338
aVTake a look at the handlers
p10339
aVpy module of the  package
p10340
aVThe  event handler is called whenever any Archetypes reference is deleted
p10341
aVIt updates the  storage, adding both source and target of a  relationship, and this storage is consulted when handling content object deletion
p10342
aVCreate a new event handler for your  reference and it'll be handled in the same way; delete a referenced image and the link integrity warning will be raised:
p10343
aVregistered with ZCML:
p10344
as(dp10345
g16
V100297
p10346
stp10347
a((dp10348
g2
(lp10349
VYou need to switch off prefetching, which I think is a parameter that changed defaults:
p10350
aVUPDATE:
p10351
aVIn the latest  framework, use  instead of :
p10352
as(dp10353
g16
V100297
p10354
stp10355
a((dp10356
g2
(lp10357
VYou need a negative look-ahead assertion:
p10358
aVThis matches any string that does not have  after the  characters
p10359
aVPython demo:
p10360
as(dp10361
g16
V100297
p10362
stp10363
a((dp10364
g2
(lp10365
VWhen passed a command,  forks and invokes the command immediately
p10366
aVThe echo command in your example would have been run already
p10367
aVThis is implied in the  constructor documentation:
p10368
aVThis is the constructor
p10369
aVThe command parameter may be a string that
p10370
aVincludes a command and any arguments to the command
p10371
aVFor example::
p10372
aVYou may also construct it with a list of arguments like so::
p10373
aVAfter this the child application will be created and will be ready to
p10374
aVtalk to
p10375
aVI've confirmed this by looking at the source code; the constructor calls  which is documented as follows:
p10376
aVThis starts the given command in a child process
p10377
aVThis does all the
p10378
aVfork/exec type of stuff for a pty
p10379
aVThis is called by
p10380
aVIf args
p10381
aVis empty then command will be parsed (split on spaces) and args will be
p10382
aVset to parsed arguments
p10383
as(dp10384
g16
V100297
p10385
stp10386
a((dp10387
g2
(lp10388
VSimply parse the whole line with one regular expression:
p10389
aVDemo (with the sys
p10390
aVexit temporarily replaced with a return):
p10391
aVThe regular expression matches digits at the start (matched by the  caret), then units from the limited set of , , ,  or , but only if they are at the end of the line, matched by the  dollar sign
p10392
aVIt would be more pythonic to raise an exception in the validation method, btw, and handle that exception where you are calling the method
p10393
aVThis makes it more reusable:
p10394
as(dp10395
g16
V100297
p10396
stp10397
a((dp10398
g2
(lp10399
VYou'll need to switch to an iterative parser, which processes XML statements in chunks, allowing you to clear up memory in between
p10400
aVThe DOM parser loads the whole document into memory in one go
p10401
aVThe standard library has both a SAX parser and ElementTree
p10402
aViterparse options available for you
p10403
aVQuick iterparse example:
p10404
aVNote the  call; that frees up the element and removes it from memory
p10405
as(dp10406
g16
V100297
p10407
stp10408
a((dp10409
g2
(lp10410
VNope, python dicts will not see any difference in what characters you use in the key string
p10411
aVThey are optimized to deal with strings only versus arbitrary key objects, but if you use only string values for keys you won't see any difference between using keys without and with non-alphanumeric characters
p10412
aVThe string-only codepath is an optimization for the most common usecase for python dicts: namespaces and function definitions
p10413
aVThis is the default mode for a dict; as soon as you store a non-string key in it, the lookup method is switched and you'll have a teensy-weensy slower dict on your hands
p10414
aVThis won't matter much in most Python applications though
p10415
as(dp10416
g16
V100297
p10417
stp10418
a((dp10419
g2
(lp10420
VYou'll need to combine the ranges into one character class, otherwise it will match one or the other range, not both:
p10421
aVDemo:
p10422
as(dp10423
g16
V100297
p10424
stp10425
a((dp10426
g2
(lp10427
VWhen using the  you basically are creating a nested parser:
p10428
aVNow you have a new parser object, that you can add switches to
p10429
aVOr, you can add another level of nesting:
p10430
aVThis can go as deep as you need to to control exact formatting
p10431
aVEach level provides help:
p10432
aVYou can have each end-point call a function, by using  on the subparser in question, then using that default  argument to call the selected function for the current arguments:
p10433
as(dp10434
g16
V100297
p10435
stp10436
a((dp10437
g2
(lp10438
VYou need to let the MySQL library do the parameter handling for you; this has the added benefit of letting MySQL prepare your statement, making repeated inserts faster too:
p10439
aVSee the Python DB API 2
p10440
aV0 spec for (some) more details on parametrized SQL
p10441
aVThe exact supported parameter formats are documented per database adapter, so check that too
p10442
aVThe MySQLdb module, for example, mimics the python string formatting syntax, and uses  as placeholders:
p10443
aVOther possible parameter options are numbers (, etc
p10444
aV, names () or the other form of python string formatting, named format specifiers: ()
p10445
as(dp10446
g16
V100297
p10447
stp10448
a((dp10449
g2
(lp10450
VEasy enough with a regular expression:
p10451
aVThat'll match (optional) whitespace, followed by a number in parethesis, with the number put in a group for easy replacing:
p10452
aVDemo:
p10453
aVComplete code for your specific example:
p10454
as(dp10455
g16
V100297
p10456
stp10457
a((dp10458
g2
(lp10459
VYou are missing the  egg; in some cases, this egg is nested inside a development egg within your buildout which confuses buildout and it won't install it
p10460
aVThe work-around is to install it manually:
p10461
as(dp10462
g16
V100297
p10463
stp10464
a((dp10465
g2
(lp10466
VYou are using a regular expression, and matching XML with such expressions get too complicated, too fast
p10467
aVUse a HTML parser instead, Python has several to choose from:
p10468
aVElementTree is part of the standard library
p10469
aVBeautifulSoup is a popular 3rd party library
p10470
aVlxml is a fast and feature-rich C-based library
p10471
aVElementTree example:
p10472
as(dp10473
g16
V100297
p10474
stp10475
a((dp10476
g2
(lp10477
VIf you are concerned with cookie security, you should always use SSL encryption
p10478
aVThe same username is included in the page output, for example, so the fact that it's included in the cookie as well isn't a information leak as such
p10479
aVThe cookie uses a cryptographic hash that has a limited timespan, the default is 12 hours, after which the cookie will no longer be accepted
p10480
aVYou can lower this timeout:
p10481
aVgo to the ZMI of your plone instance
p10482
aVFind the  folder, then the  plugin:
p10483
aVGo to the  tab (right-most tab)
p10484
aVChange the "Cookie validity timeout (in seconds)" property to a new value
p10485
aVTake note of the "Refresh interval (in seconds, -1 to disable refresh)" value below it though; whenever the signed cookie is older than the refresh interval, a new cookie is generated, to refresh the cookie lifetime
p10486
aVSo, by default, once every hour, you are issued a new cookie that is valid for 12 hours
p10487
aVYou don't want your cookie validity timeout to fall below the refresh interval
p10488
aVIf you set these values very low, you may want to think about using a periodic AJAX 'ping' request to keep the cookie fresh while the user is still using the site
p10489
aVIn fact,  already includes a facility to implement this ping for you
p10490
aVSimply enable it by installing the "Session refresh support" add-on in the control panel ("Site setup" > "Add-ons"  > check "Session refresh support 3
p10491
aV5", click "Activate")
p10492
aVThis will install the javascript library for you, and it'll ping the server every 5 minutes, provided there has been some mouse or keyboard activity while the current page is loaded
p10493
as(dp10494
g16
V100297
p10495
stp10496
a((dp10497
g2
(lp10498
V files contain byte-compiled python
p10499
aVThese can be de-compiled again into very readable python code, and are not a protection from people studying the source code
p10500
aVIf you do want to use this, you need to make sure all files are compiled, use:
p10501
aVbefore removing the  source files
p10502
as(dp10503
g16
V100297
p10504
stp10505
a((dp10506
g2
(lp10507
VYour 'template' contains the string  (right after the  there), and python is interpreting that as a formatting instruction
p10508
aVDouble the  percent characters to  and it'll work
p10509
aVAlternatively, use the newer  method for a format less prone to such problems, although in this specific case that'll get hung up on the  curly braces pairs, so your mileage may very well vary; you'd have to double those instead (so )
p10510
as(dp10511
g16
V100297
p10512
stp10513
a((dp10514
g2
(lp10515
VYou cannot remove class attributes from an inherited base class; you can only mask them, by setting an instance variable with the same name:
p10516
aVYour own class could of course also override it with a class variable:
p10517
as(dp10518
g16
V100297
p10519
stp10520
a((dp10521
g2
(lp10522
VYou are calling  which loads the whole file into memory
p10523
aVIterate over the file instead:
p10524
aVThis'll iterate over lines one by one, reading more lines as needed
p10525
as(dp10526
g16
V100297
p10527
stp10528
a((dp10529
g2
(lp10530
VThis is pretty basic usage of the  method:
p10531
aVThe parethesis around the  number pattern create a group, and the  reference is replaced with the contents of the group
p10532
as(dp10533
g16
V100297
p10534
stp10535
a((dp10536
g2
(lp10537
VIt is called a mutt encoding; the underlying bytes have been mangled beyond their original meaning and they are no longer a real encoding
p10538
aVIt was once URL-quoted UTF-8, but now interpreted as latin-1 without unquoting those URL escapes
p10539
aVI was able to un-mangle this by interpreting it as such:
p10540
as(dp10541
g16
V100297
p10542
stp10543
a((dp10544
g2
(lp10545
VPyPI let's you select packages by the Python 3 classifier
p10546
aVThat's a big list though, and not necessarily very helpful
p10547
as(dp10548
g16
V100297
p10549
stp10550
a((dp10551
g2
(lp10552
VThere isn't, I'm afraid
p10553
aVIf your users alter the site when logged in, disable logging in for them until you are done
p10554
aVGenerally, for tasks like these, I run the changes in batches, to minimize conflicts and allow end-users to continue to use the site as normal
p10555
aVBreak your work up in chunks, and commit after every n items processed
p10556
as(dp10557
g16
V100297
p10558
stp10559
a((dp10560
g2
(lp10561
VI suspect the sourcecode on your server has changed since you started it
p10562
aVIn fact, I am almost certain of it
p10563
aVPython byte-code includes a line number, and when a traceback occurs, this line number is used to look up and show you the non-compiled source line
p10564
aVOnce the bytecode is loaded into memory however, it is not reloaded if you were to change the source file
p10565
aVIf you add or remove lines from the source file after your server has started, lines in a traceback will be wrong
p10566
aVIn other words, the line shown in your traceback is almost certainly not the line where the error occurs
p10567
aVI certainly would not expect a simple  to ever throw that exception
p10568
aVThe specific exception () would only occur when trying to look up a specific entry in the list through  (a  operation)
p10569
as(dp10570
g16
V100297
p10571
stp10572
a((dp10573
g2
(lp10574
VIf the schema is linked using attributes on the root element, in the  namespace, you can retrieve these with lxml by prefixing the attribute name with the namespace URL in curly braces:
p10575
aVand then use a URL library to load the schema from the location referred
p10576
aVSee lxml namespace handling for more information
p10577
as(dp10578
g16
V100297
p10579
stp10580
a((dp10581
g2
(lp10582
VWhen turning a float into a string (printing does this automatically), python limits it to only the 12 most significant digits, plus the decimal point
p10583
aVWhen returning the number from a function, you always get the full precision
p10584
aVTo print more digits (if available), use string formatting:
p10585
aVThat defaults to 6 digits, but you can specify more precision:
p10586
aVAlternatively, python offers a newer string formatting method too:
p10587
as(dp10588
g16
V100297
p10589
stp10590
a((dp10591
g2
(lp10592
VYou are modifying the list in-place while looping over it, which has consequences for what elements you see:
p10593
aVNote how  is never printed; by removing the second entry in the list, we've shortened it by one element and the loop finds the list exhausted early
p10594
aVNote that you don't need to loop over the items, a few simple comparisons will tell you what item is the median if you think about it for a second
p10595
aV:-)
p10596
as(dp10597
g16
V100297
p10598
stp10599
a((dp10600
g2
(lp10601
VYou want to decode the response, not the request:
p10602
aVThe response is a file-like object, so you can use  to have the json library read it directly
p10603
aVAlternatively (at the cost of some temporary memory use), use the  function with the fully read response:
p10604
aVNote that python 2
p10605
aV7 already includes the simplejson library, renamed to :
p10606
as(dp10607
g16
V100297
p10608
stp10609
a((dp10610
g2
(lp10611
VEndian-ness only applies to multi-byte words, but UTF-8 uses units of 8 bits to encode information (that's what the 8 in the name stands for)
p10612
aVThere never is the question of confusion of ordering there
p10613
aVSometimes it may need more than one of those units to encode information, but they are considered distinct
p10614
aVThe letter  is one byte, , for example
p10615
aVWhen it has to encode a character with more bytes, it uses a leading indicator byte, followed by extra continuation bytes to capture all the information needed for that character
p10616
aVLogically, these are distinct units
p10617
aVGBK uses a similar scheme; characters use units of 1 byte, and just like UTF-8, a second byte can be used for some of the characters
p10618
aVUCS-2 (and it's successor, UTF-16) on the other hand, is a 2-byte format
p10619
aVIt encodes information in units of 16 bits, and those 16 bits always go together
p10620
aVThe 2 bytes in that unit belong together logically, and modern architectures treat these as one unit, and thus have made a decision in what order they are stored
p10621
aVThat's where endianess comes in, the order of the 2 bytes in a unit is architecture dependant
p10622
aVIn your architecture, the bytes are ordered using little-endianess, meaning that the 'smaller' byte goes first
p10623
aVThis is why the  byte comes before the  byte in your file
p10624
aVNote that python can read either big or little endian UTF-16 just fine; you can pick the endianess explicitly if there is no indicator character at the start (the Byte Order Mark, or BOM):
p10625
aVIn the latter example the bytes have been reversed, and decoded as big-endian
p10626
as(dp10627
g16
V100297
p10628
stp10629
a((dp10630
g2
(lp10631
VYou need to detach your  instance from the main thread session before you put it into the queue, then attach it to the queue processing thread session when taken from the queue again
p10632
aVTo detach, call  on the session, passing in the request:
p10633
aVand then when processing it in a queue thread, re-attach it by merging; set the  flag to False to prevent a round-trip to the database again:
p10634
as(dp10635
g16
V100297
p10636
stp10637
a((dp10638
g2
(lp10639
VPython objects are stored on a heap and are garbage collected via reference counting
p10640
aVVariables are references to objects like in Java, and thus point 1 applies
p10641
aVI am not familiar with either C++ or automatically dereferenced pointer variables in C, to make a call on those
p10642
aVUltimately, it's the python interpreter that does the looking up of items in the interpreter structures, which usually are python lists and dictionaries and other such abstract containers; namespaces use  (a hash table) for example, where the names and values are pointers to other python objects
p10643
aVThese are managed explicitly by the mapping protocol
p10644
aVTo the python programmer, this is all hidden; you don't need to know where your objects live, just that they are still alive as long as you have something referencing them
p10645
aVYou pass around these references when coding in python
p10646
as(dp10647
g16
V100297
p10648
stp10649
a((dp10650
g2
(lp10651
VThe parser doesn't see  as a tuple, although it does do tuple unpacking for you
p10652
aVThus, there is no tuple to create, let alone destroy
p10653
aVInstead, python sees this as two separate variables  and
p10654
aVYou can see this if you were to disassemble the compiled bytecode for the statement:
p10655
aVThe constant  is unpacked, then stored into the local variables  and
p10656
as(dp10657
g16
V100297
p10658
stp10659
a((dp10660
g2
(lp10661
VPython cannot control the encoding used by your terminal; you'll have to change that somewhere else
p10662
aVIn other words, just because you force python to output UTF-8 encoded text to the terminal, does not mean your terminal will magically start to accept that output as UTF-8 as well
p10663
aVThe Mac OS X terminal has already been configured to work with UTF-8
p10664
aVOn Windows, you can switch the console codepage with the  command:
p10665
aVwhere 65001 is the Windows codepage for UTF-8
p10666
aVSee Unicode characters in Windows command line - how
p10667
as(dp10668
g16
V100297
p10669
stp10670
a((dp10671
g2
(lp10672
VIn python, the  notation refers to Unicode codepoints, not to any encoding of those codepoints
p10673
aVUCS-2, UTF-16, UTF-8 are all encodings capable of capturing those codepoints in bytes suitable for storage in files, for transferring across a network, etc
p10674
aVThe R representation of the  codepoint includes the UTF-16 Byte Order Mark, or BOM
p10675
aVIt indicates what byte order is chosen, where 0xFFFE means little endian
p10676
aVPython includes it too, when you encode to UTF-16:
p10677
aVThe big-endian equivalent is 0xFEFF
p10678
aVYou can explicitly encode to  or  in python to avoid the BOM being included, because you've made an explicit choice:
p10679
aVYou really should read the Joel Spolsky Unicode article, as well as the Python Unicode HOWTO to more fully appreciate the difference between Unicode and encodings
p10680
as(dp10681
g16
V100297
p10682
stp10683
a((dp10684
g2
(lp10685
VYou are using  patterns, which mean "Matches whatever text was matched by the earlier group named name"
p10686
aVBut you don't have such a groups like  defined before
p10687
aVRemove the  to make them actual named groups:
p10688
aVThis is probably what you meant to do in the first place
p10689
aV:-)
p10690
as(dp10691
g16
V100297
p10692
stp10693
a((dp10694
g2
(lp10695
VYour  is actually an instance of
p10696
aVI'm not certain why you are creating these as you only use one (the second site in your list of sites), discarding the rest of the list
p10697
aVThat aside, you need to extract the  url when creating the :
p10698
as(dp10699
g16
V100297
p10700
stp10701
a((dp10702
g2
(lp10703
VThe simplest you can do is use two character classes, the latter with a  multiplier:
p10704
aValready includes
p10705
aVThere is no need to put groups around these, but you do want to anchor the expression to the start and end ( and ) to ensure you are validating the whole string, not just a portion of it
p10706
as(dp10707
g16
V100297
p10708
stp10709
a((dp10710
g2
(lp10711
VUse a generator:
p10712
aVThis'll work fine for a length divisible by 4, you may miss up to 3 values for other lengths
p10713
as(dp10714
g16
V100297
p10715
stp10716
a((dp10717
g2
(lp10718
VAll elements have a  mapping attribute; use it to detect your namespace and branch accordingly
p10719
as(dp10720
g16
V100297
p10721
stp10722
a((dp10723
g2
(lp10724
VThe  statement binds the return value of a context manager  method to the variable
p10725
aVIn your case that means  is bound to  (your  doesn't have a return statement at all, so  is the default), an  is raised and the  method is called
p10726
aVThe solution is to return  from the  method:
p10727
as(dp10728
g16
V100297
p10729
stp10730
a((dp10731
g2
(lp10732
VThe commit you link to wasn't merged with the tweepy master branch until August 19th, which was after the 1
p10733
aV11 release was cut (on August 14th)
p10734
aVYou'll need to install directly from git to get this feature
p10735
aVTo install the current development version, using pip, use:
p10736
aVOnce you've run that command, the  method is available:
p10737
aVI didn't bother to log in; the above demonstration does show it works, though
p10738
aV:-)
p10739
as(dp10740
g16
V100297
p10741
stp10742
a((dp10743
g2
(lp10744
VYou can't, not easily
p10745
aVYou'd have to loop through all keys to check for those that match:
p10746
aVIf you need to do this a lot in your application, you'd be better off creating indices; dictionaries or similar that map the second value in all your keys to specific keys
p10747
as(dp10748
g16
V100297
p10749
stp10750
a((dp10751
g2
(lp10752
VAs you only make one connection to your server, you only need to call  once, to accept that connection
p10753
aVOnce open, the socket will receive the periodic packets you send from your client
p10754
as(dp10755
g16
V100297
p10756
stp10757
a((dp10758
g2
(lp10759
VWith just a list and no other indices, you have to use a list comprehension:
p10760
aVbut if you have to do that a lot, you may want to create an index:
p10761
aVThis way you only have to loop through all your people once (cost O(N)), after which any name lookup has constant cost (O(1))
p10762
as(dp10763
g16
V100297
p10764
stp10765
a((dp10766
g2
(lp10767
VYour indentation could be incorrect, most likely caused by tabs
p10768
aVRun  to check
p10769
aVThere is otherwise no syntax error in your code that would cause this specific exception, not in the code you've given us
p10770
as(dp10771
g16
V100297
p10772
stp10773
a((dp10774
g2
(lp10775
VSure you can, with a small startup script
p10776
aVFrom Interactive Input Editing and History Substitution in the python tutorial:
p10777
aVFrom Python 3
p10778
aV4 onwards, the interactive interpreter supports autocompletion and history out of the box:
p10779
aVTab-completion is now enabled by default in the interactive interpreter on systems that support
p10780
aVHistory is also enabled by default, and is written to (and read from) the file
p10781
as(dp10782
g16
V100297
p10783
stp10784
a((dp10785
g2
(lp10786
VYou'll need to convert your tuples to strings first:
p10787
aVOf course, you'll end up with strings instead of tuples for keys:
p10788
as(dp10789
g16
V100297
p10790
stp10791
a((dp10792
g2
(lp10793
VIn all the example cases you give the packages do follow the PEP-8 naming convention:
p10794
aVSphinx's top-level package is called
p10795
aVPygments' top-level package is called
p10796
aVDjango's top-level package is called
p10797
aVFabric's top-level package is called
p10798
aVWhat you see using capitals is the distribution package, not the python package in the PEP-8 sense
p10799
aVNaturally, these projects have chosen to capitalize their project names and the distribution package reflects that project name
p10800
aVPython distribution packages do not need to be named the same as the python package that they contain
p10801
aVThis is by design; you can put multiple packages into a distribution, for example, and thus the contents should not dictate the distribution name
p10802
as(dp10803
g16
V100297
p10804
stp10805
a((dp10806
g2
(lp10807
VThe following raises the execption:
p10808
aVbecause the  variable is being used in the enclosed scope of :
p10809
aVPython detects that  is being referenced in  but does not assign anything to that variable, so it looks it up in the surrounding scope of
p10810
aVIt is assigned there, making the  statement a syntax error
p10811
aVThis limitation was removed in Python 3
p10812
aV2; you are now responsible for not deleting nested variables yourself; you'll get a runtime error () instead:
p10813
as(dp10814
g16
V100297
p10815
stp10816
a((dp10817
g2
(lp10818
VI've found that using Lucas numbers gives me results fastests:
p10819
aVLike matrix exponention, it has O(NlogN) complexity, but it's constant cost is lower, thus beating it 'on points':
p10820
aVYes, that's twice as fast
p10821
aVI can't take credit for the above implementation, nor of the matrix exponention algorithm I compared it with; both were listed on literateprograms
p10822
aVorg
p10823
aVTo calculate the 1,000,000th Fibonacci number takes:
p10824
aVjust under a 10th of a second
p10825
as(dp10826
g16
V100297
p10827
stp10828
a((dp10829
g2
(lp10830
VEach  element has child-elements, including a  element
p10831
aVYour code, however, is looking for attributes instead
p10832
aVTo get text out of a minidom element, you need a helper function:
p10833
aVAnd then you can more easily print all the titles:
p10834
as(dp10835
g16
V100297
p10836
stp10837
a((dp10838
g2
(lp10839
VTo detect  but not match  you need a negative lookahead assertion:
p10840
aVmatches the word boundary; the place where a word ends, perhaps because of whitespace after it, or the end of the line
p10841
aVThe  negative lookahead assertion checks that the next word is not all uppercase, before allowing a match on a mixed-case word
p10842
aVNote that I've included the  underscore as well in the matching character class
p10843
aVYou may want to include digits in your macro names, they are legal, after all:
p10844
aVThe second character class can then be simplified to , which is the same as
p10845
as(dp10846
g16
V100297
p10847
stp10848
a((dp10849
g2
(lp10850
VThe methods are exactly the same; the mixed-case versions (, , , etc
p10851
aVhave all been renamed to conform to the Python style guide, but the old names are still available to make porting easier
p10852
aVSee Method Names for a full list
p10853
aVIn new code, you should use the lowercase versions, so , etc
p10854
as(dp10855
g16
V100297
p10856
stp10857
a((dp10858
g2
(lp10859
VThe value you are trying to pack into the 4 bytes you've assigned for them is too large:
p10860
aVNewer python versions (>= 2
p10861
aV6) also give you a warning about the values that are accepted:
p10862
aVWhat python is telling you is that it had to mask the value to fit into 4 bytes; you can do this yourself with
p10863
aVThe warning is issued only once during a python program execution
p10864
aVNote that as of 2
p10865
aV6 the  value is always a signed 4-byte value, and you should always use a mask to pack these
p10866
aVThis has not always been consistent before 2
p10867
aV6, and depended on the platform
p10868
aVSee the documentation for details
p10869
as(dp10870
g16
V100297
p10871
stp10872
a((dp10873
g2
(lp10874
VYour Sublime Text 2 environment is different from your shell environment; the  variable is probably not pointing to the same directories and the wrong executable is selected
p10875
aVYou have several options to work around that:
p10876
aVSet a  option that includes   need to use an absolute path for your  executable, as Sublime Text 2 doesn't share the same environment PATH variable your shell uses
p10877
aVInspect  and use that as a template:
p10878
aVThat'll use  to run the command, which I think would have the same  setting as your terminal
p10879
aVRun the command through the shell instead by setting the  option:
p10880
aVUse the full path for the python command:
p10881
as(dp10882
g16
V100297
p10883
stp10884
a((dp10885
g2
(lp10886
VThere is a difference between your two queries:
p10887
aVFirst:
p10888
aVDjango code:
p10889
aVOne has a , the other a
p10890
aVPerhaps that's the root of your problem
p10891
as(dp10892
g16
V100297
p10893
stp10894
a((dp10895
g2
(lp10896
VYou need to invoke the  method itself, explicitly:
p10897
aVThis applies to any hook that needs to call the overridden method on the superclass
p10898
aVreturns a proxy object, with a  method that searches the super-class hierarchy for the attribute you are searching for
p10899
aVThis proxy itself is not callable; it has no  method of it's own
p10900
aVOnly when you explicitly look up the  method as an attribute of that proxy can python find the right implementation for you
p10901
as(dp10902
g16
V100297
p10903
stp10904
a((dp10905
g2
(lp10906
VThat's a list with one dictionary:
p10907
aVFrom the feedparser documentation:
p10908
aVA list of dictionaries with details about the full content of the entry
p10909
aVAtom feeds may contain multiple content elements
p10910
aVClients should render as many of them as possible, based on the type and the client\u2019s abilities
p10911
aVSo, you can easily have more dictionaries in that list, or 0
p10912
as(dp10913
g16
V100297
p10914
stp10915
a((dp10916
g2
(lp10917
VNo, the  method was not introduced until python 2
p10918
ag5279
aVYou should use the old-style  string formatting instead:
p10919
as(dp10920
g16
V100297
p10921
stp10922
a((dp10923
g2
(lp10924
VYou are using a regular expression, and matching XML with such expressions get too complicated, too fast
p10925
aVUse a HTML parser instead, Python has several to choose from:
p10926
aVElementTree is part of the standard library
p10927
aVBeautifulSoup is a popular 3rd party library
p10928
aVlxml is a fast and feature-rich C-based library
p10929
aVElementTree example:
p10930
as(dp10931
g16
V100297
p10932
stp10933
a((dp10934
g2
(lp10935
VYou cannot subtract character classes, no
p10936
aVYour best bet is to use the new  module, set to replace the current  module in python
p10937
aVIt supports character classes based on Unicode properties:
p10938
aVThis will match any character that the Unicode specification states is an alphabetic character
p10939
aVEven better,  does support character class subtraction; it views such classes as sets and allows you to create a difference with the  operator:
p10940
aVmatches everything in  except anything that also matches
p10941
as(dp10942
g16
V100297
p10943
stp10944
a((dp10945
g2
(lp10946
VYou do not need to decode XML for ElementTree to work
p10947
aVXML carries it's own encoding information (defaulting to UTF-8) and ElementTree does the work for you, outputting unicode:
p10948
aVIf your data is contained in a file(like) object, just pass the filename or file object directly to the parse function:
p10949
as(dp10950
g16
V100297
p10951
stp10952
a((dp10953
g2
(lp10954
VJust check the last-modified time of your cache file instead
p10955
aVEven better, that's what you really want to check in any case, because when you update your cache to store the new computed value, you want to know when that was done last, not when that was done the first time
p10956
aV:-)
p10957
as(dp10958
g16
V100297
p10959
stp10960
a((dp10961
g2
(lp10962
VUse  to split off the extension:
p10963
as(dp10964
g16
V100297
p10965
stp10966
a((dp10967
g2
(lp10968
VPython 2 supports both, in python 3 the  operator has been removed
p10969
aVThere is no difference between the two, but  is the preferred form
p10970
as(dp10971
g16
V100297
p10972
stp10973
a((dp10974
g2
(lp10975
VYou need to turn the iterable into a list to get the length:
p10976
aVNote that this consumes the iterable, so you may not be able to iterate over it again
p10977
aVStore the  result in an intermediary before calling  on it to be able to reuse all the elements in the list still:
p10978
as(dp10979
g16
V100297
p10980
stp10981
a((dp10982
g2
(lp10983
VThat's dead code; it's a local variable, so it is not ever going to influence anything else
p10984
aVIf it had been a instance variable, then  could have read the value while executing, but it's completely superfluous here
p10985
aVThe  module is relatively ancient, the line has been there since it was first committed to the python codebase in 1999
p10986
as(dp10987
g16
V100297
p10988
stp10989
a((dp10990
g2
(lp10991
VSure you can do that with SQLAlchemy
p10992
aVAll you need to do is create different connection engines, each with their own session maker
p10993
aVNothing in SQLAlchemy limits you to only one database at a time
p10994
aVYou can use each session to run queries, result objects are attached to the session that produced them, so that changes flow back to the correct database
p10995
aVDo study the session documentation in detail, to see what happens if you were to merge an object from one session into another, for example
p10996
as(dp10997
g16
V100297
p10998
stp10999
a((dp11000
g2
(lp11001
VJust call the method directly, methods on base classes are available on your instance during initialisation:
p11002
aVYou probably want to call the base-class  method as well though:
p11003
aVWe need to call the  directly because  is an old-style python class; in a new-style python class we'd use  instead, where the  function provides a proxy object that searches the base class hierarchy to find the next matching method you want to call
p11004
as(dp11005
g16
V100297
p11006
stp11007
a((dp11008
g2
(lp11009
VYou declare the name  but try to access it as  instead (note the missing  there)
p11010
aVEither use  or remove the  part from the  registration
p11011
aVIf that was just a typo, check that the ZCML file is actually being loaded; the registration itself is fine if the names match
p11012
as(dp11013
g16
V100297
p11014
stp11015
a((dp11016
g2
(lp11017
VThe  class uses HTTP/1
p11018
aV1 throughout, and the 505 seems to indicate it's the server that cannot handle HTTP/1
p11019
aV1 requests
p11020
aVHowever, if you need to make  requests, why not use the Requests package instead
p11021
aVA  is as simple as:
p11022
aVThat won't magically solve your HTTP version mismatch, but you can enable verbose logging to figure out what is going on:
p11023
as(dp11024
g16
V100297
p11025
stp11026
a((dp11027
g2
(lp11028
VYou are using a regular expression, but matching XML with such expressions gets too complicated, too fast
p11029
aVUse a HTML parser instead, Python has several to choose from:
p11030
aVElementTree is part of the standard library
p11031
aVBeautifulSoup is a popular 3rd party library
p11032
aVlxml is a fast and feature-rich C-based library
p11033
aVElementTree example:
p11034
as(dp11035
g16
V100297
p11036
stp11037
a((dp11038
g2
(lp11039
VYou are importing it from the wrong location, you need to import from  instead:
p11040
aVSee the Formsets documentation
p11041
as(dp11042
g16
V100297
p11043
stp11044
a((dp11045
g2
(lp11046
V does not send JSON
p11047
aVIn pyramid, simply access the form variables like you would with a normal POST request:
p11048
aVetc
p11049
as(dp11050
g16
V100297
p11051
stp11052
a((dp11053
g2
(lp11054
VYou can easily 'create' an inverted heap by multiplying the priorities of your items by -1
p11055
aVSo your  simply needs to be told how to 'invert' the priorities, decorating each value as needed:
p11056
aVNote that we use a  tuple to keep the heap inverted
p11057
aVFor non-numericals, you'd have to simply provide a inversion function that turns the priorities upside down, it only needs to be a simple key, not something that is readable or anything:
p11058
as(dp11059
g16
V100297
p11060
stp11061
a((dp11062
g2
(lp11063
VYou encountered an empty line:
p11064
aVSimply test for this with :
p11065
aVNote that I loop over the file directly instead of reading it all into memory in one go as well
p11066
as(dp11067
g16
V100297
p11068
stp11069
a((dp11070
g2
(lp11071
VYou are getting confused between local time (as returned by  and GMT (as parsed by ):
p11072
aVConclusion: use  instead of  to turn your values to timestamps
p11073
as(dp11074
g16
V100297
p11075
stp11076
a((dp11077
g2
(lp11078
VYou are reading that wrong I'm afraid; it's:
p11079
aVso, divide floating point value  (with the zero omitted) by the  of
p11080
as(dp11081
g16
V100297
p11082
stp11083
a((dp11084
g2
(lp11085
VLook the module up in :
p11086
aVDemo:
p11087
as(dp11088
g16
V100297
p11089
stp11090
a((dp11091
g2
(lp11092
V is a function, you need to pass in the  class to call it:
p11093
aVSQLAlchemy cannot divine from the filter alone what type of object you want returned otherwise
p11094
as(dp11095
g16
V100297
p11096
stp11097
a((dp11098
g2
(lp11099
VYou'll need to turn your dictionary into a series of keys and values:
p11100
aVThis'll pass a list of  to the  method, where keys and values are paired but in arbitrary order
p11101
aVIf you don't have an  module available,  can be defined as:
p11102
as(dp11103
g16
V100297
p11104
stp11105
a((dp11106
g2
(lp11107
VIf you can reproduce this reliably, you can put in a print statement or  in the ZODB connection  method (in  inside the  egg):
p11108
aVNow whenever any object has been marked as changed or is added to the connection as a new object, it'll be printed to the console
p11109
aVThat should help you with the debugging process
p11110
aVGood luck
p11111
as(dp11112
g16
V100297
p11113
stp11114
a((dp11115
g2
(lp11116
VI suspect you need to commit your transaction too:
p11117
as(dp11118
g16
V100297
p11119
stp11120
a((dp11121
g2
(lp11122
VNot 100% sure, but I think SQLAlchemy is trying to intepret the  character as a SQL parameter
p11123
aVI'd try doubling the  character to work around this:
p11124
aVThis depends on what database you are using; different database adapters use different parameter styles
p11125
aVThe psycopg2 module, used for PostgreSQL database connections, for example uses the  style and documents that  is the correct way to insert a  literal value into your SQL statements
p11126
as(dp11127
g16
V100297
p11128
stp11129
a((dp11130
g2
(lp11131
VMake sure you have an instance of your  class to call the method on:
p11132
aVis only provided when the method has been bound to an instance
p11133
aVIf you call the method directly on the class, you'll get an exception:
p11134
as(dp11135
g16
V100297
p11136
stp11137
a((dp11138
g2
(lp11139
VJust pass it into the constructor, like you would do for any other python class
p11140
aV:-)
p11141
as(dp11142
g16
V100297
p11143
stp11144
a((dp11145
g2
(lp11146
VUse the  class method to parse these:
p11147
aVYour example does not include a timezone however
p11148
aVIf you really do need timezone support, best resort to the  module:
p11149
as(dp11150
g16
V100297
p11151
stp11152
a((dp11153
g2
(lp11154
VYes, the seed is set for the (hidden) global  instance in the module
p11155
aVFrom the documentation:
p11156
aVThe functions supplied by this module are actually bound methods of a hidden instance of the  class
p11157
aVYou can instantiate your own instances of to get generators that don\u2019t share state
p11158
aVUse separate  instances if you need to keep the seeds separate; you can pass in a new seed when you instantiate it:
p11159
aVThe class supports the same interface as the module
p11160
as(dp11161
g16
V100297
p11162
stp11163
a((dp11164
g2
(lp11165
V is an interactive shell built with python
p11166
aVFrom the project website:
p11167
aVIPython provides a rich toolkit to help you make the most out of using Python, with:
p11168
aVPowerful Python shells (terminal and Qt-based)
p11169
aVA web-based notebook with the same core features but support for code, text, mathematical expressions, inline plots and other rich media
p11170
aVSupport for interactive data visualization and use of GUI toolkits
p11171
aVFlexible, embeddable interpreters to load into your own projects
p11172
aVEasy to use, high performance tools for parallel computing
p11173
aVNote that the first 2 lines tell you it helps you make the most of using Python
p11174
aVThus, you don't need to alter your code, the IPython shell runs your python code just like the normal python shell does, only with more features
p11175
aVI recommend reading the IPython tutorial to get a sense of what features you gain when using IPython
p11176
as(dp11177
g16
V100297
p11178
stp11179
a((dp11180
g2
(lp11181
VTake a look at colander; it makes turning a JSON data structure into Python objects dead easy
p11182
aVYou define a schema:
p11183
aVthen pass in your JSON data structure:
p11184
as(dp11185
g16
V100297
p11186
stp11187
a((dp11188
g2
(lp11189
VRSS items usually have a GUID or a link associated with them
p11190
aVUse the GUID if present, otherwise the link to uniquely identify each item
p11191
aVYou'll still have to keep track of which ones you've seen before, as the RSS format doesn't tell you what changed since last time
p11192
aVThere really is no other way, I'm afraid
p11193
aVTo save (a unicode object) in UTF-8, simply encode it when writing to the file:
p11194
aVPlease do read the Joel Spolsky article on Unicode and the Python Unicode HOWTO, to fully understand what encoding and decoding means
p11195
as(dp11196
g16
V100297
p11197
stp11198
a((dp11199
g2
(lp11200
VYou are trying to opening files without specifying an encoding, which means that python uses the default value (ASCII)
p11201
aVYou need to decode the byte-string explicitly, using the  function:
p11202
aVYour  variable you tried to interpolate into your template is itself a unicode value, and python wants to automatically convert your byte-string template (read from the file) into a unicode value too, so that it can combine both, and it'll use the default encoding to do so
p11203
aVDid I mention already you should read Joel Spolsky's article on Unicode and the Python Unicode HOWTO
p11204
aVThey'll help you understand what happened here
p11205
as(dp11206
g16
V100297
p11207
stp11208
a((dp11209
g2
(lp11210
VThe  path separator is also a python escape character
p11211
aVDouble them, or better yet, use  raw python literals instead:
p11212
aVFor example,  is a newline character, and  is interpreted as a TAB
p11213
aVIn your specific case,  is interpreted as a backspace
p11214
as(dp11215
g16
V100297
p11216
stp11217
a((dp11218
g2
(lp11219
VThe  encoding indeed does not provide escapes for values below 0xFF; these values are not normally escaped in a raw python unicode literal
p11220
aVUse the  encoding instead:
p11221
as(dp11222
g16
V100297
p11223
stp11224
a((dp11225
g2
(lp11226
VPEP 8 kinda predates list comprehensions
p11227
aVI usually break these up over multiple lines at logical locations:
p11228
aVMostly though, I'd forgo the involved test there in the first place:
p11229
as(dp11230
g16
V100297
p11231
stp11232
a((dp11233
g2
(lp11234
VThe correct spelling is , not ; this does require that you use , not :
p11235
aVI can recommend the Hitchhiker's Guide to Packaging for the nitty gritty details
p11236
as(dp11237
g16
V100297
p11238
stp11239
a((dp11240
g2
(lp11241
VThe best format for transferring datetime values is the ISO 8601 standard; they come in the format , where the  is optional
p11242
aVPython's  class can parse these with a simple extra module (see How to parse ISO formatted date in python
p11243
aVOutput is just as easy with the  method
p11244
aVMySQL's DATETIME column type only deals with UTC values, but by default accepts ISO 8601 datetime strings (with a space instead of a ), so you'd have to cast your datetime objects to UTC (example with iso8601 module mentioned above):
p11245
aVI'd insert the timezone offset into the database too; simply use the  method to retrieve it from the  object, then parse it out again when loading from MySQL with the  function
p11246
aVI don't know how well Android deals with dates and times, but surely it can handle ISO 8601 formats just fine
p11247
as(dp11248
g16
V100297
p11249
stp11250
a((dp11251
g2
(lp11252
V doesn't return anything, it heapifies the list in place; it's far more efficient to do it that way:
p11253
aVIf you need a new list, create a copy fist:
p11254
aVThat defeats the purpose somewhat, of course, as copying the list has a (linear) cost too
p11255
aVIf all you need is the smallest item in a list, the  function will be just as fast when locating just the one smallest element (both  and  scan the input list once, so O(n) cost):
p11256
aVIf you need more than one smallest value, by all means use a , especially if you add items later on
p11257
aVIf you cannot alter the original list, need several smallest items, see looking for an inverted heap in python for an efficient  implementation that creates a new heap from an input heap with only a fixed number of smallest values
p11258
as(dp11259
g16
V100297
p11260
stp11261
a((dp11262
g2
(lp11263
VYou'll have to parse this format line by line, a regular expression won't go back in the text once a match has been found
p11264
aVYou expect the regular expression to find overlapping sections (line 0 + line 2, then line 0 + line 3, etc
p11265
aV, but the engine has already matched something at lines 0 - 2, so the next match  will search for starts after line 2
p11266
aVSplit the input by lines, detect the header lines and data lines, and parse each accordingly
p11267
aVThen group data lines with the most recently parsed header
p11268
as(dp11269
g16
V100297
p11270
stp11271
a((dp11272
g2
(lp11273
VNeither  does what you think it does
p11274
aVIn both cases  and  are class variables, not globals
p11275
aVBut when you declared  as a global and assigned to it, python happily created a global variable (separate from ) and stored your value
p11276
aVBut for  you are not assigning anything to it; you are trying to treat it as a dict instead, but you didn't create the variable by assignment so that fails
p11277
aVYou want to use  instead; as a class variable, it'll be available to all instances of
p11278
aVYou can also use
p11279
aVFor , you can use  to refer to it
p11280
aVThe  keywords can be dropped altogether
p11281
aVIn any case, declaring a variable as  does not mean outside of my current scope
p11282
aVIt means at module scope instead, so always outside of your functions, classes, and method definitions
p11283
as(dp11284
g16
V100297
p11285
stp11286
a((dp11287
g2
(lp11288
VIf you are using a recent enough python version (2
p11289
aV5 and up), you should switch to using a context manager instead:
p11290
aVThen:
p11291
aVThe  method can return True if an exception has been handled; returning None will instead re-raise any exceptions raised in the  block
p11292
aVIf not, you are looking for a  block instead:
p11293
aVThe  suite is guaranteed to be executed when the  suite completes, or an exception has occurred
p11294
aVBy setting  to  you basically tell the  suite everything completed just fine, no need to put it back
p11295
aVThe  handler takes over from your blanket  handler
p11296
aVIf there has been an exception in ,  will not be set to None
p11297
aVIf the  handler doesn't catch the exception, or  is not 123,  will also not be set to None, and thus the  method is executed
p11298
as(dp11299
g16
V100297
p11300
stp11301
a((dp11302
g2
(lp11303
VI think there is a misunderstanding about what constitutes a transaction here
p11304
aVYour example opens up one connection, then executes one transaction on it
p11305
aVYou execute multiple SQL statements in that transaction, but you close it completely after committing
p11306
aVOf course that's more than fine
p11307
aVExecuting multiple transactions (as opposed to just SQL statements), looks like this:
p11308
aVThe above code commits 10 transactions, each consisting of 10 individual delete statements
p11309
aVAnd yes, you should be able to re-use the open connection for that without problems, as long as you don't share that connection between threads
p11310
aVFor example, SQLAlchemy re-uses connections by pooling them, handing out open connections as needed to the application
p11311
aVNew transactions and new statements are executed on these connections throughout the lifetime of an application, without needing to be closed until the application is shut down
p11312
as(dp11313
g16
V100297
p11314
stp11315
a((dp11316
g2
(lp11317
VYour  is executable python
p11318
aVIt is run as a python script to discover your package distribution configuration
p11319
aVYour  runs this code:
p11320
aVThis imports your  package, so the  file in that package is loaded
p11321
aVRemove that call and your setup will succeed
p11322
aVStore the version somewhere else instead
p11323
aVNote that the trackback even tells you so explicitly:
p11324
aVBest practice is to store the version in the  file instead (some examples here and here)
p11325
aVThe Django project does use the  trick, but it's  only contains the version information, nothing else
p11326
as(dp11327
g16
V100297
p11328
stp11329
a((dp11330
g2
(lp11331
VUse the  method to merge one dict into another:
p11332
aVTo do so with your list, detect the 'source' dicts in a loop and merge those into the others:
p11333
aVNote that I start with an empty dict for the source, in case you don't encounter a dict with the  key on the first run through the loop
p11334
aVThe above loop leaves the original sources in the list
p11335
aVIf you need to remove these, your best bet is to create a new list with the updated dicts:
p11336
as(dp11337
g16
V100297
p11338
stp11339
a((dp11340
g2
(lp11341
VYou are specifying a python string literal, and their encoding is determined by the default settings of your editor (or in the case of the python interpreter, of your terminal)
p11342
aVPython did not have a say in this
p11343
aVBy default, python 2 tries to interpret source code as ASCII
p11344
aVIn python 3 this has been switched to UTF-8
p11345
aVPlease read the Python Unicode HOWTO to further understand the difference between Unicode and input and output encodings
p11346
aVYou really also should read Joel Spolksy's article on Unicode
p11347
as(dp11348
g16
V100297
p11349
stp11350
a((dp11351
g2
(lp11352
VYou need to include the  command itself when executing a perl script:
p11353
aVYou did the same thing on the command line prompt; the  class cannot guess from the  file that you wanted to run this script with Perl
p11354
aV:-)
p11355
as(dp11356
g16
V100297
p11357
stp11358
a((dp11359
g2
(lp11360
VBasically, if you specify a  parameter (a dictionary), then  will send a  POST instead of a  POST
p11361
aVYou are not limited to using actual files in that dictionary, however:
p11362
aVand httpbin
p11363
aVorg lets you know what headers you posted with; in  we have:
p11364
aVcan also be a list of two-value tuples, if you need ordering and/or multiple fields with the same name:
p11365
aVIf you specify both  and , then it depends on the value of  what will be used to create the POST body
p11366
aVIf  is a string, only it willl be used; otherwise both  and  are used, with the elements in  listed first
p11367
as(dp11368
g16
V100297
p11369
stp11370
a((dp11371
g2
(lp11372
VIf all you ever do is call the function with  instances, I'd not even bother with testing for the  method; it's an error to pass in anything else and the function should just break if someone passes in strings
p11373
aVIn other words, just document your function as expecting a  method, and not test at all
p11374
aVDuck typing is for code that needs to accept distinctly different types of input, not for code that only works for one specific type
p11375
as(dp11376
g16
V100297
p11377
stp11378
a((dp11379
g2
(lp11380
VStore the functions in a list (without calling them), then use :
p11381
as(dp11382
g16
V100297
p11383
stp11384
a((dp11385
g2
(lp11386
VIf you really need to use  you can reimplement that as a function:
p11387
aVBut you need to be aware of what  (and  and ) strip a set of characters from the front, not a prefix
p11388
aVFrom the (cpython) documentation:
p11389
aVReturn a copy of the string with leading characters removed
p11390
aVThe
p11391
aVargument is a string specifying the set of characters to be removed
p11392
aVIf omitted or , the  argument defaults to removing
p11393
aVwhitespace
p11394
aVThe chars argument is not a prefix; rather, all
p11395
aVcombinations of its values are stripped:
p11396
as(dp11397
g16
V100297
p11398
stp11399
a((dp11400
g2
(lp11401
VI suspect you are applying the decorator incorrectly
p11402
aVYou need to call it to specify the  parameter:
p11403
aVor to specify it explicitly:
p11404
aVYou have a different problem in your decorator as well; you refer to  in the code:
p11405
aVbut this is no instance, and there is no  parameter
p11406
aVI think you meant:
p11407
aV(where you can test for the variable to be non-zero by treating it as a boolean)
p11408
aVOh, and you may want to fix the spelling of the decorator; you probably meant  instead
p11409
aV:-)
p11410
as(dp11411
g16
V100297
p11412
stp11413
a((dp11414
g2
(lp11415
VPylons uses the WebOb project to supply the request and response objects, and it handles file uploads efficiently
p11416
aVFile upload handling internally is actually delegated to the python stdlib  module, which uses temporary files to handle uploads
p11417
aVUltimately, this is also due to the underlying WSGI standard, which specifies that the request input is a stream
p11418
as(dp11419
g16
V100297
p11420
stp11421
a((dp11422
g2
(lp11423
VMove the string formatting operand to the string itself:
p11424
aVYou were trying to apply it to the result of the  call, which is a file
p11425
as(dp11426
g16
V100297
p11427
stp11428
a((dp11429
g2
(lp11430
VYou have two options:
p11431
aVSwitch to using SQLAlchemy; it'll make generating dynamic SQL a lot more pythonic and ensures proper quoting
p11432
aVSince you cannot use parameters for table and column names, you'll still have to use string formatting to include these in the query
p11433
aVYour values on the other hand, should always be using SQL parameters, if only so the database can prepare the statement
p11434
aVIt's not advisable to just interpolate table and column names taken straight from user input, it's far too easy to inject arbitrary SQL statements that way
p11435
aVVerify the table and column names against a list of such names you accept instead
p11436
aVSo, to build on your example, I'd go in this direction:
p11437
as(dp11438
g16
V100297
p11439
stp11440
a((dp11441
g2
(lp11442
VYou can put multiple loops in a list comprehension by listing them in the same order as you would when using nested for loops
p11443
aVSomething like:
p11444
aVBut I find your algorithm rather hard to read as it is, so I am not even sure this will do what you want
p11445
as(dp11446
g16
V100297
p11447
stp11448
a((dp11449
g2
(lp11450
VYou'd need to do two things: declare  as an attribute or property, and return a dict-like object that allows attribute access for dictionary keys
p11451
aVThe following would work:
p11452
aVShort demo:
p11453
aVThe  decorator turns methods into attributes, and the  hook allows the  class to look up dict keys via attribute access (the  operator)
p11454
as(dp11455
g16
V100297
p11456
stp11457
a((dp11458
g2
(lp11459
VYou are looking for the  method instead:
p11460
aVReturn the "current working directory" for this SFTP session, as emulated by paramiko
p11461
aVIf no directory has been set with , this method will return
p11462
aVSo at the start of your session, if you need the current working dir, try a  (change to current directory) first
p11463
aVThe  method only returns names of items in the directory
p11464
aVIf you need more information about those files, you'd need to use the  method instead, it returns a list of  instances
p11465
aVAn  instance tells you what mode the file has, through the  attribute
p11466
aVUse the  function to test if the file is a directory
p11467
as(dp11468
g16
V100297
p11469
stp11470
a((dp11471
g2
(lp11472
VIf I understand you correctly, you are looking for the  module, which implements an efficient algorithm for finding the point where a value in a sorted list is larger or smaller than a given value
p11473
aVYour log entries need to be a class that implements some form of ordering though
p11474
aVSomething like this:
p11475
aVThese  classes are orderable (with the help of the  class decorator), and thus the  module knows what entries have a 'lower' value than other values
p11476
aVYour function then becomes:
p11477
aVNote that we don't need to declare  global as you are not assigning to it
p11478
as(dp11479
g16
V100297
p11480
stp11481
a((dp11482
g2
(lp11483
VYou are looking for , together with various  module functions
p11484
aVSimply split the path by that character, then re-assemble the parts you want to use
p11485
aVSomething like:
p11486
aVThis does not deal very well with Windows paths, where both  and  are legal path separators
p11487
aVIn that case you also have a drive letter, so you'd have to special-case that as well anyway
p11488
aVOutput:
p11489
as(dp11490
g16
V100297
p11491
stp11492
a((dp11493
g2
(lp11494
VYou can easily construct a string with an integer in it:
p11495
aVDo that in a loop:
p11496
aVand Bob's your uncle
p11497
as(dp11498
g16
V100297
p11499
stp11500
a((dp11501
g2
(lp11502
VThe python pyTTS module simply uses the Microsoft SAPI COM objects, and if these are no longer registered the module fails in the manner you see
p11503
aVRe-installing the Microsoft Speech SDK should fix this for you
p11504
as(dp11505
g16
V100297
p11506
stp11507
a((dp11508
g2
(lp11509
VThe JSON  function expects Unicode data, not raw bytes
p11510
aVPython automatically tries to decode the byte string to a Unicode string for you using a default codec (in your case ASCII), and fails
p11511
aVBy opening the file with the  codec, Python makes an explicit conversion for you
p11512
aVSee the  function, which states:
p11513
aVIn text mode, if encoding is not specified the encoding used is platform dependent
p11514
aVThe encoding that would be used is determined as follows:
p11515
aVTry  to see if there is a terminal encoding
p11516
aVUse  function, which depends on the environment you run your code in
p11517
aVThe  of that function is set to
p11518
aVUse  as a default if both methods have returned
p11519
aVThis is all done in C, but it's python equivalent would be:
p11520
aVSo when you run your program in a terminal,  returns , but when running under IntelliJ there is no terminal, and if no locale is set either, python uses
p11521
aVThe Python Unicode HOWTO tells you all about the difference between unicode strings and bytestrings, as well as encodings
p11522
aVAnother essential article on the subject is Joel Spolsky's Absolute Minimum Unicode knowledge article
p11523
as(dp11524
g16
V100297
p11525
stp11526
a((dp11527
g2
(lp11528
VYou are using tabs for indentation, and I think you have an indentation error
p11529
aVUse  to detect
p11530
as(dp11531
g16
V100297
p11532
stp11533
a((dp11534
g2
(lp11535
V already returns a list, but you put it into a new list:
p11536
aVThis results in a list containing a list, and  later on is set to the full range
p11537
aVJust remove the brackets there
p11538
as(dp11539
g16
V100297
p11540
stp11541
a((dp11542
g2
(lp11543
VYou need to create a JSONP callback construct, where the JSON return value is passed to a callback function named in the  request paramater
p11544
aVThe Django Snippets site has a handy decorator for JSONP that takes care of this for you, and verifies that the user is authenticated as well
p11545
aVIf you don't want to use that decorator, at the very least use the  request parameter in your response, and set the correct content type:
p11546
as(dp11547
g16
V100297
p11548
stp11549
a((dp11550
g2
(lp11551
VUnder the API covers, Couchdbkit uses the  package, which is a REST library
p11552
aVIn other words, Couchdbkit is a pythonic API to the CouchDB REST API, and will do the same amount of work as using the REST API yourself
p11553
as(dp11554
g16
V100297
p11555
stp11556
a((dp11557
g2
(lp11558
VThe  package uses the  command-line tool to do the work
p11559
aVHowever, the  package on Debian does not include that tool:
p11560
aVThis package does not include pdf2swf and avi2swf
p11561
aVI suspect the binary violates Debian Free Software guidelines somehow
p11562
aVI have not been able to locate a Debian package that does include the binary
p11563
aVYou can install the package from source instead
p11564
as(dp11565
g16
V100297
p11566
stp11567
a((dp11568
g2
(lp11569
VUnder the hood, pyramid turns the  part of the  method into a Pyramid route predicate of the form  (where  can contain slashes itself)
p11570
aVA dedicated static asset view is attached to that route predicate
p11571
aVIn your configuration that means there would be both  and  route predicates, in that order
p11572
aVWhen you then request a URL with the path  Pyramid finds the  predicate first, and tries to look up the  path element in the  folder, which fails
p11573
aVLucky for you, you can reverse the order of the registrations, simply register the  path first:
p11574
aVNow the  predicate is registered first, and will match any  URLs before the other predicate is tested
p11575
as(dp11576
g16
V100297
p11577
stp11578
a((dp11579
g2
(lp11580
V is not overkill by any means
p11581
aVIt can generate your list of files and directories in a jiffy:
p11582
aVYou can turn this into a generator, to only process one path at a time and safe on memory
p11583
as(dp11584
g16
V100297
p11585
stp11586
a((dp11587
g2
(lp11588
VThe  command only switches what  points to, and does not touch the  path at all
p11589
aVThe  executable is still the default Apple install
p11590
aVYour  variable may still look in  before  though when you type in  at your Terminal prompt
p11591
as(dp11592
g16
V100297
p11593
stp11594
a((dp11595
g2
(lp11596
V is still in use in Plone 4
p11597
ag5740
aVAttempts have been made to modernize it, but nothing as yet has replaced it
p11598
as(dp11599
g16
V100297
p11600
stp11601
a((dp11602
g2
(lp11603
VYou are deserializing a cstruct, and it contains a  instance
p11604
aVColander expects only simple types such as , , , etc
p11605
aVIf you make your datetime value a ISO-formatted string, things work just fine:
p11606
aVNote that  does not include timezone information, nor would  preserve that
p11607
aVColander, on the other hand, parses the ISO 8601 string as a timestamp in the UTC timezone, so you want to generate your timestamp in the same timezone by using the  class method instead:
p11608
aVSo, replace
p11609
aVwith
p11610
aVand colander will happily parse that for you, using the correct timezone
p11611
as(dp11612
g16
V100297
p11613
stp11614
a((dp11615
g2
(lp11616
VThe nested function looks up variables from the parent scope when executed, not when defined
p11617
aVThe function body is compiled, and the 'free' variables (not defined in the function itself by assignment), are verified, then bound as closure cells to the function, with the code using an index to reference each cell
p11618
aVthus has one free variable () which is then referenced via a closure cell, index 0
p11619
aVThe closure itself points to the local variable  in the  function
p11620
aVWhen you actually call the function, that closure is then used to look at the value of  in the surrounding scope at the time you call the function
p11621
aVHere lies the problem
p11622
aVBy the time you call your functions, the  function is already done computing it's results
p11623
aVThe  local variable at some point during that execution was assigned each of the , , and  strings, but at the end of the function,  contains that last value
p11624
aVThus, when you call each of the dynamically returned functions, you get the value  printed
p11625
aVThe work-around is to not rely on closures
p11626
aVYou can use a partial function instead, create a new function scope, or bind the variable as a default value for a keyword parameter
p11627
aVPartial function example, using :
p11628
aVCreating a new scope example:
p11629
aVBinding the variable as a default value for a keyword parameter:
p11630
aVThere is no need to define the  or  function in the loop, compilation only takes place once, not on each iteration of the loop
p11631
as(dp11632
g16
V100297
p11633
stp11634
a((dp11635
g2
(lp11636
VYour use of  throws the error, as it will only accept strings that can be interpreted as numbers
p11637
aVYou could catch the exception instead of checking each character in the input:
p11638
aVThe above snippet replaces your old  line, which has been indented 4 more spaces to match the new / block I inserted
p11639
aVThe full code ends up like this:
p11640
as(dp11641
g16
V100297
p11642
stp11643
a((dp11644
g2
(lp11645
VSure you can:
p11646
aVNote the binary mode flag there (), since you are copying over  contents, you don't want python to reinterpret newlines for you
p11647
aVThat'll take a lot of memory if  is large
p11648
aVTake a look at the  function for a more memory-efficient option:
p11649
as(dp11650
g16
V100297
p11651
stp11652
a((dp11653
g2
(lp11654
VThe  test is used as a differentiator
p11655
aVWhen the view is called with , the form is rendered
p11656
aVThe form specifies that it needs to be submitted with using , so the code assumes that a  request signals the form is submitted
p11657
aVThe  attribute triggers the actual database query
p11658
aVBy adding the  call you specify a more specific database query, one where the  attribute contains the value of
p11659
aVThe result is a set of database results that match that query
p11660
aVthe  dictionary values are themselves views, and for these to work, you call them with the  parameter
p11661
aVJust like the  view callable itself
p11662
as(dp11663
g16
V100297
p11664
stp11665
a((dp11666
g2
(lp11667
VYou could use the  module for such merges, merging the second python list into the first
p11668
aVThe  functions work for numpy arrays but the  functions don't
p11669
aVIt's easy enough to use the module source code to adapt the algorithm, it's quite basic:
p11670
aVNot that the custom  is really adding anything here, the default  works just fine too:
p11671
aVUsing this adapted  is much more efficient than a combine and sort
p11672
aVBecause  is sorted as well, we can track the  insertion point and search for the next point starting there instead of considering the whole array each loop
p11673
aVIf you don't need to preserve , just operate directly on that array and save yourself the copy
p11674
aVMore efficient still: because both lists are sorted, we can use :
p11675
as(dp11676
g16
V100297
p11677
stp11678
a((dp11679
g2
(lp11680
VUse
p11681
aVremoves the last component for you if all you need is the path:
p11682
as(dp11683
g16
V100297
p11684
stp11685
a((dp11686
g2
(lp11687
VLook at the lines before it, there will be a parenthesis or bracket missing
p11688
aVThat, or you have a python version that doesn't support  at all, the syntax wasn't introduced until python 2
p11689
ag5279
as(dp11690
g16
V100297
p11691
stp11692
a((dp11693
g2
(lp11694
VYour browser is interpreting the  value as , the section character: 
p11695
aVYou need to escape the ampersand as  to prevent this:
p11696
aVDjango templates can do this escaping for you by using the escape filter, or you can use the  function:
p11697
as(dp11698
g16
V100297
p11699
stp11700
a((dp11701
g2
(lp11702
VUse the  function:
p11703
aVNow you have a  object, and it has ,  and  attributes:
p11704
as(dp11705
g16
V100297
p11706
stp11707
a((dp11708
g2
(lp11709
VThe value of  is too large for either  or
p11710
aVIn other words, the current value of  is not a valid index into one of those structures
p11711
aVNote that  can be anything between 0 and
p11712
aVYou could try and print out the  values first, most likely they do not contain what you expect them to contain
p11713
as(dp11714
g16
V100297
p11715
stp11716
a((dp11717
g2
(lp11718
VThe performance impact of a function definition is negligible and comparable to defining a local variable
p11719
aVThe body of the function is compiled only once, all that you end up with during execution of the code-block is loading the compiled block (), and the result of the  byte code is then stored in a local variable:
p11720
aVNow, if you call that function containing nested functions thousands of times, you do notice a performance impact for that  operation:
p11721
aVDo note that that difference will get smaller the more actual code you put into your functions though
p11722
aVThe above examples are very contrived and focus solely on the impact of  byte code on execution times
p11723
aVBetter optimize for readability and maintainability first
p11724
as(dp11725
g16
V100297
p11726
stp11727
a((dp11728
g2
(lp11729
VType  to list help:
p11730
aV-U, --upgrade         Upgrade all packages to the newest available version
p11731
aVSo, if you already have a package installed, it will upgrade the package for you
p11732
aVWithout the -U switch it'll tell you the package is already installed and exit
p11733
aVEach  subcommand has it's own help listing
p11734
aVshows you overall help, and  gives you help for that sub command, such as
p11735
as(dp11736
g16
V100297
p11737
stp11738
a((dp11739
g2
(lp11740
VThe  syntax defines a keyword argument, with a default value
p11741
aVUsing that argument is now optional, if you do not specify it, the default value is used instead
p11742
aVIn your example, that means  is set to
p11743
aVInstances are referred to, within a method, with the  parameter
p11744
aVThe  and  values are stored on  as attributes ( and ) and can later be retrieved by referring to that named attribute (, )
p11745
aVI can heartily recommend you follow the Python tutorial, it'll explain all this and more
p11746
as(dp11747
g16
V100297
p11748
stp11749
a((dp11750
g2
(lp11751
VYou'd be much better off using the  function, then subtract the two results:
p11752
aVNote that  gives you just the remainder in seconds, there is also a  attribute
p11753
aVUse  instead, it's much more convenient and saves you having to take the  value into account
p11754
aVUsing the  method, plus  methods, is keeping the majority of the work in C code and should be faster
p11755
aVNote that neither method is very fast because of the parsing step
p11756
aVTime tests:
p11757
aVwhere the second method just uses the  function (which outputs a timetuple directly)
p11758
aVThere are no faster avenues to parsing a date-time string that I am aware of though
p11759
as(dp11760
g16
V100297
p11761
stp11762
a((dp11763
g2
(lp11764
VYou are converting your  tree to  (an encoded byte string), then try to concatenate this to an empty  unicode string
p11765
aVPython will automatically try and decode your encoded byte string, using the default encoding, which is , and fails to decode the  data
p11766
aVYou need to explicitly decode the  output:
p11767
aVThe Python Unicode HOWTO explains this better, including about default encodings
p11768
aVI really, really recommend you read Joel Spolsky's article on Unicode as well
p11769
as(dp11770
g16
V100297
p11771
stp11772
a((dp11773
g2
(lp11774
VMethodnames that start with a double underscore are automatically mangled; internally, the string  is prepended to the method name:
p11775
aVThis renaming also is done for anything referencing this method name in any of the other methods in the class
p11776
aVThus, your  method is renamed to , and the  method is altered to call  instead
p11777
aVSimilarly, your  class has a  method, and it thus does not override the  method of it's super-class
p11778
aVThis is why you see the results you see; rename your  methods to  (only one underscore) and it'll work as expected
p11779
aVWhy does python do this
p11780
aVIt's a form of providing private attributes and methods, that cannot be accidentally overridden by classes that inherit from them
p11781
aVSee private name mangling in the Python expression reference
p11782
aVThe PEP 8 Python Style Guide has this to say about private name mangling:
p11783
aVIf your class is intended to be subclassed, and you have attributes
p11784
aVthat you do not want subclasses to use, consider naming them with
p11785
aVdouble leading underscores and no trailing underscores
p11786
aVThis invokes
p11787
aVPython's name mangling algorithm, where the name of the class is
p11788
aVmangled into the attribute name
p11789
aVThis helps avoid attribute name
p11790
aVcollisions should subclasses inadvertently contain attributes with the
p11791
aVsame name
p11792
aVNote 1: Note that only the simple class name is used in the mangled
p11793
aVname, so if a subclass chooses both the same class name and attribute
p11794
aVname, you can still get name collisions
p11795
aVNote 2: Name mangling can make certain uses, such as debugging and
p11796
aV, less convenient
p11797
aVHowever the name mangling algorithm
p11798
aVis well documented and easy to perform manually
p11799
aVNote 3: Not everyone likes name mangling
p11800
aVTry to balance the need to
p11801
aVavoid accidental name clashes with potential use by advanced callers
p11802
as(dp11803
g16
V100297
p11804
stp11805
a((dp11806
g2
(lp11807
VYou imported the  module into a your module scope as , but you also have a local variable  in your  method
p11808
aVWhen python sees an assignment (such as ) in a function when compiling, it marks that name as a local variable
p11809
aVAt this point your import of the  module is doomed, it is no longer visible in your function under that name
p11810
aVNext, in python's eyes you are trying to access that local variable  in the function; you are trying to get the attribute  from it, but you haven't yet assigned anything to the variable  at that moment
p11811
aVSo the  exception is thrown
p11812
aVThe workaround is to either not use  as a local variable, to import the top-level  module instead of it's submodules, then refer to it's submodules with the full , etc
p11813
aVpaths, or thirdly, by giving the  module a new name:
p11814
aVDon't use  as a local:
p11815
aVImport the  module directly:
p11816
aVProvide an alias for the  module:
p11817
as(dp11818
g16
V100297
p11819
stp11820
a((dp11821
g2
(lp11822
VYou can use  to run a piece of code repeatedly given a repeat count in :
p11823
as(dp11824
g16
V100297
p11825
stp11826
a((dp11827
g2
(lp11828
VSurround your database name in quotes:
p11829
aVFrom the Identifiers and Keywords documentation:
p11830
aVThere is a second kind of identifier: the delimited identifier or quoted identifier
p11831
aVIt is formed by enclosing an arbitrary sequence of characters in double-quotes (")
p11832
aVA delimited identifier is always an identifier, never a key word
p11833
aVSo "select" could be used to refer to a column or table named "select", whereas an unquoted select would be taken as a key word and would therefore provoke a parse error when used where a table or column name is expected
p11834
aVThe example can be written with quoted identifiers like this:
p11835
aVQuoted identifiers can contain any character, except the character with code zero
p11836
aVDo note that quoted identifiers are case sensitive
p11837
aVYou cannot drop a database while connected to that database though, so maybe you want to use the command line  command
p11838
aVYour shell will parse the quotes, so you want to escape the quotes:
p11839
as(dp11840
g16
V100297
p11841
stp11842
a((dp11843
g2
(lp11844
VNo, apart from raising the zException built-in exceptions and calling , there is no other way for influencing the status code
p11845
as(dp11846
g16
V100297
p11847
stp11848
a((dp11849
g2
(lp11850
VPython's sort algorithm (TimSort) is a stable sort, so any items that have the same sort 'value', are kept in the order they were in before sorting
p11851
aVWhen sorting dictionary keys, that means they are kept in the same order as returned by  or when iterating over the dictionary
p11852
aVDo note that this ordering is arbitrary, and not stable across changes to the dictionary
p11853
aVOtherwise yes, you can assume that to be true for all cases
p11854
aVAs pointed out by Steven Rumbalski, you can take the key along with the sorting to stabilize same-value sorting ordering:
p11855
as(dp11856
g16
V100297
p11857
stp11858
a((dp11859
g2
(lp11860
VThe standard practice is to use SSL encryption for the connection (e
p11861
ag1298
aVhttps), then hash it with a salt on the server side
p11862
aVWhen later a user logs in, you will have to still verify the password and sending a hash of the password from browser to server is just as insecure as sending the password itself; an attacker that intercepts either can still log in as that user
p11863
aVThere is a python package called  that can take care of the various forms of password hashing and salting for you:
p11864
aVIt is generally a good idea to include the choosen algorithm in the stored password hash; RFC 2307 passwords (as used in LDAP) use a  prefix, other hash schemes use a unix  prefix, where digit is a number; the  scheme in the code snippet above uses  as a prefix
p11865
aVThat way you can upgrade your password scheme at a later time while still supporting older schemes by choosing the correct hashing algorithm to verify a password at a later time
p11866
aVMost  hashing schemes already return hashes with their standard prefix, documented in each scheme's detailed documentation page
p11867
aVYou can use the  function to identify what hash algorithm was used when you later need to verify a password hash against an entered password
p11868
as(dp11869
g16
V100297
p11870
stp11871
a((dp11872
g2
(lp11873
VIn python code blocks are indented to group statements:
p11874
aVPlease, please, do read the Python tutorial; it teaches you the vital basic concepts of Python
p11875
as(dp11876
g16
V100297
p11877
stp11878
a((dp11879
g2
(lp11880
VMake sure your values match your column family type
p11881
aVIt appears your column family either is a BytesType or has no type associated with it, so pycassa will only accept string values
p11882
aVYou can map all your values to  with a list comprehension with a nested dict comprehension (the latter requires python 2
p11883
aV7 and up):
p11884
as(dp11885
g16
V100297
p11886
stp11887
a((dp11888
g2
(lp11889
VYou need to commit your transaction
p11890
aVYou can do this explicitly (by calling  or by using the  middleware; the latter commits transactions automatically on successful responses (with a 2xx HTTP response)
p11891
aVThe latter only commits transactions for SQLAlchemy if you use the  extension with your session maker:
p11892
aVIf you are already using the  and want to explicitly commit your transactions, you need to use the  package to explicitly commit a transaction:
p11893
as(dp11894
g16
V100297
p11895
stp11896
a((dp11897
g2
(lp11898
VYou need to ask twitter for each page separately; in your loop you keep asking for the same page each time, without passing the page number to the search query:
p11899
aVYou don't need to use a  loop either, you can simplify the code by using a  loop instead, combined with the  function:
p11900
as(dp11901
g16
V100297
p11902
stp11903
a((dp11904
g2
(lp11905
VPython is interpreting  as 'literal backslash followed by a string formatting code';  doesn't mean anything in a python  literal so the backslash is included literally
p11906
aVYou are looking for the  function:
p11907
aVThe  character escapes only work in python literals
p11908
aVYou can instruct python to interpret an arbitrary string containing a literal  backslash pus code to be interpreted as a python string literal using the  codec:
p11909
aVNote that the proper way to specify a unicode literal is to use the  format, and to use a unicode string literal:
p11910
aVRaw bytes can also be generated using the  escape sequence:
p11911
as(dp11912
g16
V100297
p11913
stp11914
a((dp11915
g2
(lp11916
VUse the  module, it has a handy  function:
p11917
aVOn the python prompt:
p11918
as(dp11919
g16
V100297
p11920
stp11921
a((dp11922
g2
(lp11923
V is not a PDB command or normally unavailable during a debug session
p11924
aVYou must have a local variable  with an integer value in your local or global namespace:
p11925
aVLocal variable defined in the code-under-test:
p11926
aVThe work-around in these cases is to refer to the original  function via the  module:
p11927
as(dp11928
g16
V100297
p11929
stp11930
a((dp11931
g2
(lp11932
VWith SQLAlchemy, you simply create a new instance of the model class, and merge it into the current session
p11933
aVSQLAlchemy will detect if it already knows about this object (from cache or the database) and will add a new row to the database if needed
p11934
aVAlso see this question for context: Fastest way to insert object if it doesn't exist with SQLAlchemy
p11935
as(dp11936
g16
V100297
p11937
stp11938
a((dp11939
g2
(lp11940
VNo, the  source is implemented independently from the stdlib  module and only supports ZLIB compressed data or uncompressed archives
p11941
aVSpecifically, the heavy lifting is done in the  function which has  and  branches
p11942
as(dp11943
g16
V100297
p11944
stp11945
a((dp11946
g2
(lp11947
VYou need to parse your file line by line:
p11948
aVEach line contains valid JSON, but as a whole, it is not a valid JSON value as there is no top-level list or object definition
p11949
aVNote that because the file contains JSON per line, you are saved the headaches of trying to parse it all in one go or to figure out a streaming JSON parser
p11950
aVYou can now opt to process each line separately before moving on to the next, saving memory in the process
p11951
aVYou probably don't want to append each result to one list and then process everything if your file is really big
p11952
aVIf you have a file containing individual JSON objects with delimiters in-between, use How do I use the json module to read in one json object at a time
p11953
aVto parse out individual objects using a buffered method
p11954
as(dp11955
g16
V100297
p11956
stp11957
a((dp11958
g2
(lp11959
VThe  parameter in path searches limits the depth of the search, it does not set a minimal level
p11960
aVSo, in your search, all paths starting at  up to and including 2 nested levels of children are returned
p11961
aVJust filter out the root path; you already have the context so you can just compare URL of each item:
p11962
as(dp11963
g16
V100297
p11964
stp11965
a((dp11966
g2
(lp11967
VFrom the  documentation:
p11968
aVA pair (host, port) is used for the AF_INET address family, where host is a string representing either a hostname in Internet domain notation like 'daring
p11969
aVcwi
p11970
aVnl' or an IPv4 address like '100
p11971
aV50
p11972
aV200
p11973
aV5', and port is an integer
p11974
aVSo the second value is the port number used by the client side for the connection
p11975
aVWhen a TCP/IP connection is established, the client picks an outgoing port number to communicate with the server; the server return packets are to be addressed to that port number
p11976
as(dp11977
g16
V100297
p11978
stp11979
a((dp11980
g2
(lp11981
VThe algorithm from Merging a list of time-range tuples that have overlapping time-ranges works perfectly for your input, provided you concatenate them:
p11982
aVoutput:
p11983
as(dp11984
g16
V100297
p11985
stp11986
a((dp11987
g2
(lp11988
VThose are the edges in the abstract syntax parse tree
p11989
aVNot the nodes themselves, but the elements that connect the nodes
p11990
aVFor example, in a if/else branch, the condition is one node, the if branch is another, and the else branch a third node in the tree, with the edges annotated to mark the condition and code branches
p11991
as(dp11992
g16
V100297
p11993
stp11994
a((dp11995
g2
(lp11996
VYou have to both filter and use a  argument to max:
p11997
aVThe filter can also be expressed as a generator expression:
p11998
aVDemo:
p11999
aVNote that because you filter, it's easy to end up with an empty list to pick the max from, so you may need to catch s unless you need that exception to propagate up the call stack:
p12000
as(dp12001
g16
V100297
p12002
stp12003
a((dp12004
g2
(lp12005
VThis is not a regular-expression-shaped nail, so please put down that hammer
p12006
aVPython has a  module for data like that instead
p12007
as(dp12008
g16
V100297
p12009
stp12010
a((dp12011
g2
(lp12012
VUse the  method to write out the document:
p12013
aVBoth the  method and the  function support the  keyword argument, provided you use Python 2
p12014
aV7 or up
p12015
aVOn earlier versions of Python, you can install the external ElementTree library; version 1
p12016
aV3 supports that keyword
p12017
aVYes, it sounds a little weird, but the  output mostly outputs empty elements as a start and end tag
p12018
aVSome elements still end up as empty tag elements; specifically , ,  and such
p12019
aVStill, it's that or upgrade your Fortran XML parser to actually parse standards-compliant XML
p12020
as(dp12021
g16
V100297
p12022
stp12023
a((dp12024
g2
(lp12025
VYou can use bitshifting:
p12026
aVThis easily beats the "int cast" method proposed by A
p12027
aVR
p12028
ag8974
aV, or the modified cast with lookup proposed by Steven Rumbalski:
p12029
as(dp12030
g16
V100297
p12031
stp12032
a((dp12033
g2
(lp12034
VYour function doesn't handle a string argument, which is what argparse is handing it; call  on it:
p12035
aVIf you need to support more than days, you'll have to find a way to parse the argument passed in into timedelta arguments
p12036
aVYou could, for example, support , ,  or  postfixes to denote days, hours, minutes or seconds:
p12037
aVNow your  method accepts more complete deltas, and even integers still:
p12038
aVThe default unit is days
p12039
as(dp12040
g16
V100297
p12041
stp12042
a((dp12043
g2
(lp12044
VYou create new DOM elements with the  method, new DOM attributes can be added with the  method:
p12045
aVYou then have to create a text node and add that as a child to the  Element, using the  and  methods:
p12046
aVNow you can add the new element to your document root:
p12047
aVIn other words, use the Python implementation of the DOM API
p12048
as(dp12049
g16
V100297
p12050
stp12051
a((dp12052
g2
(lp12053
VYou can explicitly include all globally installed packages in your virtualenv with the   switch:
p12054
aVGive access to the global site-packages dir to the virtual environment
p12055
aVor disable global site packages with the  switch instead:
p12056
aVDon't give access to the global site-packages dir to the virtual environment
p12057
aVThe latter is currently the default
p12058
aVI personally have  installed in my global site packages, so we can use that as a small demonstration:
p12059
as(dp12060
g16
V100297
p12061
stp12062
a((dp12063
g2
(lp12064
VYou are testing two different things, and the outcome is False; Python is chaining the operators, effectively testing if :
p12065
aVYou never need to test for  on an if statement anyway:
p12066
aVis enough
p12067
as(dp12068
g16
V100297
p12069
stp12070
a((dp12071
g2
(lp12072
VUse the  method:
p12073
aVQuoting the documentation:
p12074
aVReturn true if all characters in the string are digits and there is at least one character, false otherwise
p12075
aVFor  strings or Python 3 strings, you'll need to use a more precise definition and use the  /  instead; not all Unicode digits are interpretable as decimal numbers
p12076
aVU+00B2 SUPERSCRIPT 2 is a digit, but not a decimal, for example
p12077
as(dp12078
g16
V100297
p12079
stp12080
a((dp12081
g2
(lp12082
VYou call  twice, so you need to put both cases in a / block:
p12083
aVI've corrected two other problems, it is better to test for  with  in python, and your first  test was not going to work, as  is interpreted as  separately from  with an  in between
p12084
aVThe  is always seen as  so you never would come to the other branches in your code
p12085
aVNote that I suspect the above code could be simplified much more, but you don't show us your  function at all, so you leave us to guess what you are trying to do
p12086
as(dp12087
g16
V100297
p12088
stp12089
a((dp12090
g2
(lp12091
VYou put the period in a character class, where it is the one place it will just match a  character and nothing else
p12092
aVmeans any literal character contained in that class
p12093
aVYou want to use the  configuration constant instead:
p12094
aVAlternatively, you should keep the  outside of the character class and use it in a group with the  newline:
p12095
aVDemo:
p12096
as(dp12097
g16
V100297
p12098
stp12099
a((dp12100
g2
(lp12101
VTweets are just python dictionaries, and their contents echo the  resource exactly
p12102
aVEach tweet thus has an  key:
p12103
aVYou can always print data structures if things are not clear; I can recommend the  function to make nested python structures extra readable:
p12104
aVExample session:
p12105
as(dp12106
g16
V100297
p12107
stp12108
a((dp12109
g2
(lp12110
VThe following regex will give you your pairs of numbers (including minus signs) in groups:
p12111
aVThis matches a word-boundary (), then a set of digits (with an optional  minus sign before it), followed by a colon surrounded by optional whitespace, followed by another set of digits with optional minus sign, followed by a word boundary
p12112
aVDemo:
p12113
aVYou probably don't want to reach all lines into memory at once; just loop over your file line by line:
p12114
aVYou don't need to remove the newline for the above code to work, but if you do, use  instead of
p12115
as(dp12116
g16
V100297
p12117
stp12118
a((dp12119
g2
(lp12120
VNo, today is Tuesday, and that's weekday 1, following the documentation:
p12121
aVReturn the day of the week as an integer, where Monday is 0 and Sunday is 6
p12122
aVThe same as
p12123
aVSee also
p12124
aVSo Monday is , Tuesday is , etc
p12125
aVIf you want  for Tuesday, use  instead:
p12126
aVReturn the day of the week as an integer, where Monday is 1 and Sunday is 7
p12127
aVThe same as
p12128
aVSee also ,
p12129
as(dp12130
g16
V100297
p12131
stp12132
a((dp12133
g2
(lp12134
VReturn new vectors when using  and , and handle 'strange' types:
p12135
aVTo modify the vectors in-place, use  and ; these still need to return the new value; this can be
p12136
aVNote that this does not handle just passing in a tuple of  coordinates
p12137
aVIf you want to support that usecase, you need to specially handle it:
p12138
aVNote also that you should not really use class attributes for your position and velocity values; I've used instance attributes instead above, and took the opportunity to set both position and velocity to sane values
p12139
aVDemo:
p12140
as(dp12141
g16
V100297
p12142
stp12143
a((dp12144
g2
(lp12145
VUse  argument passing:
p12146
aVDemo:
p12147
as(dp12148
g16
V100297
p12149
stp12150
a((dp12151
g2
(lp12152
VWhy not generate a new ID in your python product
p12153
aVAt the module level, define a new random constant on module load:
p12154
aVand use that
p12155
as(dp12156
g16
V100297
p12157
stp12158
a((dp12159
g2
(lp12160
VBecause Plone items are not files on a disk, and because we can use acquisition in Plone, any piece of HTML can be rendered via different URLs
p12161
aVVia acquisition, it could be almost anything for example, but folderish items can be rendered both with and without a trailing slash
p12162
aVThe browser bases relative URLs within a page on the current page URL, unless a  tag is present, in which case any relative URLs on the page are made absolute relative to that URL instead
p12163
aVRemove the tag at your own peril; there are always more relative URLs to contend with than you could hope to eliminate
p12164
as(dp12165
g16
V100297
p12166
stp12167
a((dp12168
g2
(lp12169
V does not do what you think it does
p12170
aVThe method returns the internal size in bytes for the given object, not the number of items a generator is going to return
p12171
aVPython cannot beforehand know the size of a generator
p12172
aVTake for example the following endless generator (example, there are better ways to create a counter):
p12173
aVThat generator is endless; there is no size assignable to it
p12174
aVYet the generator object itself takes memory:
p12175
aVYou don't normally call  you leave that to the  function, which also adds garbage collector overhead
p12176
aVIf you know a generator is going to be finite and you have to know how many items it returns, use:
p12177
aVbut note that that exhausts the generator
p12178
as(dp12179
g16
V100297
p12180
stp12181
a((dp12182
g2
(lp12183
VSQLAlchemy  instances are not strings, but objects with a string representation when printed
p12184
aVThey act like lists and mappings; if all you need are the long values, just loop over the row:
p12185
aVor address each column in the row by it's index:
p12186
aVYour query asks for the column , so that is now a key on the row:
p12187
as(dp12188
g16
V100297
p12189
stp12190
a((dp12191
g2
(lp12192
VIf your code has to call specific private methods that cannot be overridden, use a name that starts with two underscores:
p12193
aVPython "mangles" such method names by adding in the class name (plus an underscore) to minimize the chances subclasses overwrite them with their own versions
p12194
aVThe PEP 8 Python Style Guide has this to say about private name mangling:
p12195
aVIf your class is intended to be subclassed, and you have attributes
p12196
aVthat you do not want subclasses to use, consider naming them with
p12197
aVdouble leading underscores and no trailing underscores
p12198
aVThis invokes
p12199
aVPython's name mangling algorithm, where the name of the class is
p12200
aVmangled into the attribute name
p12201
aVThis helps avoid attribute name
p12202
aVcollisions should subclasses inadvertently contain attributes with the
p12203
aVsame name
p12204
aVNote 1: Note that only the simple class name is used in the mangled
p12205
aVname, so if a subclass chooses both the same class name and attribute
p12206
aVname, you can still get name collisions
p12207
aVNote 2: Name mangling can make certain uses, such as debugging and
p12208
aV, less convenient
p12209
aVHowever the name mangling algorithm
p12210
aVis well documented and easy to perform manually
p12211
aVNote 3: Not everyone likes name mangling
p12212
aVTry to balance the need to
p12213
aVavoid accidental name clashes with potential use by advanced callers
p12214
as(dp12215
g16
V100297
p12216
stp12217
a((dp12218
g2
(lp12219
VUse the  of the response:
p12220
aVAlternatively, you can use the decoded unicode text:
p12221
aVSee the Response content section of the documentation
p12222
as(dp12223
g16
V100297
p12224
stp12225
a((dp12226
g2
(lp12227
VJust pass  to  to remove digits from the right-hand side of your strings:
p12228
as(dp12229
g16
V100297
p12230
stp12231
a((dp12232
g2
(lp12233
VYou could use a   condition:
p12234
aVor simplify this down to:
p12235
aVif you don't care about  possibly being some other false-y value such as an empty tuple and such
p12236
as(dp12237
g16
V100297
p12238
stp12239
a((dp12240
g2
(lp12241
VYou are printing 4-byte Unicode characters in a UCS2 Python build, which internally are stored as 2 characters each, a UTF-16 surrogate pair
p12242
aVOne of the side-effects is that any Unicode character above  is printed as such pairs; the lead character is a value between  and  followed by a second character in the  to  range
p12243
aVYou need to recompile your python to support wide Unicode characters, or upgrade to python 3
p12244
aV3 which has a new internal Unicode representation that switches between 1, 2 and 4 bytes wide characters as needed
p12245
aVYou can test your python unicode support by looking at ; if that system value is equal to  you have a narrow (default) build, in a wide build that value is 1114111
p12246
aVMac's default python is a narrow Unicode build; most recent Linux distributions enable the wide unicode flag
p12247
as(dp12248
g16
V100297
p12249
stp12250
a((dp12251
g2
(lp12252
VYou probably want to exclude numbers that are both not preceded by a "number
p12253
aVcombo and not followed by a "
p12254
aVnumber" combo:
p12255
aVResult:
p12256
as(dp12257
g16
V100297
p12258
stp12259
a((dp12260
g2
(lp12261
VA generator could do this nicely if you only need the first match:
p12262
aVUsage:
p12263
aVNote that the first value is the index into the overal  sequence, the second is the index into the individual tuple;
p12264
as(dp12265
g16
V100297
p12266
stp12267
a((dp12268
g2
(lp12269
VYou need to use the proper parameter syntax; the format depends entirely on your database adapter
p12270
aVFor example, some adapters support  paramaters, in which case you are missing those colons in your query:
p12271
aVThe DBAPI 2
p12272
aV0 spec supports several formats, including positional parametrs with  and  placeholders, and named parameters in the above form and as  formatting
p12273
aVYou need to review your database adapter documentation to find out what is supported
p12274
as(dp12275
g16
V100297
p12276
stp12277
a((dp12278
g2
(lp12279
VYou need to pass  to the template:
p12280
as(dp12281
g16
V100297
p12282
stp12283
a((dp12284
g2
(lp12285
VThis is not going to work at all, I'm afraid
p12286
aVThe compiler does not see the code suite under a  statement as a separate scope, so you cannot do what you want
p12287
aVYou'd have to go look at the  function (in Python 3,  statement in Python 2) instead, as that does let you pass in a custom mapping object for the local namespace; python 3
p12288
aV3 even let's you use a custom mapping for the global namespace too
p12289
aVWith a custom mapping name lookups are totally malable, just as you seek
p12290
as(dp12291
g16
V100297
p12292
stp12293
a((dp12294
g2
(lp12295
VYour  returns the property value, not the property itself
p12296
aVWhen you access  it does the equivalent of  and returns that, and the property is called at that time
p12297
aVYou thus need to implement a  method too, to mirror the  and pass on the value setting to the contained  object
p12298
aVUnder the hood, Python implements properties as descriptors; their  method is called by the lower-level  method, which causes them to return their computed value
p12299
aVIt is never the property object itself that is returned
p12300
aVHere's an example :
p12301
aVNote: because your  sets , you need to test if  exists on your class (
p12302
aVYou also need to call the original  implementation to make sure that things like  work still
p12303
as(dp12304
g16
V100297
p12305
stp12306
a((dp12307
g2
(lp12308
VMethods are functions that are associated with a class
p12309
aVMethods are only created when you retrieve them from an already defined class; a method is a wrapper around a function, with a reference to the class as well (and optionally a reference to the instance)
p12310
aVWhat happens in the first case is: Python compiles your class definition
p12311
aVIt finds the decorator definition and a function
p12312
aVThe decorator is passed the function, returning a new function
p12313
aVThat function is added to the class definition (stored in the class )
p12314
aVAll this time you are dealing with a python function, not a method
p12315
aVThat happens later
p12316
aVWhen you then call , a lookup reveals that the instance doesn't have a  but the  class does, so it is retrieved using
p12317
aVThis finds a function (your  decorator), which is a descriptor so it's  method is called (so , returning a bound method, which is then called and passed in the  value
p12318
aVThe method is bound because  is not None when  is called
p12319
aVYour decorator, which wrapped a function at class building time, prints  because it was passed an unwrapped function to start with
p12320
aVIn the second case, however, you retrieve a method (again via  calling  on the undecorated  function), this time unbound (as there is no instance, only a class passed to  (the full call is ), and you then decorate that method
p12321
aVNow  prints True
p12322
aVNote that in Python 3, the latter case changes
p12323
aVIn Python 3 there no longer is a concept of an unbound method, only functions and bound methods
p12324
aVThe term 'bound' is thus dropped altogether
p12325
aVYour second case would also print  as  returns a function in that case
p12326
as(dp12327
g16
V100297
p12328
stp12329
a((dp12330
g2
(lp12331
VNo, this is not planned
p12332
aVThe  arbitrary parameter list (and  keyword arguments mapping) only applies to python call invocations (mirrored by  and  function signatures), and to the left-hand side of an iterable assignment
p12333
aVYou can simply concatenate the two lists:
p12334
as(dp12335
g16
V100297
p12336
stp12337
a((dp12338
g2
(lp12339
VThe  module as shipped with Python 2
p12340
aV5 and up does not include the  module; the latter is entirely separate from the rest of the  functionality
p12341
aVTo generate XML, I personally use a templating language such as Chameleon
p12342
aVYou can also build the tree by using the ElementTree API itself and simply call  on the result
p12343
as(dp12344
g16
V100297
p12345
stp12346
a((dp12347
g2
(lp12348
VA better bet is to use the  parameter for sorting:
p12349
aVYou can also use the  built-in function instead of using ; it'll return a sorted list for you, it's the same amount of work for Python to first call  on the results, then sort, as it is to just call :
p12350
aVNaturally, both  and  need to be present in the catalog metadata
p12351
as(dp12352
g16
V100297
p12353
stp12354
a((dp12355
g2
(lp12356
VYou are not grouping the match correctly, use this instead:
p12357
aVreturns the whole match, unless you define capturing groups (), at which point it'll return the results contained in the group instead
p12358
aVThe above pattern uses a non-capturing group instead ()
p12359
aVSince that leaves your expression without any capturing groups,  returns full matches again
p12360
as(dp12361
g16
V100297
p12362
stp12363
a((dp12364
g2
(lp12365
VUnfortunately,  becomes :
p12366
aVAnd the DateTime internal database translates that to
p12367
aVIt is an unfortunate side-effect of Eastern Standard Time being the name for more than one timezone
p12368
aVYou'd need to specify a more explicit  variable specifying the offsets and the DST switch dates, with a new timezone name that won't be misinterpreted:
p12369
aVThe above value comes from the still open bug report and happens to be perfect for your purposes:
p12370
aVYou can add the  environment variable to your Zope configuration by sepecifying it in the buildout:
p12371
as(dp12372
g16
V100297
p12373
stp12374
a((dp12375
g2
(lp12376
VYou can use the  module to both pick a number between 3 and 20, and to take a sample of lines:
p12377
as(dp12378
g16
V100297
p12379
stp12380
a((dp12381
g2
(lp12382
VYou are looking for the "Displays for lists, sets and dictionaries" section of the expressions chapter of the reference documentation
p12383
aVThat section deals with both defining literal lists, sets and dictionaries, as well as comprehension expressions for those types
p12384
aVFor constructing a list, a set or a dictionary Python provides special syntax called \u201cdisplays\u201d, each of them in two flavors:
p12385
aVeither the container contents are listed explicitly, or
p12386
aVthey are computed via a set of looping and filtering instructions, called a comprehension
p12387
as(dp12388
g16
V100297
p12389
stp12390
a((dp12391
g2
(lp12392
V does not return a list of values, it returns just one value
p12393
aVTry using  instead:
p12394
aVThere is no need to use a while loop, a for loop works much better:
p12395
as(dp12396
g16
V100297
p12397
stp12398
a((dp12399
g2
(lp12400
VYou want to use the  function to get a list of values:
p12401
aVYou do not need to add  to the name to make this work; in fact, the  will not help, don't use it at all
p12402
as(dp12403
g16
V100297
p12404
stp12405
a((dp12406
g2
(lp12407
VYes, using  is indeed the best way to do that
p12408
as(dp12409
g16
V100297
p12410
stp12411
a((dp12412
g2
(lp12413
VTo pass a list as hidden elements in a form you need to create a new  element for each item in the list:
p12414
aVNote that  elements must be empty elements (so use ) according to the HTML standard
p12415
as(dp12416
g16
V100297
p12417
stp12418
a((dp12419
g2
(lp12420
VYour  command is installed for a different python (one installed in
p12421
aVYou'll find that for  the import works
p12422
aVYou need to install pip seperately for your other python (the one in ) to have lxml installed for that python version
p12423
aVUse  to ensure the correct  command is used to install  once  has been installed
p12424
as(dp12425
g16
V100297
p12426
stp12427
a((dp12428
g2
(lp12429
VWhen you see a command pattern like , , etc
p12430
aVwe are talking about sub-commands
p12431
aVTo create sub-commands, argparse lets you use sub-parsers, which are essentially just like the main parser (take command-line switches, etc
p12432
aVDefine them like this:
p12433
aVI've associated a function with each subparser (), and thus the  structure will have a  attribute pointing to one of the functions defined
p12434
aVWe simply have to call it
p12435
aVOutput of :
p12436
as(dp12437
g16
V100297
p12438
stp12439
a((dp12440
g2
(lp12441
VThe  method should take an extra argument; yours only takes  but it is passed an event argument as well
p12442
aVUpdate your function signature to accept it:
p12443
as(dp12444
g16
V100297
p12445
stp12446
a((dp12447
g2
(lp12448
VYes, they can, but you need to put a special piece of code in the  file in each package to declare it a namespace:
p12449
aVand you need to declare the namespace in each package's  metadata:
p12450
aVAll this requires you to use , it will not work with mere distutils distributions
p12451
aVSee the Namespace packages documentation of
p12452
aVNote: older packages used a more verbose version of the namespace declaration code:
p12453
aVThe  function now takes care of the same job more concisely
p12454
as(dp12455
g16
V100297
p12456
stp12457
a((dp12458
g2
(lp12459
VI'd cache the query results, indeed
p12460
aVYou need to make a decision on how long to cache the results, and if stored long term, how to invalidate that cache or check for changes
p12461
aVThere are no best practices for these decisions, as they depend entirely on the type of data stored and the APIs of the backends
p12462
aVIf they support some kind of freshness query, for example, then you store everything forever and poll the backend to see if the cache needs updating
p12463
aVYou can start with a simple request cache; query once per request, store it on the request object
p12464
aVYour cache will automatically be invalidated at the end of the request as the request object is cleaned up, the next request will be a clean slate
p12465
aVIf your backend users rarely change, you can cache information for longer, in a local cache
p12466
aVI'd use a volatile attribute on the plugin
p12467
aVAny attribute starting with  is ignored by the persistence machinery
p12468
aVThus, anything stored in a  volatile attribute is both thread-local and only exists for the lifetime of the process, a restart of the server clears these automatically
p12469
aVAt the very least you should use an  volatile attribute to store your backend SQL connections
p12470
aVThat way they can stay open between requests, and can be re-used
p12471
aVSomething like the following method would do nicely:
p12472
aVYou could also use a persistent attribute on your plugin to store your cache
p12473
aVThis cache would be committed to the ZODB and persist across restarts
p12474
aVYou then really need to work out how to invalidate the contents; store timestamps and evict data when to old, etc
p12475
aVYour cache datastructure depends entirely on your application needs
p12476
aVIf you don't persist information, a dictionary (username -> information) could be more than enough
p12477
aVPersisted caches could benefit from using a  instead of a dictionary as they reduce chances of conflicts between different threads and are more efficient when it comes to large sets of data
p12478
aVWhatever you do, you do not need to use a Session
p12479
aVSessions are prone to conflicts, do not scale well, and are in any case not the place to store a cache of this kind
p12480
as(dp12481
g16
V100297
p12482
stp12483
a((dp12484
g2
(lp12485
VJust match the literal  and group on the repeated :
p12486
aVThe  pattern matches a set of literal characters at least once, and the whole group is preceded by a literal XYZ
p12487
aVThis is quite basic regular expression 101, you should read a good tutorial on regular expression matching to get started
p12488
as(dp12489
g16
V100297
p12490
stp12491
a((dp12492
g2
(lp12493
VYou are moving elements out of the  while iterating over them
p12494
aVThis changes the  list:
p12495
aVYou'll have to iterate over a copy of the list instead; here I create a copy of the list by using the  slice notation:
p12496
aVDo yourself a big favour though and use the ElementTree API instead; that API is far pythononic and easier to use than the XML DOM API:
p12497
as(dp12498
g16
V100297
p12499
stp12500
a((dp12501
g2
(lp12502
VYou are looking for the  of your folder:
p12503
aVThe above snippet looks up the creator userid (this defaults to the owner of the content object), and uses the membership tool to look up a member info object for that user
p12504
aVWe then display the user's full name, or if the creator is not a Plone user, just the userid
p12505
as(dp12506
g16
V100297
p12507
stp12508
a((dp12509
g2
(lp12510
VJSON is a textual format
p12511
aVSince images are opaque binary data, you'd need to encode that data into a textual format
p12512
aVBase64 is most commonly used for such data, which python can handle just fine with the  module:
p12513
aVThis is what Twitter supports for updating your profile image
p12514
aVHowever, using JSON for image data is not a good idea for all but very small images
p12515
aVThe json parser included in python will easily overload with a large payload like a decently sized image
p12516
aVYou'd be better off providing a REST API that accepts images using a PUT or POST request instead, then communicate about the image using URLs
p12517
as(dp12518
g16
V100297
p12519
stp12520
a((dp12521
g2
(lp12522
VYou are already using the httpbin
p12523
aVorg service, it returns you a JSON structure that includes all headers it received:
p12524
aVWhen I run the above code, I get:
p12525
as(dp12526
g16
V100297
p12527
stp12528
a((dp12529
g2
(lp12530
VInstances store their attributes in :
p12531
aVProvided you don't store any methods on your instances, a default  could be:
p12532
aVwhere we sort the items by attribute name; the  call ensures we return an immutable sequence suitable for the  call
p12533
aVFor more complex setups you'd have to either test for the types returned by  (skip functions and such) or use a specific pattern of attributes or repurpose  to list the appropriate attributes you can use
p12534
aVTogether with your  and  methods, that'd make a good base class to inherit from for all your immutable classes
p12535
as(dp12536
g16
V100297
p12537
stp12538
a((dp12539
g2
(lp12540
VYou are using a regular expression, but matching XML with such expressions gets too complicated, too fast
p12541
aVDon't do that
p12542
aVUse a HTML parser instead, Python has several to choose from:
p12543
aVElementTree is part of the standard library
p12544
aVBeautifulSoup is a popular 3rd party library
p12545
aVlxml is a fast and feature-rich C-based library
p12546
aVThe latter two handle malformed HTML quite gracefully as well, making decent sense of many a botched website
p12547
aVElementTree example:
p12548
as(dp12549
g16
V100297
p12550
stp12551
a((dp12552
g2
(lp12553
VIf you have defined your own  dummy function, and that function does not have a  value, then most likely the included python interpreter is a custom compiled version where the  slot has been cleared
p12554
aVThe work-around is simple, copy the  zipfiles (in all subdirs) elsewhere, add those to your  and import the code into your own interpreter
p12555
as(dp12556
g16
V100297
p12557
stp12558
a((dp12559
g2
(lp12560
VYou'll need to use an absolute filename, not a local file:
p12561
as(dp12562
g16
V100297
p12563
stp12564
a((dp12565
g2
(lp12566
VThe module you are looking for is the  module
p12567
aVYou'd still need to ensure that your lists meet you minimal length requirements:
p12568
as(dp12569
g16
V100297
p12570
stp12571
a((dp12572
g2
(lp12573
VJust built a new list by casting the arrays to single-dimension lists:
p12574
aVAlternatively, you could use  to create one-dimensional arrays:
p12575
aVIf the number of parameters is variable, you can generate the placeholder parameters too:
p12576
as(dp12577
g16
V100297
p12578
stp12579
a((dp12580
g2
(lp12581
V calls the function for you
p12582
aVBy calling it yourself, the exception is raised before  can test it
p12583
aVChange your code to:
p12584
aVand it'll work correctly
p12585
aVAlternatively, you can use  as a context manager (python 2
p12586
aV7 and up):
p12587
aVUsing  as a context manager has the added advantage that you can now retrieve the exception instance and perform further tests on it:
p12588
as(dp12589
g16
V100297
p12590
stp12591
a((dp12592
g2
(lp12593
VYour  function will have to retrieve the textfield after the button has been pressed:
p12594
aVI've changed your test a little, using , and directly printing the result of that test (print will turn boolean  or  into the matching string)
p12595
aVWhat happens in your code is that you define , retrieve it's contents (obviously empty), and only then show the TKInter GUI window by running the mainloop
p12596
aVThe user never gets a chance to enter any text that way
p12597
as(dp12598
g16
V100297
p12599
stp12600
a((dp12601
g2
(lp12602
V returns a new query object, but you do not store it
p12603
aVReplace  with the result each time:
p12604
as(dp12605
g16
V100297
p12606
stp12607
a((dp12608
g2
(lp12609
VNote that the code is looking for  with an underscore, but you specified it as , a namespaced value, instead
p12610
aVThe following works:
p12611
aVZCML is not the same as ZPT when it comes to internationalisation
p12612
aV:-)
p12613
as(dp12614
g16
V100297
p12615
stp12616
a((dp12617
g2
(lp12618
VDo not specify a  header,  calculates it for you
p12619
aVAs it is, your header specifies the wrong length:
p12620
aVWithout that header the rest of the posted code works fine for me
p12621
as(dp12622
g16
V100297
p12623
stp12624
a((dp12625
g2
(lp12626
VThe number you see is a UNIX timestamp, and represents the number of seconds since the epoch, the 1st of January 1970
p12627
aVYou could use  to turn that into a python datetime object for example:
p12628
aVNote that  returns a named tuple; you can access the properties on that tuple by name too:
p12629
aVSee the  documentation for all the attributes that are available
p12630
aVYou, on the other hand, accessed the  value instead; python tuples and list indexes start at 0, so the 9th element is index 8
p12631
aVYou accessed index 10, the creation time of the files
p12632
aVIf all you need is the modified time of a file, you can also use  as a convenient shortcut:
p12633
aVWhen copying a file, it's properties such as last-modification timestamp are usually included, thus the modified time of the newly copied file could easily change, both backwards and forwards
p12634
aVThe same applies to the creation time
p12635
as(dp12636
g16
V100297
p12637
stp12638
a((dp12639
g2
(lp12640
VThe  keyword specifies a dictionary to use for the global and local namespaces
p12641
aVFrom the python 2 documentation for :
p12642
aVIn all cases, if the optional parts are omitted, the code is executed in the current scope
p12643
aVIf only the first expression after  is specified, it should be a dictionary, which will be used for both the global and the local variables
p12644
aVThe python 3 equivalent is thus
p12645
as(dp12646
g16
V100297
p12647
stp12648
a((dp12649
g2
(lp12650
VThe end value is always exclusive, thus the 0 end value means include index 1 but not 0
p12651
aVUse None instead (since negative numbers have a different meaning):
p12652
aVNote the start value as well; the last character index is at
p12653
as(dp12654
g16
V100297
p12655
stp12656
a((dp12657
g2
(lp12658
VA list comprehension is easiest:
p12659
aVNote that you cannot name a variable ; I used  instead
p12660
aVThe above assumes characters 3 through to 6 are always the year in your values
p12661
as(dp12662
g16
V100297
p12663
stp12664
a((dp12665
g2
(lp12666
VYou need to put quotes around the whole value, including the ampersand, as it is a special shell character
p12667
aVAlternatively, you can escape just the ampersand by putting a backslash in front of it:
p12668
aVThe ampersand signals to the shell you want to put the command up to that point in background mode
p12669
aVAny of the following characters are special in a shell:
p12670
aVThese need to be escaped in the same way; use a backslash or put quotes around the value
p12671
as(dp12672
g16
V100297
p12673
stp12674
a((dp12675
g2
(lp12676
VShort, short, short answer: Nope
p12677
aVLonger answer: It depends on your application whether or not whitespace is significant
p12678
aVIf you indent your XML file you add whitespace which sometimes has meaning to the application processing the data contained
p12679
aVBut for parsing the XML file
p12680
aVWhitespace does not influence the parse-ability, no
p12681
aVSee the whitespace handling section of the XML specification
p12682
as(dp12683
g16
V100297
p12684
stp12685
a((dp12686
g2
(lp12687
VYour string is encoded using the Quoted-printable format for MIME headers
p12688
aVThe  module handles this for you:
p12689
as(dp12690
g16
V100297
p12691
stp12692
a((dp12693
g2
(lp12694
VJust create an inverted mapping:
p12695
aVNote that the above code handles duplicate values;  returns a list of keys that hold that value
p12696
aVIf your values are also unique, a simple dict can be used instead of :
p12697
aVor, in python 3, where  is a dictionary view:
p12698
as(dp12699
g16
V100297
p12700
stp12701
a((dp12702
g2
(lp12703
VThe  character is the proper encoding for a space when quoting GET or POST data
p12704
aVThus, a literal  character needs to be escaped as well, lest it be decoded to a space on the other end
p12705
aVSee RFC 2396, section 2
p12706
aV2, section 3
p12707
aV4 and the HTML specification,  section:
p12708
aVControl names and values are escaped
p12709
aVSpace characters are replaced by `+', and then reserved characters are escaped as described in [RFC1738], section 2
p12710
ag5740
aVIf you are posting data to an application that does not decode a  character to a space but instead treats such data as literal plus signs instead, you need to encode your parameters yourself using the  function instead, specifying that the  character is not to be encoded:
p12711
aVDemo:
p12712
aVWhen using , you can simply pass in the result of the above function as the  value, but in that case you need to manually set the content type:
p12713
as(dp12714
g16
V100297
p12715
stp12716
a((dp12717
g2
(lp12718
VYou need to separate the arguments when using :
p12719
aVnormally does not treat your command like the shell does, and it won't parse it out into the separate arguments
p12720
aVSee frequently used arguments for the full explanation
p12721
aVIf you must rely on shell parsing of your command, set the  keyword argument to :
p12722
aVNote that I changed your test to  to be clearer about the possible return values
p12723
aVThe  test happens to work for small integers due to an implementation detail in the Python interpreter, but is not the correct way to test for integer equality
p12724
as(dp12725
g16
V100297
p12726
stp12727
a((dp12728
g2
(lp12729
VThe  module comes in both a python-only and a C variant (called )
p12730
aVAs such, the  method needs to be callable from Python code
p12731
aVThus, you need to provide a  entry in your C object  struct with a suitable implementation
p12732
aVAlternatively, you can also register a pickling function with the  module
p12733
aVThis module's original usecase was to support extension modules better; the source code for the module states:
p12734
aVThis is only useful to add pickle support for extension types defined in C, not for instances of user-defined classes
p12735
as(dp12736
g16
V100297
p12737
stp12738
a((dp12739
g2
(lp12740
VIt's perfectly normal to factor out common code into a (private) helper method:
p12741
aVThe method could return a value, or it could directly manipulate the attributes on
p12742
aVA word of advice: read the Python style guide and stick to it's conventions
p12743
aVMost other python projects do, and it'll make your code easier to comprehend for other Python developers if you do
p12744
as(dp12745
g16
V100297
p12746
stp12747
a((dp12748
g2
(lp12749
VYou take the built-in function :
p12750
aVFrom the documentation:
p12751
aVSums  and the items of an iterable from left to right and returns the total
p12752
aVdefaults to
p12753
aVThe iterable\u2018s items are normally numbers, and the  value is not allowed to be a string
p12754
aVIf the user input is in the form of strings, you need to turn those into integers first
p12755
aVA generator expression could do that for you:
p12756
as(dp12757
g16
V100297
p12758
stp12759
a((dp12760
g2
(lp12761
VYou do need to give your encoded  parameter to the  command:
p12762
aVotherwise you will create another GET request instead of POSTing
p12763
as(dp12764
g16
V100297
p12765
stp12766
a((dp12767
g2
(lp12768
VYou are committing every single row
p12769
aVDon't do that, commit when all rows have been updated
p12770
aVFor the  counter, you can use an infinite generator; the  function will generate the numbers 0 through to 100 for you, starting back at 0 endlessly:
p12771
as(dp12772
g16
V100297
p12773
stp12774
a((dp12775
g2
(lp12776
VJust use
p12777
aVstrip(), it removes all whitespace for you, including tabs and newlines, while splitting
p12778
aVThe splitting itself can then be done with :
p12779
aVOutput:
p12780
aVYou can even inline the splitting on  as well now:
p12781
as(dp12782
g16
V100297
p12783
stp12784
a((dp12785
g2
(lp12786
VYour header line is not using tabs
p12787
aVWhen I recreate your data without tabs, the line returned by the  module contains just one (long) key
p12788
aVIf I recreate it with actual tabs, then I get:
p12789
aVNote that the values do not need stripping; the module takes care of extraneous whitespace for you
p12790
aVYou can read your header separately, clean that up, then deal with the rest of your data with the  module:
p12791
aVThe above code reads the header line separately, splits it and removes the extra  periods for you to make for more workable column keys, then sets the file up for the  by resetting the readline buffer (a side-effect of the  call)
p12792
as(dp12793
g16
V100297
p12794
stp12795
a((dp12796
g2
(lp12797
VTest for the return value before trying to retrieve the first match:
p12798
aVAlternatively, set  to an empty string or the first value on a single line:
p12799
as(dp12800
g16
V100297
p12801
stp12802
a((dp12803
g2
(lp12804
VThe lock file is created by gnupg, not the python wrapper, and it is always created in the GNUPGHOME path, defaulting to
p12805
aVYou cannot prevent the lockfile, but you can set the directory to a temporary one
p12806
aVThe disadvantage is that it'll not be able to load the default keyring so you'll need to pass it in explicitly, telling GNUPG to ignore the default file (it'll complain bitterly if you do not):
p12807
aVIn fact, I've gone a far as using a temporary file for the keyring as well; use the  function to create an empty file in the temporary directory generated above, import the key (drawn from a database) into that keyring (using ) then use the imported key to do the encryption, before cleaning up the whole temporary home
p12808
as(dp12809
g16
V100297
p12810
stp12811
a((dp12812
g2
(lp12813
VYou execute a query with formatting parameters but never pass these in; the  part goes outside of the SQL query:
p12814
aVYou would be better off using SQL parameters however, so the database can prepare the query and reuse the query plan:
p12815
aVPyODBC uses  for SQL parameters
p12816
as(dp12817
g16
V100297
p12818
stp12819
a((dp12820
g2
(lp12821
VYou cannot use  statements in Mako templates
p12822
aVAt all
p12823
aVThis is because a Mako template is compiled to a python file, and in order for this to work it sets up some initial structures at the top of that python file:
p12824
aVOnly after this initial setup is any code from the template itself included
p12825
aVYour  will never be placed first
p12826
aVYou can still use floating point division by casting either operand of the  division operator to a float:
p12827
aVAs long as you follow that workaround you can do fine without the  future import
p12828
as(dp12829
g16
V100297
p12830
stp12831
a((dp12832
g2
(lp12833
VThat is actually not correct
p12834
aVName mangling takes place at class creation time; any functions that refer to mangled names are adjusted as well
p12835
aVI cannot reproduce your example, at least not in Python versions 2
p12836
aV4, 2
p12837
aV5, 2
p12838
aV6, 3
p12839
aV1 and 3
p12840
aV2 on the Mac:
p12841
aVIf you disassemble the function bytecode you can see the name has been mangled as well:
p12842
aVI've checked the compiler source and all names are run through the mangler, a code path that has remained the same since  2002 at least
p12843
aVAnd yes, class attributes and instance attributes are the correct terms
p12844
aVClass attributes are always shared, but assignment to an attribute on an instance assigns to the instance
p12845
aVMutating a list or other mutable objects is not the same as attribute assignment
p12846
as(dp12847
g16
V100297
p12848
stp12849
a((dp12850
g2
(lp12851
VYou call the function recursively when , but don't do anything with the return value:
p12852
aVThe  branch is never executed then, so  is returned instead
p12853
aVYou probably want to return the result of the recursive call:
p12854
aVSome further tips:
p12855
aVThere is no need to test for  in an  statement, the following will work just fine:
p12856
aVYou can return the test in  is itself a boolean result, just return that without testing:
p12857
as(dp12858
g16
V100297
p12859
stp12860
a((dp12861
g2
(lp12862
VUse the  module to run external commands:
p12863
as(dp12864
g16
V100297
p12865
stp12866
a((dp12867
g2
(lp12868
VUse the  attribute of the response:
p12869
aVI've posted the downloaded image as multipart-encoded POST with the field-name
p12870
aVIt depends on the exact application you are posting to what fieldname they expect
p12871
as(dp12872
g16
V100297
p12873
stp12874
a((dp12875
g2
(lp12876
VMake it a list:
p12877
aVotherwise the list adds each element (e
p12878
ag1298
aVeach character) of the string separately
p12879
aVAlternatively, you can call  on  and modify that list in-place:
p12880
aVThis is all standard python list manipulation and is independent of the contents; it doesn't matter if there are unicode objects or custom objects in that list
p12881
as(dp12882
g16
V100297
p12883
stp12884
a((dp12885
g2
(lp12886
VIt's just an anonymous variable, and has no special meaning to python
p12887
aVCompare it with using  as a loop counter
p12888
aVYou generally use it to document that the surrounding code is going to ignore the value of that variable
p12889
aVIn the python interactive console, the result of the last expression is assigned to , but that does not carry through in python programs
p12890
as(dp12891
g16
V100297
p12892
stp12893
a((dp12894
g2
(lp12895
V is a function in Python 3:
p12896
aVI fixed your  newline escape code for you as well
p12897
aVYou probably want to use the  method to format your output:
p12898
as(dp12899
g16
V100297
p12900
stp12901
a((dp12902
g2
(lp12903
VJSON is a strict textual format
p12904
aVYou cannot just throw SQLAlchemy at the encoder and expect this to Just Work, you need to decide what the encoding for your objects will look like
p12905
aVOne way is for your SQLAlchemy objects to implement an extra method that returns a simple python dictionary; one that can be serialized
p12906
aVThat means it can only use strings for keys, and can only contain lists, tuples, numbers and / or strings
p12907
aVAn example method could be:
p12908
aVThis returns a dictionary with  and  keys, where the  key contains a list of phone numbers from a (purely made up for example purposes) phonenumbers relationship
p12909
aVYou can then use that information to create a new list of dictionaries that  can handle:
p12910
aVThe upcoming Pyramid 1
p12911
aV4 adds specific support for serializing custom objects in the  renderer via the  method hook, as well as support for adapters to do the conversion for you
p12912
as(dp12913
g16
V100297
p12914
stp12915
a((dp12916
g2
(lp12917
VThat's an error in the documentation, inserted by someone applying a new Python 3 feature to places where it shouldn't be used
p12918
aVIt has since been fixed (see issue 15831)
p12919
aVThe function signatures in the document used is given in a psuedo-formal-grammar form, but adding in the  marker only makes sense if you use actual python syntax
p12920
aVThe  part of the signature should have been listed as  instead in that case
p12921
aVThe corrected version now reads:
p12922
aVThe online development version of the documentation has as of now not yet been updated, but the documentation source has been corrected; I'll see if we can request a regeneration of the docs
p12923
aVTo be clear: the  syntax is valid in Python 3 and means that the following arguments can only ever be used as keyword arguments, not positional arguments
p12924
aVThis does however not apply to the  function, as all positional arguments are to be printed anyway and could never be mistaken for the keyword arguments
p12925
as(dp12926
g16
V100297
p12927
stp12928
a((dp12929
g2
(lp12930
VThe easiest method is to use the  module; it includes an (internal) timezone parser that handles almost your format; we need to insert a  to follow make it match ISO 8601 timezones:
p12931
as(dp12932
g16
V100297
p12933
stp12934
a((dp12935
g2
(lp12936
VIt's a python dictionary literal, combined with a lookup using  as a key:
p12937
as(dp12938
g16
V100297
p12939
stp12940
a((dp12941
g2
(lp12942
VThe  decorator only works with new-style classes; that is to say, classes that inherit from
p12943
aVAcquisition (which gives you access to the global  object via attribute access) on the other hand is very much 'old-skool' python and the two do not work well together, as  ignores acquisition wrappers, which are needed to acquire the  object
p12944
aVZope has it's own -like method that pre-dates new-style classes and the  decorater, called , which actually predates the  decorator and new-style classes by many years
p12945
aVA -wrapped function does know how to behave with an -wrapped object, though
p12946
aVYou can use  much like the  decorator:
p12947
aVThe  wrapper function also can be configured with a level of wrapping, which is what we need when dealing with Acquisition wrappers
p12948
aVYou cannot use the  as a decorator in that case:
p12949
aVIt is easy enough to define a new function to do the decorating for us though:
p12950
aVStick this in a utility module somewhere, after which you can then use it as a callable decorator to mark something as an Acquisition-aware property:
p12951
aVNote that unlike ,  can only be used for getters; there is no support for setters or deleters
p12952
as(dp12953
g16
V100297
p12954
stp12955
a((dp12956
g2
(lp12957
VYou can use the  elements you matched as the starting point, you can simply iterate over them like you would with a python list:
p12958
aVThe above uses  to grab all contained  elements, but you could use further  calls if you need more control
p12959
as(dp12960
g16
V100297
p12961
stp12962
a((dp12963
g2
(lp12964
VYou can slice your string to only select the first 19 characters:
p12965
aVThis let's you parse the date without having to bother with the microseconds and timezone
p12966
aVDo note that you probably do want to parse the timezone too though
p12967
aVYou can use the  module to handle the whole format, without the need to slice:
p12968
aVThe  module is written in pure python and works without problems on the Google App Engine
p12969
as(dp12970
g16
V100297
p12971
stp12972
a((dp12973
g2
(lp12974
VYou already have a unicode string, there is no need to decode it to a unicode string again
p12975
aVWhat happens in that case is that python helpfully tries to first encode it for you, so that you can then decode it from
p12976
aVIt uses the default encoding to do so, which happens to be ASCII
p12977
aVHere is an explicit encode to show you the exception raised in that case:
p12978
aVIn short, when you have a unicode literal like , there is no need to decode it
p12979
aVRead up on the unicode, encodings, and default settings in the Python Unicode HOWTO
p12980
aVAnother invaluable article on the subject is Joel Spolsky's Minimun Unicode knowledge post
p12981
as(dp12982
g16
V100297
p12983
stp12984
a((dp12985
g2
(lp12986
VIf you want to avoid a regular expression, you can use a generator expression that tests each combination (generated via ):
p12987
aVNote that this is far slower than the regular expression approach, especially when hitting the worst-case scenario (no match):
p12988
aVThe generator expression is 10 times slower than the regular expression approach
p12989
aV(I used a  compiled regular expression for the test)
p12990
as(dp12991
g16
V100297
p12992
stp12993
a((dp12994
g2
(lp12995
VYour  is going to overwrite values every loop
p12996
aVIf all your entries in  are directories, for example, you'll end up with removing entries from  as you loop over each subdir:
p12997
aVYou want to use  instead when adding items to the end of your list
p12998
aVNote that on Windows, you don't have to use backslashes as path separators, it's better to use forward slashes, as these do not have special meaning in Python strings:
p12999
aVAlternatively, use  raw string literals to remove the chance backslashes are interpreted as character escapes:
p13000
as(dp13001
g16
V100297
p13002
stp13003
a((dp13004
g2
(lp13005
VThe  call is a cheaper call; it looks up the user id from the request without going through the whole authentication process again
p13006
aVThe key concept there is the word again
p13007
aVYou should only use the method in views that have already been authorized
p13008
aVIn other words, by the time you reach code that uses  you've already verified the user, and specifically do not want to do this again for this particular call
p13009
aVAuthenticating users against a backend persistent storage can be expensive, especially if such a storage doesn't support caching
p13010
aVThe  API method is an optimization where the request is basically your  cache
p13011
as(dp13012
g16
V100297
p13013
stp13014
a((dp13015
g2
(lp13016
VYou are creating a list with 10 references to the same empty list
p13017
aVYou should use a list comprehension instead:
p13018
aVIn a list comprehension, you create a new list for every iteration through the loop
p13019
aVIf you are using python 2, you should use  instead of  (although with only 10 elements that won't make much difference)
p13020
as(dp13021
g16
V100297
p13022
stp13023
a((dp13024
g2
(lp13025
VDon't use a template to render JSON; use pyramid's built-in JSON renderer instead:
p13026
aVYou probably want to apply the JSON conversion method we discussed in your other question to  here though; the last line would then be:
p13027
aVSee the pyramid renderer documentation
p13028
as(dp13029
g16
V100297
p13030
stp13031
a((dp13032
g2
(lp13033
VTry committing your changes:
p13034
as(dp13035
g16
V100297
p13036
stp13037
a((dp13038
g2
(lp13039
VCPython uses reference counting to track object lifetimes
p13040
aVThus, all deletions are done by the garbage collector
p13041
aVFor example, the following code creates two references; the  hook only is called once, after the second reference to the object is deleted:
p13042
aVThus, there is no way to detect an individual  statement through the  hook; it is always only called by the garbage collector
p13043
aVNote that certain python implementations (most notably cpython), do not clear objects with a  hook that are part of a circular dependency
p13044
aVThis does not apply to all implementations, but it bears remembering
p13045
aVIn any case, the use of reference counting to implement object deletion and garbage collection is itself an implementation detail, and non-CPython implementations could (and do) handle object deletion differently altogether
p13046
as(dp13047
g16
V100297
p13048
stp13049
a((dp13050
g2
(lp13051
VYou need to use  instead of  when subclassing , see basic customization
p13052
aVYour code doesn't override , so the original  constructor is called with your two arguments, and it only accepts one
p13053
aVobjects are immutable, they construct a new instance in , which then cannot be changed anymore; by the time  is called,  is an immutable object, so  for  doesn't make sense
p13054
aVYou can still also define an  method, but since you already have , there is really no need to divide the work up across two methods
p13055
as(dp13056
g16
V100297
p13057
stp13058
a((dp13059
g2
(lp13060
VThe  file is not inteded as a Flask config file; it is meant to be used with the  command line tool only:
p13061
aVRemove the  line from your
p13062
aVThe Flask example at the top of the Flask Babel documentation happens to use  but your project already loads it's Flask configuration using
p13063
as(dp13064
g16
V100297
p13065
stp13066
a((dp13067
g2
(lp13068
VThe expression  creates one potentially very long string
p13069
aVUse
p13070
aVinstead
p13071
aVBut the  call itself is never reached, as you  statement is testing the wrong thing; change it to:
p13072
aVis aready a number (the length of the longest list); asking that number for it's length is not what you were looking for
p13073
as(dp13074
g16
V100297
p13075
stp13076
a((dp13077
g2
(lp13078
VYou can pass in your list by using the  syntax:
p13079
aVAlternatively, you could detect if your first argument passed in is a sequence and use that instead of the whole  tuple:
p13080
as(dp13081
g16
V100297
p13082
stp13083
a((dp13084
g2
(lp13085
VYou want to return your  value; printing it to the console won't help in a web application:
p13086
aVThe parenthesis around  are meaningless noise, btw, they are not needed in Python and are in this case ignored by the parser
p13087
aVI'm assuming you are doing something meaningful with the  value in the view; otherwise using  on the value is a little pointless
p13088
aVYou can also use the  method to have the value converted for you:
p13089
aVNow  will be set to an integer, or  if the field is not present in the form or cannot be converted to an integer
p13090
as(dp13091
g16
V100297
p13092
stp13093
a((dp13094
g2
(lp13095
VThe  calling convention is documented in the Expressions reference:
p13096
aVIf the syntax  appears in the function call,  must evaluate to an iterable
p13097
aVElements from this iterable are treated as if they were additional positional arguments; if there are positional arguments x1,
p13098
aV, xN, and  evaluates to a sequence y1,
p13099
aV, yM, this is equivalent to a call with M+N positional arguments x1,
p13100
aV, xN, y1,
p13101
aV, yM
p13102
aVSo, since you used  as the expression, which is an iterable, and there were no other positional arguments, it is treated as a call with M=0 and N=4, for a total of 4 positional arguments
p13103
aVYou can thus also call your function as  or any other combination of iterable and positional arguments, provided the iterable comes after the positionals
p13104
as(dp13105
g16
V100297
p13106
stp13107
a((dp13108
g2
(lp13109
VYou can force  to compile messages marked as fuzzy with the  (or ) command line switch:
p13110
aVFuzzy' messages are marked with a  line above the  line, and are the result of a merge where a message is deemed slightly changed from the previous version
p13111
aVA message marked as  is supposed to be looked at by a human to make sure the translation doesn't need updating, after which the human translator removes that flag
p13112
as(dp13113
g16
V100297
p13114
stp13115
a((dp13116
g2
(lp13117
VShorter method with a list comprehension:
p13118
as(dp13119
g16
V100297
p13120
stp13121
a((dp13122
g2
(lp13123
VYou cannot use sets to do this, because a set has no ordering; thus Python wouldn't know which value was the  and which , for example
p13124
aVYou can return a tuple though:
p13125
aVDemo:
p13126
as(dp13127
g16
V100297
p13128
stp13129
a((dp13130
g2
(lp13131
VI'd use a regular expression:
p13132
aVThis outputs integers:
p13133
as(dp13134
g16
V100297
p13135
stp13136
a((dp13137
g2
(lp13138
VYes, define your unicode data as unicode literals:
p13139
aVYou usually want to use '\u005cuxxxx` unicode escapes or set a source code encoding
p13140
aVThe following line at the top of your module, for example, sets the encoding to UTF-8:
p13141
aVRead the Python Unicode HOWTO for the details, such as default encodings and such (the default source code encoding, for example, is ASCII)
p13142
aVAs for your specific example, your title is not a Unicode literal but a python byte string, and python is trying to decode it to unicode for you just so you can encode it again
p13143
aVThis fails, as the default codec for such automatic encodings is ASCII:
p13144
aVEncoding only applies to actual unicode strings, so a byte string needs to be explicitly decoded:
p13145
aVIf you are used to Python 3, then unicode literals in Python 2 () are the new default string type in Python 3, while regular (byte) strings in Python 2 () are the same as  objects in Python 3 ()
p13146
aVIf you have errors both with and without the encode call on , you have mixed data
p13147
aVTest the title and encode as needed:
p13148
aVYou may want to find out what produces the mixed unicode / byte string titles though, and correct that source to always produce one or the other
p13149
as(dp13150
g16
V100297
p13151
stp13152
a((dp13153
g2
(lp13154
VIf you want to use , then create a list for your string variable before multiplying:
p13155
as(dp13156
g16
V100297
p13157
stp13158
a((dp13159
g2
(lp13160
VThe server you connected to did not send a proper HTTP response line
p13161
aVSuch a response should consist of a number followed by a human-readable textual description, like:
p13162
aVor
p13163
aVYou need to verify what the server on port 8021 sends
p13164
aVTry using  from the terminal, then entering something like  plus two newlines to see what is returned by the server
p13165
aVI note that your  string is empty; it may be your server expects at least the empty path ()
p13166
aVHowever, not sending a properly formatted error code in that case is still a violation of the HTTP standard
p13167
as(dp13168
g16
V100297
p13169
stp13170
a((dp13171
g2
(lp13172
VTo read a file line by line, just loop over the open file object in a  loop:
p13173
aVTo split a line by whitespace into a list of separate words, use :
p13174
aVTo count the number of items in a python list, use :
p13175
aVTo select the first two items from a python list, use slicing:
p13176
aVI'll leave constructing the complete program to you, but you won't need much more than the above, plus an  statement to see if you already have your two words
p13177
aVThe three extra bytes you see at the start of your file are the UTF-8 BOM (Byte Order Mark); it marks your file as UTF-8 encoded, but it is redundant and only really used on Windows
p13178
aVYou can remove it with:
p13179
aVYou may want to decode your strings to unicode using that encoding:
p13180
aVYou could also open the file using :
p13181
aVNote that  will not strip the BOM for you; the easiest way to do that is to use :
p13182
as(dp13183
g16
V100297
p13184
stp13185
a((dp13186
g2
(lp13187
VThe thread identifier is not an auto-incrementing number
p13188
aVInstead, it is a unique number for that thread, and it is going to be a non-zero integer between  and ,
p13189
aVThe identifier is a 'magic cookie' value
p13190
aVYou don't need to care about it's actual value, just that it'll uniquely identify the current thread
p13191
as(dp13192
g16
V100297
p13193
stp13194
a((dp13195
g2
(lp13196
VUse the  method:
p13197
as(dp13198
g16
V100297
p13199
stp13200
a((dp13201
g2
(lp13202
VThe  project would be the obvious place to start; the following example starts a simple FTP server that authenticates users against a password file but also allows anonymous access
p13203
aVYou can easily expand from there
p13204
aVHow you implement 'files' and 'directories' is completely up to you
p13205
as(dp13206
g16
V100297
p13207
stp13208
a((dp13209
g2
(lp13210
VYou are defining column names with spaces as well as using  dashes and  slashes
p13211
aVPut such names in double quotes:
p13212
aVFirebird adheres quite strictly to the ANSI SQL standard, see Interbase/Firebird identifiers for detailed rules on what identifiers you can define with and without quoting
p13213
as(dp13214
g16
V100297
p13215
stp13216
a((dp13217
g2
(lp13218
VThere is an open pull request on the pyflakes issue tracker that includes a patch for this issue; you could download the patched version from GitHub, or apply the patch manually
p13219
as(dp13220
g16
V100297
p13221
stp13222
a((dp13223
g2
(lp13224
VYou need to capture the number, by putting it in a regular expression group:
p13225
aVWithout the  group, Django does not know about the captured number and cannot pass it to your view
p13226
aVSee the URL Dispatch documentation:
p13227
aVTo capture a value from the URL, just put parenthesis around it
p13228
as(dp13229
g16
V100297
p13230
stp13231
a((dp13232
g2
(lp13233
VIn python, subtracting two  objects results in a  object, which has a  attribute
p13234
aVTurning the number of days difference into years and months is not clearly defined; if you define a year as 365 days and a month as 30 days, you could use:
p13235
aVOr, you could define average year and month lengths to be (slightly) more accurate:
p13236
aVWith the latter calculation, your second difference comes out as 11 years and 3 months
p13237
as(dp13238
g16
V100297
p13239
stp13240
a((dp13241
g2
(lp13242
VSimulate a Python interactive session; blocks that start with  are automatically treated as Python source code:
p13243
as(dp13244
g16
V100297
p13245
stp13246
a((dp13247
g2
(lp13248
V relies on your package setup
p13249
aVpy, so if your package has dependencies, list those in the   list
p13250
aVOnly list those dependencies in your buildout configuration to pin the versions in a  section
p13251
aVSo, installing a simple egg  that depends on  and :
p13252
aVwhere  for the  egg has a  entry
p13253
aVBuildout will take care of installing  and  for you, without those explicitly being listed
p13254
aVPinning version numbers:
p13255
as(dp13256
g16
V100297
p13257
stp13258
a((dp13259
g2
(lp13260
VThe script creates a full distribution from scratch, by checking out the supplied Subversion URL into a temporary directory, then run the buildout configuration file in that directory, named by the second parameter
p13261
aVAlternatively, instead of a Subversion repository, it could just copy the directory structure pointed at by a file URL; the latter is a stop-gap measure to support more than just SVN repositories
p13262
aVYou create a working copy of your Git project, for example, then point to it with a  URL
p13263
aVThe script builds a fully stand-alone copy of your buildout
p13264
aVIn order to do so, it has to create an empty cache and fill that by letting the recipes do their work
p13265
aVLater on, the install script reuses that cache to run the installation
p13266
aVAlso, recipes use their own means of checking the cache and downloading resources, buildout does not maintain it on behalf of the recipes
p13267
aVThus, there is currently no mechanism in place for the script to determine if anything could be re-used from the existing cache
p13268
as(dp13269
g16
V100297
p13270
stp13271
a((dp13272
g2
(lp13273
VUsing  is not sufficient to test for a valid IRI
p13274
aVUse the  package instead:
p13275
as(dp13276
g16
V100297
p13277
stp13278
a((dp13279
g2
(lp13280
VYou'd need to upgrade your Ubuntu installation to precise (version 0
p13281
aV10
p13282
aV6) or to quantal (version 0
p13283
aV10
p13284
aV11)
p13285
aVOlder Ubuntu releases do not get new versions of packages;  is also not part of the Ubuntu backports packages
p13286
aVI strongly advise you to use a virtualenv and install the latest bottle version in there with
p13287
aVUbuntu packages are not agile enough to follow the faster release cycles of many Python packages
p13288
as(dp13289
g16
V100297
p13290
stp13291
a((dp13292
g2
(lp13293
VThe old  is automatically cleared by Python, provided the modified date on the  file is newer
p13294
aVYou could manually delete all  files in a directory structure with:
p13295
aVand Python will re-create them as modules are imported
p13296
aVYou can also run:
p13297
aVto force a compilation
p13298
as(dp13299
g16
V100297
p13300
stp13301
a((dp13302
g2
(lp13303
VIf  is a file, you need to put the read pointer back to the beginning in each loop (using ), or just re-open the file
p13304
aVAlternatively, read all of  into a list first and loop over that list instead
p13305
aVFurther advice: use the  module for tab-separated data, and don't ever use blank -; always only catch specific exceptions
p13306
as(dp13307
g16
V100297
p13308
stp13309
a((dp13310
g2
(lp13311
VNo, python is flexible like that, it does not enforce what attributes you can store on user-defined classes
p13312
aVThere is a trick however, using the  attribute on a class definition will prevent you from creating additional attributes not defined in the  sequence:
p13313
as(dp13314
g16
V100297
p13315
stp13316
a((dp13317
g2
(lp13318
VTake a look at the  project; it let's you define an object-oriented 'schema' that is easily serializable to and from JSON
p13319
aVThen load these from JSON:
p13320
aVand  validates the data for you, returning a set of python objects that then can be acted upon
p13321
aVAlternatively, you'd have to create specific per-object handling to be able to turn Python objects into JSON structures and vice-versa
p13322
as(dp13323
g16
V100297
p13324
stp13325
a((dp13326
g2
(lp13327
VThe  module is your friend:
p13328
aVAlso see os
p13329
aVpath
p13330
aVisfile() to test if a given file is a regular file versus a directory
p13331
as(dp13332
g16
V100297
p13333
stp13334
a((dp13335
g2
(lp13336
VThe  package offers a  plugin for supervisor
p13337
aVmonitors memory usage for programs under supervisor control
p13338
aVYou configure  as a supervisor eventlistener:
p13339
aVThe above configuration sets memmon to restart any program under supervisor control if it exceeds 200MB memory usage
p13340
aVIt checks every 60 seconds
p13341
aVYou can configure memmon to monitor specific programs or program groups, setting limits for each
p13342
as(dp13343
g16
V100297
p13344
stp13345
a((dp13346
g2
(lp13347
VYour custom classes do not define what it means to be equal
p13348
aVIf you were to add a  method that tells python how to compare two instances, the  test would be able to find duplicates:
p13349
aVTo complement the method, you should add a  method as well:
p13350
aVIf your weatherdata objects don't change (are not mutable) after creation, you can add a  method and store your instances in a set instead of a list
p13351
aVUsing a set would speed up the  test
p13352
aVAn example  method would be:
p13353
as(dp13354
g16
V100297
p13355
stp13356
a((dp13357
g2
(lp13358
VYes, you can use the  module to decompress byte streams:
p13359
aVThe S3 key object is an iterator, so you can do:
p13360
as(dp13361
g16
V100297
p13362
stp13363
a((dp13364
g2
(lp13365
VOS X 10
p13366
aV7 and 10
p13367
aV8 come with Python 2
p13368
aV7 pre-installed; :
p13369
aVInstalling additional versions of python isn't prohibited however; the Python for Mac 2
p13370
ag4892
aV3 installer won't interfere with the system install or your Python 3 installation
p13371
as(dp13372
g16
V100297
p13373
stp13374
a((dp13375
g2
(lp13376
VNo, there is no difference between the two statements, both put the exact same object into your module namespace (), under the exact same name
p13377
aVThey go about it in slightly different ways but the end-result is the same
p13378
aVEssentially, the first does:
p13379
aVand the second comes down to
p13380
aVand in the end all you have is the  name bound to the  function
p13381
aVPersonally, I would not rename the function like that, I'd keep it as  and use , clearly communicating where the object comes from throughout the code, or I'd use
p13382
aVRenaming the object may make it easier to type for you, but may make it harder for you or others to grok later on when you revisit this code after months of absence
p13383
as(dp13384
g16
V100297
p13385
stp13386
a((dp13387
g2
(lp13388
VYou cannot access  while defining it
p13389
aVPython first evaluates the  dict literal before assigning it to
p13390
aVIn other words, while evaluating the  dict literal statement,  is not yet defined and thus cannot be accessed
p13391
aVDo this instead:
p13392
as(dp13393
g16
V100297
p13394
stp13395
a((dp13396
g2
(lp13397
VPlease upgrade your  package to version 1
p13398
aV3b4, versions before 1
p13399
aV3 are not compatible with Internet Explorer 9
p13400
as(dp13401
g16
V100297
p13402
stp13403
a((dp13404
g2
(lp13405
VYou create simple classes to hold your data instead of using nested lists:
p13406
aVThen document that your method returns a list of those
p13407
aVThe added advantage is that now you can add additional methods on these objects
p13408
aVAdd a  method for easy display
p13409
aVEtc
p13410
aVMost of all, you can document these entry objects far more clearly than you could document a nested structure of primitive types
p13411
as(dp13412
g16
V100297
p13413
stp13414
a((dp13415
g2
(lp13416
VYou can't
p13417
aVYou have two options: read the whole generator into a list, then sample from that list, or use a method that reads the generator one by one and picks the sample from that:
p13418
aVThis method adjusts the chance that the next item is part of the sample based on the number of items in the iterable so far
p13419
aVIt doesn't need to hold more than  items in memory
p13420
aVThe solution isn't mine; it was provided as part of another answer here on SO
p13421
as(dp13422
g16
V100297
p13423
stp13424
a((dp13425
g2
(lp13426
VYou could use  to parse such files:
p13427
as(dp13428
g16
V100297
p13429
stp13430
a((dp13431
g2
(lp13432
VUsing  writes to , it doesn't return a value
p13433
aVYou you want  to return the character sheet string to write it to a file, you'll need to just build that string instead
p13434
aVTo ease building the string, use a list to collect your strings:
p13435
as(dp13436
g16
V100297
p13437
stp13438
a((dp13439
g2
(lp13440
VYou need to turn your old  line into a string to append:
p13441
aVOr use a formatter:
p13442
aVbecause  only takes one item at a time
p13443
as(dp13444
g16
V100297
p13445
stp13446
a((dp13447
g2
(lp13448
VIt'll be easier to use iterate over your list:
p13449
aVThe use of the  statement ensures that the file is closed properly when the loop is done
p13450
aVUsing  let's us eliminate having to use a manual counter
p13451
aVNote that now your lines always have a  extra tab at the end
p13452
aVYou can use a  trick to grab 4 items at a time from your list and write those together with a :
p13453
aVHere I use  to take an item from the list 4 times each time we iterate over it, until the original list has been exhausted
p13454
aVTo make sure we have 4 items at the end no matter what the length of the list, we use an empty string as padding:
p13455
as(dp13456
g16
V100297
p13457
stp13458
a((dp13459
g2
(lp13460
VIf all you want to do is print, then you still have the keys; just print those too:
p13461
aVOutput:
p13462
as(dp13463
g16
V100297
p13464
stp13465
a((dp13466
g2
(lp13467
VA factory function is going to be much easier to understand
p13468
aVUse a dictionary to map codes to exception classes:
p13469
as(dp13470
g16
V100297
p13471
stp13472
a((dp13473
g2
(lp13474
VPass everything as a series of arguments to the  function:
p13475
aVThe  function will convert the result of  to a string for you
p13476
aVNote that you need to turn  (a string) into an integer first before you can subtract it from  though
p13477
as(dp13478
g16
V100297
p13479
stp13480
a((dp13481
g2
(lp13482
VUse the  library to access your S3 storage
p13483
aVYou still have to write your data to a (temporary) file first before you can send it though, as the stream writing methods have not yet been implemented
p13484
aVI'd use a context manager to work around that limitation:
p13485
aVUse it as a context managed file object:
p13486
as(dp13487
g16
V100297
p13488
stp13489
a((dp13490
g2
(lp13491
VFrom the list displays documentation:
p13492
aVWhen a list comprehension is supplied, it consists of a single expression followed by at least one  clause and zero or more  or  clauses
p13493
aVIn this case, the elements of the new list are those that would be produced by considering each of the  or  clauses a block, nesting from left to right, and evaluating the expression to produce a list element each time the innermost block is reached
p13494
aVThus, your expression can be rewritten as:
p13495
as(dp13496
g16
V100297
p13497
stp13498
a((dp13499
g2
(lp13500
VUse a  for ease of processing these entries:
p13501
as(dp13502
g16
V100297
p13503
stp13504
a((dp13505
g2
(lp13506
VYou have two  characters in there that are not meant to be formatting characters
p13507
aVYou need to double it to make Python ignore it:
p13508
as(dp13509
g16
V100297
p13510
stp13511
a((dp13512
g2
(lp13513
VJust append the lines to , instead:
p13514
aVEach lxml tree tag acts like a list, where any children are elements in the list
p13515
aVSimply appending new  objects makes them children of the tag you append them to
p13516
aVYou can then reach each element of that list by using indexing; the  index is the last element, allowing us to set it's text
p13517
aVThe above code outputs:
p13518
as(dp13519
g16
V100297
p13520
stp13521
a((dp13522
g2
(lp13523
VYour CSS file is a static file, and thus is not treated as a template
p13524
aVAll static resources are served as-is, without any processing
p13525
aVAll non-absolute URLs in a CSS file are relative to the location from where the CSS file has been loaded; if you use , the browser loads the image relative to your CSS file location
p13526
aVSince the CSS was loaded from , the image will be loaded from
p13527
aVAlternatively, if you referencing files from unusual locations (for example, images auto-generated by one of your views), you'll have to add your CSS file as a view instead, and render it with a (text) template
p13528
as(dp13529
g16
V100297
p13530
stp13531
a((dp13532
g2
(lp13533
VI'd:
p13534
aVconvert the list of timestamps to  objects:
p13535
aVUse the  module to find your start time the user requested
p13536
aVUsing  is a much faster method than using linear search, provided you translate the user input to  objects as well:
p13537
aVUse  functions to merge the two lists into one that shows entries that match your range:
p13538
aVThe  iterable now generates entries between  and  as  tuples, without using any extra memory for copied lists
p13539
aVThis let's you handle huge amounts of data efficiently
p13540
aVDemo:
p13541
as(dp13542
g16
V100297
p13543
stp13544
a((dp13545
g2
(lp13546
VThe Babel project offers a full-featured date and time localization library
p13547
aVYou'll also need the  module to parse a date-time string with a timezone correctly
p13548
aVIt either formats dates and times based on locale:
p13549
aVor it let's you specify the format in detail
p13550
aVThis includes formatting the timezone
p13551
aVPutting the parser and the formatter together:
p13552
aVOrdinals ('1st', '2nd', etc
p13553
aVare a little harder to do internationally, and the LDML format used by Babel doesn't include a pattern for these
p13554
aVIf you must have an ordinal in your date formatting (perhaps because you only expect to output in English), you'll have to create those yourself:
p13555
as(dp13556
g16
V100297
p13557
stp13558
a((dp13559
g2
(lp13560
VYour best bet would be to use the new  module instead
p13561
aVOne of it's features is that it can remove characters from a character set:
p13562
aVThe  syntax creates a character set that is the same as  with the underscore character removed from the matching characters
p13563
as(dp13564
g16
V100297
p13565
stp13566
a((dp13567
g2
(lp13568
VThe pip  option supports local directories
p13569
aVSimply put all your sdist and egg distributions into the one directory and pip will find them there
p13570
aVBinary distributions, I'd build as eggs (with ), for easy installation without the need to compile
p13571
as(dp13572
g16
V100297
p13573
stp13574
a((dp13575
g2
(lp13576
VThe default implementation of  limits the output to 12 digits only
p13577
aVThus, the least significant digits are dropped and what is left is the value 0
p13578
ag5740
aVTo print more digits (if available), use string formatting:
p13579
aVThat defaults to 6 digits, but you can specify more precision:
p13580
aVAlternatively, python offers a newer string formatting method too:
p13581
aVWhy python produces the 'imprecise' result in the first place has everything to do with the imprecise nature of floating point arithmetic
p13582
aVUse the  module instead if you need more predictable precision:
p13583
as(dp13584
g16
V100297
p13585
stp13586
a((dp13587
g2
(lp13588
VRun your flask app under a proper WSGI server capable of handling concurrent requests (perhaps gunicorn or uWSGI) and it'll work
p13589
aVWhile developing, enable threads in the Flask-supplied server with:
p13590
aVbut note that the Flask server is not recommended for production use
p13591
aVWhat happens is that using requests you are making a second request to your flask app, but since it is still busy processing the first, it won't respond to this second request until it is done with that first request
p13592
as(dp13593
g16
V100297
p13594
stp13595
a((dp13596
g2
(lp13597
VUse Base64:
p13598
aVIt'll be easy to turn that back to binary data later on with a simple  call
p13599
aVBase64 encodes to ASCII data safe for inclusion in XML, in a reasonably compact format; every 3 bytes of binary information become 4 Base64 characters
p13600
as(dp13601
g16
V100297
p13602
stp13603
a((dp13604
g2
(lp13605
VYour browser normally indeed uses the location of the current page as the basis for relative URLs, and your use of  simulates that behaviour correctly
p13606
aVHowever, if the HTML returned contains a  tag, the browser uses the url named by that tag as the basis for resolving relative URLs
p13607
aVThe  tag is part of the HTML head
p13608
aVYou'll need to parse the response of  to determine if there is such a tag, then use its value instead of the URL of the page instead to determine a relative URL
p13609
aVThe  link value itself could be relative, in which case you'd have to make that absolute first based on the document location
p13610
aVIn this particular case, the web page contains such a  tag:
p13611
as(dp13612
g16
V100297
p13613
stp13614
a((dp13615
g2
(lp13616
VIt works with both the  and  methods
p13617
aVis anchored to the start of the string, but you can still require that the whole string matches by including a  anchor
p13618
as(dp13619
g16
V100297
p13620
stp13621
a((dp13622
g2
(lp13623
VYou can control the Unix terminal more fully with the  library
p13624
aVThe library essentially lets you build a simple terminal GUI
p13625
aVIf you need more, take a look at Urwid as well
p13626
aVUrwid offers more complex GUI widgets for the discerning terminal GUI developer
p13627
aV:-)
p13628
as(dp13629
g16
V100297
p13630
stp13631
a((dp13632
g2
(lp13633
VThe  method sorts in-place and doesn't return anything
p13634
aVUse  instead if you want the sorted list returned and the original input list left untouched
p13635
as(dp13636
g16
V100297
p13637
stp13638
a((dp13639
g2
(lp13640
VYou could use the  "wildcard" positional parameter:
p13641
aVand call this as:
p13642
aVor
p13643
as(dp13644
g16
V100297
p13645
stp13646
a((dp13647
g2
(lp13648
VThe problem you see has nothing to do with Python
p13649
aVThe website itself seems to require something more than just a HEAD request
p13650
aVEven a simple telnet session results in the error:
p13651
aVTry adding some more headers; the  command line client does get a 200 response:
p13652
as(dp13653
g16
V100297
p13654
stp13655
a((dp13656
g2
(lp13657
VYou'd be better off creating a temporary directory, so that  can create the output file for you
p13658
aVIt is probably failing to operate because  creates the file, not just the filename
p13659
aVUse the following context manager, it'll clean up after you when done:
p13660
aVAlso, it would be far easier for you to pass in the arguments without the  switch and the command as a list
p13661
aVHere is the above context manager in action with the command split into a list:
p13662
aVThis way the shell cannot mis-interpret special characters in the  and  arguments
p13663
aVThe context manager provides the filename without creating it, but will still clean up after itself
p13664
as(dp13665
g16
V100297
p13666
stp13667
a((dp13668
g2
(lp13669
VTo preserve the DPI, you need to specify it when saving; the  attribute is not always preserved across image manipulations:
p13670
as(dp13671
g16
V100297
p13672
stp13673
a((dp13674
g2
(lp13675
V is not a valid character class, I think you meant to use  instead
p13676
aVYou can reduce the groups if you don't use them either
p13677
aVBut most of all, you need to extract your groups correctly:
p13678
aVBy creating only two capturing groups, we can more simply extract those two with  and directly assign them to two variables,  and
p13679
aVHowever, reading up on the FASTA format seems to indicate this is a multi-line format with the tag on one line, the gene data on multiple lines after that
p13680
aVIn that case your  was meant to match the newline
p13681
aVThis won't work as you read the file one line at a time
p13682
aVIt would be much simpler to read that format without regular expressions like so:
p13683
aVThis reads the file line by line, detecting tags based on the starting  character, then reads multiple lines of gene information collecting it into your dictionary under the most-recently read tag
p13684
aVNote the  mode; we open the file using python's universal newlines mode, to handle whatever newline convention was used to create the file
p13685
aVLast but not least; take a look at the BioPy project; their  module handles FASTA plus many other formats perfectly
p13686
as(dp13687
g16
V100297
p13688
stp13689
a((dp13690
g2
(lp13691
VYour errors are numerous, here are the ones I've found so far:
p13692
aVThe line  does not do what you think it does
p13693
aVPython does not have C casts, you need to call the  type instead:
p13694
aVYou compound this error later on by using an uppercase spelling of :
p13695
aVCorrect these in a similar manner:
p13696
aVand since the default for  is to split on whitespace you can leave out the  argument
p13697
aVBetter yet, combine them into one line:
p13698
aVYou never increment , so your  loop will continue forever, so you'll get an EOF error
p13699
aVUse a  loop instead:
p13700
aVYou don't need to use  anywhere in this function, they can all be replaced with  loops
p13701
aVPython strings have no  method
p13702
aVUse  instead:
p13703
aVbut since  is a boolean test, you can simplify your  instantiation like so:
p13704
aVThere is no need to initialize variables quite so much in Python
p13705
aVYou can get of most of the  and  lines, etc
p13706
aVif you are assigning a new value on a following line
p13707
aVYou create a 'myMapcls
p13708
aVmyMap` instead
p13709
aVThere is no handling of multible maps here; the last map in the file would overwrite any preceding map
p13710
aVRewritten version:
p13711
as(dp13712
g16
V100297
p13713
stp13714
a((dp13715
g2
(lp13716
VThere are three tricks that'll help you here:
p13717
aVLists can be compared just like strings and numbers
p13718
aVA list of integers can be compared to another and if the contained numbers are the same, the comparison returns :
p13719
aVYou can reverse a list easily
p13720
aVYou can use the  built-in function, or you can use the  slice notation to give a negative stride
p13721
aVThe latter gives you a reversed list too:
p13722
aVThe  function returns an iterator, by passing that to the  constructor we get a list again
p13723
aVYou can use the  operator to test list membership
p13724
aVUse this to test if an individual integer is part of a list of integers:
p13725
aVThese 3 tricks together should give you all the tools you need to re-program your script to work with integers
p13726
aVStore both your random numbers and the user input (turned to integers with the  function) in lists and work your way from there
p13727
aVIf you must accept one integer input between 10 and 99 things get a little trickier
p13728
aVYou can separate out the 10s and the 1s by using th modulo  and division  operators:
p13729
aVYou can combine the two operations using the  function:
p13730
aVNow you have two separate integers again to do your comparisons with
p13731
as(dp13732
g16
V100297
p13733
stp13734
a((dp13735
g2
(lp13736
VYou want to use a session:
p13737
aVYou use the session just like the  module (it has the same methods), but it'll retain cookies for you and send them along on future requests
p13738
as(dp13739
g16
V100297
p13740
stp13741
a((dp13742
g2
(lp13743
VYou are looking for the  function, I think:
p13744
aVTo convert a whole set of characters use a list comprehension:
p13745
aVIt's inverse is the  function:
p13746
as(dp13747
g16
V100297
p13748
stp13749
a((dp13750
g2
(lp13751
VYour filenames are byte strings that contain UTF-8 bytes representing unicode characters
p13752
aVThe HTML parser normally works with unicode data instead of byte strings, particularly when it encounters a ampersand escape, so Python is automatically trying to decode the value for you, but it by default uses  for that decoding
p13753
aVThis fails for UTF-8 data as it contains bytes that fall outside of the ASCII range
p13754
aVYou need to explicitly decode your string to a unicode object:
p13755
aVYour next problem will be that you now have unicode filenames, but your filesystem will need some kind of encoding to work with these filenames
p13756
aVYou can check what that encoding is with ; use this to re-encode your filenames:
p13757
aVYou can read up on how Python deals with Unicode in the Unicode HOWTO
p13758
as(dp13759
g16
V100297
p13760
stp13761
a((dp13762
g2
(lp13763
VFor  timezones, use their  method to turn a naive  object into one with a timezone:
p13764
aVFor timezones without a DST transition, the  method to attach a timezone to a naive  object should normally also work:
p13765
aVSee the localized times and date arithmetic of the pytz documentation for more details
p13766
as(dp13767
g16
V100297
p13768
stp13769
a((dp13770
g2
(lp13771
VYou are dealing with two files here
p13772
aVYou open  for writing in the current directory, but you rename the file
p13773
aVWhen opening , make sure you use the correct directory:
p13774
aVNote that on Windows, you can use the  separator as well, which is easier to deal with as you don't have to use raw strings or escape the slashes
p13775
aVAlso, it's better to use  to deal with directories and files:
p13776
aVthen work with  throughout the function
p13777
as(dp13778
g16
V100297
p13779
stp13780
a((dp13781
g2
(lp13782
VCertainly, it's not that hard either:
p13783
aVThe above expression selects any word that is preceded by some non-word characters (essentially whitespace or the start), is between 1 and 3 characters short, and ends on a word boundary
p13784
aVThe  boundary matches are important here, they ensure that you don't match just the first or last 3 characters of a word
p13785
aVThe  at the start lets you remove both the word and the preceding non-word characters so that the rest of the sentence still matches up
p13786
aVNote that punctuation is included in , use  if you only want to remove preceding whitespace
p13787
aVFor what it's worth, this regular expression solution preserves extra whitespace between the rest of the words, while mgilson's version collapses multiple whitespace characters into one space
p13788
aVNot sure if that matters to you
p13789
aVHis list comprehension solution is the faster of the two:
p13790
as(dp13791
g16
V100297
p13792
stp13793
a((dp13794
g2
(lp13795
VThe  has a  attribute; it's a sequence of tuples
p13796
aVEach tuple describes a column in the result and it's first value is the name
p13797
aVYou can use it to construct a dict of each row:
p13798
aVThe  attribute is described in more detail in the Python DB API 2
p13799
ag2391
as(dp13800
g16
V100297
p13801
stp13802
a((dp13803
g2
(lp13804
VUse :
p13805
as(dp13806
g16
V100297
p13807
stp13808
a((dp13809
g2
(lp13810
VWhen commenting out a  / , place a  in front of the :
p13811
aVThis makes for correct syntax without having to de-dent the inner block
p13812
aVYou could also add a  block after the commented :
p13813
aVYour only other option is to comment out the  line as well, and remove the indentation of the block:
p13814
aVYou cannot leave a bare  in place without an  or  block to complete it
p13815
as(dp13816
g16
V100297
p13817
stp13818
a((dp13819
g2
(lp13820
VI'd say that's a bug in lxml's URL handling, you should check for existing reports in the lxml tracker, and report it if it isn't there yet
p13821
aVThe work-around for now is to use  to retrieve your URL instead:
p13822
as(dp13823
g16
V100297
p13824
stp13825
a((dp13826
g2
(lp13827
VIn a UCS-2 build, python uses 2 bytes internally for each unicode character over  code point
p13828
aVRegular expressions need to work with those, so you'd need to use the following regular expression to match these:
p13829
aVThis regular expression matches any 2-byte UTF-16-encoded code point (see UTF-16 Code points U+10000 to U+10FFFF
p13830
aVTo make this compatible across Python UCS-2 and UCS-4 versions, you could use a / to use one or the other:
p13831
aVDemonstration on a UCS-2 python build:
p13832
as(dp13833
g16
V100297
p13834
stp13835
a((dp13836
g2
(lp13837
VUse :
p13838
aVWe split the string on the comma once, to save python the work of splitting on more commas
p13839
aVAlternatively, you can use :
p13840
aVDemo:
p13841
aVis the faster method:
p13842
as(dp13843
g16
V100297
p13844
stp13845
a((dp13846
g2
(lp13847
VStore the dict locally, update it with your extra info before returning:
p13848
aVI removed the  constructor in my example, it is entirely redundant
p13849
aVBut because all your keys are also valid python identifiers, you could define your dict in a slightly more compact manner by using the  constructor and keyword arguments:
p13850
as(dp13851
g16
V100297
p13852
stp13853
a((dp13854
g2
(lp13855
VYou'll need to use a query parameter:
p13856
aVthen pass in the value for  when executing the query:
p13857
aVIn python, you cannot simply just put a variable in between various strings and hope it interpolates
p13858
aVTo do regular string interpolation, use the  method:
p13859
aVbut then you'll miss out on the database query optimizer preparing your statement
p13860
aVPrepared statements are faster to execute if used repeatedly
p13861
as(dp13862
g16
V100297
p13863
stp13864
a((dp13865
g2
(lp13866
VFirst of all, Zope already has gettext-compatible i18n packages available for you, in the form of
p13867
aVThis is already part of Zope itself, no need to install it separately
p13868
aVSecondly, don't muck about with ; simply import the message factory into a module and name it
p13869
aVIn your Zope Product  you add a message factory for this:
p13870
aVNow you have a message id factory that can be imported into any of your project python files, including restricted files:
p13871
aVNote how we still use  as the local name in the code
p13872
aVYou register your message catalogs with a short amount of ZCML:
p13873
aVwhere  is a subdirectory of the directory the  file lives
p13874
aVexpects to find  and optionally,  files in the registered directory;  files are automatically compiled into  files for you as needed
p13875
aVZPT page templates use  message catalogs by default, see ZPT i18n support
p13876
aVIf you need to translate something manually, use the  function:
p13877
aVMost of the Plone i18n manual applies to generic Zope applications
p13878
aVIf you absolutely have to be able to poke things into , then by all means directly manipulate ; it's a dictionary:
p13879
as(dp13880
g16
V100297
p13881
stp13882
a((dp13883
g2
(lp13884
VYou can (again), best use :
p13885
aVThis will create a list of gene counts per site
p13886
aVDemonstration:
p13887
as(dp13888
g16
V100297
p13889
stp13890
a((dp13891
g2
(lp13892
VSimply cast to a string:
p13893
aVif  is a local variable that is an int
p13894
aVIf you need to use this in a join, have the database cast it to a string:
p13895
as(dp13896
g16
V100297
p13897
stp13898
a((dp13899
g2
(lp13900
VYou can do the same a little simpler with a :
p13901
aVUsing a  is faster than using , which would be the other option
p13902
as(dp13903
g16
V100297
p13904
stp13905
a((dp13906
g2
(lp13907
V just tests if the string  exists, and it does
p13908
aVThus, the  statement is never executed
p13909
aVYou need to capture the user input in a variable and test against that instead:
p13910
as(dp13911
g16
V100297
p13912
stp13913
a((dp13914
g2
(lp13915
VThese work for me (Sublime Text 2 v2
p13916
ag2391
aV1 on OS X 10
p13917
ag4892
aV5)
p13918
aV\u2318-\u2191: start of buffer
p13919
aV\u2318-\u2193: end of buffer
p13920
aVThe CMD-up and -down combos are the default shortcut for moving to the start and end of text buffers on OS X
p13921
aVThey work in Safari text areas, too, for example
p13922
aVAs such, they are not listed in the keymap file
p13923
as(dp13924
g16
V100297
p13925
stp13926
a((dp13927
g2
(lp13928
VYou can set the domain in the session plugin (controlling the  cookie)
p13929
aVGo to the ZMI via the Site Setup control panel:
p13930
aVFind the  folder:
p13931
aVInside of this folder is a  object:
p13932
aVThis in turn has a  tab:
p13933
aVOn that tab, there is a  field:
p13934
aVHere, fill in your  domain and hit
p13935
as(dp13936
g16
V100297
p13937
stp13938
a((dp13939
g2
(lp13940
VJust loop over the open file:
p13941
aVBecause you now use the file as an iterator, you can call the  function on the  variable at any time to retrieve an extra line
p13942
aVTwo extra tips:
p13943
aVDon't call your variable ; it masks the built-in  type object in python
p13944
aVI named it  instead
p13945
aVYou can use the open file as a context manager with the  statement
p13946
aVIt'll close the file for you automatically when done:
p13947
as(dp13948
g16
V100297
p13949
stp13950
a((dp13951
g2
(lp13952
VPython can 'intern' short strings; stores them in a special cache, and re-uses string objects from that cache
p13953
aVWhen then comparing strings, it'll first test if it is the same pointer (e
p13954
ag1298
aVan interned string):
p13955
aVOnly if that pointer comparison fails does it use a size check and  to compare the strings
p13956
aVInterning normally only takes place for identifiers (function names, arguments, attributes, etc
p13957
aVhowever, not for string values created at runtime
p13958
aVAnother possible culprit is string constants; string literals used in code are stored as constants at compile time and reused throughout; again only one object is created and identity tests are faster on those
p13959
aVFor string objects that are not the same, Python tests for equal length, equal first characters then uses the  function on the internal C strings
p13960
aVIf your strings are not interned or otherwise are reusing the same objects, all other speed characteristics come down to the  function
p13961
as(dp13962
g16
V100297
p13963
stp13964
a((dp13965
g2
(lp13966
VTo parse a phrase, use quotes around the phrase:
p13967
aVYou can simply put quotes around an existing query:
p13968
aVbut you probably have to remove existing quotes in the query to make this work
p13969
aVGoogle's documentation is silent on how to include quotes in your search queries
p13970
aVSo the complete, fail-safe method would be:
p13971
as(dp13972
g16
V100297
p13973
stp13974
a((dp13975
g2
(lp13976
VYou are missing a comma:
p13977
aVNote that this is on line 5 of your  module, but Python could only discover this on line 6 when it encountered something that doesn't fit after your  call
p13978
as(dp13979
g16
V100297
p13980
stp13981
a((dp13982
g2
(lp13983
VIf you need to peek ahead (read a few extra characters at a time), you need a buffered file object
p13984
aVThe following class does just that:
p13985
aVThis attempts to find extra characters beyond the one character you are reading, but doesn't make a guarantee it'll be able to satisfy your requirements
p13986
aVIt could read fewer if we are at the end of the file or if there is a lot of non-alphabetic text in the next block
p13987
aVUsage:
p13988
aVDemo, using a file with your example input:
p13989
aVTo use the  calls in a loop, where you get each and every character separately plus the two next 2 bytes, use the  with a sentinel:
p13990
as(dp13991
g16
V100297
p13992
stp13993
a((dp13994
g2
(lp13995
VIn a list, find the position of text with , then replace by using slice assignment:
p13996
aVThis will replace only one occurrence of  at a time
p13997
aVDemo:
p13998
aVTo replace all occurences, use  plus the length of  to skip searching past the previous match:
p13999
aVIf you need to loop over  while modifying it, use a copy instead:
p14000
as(dp14001
g16
V100297
p14002
stp14003
a((dp14004
g2
(lp14005
VYou could traverse the base classes using the  attribute of the class, looking for the property in each class' :
p14006
aVmro" stands for method resolution order, and is a list of the base classes in the order that python will look for methods and other class-defined attributes
p14007
aVScanning this list means you'll look up the property across the base classes in the same order Python would use
p14008
aVYour example code works correctly with the above code:
p14009
as(dp14010
g16
V100297
p14011
stp14012
a((dp14013
g2
(lp14014
VUse  instead:
p14015
aVIn each loop,  is the full path to the directory the filenames and dirnames are directly contained in
p14016
aVBy using  we extract the 'local' path, count the depth and use that for the number of tabs to prepend each filename with
p14017
as(dp14018
g16
V100297
p14019
stp14020
a((dp14021
g2
(lp14022
VYou need to use a unicode literal
p14023
aVIt'll be easier to use a unicode escape instead of the character:
p14024
aVWhat happens when you do not use a unicode literal but a byte (string) literal instead, is that Python tries to decode the value to a unicode literal using the default encoding, which is ASCII
p14025
aVThis results in the UnicodeDecodeError you saw
p14026
aVIf you really do want to use the unescaped character, make sure you specify the encoding of your source file at the top:
p14027
aVand make sure your editor uses UTF-8 to save the file
p14028
aVYou'd still have to use a unicode literal though:
p14029
as(dp14030
g16
V100297
p14031
stp14032
a((dp14033
g2
(lp14034
VIt is a chained assignment
p14035
aVYou set both  and  to the return value of
p14036
aVYou can chain assignments with abandon:
p14037
aVNote that the expression on the right-hand side only is evaluated once, and it's value is assigned to all the left-hand side variables from left to right
p14038
aVThis can most easily be seen if you decompiled the python bytecode:
p14039
aVcreates an extra reference to the value on the stack (), which is stored in , then  is given another duplicated reference, then the value is stored in
p14040
as(dp14041
g16
V100297
p14042
stp14043
a((dp14044
g2
(lp14045
VThe  call in  is incorrect, it should probably be:
p14046
aVPython packages are dot-delimited and the author used a path instead
p14047
aVLater on, the Django framework tries to load the module, and splitting off the last name after the last dot fails as there are no dots in the original call
p14048
aVIt looks like the project you are trying to load is fundamentally broken
p14049
aVIt probably will have other errors as well
p14050
as(dp14051
g16
V100297
p14052
stp14053
a((dp14054
g2
(lp14055
VIn terms of execution: nothing
p14056
aVThe  loop itself loops over an empty list, so no iterations will take place
p14057
aVAnd that's a good thing, because the  means: assign each entry in the loop to 0 variables
p14058
aVThe latter part is probably what is puzzling you
p14059
aVThe statement is legal because the target token  allows you to assign the values in a sequence to an equally large sequence of variable names; we call this tuple unpacking
p14060
aVThe following are more useful examples of target lists, in assignment and deletion:
p14061
aVYou can do the same in a  loop:
p14062
aVYou can use both tuples and lists for the  token, this is legal too:
p14063
aVHowever, in Python, a list can be empty
p14064
aVThus, the following is legal, however non-sensical:
p14065
aVand finally, so is this:
p14066
aVMore fun with target lists:
p14067
aVNow the left-hand side is using a slice in the assignment
p14068
aVFrom the documentation:
p14069
aVIf the target is a slicing: The primary expression in the reference is evaluated
p14070
aVIt should yield a mutable sequence object (such as a list)
p14071
aVThe assigned object should be a sequence object of the same type
p14072
aVNext, the lower and upper bound expressions are evaluated, insofar they are present; defaults are zero and the sequence\u2019s length
p14073
aVThe bounds should evaluate to (small) integers
p14074
aVIf either bound is negative, the sequence\u2019s length is added to it
p14075
aVThe resulting bounds are clipped to lie between zero and the sequence\u2019s length, inclusive
p14076
aVFinally, the sequence object is asked to replace the slice with the items of the assigned sequence
p14077
aVThe length of the slice may be different from the length of the assigned sequence, thus changing the length of the target sequence, if the object allows it
p14078
aVSo here we are no longer using tuple unpacking; instead we replace a section of the left-hand list with the right-hand list
p14079
aVBut because in our example the left-hand list is an anonymous list literal, the resulting altered list is lost again
p14080
aVBut because such an assignment is also legal in a for loop, the following is legal syntax, albeit rather non-sensical:
p14081
as(dp14082
g16
V100297
p14083
stp14084
a((dp14085
g2
(lp14086
VThis works in python 3
p14087
aV2:
p14088
aVThe  FAQ states python 3 is supported up to version 3
p14089
aV2, and you have just found out on python 3
p14090
aV3,  does not (yet) work
p14091
aVThere is a patch available in the issue tracker, so it's only a matter of time
p14092
aVUpdate: Version 0
p14093
aV14
p14094
aV1 was released on 2012/10/01, with the fix:
p14095
ag2391
aV14
p14096
aV1 (2012-10-01)
p14097
aVPython 3
p14098
aV3 Compatibility
p14099
aVSimply default accept-encoding
p14100
aVBugfixes
p14101
as(dp14102
g16
V100297
p14103
stp14104
a((dp14105
g2
(lp14106
VYou cannot read a file twice without resetting the read pointer
p14107
aVMoreover, your code actively prevents your file from being read properly
p14108
aVYour code currently does this:
p14109
aVThe  statement can read the whole file into memory in one go, resulting in the read pointer being moved to the end
p14110
aVThe loop over  will not return anything
p14111
aVBut you also only run that code if your  call did not read anything
p14112
aVYou are basically saying: If the file is empty, read the lines, otherwise do not read anything
p14113
aVIn the end this means your  function always returns , later leading to the error you see
p14114
aVLoose the  altogether:
p14115
aVYou then don't do anything much with  because for each line in your file you replace the  variable:
p14116
aVYou probably meant to create a list instead, and append:
p14117
aVAnother tip:  can be rewritten to
p14118
aVYou probably want to look into the  module to manipulate your paths though; I suspect a  call would work better and more reliably for you there
p14119
as(dp14120
g16
V100297
p14121
stp14122
a((dp14123
g2
(lp14124
VThe  keyword parameter in the  function is only available in the current development version; the current 0
p14125
aV10
p14126
aVx code itself ignores doesn't yet support it
p14127
aVInstead, use the  function instead:
p14128
aVor run with the  command-line flag
p14129
aVYou may have to import the  function from  if you haven't done so already
p14130
aVThe tutorial explains debug mode in more detail
p14131
as(dp14132
g16
V100297
p14133
stp14134
a((dp14135
g2
(lp14136
VYes, use a conditional expression:
p14137
aVExamples:
p14138
aVBefore Python 2
p14139
aV5 where this was introduced, people used a combination of  and  expressions to achieve similar results:
p14140
aVbut if the  part of the expression itself evaluated to something that has the boolean value  (so a 0 or None or any sequence with length 0, etc
p14141
aVthen  would be picked anyway
p14142
as(dp14143
g16
V100297
p14144
stp14145
a((dp14146
g2
(lp14147
VYour output is probably buffered
p14148
aVAdd a
p14149
aVflush() for stdout to clear it:
p14150
as(dp14151
g16
V100297
p14152
stp14153
a((dp14154
g2
(lp14155
VUse a namedtuple:
p14156
as(dp14157
g16
V100297
p14158
stp14159
a((dp14160
g2
(lp14161
VCollect your encrypted characters in a list, then print the joined result:
p14162
aVI renamed your  variable to  to avoid masking the built-in  type
p14163
aVYour  function could be simplified to:
p14164
aVBecause a string is a sequence just like a list; no need to convert to a list first
p14165
aVBy using  we save ourselves the bother of having to look up the index of each letter
p14166
as(dp14167
g16
V100297
p14168
stp14169
a((dp14170
g2
(lp14171
VA lot of things evaluate to  in Python
p14172
aVFrom the documentation on Boolean operators:
p14173
aVIn the context of Boolean operations, and also when expressions are used by control flow statements, the following values are interpreted as false: , , numeric zero of all types, and empty strings and containers (including strings, tuples, lists, dictionaries, sets and frozensets)
p14174
aVAll other values are interpreted as true
p14175
aVFunctions in Python, like so many things, are objects, and not empty
p14176
aVThus, in a boolean context, they evaluate to True
p14177
as(dp14178
g16
V100297
p14179
stp14180
a((dp14181
g2
(lp14182
VYou really want to use , perhaps contained in a :
p14183
as(dp14184
g16
V100297
p14185
stp14186
a((dp14187
g2
(lp14188
VIn cpython, if you use  without assigning the result to a variable, the file is closed again immediately
p14189
aVOn other python implementations (IronPython, jython, etc) this may not be the case; a file object in is closed when deleted by the garbage collector if not closed explicitly
p14190
aVYou can open files multiple times though, so you can always pass the same filename to  again at a later time, file open or not
p14191
aVIt's usually best to use the open file as a context manager, by using a  statement
p14192
aVWhen the block of code indented under the  statement is done, the file automatically closed for you:
p14193
as(dp14194
g16
V100297
p14195
stp14196
a((dp14197
g2
(lp14198
VYou have too many capturing groups in your regular expression; make them non-capturing:
p14199
aVDemo:
p14200
aVThat returns only one element that is empty
p14201
as(dp14202
g16
V100297
p14203
stp14204
a((dp14205
g2
(lp14206
VYou need to import the class from the module:
p14207
aVThis adds the class  directly to your local namespace
p14208
aVYour statement  adds the name  to the local namespace, so you could also do this instead:
p14209
aVbecause  is the  module in your  package directory
p14210
as(dp14211
g16
V100297
p14212
stp14213
a((dp14214
g2
(lp14215
V returns relative names, so you'll have to use  to make them absolute:
p14216
as(dp14217
g16
V100297
p14218
stp14219
a((dp14220
g2
(lp14221
VPython handles large numbers with arbitrary precision:
p14222
aVJust sum them up
p14223
aVTo make sure you don't use , try  instead
p14224
as(dp14225
g16
V100297
p14226
stp14227
a((dp14228
g2
(lp14229
VStore the values in a dictionary instead:
p14230
aVNow you can address the values in  as , , etc
p14231
as(dp14232
g16
V100297
p14233
stp14234
a((dp14235
g2
(lp14236
VPython used to lack booleans, we just used integers, 0 for False and any other integer for True
p14237
aVSo when booleans were added to the language, the values False and True, can be seen as the integer values 0 and 1 still by the interpreter, to help backwards compatibility
p14238
aVInternally, they are sub-classes of int
p14239
aVIn other words, the following equations are True:
p14240
aVand as you found out:
p14241
aVThis doesn't extend to strings however
p14242
as(dp14243
g16
V100297
p14244
stp14245
a((dp14246
g2
(lp14247
VPyramid uses the standard  module to guess the mimetype based on the extension
p14248
aVIt calls:
p14249
aVThe module looks in the Windows registry if on that platform, and in the following locations for mimetype lists:
p14250
aVYou can either extend one of those files, or create your own file and add it to the module using the  function
p14251
aVThe file format is simple, just list the mimetype, then some whitespace, then a space-separated list of extensions:
p14252
as(dp14253
g16
V100297
p14254
stp14255
a((dp14256
g2
(lp14257
VThe  method of dateutil is very flexible and will parse almost anything you throw at it
p14258
aVHowever, because of that flexibility, if your input is limited to a certain number of patterns, custom code that checks for those patterns then uses  could easily beat it
p14259
aVSince this depends entirely on the number of patterns you need to test for, the only thing you can do is measure which one will be faster for your specific usecases
p14260
as(dp14261
g16
V100297
p14262
stp14263
a((dp14264
g2
(lp14265
VStrings in python are immutable, so you cannot treat them as a list and assign to indices
p14266
aVUse  instead:
p14267
aVIf you need to replace only certain semicolons, you'll need to be more specific
p14268
aVYou could use slicing to isolate the section of the string to replace in:
p14269
aVThat'll replace all semi-colons in the first 10 characters of the string
p14270
as(dp14271
g16
V100297
p14272
stp14273
a((dp14274
g2
(lp14275
VIn python 3
p14276
aV3, you can use the new  context manager:
p14277
aVThis will raise , unless you clear the stack callbacks with
p14278
aVYou can codify this is into a custom context manager:
p14279
as(dp14280
g16
V100297
p14281
stp14282
a((dp14283
g2
(lp14284
VYou can use the file as an iterator, then print the next 8 lines every time you find your sentence:
p14285
aVEach time you call  on the file object (or loop over it in a  loop), it'll return the next line in that file, until you've read the last line
p14286
aVInstead of the  for loop, I'd actually use :
p14287
as(dp14288
g16
V100297
p14289
stp14290
a((dp14291
g2
(lp14292
VYou need to set up a little more context for your code to work
p14293
aVThe Plone site acts as a local component registry, for example
p14294
aVYou are also better off using the  command, it'll set up the database connection for you and pass the root object as  to your script
p14295
aVIn that script, use the following boilerplate to get the rest of the scaffolding up:
p14296
aVWith these in place you'll have everything you need to run your code
p14297
aVDon't forget to call  at the end
p14298
aVYour Plone site is reachable in the local variable
p14299
as(dp14300
g16
V100297
p14301
stp14302
a((dp14303
g2
(lp14304
VYou can use tuples as keys:
p14305
aVIf you want to count things, take a look at , it makes counting trivial, no need to initialize the keys to 0:
p14306
as(dp14307
g16
V100297
p14308
stp14309
a((dp14310
g2
(lp14311
VThe assert line is a long-standing problem in Plone, one that I haven't followed all the intricacies on
p14312
aVThere currently is one open bug involving the assert still:
p14313
aVProducts
p14314
aVResourceRegistries: "inline" resouces fail with "redirect"
p14315
aVI suspect that you have a JavaScript resource that is rendered inline, including in the error page
p14316
aVIt seems the resource registry assert is not taking into account a inline response on a non-200 page (such a as a 404 Not Found response)
p14317
aVThe above issue has a patch attached
p14318
aVIf the patch works for you, I suggest you comment on the ticket and state it worked for you
p14319
aVDo confirm that you have an inline JavaScript resource in your resource registry though
p14320
as(dp14321
g16
V100297
p14322
stp14323
a((dp14324
g2
(lp14325
VYou  is an iterator, and once exhausted won't rewind to the beginning for you
p14326
aVStore the result in a list and write that:
p14327
as(dp14328
g16
V100297
p14329
stp14330
a((dp14331
g2
(lp14332
VYou are using an index and a slice assignment, which are quite different
p14333
aVCompare this with indexing and slicing the list in an expression:
p14334
aVBy using a  colon in the list index, you are asking for a slice, which is always another list
p14335
aVIn Python you can assign values to both an individual item in a list, and to a slice of the list
p14336
as(dp14337
g16
V100297
p14338
stp14339
a((dp14340
g2
(lp14341
VBoth the instance constructor () and your instance initializer () need to accept the same number of arguments
p14342
aVYour  needs 4 arguments, but your  method only accepts 2
p14343
aVAdjust one or the other to accept the same number, or use a  catch-all argument in your  method
p14344
aVFor example, using the following  method would make things work:
p14345
aVin which case you no longer need your  initializer at all
p14346
aVDemo:
p14347
aVAn immutable type like a tuple often uses a  constructor instead of a  initializer; all the built-in immutables (, , ) do so
p14348
as(dp14349
g16
V100297
p14350
stp14351
a((dp14352
g2
(lp14353
VYour  value is empty, so the  loop never assigns a value to
p14354
aVInitialize  at the start of your function:
p14355
aVand figure out why your  file is empty
p14356
as(dp14357
g16
V100297
p14358
stp14359
a((dp14360
g2
(lp14361
VUse  to parse the HTML and use it's  module:
p14362
as(dp14363
g16
V100297
p14364
stp14365
a((dp14366
g2
(lp14367
VUse the  word boundary anchor instead of looking for whitespace to select words:
p14368
aVThe  anchor will also match if  is the first word in the string, or next to punctuation and not just whitespace (e
p14369
ag1298
ag2858
aVYou also want to use  instead of ; the latter automatically anchors to the start of the searched string:
p14370
aVIf zero or more characters at the beginning of string match the regular expression pattern, return a corresponding  instance
p14371
aVDemo:
p14372
as(dp14373
g16
V100297
p14374
stp14375
a((dp14376
g2
(lp14377
VThat statement would import all names from the  module in the package, not the files contained
p14378
aVYou'd have to import each module in the package in the  file explicitly for the  to import everything in all the modules in the package
p14379
as(dp14380
g16
V100297
p14381
stp14382
a((dp14383
g2
(lp14384
VUsing the algorithms demonstrated by the  module would give you the fastest search times, but we have to create some sorted indices
p14385
aVYou'd have to store both the start and the endtimes in a list with the index of the entry in the  list:
p14386
aVYou then create specialized  functions based on the  and  functions:
p14387
aVNow you can find the start and end indices with these functions:
p14388
aVReturning your matching range is now easy:
p14389
aVEach search has a  cost, where  is the length of the list
p14390
aVIt's easy enough to combine these operations into a class encapsulating both the timeseries list  and the indices
p14391
as(dp14392
g16
V100297
p14393
stp14394
a((dp14395
g2
(lp14396
VYou can control the Unix terminal with the  library
p14397
aVThe library essentially lets you build a simple terminal GUI
p14398
aVIf you need more, take a look at Urwid as well
p14399
aVUrwid offers more complex GUI widgets for the discerning terminal GUI developer
p14400
aV:-)
p14401
as(dp14402
g16
V100297
p14403
stp14404
a((dp14405
g2
(lp14406
VSquare brackets are special; they mark all characters inside of them as a character group
p14407
aVYou are asking to match either a number (), a  comma, a  full stop, a  opening parenthesis or a  closing parenthesis
p14408
aVIn other words, the opening and closing parenthesis are part of the matched characters, not denoting a capturing group
p14409
aVYou don't need to use a character class at all here, you are looking for a more specific pattern of number, follewed by a full stop followed by another number
p14410
aVUse a non-capturing group () to group the number format together with the comma to match repeating groups of numbers:
p14411
aVUnfortunately, this still won't capture more than one group for you; regular expressions will never produce a variable number of groups
p14412
aVWe've defined only two group here, so that's all we get:
p14413
aVSee Regex question about parsing method signature and python regex repetition with capture question for other SO questions that ran into this limitation
p14414
aVYour format is actually very simple, and you'd be much better off not using regular expressions at all
p14415
aVSimply split by the  comma and be done with it:
p14416
as(dp14417
g16
V100297
p14418
stp14419
a((dp14420
g2
(lp14421
VYou'd have to create a custom function or lambda to call the  method for you, given an instance:
p14422
aVor you could store a reference to the class method:
p14423
aVas  is of type
p14424
aVThe syntax  always will look up  as an attribute on , and the local variable  is never consulted for that
p14425
as(dp14426
g16
V100297
p14427
stp14428
a((dp14429
g2
(lp14430
VYou don't need to use ; the output is already valid JavaScript
p14431
aVYou then don't need to put quotes around the JSON value either
p14432
aVGenerally, my JavaScript looks like:
p14433
as(dp14434
g16
V100297
p14435
stp14436
a((dp14437
g2
(lp14438
VYou get a syntax error because the syntax for the python or operator is different, and you need to explicitly ask Python to return  from a dictionary lookup using the  method:
p14439
aVBecause  takes a default value to return instead of the looked-for key (which defaults to , you can also spell this as:
p14440
aVThis has the added benefit that if  is false-y (evaluates to False in a boolean context, such as empty sequences or numerical 0) it'll still return  and not
p14441
as(dp14442
g16
V100297
p14443
stp14444
a((dp14445
g2
(lp14446
VThere is a standard library named  as well; it is being loaded before your local module is being found
p14447
aVRename the module to something else and it'll work
p14448
as(dp14449
g16
V100297
p14450
stp14451
a((dp14452
g2
(lp14453
VUse ; it creates the combinations you are looking for
p14454
aVTogether with a list comprehension, you should be set:
p14455
aVNote that the  type was made a built-in native type in python; just use  (lowercase) for the native version
p14456
aVWe don't need to turn the set into a list for this to work; itertools doesn't care either way
p14457
aVYou can even use the new  set literal syntax
p14458
aVThis produces:
p14459
as(dp14460
g16
V100297
p14461
stp14462
a((dp14463
g2
(lp14464
VYou can decode this with the python  module:
p14465
aVThe  pattern expects a big-endian signed integer (4 bytes)
p14466
as(dp14467
g16
V100297
p14468
stp14469
a((dp14470
g2
(lp14471
VA  expression is a character group, meaning it'll match any one character contained therein
p14472
aVYou are thus matching a literal  character
p14473
aVA character group always applies to one input character, and thus can never contain an anchor
p14474
aVIf you wanted to match either a whitespace character or the end of the string, use a non-capturing group instead, combined with the  or selector:
p14475
aVAlternatively, look at the  word boundary anchor
p14476
aVIt'll match anywhere a  group start or ends (so it anchors to points in the text where a  character is preceded or followed by a  character, or is at the start or end of the string)
p14477
as(dp14478
g16
V100297
p14479
stp14480
a((dp14481
g2
(lp14482
VA tkt auth cookie is a secure hash of several pieces of information, including the username and optionally a timestamp, but not the user password
p14483
aVOnce authenticated, you give such a cookie to the user, and every time the user returns you just extract the username again and know it's the same user
p14484
aVTo keep this cookie secure, you need to have a server-side secret, however
p14485
aVOnly a server in possession of that secret can create these cookies; if an attacker ever got hold of it he could generate authentication cookies for arbitrary users without ever needing to know the passwords of these users
p14486
aVThe  parameter for the policy is that server-side secret; it's like a master password for your server
p14487
aVIf you run more than one process for your site (and with WSGI, you usually do), you need to make it consistent across your processes, to make sure each process can verify the coookies
p14488
aVYou can specify it in your configuration file, in your source code, or in your database; it depends on how much flexibility you need, your security policies, and whether or not you need to share the secret with other systems
p14489
aVYou can share the secret with other systems in your domain that also need to authenticate your users, using the same standard
p14490
aVApache has a  module for example, Plone uses the same standard, and by sharing the secret you can provide a single sign-on for your users across disparate web applications
p14491
aVNote that changing the secret means existing sessions become invalid, and users would have to re-authenticate
p14492
aVIn any case, existing cookies can have a limited life-span; the embedded timestamp limits how long it will be accepted as valid, if you configure the  parameter on the policy
p14493
aVIt's good policy to set a timeout, combined with a reissue time; any user that re-visits your application within the timeout will be re-issued a new cookie with a new timestamp to keep their session fresh
p14494
aVThat way your session cookies automatically expire if your users do not return, and their cookie cannot be reused by an attacker at a later time
p14495
as(dp14496
g16
V100297
p14497
stp14498
a((dp14499
g2
(lp14500
VIn your first example, the tuple is implicit; python imagines the parenthesis for you when it sees the comma in the expression; it does this for any expression, not just when returning from a function:
p14501
aVBut in your lambda example, you have to make them explicit, because python sees the whole expression as a new tuple (containing a lambda and a  expression):
p14502
as(dp14503
g16
V100297
p14504
stp14505
a((dp14506
g2
(lp14507
VHow about a python expression using :
p14508
aVIf  is , it short-circuits and returns , otherwise it returns
p14509
aVYou need to use  because otherwise you'd be concatenating an  and a  type
p14510
as(dp14511
g16
V100297
p14512
stp14513
a((dp14514
g2
(lp14515
VWhy not use  for your serialization and deserialization
p14516
aVColander turns an object schema into simple data structure and vice-versa, and you can use JSON to send and receive this information
p14517
aVFor example:
p14518
aVThe above setup defines a list of item objects, but you can easily define game-specific objects too
p14519
aVDeserialization becomes:
p14520
aVand serialization is:
p14521
aVApart from letting you round-trip python objects, it also validates the serialized data to ensure it fits your schema and hasn't been mucked about with
p14522
as(dp14523
g16
V100297
p14524
stp14525
a((dp14526
g2
(lp14527
VIt is a raw python string literal; any  or other character escape is not interpreted
p14528
aVSince you often use the backslash in regular expressions (where they have their own meaning) it is common practice to use raw string literals for such expression definitions
p14529
as(dp14530
g16
V100297
p14531
stp14532
a((dp14533
g2
(lp14534
VYou could use the  module:
p14535
aVor, as running code:
p14536
as(dp14537
g16
V100297
p14538
stp14539
a((dp14540
g2
(lp14541
VIn python 3, the  object is a module
p14542
aVYou need to call objects contained in this module
p14543
aVThis is an important change from Python 2, if you are using example code you need to take that into account
p14544
aVFor example, creating the  object and the opener:
p14545
aVRead the documentation carefully
p14546
as(dp14547
g16
V100297
p14548
stp14549
a((dp14550
g2
(lp14551
VYou are using a python feature not yet supported in Python 2
p14552
ag400
aVFrom the  documentation:
p14553
aVChanged in version 2
p14554
aV5: Added support for the optional key argument
p14555
aVYou'll have to use a decorate, undecorate pattern, using a python list comprehension:
p14556
as(dp14557
g16
V100297
p14558
stp14559
a((dp14560
g2
(lp14561
V is only called on explicit  assignments; building a class does not use attribute assignment but builds a dictionary () instead
p14562
aVTo access the class you have a few different options though:
p14563
aVUse a class decorator instead; it'll be passed the completed class after building it, you could decorate individual methods on that class by replacing them (decorated) in the class
p14564
aVYou could use a combination of a function decorator and a class decorator to mark which methods are to be decorated:
p14565
aVYou could use a metaclass instead of a class decorator to achieve the same, of course
p14566
aVCheat, and use  to retrieve the class from the calling frame:
p14567
aVNote that all you can retrieve is the name of the class; the class itself is still being built at this time
p14568
aVYou can add items to  (a mapping) and they'll be made part of the new class object
p14569
aVAccess  whenever the method is called
p14570
aVis a reference to the instance after all, and  is going to be, at the very least, a sub-class of the original class the function was defined in
p14571
as(dp14572
g16
V100297
p14573
stp14574
a((dp14575
g2
(lp14576
VEverything from the first  single quote is a string, including the double quotes
p14577
aVIt doesn't matter how many double quotes you use within a single-quoted string
p14578
aVThe string ends at the next single quote encountered, which is why you have to escape any literal single quotes within the literal
p14579
aVIn your second example you use a triple quoted string
p14580
aVPython then regards everything up to the next triple quote () part of the string literal
p14581
aVPython accept 4 different forms of quoting to delimit a literal string:
p14582
aVNote that when you use tripled quotes, newlines can be used:
p14583
aVYou cannot do that with single quoted strings
p14584
as(dp14585
g16
V100297
p14586
stp14587
a((dp14588
g2
(lp14589
VIn python you'd return a custom type, and override the  method to calculate the string representation at printing time
p14590
aVDepending on your use-cases, you are still looking at the various hooks python provides:
p14591
aVAttribute access on custom classes can be hooked into with the  method, or by using a
p14592
aVAccessing individual items in a sequence-like class (list, tuple, string) and mapping-type classes can be hooked into with
p14593
aVYou'll have to decide, based on your use-case, what you need to hook into, at which point it becomes inevitable that you need to make the expensive calculation
p14594
aVPython will let you hook that almost any point in an object's lifetime with ease
p14595
as(dp14596
g16
V100297
p14597
stp14598
a((dp14599
g2
(lp14600
VYou are not printing the string, you are printing the string literal; it is the strings representation:
p14601
aVWhenever you echo a variable in the Python interactive interpreter (or IDLE), the interpreter echoes the value back to you:
p14602
aVPrinting the value, however, outputs to the same location, but is a different action altogether:
p14603
aVIf I were to call a function that printed, for example, and that function returned a value, you'd see both echoed to the screen:
p14604
aVIn the above example,  and  were printed by the function, but  is the return value of the function, which the interpreter helpfully echoed back to me in the form of it's representation
p14605
as(dp14606
g16
V100297
p14607
stp14608
a((dp14609
g2
(lp14610
VYou are looking for the  argument syntax:
p14611
aVWhen passing arguments to a callable, any expression preceded by a  asterix, is interpreted as a sequence of positional arguments, and expanded to be passed on as separate arguments to the called object (function, method, etc
p14612
aVFor your example that would be:
p14613
aVThere is a keyword equivalent using  double asterixes (takes a mapping), and you can use the same syntax in function signatures too
p14614
aVSee the documentation on call expressions, and for the function signature mirror syntax, the documentation on function definitions
p14615
as(dp14616
g16
V100297
p14617
stp14618
a((dp14619
g2
(lp14620
VYou are mixing tabs and spaces
p14621
aVDon't do this, it creates inconsistent indentation problems
p14622
aVRun your script through the tab checker:
p14623
aVand fix any and all tabs (replace with spaces), then configure your editor to only use spaces
p14624
aVFor Notepad++, see:
p14625
aVNotepad++ tabs to spaces
p14626
aVHow do I configure Notepad++ to use spaces instead of tabs
p14627
as(dp14628
g16
V100297
p14629
stp14630
a((dp14631
g2
(lp14632
VEasy peasy:
p14633
aVIt's a conditional expression
p14634
as(dp14635
g16
V100297
p14636
stp14637
a((dp14638
g2
(lp14639
VIf you want to continue development on the Git package, I'd use  to manage the package
p14640
aVwill mark the egg as a developer egg, which means it'll not be pulled from PyPI but used locally
p14641
aVMoreover,  will manage the working copy for you:
p14642
aVNow, when running your buildout,  will automatically check out  from git into the  subdirectory, run it's setup
p14643
aVpy to make a development egg, and buildout will use that egg to satisfy dependencies on it
p14644
aVIf you need a different sources directory, use the  option:
p14645
as(dp14646
g16
V100297
p14647
stp14648
a((dp14649
g2
(lp14650
VNo, ASCII is a 7-bit encoding
p14651
aVMost text encodings (including UTF-8 and ISO-8859) are 8-bit encodings
p14652
aVGenerally speaking, anything beyond the basic ASCII character set needs more than 7 bits to encode
p14653
aVSo when dealing with international data, you usually deal with encodings that can use multiple bytes per encoded character
p14654
aVPython will automatically try to decode byte strings to Unicode when you try to combine Unicode and byte string types, and the default encoding (in python 2) is ASCII
p14655
aVThis is a frequent source of UnicodeDecodeError exceptions in Python
p14656
aVYou really want to read up on Unicode and text encodings before you proceed though
p14657
aVI can recommend:
p14658
aVJoel Spolsky's minimum Unicode article
p14659
aVThe Python Unicode HOWTO
p14660
as(dp14661
g16
V100297
p14662
stp14663
a((dp14664
g2
(lp14665
VYou you wanted a list of x and y coordinates, it's easy enough:
p14666
aVIf these coordinates are integers, you can convert them to python int (from str) with a quick call to :
p14667
aVIn python 3, where  is a generator, it's probably best to use a nested list comprehension:
p14668
aVThis'll result in a list of lists:
p14669
as(dp14670
g16
V100297
p14671
stp14672
a((dp14673
g2
(lp14674
VYou are looking for an empty string that is not followed by the text , a negative lookahead assertion
p14675
aVSince there are 4 such positions with an empty string (in-between the letters and at the end), there are 4 empty matches
p14676
aVIt is returning exactly what your are looking for, perhaps you were looking for something else instead
p14677
as(dp14678
g16
V100297
p14679
stp14680
a((dp14681
g2
(lp14682
VThe line  creates a list that has the same empty list in it 15 times
p14683
aVYou want to use a list comprehension instead:
p14684
aVTry it out for yourself:
p14685
as(dp14686
g16
V100297
p14687
stp14688
a((dp14689
g2
(lp14690
VWhen writing data to a file, it'll turn your objects into strings
p14691
aVThe  notation indicates your data is contained in lists
p14692
aVYou want to write  instead of  for each entry
p14693
aVTo illustrate:
p14694
as(dp14695
g16
V100297
p14696
stp14697
a((dp14698
g2
(lp14699
VAny text that only uses ASCII codepoints (byte values 00-7F hexadecimal) can be converted to ASCII
p14700
aVBasically any text that uses characters not often used in American English is not ASCII
p14701
aVIn your example code, you are not converting the input to Unicode text; you are treating it as un-decoded bytes
p14702
aVThe test page in question is encoded in UTF-8, and you never decode that to Unicode
p14703
aVIf you were to decode the value to a Unicode string, you won't be able to store that string in a  object
p14704
aVYou may want to read up on the difference between Unicode and text encodings such as ASCII and UTF-8
p14705
aVI can recommend:
p14706
aVJoel Spolsky's minimum Unicode article
p14707
aVThe Python Unicode HOWTO
p14708
as(dp14709
g16
V100297
p14710
stp14711
a((dp14712
g2
(lp14713
VYou use a list comprehension:
p14714
aVFor your specific example, you can use an expression that sums the values:
p14715
aVwhere  returns your random number
p14716
as(dp14717
g16
V100297
p14718
stp14719
a((dp14720
g2
(lp14721
VYou do not want to use the minidom; use the ElementTree API instead
p14722
aVThe DOM API is a very verbose and constrained API, the ElementTree API plays to Python's strengths instead
p14723
aVThe MiniDOM module doesn't offer any query API like you are looking for
p14724
aVYou can use the bundled  module, or you could install lxml, which offers more powerful XPath and other query options
p14725
as(dp14726
g16
V100297
p14727
stp14728
a((dp14729
g2
(lp14730
VNo, python is inherently dynamically typed
p14731
aVIf you must doublecheck a type, use the  function, or use duck typing to test for specific behaviour
p14732
as(dp14733
g16
V100297
p14734
stp14735
a((dp14736
g2
(lp14737
VThere are several ways:
p14738
aVUse a dictionary instead, it is more than sufficient in many cases:
p14739
aVGive your  class a meaningful  initializer:
p14740
aVand pass your parsed values into that:
p14741
aVAs a last resort, you can use  to set arbitrary attributes on an existing object:
p14742
as(dp14743
g16
V100297
p14744
stp14745
a((dp14746
g2
(lp14747
VHow about you loop over the print statement 4 times
p14748
aVOr, use  to append the newline, and multiply the result by 4:
p14749
aVOr, use a list and  the elements with newlines:
p14750
as(dp14751
g16
V100297
p14752
stp14753
a((dp14754
g2
(lp14755
VThere are ,  and  properties on a Point object; simply set those:
p14756
aVThere are also ,  and  properties; it is not immediately clear from the source code what the difference is between the two types:
p14757
aVbut the library can produce these objects directly from a
p14758
aVlas file for you, can't it
p14759
aVThe  class you had trouble with before certainly does return these objects already
p14760
aVAnd since you updated to show some code, here is a more readable version of that:
p14761
as(dp14762
g16
V100297
p14763
stp14764
a((dp14765
g2
(lp14766
VIn this case, a regular expression would work just fine:
p14767
aVNote the  qualilifier; you have newlines inside your  sections, and we want to remove those too
p14768
aVDemo:
p14769
as(dp14770
g16
V100297
p14771
stp14772
a((dp14773
g2
(lp14774
VUse a triple quoted string:
p14775
aVSQL is a whitespace-agnostic language, you can use newlines as well as spaces to delimit
p14776
aVThe initial backslash escapes the first newline; it's a personal preference but not needed
p14777
aVIf you really don't want the newlines, put parenthesis around your string; no need to use  signs then as python will make it one long string for you:
p14778
as(dp14779
g16
V100297
p14780
stp14781
a((dp14782
g2
(lp14783
VThe print function uses a special flag when writing to a file object, causing the  function of the Python C API to retrieve the output encoding to do the unicode-to-bytes conversion, and by replacing the  stream you lost the encoding
p14784
aVUnfortunately, you cannot explicitly set it again:
p14785
aVYou also cannot use the  function instead, since it doesn't allow buffering to be disabled if you want to be able to use the  option you'd require
p14786
aVThe proper way to have the print function flush immediately is to use the  keyword:
p14787
aVIf that's too tedious to add everywhere, consider using a custom print function:
p14788
aVSince Python 2
p14789
aV7's  function doesn't actually support the flush keyword yet (botheration), you can simulate that by adding an explicit flush instead in that custom version
p14790
as(dp14791
g16
V100297
p14792
stp14793
a((dp14794
g2
(lp14795
VYou are not using specifying a string formatter the  argument here:
p14796
aVYou only have 3 slots there (,  and ), but you pass in 4 arguments
p14797
aVThe following would already be better:
p14798
aVeven though that would not print exactly what you wanted
p14799
aVYou want to format  a bit more:
p14800
as(dp14801
g16
V100297
p14802
stp14803
a((dp14804
g2
(lp14805
VYou want to use a , not a  object:
p14806
aVA  object expects a python regular expression as the first argument, and an error message as the second argument
p14807
aVA password validating regular expression would be something like:
p14808
as(dp14809
g16
V100297
p14810
stp14811
a((dp14812
g2
(lp14813
VYou cannot use new-style formatting when using the logging module; use  instead of
p14814
aVThe logging module uses the old-style  operator to format the log string
p14815
aVSee the  method for more detail
p14816
as(dp14817
g16
V100297
p14818
stp14819
a((dp14820
g2
(lp14821
VUse one asterix and it'll work:
p14822
aVor perhaps:
p14823
aVif you want your output to match exactly
p14824
as(dp14825
g16
V100297
p14826
stp14827
a((dp14828
g2
(lp14829
VSlicing is a little smarter than that; you can use negative indices to count from the end:
p14830
aVDemo:
p14831
aVThis works for an arbitrary number of elements to be moved to the front:
p14832
aVUsing slicing like this is comparable in speed to using  +  (on a short list):
p14833
aVbut wins hands down if you need to shift more than one element:
p14834
as(dp14835
g16
V100297
p14836
stp14837
a((dp14838
g2
(lp14839
VThe  function returns a packed 32-bit binary value; you could use the  module to turn that into an integer:
p14840
as(dp14841
g16
V100297
p14842
stp14843
a((dp14844
g2
(lp14845
VI am pretty certain you are doing something else different; the triple quoting isn't making a difference here at all:
p14846
aVUsing triple quoting is just one way to specify a python string literal
p14847
aVHow you specified that literal (with or without the  raw prefix, with single or triple quotes, using single  or double  quotes) is not preserved
p14848
aVWhere triple quoting does make a difference is when you include a newline:
p14849
aVBut your examples do not include any newlines at all
p14850
as(dp14851
g16
V100297
p14852
stp14853
a((dp14854
g2
(lp14855
VYou appear to be interpreting the data as little-endian
p14856
aVTo decode, decode with , then use bitshifting and a mask to interpret them:
p14857
as(dp14858
g16
V100297
p14859
stp14860
a((dp14861
g2
(lp14862
VYou need to use a timezone object; these don't come with Python itself as the data changes too often
p14863
aVThe  library is easily installed though
p14864
aVExample conversion:
p14865
as(dp14866
g16
V100297
p14867
stp14868
a((dp14869
g2
(lp14870
VA Maintainer can:
p14871
aVEdit package info
p14872
aVAdd and remove releases
p14873
aVAdd and remove files for releases
p14874
aVEdit release info
p14875
aVSomeone with the Admin role can, in addition, also assign roles and remove the package altogether
p14876
as(dp14877
g16
V100297
p14878
stp14879
a((dp14880
g2
(lp14881
VYou want to use  to combine the elements, I think:
p14882
aVDo yourself a big favour though and use the ElementTree API instead; that API is far pythononic and easier to use than the XML DOM API
p14883
as(dp14884
g16
V100297
p14885
stp14886
a((dp14887
g2
(lp14888
VThe ZODB3 package comes with pre-compiled eggs for Windows, see the PyPI page for ZODB3
p14889
aVYou need to tell  explicitly that it needs to install an egg; it normally does not support installing from an egg:
p14890
aVAlternatively, you could use  instead
p14891
as(dp14892
g16
V100297
p14893
stp14894
a((dp14895
g2
(lp14896
VYou seem to have a version conflict; note the  path, but the  script wants to load  instead
p14897
aVThe latter is a development version; it has the revision number of a subversion repository embedded in the version ()
p14898
aVI suspect you have two python installations; one is the system version (in  and the other is installed with the python installer into , and the stub script in  may be installed with the system python
p14899
aVIf so, there'll be another copy of the stub at , which should work correctly
p14900
as(dp14901
g16
V100297
p14902
stp14903
a((dp14904
g2
(lp14905
VHow about:
p14906
as(dp14907
g16
V100297
p14908
stp14909
a((dp14910
g2
(lp14911
VThe Python standard library uses it, so it is most definitely proper and safe
p14912
aVSee the  module source for an excellent example:
p14913
aVIt's quite common to conditionally import modules in python
p14914
aVInstead of , you'll often see a / combination too:
p14915
aVHere, we basically use the moral equivalent of an  test: If you can import , do so, otherwise define the full function here
p14916
aVAn import statement is just a re-binding of an external piece of code to a local name
p14917
aVUsing an  control flow to control the import is no different from assigning a variable in an  statement in that regard
p14918
aVYou need to make sure you don't end up using the name without it being defined either way
p14919
as(dp14920
g16
V100297
p14921
stp14922
a((dp14923
g2
(lp14924
VThe point is that with the ZCA, you don't set a dependency to a concrete object
p14925
aVYou use utilities instead
p14926
aVObject A would implement an interface, and you look up the interface in B to find a concrete implementation, which could be A, but that depends on the register
p14927
aVNote that the ZCA is meant to allow you to plug different implementations for a given interface, and is not always needed
p14928
aVIf your Task object expects a specific type, then document that
p14929
aVUsing the ZCA is not a requirement here
p14930
aVAt most, you can try to adapt the passed in value to ; if the passed in object already implements that interface, that action is a no-op:
p14931
aVThat would allow you the flexibility of passing in something else later, something that is not a Person itself, but could be adapted to that interface
p14932
as(dp14933
g16
V100297
p14934
stp14935
a((dp14936
g2
(lp14937
VAlthough the web interface doesn't link to it, you can switch channels on the logtail; the default is  but you can also ask for the  logtail by altering the logtail URL
p14938
aVNormally the url for the  function takes the form of , but it supports adding the channel as an extra path element
p14939
aVThus,  is the same as leaving off the channel, or you could switch to  for tailing the stderr log
p14940
as(dp14941
g16
V100297
p14942
stp14943
a((dp14944
g2
(lp14945
VThis is not a proxy setup problem; Apache proxy rules for Plone either work or they don't
p14946
aVThe proxy error is caused by Plone no longer responding, and that is why restarting Plone fixes the problem temporarily
p14947
aVYou'll need to figure out why Plone stops responding
p14948
aVThis can have any number of reasons, and you'll have to pinpoint what is going on
p14949
aVYou could have a programming error, one that ties up a thread forever, in part of your site
p14950
aVOnce you run out of threads, Plone can no longer serve normal requests and you get your proxy errors
p14951
aVYou could use  to peak at what your threads are up to when your site is no longer responding
p14952
aVIt could be something trashed your ZODB cache; if a web crawler tried to load all of your site in short succession, for example, it may have caused so much cache churn that it takes a while to rebuild your catalog cache
p14953
aVTake a close look at your log files (both from Apache and the Plone instance) and look for patterns
p14954
aVIn such cases you'd either have to block the crawler, or install better caching to lighten the load on your Plone server (Varnish does a great job of such caching setups, with some careful tuning)
p14955
aVSome inexperienced catalog usage could have trashed your ZODB cache, with the same results
p14956
aVIn one (very bad) case that I've seen, some code would look up all objects of a certain type from the catalog, call  on those results (loading each and every object into memory), then filter the huge set down to a handful of objects that would actually be needed
p14957
aVInstead, the catalog should have been used to narrow the list of objects to load significantly before loading the objects themselves
p14958
aVIt could be you are not taking advantage of ZODB Blobs; large files stored on and served directly from the disk instead of from ZODB objects spares your memory cache significantly
p14959
aVAll in all this could be some work to sort out, depending on what the root cause is
p14960
as(dp14961
g16
V100297
p14962
stp14963
a((dp14964
g2
(lp14965
VYou can use a list comprehension instead of a while loop:
p14966
aVYour  test itself is also wrong
p14967
aVYou never need to test for  for  in any case, that's what  does
p14968
aVBut in your case you test the following:
p14969
aVwhich is always going to be False
p14970
aVIn python, comparison operators like  and  are chained
p14971
aVLeaving off the  would make your  loop work much better
p14972
aVI'm not sure you understand what happens when you call  on a string though; it'll split it into individual characters:
p14973
aVIf you wanted to split the input into elements separated by a comma, use the  method instead, and you won't have to remove the commas at all:
p14974
as(dp14975
g16
V100297
p14976
stp14977
a((dp14978
g2
(lp14979
VThe JSON encoding is the lingua franca of your RPC protocol, so you can indeed use any client you like
p14980
aVNote that JSON-RPC uses the HTTP protocol, a very specific communication protocol built on top of TCP/IP
p14981
aVThe examples include both the Python client and the server because they illustrate how to implement the JSON-RPC standard in Python, not in JavaScript or C or Lisp
p14982
aVThey focus on the implementation in one language
p14983
aVThe JSON-RPC standard however, is language agnostic
p14984
aVIt doesn't matter what language you write either the server or the client in, as long as they use the same standard
p14985
as(dp14986
g16
V100297
p14987
stp14988
a((dp14989
g2
(lp14990
VYou have two statements on one line; that's a syntax error
p14991
aVPut them on two separate lines:
p14992
aVTechnically, you could also join multiple statements with a  semi-colon, but that is generally discouraged
p14993
as(dp14994
g16
V100297
p14995
stp14996
a((dp14997
g2
(lp14998
V indicates that you are trying to print the filenames
p14999
aVIf it was  that had a problem you should see a  (Decode, not Encode)
p15000
aVBecause you use a Unicode pathname,  returns readily decoded filenames; on Windows the filesystem uses UTF-16 to encode filenames and those are easily decoded in Python ( tells Python what codec to use)
p15001
aVHowever, the Windows console uses a different encoding; in your case , and that codec cannot display all the different characters that UTF-16 can encode
p15002
aVYou are looking for a  statement here
p15003
aVYou perhaps could use  to try and print the filenames instead; unprintable characters will be replaced by a question mark
p15004
aVAlternatively, you could use a  as the path and work with raw bytestrings instead of Unicode
p15005
as(dp15006
g16
V100297
p15007
stp15008
a((dp15009
g2
(lp15010
V looks like a UTF-8 byte pair for , or
p15011
aVBetter known as the cyrillic character  (Capital O)
p15012
aVIn other words, you have strangely encoded UTF-8 data on your hand
p15013
aVTurn the  digits into bytes ( would do) then decode from UTF-8:
p15014
as(dp15015
g16
V100297
p15016
stp15017
a((dp15018
g2
(lp15019
VBecause explicit is better than implicit
p15020
aVBy making the parameter an explicit requirement, you simplify code understanding, introspection, and manipulation
p15021
aVIt's further expanded on in the Python FAQ
p15022
aVMoreover, you can define class methods (take a class instead of an instance as the first argument), and you can define static methods (do not take a 'first' argument at all):
p15023
as(dp15024
g16
V100297
p15025
stp15026
a((dp15027
g2
(lp15028
VDouble the  percent symbol:
p15029
aVThe  part is being interpreted as a string formatter for a floating point number otherwise
p15030
as(dp15031
g16
V100297
p15032
stp15033
a((dp15034
g2
(lp15035
VUse  instead of the standard library ; it supports the same API, but can handle broken XML; it'll attempt to repair it if at all possible:
p15036
as(dp15037
g16
V100297
p15038
stp15039
a((dp15040
g2
(lp15041
VIt looks like you tried to print an exception; you can access the the arguments of the exception with the  parameter:
p15042
as(dp15043
g16
V100297
p15044
stp15045
a((dp15046
g2
(lp15047
VYou should not open the file in universal newline mode ()
p15048
aVOpen the file in binary mode instead:
p15049
aVCSV does it's own newline handling, including managing newlines in quotes
p15050
aVNext, print your rows with  to verify that you are getting the output you are expecting
p15051
aVUsing  instead of the regular string representation shows you much more about the type of objects you are handling, highlighting such differences as strings versus integers ( vs
p15052
ag2858
aVThirdly, if you want to select part of a string up to a delimiter such as a comma, use  or :
p15053
as(dp15054
g16
V100297
p15055
stp15056
a((dp15057
g2
(lp15058
VNo, you cannot use  to install anything but python distributions
p15059
aVUse another installation tool; buildout can manage both Python distributions and other installation tasks with python extensions called recipes
p15060
aVAlternatively, you could package up your jQuery dependency as a python distribution, but such a distribution would be very tightly bound to your application
p15061
aVThe Plone community does do this, but they include configuration for the Plone CMS to integrate the libraries into their registries; see  for example, the contents of the package include more than just jQuery
p15062
as(dp15063
g16
V100297
p15064
stp15065
a((dp15066
g2
(lp15067
VAs always, use a list comprehension:
p15068
aVThis applies a string formatting operation to each element, adding the spaces
p15069
aVIf you use python 2
p15070
aV7 or later, you can even omit the  in the replacement field (the curly braces)
p15071
as(dp15072
g16
V100297
p15073
stp15074
a((dp15075
g2
(lp15076
VYou'd have to create separate indexes using dictionaries to allow looking up elements by contents:
p15077
aVNow you can look up indices on strings:
p15078
aVNote that this always returns a list, as your entries could match multiple tuples
p15079
aVIf the lookup is a string, we only use the first two indexes, otherwise only the 3rd
p15080
aVAlternatively, the more general solution that doesn't care about entry type, would be to create a list of indexes, instead of 3 separate variables:
p15081
aVwith the lookup becoming:
p15082
aVYou could bundle this all up in a class, where your indexes are kept up to date as you add or remove elements
p15083
as(dp15084
g16
V100297
p15085
stp15086
a((dp15087
g2
(lp15088
VUse the  method with a list comprehension:
p15089
as(dp15090
g16
V100297
p15091
stp15092
a((dp15093
g2
(lp15094
VThe default setup sorts items by their container ordering (the  index in the catalog)
p15095
aVYou can alter the ordering of items within a container by dragging them by their ordering handle:
p15096
aVThis is on the folder contents view ()
p15097
aVIf you need to alter the default sorting parameter because all your content should always be sorted alphabetically or by publication date or similar, you'll have to change the navigation tree parameters in the ZMI; find the  tool in the ZMI, within which you'll find the  property sheet
p15098
aVChange the  property to the name of a different catalog index to sort results by
p15099
aVIf you have created a custom Archetypes folder type, make sure it inherits from
p15100
aVWhen using Dexterity, the  base class is orderable by default
p15101
as(dp15102
g16
V100297
p15103
stp15104
a((dp15105
g2
(lp15106
VNot without looking at the  value for each and every file in that folder
p15107
aVYou can use  on the  value for each entry in the folder:
p15108
as(dp15109
g16
V100297
p15110
stp15111
a((dp15112
g2
(lp15113
VUse a  instead of an ordinary dict to count things:
p15114
aVor even:
p15115
aVAs you can see that makes your code vastly simpler
p15116
as(dp15117
g16
V100297
p15118
stp15119
a((dp15120
g2
(lp15121
VUse parameters instead of string interpolation to ensure that your values are properly escaped by the database connector:
p15122
aVThe mysqldb sql parameter style uses the same syntax as used by the python string formatting operator, which is a little confusing
p15123
as(dp15124
g16
V100297
p15125
stp15126
a((dp15127
g2
(lp15128
VIf order matters, use a  with only the first two elements of your nested lists:
p15129
as(dp15130
g16
V100297
p15131
stp15132
a((dp15133
g2
(lp15134
VDon't use append but concatenation instead:
p15135
aVThis returns a new list;  will not be affected
p15136
aVIf you need to have  affected as well either use  anyway, then assign  separately from (a copy of)
p15137
as(dp15138
g16
V100297
p15139
stp15140
a((dp15141
g2
(lp15142
VYou are accessing the index , not :
p15143
aVThis means that by the time you reach  you have an index error, whatever the size of your list
p15144
as(dp15145
g16
V100297
p15146
stp15147
a((dp15148
g2
(lp15149
VFirst, some comments on your code, it can be simplified and improved:
p15150
aVBest practice is for your form to use the  method of your view; it's the canonical URL, while  might include acquisition oddities or the wrong URL altogether if your view was included elsewhere:
p15151
aVThe  input box tal expression can just use a path expression, these work for dictionaries just fine
p15152
aVYou don't need to redefine the  method, the  class already provides that for you
p15153
aVTo test if a form has been submitted, we generally just test for the submit button being present in the request, your test is more elaborate than is needed:
p15154
aVBecause  is a method of your view, it can itself access  and , simplifying your method signature
p15155
aVSince you now know that your form is submitted, you can count on  to exist and be a string; if it isn't someone has been manually tinkering with the request and things deserve to break, so I generally do not use  in such cases
p15156
aVViews must always do all their work in the  method, since the  is called during traversal, at which time such crucial information as the current user have not yet been determined
p15157
aVYou do not need to access the response for the  method through the context, just access it from the  attribute, but remember to return the result:
p15158
aVHowever, if your view is the default view of the context object, that will indeed lead to a redirect loop that the browser will not tolerate
p15159
aVNote that if you do override the  method of a  view class that has a template associated with it, you need to make sure you return the output of the template where appropriate
p15160
aVMy stab at your view class would thus be:
p15161
as(dp15162
g16
V100297
p15163
stp15164
a((dp15165
g2
(lp15166
VYou are using the  class completely incorrectly, I'm afraid
p15167
aVYou are passing it the result of the  method, which never returns
p15168
aVPass  (without calling it) to the  class as the , then start it explicitly:
p15169
aVAlso, just access  as an instance variable, not a class variable
p15170
as(dp15171
g16
V100297
p15172
stp15173
a((dp15174
g2
(lp15175
VUse the  utility:
p15176
aVAlternatively, you could use the  method, it takes a  keyword parameter (defaults to ), returned if the id is not found
p15177
as(dp15178
g16
V100297
p15179
stp15180
a((dp15181
g2
(lp15182
VNeither LIMIT nor OFFSET use  equals signs, so your SQL is indeed incorrect
p15183
aVYou really should use SQL parameters, where the database library quotes your values and prevents SQL injection attacks:
p15184
aVNote the order of the parameters as well;  comes first, so pass in your  parameter first
p15185
aVYou can just use:
p15186
aVas well, replacing  with a comma, and swapping the arguments
p15187
as(dp15188
g16
V100297
p15189
stp15190
a((dp15191
g2
(lp15192
VYou need to register your type with the factory tool
p15193
aVWhen so registered content is created initially inside a sandbox, just so you can fill out the edit form for the first time
p15194
aVOnce you submit the edit form, the item is created for real and is given an id based on the title
p15195
aVTo register, either manually enable your type on the "Factory Types" tab of the  object (in the ZMI), or register your type in your GenericSetup profile with a file named  containing:
p15196
aVYou also need to make sure your type has the rename flag set to True; in your class definition add:
p15197
as(dp15198
g16
V100297
p15199
stp15200
a((dp15201
g2
(lp15202
V is simply a method that takes one argument, and you can easily define one yourself:
p15203
aVNo magic methods required
p15204
as(dp15205
g16
V100297
p15206
stp15207
a((dp15208
g2
(lp15209
VYou'd have to initialize the map in the  method:
p15210
aVor use a string-and-getattr approach:
p15211
as(dp15212
g16
V100297
p15213
stp15214
a((dp15215
g2
(lp15216
V is an unbound method of the  type,  is an anonymous function
p15217
aVThe end effect is the same: for each element in , the  callable is called, passing in the element
p15218
aVThe effects could be different if you are not sorting strings
p15219
aVThe  method only works with strings, while the anonymous lambda function will work with anything that has a  method; use this when you have a mixture of  and , for example
p15220
aVI prefer the first version, it's shorter and a little faster
p15221
aVMoreover, it'll throw an error if my values are not strings, which is usually what you want
p15222
as(dp15223
g16
V100297
p15224
stp15225
a((dp15226
g2
(lp15227
VConcatenate the strings:
p15228
aVor use string formatting:
p15229
aVOn python 3, the  function can also be told to use an empty separator between multiple arguments, instead of a space:
p15230
as(dp15231
g16
V100297
p15232
stp15233
a((dp15234
g2
(lp15235
V is a boolean expression
p15236
aVSince in Python, the  type is a subclass of , the  outcome is interpreted as , so the end effect is:
p15237
aVOr, demonstrated in a different way:
p15238
aVThe  method doesn't work with strings; it works with code objects (or something that contains code, such as a function, method, class, or module), or with bytecode
p15239
aVThe fact that it seems to be able to decode your string is a happy coincidence;  is opcode 120 (the ASCII value for ), the whole string is being interpreted as a set of opcodes and offsets
p15240
aVUse a function instead:
p15241
as(dp15242
g16
V100297
p15243
stp15244
a((dp15245
g2
(lp15246
VYou need to use a  wildcard to select all programs in a group:
p15247
aVNote: it may that your shell requires you to escape the , usually with
p15248
as(dp15249
g16
V100297
p15250
stp15251
a((dp15252
g2
(lp15253
VYou need to catch the  exception:
p15254
aVNote that I store the system exit exception raised in ; it could be that it was raised as a result of a different action, not the  flag
p15255
aVIf  doesn't raise an exception itself, we re-raise the original  exception to clean up properly
p15256
aVThe  statement captures the exception in a local variable
p15257
aVThe local variable thus assigned is normally deleted at the end of the  block (to prevent a reference cycle); if you want to use that exception outside of the  suite you need to store it in a new variable; this is why  is a separate variable defined outside of the  suite
p15258
aVAlternatively, you can opt to remove the  switch from the  argparser altogether by using the  option, then handling help manually there
p15259
as(dp15260
g16
V100297
p15261
stp15262
a((dp15263
g2
(lp15264
VYou are missing a closing parenthesis on the previous line:
p15265
aVRule of thumb: When a syntax error doesn't make immediate sense, check the previous line
p15266
as(dp15267
g16
V100297
p15268
stp15269
a((dp15270
g2
(lp15271
VIf your function can return multiple elements, then you need to use the  argument syntax to pass these elements as positional arguments to the  method:
p15272
aVNow  should return a sequence:
p15273
as(dp15274
g16
V100297
p15275
stp15276
a((dp15277
g2
(lp15278
VYou'll have to explicitly test for the existence using :
p15279
aVThere is no way to force the  function to not create the file for you
p15280
as(dp15281
g16
V100297
p15282
stp15283
a((dp15284
g2
(lp15285
VPython is implemented in C, and records what version of the C compiler was used to compile it (to aid tracking down compiler-specific bugs)
p15286
aVThe implementation itself does not vary based on the compiler
p15287
aVIt can vary based on the platform it is compiled for, and the available external libraries, but there is nothing altering Python behaviour based on the compiler used
p15288
as(dp15289
g16
V100297
p15290
stp15291
a((dp15292
g2
(lp15293
VThere are 2 different ways you can look for lowercase characters:
p15294
aVUse  to find lowercase characters
p15295
aVCombined with a list comprehension, you can gather all lowercase letters:
p15296
aVYou could use a regular expression:
p15297
aVThe first method returns a list of individual characters, the second returns a list of character groups:
p15298
as(dp15299
g16
V100297
p15300
stp15301
a((dp15302
g2
(lp15303
VWhen you access  or  a method is returned; it's unbound in the first case and bound in the second
p15304
aVA python method is essentially a wrapper around a function that also holds a reference to the class it is a method of
p15305
aVWhen bound, it also holds a reference to the instance
p15306
aVWhen you call an method, it'll do a type-check on the first argument passed in to make sure it is an instance (it has to be an instance of the referenced class, or a subclass of that class)
p15307
aVWhen the method is bound, it'll provide that first argument, on an unbound method you provide it yourself
p15308
aVIt's this method object that has the  attribute, which is just a reference to the  wrapped function
p15309
aVBy accessing the underlying function instead of calling the method, you remove the typecheck, and you can pass in anything you want as the first argument
p15310
aVFunctions don't care about their argument types, but methods do
p15311
aVNote that in Python 3, this has changed;  just returns the function, not an unbound method
p15312
aVreturns a method still, still bound, but there is no way to create an unbound method any more
p15313
aVUnder the hood, each function object has a  method, this is what returns the method object:
p15314
as(dp15315
g16
V100297
p15316
stp15317
a((dp15318
g2
(lp15319
VYou can use the  method on the  user folder; it'll call the right plugins, resulting in a cookie being set for the user in a default Plone setup:
p15320
aVThe method needs request, response, username and password parameters
p15321
as(dp15322
g16
V100297
p15323
stp15324
a((dp15325
g2
(lp15326
V on a response returns a decoded unicode value, but perhaps you should let BeautifulSoup do the decoding for you:
p15327
aVreturns the un-decoded raw bytestring, and  is the encoding detected from the headers
p15328
as(dp15329
g16
V100297
p15330
stp15331
a((dp15332
g2
(lp15333
VNo, it's not secure
p15334
aVInstead, you should use the Gnome keyring service, or whatever the current system offers, to store passwords
p15335
aVSee the keyring package for a Python interface to such services:
p15336
aVwill store your password in the most secure keyring available, use  to retrieve it again
p15337
as(dp15338
g16
V100297
p15339
stp15340
a((dp15341
g2
(lp15342
VThe first line of the docstring is used; the responsible method is , which you can override in your testcases:
p15343
aVBy always returning  you turn the feature off entirely
p15344
aVIf you want to format the docstring differently, it's available as
p15345
as(dp15346
g16
V100297
p15347
stp15348
a((dp15349
g2
(lp15350
VBecause  is a text-only format, you cannot tell Excel anything about how to interpret the data, I am afraid
p15351
aVYou'd have to generate actual Excel files (using  for example, documentation and tutorials available on http://www
p15352
aVpython-excel
p15353
aVorg/)
p15354
as(dp15355
g16
V100297
p15356
stp15357
a((dp15358
g2
(lp15359
V just reads the contents of the template; you discarded the actual rendering result
p15360
aVreturns the rendering
p15361
aVDo this instead:
p15362
as(dp15363
g16
V100297
p15364
stp15365
a((dp15366
g2
(lp15367
VUse the  string formatter:
p15368
aVor to make it one string:
p15369
as(dp15370
g16
V100297
p15371
stp15372
a((dp15373
g2
(lp15374
VApart from this being a terrible way to communicate a list from one python script to another, you'd need to use quotes around the list to prevent it from being split by the shell:
p15375
aVI've used string formatting to put the quotes around  and
p15376
aVYou really want to look into the  module to invoke other processes without the shell getting in the way
p15377
as(dp15378
g16
V100297
p15379
stp15380
a((dp15381
g2
(lp15382
VThe line  means to loop over  and put each element in the variable
p15383
aVThus, your inner loop just needs to loop over ; the  prefix is not used here:
p15384
aVThe  variable is actually only used to store loop metadata; the current count, the  and  flags, the  and  flags, etc
p15385
as(dp15386
g16
V100297
p15387
stp15388
a((dp15389
g2
(lp15390
VYou only have one list (you reset  on each loop), and you write that list as if it is a full set of multiple rows
p15391
aVThe CSV module sees that one list as a set of sequences, meaning that each string entry is seen as a sequence of individual characters, and that is what is then written to your csv file:
p15392
aVYou can write each row separately while collecting the  lists:
p15393
aVNow the list will be treated as a sequence of columns, writing each line as you complete it
p15394
aVAlternatively, you'd have to collect each  list into a results list:
p15395
aVThen write that list of lists to your CSV file:
p15396
as(dp15397
g16
V100297
p15398
stp15399
a((dp15400
g2
(lp15401
VUse :
p15402
as(dp15403
g16
V100297
p15404
stp15405
a((dp15406
g2
(lp15407
VYour expressions are terribly over-complicated
p15408
aVThe following is a simplification that matches the exact same patterns:
p15409
aVYour time strings are not being matched because of the look-ahead assertion (the  part); it limits matches to anything that is followed by whitespace, a full stop, a comma, a letter  or the end of the string
p15410
aVYour first string is followed immediately by  in the sentence; there is no whitespace
p15411
aVThe following  value does match:
p15412
aVNote the extra space after the timezone
p15413
as(dp15414
g16
V100297
p15415
stp15416
a((dp15417
g2
(lp15418
VThe filename is set in the code objects produced by
p15419
aVInstead of using  with a string, you should use  to compile your code separately
p15420
aVThat way you can set the filename:
p15421
as(dp15422
g16
V100297
p15423
stp15424
a((dp15425
g2
(lp15426
VYou can use the  keyword to specify your own type converter; if your filename is incorrect, throw a :
p15427
aVThe type converter doesn't have to convert the value
p15428
as(dp15429
g16
V100297
p15430
stp15431
a((dp15432
g2
(lp15433
VThe following code from  throws the exception:
p15434
aVYour  variable is not a bool, but the  function:
p15435
aVwhich you don't even invoke
p15436
aVThe  asks for a boolean as well:
p15437
aV[
p15438
aVgraph_vis \u2013 specify whether to visualize the simulation in Gephi
p15439
as(dp15440
g16
V100297
p15441
stp15442
a((dp15443
g2
(lp15444
VYou are talking about UNIX timestamps, which are expressed as the number of seconds since an epoch, which is defined as midnight January 1, 1970, UTC
p15445
aVIf your values are correct timestamps you'd need to localize them to UTC first, then cast them to the correct timezone:
p15446
aVA little demonstration to illustrate:
p15447
aVIf your timestamps are however using a localized epoch, so not midnight UTC, but midnight in L
p15448
aVA
p15449
aVor New York, then simply use the code you already have
p15450
aVHowever, the timestamp  in New York would mean the exact same thing in L
p15451
ag15449
aV, namely that many seconds since the local epoch
p15452
aVThus, 1350663248 seconds since the epoch in New York time is 2012-10-19 16:14:08 local time, and that same timestamp since the epoch in L
p15453
ag15449
aVis also 2012-10-19 16:14:08 local time
p15454
aVThose two times are still 3 hours apart though:
p15455
aVSo, in the above example, you have two datetime objects with  as the hour, but if you subtract one from the other the difference is still 10800 seconds, or 3 hours
p15456
aVIf you need to show the hour component only, and you want to see different hours for the different timezones, you need to pick a canonical timezone to display the hours in
p15457
aV16:00:00 in L
p15458
ag15449
aVis 19:00:00 in New York, but only if you express your datetime in that timezone:
p15459
as(dp15460
g16
V100297
p15461
stp15462
a((dp15463
g2
(lp15464
VYou have it exactly correct
p15465
aVSee the list comprehension documentation:
p15466
aVWhen a list comprehension is supplied, it consists of a single expression followed by at least one  clause and zero or more  or  clauses
p15467
aVIn this case, the elements of the new list are those that would be produced by considering each of the  or  clauses a block, nesting from left to right, and evaluating the expression to produce a list element each time the innermost block is reached
p15468
aVSo your interpretation of the for loop nesting is spot on
p15469
as(dp15470
g16
V100297
p15471
stp15472
a((dp15473
g2
(lp15474
VJust loop directly over the  results:
p15475
aVThe  method just returns the first element within  it finds, it doesn't continue the search from the last hit you found
p15476
aVSo on each run through the loop it'll find the same element
p15477
aVIf you want to limit the number of results, use slice notation:
p15478
as(dp15479
g16
V100297
p15480
stp15481
a((dp15482
g2
(lp15483
VThe line
p15484
aVcreates copies of the lists, not new lists for each column or row
p15485
aVUse a list comprehension instead:
p15486
aVQuick demonstration of the difference:
p15487
as(dp15488
g16
V100297
p15489
stp15490
a((dp15491
g2
(lp15492
VUse the  function:
p15493
aVor use :
p15494
aV(On python 2 you'd use  instead)
p15495
aVlet's you step through  in steps other than  as well:
p15496
aVYou usually don't need to use an index for sequences though; not with the  library or the  function; most usecases for 'special' index value ranges are covered:
p15497
as(dp15498
g16
V100297
p15499
stp15500
a((dp15501
g2
(lp15502
VYou have a local variable  defined in an  statement in your function:
p15503
aVBecause it is inside an  statement nothing is assigned to it, but because of that variable, the imported  module is not available in your function
p15504
aVRename that variable to resolve the conflict
p15505
as(dp15506
g16
V100297
p15507
stp15508
a((dp15509
g2
(lp15510
VIt'll be one of two problems; we have to guess here since you have not posted any code
p15511
aVYou have a local variable  which is a list
p15512
aVRename that variable in your code, it is masking the built-in  function
p15513
aVYou have a local variable  which is a list, and you are trying to use it as a function
p15514
aVPerhaps you have a function named  as well
p15515
aVIn than case, rename the variable
p15516
as(dp15517
g16
V100297
p15518
stp15519
a((dp15520
g2
(lp15521
VYou are already looping over all values of , no need to then index them again:
p15522
aVCompare the following two:
p15523
aVIf you expected  to be an index into , use  to get that index:
p15524
as(dp15525
g16
V100297
p15526
stp15527
a((dp15528
g2
(lp15529
VPython buffers writes to  and , and flushes the buffer on exit
p15530
aVYou need to force a flush to see your message from python earlier:
p15531
as(dp15532
g16
V100297
p15533
stp15534
a((dp15535
g2
(lp15536
VCreate your memory handler just like you create a stream handler, passing in the stream handler as the target:
p15537
aVYou do not add the stream handler with
p15538
as(dp15539
g16
V100297
p15540
stp15541
a((dp15542
g2
(lp15543
VYou installed the BeautifulSoup library version 4, which has been renamed:
p15544
aVIf you want the old name and matching API, you need to install BeautifulSoup 3 instead:
p15545
aVNote that since your tutorial is using  it may not entirely work with the updated API of BeautifulSoup version 4
p15546
aVIf you run into problems, take a look at the porting to BS4 section of the BeautifulSoup documentation to 'translate' BS 3 code to the 4 API
p15547
as(dp15548
g16
V100297
p15549
stp15550
a((dp15551
g2
(lp15552
VThe override applies to descriptors that are part of the class
p15553
aVPython will always look up , and will not use  to search for a instance-override
p15554
aVHere is an example using a contrived  class and a property (which is a descriptor with a  and a :
p15555
aVAs you can see, even though I add a  entry in the instance , it is completely ignored and the  property is used still
p15556
aVPython is ignoring the instance  because the  property defines both  and a
p15557
aVIf you use a descriptor that doesn't define a  the override works (but it's  is not called:
p15558
as(dp15559
g16
V100297
p15560
stp15561
a((dp15562
g2
(lp15563
VYour nodes always need a unique names, otherwise you cannot name them uniquely to attach edges between them
p15564
aVHowever, you can give each node a label, which is what is displayed when rendered
p15565
aVSo you'll need to add nodes with unique ids:
p15566
aVthen add graph edges connecting those nodes:
p15567
aVTogether with the rest of the edges you defined this makes:
p15568
as(dp15569
g16
V100297
p15570
stp15571
a((dp15572
g2
(lp15573
VWhat you want is not really part of the Buildout set of use-cases
p15574
aVYou want to customize generated code when you start a project, while buildout aims at giving you a reproducible deployment or development environment
p15575
aVThe former one developer would use, the latter is aimed at getting multiple developers or multiple production machines up and running with the same software stack
p15576
aVThat said, certainly a buildout recipe can be constructed that writes out new versions of those files when the part is run
p15577
aVFor example, using  you could specify a template file to be placed in a certain location every time buildout is run
p15578
aVNote that that would overwrite those files if they ever changed
p15579
as(dp15580
g16
V100297
p15581
stp15582
a((dp15583
g2
(lp15584
VIf you can comment out code and your program still works, then yes, that code was optional
p15585
aVremoves all whitespace at the start and end, including spaces, tabs, newlines and carriage returns
p15586
aVLeaving it in doesn't do any harm, and allows your program to deal with unexpected extra whitespace inserted into the file
p15587
aVFor example, by using , the following two lines in a file would lead to the same end result:
p15588
aVI'd say leave it in
p15589
as(dp15590
g16
V100297
p15591
stp15592
a((dp15593
g2
(lp15594
VYou are not collecting the data anywhere; you store everything in a variable named , then only return the last iteration of that variable
p15595
aVPython does not magically make that variable use the  counter
p15596
aVUse a list to collect the strings:
p15597
as(dp15598
g16
V100297
p15599
stp15600
a((dp15601
g2
(lp15602
VA copy of the list will not follow changes made to the original list; python's list are completely separate from one another once a copy has been made
p15603
aVWhat you are trying to do is not possible without custom classes
p15604
as(dp15605
g16
V100297
p15606
stp15607
a((dp15608
g2
(lp15609
VIf you take a look at the python bytecode, it becomes quite obvious very quickly why unpacking is faster:
p15610
aVThe tuple unpacking operation is a simple bytecode (), while the indexing operation has to call a method on the tuple ()
p15611
aVThe unpack operation can take place, inline, in the python evaluation loop, while the subscription call requires looking up of the function on the tuple object to retrieve the value, using
p15612
aVThe  opcode source code special-cases a python tuple or list unpack where the the sequence length matches the argument length exactly:
p15613
aVThe above code reaches into the native structure of the tuple and retrieves the values directly; no need to use heavy calls such as  which have to take into account that the object could be a custom python class
p15614
aVThe  opcode is only optimized for python lists; anything that isn't a native python list requires a  call
p15615
as(dp15616
g16
V100297
p15617
stp15618
a((dp15619
g2
(lp15620
VFrom the Windows system error codes list:
p15621
aVERROR_ALREADY_EXISTS
p15622
aV183 (0xB7)
p15623
aVCannot create a file when that file already exists
p15624
aVYou are trying to create a file that already exists
p15625
aVDelete it first or pick a different filename
p15626
aVAs a bonus tip: Use the  function to correctly join paths:
p15627
aVI've also used string formatting to create your filename
p15628
as(dp15629
g16
V100297
p15630
stp15631
a((dp15632
g2
(lp15633
VA custom encoder is not called recursively
p15634
aVYou are actually better off not using a custom encoder, and instead convert your objects to simple python types before serializing
p15635
aVYou could add a  or similarly named method to your model and calling that every time you need a JSON result:
p15636
aVThen in your view:
p15637
as(dp15638
g16
V100297
p15639
stp15640
a((dp15641
g2
(lp15642
VUse the  module instead, which has a far richer set of objects to handle date(time) arithmetic:
p15643
aVYou can use the excellent  add-on module to get an ever richer set of options for dealing with deltas:
p15644
aVknows about leap years, month lengths, etc
p15645
aVand will do the right thing when adding a month to, say, January 30th (you end up with February 28th or 29th, it won't cross month boundaries)
p15646
as(dp15647
g16
V100297
p15648
stp15649
a((dp15650
g2
(lp15651
VThe following list comprehension would do that:
p15652
as(dp15653
g16
V100297
p15654
stp15655
a((dp15656
g2
(lp15657
VIf you a) use the XML syntax highlighter (View -> Syntax -> XML), and b) declare the ,  and  namespaces properly, then  (the command line tool used by SublimeLinter for this task) will be perfectly happy with TAL templates
p15658
aVFor example, using an HTML body tag:
p15659
aVand I can use ,  and  attributes and tags at will
p15660
as(dp15661
g16
V100297
p15662
stp15663
a((dp15664
g2
(lp15665
VYou don't need to raise anything; just add a  instead of a  right where you are
p15666
aVIn addition, you can set error messages on individual widgets in an action handler, provided you create a  subclass:
p15667
aVand then in the handler:
p15668
aVYou can do this for all affected widgets
p15669
aVAlternatively, you can have this handled using an invariant:
p15670
aVand the error will be set when you call
p15671
as(dp15672
g16
V100297
p15673
stp15674
a((dp15675
g2
(lp15676
VWhat you are doing is perfectly fine, and you'll find the technique used in plenty of Python frameworks
p15677
aVHowever, you may want to use  to check if this is really faster
p15678
aVWhen you access , Python will first look for it in the class definition to make sure it's not a data descriptor (such as a property), then look it up in the instance namespace, but this is a very fast lookup since  is not defined in the class (setting  stores it in the instance  namespace)
p15679
aVThe  statement is almost certainly slower than that double lookup, since the  statement itself needs to look up  in the same manner, but the difference will be negligible
p15680
as(dp15681
g16
V100297
p15682
stp15683
a((dp15684
g2
(lp15685
VYou need to use a capturing group (parenthesis) around the part of the match you want  to return:
p15686
as(dp15687
g16
V100297
p15688
stp15689
a((dp15690
g2
(lp15691
VYou need to reverse the nesting;
p15692
aVSee the list comprehension documentation:
p15693
aVWhen a list comprehension is supplied, it consists of a single expression followed by at least one  clause and zero or more  or  clauses
p15694
aVIn this case, the elements of the new list are those that would be produced by considering each of the  or  clauses a block, nesting from left to right, and evaluating the expression to produce a list element each time the innermost block is reached
p15695
aVIn other words, since you basically want the moral equivalent of:
p15696
aVyour list comprehension should follow the same ordering
p15697
as(dp15698
g16
V100297
p15699
stp15700
a((dp15701
g2
(lp15702
VBoth are proper; the latter form let's you attach arguments to your exception:
p15703
aVYou can also pass in the arguments as a second value as a tuple in the raise statement:
p15704
aVbut a single non-tuple value will work too, and is regarded as a single argument:
p15705
aVand a third value to  let's you specify an alternate traceback, which then is used instead of a  traceback that would be generated for the current location in the code:
p15706
aVSee the documentation for the  statement
p15707
aVNote that when you do use arguments for your exception, The Python styleguide PEP 8 prefers you provide an exception instance, and not a class:
p15708
aVWhen raising an exception, use  instead of the older form
p15709
aVThe paren-using form is preferred because when the exception arguments are long or include string formatting, you don't need to use line continuation characters thanks to the containing parentheses
p15710
aVThe older form will be removed in Python 3
p15711
aVPython 3 will no longer support that form
p15712
as(dp15713
g16
V100297
p15714
stp15715
a((dp15716
g2
(lp15717
VThe  package is just that, a package
p15718
aVIt's  does not import  and thus you cannot simply reach  by only importing
p15719
aVIt is intended as a namespace only
p15720
aVImport  instead
p15721
as(dp15722
g16
V100297
p15723
stp15724
a((dp15725
g2
(lp15726
VYou'll find everything in the  file
p15727
aVIt's methods are enumerated in the  structure
p15728
aVYou may also want to study the  structure for further pointers to implementations of various hooks
p15729
aVSince  and  are part of both the C sequence protocol, the  structure points to a new structure  that defines those hooks, listed in the  slot of
p15730
aVThe  function implements the  hook, and  is represented by
p15731
aVSlices, on the other hand, are handled by the mapping protocol, and you'll end up (via ) at  and
p15732
as(dp15733
g16
V100297
p15734
stp15735
a((dp15736
g2
(lp15737
VSplit the line on whitespace, once:
p15738
aVmeans: split the line once on whitespace; where whitespace can be consecutive tabs or spaces of any number
p15739
aVThis ensures that you always have a key and a value, and any extra whitespace in the value is preserved
p15740
aVThe  removes any leading and trailing whitespace; because we limited the  to one split only, the value still retains the newline from the file, otherwise
p15741
aVAlternatively, you could opt to split on the last group of whitespace in the line, allowing the key to contain whitespace, rather than the value
p15742
aVThis could make sense for URL entries, which are not supposed to hold whitespace, but the site title might:
p15743
aVdoes the same thing as  but starts from the end of the string rather than start
p15744
aVYou can do this in a generator, reading your file and storing the key/value pairs in a dictionary in one go:
p15745
as(dp15746
g16
V100297
p15747
stp15748
a((dp15749
g2
(lp15750
VIf you absolutely have to, you could monkeypatch the id; do so as part of the test runner part, in buildout:
p15751
as(dp15752
g16
V100297
p15753
stp15754
a((dp15755
g2
(lp15756
VWhat you are missing is a correlation between the innermost sub-query and the next level up; without the correlation, SQLAlchemy will include the  alias in the innermost sub-query:
p15757
aVNote that  is now missing from the query
p15758
aVFrom the  method documentation:
p15759
aVReturn a Query construct which will correlate the given FROM clauses to that of an enclosing Query or select()
p15760
aVThus,  is assumed to be part of the enclosing query, and isn't listed in the query itself
p15761
aVNow your query works:
p15762
as(dp15763
g16
V100297
p15764
stp15765
a((dp15766
g2
(lp15767
VThe text  is a python string formatting expression
p15768
aVThe  part of the string is a placeholder string, and to fill it python will replace that placeholder with
p15769
aVThe result is returned as a HTTP response, presumably to be used by an AJAX call (it's not a full HTML page)
p15770
as(dp15771
g16
V100297
p15772
stp15773
a((dp15774
g2
(lp15775
VYou have run into a bug in ; when the server does not set an explicit encoding,  uses  to make an educated guess about the encoding
p15776
aVIn this particular case, it gets that wrong;  thinks it's  instead of
p15777
aVThe issue has been reported to the maintainers of  as issue 765
p15778
aVThe maintainers closed that issue, blaming the problem on the server not setting a character encoding for the response
p15779
aVThe work-around is to set  before accessing  so that the contents are correctly decoded without guessing
p15780
aVHowever, as J
p15781
aVF
p15782
aVSebastian correctly points out, if the response really is JSON, then the encoding has to be one of the UTF family of encodings
p15783
aVThe JSON RFC even includes a section on how to detect what encoding was used
p15784
aVI've submitted a pull request to the  project that does just that; if you ask for the JSON decoded response, and no encoding has been set, it'll detect the correct UTF encoding used instead of guessing
p15785
aVWith this patch in place, the URL loads without setting the encoding explicitly:
p15786
as(dp15787
g16
V100297
p15788
stp15789
a((dp15790
g2
(lp15791
VGlobals in page templates, like globals in Python, can be overridden
p15792
aVSo you do the following instead:
p15793
aVThen use a  to provide overrides; you can override as few or as many of the variables as you want:
p15794
as(dp15795
g16
V100297
p15796
stp15797
a((dp15798
g2
(lp15799
VYou'd create a function that returns a specific datetime, localized to the timezone passed in:
p15800
aVThat way you can test if the resulting timezone-aware datetime is correctly being handled;  results elsewhere should show the correct timezone but will have a predictable date and time
p15801
aVYou use the  function as a side-effect when mocking ; whenever code calls  the call is recorded by , and  is called, and it's return value used as the value returned to the caller of
p15802
as(dp15803
g16
V100297
p15804
stp15805
a((dp15806
g2
(lp15807
V should always be a dict or a sequence of 2-value tuples, which are then encoded for you
p15808
aVYou, however, want to upload an already encoded body, so you want the  keyword instead:
p15809
aVIn fact,  is the second parameter, so you could even do:
p15810
aVas you normally only send opaque data with PATCH
p15811
aVThe  and  methods behave in the same way, the second parameter is the  keyword
p15812
as(dp15813
g16
V100297
p15814
stp15815
a((dp15816
g2
(lp15817
VYou are basically counting from 0 to 1188137599999 ((26 ** 5) * 100000 - 1), but with the value over 100000 expressed in base 26 with only letters
p15818
aVIf you separate the number formatting from the counting, you get:
p15819
aVand it'll efficiently generate all your values one by one
p15820
aVDemo:
p15821
aVThe functions also accept arbitrary number and letter lengths:
p15822
aVMy method has the advantage you can format arbitrary numbers to a letters + digits sequence numbers, as well as generate the sequence starting at 0
p15823
aVmgilson's solution is probably faster though, as using  to generate the letter sequence doesn't require you to decompose the upper half of the sequence number into a set of base 26 'digits'
p15824
as(dp15825
g16
V100297
p15826
stp15827
a((dp15828
g2
(lp15829
VYou are creating an invalid url:
p15830
aVYou probably meant:
p15831
aVWhen downloading a large file, it's better to use a buffered copy from filehandle to filehandle:
p15832
aVwill efficiently load from the open urllib connection and write to the open  file handle
p15833
aVNote the  statement, when the code block underneath concludes it'll automatically close the file for you
p15834
as(dp15835
g16
V100297
p15836
stp15837
a((dp15838
g2
(lp15839
VYou can match any such a name with:
p15840
aVThe capturing group surrounds the name inside the brackets in the original text
p15841
aVYou could then use a function passed to  to substitute the names with links, based on a lookup you have:
p15842
aVThe function is passed a match object for each match found; the capturing group is retrieved with
p15843
aVIn this example the name is transformed in a very simple manner, but you could do actual database checks if the name exists, for example
p15844
aVDemo:
p15845
as(dp15846
g16
V100297
p15847
stp15848
a((dp15849
g2
(lp15850
VYes, you could, but only with an ugly hack, and only by storing the function with a new name
p15851
aVYou'd have to use the  function to retrieve the local namespace of the calling frame
p15852
aVThat local namespace is the class-in-construction, and adding items to that namespace means they'll end up in the class dictionary passed to your metaclass
p15853
aVThe following retrieves that namespace:
p15854
aVis a dict-like object, just like
p15855
aVYou can now store something in that namespace (like  or similar) to add extra references to the functions
p15856
as(dp15857
g16
V100297
p15858
stp15859
a((dp15860
g2
(lp15861
VThe user is not determined until after traversal has taken place
p15862
aVIn Plone, the authentication and authorization of a user depends on the context and cannot be determined before traversal is complete
p15863
aVThus, you have to hook into the  instead; it is passed the request after traversal has completed and a user has been determined
p15864
aVYou'll have to retrieve the portal using the  function instead:
p15865
aVTo be explicit: This means you cannot vary the object found during traversal based on the authenticated user, because authentication takes place after traversal is complete
p15866
aVOnce rendering starts, then the user has been authenticated
p15867
aVThis means you cannot register a page for your per-user theme, and expect to be able to use that page in a URL path ()
p15868
aVAnything looked up during response rendering is of course fair game, so viewlets, portlets, views looked up by code other than publication traversal, etc
p15869
aVcan all be varied using your marker interface
p15870
as(dp15871
g16
V100297
p15872
stp15873
a((dp15874
g2
(lp15875
VContent objects consist of multiple persistent records
p15876
aVFor images and files that includes the binary blob file on the file system
p15877
aVWhen a content object is changed, only the persistent records that are affected by the change are written as part of the transaction
p15878
aVOlder records are not cleared at that moment, so you do get multiple copies, yes
p15879
aVSo each time you change the binary content of a file or an image, a new copy is created with that new data, and the old version is retained
p15880
aVIf, however, you only change the title, or the publication date, the blob file is untouched, you won't end up with an extra copy of otherwise unchanged data
p15881
aVYou use ZODB packing to remove old transaction data
p15882
aVNote that by packing, you also remove the ability to undo changes for which the old state has been removed by a pack
p15883
as(dp15884
g16
V100297
p15885
stp15886
a((dp15887
g2
(lp15888
VYou cannot have a backslash as the last character in a raw string unless it is part of an even number of backslashes; it escapes the closing quote
p15889
aVCompare this to:
p15890
aVFrom the string literal documentation:
p15891
aVWhen an  or  prefix is present, a character following a backslash is included in the string without change, and all backslashes are left in the string
p15892
aVFor example, the string literal  consists of two characters: a backslash and a lowercase
p15893
aVString quotes can be escaped with a backslash, but the backslash remains in the string; for example,  is a valid string literal consisting of two characters: a backslash and a double quote;  is not a valid string literal (even a raw string cannot end in an odd number of backslashes)
p15894
aVSpecifically, a raw string cannot end in a single backslash (since the backslash would escape the following quote character)
p15895
as(dp15896
g16
V100297
p15897
stp15898
a((dp15899
g2
(lp15900
VYou are opening the log file with a relative path, but you change directories just before the failure:
p15901
aVOpen the logfile with an absolute path instead, since you obviously cannot write in
p15902
as(dp15903
g16
V100297
p15904
stp15905
a((dp15906
g2
(lp15907
VProcess it line by line:
p15908
aVThe  is using a generator expression; we loop over  per line, then split that line into two values on the first  colon we find, and store the stripped results of that as key and value of a mapping
p15909
aVThe  removes whitespace from the start and end of each part of the split line
p15910
aVThe  itself limits the split on  to 1 such character only, to prevent any extra  colon on the line from confusing the  constructor, which only wants  pairs
p15911
aVDemo:
p15912
aVThe long, non-generator expression version would be:
p15913
as(dp15914
g16
V100297
p15915
stp15916
a((dp15917
g2
(lp15918
VYou'll have to use a tuple to return multiple values:
p15919
aVwhere the parenthesis are usually optional
p15920
aVWhen calling this function, you can then unpack the two values again:
p15921
aVOnce python sees a return statement the function execution ends, a second statement is never reached
p15922
as(dp15923
g16
V100297
p15924
stp15925
a((dp15926
g2
(lp15927
VBy using a list comprehension:
p15928
as(dp15929
g16
V100297
p15930
stp15931
a((dp15932
g2
(lp15933
VThe line  is clearly wrong; remove everything before the  part of that line:
p15934
aVNot sure if it is your formatting on Stack Overflow or in your file, but you are also missing some indentation elsewhere:
p15935
aVThe lines following the  specification should be indented to mark them as the (continuing) value for the  parameter
p15936
aVThe same goes for the  line in the  part:
p15937
as(dp15938
g16
V100297
p15939
stp15940
a((dp15941
g2
(lp15942
VYou are complicating things a little, you only need to return  at the end when things have been proven to not be
p15943
aVTwo elements are equal when their tags match, their lengths match, and each paired child element is the same
p15944
aVPython makes testing if all elements in a sequence are  really easy with the  function, and by using  we can pair up the element children nicely
p15945
aVwill terminate early if any child pair is not equal:
p15946
as(dp15947
g16
V100297
p15948
stp15949
a((dp15950
g2
(lp15951
VYou need to flush the python buffers on each write:
p15952
aVThe subprocesses do not buffer their writes, so their data ends up in the logfiles before whatever python wrote
p15953
aVPython's writes end up in it's buffer and are not flushed until that buffer is full
p15954
as(dp15955
g16
V100297
p15956
stp15957
a((dp15958
g2
(lp15959
VYou are building unicode strings, not byte strings, and the socket interface doesn't support unicode strings
p15960
aVYou'll need to encode the result of the string interpolation:
p15961
as(dp15962
g16
V100297
p15963
stp15964
a((dp15965
g2
(lp15966
VUse  instead of
p15967
aVDo not register any  argument and parse the remaining arguments yourself for such parameters
p15968
as(dp15969
g16
V100297
p15970
stp15971
a((dp15972
g2
(lp15973
VSure it does, wrap the email  in a :
p15974
as(dp15975
g16
V100297
p15976
stp15977
a((dp15978
g2
(lp15979
VIn your  function you are at some point assigning to :
p15980
aVThis makes  a local variable
p15981
aVYou are also referring to it with a test:
p15982
aVbut before it is assigned to
p15983
aVThis is the cause of your exception
p15984
aVEither add  at the start of your function, or declare it a global (if that is what you meant it to be)
p15985
aVBy the looks of it, you don't use  outside of the function, so you probably didn't mean it to be
p15986
aVThe following works;  is also being modified so it needs to be declared :
p15987
aVor, simplified:
p15988
aValready takes the floor of a floating point argument
p15989
aVNote that you end up with an infinite loop if  is not
p15990
aVThe first time  is an odd number, this is going to hit you, for example, and your loop will never exit
p15991
aVTake , for example; you'll try the divisors , , and
p15992
aVWhile  is a divisor,  will remain  and the loop breaks
p15993
aVNext  loop, the divisor is , and  is not ever going to give you , so the loop will continue forever
p15994
as(dp15995
g16
V100297
p15996
stp15997
a((dp15998
g2
(lp15999
VDo not use string formatting to put data into the database, use SQL parameters instead:
p16000
aVFor MySQLdb the syntax is almost the same, just remove the single quotes
p16001
aVEach  is replaced by a properly quoted string value, by the database adapter
p16002
aVThis also prevents SQL injection attacks
p16003
as(dp16004
g16
V100297
p16005
stp16006
a((dp16007
g2
(lp16008
VYou'd be better of using :
p16009
aVwhere  is prefixed to the instruction name to ensure that only allowed methods are called through this method
p16010
aVIf your instruction functions live in the global namespace, use  instead, and use it as a mapping:
p16011
aVHowever, you'd then be better of putting those callables in an explicit mapping:
p16012
aVis rarely, if ever, needed to look up arbitrary objects in python namespaces
p16013
as(dp16014
g16
V100297
p16015
stp16016
a((dp16017
g2
(lp16018
VUse a :
p16019
aVFor python 3 just replace  with :
p16020
aVYou do need to loop over both input dictionaries, because you are moving the values to a new dictionary per name
p16021
as(dp16022
g16
V100297
p16023
stp16024
a((dp16025
g2
(lp16026
VUnfortunately, you are stuck, I'm afraid
p16027
aVThe  of the object being uploaded is ignored altogether
p16028
aVWhat happens is this:
p16029
aVA  object is instantiated by the publisher
p16030
aVThis object's [ method] is called
p16031
aVThe following code, part of that method, creates the object and stores it on the parent (simplified):
p16032
aVAs you can see the  variable is not updated
p16033
aVYou could file an issue in the tracker requesting that  is consulted there
p16034
as(dp16035
g16
V100297
p16036
stp16037
a((dp16038
g2
(lp16039
VThe  was removed in  version 2
p16040
aV2 (see this entry into the HTML5 PLIP and this commit)
p16041
aVZEXP imports into different version stacks are generally fraught with problems, exactly because of changing persistent object locations
p16042
aVYou'll have to import to an earlier version of the software stack, then follow the regular Plone upgrade path to bring yourself up to a more recent version of Plone
p16043
aVThe upgrade scripts take care of removing references to removed viewlets like these, for example
p16044
as(dp16045
g16
V100297
p16046
stp16047
a((dp16048
g2
(lp16049
VAnything using  is a string escape code, which happens to use hex notation; other escape codes include  for newlines,  for a literal quote, etc
p16050
aVA python string is a sequence of bytes and you can specify literal values outside the ASCII printable range using such characters
p16051
aVWhen Python echoes a string value back at you in the interpreter, or you print the result of a  call on a string, Python will use such escapes to represent any byte that cannot be printed as a ASCII character instead:
p16052
aVThe  function returns a very specific string representation, as does  with the difference being that the former includes the  prefix
p16053
aVThere are two more methods to produce such string representations; using the  and  string formatters, which use lowercase or uppercase letters for the representation
p16054
aVThese are all string representations though (a series of ASCII characters), and have the same relation to the original data as  is to integer data; you have changed the type and are further away from your goal of changing the byte ordering
p16055
aVChanging a piece of binary information from little-ending to big-endian requires that you know the size of that piece of information
p16056
aVIf all you have are short integers, then you need to flip every two bytes around, but if you have normal (long) integers, then you have 4 bytes per value and you need to reverse each 4 bytes
p16057
aVUsing the  module is, I think, an excellent approach because you have to specify the value type
p16058
aVThe following would interpret  as a big-endian unsigned short int, then pack it back to a binary representation as a little-endian unsigned short int:
p16059
as(dp16060
g16
V100297
p16061
stp16062
a((dp16063
g2
(lp16064
VDatabase adapters rarely support using parameters for anything that isn't a 'value' (something that needs quoting)
p16065
aVEither use string formatting (dodgy, you run the risk of a sql injection) or use a library like SQLAlchemy that let's you produce valid SQL using Python code
p16066
aVIf you are certain your  value is sane (checked against a list of existing table names, for example), the following would work:
p16067
as(dp16068
g16
V100297
p16069
stp16070
a((dp16071
g2
(lp16072
VThe feedparser sanitizes HTML input and ,  and  tags are stripped by default
p16073
aVYou need to either disable sanitization (only if you truly trust the source), or whitelist the YouTube tags
p16074
aVTo disable sanitization, set  to False:
p16075
aVTo add to the whitelist, add elements to the  set:
p16076
aVBoth methods have inherent risks, and you are opening yourself to attacks this way
p16077
aVThe approach I'd use is to switch of sanitization altogether, but then use some other method to sanitize the HTML, probably using  with a whitelist and listing YouTube in
p16078
as(dp16079
g16
V100297
p16080
stp16081
a((dp16082
g2
(lp16083
VYou need to make the first  match non-greedy (add a ), it'll swallow the numbers otherwise:
p16084
aVI've also made the optional  part a non-capturing group to simplify processing the output:
p16085
as(dp16086
g16
V100297
p16087
stp16088
a((dp16089
g2
(lp16090
VUse the  module for general date parsing:
p16091
aVobjects can be compared in various ways
p16092
aVIf you know the exact format of each date string to be parsed, you can also do the parsing more explicitly using the  method:
p16093
aVNote however that that method ignores timezones
p16094
as(dp16095
g16
V100297
p16096
stp16097
a((dp16098
g2
(lp16099
VYou are looping over multiple elements in the tree
p16100
aVIn your first version you are returning immediately when processing the first element
p16101
aVIn the second version you only return after processing all elements in the tree
p16102
aVEither return from within the loop or determine what needs to be done with the multiple matches:
p16103
as(dp16104
g16
V100297
p16105
stp16106
a((dp16107
g2
(lp16108
VYou are confused between install and uninstall of the persistent configurations, through the Plone control panel, and actual removal of the egg from your buildout
p16109
aVResource directories are registered in the package ZCML files, and are not persistent
p16110
aVYou'll have to remove the package egg from your buildout for these ZCML files to not be loaded
p16111
aVIf you, for some reason, need code provided by the package egg but absolutely do not want the resources to be registered, you'll need to use the  package to unregister the resource directories again
p16112
aVUnless they actively interfere with anything I see no need for you to do so, though
p16113
aVNote that there is absolutely no harm in having the resource URLs still available in your Plone site
p16114
as(dp16115
g16
V100297
p16116
stp16117
a((dp16118
g2
(lp16119
VYou cannot just zip up a installed package; it doesn't include the  file needed by tools like  to install the a python package and ensure the installation is correct and complete
p16120
aVPip only works with source distributions; you usually create such a distribution by running the  command on the existing  file:
p16121
aVThe most recent pip version also supports python eggs, but you'll still need the  file to create those
p16122
as(dp16123
g16
V100297
p16124
stp16125
a((dp16126
g2
(lp16127
VNo, in python the  and  operations short circuit and return the last evaluated item
p16128
aVSee Boolean operations:
p16129
aVThe expression  first evaluates ; if  is false, its value is returned; otherwise,  is evaluated and the resulting value is returned
p16130
aVThe expression  first evaluates ; if  is true, its value is returned; otherwise,  is evaluated and the resulting value is returned
p16131
aVIf you must have a boolean value, use :
p16132
as(dp16133
g16
V100297
p16134
stp16135
a((dp16136
g2
(lp16137
VUse :
p16138
aVand you can omit the  call entirely
p16139
as(dp16140
g16
V100297
p16141
stp16142
a((dp16143
g2
(lp16144
VThis has nothing to do with IDLE; the  and  functions have changed in Python 3 and now return an iterator instead of a list:
p16145
aV: Construct an iterator
p16146
aV: Return an iterator
p16147
aVUse  and  if you want to see the results as lists
p16148
aVAlternatively, you can use list comprehensions:
p16149
as(dp16150
g16
V100297
p16151
stp16152
a((dp16153
g2
(lp16154
VYou can either use the  file object, or , and iterate over the response
p16155
aVTo use the  file-like object will not, by default, decode compressed responses (with GZIP or deflate)
p16156
aVYou can force it to decompress for you anyway by setting the  attribute to  ( sets it to  to control decoding itself)
p16157
aVYou can then use  to have Python stream the data to a file object:
p16158
aVTo iterate over the response with  use a loop; the method ensures that data is decompressed by this stage:
p16159
aVThis'll read the data in 128 byte chunks; if you feel another chunk size works better, do use  with a custom chunk size:
p16160
aVNote that you need to open the destination file in binary mode to ensure python doesn't try and translate newlines for you
p16161
aVWe also set  so that  doesn't download the whole image into memory first
p16162
as(dp16163
g16
V100297
p16164
stp16165
a((dp16166
g2
(lp16167
VThere is  / :
p16168
aVbut this does not use AJAX to add entries
p16169
as(dp16170
g16
V100297
p16171
stp16172
a((dp16173
g2
(lp16174
VYou need to use the  module:
p16175
aVHere  indicates little-endian, and  that we want to pack a unsigned long long (8 bytes)
p16176
aVNote that Python will use ASCII characters for any byte that falls within the printable ASCII range to represent the resulting bytestring, hence the ,  and  parts of the above result:
p16177
as(dp16178
g16
V100297
p16179
stp16180
a((dp16181
g2
(lp16182
VThe sharing tab only affects local roles
p16183
aVThese usually are inherited from parents (acquired), but you can explicitly block these by setting  to  on an object
p16184
aVMake sure, however, you set this on the unwrapped object (no acquisition context):
p16185
as(dp16186
g16
V100297
p16187
stp16188
a((dp16189
g2
(lp16190
VUse the  class, it'll write the values directly for you:
p16191
as(dp16192
g16
V100297
p16193
stp16194
a((dp16195
g2
(lp16196
VIndeed, the  function, for classes, already includes all the classes listed in :
p16197
aVIf the object is a type or class object, the list contains the names of its attributes, and recursively of the attributes of its bases
p16198
aVHowever, it is possible for a class to override that behaviour by specifying a  method (via a metaclass, a classmethod is not enough):
p16199
aVIf the object has a method named , this method will be called and must return the list of attributes
p16200
aVWhen a  method is present,  is not recursed over:
p16201
aVThus, the explicit recursion over  in the  class method could be an attempt at bypassing any custom  implementations
p16202
aVOtherwise, the recursion over  is completely redundant
p16203
aVIn my personal opinion, the recursion over  is redundant even if there are  methods present in the class hierarchy
p16204
aVIn such cases, the  method override is at fault as that method should recurse over the classes listed in  to correctly mimic the behaviour of the  function
p16205
aVTo be honest, I suspect that the author of the function that you found was not aware of the recursive nature of , and added the  recursion needlesly, not as a means to bypass custom  methods
p16206
as(dp16207
g16
V100297
p16208
stp16209
a((dp16210
g2
(lp16211
VA list comprehension:
p16212
aVDemo:
p16213
as(dp16214
g16
V100297
p16215
stp16216
a((dp16217
g2
(lp16218
VA catalogue like  is intended for indexing content, not storing it
p16219
aVIt's intent is to make finding back your content (stored elsewhere) easy and performant, by indexing certain aspects of that content
p16220
aVThe example given is completely standalone, and stores it's data in a separate ZODB file
p16221
aVThis is to support the usecase where the catalog is used for data that itself is not stored in the ZODB
p16222
aVHowever, you are free to store the catalog in the same ZODB you store your content in
p16223
aVYour content objects should follow the basic rules for persistent objects, but you are otherwise free to architect the storage structures
p16224
aVTo create a  catalog for yourself, not using the provided , simply instantiate :
p16225
as(dp16226
g16
V100297
p16227
stp16228
a((dp16229
g2
(lp16230
VYou are assigning to , which makes that variable a local
p16231
aVYou cannot do what you are trying to achieve here with Python 2 (in Python 3 you can mark it as )
p16232
aVThe work-around is to make  a mutable, then mutate it's contents instead of assigning to it:
p16233
aVNow we are mutating , not assigning to the variable
p16234
aVTo put it another way, we are executing the moral equivalent of , wheras your code was executing , an act that marks  as a local variable
p16235
as(dp16236
g16
V100297
p16237
stp16238
a((dp16239
g2
(lp16240
V is a bitwise, logical or:
p16241
aVReduce calls the  with the current running total and the next (integer) value of the output of the  function
p16242
aVSo, it is doing the following in a loop:
p16243
aVwhere  turned the IP address into a sequence of integers;  becomes
p16244
aVThe  is a bitwise left shift, by 8 bits in this case:
p16245
aVSo, for each integer part of an ip address, it shifts the value to the left by 8 positions, and adds the bits of the next part of the address to that number
p16246
aVThis makes perfect sense, since an IP address is nothing but a 32-bit number, and the string notation divides that number up into 4 chunks of 8 bits, and 'prints' the integer value of each of those 8 bits with a  character in between
p16247
aVIt helps to print each stage as a binary number:
p16248
as(dp16249
g16
V100297
p16250
stp16251
a((dp16252
g2
(lp16253
VAs with all generators, you'll need to convert it to a list and store that result instead:
p16254
aVThis is a fundamental principle of generators, they are expected to produce their sequence only once
p16255
aVMoreover, you cannot simply store a generator for memoization purposes, as the underlying lists could change
p16256
aVIn almost all memoization use-cases, you should store the list instead; a generator is usually only a means of efficiently transforming or filtering the underlying sequences, and does not represent the data you want to memoize itself
p16257
aVIt's as if you are storing a function, not it's output
p16258
aVIn your specific case, if all what you are doing is using  to concatenate existing lists, store those lists directly instead
p16259
aVNote that this enables generators to produce endless sequences, so be careful with that you convert to a list
p16260
as(dp16261
g16
V100297
p16262
stp16263
a((dp16264
g2
(lp16265
V returns an iterator, not a bytestring
p16266
aVUse the negative stride slicing trick instead:
p16267
aVThis returns a reversed string instead
p16268
aVCompare:
p16269
as(dp16270
g16
V100297
p16271
stp16272
a((dp16273
g2
(lp16274
VYou need to correct the import; from the developer sourcecode hosting homepage:
p16275
as(dp16276
g16
V100297
p16277
stp16278
a((dp16279
g2
(lp16280
VThe proxy support in tweepy is severely lacking; there is a patch available that aims to fix that problem
p16281
aVThe patch switches Tweepy from using  directly to using  instead, which means it'd honour the  environment variable
p16282
as(dp16283
g16
V100297
p16284
stp16285
a((dp16286
g2
(lp16287
VIf you wrap the  variable in a  object then you can treat it like any column, including using the  and  operators:
p16288
aVSQLAlchemy translates  to:
p16289
aVon MySQL or
p16290
aVon other databases
p16291
aVIf you wanted to test for a  operation instead, that works too:
p16292
as(dp16293
g16
V100297
p16294
stp16295
a((dp16296
g2
(lp16297
VYou can use indices to get items from a tuple:
p16298
aVjust as you can do with lists and strings (see sequence types)
p16299
aVThe documentation of  is a little on the thin side, but from looking at the source code it appears the  objects have ,  and  attributes:
p16300
aVThe  attribute is another custom class, with , , , , ,  and  properties
p16301
as(dp16302
g16
V100297
p16303
stp16304
a((dp16305
g2
(lp16306
VYou are looking for the  and  functions
p16307
aV, without an argument, returns the equivalent of
p16308
aVis essentially the same as  at module scope, but in a function it returns the module scope variables
p16309
as(dp16310
g16
V100297
p16311
stp16312
a((dp16313
g2
(lp16314
VUse a HTML parser instead, Python has several to choose from:
p16315
aVElementTree is part of the standard library
p16316
aVBeautifulSoup is a popular 3rd party library
p16317
aVlxml is a fast and feature-rich C-based library
p16318
aVElementTree example:
p16319
as(dp16320
g16
V100297
p16321
stp16322
a((dp16323
g2
(lp16324
V'Time 0' is usually the UNIX epoch
p16325
aVFrom the  module documentation:
p16326
aVThe epoch is the point where the time starts
p16327
aVOn January 1st of that year, at 0 hours, the \u201ctime since the epoch\u201d is zero
p16328
aVFor Unix, the epoch is 1970
p16329
aVTo find out what the epoch is, look at gmtime(0)
p16330
as(dp16331
g16
V100297
p16332
stp16333
a((dp16334
g2
(lp16335
VWord is a terrible code editor
p16336
aVThe quotes were replaced by a 'fancy' quote, not the normal double-quote from the ASCII alphabet, but one from elsewhere in the Unicode standard:
p16337
aVMy Unicode application tells me that's the RIGHT DOUBLE QUOTATION MARK symbol; Word normally uses matching LEFT DOUBLE QUOTATION MARK symbols as well
p16338
aVIf you want to use double qoutes in your python string, simply enclose the whole string in single quote marks:
p16339
aVOr you can use tripple-quoting:
p16340
aVThat way you don't have to bother with all those escapes
p16341
as(dp16342
g16
V100297
p16343
stp16344
a((dp16345
g2
(lp16346
VThe  variable always contains the name of the module, except when the file has been loaded into the interpreter as a script instead
p16347
aVThen that variable is set to the string  instead
p16348
aVAfter all, the script is then run as the main file of the whole program, everything else are modules imported directly or indirectly by that main file
p16349
aVBy testing the  variable, you can thus detect if a file has been imported as a module, or was run directly
p16350
aVInternally, modules are given a namespace dictionary, which is stored as part of the metadata for each module, in
p16351
aVThe main file, the executed script, is stored in that same structure as
p16352
aVBut when you import a file as a module, python first looks in  to see if that module has already been imported before
p16353
aVSo,  means that we first look in  for the  module
p16354
aVIt'll create a new module structure with a namespace if  isn't there yet
p16355
aVSo, if you both run  as the main file, and later import it as a python module, it'll get two namespace entries in
p16356
aVOne as , then later as
p16357
aVThese two namespaces are completely separate
p16358
aVYour global  is stored in , but  is looking in  for , where it is
p16359
aVBut when you use ,  becomes the  main file of the program, and  will be imported just once into the  structure
p16360
aVThis time round,  stores  in the  structure, and that's what  will find
p16361
as(dp16362
g16
V100297
p16363
stp16364
a((dp16365
g2
(lp16366
VYou have your poll id and  action reversed
p16367
aVYour url pattern is of the form:
p16368
aVbut your form action points to  instead
p16369
aVReverse those:
p16370
aVNote that the tutorial actually uses a different method to generate that URL; it uses:
p16371
aVwhere the  filter generates the correct URL for you, given the  route configuration and the id of the current poll object ()
p16372
aVUsing  makes it easier for you to later change your routes, without having to then correct all your templates too
p16373
as(dp16374
g16
V100297
p16375
stp16376
a((dp16377
g2
(lp16378
VYou can't, not without a whole lot of painstaking manual timezone defining
p16379
aVPython does not include a timezone database, because it would be outdated too quickly
p16380
aVInstead, Python relies on external libraries, which can have a far faster release cycle, to provide properly configured timezones for you
p16381
aVAs a side-effect, this means that timezone parsing also needs to be an external library
p16382
aVIf  is too heavy-weight for you, use  instead, it'll parse your specific format just fine:
p16383
aVis a whopping 4KB small
p16384
aVCompare that tot 's 148KB
p16385
as(dp16386
g16
V100297
p16387
stp16388
a((dp16389
g2
(lp16390
VYou have a literal  character in your string; double that to prevent Python from trying to interpret it as a format string:
p16391
aVor perhaps you missed out on a  there instead:
p16392
aVYou really want to look into tripple-quoting your string though
p16393
aVPython let's you use  as string delimiters, and in such a literal string newlines are preserved:
p16394
aVThat way you can more clearly that you have several doubled  percent marks in your string that probably need fixing
p16395
as(dp16396
g16
V100297
p16397
stp16398
a((dp16399
g2
(lp16400
VYou need to return the output of your recursive calls:
p16401
aVotherwise python will simply reach the end of your function, which means it'll return ; the default return value for a function
p16402
aVYour code could be simplified to:
p16403
as(dp16404
g16
V100297
p16405
stp16406
a((dp16407
g2
(lp16408
VYou can refer to  by prefixing it with the class name:
p16409
aVStatic methods are nothing but regular functions contained within the namespace of a class after all
p16410
aVAlternatively, define  as a regular function instead:
p16411
aVwhich avoids the whole issue altogether
p16412
as(dp16413
g16
V100297
p16414
stp16415
a((dp16416
g2
(lp16417
VCurrent best practice is to use buildout to define a fully reproducible deployment
p16418
aVGenerally, you use a  and a  configuration that share configuration via inclusion, to tweak the deployment to the specific needs of either environment; you can expand on this model as needed
p16419
aVA big project might have a  to deploy new features to a test environment first, for example
p16420
aVWhether or not you use ZEO in development depends entirely on your use cases
p16421
aVMost development setups certainly do not need it, but in a large deployment that includes async workers you may find you need a ZEO server when developing anyway
p16422
aVAgain, buildout will make switching your development environment around for changing needs easier, especially when combined with supervisord to manage the various daemons used in the setup
p16423
aVFor the biggest deployment I manage, we use a combination of subversion and git, but only for historic reasons
p16424
aVThis is all being moved to one git repository
p16425
aVIn the end, the repository will hold the complete buildout with it's various configurations, ,  and per-production-machine configuration files (one for each server in the production cluster)
p16426
aVFor a 3-machine ZEO setup, that'd be one  and  and , for example
p16427
aVThe core development eggs are stored in the same repository in
p16428
aVDevelopment takes place exclusively in per-feature and per-issue branches
p16429
aVOnce complete, a branch is merged into the staging branch, and the staging server is updated and restarted
p16430
aVOnce the customer has signed off on each merged branch, and a roll-out has been planned, we merge the approved branches to the main branch and tag a release
p16431
aVThe production cluster machines are then switched to that new tag and restarted
p16432
aVWe also use Jenkins for continuous integration testing; both the main and the staging branches are put through their tests at least once a day, letting us catch problems early
p16433
aVAll daemons are managed by a dedicated supervisord, which is started via a crontab entry (), not the native OS  structure
p16434
aVThis way we can manage the running daemons entirely with buildout
p16435
aVThe buildouts even generate logrotate configurations and munin monitoring plugins; these are symlinked into the OS locations as needed
p16436
aVBecause a buildout is entirely self-contained, it doesn't matter where you set up the production buildout on a machine
p16437
aVDo pick something consistent, document it and stick to that
p16438
aVMake sure you have sufficient disk space for your daemon needs and otherwise not worry too much about it
p16439
as(dp16440
g16
V100297
p16441
stp16442
a((dp16443
g2
(lp16444
VAn integer literal starting with a 0 is interpreted as an octal number, base 8:
p16445
aVThis has been changed in Python 3, where integers with a leading 0 are considered errors:
p16446
aVYou should never specify an integer literal with leading zeros; if you meant to specify an octal number, use  to start it, otherwise strip those zeros
p16447
as(dp16448
g16
V100297
p16449
stp16450
a((dp16451
g2
(lp16452
VHow about the low, low tech version
p16453
aVUse a cron-job to run the query, put this in a temp file, then move the file into a known location, with a timestamp in the filename
p16454
aVThen, when someone requests the page in question (showing new packages), simply read the newest file in that location:
p16455
aVBy using a move, you guarantee that the newest file in the designated location is always a complete file, avoiding a partial result being read
p16456
as(dp16457
g16
V100297
p16458
stp16459
a((dp16460
g2
(lp16461
VThey are quite different beasts altogether
p16462
aVis the datastore access API
p16463
aVIt is similar to a database driver for a SQL database
p16464
aVIt lets you connect to the datastore and run queries
p16465
aVis a data modeling API
p16466
aVIt let's you model the data you are going to store in the datastore
p16467
aVIt is similar to SQLAlchemy and Django's data modeling layers
p16468
aVIt let's you express the data you need in your application in terms that make it easy to translate manipulations to queries to the datastore
p16469
aVIn other words, with  you create a model, and manipulating that model (adding and removing entities, changing attributes of those entities) results in queries to the underlying datastore, using
p16470
aVYour  code doesn't use a model; it queries the datastore directly
p16471
aVI believe that the  does have it's own  class, and you can create those with the  parameter and the data returned from the query:
p16472
aVeach entry in the  result set is a dictionary in any case, and the contents depend on the code that stored stuff in the records in the first place
p16473
aVIn the case of the  code I'd expect to see , ,  and  keys
p16474
aVIf you do have a  class defined using the  API, then use that to query your pages instead:
p16475
aVand then you can access the attributes of the result
p16476
as(dp16477
g16
V100297
p16478
stp16479
a((dp16480
g2
(lp16481
VOnce you use , you have to continue using it;  indirectly uses the same interface under the hood (via )
p16482
aVIn other words, by using  at all, you have to do the work  does by hand:
p16483
aVpresuming you use Python 3
p16484
aVThe alternative is to make 2 requests:
p16485
aVPython 2 version:
p16486
as(dp16487
g16
V100297
p16488
stp16489
a((dp16490
g2
(lp16491
VYou need to replace the  characters; they signify a tab character in a python string literal
p16492
aVEither double the slash, or use a raw python string instead:
p16493
aVor
p16494
aV(note the  at the start of the string)
p16495
as(dp16496
g16
V100297
p16497
stp16498
a((dp16499
g2
(lp16500
VStore your operations in a sequence, then use a loop:
p16501
as(dp16502
g16
V100297
p16503
stp16504
a((dp16505
g2
(lp16506
VThe  syntax can be used for calling functions too, provided  is an iterable:
p16507
aVSee the calls syntax specification
p16508
aVFor an actual dictionary, use the  syntax:
p16509
aVwhere  accepts ,  and  arguments or has a  catch-all argument
p16510
aVNote that  does not work if all your function defines is a  positional argument catch-all
p16511
as(dp16512
g16
V100297
p16513
stp16514
a((dp16515
g2
(lp16516
VThe fieldsets can be rigged up to add 'previous' and 'next' buttons with some extra JavaScript magic
p16517
aVHere's what I use in a current project:
p16518
as(dp16519
g16
V100297
p16520
stp16521
a((dp16522
g2
(lp16523
VOn Windows, this is entirely correct
p16524
aVA  directory is created on POSIX systems only
p16525
aVFrom the Windows Notes section of the documentation:
p16526
aVSome paths within the virtualenv are slightly different on Windows: scripts and executables on Windows go in  instead of  and libraries go in  rather than
p16527
aVFor Windows, run  to activate the virtualenv
p16528
aVFrom the documentation again:
p16529
aVOn Windows you just do:
p16530
aVAnd type deactivate to undo the changes
p16531
aVBased on your active shell (CMD
p16532
aVexe or Powershell
p16533
aVexe), Windows will use either  or  (as appropriate) to activate the virtual environment
p16534
as(dp16535
g16
V100297
p16536
stp16537
a((dp16538
g2
(lp16539
VUse  on the , then again on the value associated with the chosen key:
p16540
aVWe need to turn the result of  (a dict view) into a list for you to be able to make a random choice from them
p16541
aVDemo:
p16542
as(dp16543
g16
V100297
p16544
stp16545
a((dp16546
g2
(lp16547
VUse :
p16548
aVNote that this does limit the loop to the shortest of the strings
p16549
aVIf you need all characters, use  instead:
p16550
aVYour version looped over the tuple , so it would print  first, then
p16551
as(dp16552
g16
V100297
p16553
stp16554
a((dp16555
g2
(lp16556
VYou defined  in the local namespace of  only; it is not available globally
p16557
aVIf you want such a nested function to be available at the module level, you'd have to either return it from the function, or define a  variable to store it in:
p16558
aVthen call that as
p16559
aVThe  approach is not recommendable (using a  rarely is) but would look something like:
p16560
aVat which point  will be set when you have called
p16561
as(dp16562
g16
V100297
p16563
stp16564
a((dp16565
g2
(lp16566
VYou should look at Urwid
p16567
aVUrwid provides a higher-level toolkit on top of curses and includes an event loop to handle keyboard and mouse input
p16568
aVIt either uses it's own select-based event loop, or can hook into gevent or Twisted
p16569
aVIn addition to handling keyboard input efficiently you'll also have a host of options to handle user input with edit boxes, list controls and more
p16570
as(dp16571
g16
V100297
p16572
stp16573
a((dp16574
g2
(lp16575
VColander, combined with limone does exactly this
p16576
aVYou define a schema using :
p16577
aVthen pass in your JSON data structure:
p16578
as(dp16579
g16
V100297
p16580
stp16581
a((dp16582
g2
(lp16583
VIndeed, the test runner does create an instance of your test class () for each test method that you create
p16584
aVrefers to that instance
p16585
aVFrom the  documentation:
p16586
aVEach instance of  will run a single test method: the method named
p16587
aVThis means you can use additional 'helper' methods on your test class and call these with
p16588
aVYou generally don't have to worry about how the  framework loads and runs your tests, but the  documentation can explain this in further detail
p16589
as(dp16590
g16
V100297
p16591
stp16592
a((dp16593
g2
(lp16594
VYou need to use the full name:
p16595
aVand include the  parethesis to call the function
p16596
aVAlternatively, you can import it slightly differently:
p16597
aVto import the function into the local namespace
p16598
as(dp16599
g16
V100297
p16600
stp16601
a((dp16602
g2
(lp16603
VYou defined the function in a class, so you need to reference it with the classname too:
p16604
aVAlternatively, move the function out of the class definition, at which point you do not need to use  at all:
p16605
aVIn Python, functions do not have to be part of a class definition
p16606
as(dp16607
g16
V100297
p16608
stp16609
a((dp16610
g2
(lp16611
VThe current documentation for  reads:
p16612
aVReturn a random floating point number  such that  for  and  for
p16613
aVThe end-point value  may or may not be included in the range depending on floating-point rounding in the equation
p16614
aVFloating point arithmetic on computers is limited in precision and rounding errors caused by this imprecision may lead to  not being included in the full range of values used for the random value that  returns
p16615
aVreturns a value between 0
p16616
aV0 (inclusive) and 1
p16617
aV0 (exclusive)
p16618
aVThere are values for  and  where a floating point calculation of the sum  does not equal , but will be a minute amount lower than , while for other combinations the sum does equal to
p16619
aVis the minimum precision of a floating point number on your platform (see ), and  the maximum value  can return
p16620
aVIf you are interested in the details of why floating point arithmetic on computers is imprecise, I can recommend the following two articles:
p16621
aVThe Floating Point Guide
p16622
aVWhat Every Computer Scientist Should Know About Floating-Point Arithmetic
p16623
as(dp16624
g16
V100297
p16625
stp16626
a((dp16627
g2
(lp16628
VWe always deploy a new Zope instance per site
p16629
aVWebsites always change, and if you deployed multiple sites per instance, you have the following downsides:
p16630
aVAll the sites must follow the same software releases
p16631
aVYou cannot upgrade a component for one site only
p16632
aVSoftware updates cause downtime for all sites hosted in the same instance
p16633
aVIf one of the sites becomes disproportionally more popular, it'll dominate the various caches, to the detriment of the other sites
p16634
aVThey will become disproportionally slower as their data has to be fetched from disk, always
p16635
aVYou cannot simply scale up one site to meet demands without having to scale up the other sites too
p16636
aVWant to go from one instance to two
p16637
aVYou'll not only need to add a load balancer, you need to add a load balancer configured to handle all the sites
p16638
aVUnless you are hosting a series of totally uniform websites that have to move along in lock-step, there are really no upsides to hosting multiple sites in an instance
p16639
as(dp16640
g16
V100297
p16641
stp16642
a((dp16643
g2
(lp16644
VYou'll need to generate a runtime exception, not a compile time exception
p16645
aVA missing quote is a compile time exception and your logging code will never be executed
p16646
aVJust raise an exception instead:
p16647
as(dp16648
g16
V100297
p16649
stp16650
a((dp16651
g2
(lp16652
VYou need to store a reference to your  instance on you App:
p16653
aVNow you can access  from  and call it
p16654
aVget()` method to get the current entry text:
p16655
as(dp16656
g16
V100297
p16657
stp16658
a((dp16659
g2
(lp16660
VUse the  function from the  package:
p16661
aVInternally, this is a class that uses  and  (switching based on ), but creates a suitable timezone object from that
p16662
aVYou use this instead of a  timezone
p16663
aVThe alternative is to read the currently configured timezone from the operating system instead, but this differs widely from OS to OS
p16664
aVOn Mac OS X you need to read the output of :
p16665
aVOn Debian and Ubuntu systems, you can read :
p16666
aVOn RedHat and direved systems, you'll need to read it from :
p16667
as(dp16668
g16
V100297
p16669
stp16670
a((dp16671
g2
(lp16672
VYou are trying to run a shell script using Python, this'll never work
p16673
aVAlthough Play version 1 used Python, version 2 has switched to using a shell script instead
p16674
as(dp16675
g16
V100297
p16676
stp16677
a((dp16678
g2
(lp16679
VYou need to print it with some formatting:
p16680
aVwhich will zero-pad your number up to 4 digits
p16681
aVSee the string formatting documentation for more details
p16682
aVAlternatively, you can use the  method to add the extra zeros after string conversion:
p16683
as(dp16684
g16
V100297
p16685
stp16686
a((dp16687
g2
(lp16688
VYou can use the file as an iterable, and loop over it, or you can call  on it to advance one line at a time
p16689
aVIf you need to read 1 specific line, this means you can skip the lines before it using  calls:
p16690
as(dp16691
g16
V100297
p16692
stp16693
a((dp16694
g2
(lp16695
VMethods in Python accept at least the automatic argument , so the method probably looks something like:
p16696
aVPython takes care of the  argument, and then there is one more argument for you to pass in
p16697
aVWhen you pass in two arguments you end up with 3 total, and that's one too many
p16698
as(dp16699
g16
V100297
p16700
stp16701
a((dp16702
g2
(lp16703
VYou need to add the same layer () to your own theme too; it is not dependent on the Default skin, but the author forgot to add a wild-card definition to register the layer with all skins
p16704
aVIf you already have a  file for your own theme, simply add the same layer definition to it:
p16705
aVMake sure you add this product's generic setup profile to your own profile's  dependencies:
p16706
aVand run your setup profile again
p16707
as(dp16708
g16
V100297
p16709
stp16710
a((dp16711
g2
(lp16712
VThe 'regular' setup doesn't support namespaced packages very well, where multiple eggs share a top-level name (such as  and , etc
p16713
aVUse the  buildout recipe to build a 'regular' setup, it uses symlinks to give you a searchable structure of all eggs used
p16714
aVYou'll find the result in
p16715
aVNote that this structure uses symlinks, so if you use tools like  or  make sure to configure them to follow symlinks (e
p16716
ag1298
aVand )
p16717
aVThe omelette directory structure is not used by Python itself, it is purely intended for presenting a coherent library structure from all eggs used in your buildout
p16718
aVNote that for Windows, you need to install the junction utility as well for the recipe to work
p16719
as(dp16720
g16
V100297
p16721
stp16722
a((dp16723
g2
(lp16724
VWhy not use the  package instead
p16725
aVIt's  function can handle most formats without having to configure the format:
p16726
aVAlternatively, you could try and translate the ICU format strings available via the  command:
p16727
aVThese are the locale settings configured via the  configuration panel
p16728
as(dp16729
g16
V100297
p16730
stp16731
a((dp16732
g2
(lp16733
VThe page uses AJAX to load the songlist asynchronously, from http://www
p16734
aVrockantenne
p16735
aVde/webplayer/xml/livesongcache
p16736
aVxml
p16737
aV82321
p16738
aVLoad that URL instead, and parse the returned XML yourself
p16739
as(dp16740
g16
V100297
p16741
stp16742
a((dp16743
g2
(lp16744
VThis is what  is for
p16745
aVHowever, you may want rethink how you signal that the 'home directory' is a temporary test-only setup
p16746
aVYou could add an extra file ( or similar), use a clear 'temporary' username
p16747
aVOr, better yet, remove the dummy wrapper altogether and have the test create the temporary user directory before running the test, then clean it up when tearing down the test
p16748
as(dp16749
g16
V100297
p16750
stp16751
a((dp16752
g2
(lp16753
VOn python 2
p16754
aV4, use the  package
p16755
aVThis is the exact same package that was added to the Python standard library in version 2
p16756
aV5, when it was renamed to
p16757
aVAs it is the same package, there are no differences in the API, and you only have to use a   test:
p16758
as(dp16759
g16
V100297
p16760
stp16761
a((dp16762
g2
(lp16763
VPython does not use the  environment variable
p16764
aVYou always have to specify a full path to the python script on the command line
p16765
aVThis can be relative from the current directory or an absolute path
p16766
aVThe association between files with the  extension and the Python executable is a separate registration, where Windows executes the Python executable after the script file has been located on the current search path
p16767
aVWindows passes the full, absolute path of the script to the Python executable when it invokes it
p16768
aVWhen you execute the Python executable directly using  you bypass that lookup
p16769
aVYou could try to execute the Python script directly using  without the  executable, but I am not familiar enough with Ruby and Windows to know if that'll honour the  extension registration used by the Windows command prompt
p16770
as(dp16771
g16
V100297
p16772
stp16773
a((dp16774
g2
(lp16775
VYour code is patent nonsense, and will always return
p16776
aVYou are ignoring the opened file, pass in a filename to your function, then replace that with an empty list, so you end up looping over that empty list and not producing any results
p16777
aVIn the end, each of your  statements compares the result () to a string, which will never match and thus fail
p16778
as(dp16779
g16
V100297
p16780
stp16781
a((dp16782
g2
(lp16783
VUse the  keyword to the  function and  method:
p16784
aVDemo:
p16785
aVThis assumes that all top-level dictionaries have a  key, which is assumed to be a dictionary with a  key
p16786
aVSee the Python Sorting HOWTO for more details and tricks
p16787
as(dp16788
g16
V100297
p16789
stp16790
a((dp16791
g2
(lp16792
VFor the simple case, simply iterate and build, either from the end or the start:
p16793
aVor
p16794
aVThe first solution can also be expressed as a one-liner using :
p16795
as(dp16796
g16
V100297
p16797
stp16798
a((dp16799
g2
(lp16800
VYou need to either turn off uwsgi request logging (), or configure uwsgi to log requests elsewhere using  or the UDP logging options provided
p16801
aVWhat happens now is that your uwsgi processes are sending a lot of data on their stdout, so the kernel is waking up your supervisord process a lot to handle the log data (via  calls)
p16802
aVWith 6K qps you really want to have something else handle that volume of log data
p16803
as(dp16804
g16
V100297
p16805
stp16806
a((dp16807
g2
(lp16808
VWhy not re-join the remaining arguments, after splitting it with
p16809
aVAlternatively, you'd have to drive the  instance yourself:
p16810
aVThe  attribute is the file-like object holding the text being parsed, and will thus contain the remainder after parsing the first two arguments
p16811
aVIt is possible that you need to access the pushback state though, where the lexer stores tokens it took a look at but were not needed for the current token:
p16812
as(dp16813
g16
V100297
p16814
stp16815
a((dp16816
g2
(lp16817
VUse :
p16818
as(dp16819
g16
V100297
p16820
stp16821
a((dp16822
g2
(lp16823
VI think you mean co-routines, not co-recursion
p16824
aVYes, it's perfectly possible in Python, since PEP 342: Coroutines via Enhanced Generators has been implemented
p16825
aVThe canonical example is the consumer decorator:
p16826
aVUsing such  then let's you chain filters and push information through them, acting as a pipeline:
p16827
aVThe central principles are python generators, and yield expressions; the latter lets a generator receive information from a caller
p16828
aVEdit: Ah, Co-recursion is indeed a different concept
p16829
aVNote that the Wikipedia article uses python for it's examples, and moreover, uses python generators
p16830
as(dp16831
g16
V100297
p16832
stp16833
a((dp16834
g2
(lp16835
VIf all results have been consumed, the cursor just points to that position
p16836
aVIn other words, the cursor points to where new results would appear if you were to add more items to the datastore
p16837
aVFrom the Datastore Queries documentation:
p16838
aVA cursor marks a location within a query's index from which to begin the next scan for results
p16839
aVAs such, it does not represent a relative offset within the query's result list, but rather the position following a specific result
p16840
aVIf the query's results change between uses of a cursor, only those changes that follow the cursor position in the index will affect the results of subsequent retrievals
p16841
aVThe  method will never return
p16842
as(dp16843
g16
V100297
p16844
stp16845
a((dp16846
g2
(lp16847
VA directory with a  file is called a package
p16848
aVAnd no, the package name is always the same as the directory
p16849
aVThat's how Python can discover packages, it matches it against directory names found on the search path, and if there is a  file in that directory it has found a match and imports the  file contained
p16850
aVYou can always import something into your local module namespace under a shorter, easier to use name using the  or the  syntax:
p16851
as(dp16852
g16
V100297
p16853
stp16854
a((dp16855
g2
(lp16856
VIf you really want to use a list comprehension, combine it with a dict comprehension:
p16857
aVSubstitute  for  if you are on python 3
p16858
aVOn python 2
p16859
aV6 and below you should use:
p16860
aVas the  dict comprehension syntax was only introduced in Python 2
p16861
aV7 and 3
p16862
as(dp16863
g16
V100297
p16864
stp16865
a((dp16866
g2
(lp16867
V is lowercase:
p16868
aVThe error is thrown because the variable  is indeed not defined; python is case sensitive and  is not the same thing as ; the former is seen as a variable name, while  is a keyword
p16869
aVIf you were to run your code with the interpreter, it'll throw a syntax error instead; PyDev's interpretation is slightly different
p16870
as(dp16871
g16
V100297
p16872
stp16873
a((dp16874
g2
(lp16875
VWhat you see there is not a warning message, but the return value of
p16876
aVIt's the number of rows affected, 1
p16877
aVThe API happens to return a Python  integer, but it's otherwise the same as a regular  value:
p16878
aVIf you do not want the Python console to echo return values back to you, assign them to a variable:
p16879
as(dp16880
g16
V100297
p16881
stp16882
a((dp16883
g2
(lp16884
VYou should not use  to compare integers
p16885
aVUse  instead
p16886
aVshould only be used to test if two variables are pointing to the same object
p16887
aVIn Python, small numbers are interred and you often get the same object for the same int literal, but not always and not for larger numbers
p16888
as(dp16889
g16
V100297
p16890
stp16891
a((dp16892
g2
(lp16893
VYou cannot use SQL parameters for table or column names, only for column and result values
p16894
aVYou'll have to use conventional python string formatting to insert the name of the updated table instead
p16895
as(dp16896
g16
V100297
p16897
stp16898
a((dp16899
g2
(lp16900
VBecause a SQL parameter indicates a literal value, one that needs quoting to protect it from being interpreted as a SQL table or column name, or a literal
p16901
aVIn other words, your  value will be quoted:
p16902
aVinstead of
p16903
aVYou'll have to sanitize the value for  yourself to ensure that it only contains a field name and then interpolate it yourself:
p16904
aVThe sanitization is a hard problem; you perhaps should use a framework like SQLAlchemy to generate the SQL for you in a sane manner instead
p16905
as(dp16906
g16
V100297
p16907
stp16908
a((dp16909
g2
(lp16910
VYou are using a regular expression, and matching XML with such expressions get too complicated, too fast
p16911
aVPlease don't make it hard on yourself and use a HTML parser instead, Python has several to choose from:
p16912
aVElementTree is part of the standard library
p16913
aVBeautifulSoup is a popular 3rd party library
p16914
aVlxml is a fast and feature-rich C-based library
p16915
aVElementTree example:
p16916
as(dp16917
g16
V100297
p16918
stp16919
a((dp16920
g2
(lp16921
VThe variable is made global in the current code block only
p16922
aVFrom the  statement documentation:
p16923
aVThe  statement is a declaration which holds for the entire current code block
p16924
aVIt means that the listed identifiers are to be interpreted as globals
p16925
aVIt would be impossible to assign to a global variable without global, although free variables may refer to globals without being declared global
p16926
aVThe variable  in other methods is unaffected
p16927
aVIt'll only be a global in the  method
p16928
aVIf you wanted it to be a global in the other methods as well (,  and ) then you'd need to declare  a global in each method separately
p16929
as(dp16930
g16
V100297
p16931
stp16932
a((dp16933
g2
(lp16934
VYou need to set the version to , not :
p16935
as(dp16936
g16
V100297
p16937
stp16938
a((dp16939
g2
(lp16940
VI'd customize the portlet to only render if a specific marker interface is present on the context, then assign it to the language-neutral root
p16941
aVIf you need to show the portlet on all folders in a section, and below you could check for the interface on all objects in the  list
p16942
aVThen, you assign that marker interface to the sections that you want the portlet to appear
p16943
as(dp16944
g16
V100297
p16945
stp16946
a((dp16947
g2
(lp16948
V supports a 'default' argument:
p16949
aVThe default is to return , but by specifying an empty string your concatenation will work even if  is not defined
p16950
aVYou cannot have the concatenation magically return  if the  return None; you could use a custom class that returns  in a  method but I'm not sure if that'd be very readable
p16951
aVIf you need to skip any of the options (not concatenate) if the environment variable is not defined, you'd be better off splitting out the tests:
p16952
aVThis defines a series of tests, and the value associated with the first test that is successful is used
p16953
as(dp16954
g16
V100297
p16955
stp16956
a((dp16957
g2
(lp16958
V is not defined at function definition time, you cannot use it to create a default argument
p16959
aVExpressions in a function definition are evaluated when the function is created, not when it is being called, see "Least Astonishment" in Python: The Mutable Default Argument
p16960
aVUse the following technique instead:
p16961
aVIf you need to support  as a possible value for  (e
p16962
ag1298
aVis a valid value for  if specified explicitly), you'll need to pick a different unique sentinel to use:
p16963
as(dp16964
g16
V100297
p16965
stp16966
a((dp16967
g2
(lp16968
VYou could use a regular expression:
p16969
aVThis outputs
p16970
aVThe regular expression is actually very simple
p16971
aVThe  character group means: match one character from the set given (so an , or an , or an , etc
p16972
aVThen we look for a second character group optionally matching 1 character, namely a  or
p16973
aVThe question mark after the second character is what makes it optional; we are specifying that it's also fine if the  or the  character is not there
p16974
aVThe  method simply returns all matches that have been found, so you get a list of all character groups in the input string that match the pattern
p16975
as(dp16976
g16
V100297
p16977
stp16978
a((dp16979
g2
(lp16980
VYou have indented your code too far, remove the extra space to match the indentation of
p16981
aVYou may want to review your python tutorials as to when to indent python code, and when not to
p16982
as(dp16983
g16
V100297
p16984
stp16985
a((dp16986
g2
(lp16987
VYou would unit-test the  function itself
p16988
aVYou then only have to test for the fact that  raises a  exception when passed invalid input:
p16989
aVSince you already have a unittest for  itself, your unittests for  do not need to focus on it's functionality
p16990
aVYou can focus on the functionality unique to
p16991
aVIn your case  is a unit providing a service to subclasses; I'd test this as a mock subclass:
p16992
aVso you can check if  indeed called  with the expected  value
p16993
as(dp16994
g16
V100297
p16995
stp16996
a((dp16997
g2
(lp16998
V already lets you do that:
p16999
aVIf you are on python 2, use  to get the same functionality
p17000
aVYou can always implement a function with the same arguments as the  function and use that as a replacement, or use wildcard arguments (, ), then add the  keyword argument as needed
p17001
aVYou can always reach the original builtin  function via the  structure:
p17002
as(dp17003
g16
V100297
p17004
stp17005
a((dp17006
g2
(lp17007
VThe function returned a byte string, not a unicode string
p17008
aVYou need to decode it, given the encoding used for the string
p17009
aVI'm making the presumption here that the encoding used was the filesystem encoding, which is avilable via
p17010
aVIt looks like latin-1 from here, but you can't be certain
p17011
aVYou can also try to pass in a unicode path to  and have Python do the decoding for you:
p17012
aVPlease read up on this and other Unicode issues in the Python Unicode HOWTO
p17013
aVIf you don't understand the difference between a encoded bytestring and a Unicode string, please do read this excellent article as well
p17014
as(dp17015
g16
V100297
p17016
stp17017
a((dp17018
g2
(lp17019
VLine by line:
p17020
aVWe make a subclass of , so  is a kind of , with some local changes
p17021
aVThe  hook is called whenever someone tries to access an item on the instance through  index lookups
p17022
aVSo whenever someone does ,  is called
p17023
aVWe'll skip the  for a moment, next line is:
p17024
aVThis calls the unbound method , and passes in our own instance to it, together with the key
p17025
aVIn other words, we call the original  as defined by our parent class
p17026
aVNow, we all know what happens if there is no  key in a dictionary, a  is raised
p17027
aVThis is where the ,  combo comes in:
p17028
aVSo, if the current instance (which is a sub-type of ) doesn't have a given key, it'll catch the  exception the original  method throws, and instead we create a new value, store that in  and return that value
p17029
aVNow, remember that  is a (subclass) of , so it's a dictionary
p17030
aVIt thus can assign new values (for which it'll use the  hook, incidentially), and in this case it creates a new instance of the same type as
p17031
aVThat's another  subclass
p17032
aVSo what happens in detail when we call
p17033
aVPython goes through this step by step:
p17034
aVleads to
p17035
aVThe custom  method of  catches the , creates a new instance of , stores that under the key  and returns it
p17036
aVreturned an empty  instance
p17037
aVThe next item access  is called on that object, and we repeat what happened in step 1; there is a , a new instance of  is created, stored under the  key, and that new instance is returned to the caller
p17038
aVreturned an empty  instance
p17039
aVThe next item access  is called on that object, and we repeat what happened in step 1 (and in step 2)
p17040
aVThere is a , a new instance of  is created, stored under the  key, and that new instance is returned to the caller
p17041
aVreturned an empty  instance
p17042
aVNow we store a new value in that instance,
p17043
aVOnce you go to your next line of code, , the top-level  instance already has a  key, and the  line will return the corresponding value, which happens to be the  instance created in step one above
p17044
aVFrom there, the  item access call will create a new  instance again (because the object at  only has a  key), and we go through all the same steps again
p17045
as(dp17046
g16
V100297
p17047
stp17048
a((dp17049
g2
(lp17050
VSince ReST is a format that tries to look as much as possible like readable plain text, there is no reliable way to detect if any piece of text is using ReST, let alone something as small as a docstring
p17051
aVI'd say you should just try and render it as ReST and give the end-user the option to switch that off again
p17052
as(dp17053
g16
V100297
p17054
stp17055
a((dp17056
g2
(lp17057
VPhantomJS recently dropped Python support altogether
p17058
aVHowever, PhantomJS now embeds Ghost Driver
p17059
aVA new project has since stepped up to fill the void: Ghost
p17060
aVpy
p17061
aVYou probably want to use that instead:
p17062
as(dp17063
g16
V100297
p17064
stp17065
a((dp17066
g2
(lp17067
VYou need to use a sentinel to detect that a default value was not set:
p17068
aVThis works because an instance of  will always have it's own memory id and thus  will only return True if the exact value was left in place
p17069
aVAny other value will not register as the same object, including
p17070
aVYou'll see different variants of the above trick in various different python projects
p17071
aVAny of the following sentinels would also work:
p17072
as(dp17073
g16
V100297
p17074
stp17075
a((dp17076
g2
(lp17077
VIf you have created the virtualenv with the  switch (the default), then system-wide installed additions such as MySQLdb are not included in the virtual environment packages
p17078
aVYou need to install MySQLdb with the  command installed with the virtualenv
p17079
aVEither activate the virtualenv with the  script, or use  from within the virtualenv to install the MySQLdb library locally as well
p17080
aVAlternatively, create a new virtualenv with system site-packages included by using the  switch
p17081
as(dp17082
g16
V100297
p17083
stp17084
a((dp17085
g2
(lp17086
VYou could set the value of  as a default value to a keyword argument:
p17087
as(dp17088
g16
V100297
p17089
stp17090
a((dp17091
g2
(lp17092
VIt appears the MySQLdb egg requires a newer version of :
p17093
aVand
p17094
aVUpgrade your  egg first; if you are using the unified installer, for example,  pins the version
p17095
aVIf so, edit  to correct the version number there:
p17096
as(dp17097
g16
V100297
p17098
stp17099
a((dp17100
g2
(lp17101
VThis is not a Python problem
p17102
aVYou have a problem with , not Python
p17103
aVIn Python 2, the difference between  and  is null and void
p17104
aVThere is no difference at all because the Python compiler sees the parenthesis as a no-op and the resulting byte-code is exactly the same:
p17105
as(dp17106
g16
V100297
p17107
stp17108
a((dp17109
g2
(lp17110
VThe statement  is interpreted as:
p17111
aVThe first part is always True (non-empty strings are 'truthy', or considered boolean True in a boolean expression)
p17112
aVYou probably wanted:
p17113
aVinstead, or you could use set intersections:
p17114
as(dp17115
g16
V100297
p17116
stp17117
a((dp17118
g2
(lp17119
VSimply split the two values, map them to integers and update a  instance:
p17120
aVBy using  we get the current year
p17121
aVDemo:
p17122
aVAlternatively, you could use the  method to parse these dates, but you'll have to manually correct the year afterwards (it'll use 1900 as the default if no year is being parsed):
p17123
as(dp17124
g16
V100297
p17125
stp17126
a((dp17127
g2
(lp17128
VStrings that start with a  are unicode string literals
p17129
aVSince XML contains unicode data, the XML parser returns your data in the correct type, which is the python  type
p17130
aVYou do not need to remove them, you do not have a problem
p17131
aVYou may want to read up on Unicode and Python in the Python Unicode HOWTO but there is no problem here
p17132
aVSince these are numbers, you can convert the unicode values straight to float instances
p17133
as(dp17134
g16
V100297
p17135
stp17136
a((dp17137
g2
(lp17138
VZODB itself is a in-process object database
p17139
aVYou can, however, use a client-server model to share it across processes
p17140
aVYou have 2 choices:
p17141
aVUse ZEO to create a dedicated process to share the ZODB storage(s)
p17142
aVSee Using ZODB with ZEO for instructions
p17143
aVUse RelStorage to store the object database in Oracle, MySQL or PostgeSQL
p17144
as(dp17145
g16
V100297
p17146
stp17147
a((dp17148
g2
(lp17149
VIf you use BeautifulSoup to get the contents of the  tag, the  module can do the rest with a bit of string magic:
p17150
aVThe  and  combo above split the text on the first  and on the last  in the JavaScript text block, which should be your object definition
p17151
aVBy adding the braces back to the text we can feed it to  and get a python structure from it
p17152
aVDemonstration:
p17153
as(dp17154
g16
V100297
p17155
stp17156
a((dp17157
g2
(lp17158
VSome of the security vulnerabilities do apply to 2
p17159
ag2391
aV5, yes
p17160
aVHowever, there are other unpatched vulnerabilities in 2
p17161
ag2391
aV5 not addressed by this hotfix, and you want to move away from this old a version as soon as possible
p17162
aVThe Plone security team does not provide official support for Plone versions this old; currently 3
p17163
aVx and 4
p17164
aVx releases are supported
p17165
aVYou can unzip the hotfix into your Products folder, and it should just work
p17166
aVI believe people have tested it on 2
p17167
ag2391
aVx installations already; the test coverage certainly was run on 2
p17168
ag1124
aVYou'll have to run your own tests though to make sure nothing (important) breaks for you when the fix is installed
p17169
as(dp17170
g16
V100297
p17171
stp17172
a((dp17173
g2
(lp17174
VThe same way you'd query a table
p17175
aVFrom a  point of view, a  is the exact same thing as a :
p17176
aVNote that you generally do not want to use a black
p17177
aVCatch a specific exception if you have to, but you are usually better off not catching the exception at all rather than block all feedback on errors as you've done here
p17178
as(dp17179
g16
V100297
p17180
stp17181
a((dp17182
g2
(lp17183
VYou opened the file for writing by specifying the mode as ; open the file for reading instead:
p17184
aVis the default, so it can be omitted
p17185
aVIf you need to both read and write, use the  mode:
p17186
aVopens the file for writing (truncates it to 0 bytes) but also lets you read from it
p17187
aVIf you use  it is also opened for both reading and writing, but won't be truncated
p17188
aVIf you are to use a dual-mode such as  or , you need to familiarize yourself with the  method too, as using both reading and writing operations will move the current position in the file and you'll most likely want to move that current file position explicitly between such operations
p17189
aVSee the documentation of the  function for further details
p17190
as(dp17191
g16
V100297
p17192
stp17193
a((dp17194
g2
(lp17195
VYou cannot define properties on an instance;  objects are descriptors, and descriptor  and  hooking is only supported on classes
p17196
aVYou'll have to either define all these properties on the class and disable them (throw an  perhaps from a disabled property), or use  and  instead
p17197
aVThe 'define them all' approach:
p17198
aVThe  and  approach:
p17199
as(dp17200
g16
V100297
p17201
stp17202
a((dp17203
g2
(lp17204
VThe  class was added to the module in Python 2
p17205
ag4892
aVYou are most likely using Python 2
p17206
aV6 or older
p17207
aVFrom the  documentation:
p17208
aVNew in version 2
p17209
ag4892
aVOn python 2
p17210
aV5 or 2
p17211
aV6, use this backport instead
p17212
as(dp17213
g16
V100297
p17214
stp17215
a((dp17216
g2
(lp17217
VYou need to commit your inserts:
p17218
aVOnly when you commit your transactions does sqlite write the rows to the database permanently
p17219
aVQuoting from the documentation:
p17220
aVThis method commits the current transaction
p17221
aVIf you don\u2019t call this method, anything you did since the last call to  is not visible from other database connections
p17222
aVIf you wonder why you don\u2019t see the data you\u2019ve written to the database, please check you didn\u2019t forget to call this method
p17223
aVAlternatively, you could set the connection isolation level to  to auto-commit changes
p17224
as(dp17225
g16
V100297
p17226
stp17227
a((dp17228
g2
(lp17229
VPython does not allow dashes in identifiers
p17230
aVModule names need to be valid identifiers, so any module file or package directory name with a dash in it is not importable
p17231
aVOn the other hand, script files (python files executed directly by Python, not imported) have no such restrictions
p17232
aVI'd say what you encountered is a bug in PyDev and you should report it as such
p17233
as(dp17234
g16
V100297
p17235
stp17236
a((dp17237
g2
(lp17238
VNamespaces are just python objects, and you can assign objects (including the result of attribute lookups) to local variable names:
p17239
aVAlternatively, you'd have to hack together a context manager that modifies , as shown in this answer: http://stackoverflow
p17240
aVcom/a/12486075/100297
p17241
aVSomething like this would do that:
p17242
aVthen use it like this:
p17243
aVwhere all items in the  are made available globally while in the  block
p17244
as(dp17245
g16
V100297
p17246
stp17247
a((dp17248
g2
(lp17249
VThere is no problem; your python interpreter is echoing the string back to you in a manner that can be pasted back into the interpreter
p17250
aVUse  instead if you want to just print the string value instead of the string literal:
p17251
aVNote that there is no difference between python versions in that regard; python 3 behaves in exactly the same manner
p17252
as(dp17253
g16
V100297
p17254
stp17255
a((dp17256
g2
(lp17257
VJust print a literal  and add  to the total:
p17258
aVYou need to keep track of how many times your loop is run, and using  for that is fine, but that does mean you need to increment it on each run through
p17259
aVIf, during each loop, you only want to add one to the total, just do that and don't use the loop counter for that
p17260
as(dp17261
g16
V100297
p17262
stp17263
a((dp17264
g2
(lp17265
VIf no exception was thrown when calling  or , it was inserted when you called
p17266
aVCommitting a transaction successfully is a guarantee from the database layer that the insert was written to disk
p17267
as(dp17268
g16
V100297
p17269
stp17270
a((dp17271
g2
(lp17272
VYou can reed the 5th line with the  method:
p17273
aVThe file iteration method uses buffering to remain efficient, and that buffer is not shared with the  and other read methods of the file object
p17274
aVThus, you'll miss out on data when mixing iteration and read methods
p17275
aVFrom the  method documentation:
p17276
aVIn order to make a for loop the most efficient way of looping over the lines of a file (a very common operation), the  method uses a hidden read-ahead buffer
p17277
aVAs a consequence of using a read-ahead buffer, combining  with other file methods (like ) does not work right
p17278
aVYou could replace the  calls with  calls as well, just be consistent and use one or the other
p17279
as(dp17280
g16
V100297
p17281
stp17282
a((dp17283
g2
(lp17284
VA python  is a highly optimized hash table, which is a data structure
p17285
aVSo, to put it differently, a python  is one example of a data structure
p17286
aVSo are the , ,  and  types
p17287
aVA custom class is again another data structure, one that is highly customizable to your application needs
p17288
aVFrom the WikiPedia entry on Data structure:
p17289
aVIn computer science, a data structure is a particular way of storing and organizing data in a computer so that it can be used efficiently
p17290
as(dp17291
g16
V100297
p17292
stp17293
a((dp17294
g2
(lp17295
VYou can best do that by using intermediate variables:
p17296
as(dp17297
g16
V100297
p17298
stp17299
a((dp17300
g2
(lp17301
VThe detailed "what happens"
p17302
aVThe  function inspects the frame stack and alters the  namespace (a python ) of the class-in-construction
p17303
aVEverything within a  statement in python is executed in that namespace, and the result forms the class body
p17304
aVThe function adds an extra value to the class namespace,  with some data (the interfaces you've passed to the function, and the  callable, something that'll be used later on
p17305
aVIt then either adds or chains in a metaclass for the class in question, by adding the (or altering a pre-existing)  key in the namespace
p17306
aVThis ensures that in the future, every time you create an instance of the class, the metaclass now installed will be called first
p17307
aVIn fact, this metaclass (the class advisor) is a little devious; it removes itself again after the first time you create an instance
p17308
aVIt simply calls the callback specified in the  together with the interfaces you passed to the original  function, right after it either deletes the  key from the class, or replaces it with the original  (which it called to create the first class instance)
p17309
aVThe callback cleans up after itself, it removes the  attribute from the class
p17310
aVThe short version
p17311
aVIn summary, all the work  does is:
p17312
aVAdd the passed interfaces, together with a callback to a special attribute in the class ()
p17313
aVEnsures that the callback is called the first time you create an instance, using a special metaclass
p17314
aVIn the end, it's the moral equivalent of defining your interfaces like this:
p17315
aVexcept that the last call is postponed until you first create an instance of
p17316
aVBut why go to such lengths
p17317
aVWhen  was first developed, Python did not yet have class decorators
p17318
aVneeds to be called separately, as a function, after the class has been created, and a  call within the class body provides better documentation about what interfaces a class implements
p17319
aVYou can place it right at the top of a class declaration, and everyone can see this important piece of information when looking at the class
p17320
aVHaving a  call located after the class declaration is not nearly as visible and clear, and for long class definitions it is easily going to be missed altogether
p17321
aVPEP 3129 finally did add class decorators to the language, and they were added to python 2
p17322
aV6 and 3
p17323
aV0;  was first developed back in the days of python 2
p17324
aV3 (IIRC)
p17325
aVNow that we do have class decorators,  has been deprecated, and you can use the  class decorator instead:
p17326
as(dp17327
g16
V100297
p17328
stp17329
a((dp17330
g2
(lp17331
VYou print the return value of :
p17332
aVbut the  method does not have a return statement
p17333
aVThe default return value of any function or method in python is , if no return statement has been given:
p17334
aVEither remove the  before the method call, or have  return a string to print instead of doing all the printing in the method
p17335
as(dp17336
g16
V100297
p17337
stp17338
a((dp17339
g2
(lp17340
VThe moment you load data from JSON with  you have a python structure
p17341
aVIf at that time it is not a dictionary, then whatever the request sent you did not hold the correct JSON structure (could be a list, for example)
p17342
aVI'd use a  /  in this case:
p17343
aVAn exception will be raised if  is not valid JSON, or if  is not a dictionary with the correct keys
p17344
aVThe three exceptions listed are what would be raised by the various error modes that are possible:
p17345
as(dp17346
g16
V100297
p17347
stp17348
a((dp17349
g2
(lp17350
VUse a list comprehension:
p17351
aVA list comprehension lets you apply an expression to each element in a sequence
p17352
aVDemo:
p17353
as(dp17354
g16
V100297
p17355
stp17356
a((dp17357
g2
(lp17358
VTo PUT large files, don't read them into memory
p17359
aVSimply pass the file as the  keyword:
p17360
aVMoreover, you were opening the file as unicode (decoding it from UTF-8)
p17361
aVAs you'll be sending it to a remote server, you need raw bytes, not unicode values, and you should open the file as a binary instead
p17362
as(dp17363
g16
V100297
p17364
stp17365
a((dp17366
g2
(lp17367
VThe return value of  is the exit code of the process, not whatever it outputs to stdin
p17368
aVYou want to use the  module instead:
p17369
as(dp17370
g16
V100297
p17371
stp17372
a((dp17373
g2
(lp17374
VYou need to split the arguments into a list:
p17375
aVThe  callables do not parse the command out to individual arguments like the shell does
p17376
aVYou either need to do this yourself or you need to tell  to use the shell explicitly:
p17377
aVThe latter is not recommended as it can expose your application to security vulnerabilities
p17378
aVYou can use  to parse a shell-like command line if needed:
p17379
as(dp17380
g16
V100297
p17381
stp17382
a((dp17383
g2
(lp17384
VIn python, booleans are a subclass of int:
p17385
aVThey are basically 1 and 0:
p17386
aVSee Why is bool a subclass of int
p17387
as(dp17388
g16
V100297
p17389
stp17390
a((dp17391
g2
(lp17392
VYou need to use the  method to move a datetime into a timezone:
p17393
aVThe output is then:
p17394
aVSee the  documentation:
p17395
aVUnfortunately using the tzinfo argument of the standard datetime constructors \u2018\u2019does not work\u2019\u2019 with pytz for many timezones
p17396
as(dp17397
g16
V100297
p17398
stp17399
a((dp17400
g2
(lp17401
VNo, there isn't, not without reading all the contents of the directory into memory
p17402
aVThe operating system provides the filenames in directory order, and would need to read the contents into memory in full as well if it wanted to sort these
p17403
aVYou could sort the results after  matched files, provided that set is small enough to fit into memory by calling  on the  output:
p17404
as(dp17405
g16
V100297
p17406
stp17407
a((dp17408
g2
(lp17409
V attaches the timezone to a naive  instance in the local timezone
p17410
aVIf you have datetime values in a local timezone, localize to that timezone, then use  to cast the value to UTC:
p17411
aVNote that you don't need to do this,  objects with a timezone can be compared; they'll both be normalized to UTC for the test:
p17412
as(dp17413
g16
V100297
p17414
stp17415
a((dp17416
g2
(lp17417
VPyTZ uses the Olson timezone database, and it updates regularly
p17418
aVPyTZ is not the only user; most POSIX systems use it too, including Linux and OS X
p17419
aVYes, new revisions of PyTZ are packaged whenever that database updates
p17420
as(dp17421
g16
V100297
p17422
stp17423
a((dp17424
g2
(lp17425
VWhenever you look up a method via  or , the method object is created a-new
p17426
aVPython uses the descriptor protocol to wrap the function in a method object each time
p17427
aVSo, when you look up , a new method object is created, you retrieve it's id (a memory address), then discard the method object again
p17428
aVThen you look up , a new method object created that re-uses the now freed memory address and you see the same value
p17429
aVThe method is then, again, discarded (garbage collected as the reference count drops to 0)
p17430
aVNext, you stored a reference to the  unbound method in a variable
p17431
aVNow the memory address is not freed (the reference count is 1, instead of 0), and you create a second method instance by looking up  which has to use a new memory location
p17432
aVThus you get two different values
p17433
aVSee the documentation for :
p17434
aVReturn the \u201cidentity\u201d of an object
p17435
aVThis is an integer (or long integer) which is guaranteed to be unique and constant for this object during its lifetime
p17436
aVTwo objects with non-overlapping lifetimes may have the same  value
p17437
aVCPython implementation detail: This is the address of the object in memory
p17438
aVEmphasis mine
p17439
aVYou can re-create a method using a direct reference to the function via the  attribute of the class, then calling the  descriptor method:
p17440
aVNote that in Python 3, the whole unbound / bound method distinction has been dropped; you get a function where before you'd get an unbound method, and a method otherwise, where a method is always bound:
p17441
as(dp17442
g16
V100297
p17443
stp17444
a((dp17445
g2
(lp17446
VYou created a handler, but never configured the logging module to use it:
p17447
aVYou need to add this handler to a logger; the root logger for example:
p17448
aVAlternatively, you can add the handler to the warnings logger only; the  documentation states that it uses  for captured warnings:
p17449
aVInstead of creating a handler and formatter explicitly, you can also just call  to configure the root logger:
p17450
aVThe above basic configuration is the moral equivalent of the handler configuration you set up
p17451
as(dp17452
g16
V100297
p17453
stp17454
a((dp17455
g2
(lp17456
VYou created a tuple to loop over:
p17457
aVBefore, you probably tried to loop over the dictionary:
p17458
aVor perhaps:
p17459
aVwhich won't work; you are then looping over just the keys of one dictionary
p17460
aVSince you didn't include the code that didn't work, we can only speculate on that point
p17461
aVEither write the one dictionary directly without looping:
p17462
aVor use a one-element tuple:
p17463
aVSee Tuple syntax to learn why the extra comma is essential there
p17464
aVParenthesis around an expression are optional in Python, and just group that expression to span lines or denote precedence; you need at least one comma to make it a tuple
p17465
aVOn the other hand, a  almost always points to a simple typo; perhaps you forgot to quote the  key in your dictionary
p17466
aVAgain, without a traceback, this is pure speculation
p17467
as(dp17468
g16
V100297
p17469
stp17470
a((dp17471
g2
(lp17472
VNo, clicking is an event in a web browser, not something that happens in the HTML structure for a page
p17473
aVWhen you use BeautifulSoup, you load the same HTML a browser loads, but there is nothing connecting that HTML structure to what is loaded into some random user's browser, which handles the link clicking
p17474
as(dp17475
g16
V100297
p17476
stp17477
a((dp17478
g2
(lp17479
VWhen the webapp2 framework calls one of your handler methods, it uses the return value of that method as the response value to the browser
p17480
aVYou are not returning anything from your methods, however
p17481
aVYou are writing directly to the response instead (which is fine)
p17482
aVWhen you do that, you need to return an empty string:
p17483
aVThe default return value for python functions without an explicit return statement is , which is what you are seeing appended
p17484
aVAlternatively, you could just return the string result instead of writing it to :
p17485
as(dp17486
g16
V100297
p17487
stp17488
a((dp17489
g2
(lp17490
VYour data contains newlines where JSON would not allow these
p17491
aVYou'll have to stitch the lines back together again:
p17492
aVThe code collects lines into , but minus the newline, and tries to decode the JSON
p17493
aVIf that succeeds,  is set to the empty string again to process the next entry
p17494
aVIf it fails, we loop to the next line to append, until there is a complete JSON value to decode
p17495
as(dp17496
g16
V100297
p17497
stp17498
a((dp17499
g2
(lp17500
VUse a sequence of two-value tuples instead:
p17501
aVThe reason  doesn't retain ordering when using a dictionary is because python dictionaries do not have ordering
p17502
aVA tuple or a list, on the other hand, does, so the ordering can be retained
p17503
aVDemo:
p17504
as(dp17505
g16
V100297
p17506
stp17507
a((dp17508
g2
(lp17509
VIn Python, you can just refer directly to the class attribute:
p17510
aVDemo:
p17511
as(dp17512
g16
V100297
p17513
stp17514
a((dp17515
g2
(lp17516
VLook for the  elements instead:
p17517
as(dp17518
g16
V100297
p17519
stp17520
a((dp17521
g2
(lp17522
VYou encode valid python source code contained in a string:
p17523
as(dp17524
g16
V100297
p17525
stp17526
a((dp17527
g2
(lp17528
VSets are just like  and ; on creation they copy the references from the seeding iterable
p17529
aVIterators cannot be sets, because you cannot enforce the uniqueness requirement of a set
p17530
aVYou cannot know if a future value yielded by an iterator has already been seen before
p17531
aVMoreover, in order for you to determine what the intersection is between two iterables, you have to load all data from at least one of these iterables to see if there are any matches
p17532
aVFor each item in the second iterable, you need to test if that item has been seen in the first iterable
p17533
aVTo do so efficiently, you need to have loaded all the items from the first iterable into a set
p17534
aVThe alternative would be to loop through the first iterable from start to finish for each item from the second iterable, leading to exponential performance degradation
p17535
as(dp17536
g16
V100297
p17537
stp17538
a((dp17539
g2
(lp17540
VFirst of all,  is not a function; it is a statement
p17541
aVThere is no need to add the parenthesis
p17542
aVFunctions in python without a return statement return  by default
p17543
aVAn empty  statement does the same, so there is no difference
p17544
as(dp17545
g16
V100297
p17546
stp17547
a((dp17548
g2
(lp17549
V is the hook used to initialize your instance
p17550
aV(it is always called when you create an instance)
p17551
aVis just a class method with a wonky name
p17552
aVYou need to show us your code; if something is broken when you have a method named  you made a mistake there
p17553
aVRenaming it to  just means it won't be called automatically, thus not triggering your coding mistake
p17554
aVIn the comment you refer to, the author did use  in his comment but forgot to escape the leading underscores, and they were interpreted as code to start bold text instead:
p17555
aVbecomes this is bold
p17556
aVNote that the trailing  on  also is lost in that comment
p17557
aVIn your updated code, you are trying to override the  method of a (subclass) of tuple, which is a special case
p17558
aVBy renaming the  method to  you created a different method and did not run into this common problem at all
p17559
aVSee Subclassing Python tuple with multiple __init__ arguments for more detail on why this is a problem; you have to create a  method instead
p17560
aVis the factory method to create instances,  then initializes the data
p17561
aVBut that doesn't work on immutable types such as  or , since you are not supposed to change the instance after the factory created it
p17562
aVIn this specific case, you do not need an  or a  method at all because the  subclass  already takes care of the initialization of the ,  and  attributes
p17563
aVBy renaming  to  you made things work, but you do end up with a pointless  method that you'll never use
p17564
aVJust delete it
p17565
as(dp17566
g16
V100297
p17567
stp17568
a((dp17569
g2
(lp17570
V tries to parse the input as a python expression
p17571
aVUse  instead
p17572
aVIt works with  as input because that's a literal float value, a number, in python
p17573
aVIt could be that you are following a tutorial meant for Python 3, but are using Python 2 instead
p17574
aVIn Python 3, the  function was renamed to  and the old  function was removed altogether
p17575
aVIf so, please install Python 3 and continue from there
p17576
as(dp17577
g16
V100297
p17578
stp17579
a((dp17580
g2
(lp17581
Vbecause I don't know the locale settings
p17582
aVYou could look that up using the  module:
p17583
aVor
p17584
aVUsing that, your code could become:
p17585
aVBetter still, the same module has a conversion function for you, called :
p17586
as(dp17587
g16
V100297
p17588
stp17589
a((dp17590
g2
(lp17591
VIf you actually defined  it'd work:
p17592
aVThe short-circuiting is independent from actually having to define your variables
p17593
aVGenerally,  has been pulled from somewhere but is an empty (falsy) value:
p17594
as(dp17595
g16
V100297
p17596
stp17597
a((dp17598
g2
(lp17599
VPython applies name mangling to class attributes that start with a double underscore, and I strongly suspect that that is the root of your problem here
p17600
aVRemove one of the underscores from your column declaration:
p17601
as(dp17602
g16
V100297
p17603
stp17604
a((dp17605
g2
(lp17606
VYou first set your  values to be an :
p17607
aVbut then you later on you try to treat it as if it is a :
p17608
aVStart out with a  containing your first  instead:
p17609
aVand the  will work
p17610
aVAlternatively, you could use a :
p17611
aVand then append at will without needing to test if the key is already there:
p17612
as(dp17613
g16
V100297
p17614
stp17615
a((dp17616
g2
(lp17617
VYou loop over each entry in the dict, and match the value, and if it doesn't match, then for each key-value pair you print that it doesn't match
p17618
aVIt is the equivalent of the following simplified loop:
p17619
aVUse the  clause of the  loop instead, it'll only be invoked if you completed going through all the values; use a  if you find a match:
p17620
aVA small demonstration of how the  clause works when used with a  loop:
p17621
aVIn the first example, we broke out of the loop with a , but in the second example we never reached the  statement ( never was equal to ) so the  clause is reached and  is printed
p17622
as(dp17623
g16
V100297
p17624
stp17625
a((dp17626
g2
(lp17627
VSimply double the backslash, but do use a raw string literal to avoid having to double them again:
p17628
as(dp17629
g16
V100297
p17630
stp17631
a((dp17632
g2
(lp17633
VEach row returned by the database is a tuple of columns
p17634
aVYou retrieved one row () and that row is a tuple with one element (you selected only the  column)
p17635
aVSimply take it out from the tuple using it's index:
p17636
as(dp17637
g16
V100297
p17638
stp17639
a((dp17640
g2
(lp17641
VPython is an object-oriented programming language
p17642
aVIn such a language, values are objects, and objects can have methods
p17643
aVThe  function is a method on a class, and  is an instance of that class
p17644
aVInstances of a class carry with them all the methods of it's class
p17645
aVThis is why, for example,  objects in python have an  method:
p17646
aVThe  class has a  method, and you do not need to import that method to be able to call it
p17647
aVAll you need is a reference to a list instance
p17648
aVTechnically speaking, a python  is a type, but that distinction does not matter here
p17649
aVOn the whole, types are the same things as classes, for the purpose of this discussion
p17650
aVPlease do go and read the Python Tutorial, it explains classes in a later chapter (but you may want to skim through the first set of chapters first)
p17651
as(dp17652
g16
V100297
p17653
stp17654
a((dp17655
g2
(lp17656
VUpgrade your  package
p17657
aVThis works for me in version  for example:
p17658
aVUse  or  to upgrade
p17659
as(dp17660
g16
V100297
p17661
stp17662
a((dp17663
g2
(lp17664
VList  in the  option:
p17665
aVFrom the  "Writing a Setup Script" documentation:
p17666
aVIf you use a different convention to lay out your source directory, that\u2019s no problem: you just have to supply the package_dir option to tell the Distutils about your convention
p17667
aVFor example, say you keep all Python source under , so that modules in the \u201croot package\u201d (i
p17668
ag7233
aV, not in any package at all) are in , modules in the  package are in , and so forth
p17669
aVThen you would put
p17670
aVin your setup script
p17671
aVThe keys to this dictionary are package names, and an empty package name stands for the root package
p17672
aVThe values are directory names relative to your distribution root
p17673
aVIn this case, when you say , you are promising that the file  exists
p17674
as(dp17675
g16
V100297
p17676
stp17677
a((dp17678
g2
(lp17679
VYou'll have to calculate the e-tag value yourself
p17680
aVE-tags are opaque strings that only have meaning to the application
p17681
aVBest practice is to just concatenate all the input variables (converted to string) that determine the JSON content; anything that, if changed, would result in a change in the JSON output, should be part of this
p17682
aVIf there is anything sensitive in those strings you wouldn't want to be exposed, use the MD5 hash of the values instead
p17683
aVFor example, in a CMS application that I administer, the front page has the following e-tag:
p17684
aVThe input variables that we care about have been concatenated with the  symbol into an opaque value, but it does represent several distinct input values, such as a last-modified timestamp (the number), the browser accepted language header, the current visual theme, and a internal UID that is retrieved from a browser cookie (and which determines what context the content on the front page is taken from)
p17685
aVIf any of those variables would change, the page is likely to be different and the cached copy would be stale
p17686
aVNote that an e-tag is useless without a means to verify it quickly
p17687
aVA client will include it in a  request header, and the server should be able to quickly re-calculate the e-tag header from the current variables and see if the tag is still current
p17688
aVIf that re-calculation would take the same amount of time as regenerating the content body, you only save a little bandwidth sending the  response instead of a full JSON body in a  response
p17689
as(dp17690
g16
V100297
p17691
stp17692
a((dp17693
g2
(lp17694
VJust use  on the  result:
p17695
aVreturns results in the ordering given by the OS
p17696
aVUsing random filenames does not change that ordering, only adding items to or removing items from the directory can influence that ordering
p17697
aVIf your fear that you'll have too many files, do not use a single directory
p17698
aVInstead, set up a tree of directories with pre-generated names, pick one of those at random, then pick a file from there
p17699
as(dp17700
g16
V100297
p17701
stp17702
a((dp17703
g2
(lp17704
VUse either  or , the former is a fork of the latter, with some improvements and better documentation
p17705
aVEither one is a big step up from , which is part of the python standard library
p17706
aVYou want a console script, for which you define an entry point:
p17707
aVwhere  and  would be scripts that you can call on the command line
p17708
aVThe indicated function will be called with  as the first and only argument
p17709
aVLet the installation tools take care of that; it works fine on Windows
p17710
aV:-)
p17711
as(dp17712
g16
V100297
p17713
stp17714
a((dp17715
g2
(lp17716
VYou'll need to call  in the  initializer too
p17717
as(dp17718
g16
V100297
p17719
stp17720
a((dp17721
g2
(lp17722
VUse a list comprehension:
p17723
as(dp17724
g16
V100297
p17725
stp17726
a((dp17727
g2
(lp17728
VNo, there isn't
p17729
aVYou can check what Python does by compiling the code to byte-code using the  module:
p17730
aVAs you can see, the  attribute is looked up and called each time
p17731
aVPython cannot know what a given method will return between calls, the  method is no exception
p17732
aVIf python were to try to optimize that by assuming the value returned would be the same between calls, you'd run into countless different problems, and we haven't even tried to use multi-threading yet
p17733
aVNote that you would be much better off using , and not call the  hook directly:
p17734
as(dp17735
g16
V100297
p17736
stp17737
a((dp17738
g2
(lp17739
VThe class scope is a temporary scope, it only exists while executing the body of the class definition
p17740
aVThe resulting  is used to create the class namespace, the  of the class
p17741
aVAs far as functions defined in a class are concerned, the next scope 'up' is the scope of the  definition itself
p17742
aVThe following works fine:
p17743
aVThis is documented in pep 227:
p17744
aVNames in class scope are not accessible
p17745
aVNames are resolved in
p17746
aVthe innermost enclosing function scope
p17747
aVIf a class definition
p17748
aVoccurs in a chain of nested scopes, the resolution process skips
p17749
aVclass definitions
p17750
aVand in the  compound statement documentation:
p17751
aVThe class\u2019s suite is then executed in a new execution frame (see section Naming and binding), using a newly created local namespace and the original global namespace
p17752
aV(Usually, the suite contains only function definitions
p17753
aVWhen the class\u2019s suite finishes execution, its execution frame is discarded but its local namespace is saved
p17754
aV[4] A class object is then created using the inheritance list for the base classes and the saved local namespace for the attribute dictionary
p17755
aVEmphasis mine; the execution frame is the temporary scope
p17756
as(dp17757
g16
V100297
p17758
stp17759
a((dp17760
g2
(lp17761
VAttempting to make a simple format such as Python pickles safe for passwords is a fools game
p17762
aVUse the  package instead and leave it to the OS to store your password safely
p17763
aVThe  package uses the OS-supplied keyring (OS X, Windows, KDE, Gnome), but will fall back to an encrypted store of it's own if necessary
p17764
as(dp17765
g16
V100297
p17766
stp17767
a((dp17768
g2
(lp17769
VThere is  a bug in the  dump code, tracked as issue 15019 in the Python bug tracker
p17770
aVYou can fix this by editing the  file and adding the following line at the top:
p17771
aVLocate the file by running the following command:
p17772
aVYou'll have to adjust the line writing code to encode the unicode values that now will be returned from the  method:
p17773
aVIf you feel uncomfortable with editing the Python standard library source files, use the following (fixed and shortened) function instead:
p17774
aVUse the above like this:
p17775
as(dp17776
g16
V100297
p17777
stp17778
a((dp17779
g2
(lp17780
VKomodo uses CIX (codeintel XML) files that describe autocompletion information for binary libraries
p17781
aVUnfortunately, I have not been able to locate one for pyodbc; you'd have to create such a file yourself
p17782
aVYou can find instructions on how to do that on in the Komodo FAQ:
p17783
as(dp17784
g16
V100297
p17785
stp17786
a((dp17787
g2
(lp17788
VImported names are bound to the current scope, so an import inside a function binds to a local name only
p17789
aVIf you absolutely have to import something in  that then needs to be globally avaliable, mark the imported name as  first:
p17790
aVbut this usually leads to strange and wonderfully difficult to locate bugs
p17791
aVDon't do that, just make your imports at module scope instead
p17792
aVIf you need the imported name within other class methods, you could also assign the imported name to a instance variable:
p17793
aVbut again, that's not the best practice to use
p17794
as(dp17795
g16
V100297
p17796
stp17797
a((dp17798
g2
(lp17799
VUse :
p17800
aVis a method on the  class; various parameters of , including ,  and  are  instances
p17801
aVThe  project documentation (on which the Pyramid request is based) can provide more information
p17802
as(dp17803
g16
V100297
p17804
stp17805
a((dp17806
g2
(lp17807
VIf this is a string, simply split the line on the first :
p17808
aVThe line is split on the first occurrence of the characters  (with spaces), and the second half of the result is printed
p17809
aVBut perhaps you can instead prevent the code that outputs the string from adding in the date in the first place
p17810
as(dp17811
g16
V100297
p17812
stp17813
a((dp17814
g2
(lp17815
VYou'll need to create an alias for the pickle import to work; the following to the  file of the  package:
p17816
aVIt may be that you'll need to create additional entries though:
p17817
aVNow cPickle will find  and  again at their old locations
p17818
aVYou may want to re-write the pickle file afterwards, the new module location will be used at that time
p17819
aVThe additional aliases created above should ensure that the modules in question have the new location name for  to pick up when writing the classes again
p17820
as(dp17821
g16
V100297
p17822
stp17823
a((dp17824
g2
(lp17825
VYes, https://dev
p17826
aVplone
p17827
aVorg/ is the correct location
p17828
aVUse the  component when filing a ticket
p17829
as(dp17830
g16
V100297
p17831
stp17832
a((dp17833
g2
(lp17834
VEgg files are simply zip-compressed directories containing Python packages, modules and a little metadata, with a  extension
p17835
aVThe zip format is flexible; it will ignore anything at the start of the file that isn't part of the zipfile
p17836
aVThe zipfile is detected by finding a series of characters ( and two more bytes indicating the type) and reading from there
p17837
aVThis means you can put something in front of the zip
p17838
aVThe  eggs are special in that they use this trick to insert some shell script before the zip data:
p17839
aVPast those first 8 lines, it's a genuine zip:
p17840
aVThe script contained in those first 8 lines is what is being executed when you run
p17841
aVAs you can see, the script is specific to the egg version; this in the version for python 2
p17842
aV7, and it simply uses the python interpreter to add this egg to the python search path
p17843
aVIt then imports a function from the contained python module and runs it
p17844
aVHere are the contents of the egg itself, which is as I mentioned just a zip archive:
p17845
as(dp17846
g16
V100297
p17847
stp17848
a((dp17849
g2
(lp17850
VCollect all the data in a list first, then encode that list:
p17851
as(dp17852
g16
V100297
p17853
stp17854
a((dp17855
g2
(lp17856
VThe  elements do not have a  attribute
p17857
aVA child tag of the tag does:
p17858
aVDemonstration:
p17859
as(dp17860
g16
V100297
p17861
stp17862
a((dp17863
g2
(lp17864
VYou'll have to re-apply the regular expression
p17865
aVJust store it in variable and reuse:
p17866
as(dp17867
g16
V100297
p17868
stp17869
a((dp17870
g2
(lp17871
VYou are using extended slicing syntax, which only the  library supports, on the standard Python  type (your ) variable
p17872
aVYou'll have to use  to add new values to it instead:
p17873
aVor simply define the whole list as a set of expressions:
p17874
aVor use a  array instead
p17875
aVStandard python sequence types such as ,  and  only support simple indexing:
p17876
aVor plain slicing:
p17877
as(dp17878
g16
V100297
p17879
stp17880
a((dp17881
g2
(lp17882
VIt looks like you found a bug in the Python  module
p17883
aVI can reproduce your simple case in Python versions 2
p17884
aV7, 3
p17885
aV2 and 3
p17886
aV3, while the problem is not present in Python 2
p17887
aV4, 2
p17888
aV5, 2
p17889
aV6  or 3
p17890
ag1124
aVAt first glance, I don't see a preexisting bug in the python bug tracker
p17891
aVPlease report your problem there, with your minimal test case, as well as what python versions it can be reproduced on
p17892
as(dp17893
g16
V100297
p17894
stp17895
a((dp17896
g2
(lp17897
VUse events; you can register event handlers for when your content type is added, or edited, and you set the value on the object whenever these events trigger your handler
p17898
as(dp17899
g16
V100297
p17900
stp17901
a((dp17902
g2
(lp17903
VYou should not use mutable values in your class variables
p17904
aVSet such values on the instance instead, using the  instance initializer:
p17905
aVOtherwise what happens in that the  list is shared among not only the instances, but with the subclasses as well
p17906
aVIn any case, you'll have to avoid modifying mutables of parent classes even if you do desire to share state among instances through a mutable class variable; only assignment to a name would create a new variable:
p17907
aVwhere a new  variable is created for the  class
p17908
aVBy using assignment, you've created a new list instance and the  mutable is unaffected
p17909
aVDo take care with nested mutables in such cases; use the  module to create deep copies if necessary
p17910
as(dp17911
g16
V100297
p17912
stp17913
a((dp17914
g2
(lp17915
VCheck your  egg versions
p17916
ag5740
aV12
p17917
aV7 added the function , and you'll need to use at least that release in the 2
p17918
aV12
p17919
aVx series, or use version 3
p17920
ag2391
aV1 or newer in the 3
p17921
ag2391
aVx series to be able to unpickle DateTime instances again
p17922
aVThe 3
p17923
ag2391
aVx series uses a much more efficient internal structure, leading to significant memory savings
p17924
aVHowever, 3
p17925
ag2391
aVx DateTime code can read 2
p17926
aVx series pickles, but once you move to 3
p17927
aVx you cannot go back to 2
p17928
aVx as the format is not backwards compatible
p17929
as(dp17930
g16
V100297
p17931
stp17932
a((dp17933
g2
(lp17934
VSets are unordered
p17935
aVFrom the documentation:
p17936
aVBeing an unordered collection, sets do not record element position or order of insertion
p17937
aVLike dictionaries, the ordering is based on the hashes of the stored keys
p17938
aVYou cannot rely on this apparent ordering to remain stable
p17939
aVIf you are interested in the underlying data model, the underlying data structure is called a Hash Table, but in sets only keys are stored, values are left empty
p17940
as(dp17941
g16
V100297
p17942
stp17943
a((dp17944
g2
(lp17945
VUse the  action instead:
p17946
aVshould only be used for options that take one or more arguments (with a fallback to a default value)
p17947
as(dp17948
g16
V100297
p17949
stp17950
a((dp17951
g2
(lp17952
VIndeed, at class construction time, the class object itself has not yet been constructed, thus you cannot use it as the basis of a decorator
p17953
aVOne work-around I can think of, is to not use the  decorator
p17954
aVInstead, internally in your own decorator, re-use the  decorator
p17955
aVThat way you ensure that Python at the very least passes in the associated class for you:
p17956
aVThen use it like this:
p17957
aVDemonstration:
p17958
aVA generic version of your decorator is not easy; the only other workaround to your conundrum is to use a metaclass hack; see another answer of mine where I describe the method in more detail
p17959
aVYou basically need to reach into the class-under-construction namespace, set a temporary metaclass, and then rely on there being at least one instance of the class before your decorator will work; the temporary metaclass approach hooks into the class creation mechanisms to retrieve the constructed class at a later time
p17960
aVSeeing as you are using this decorator as an alternative class factory however, that is probably not going to be ideal; if someone used your decorated functions to create class instances exclusively the metaclass would be called too late
p17961
as(dp17962
g16
V100297
p17963
stp17964
a((dp17965
g2
(lp17966
V looks for tables that are contained in the same parent as the original  element
p17967
aVYou want to look for a table contained in the div
p17968
aVUse  for that:
p17969
aVand for simple cases (such as the contained table) you can use the tagname as an attribute:
p17970
aVYou were calling a tag, which is like using the  method
p17971
aVreturns all matching tags, a list
p17972
aVYou'd have to loop over the result set, but since you are looking for a single div (using its id) you are better off using  which returns just one result
p17973
aVIf you do need to process more than one match, just treat the result of  as a list; loop over it:
p17974
aVor use indices:
p17975
as(dp17976
g16
V100297
p17977
stp17978
a((dp17979
g2
(lp17980
VYou are interpreting the HTML returned as a list; by looping over text you create individual characters:
p17981
aVJust interpolate the  variable directly:
p17982
as(dp17983
g16
V100297
p17984
stp17985
a((dp17986
g2
(lp17987
VYou can customize the view of Dexterity types using a display form
p17988
aVThis is a  form, so we can use the  method to set the widget availability dynamically to hide some of them:
p17989
as(dp17990
g16
V100297
p17991
stp17992
a((dp17993
g2
(lp17994
VYou are confusing encoded byte strings with unicode text
p17995
aVIn UTF-8, for example, up to 3 bytes are used to encode any given character, in UTF-16 each character is encoded using at least 2 bytes each
p17996
aVA python string is a series of bytes, to get unicode you'd have to decode the string with an appropriate codec
p17997
aVIf your text is encoded using UTF-8, for example, you can decode it with:
p17998
aVOn the other hand, data written to a file is always encoded, so a unicode string of length 10 could take up 20 bytes in a file, if written using the UTF-16 codec
p17999
aVMost likely you are getting confused with such 'wider' characters, not with wether or not your  (ASCII 10) characters are counted correctly
p18000
aVPlease do yourself a favour and read up on Unicode and encodings:
p18001
aVJoel on Software: The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p18002
aVThe Python Unicode HOWTO
p18003
as(dp18004
g16
V100297
p18005
stp18006
a((dp18007
g2
(lp18008
VYou need to pass the contents of your list as separate parameters:
p18009
aVWhat happens otherwise is that the whole list is being used as one set instead
p18010
aVThe  syntax indicates to Python that you want to use  as a sequence of parameters to the function, instead using the whole  list as just one parameter
p18011
as(dp18012
g16
V100297
p18013
stp18014
a((dp18015
g2
(lp18016
VWhenever you set an attribute on a  object, it get's saved to the ZODB (provided no exception triggered a transaction abort)
p18017
aVIn the ZODB, objects really should have only one parent, and thus only one, canonical URL
p18018
aVIt is not recommended that you try and make such objects appear to have multiple URLs, at least not by manipulating the  attribute
p18019
aVRather, you should provide a  method to provide alternative URLs instead
p18020
aVYou can use volatile attributes to store non-persistent information on your objects for such a method to use, perhaps
p18021
aVVolatile attributes are any attribute starting with  and are ignored by the persistence engine
p18022
as(dp18023
g16
V100297
p18024
stp18025
a((dp18026
g2
(lp18027
VSimply use the  function:
p18028
aVThis returns a list of roles that have the specific permission for the given context
p18029
aVIt'll walk the acquisition chain as needed
p18030
as(dp18031
g16
V100297
p18032
stp18033
a((dp18034
g2
(lp18035
VUse  instead:
p18036
aVThe python  statement will convert any element in the expression to string and join them using a space; if you want to use a different delimiter you'll have to do the joining manually
p18037
aVAlternatively, use the  function, which has been introduced to ease transition to Python 3:
p18038
aVThe  function accepts a  parameter to alter what string is used to delimit the values
p18039
aVIn python 3, only the  function remains and the old  statement from python 2 has been removed
p18040
as(dp18041
g16
V100297
p18042
stp18043
a((dp18044
g2
(lp18045
VYour  variable is already a mutable; just pass it along with your recursive calls:
p18046
aVAlternatively, you can use a class to hold the state, it'll be easier to then pluck the state from the instance:
p18047
aVThen use this like this:
p18048
as(dp18049
g16
V100297
p18050
stp18051
a((dp18052
g2
(lp18053
VYou already discovered how to import your function correctly:
p18054
aVfrom primenum import isPrime
p18055
aVor refer to the full name:
p18056
aVYou need to use a full path to store your pickle file; otherwise python looks for it in the local directory only
p18057
aVPerhaps store it in your home directory:
p18058
aVthen later open the file with:
p18059
as(dp18060
g16
V100297
p18061
stp18062
a((dp18063
g2
(lp18064
VYou can't use the  module on Windows; apparently there are DOS and OS/2 ports but it is primarily a POSIX-only library
p18065
aVYou'll have to use a Windows-specific port such as , a third-party project that supports Windows too such as PDCurses, or you could try the  module (the latter drives the Windows CMD console in a similar manner)
p18066
as(dp18067
g16
V100297
p18068
stp18069
a((dp18070
g2
(lp18071
VYou can dynamically load variables from the  mapping:
p18072
aVGenerally, you want to avoid such tricks; find other ways to store your  variables, in a mapping or a list for example
p18073
as(dp18074
g16
V100297
p18075
stp18076
a((dp18077
g2
(lp18078
VThe file  is not part of the  package
p18079
aVPlease rename it, it is masking the real library
p18080
aVRight now it is being imported instead of the installed package
p18081
aVThe  package itself consists of a directory with a  file inside of it
p18082
aVPrinting  should result in a path ending in
p18083
as(dp18084
g16
V100297
p18085
stp18086
a((dp18087
g2
(lp18088
VYour AJAX call doesn't include a  query field at all
p18089
aVUpdate your jQuery   parameter:
p18090
as(dp18091
g16
V100297
p18092
stp18093
a((dp18094
g2
(lp18095
VYou still need to provide an expression for each loop, and your  section is rather out of hand
p18096
aVThe following works:
p18097
aVThis is the equivalent of:
p18098
aVPerhaps the  should be , but that's not entirely clear from your example
p18099
aVWe use  or  to avoid using integer division, which would result in  as the answer
p18100
aVAlternatively, you can use  to make the  division operator use float division by default, see PEP 238
p18101
aVNote that I made it a generator expression for you, no need to store a list first
p18102
as(dp18103
g16
V100297
p18104
stp18105
a((dp18106
g2
(lp18107
VTo sort a list of dictionaries, use a  with the key on which to sort; you want to sort the results list, not the contained dictionaries
p18108
aVMoreover, some of the entries do not have a year, and that could lead to errors:
p18109
aVThe  definition will basically do a  for each entry in , giving the  method the value to sort on
p18110
aVYou should not use  to read your JSON response, it'll mis-interpret newlines
p18111
aVLet the  library do the reading instead (note the , no  at the end):
p18112
as(dp18113
g16
V100297
p18114
stp18115
a((dp18116
g2
(lp18117
VYou want to use  on the lines from the  file; a newline is included otherwise:
p18118
as(dp18119
g16
V100297
p18120
stp18121
a((dp18122
g2
(lp18123
VThe first argument is the program to execute (found on the )
p18124
aVThe rest are the  arguments to the program
p18125
aVThe first such argument is the program name used to invoke it, and the display value used in the OS process list
p18126
aVIt is the value of  in a python script
p18127
as(dp18128
g16
V100297
p18129
stp18130
a((dp18131
g2
(lp18132
VYour function should always return a list; for the empty list case, an empty list, and for the case where there is only one element, a list with only one element
p18133
aVBut your code returns the one element, not a list with one element:
p18134
aVChange that to returning just :
p18135
aVYou can combine this with the other end-state test:
p18136
aVNext problem is that you are not creating a copy of a list when you create the variable ; you create a reference to the same list, you'd have to use a slice or create an explicit new list:
p18137
aVIf you are going to remove a value from that list anyway, you may as well adjust the slice a little, and put this after testing  (why do the work otherwise):
p18138
aVNowhere in your code do you actually compute a sum; nothing is added to your numbers
p18139
aVYou never add  to , , etc
p18140
aVMoreover, you seem to be focusing on the last number, while your assignment states you needed to sum the first value to the rest of the list
p18141
aVAnd there is a pattern there
p18142
aVNot only do you add  to , but the sum of  +  is added to , and that sum is then added to , etc
p18143
aVLet's make use of that:
p18144
aVNote that I don't even bother storing a copy of numbers now; may as well just pass it to the next recursion as a slice of everything but the first element
p18145
aVWe also use the first element from  to create our sum ()
p18146
aVAlso, we now pass along the culmulative sum so far, starting at 0; and that means we need to change the end condition of the recursive function; we are essentially adding  to the start of the list, and we want to make sure we sum that with the next element always
p18147
aVThis now does what you need:
p18148
as(dp18149
g16
V100297
p18150
stp18151
a((dp18152
g2
(lp18153
VI'd use the  library for this, as it makes tasks like these easier
p18154
aVThe request you captured seems to be posting JSON data, albeit with a  content type:
p18155
aVwhere  is a JSON string created from the same information as your proxy-captured POST
p18156
aVAlternatively, if you only want to use the standard library, use :
p18157
as(dp18158
g16
V100297
p18159
stp18160
a((dp18161
g2
(lp18162
VOpen the file first, then use it as a context manager:
p18163
as(dp18164
g16
V100297
p18165
stp18166
a((dp18167
g2
(lp18168
VSet the cursor factory when you connect:
p18169
as(dp18170
g16
V100297
p18171
stp18172
a((dp18173
g2
(lp18174
VYou'd have to create indexes or cached counts to speed up such code; trade memory for speed
p18175
aVWherever you handle your list (add to it, remove from it, edit entries) you also maintain your indices
p18176
aVFor example, if you had a counts dict with ids as keys and their frequency as values, all you had to do is look up the count directly, and ensure that the counts stayed up-to-date as you manipulate
p18177
aVThe best way to manage this is by encapsulating your list in a custom type, so that you can control all manipulations of the data structure and maintain the extra information
p18178
as(dp18179
g16
V100297
p18180
stp18181
a((dp18182
g2
(lp18183
VThis appears to be a Mountain Lion only problem, and only if your python was installed fresh on it (or so the reports seem to indicate)
p18184
aVThe work-around is to run python with the  switch:
p18185
aVor to create a virtualenv, then run the  script with the virtualenv python
p18186
as(dp18187
g16
V100297
p18188
stp18189
a((dp18190
g2
(lp18191
VThe new  method is meant to replace the old  formatting syntax
p18192
aVThe latter has been deprecated already
p18193
aVThe method documentation states as much:
p18194
aVThis method of string formatting is the new standard in Python 3, and should be preferred to the  formatting described in String Formatting Operations in new code
p18195
aVHowever, to maintain backwards compatibility and to make transition easier, the old format has been left in place for now
p18196
aVFrom the original PEP 3101 proposal:
p18197
aVBackwards Compatibility
p18198
aVBackwards compatibility can be maintained by leaving the existing
p18199
aVmechanisms in place
p18200
aVThe new system does not collide with any of
p18201
aVthe method names of the existing string formatting techniques, so
p18202
aVboth systems can co-exist until it comes time to deprecate the
p18203
aVolder system
p18204
aVThe new system has as an advantage that you can combine the tuple and dictionary approach of the old  formatter:
p18205
aVNote that the old system had  and the  class, where the latter allows you to create subclasses that add or alter it's behaviour
p18206
aVThe new-style system has the  class to fill the same niche
p18207
aVI'm a Dutch expat too, out of the past 12 years only 2 were spent living in the old Kikkerland
p18208
aVBut I worked with Guido at some point, perhaps that helped
p18209
aV:-P
p18210
as(dp18211
g16
V100297
p18212
stp18213
a((dp18214
g2
(lp18215
VYou'll have to parse out the contents of  a little further
p18216
aVLuckily, the original page uses  tags to give you places to delimit the text
p18217
aVDon't bother with a regex here, BeautifulSoup has better tools for you:
p18218
aVwould result in:
p18219
aVYou can store all these in a list by calling  on the  iterator:
p18220
as(dp18221
g16
V100297
p18222
stp18223
a((dp18224
g2
(lp18225
VYou are mixing tabs and spaces
p18226
aVDon't do this
p18227
aVRun  to detect any inconsistencies, but most of all, use spaces only throughout
p18228
aVConfigure your editor to use spaces for indentation, and replace all existing tabs with spaces
p18229
aVMost code editors have a function for that
p18230
as(dp18231
g16
V100297
p18232
stp18233
a((dp18234
g2
(lp18235
VNo, there is no option to  that'll skip those
p18236
aVYou'll need to do so yourself (which is easy enough):
p18237
aVNote the  slice assignment; we are replacing the elements in  (and not the list referred to by ) so that  will not process deleted directories
p18238
aVThis only works if you keep the  keyword argument to , from the documentation of :
p18239
aVWhen  is , the caller can modify the dirnames list in-place (perhaps using  or slice assignment), and  will only recurse into the subdirectories whose names remain in dirnames; this can be used to prune the search, impose a specific order of visiting, or even to inform  about directories the caller creates or renames before it resumes  again
p18240
as(dp18241
g16
V100297
p18242
stp18243
a((dp18244
g2
(lp18245
VYou should use a metaclass instead
p18246
aVThe standard library comes with a ready-made metaclass for just this task, the  metaclass:
p18247
aVDemonstration:
p18248
aVOnce  does provide implementations of the abstract methods, instantiation succeeds:
p18249
as(dp18250
g16
V100297
p18251
stp18252
a((dp18253
g2
(lp18254
V takes a module object, not a filename:
p18255
as(dp18256
g16
V100297
p18257
stp18258
a((dp18259
g2
(lp18260
VNo, there is no way to force the  method to not output XHTML-compliant HTML
p18261
as(dp18262
g16
V100297
p18263
stp18264
a((dp18265
g2
(lp18266
VYou are trying to parse the OS X  XML data structure
p18267
aVPython already comes with a module that can parse that for you;
p18268
aVUse that instead:
p18269
as(dp18270
g16
V100297
p18271
stp18272
a((dp18273
g2
(lp18274
VThe compiler has no way of knowing whether the time module exports objects named
p18275
aVThe free variables of nested functions are tied to closure cells at compile time
p18276
aVClosure cells themselves point to (local) variables defined in compiled code, as opposed to globals, which are not tied at all
p18277
aVSee the python data model; functions refer to their globals via the  attribute, and the  attribute holds a sequence of closure cells (or )
p18278
aVAs such, you cannot use a dynamic import statement in a nested scope
p18279
aVAnd why do nested functions need closure cells at all
p18280
aVBecause you need a mechanism to refer to local function variables when the function itself has finished:
p18281
aVBy calling  I obtained a nested function that refers to a scoped variable, and the compiler needs to create the necessary references for the interpreter to be able to retrieve that scoped variable again
p18282
aVHence the cells, and the limitations placed on them
p18283
as(dp18284
g16
V100297
p18285
stp18286
a((dp18287
g2
(lp18288
VAn arbitrary order is imposed for objects
p18289
aVThe ordering is only defined to be stable within a program execution
p18290
aVThis means it's up to the Python implementation to define an ordering when comparing arbitrary objects
p18291
aVCPython uses the memory address if the types are the same (from the C source):
p18292
aVThe same value is the basis for the  function, and is also represented in the default  string for custom classes, so it may appear that the  of classes determine ordering
p18293
aVIt's only the memory address that does
p18294
aVFor objects that are not the same type, the type name is used instead (with number-like types sorting before others), and if the types differ but their names are the same, the code falls back to the memory address of the type (as opposed to the memory address of the instance when the types are the same)
p18295
aVThis implicit ordering has been considered an error in the language, and has been remedied in Python 3:
p18296
aVThe ordering comparison operators (, , , ) raise a  exception when the operands don\u2019t have a meaningful natural ordering
p18297
aVThis applies to custom classes that do not implement the necessary ordering hooks:
p18298
as(dp18299
g16
V100297
p18300
stp18301
a((dp18302
g2
(lp18303
VCreating savepoints and commiting the transaction already clears a lot of you memory
p18304
aVYou'll need to check what your ZODB cache parameters are set to, and tune these as necessary
p18305
aVThe cache size parameter indicates the number of objects cached, not bytes, so you'll have to adjust this based on the size of your objects
p18306
aVYou can try and call  on the ZODB connection object, this explicitly deactivates any unmodified (or already committed) objects in the cache
p18307
aVOther than that, do note that even when Python frees objects from memory, the OS doesn't always reclaim that freed memory until it is needed for something else
p18308
aVOS-reported memory usage doesn't necessarily reflect actual memory requirements for a Python process
p18309
as(dp18310
g16
V100297
p18311
stp18312
a((dp18313
g2
(lp18314
VFirst of all, UTF-32 is a 4-byte encoding, so its BOM is a four byte sequence too:
p18315
aVAnd because different computer architectures treat byte orders differently (called Endianess), there are two variants of the BOM, little and big endian:
p18316
aVThe purpose of the BOM is to communicate that order to the decoder; read the BOM and you know if it is big or little endian
p18317
aVSo, those last two null bytes in your UTF-32 string are part of the last encoded character
p18318
aVThe UTF-16 BOM is thus similar, in that there are two variants:
p18319
aVIt depends on your computer architecture which one is used by default
p18320
aVUTF-8 doesn't need a BOM at all; UTF-8 uses 1 or more bytes per character (adding bytes as needed to encode more complex values), but the order of those bytes is defined in the standard
p18321
aVMicrosoft deemed it necessary to introduce a UTF-8 BOM anyway (so its Notepad application could detect UTF-8), but since the order of the BOM never varies its use is discouraged
p18322
aVAs for what is stored by Python for unicode strings; that actually changed in Python 3
p18323
ag35
aVBefore 3
p18324
aV3, internally at the C level, Python either stored UTF16 or UTF32 byte combinations, depending on whether or not Python was compiled with wide character support (see How to find out if Python is compiled with UCS-2 or UCS-4
p18325
aV, UCS-2 is essentially UTF-16 and UCS-4 is UTF-32)
p18326
aVSo, each character either takes 2 or 4 bytes of memory
p18327
aVAs of Python 3
p18328
aV3, the internal representation uses the minimal number of bytes required to represent all characters in the string
p18329
aVFor plain ASCII and Latin1-encodable text 1 byte is used, for the rest of the BMP 2 bytes are used, and text containing characters beyond that 4 bytes are used
p18330
aVPython switches between the formats as needed
p18331
aVThus, storage has become a lot more efficient for most cases
p18332
aVFor more detail see What's New in Python 3
p18333
ag35
aVI can strongly recommend you read up on Unicode and Python with:
p18334
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p18335
aVThe Python Unicode HOWTO
p18336
as(dp18337
g16
V100297
p18338
stp18339
a((dp18340
g2
(lp18341
VJust sort the filenames; the most recent file will be the last one:
p18342
as(dp18343
g16
V100297
p18344
stp18345
a((dp18346
g2
(lp18347
VConverting plural to singular and back is a difficult task in any language
p18348
aVLike with most languages, there are both general rules and exceptions in German, that make creating a straightforward computer algorithm tricky
p18349
aVTo do it properly, you'd have to use the  library (the Natural Language Toolkit)
p18350
aVThis is not something for the faint of heart
p18351
aVIf you do want to go this route, O'Reilly published an excellent book on the library, now available for free online
p18352
as(dp18353
g16
V100297
p18354
stp18355
a((dp18356
g2
(lp18357
VYou are probably using the  project; it creates a temporary directory with the name , with that exact structure (based on a md5 hash)
p18358
aVOn Raspberry you are running your code as root usually, so that fits
p18359
aVAnother python library that uses the exact same structure is python-lastfm; the code was obviously copied between projects
p18360
aVBoth projects have sprouted a few forks, so the method may be more widespread still
p18361
as(dp18362
g16
V100297
p18363
stp18364
a((dp18365
g2
(lp18366
VThe  prefix indicates a XML namespace
p18367
aVUse the elementtree API namespace support to deal with it, not just remove it from your input
p18368
aVAs it happens,  usually refers to Dublin Core metadata
p18369
aVYou need to determine the full namespace URL, then use that URL in your XPath queries:
p18370
aVHere I used the recommended  namespace URL for the dublin core prefix
p18371
aVYou can normally determine the URL from the  property; your root element probably has the following  attribute:
p18372
aVand thus you can change your code to:
p18373
aVThis can be simplified further still by passing the  dictionary to the  method as the  keyword, at which point you can use the prefix in your xpath expression:
p18374
as(dp18375
g16
V100297
p18376
stp18377
a((dp18378
g2
(lp18379
VYou'll need to use a function to flatten your structure:
p18380
aV(The  should be replaced with  if you are using Python 3)
p18381
aVOn python 3
p18382
aV3 and newer, you can also use the new  syntax:
p18383
aVThis will recursively yield all the keys
p18384
aVTo turn that into a list use:
p18385
aVSince Python dictionaries are unordered, the ordering of the keys returned is not going to be sorted
p18386
aVYou'll have to explicitly sort the result if you want your keys to have a specific ordering
p18387
as(dp18388
g16
V100297
p18389
stp18390
a((dp18391
g2
(lp18392
VYou could avoid changing the list in place and instead return a new list:
p18393
aVYou should probably change  to return a list as well:
p18394
aVand 'empty' is not needed;  is considered  in a python context
p18395
aVThen  becomes:
p18396
aVDemonstration:
p18397
as(dp18398
g16
V100297
p18399
stp18400
a((dp18401
g2
(lp18402
VReturn a  instead of a regular tuple, and you don't need to unpack it
p18403
aVYou can then later extend the returned tuple without affecting existing users of the API:
p18404
aVand your API is consumed like:
p18405
aVIf you later update the  to add a 3rd parameter  the above consumer is still going to work
p18406
as(dp18407
g16
V100297
p18408
stp18409
a((dp18410
g2
(lp18411
VYou need to go up to the class itself:
p18412
aVDemonstration:
p18413
as(dp18414
g16
V100297
p18415
stp18416
a((dp18417
g2
(lp18418
VSimply save that file object to something with a  or  filename:
p18419
aVor state the format explicitly:
p18420
aVPIL will then convert the image to the correct format
p18421
aVNote that the PIL EPS module uses the  command from the Ghostscript project to do it's conversions, you'll need to have it installed for this to work
p18422
as(dp18423
g16
V100297
p18424
stp18425
a((dp18426
g2
(lp18427
VCertainly
p18428
aVJust put the  call in that module, and if needed, add additional breakpoints using the  command for the other functions, or use multiple  calls
p18429
aVThen, when stepping through the code, use  (or ) to skip over function calls that would take you out of the module
p18430
aVOr use  () to run code until the next line is being executed (use this to get out of a long loop)
p18431
aVWhenever the interpreter hits one of your breakpoints or  calls it'll stop there, regardless
p18432
as(dp18433
g16
V100297
p18434
stp18435
a((dp18436
g2
(lp18437
VImport it:
p18438
aVEach and every  file in python is a module, and you can simply import it
p18439
aVIf the file is called , import
p18440
as(dp18441
g16
V100297
p18442
stp18443
a((dp18444
g2
(lp18445
VThe  command is created by a buildout part, usually using the  or  recipes
p18446
aVThose recipes support an  entry to configure what eggs are available to it
p18447
aVIf you installed Plone with the unified installer, then the  part is set up to include the  entry from the  section, so in your  you can add eggs to that entry as well to ensure the eggs you want to test are included
p18448
aVTo run all the tests for one package, use the  option to :
p18449
as(dp18450
g16
V100297
p18451
stp18452
a((dp18453
g2
(lp18454
VYou'd have to either create  in the  of , use a  hook to create  dynamically, or use a property
p18455
aVapproach:
p18456
aVapproach:
p18457
aVProperty approach:
p18458
aVOf course, the property and  approaches do not have to store the  instance on , it could just return a pre-existing  instance from somewhere else instead
p18459
as(dp18460
g16
V100297
p18461
stp18462
a((dp18463
g2
(lp18464
VProvided the , etc
p18465
aVitems are each on a separate line:
p18466
aVNote that you probably mean the  type, which is a specific kind of python mapping, that happens to use a hash table in the underlying implementation
p18467
as(dp18468
g16
V100297
p18469
stp18470
a((dp18471
g2
(lp18472
VUse the  module, and a little  trickery:
p18473
aVNote how this is not the easiest and most straightforward task, and you may want to rethink the wisdom of doing this
p18474
as(dp18475
g16
V100297
p18476
stp18477
a((dp18478
g2
(lp18479
VThe second argument to  is the globals used for the expression run by
p18480
aVOne of things python does when evaluating an expression is ensuring that the python built-ins are available to the evaluated expression, and to do that it adds the  entry to that globals namespace
p18481
aVSo, yes, the  call did change your dictionary, and that is expected and normal behaviour
p18482
aVIt even says so in the documentation for the function:
p18483
aVIf the globals dictionary is present and lacks \u2018__builtins__\u2019, the current globals are copied into globals before expression is parsed
p18484
aVThis means that expression normally has full access to the standard  module and restricted environments are propagated
p18485
aVIf you want to avoid this change, use an empty  for the globals, and use  as the  namespace instead:
p18486
as(dp18487
g16
V100297
p18488
stp18489
a((dp18490
g2
(lp18491
VUse the  decorator to ensure that the wrapper returned by  has the correct name:
p18492
aVThe task name is taken from the function call that the  decorator wraps, but by inserting a decorator in between, you gave  your  wrapping function instead
p18493
aVThe  decorator copies all the necessary metadata over from  to the wrapper so that  can pick up the proper name
p18494
as(dp18495
g16
V100297
p18496
stp18497
a((dp18498
g2
(lp18499
VJust use the XOR operator  against 0xFF:
p18500
aVIf you need to work with values larger than a byte, you could create the mask from the  method on your value:
p18501
as(dp18502
g16
V100297
p18503
stp18504
a((dp18505
g2
(lp18506
VYou'll have to encode it manually, to UTF-8:
p18507
aVas the API only takes encoded bytes as input
p18508
aVUTF-8 is a good default for such data
p18509
aVIt'll be able to decode to unicode again from there:
p18510
as(dp18511
g16
V100297
p18512
stp18513
a((dp18514
g2
(lp18515
VSimply search for it:
p18516
aVI used the class to limit the find, but since there are no other  elements that's a little redundant here
p18517
aVIf, instead, you need to remove the tag, use the above method to first find it, then call  on it to remove it from the document:
p18518
aVTwo things: the removed tag is returned from the  method, you could save it for later use
p18519
aVThe tag is removed from the document altogether, you'd have to re-add it manually later if you still need it to be in the document anyway
p18520
aVAlternatively, you could use the  method, which deletes the tag from the document altogether, without returning a reference
p18521
aVThe tag is then gone forever
p18522
as(dp18523
g16
V100297
p18524
stp18525
a((dp18526
g2
(lp18527
VYou'll need to loop through the  dict separately, where you ask it to be sorted on value:
p18528
aVThe  call is given a key to sort by, namely the second element of each  tuple (a key and value pair)
p18529
aVIf you wanted to write the sorted items to a file, you'd need to open that file in writing mode:
p18530
aVNote that we write newlines () after every entry;  includes a newline for us but when writing to a file you need to include it manually
p18531
as(dp18532
g16
V100297
p18533
stp18534
a((dp18535
g2
(lp18536
VYou need to call the commit method to commit your changes to the database, otherwise the transaction is never saved and other connections won't see the changes
p18537
aVYou omitted the  parenthesis in your code
p18538
aVYou also reference the  method in several locations without calling it; not as big a deal as Python will automatically clean those up through garbage collection
p18539
as(dp18540
g16
V100297
p18541
stp18542
a((dp18543
g2
(lp18544
VJust call  on each value:
p18545
aVThis changes  in-place
p18546
aVIf you need a copy, use a dict comprehension instead:
p18547
aVOn python 3, replace  with
p18548
as(dp18549
g16
V100297
p18550
stp18551
a((dp18552
g2
(lp18553
VThe only documentation that I am aware of (apart from the source code), is Lennart Regebro's excellent Porting to Python 3 book (online in full)
p18554
aVThe book has a full chapter on writing your own  fixers
p18555
aVThe chapter discusses the parse tree architucture used by  and how to take advantage of that structure to create your own translations to be run when porting code from python 2 to 3
p18556
as(dp18557
g16
V100297
p18558
stp18559
a((dp18560
g2
(lp18561
V creates a python egg, in-place; it does not [modify the] python environment so package can be imported from it's current location
p18562
aVYou still have to either add it's location to the python search path or use the directory it is placed in as the current directory
p18563
aVIt is the job of the  command to create an in-place egg, which may include compiling C extensions, running the 2to3 python conversion process to create Python3 compatible code, and to provide metadata other python code may be relying on
p18564
aVWhen you install the package as an egg in your  directory, the same metadata is included there as well
p18565
aVThe data is certainly not temporary (it is extracted from your  file for easy parsing by other tools)
p18566
aVThe intent is that you can then rely on that metadata when using your package in a wider system that relies on the metadata being present, while still developing the package
p18567
aVFor example, in a buildout development deployment, we often use  to automate the process of fetching the source code for a given package when we need to work on it, which builds it as a develop egg and ties it into the deployment while we work on the code
p18568
aVNote that the  directory serves a specific purpose: to signal to other tools in the setuptools eco-system that your package is installed and available
p18569
aVIf your package is a dependency of another egg in your setup, then that dependency is satisfied
p18570
aVand  and buildout will not try and fetch the egg from somewhere else instead
p18571
aVApart from creating the  directory, the only other thing the command does, is to build extensions, in-place
p18572
aVSo the command you are looking for instead is:
p18573
aVThis will do the exact same thing as  but leave out the  directory
p18574
aVIt also won't generate the  file
p18575
aVThere is no way of generating only the  file and leave out the  directory generation
p18576
aVTechnically speaking,  will also check if you have the setuptools  file installed to support namespaced packages, but that's not relevant here
p18577
as(dp18578
g16
V100297
p18579
stp18580
a((dp18581
g2
(lp18582
VUse :
p18583
aVcreates a new callable, that'll apply any arguments (including keyword arguments) to the wrapped function in addition to whatever is being passed to that new callable
p18584
as(dp18585
g16
V100297
p18586
stp18587
a((dp18588
g2
(lp18589
VOne is the  representation of the string, the other the printed string
p18590
aVThe representation you can paste back into the interpreter to make the same string again
p18591
aVThe Python interactive prompt always uses  when echoing variables,  always uses the  string representation
p18592
aVThey are otherwise the same
p18593
aVTry  for comparison:
p18594
as(dp18595
g16
V100297
p18596
stp18597
a((dp18598
g2
(lp18599
VThe WebHelpers package is not (yet) python 3 compatible
p18600
aVPython 3 has removed support for raising exceptions with a type and value
p18601
aVIt should instead read:
p18602
aVUnfortunately, there are more things in the WebHelpers source code that make porting it to Python 3 a daunting task, especially for someone new to Python
p18603
aVYou'll either have to switch to using Python 2 or use a different library altogether
p18604
as(dp18605
g16
V100297
p18606
stp18607
a((dp18608
g2
(lp18609
VJust use a list comprehension:
p18610
as(dp18611
g16
V100297
p18612
stp18613
a((dp18614
g2
(lp18615
VClearly,  expects  to be an iterable (a list or a tuple would do)
p18616
aVInstead of , use  (an empty tuple)
p18617
aVNote however, that  should be set to a string
p18618
aVUse  for a sane default
p18619
aValso has to be set, to an integer count of seconds to wait
p18620
aVI guess 60 seconds (a full minute) is as good as anything
p18621
aVYou can omit the  and  arguments and leave those at their defaults:
p18622
as(dp18623
g16
V100297
p18624
stp18625
a((dp18626
g2
(lp18627
VNo, there normally is no harm such a condition could cause
p18628
aVThe  comparison operator doesn't alter anything
p18629
aVIf any of the variables , ,  or  is indeed  or , then the test would succeed, otherwise it would fail (return )
p18630
aVThe four variables collected (temporarily) into a list would not be affected themselves
p18631
aV(Why
p18632
aVBecause  is a subclass of  and  is  in python
p18633
aVSo  is  as well
p18634
aVTry it out in your interpreter;  returns , and then try  for more surprises)
p18635
aVThe one exception would be if someone had made the mistake of creating a  equality hook on a custom class that altered the state of the instance
p18636
aVThat would be a big bug in that custom class, not anything specific to the  statement itself
p18637
as(dp18638
g16
V100297
p18639
stp18640
a((dp18641
g2
(lp18642
VTry it out in the interpreter; it uses  to show continuation lines
p18643
aVis only for a new statement or expression, while a  in incomplete until you've had an empty  continuation line:
p18644
as(dp18645
g16
V100297
p18646
stp18647
a((dp18648
g2
(lp18649
VUse  to remove any newlines from the line:
p18650
as(dp18651
g16
V100297
p18652
stp18653
a((dp18654
g2
(lp18655
VUse :
p18656
aVIf, however, you are looking for the output of the command in backticks, you'd need to use the  module instead:
p18657
aVNote that I set  to  to have the shell interpret it for me
p18658
as(dp18659
g16
V100297
p18660
stp18661
a((dp18662
g2
(lp18663
VThe python  implementation uses the hash value to both sparsely store values based on the key and to avoid collisions in that storage
p18664
aVIt uses the result of  as a starting point, it is not the definitive position
p18665
aVThus, although  returns , the exact 'position' in the underlying C structure is also based on what other keys are already there, and how large the current table is
p18666
aVThe python hash table is resized as needed (items added), for example
p18667
aVSince a dict has no ordering, this is not something you need to worry about, or can hope to influence
p18668
aVIf you need ordering in a dict, use the  implementation instead, which keeps track of ordering separately
p18669
aVThe details of the python hash table implementation
p18670
aVYou may want to read up on how hash tables work on Wikipedia; Python uses open addressing for it's implementation
p18671
aVWhen selecting a slot in the table, the modulus of the hash value (an integer) and the current table size is taken, thus on a table of size 32, so the key , hash value  would initially be stored in slot 14
p18672
aVIf there is a collision (there already is something else stored in slot 14 and it's not the integer ), then the slot value is perturbed until an empty slot is found or the same key is found instead
p18673
aVPerturbing is done with the formula:
p18674
aVSo, when there is a collision, another slot is picked at progressively smaller steps until it scans the whole table
p18675
aVNote that the table will already have been resized to make space if necessary
p18676
aVIn order for this to work correctly, custom types need both a  method and need to implement  to determine if two instances represent the same key
p18677
aVMatching hash values is not enough
p18678
aVFor the  implementation to consider two instances to represent the exact same key, both their hash values must match, and they must return True for the  equality operator
p18679
aVSuch objects are considered hashable
p18680
aV(For Python 2
p18681
aVx, implementing the  hook would do instead of implementing ; support for this has been removed in Python 3)
p18682
as(dp18683
g16
V100297
p18684
stp18685
a((dp18686
g2
(lp18687
V is another hook method, and not the value of the string
p18688
aVIf this is a subclass of , you can just iterate over  instead:
p18689
aVor you can make it more explicit:
p18690
aVIf this is not a subclass, perhaps you meant to call :
p18691
aVor you can avoid calling the hook and use :
p18692
as(dp18693
g16
V100297
p18694
stp18695
a((dp18696
g2
(lp18697
VWhen you return  you indicate that you do not know if  should return  or
p18698
aVNormally, Python will then swap the operands; if  results in , it'll try  instead
p18699
aVThat'll fail here too, since you use the same type on both sides of the operator
p18700
aVFor the  operator, Python will then fall back to comparing their memory addresses, and these are not the same (two separate instances), so False is returned
p18701
aVSee the  C function for details
p18702
aVYou'll have to raise  manually if that is your expected outcome
p18703
as(dp18704
g16
V100297
p18705
stp18706
a((dp18707
g2
(lp18708
VNo, that is not a feature supported by supervisord
p18709
aVIt has no facility to create an arbitrary number of processes based on a template
p18710
aVYou'll have to pre-define your workers and start and stop those as needed
p18711
as(dp18712
g16
V100297
p18713
stp18714
a((dp18715
g2
(lp18716
VJust keep a separate counter and increment that, then test if it has reached
p18717
aVSimple as that
p18718
aVThere is no need to get too clever here:
p18719
aVAlternatively, since  returns a list, you could filter it if you have your already synched list of filenames in a set, then slice it down to your maximum size:
p18720
aVNote that I just test for  instead of using your simple filematcher; the test comes down to the same thing
p18721
as(dp18722
g16
V100297
p18723
stp18724
a((dp18725
g2
(lp18726
VThe  module loops over your rows one by one, there is no need to then loop over the column
p18727
aVJust sum :
p18728
aVYou can use a shortcut with a generator expression and the  built-in function:
p18729
aVIn Python, strings are sequences too, so when you do  you are looping over the individual characters of ; so for your first row that'd be  and :
p18730
as(dp18731
g16
V100297
p18732
stp18733
a((dp18734
g2
(lp18735
VSort on your grouping criteria, then use :
p18736
aVDemonstration:
p18737
aVYour output requirement is a little convoluted; if returning lists of the grouped elements is enough, calling  on  is enough:
p18738
as(dp18739
g16
V100297
p18740
stp18741
a((dp18742
g2
(lp18743
V is a function:
p18744
aVbut within that function you are trying to use it as a dictionary instead:
p18745
aVon the line where you define :
p18746
aVYou can split that line up over several to make it more readable and debuggable:
p18747
aVYou seem to expect there to be a  dictionary in your function throughout:
p18748
aVPerhaps you have a global named  that is a dictionary
p18749
aVYou cannot have both a dictionary and a function with the same name in your module
p18750
aVRename one or the other
p18751
as(dp18752
g16
V100297
p18753
stp18754
a((dp18755
g2
(lp18756
VFunctions are also attributes, there is nothing stopping you from assigning additional functions to a class or an instance at a later time
p18757
aVSo you are asking if you can list all attributes that are not functions, and not 'special'
p18758
aVIf you want to list anything that is defined directly on the class or instance, look at the  mapping instead
p18759
aVYou'll still have to filter that:
p18760
aVThis'll generate all attribute names that are not functions or methods, which should work both for classes and for instances that had methods assigned to them manually
p18761
aVTo get a list as output, call  or
p18762
aVThis method does not traverse base classes, and will fall down if you use  on your class
p18763
as(dp18764
g16
V100297
p18765
stp18766
a((dp18767
g2
(lp18768
VYou'll have to flatten the structure using a function:
p18769
aVthen use that to loop over your structure:
p18770
aVPython dictionaries are not ordered, so the output will not be sorted or matching the order in which you declared your structure
p18771
aVVersion without :
p18772
aVBoth versions print:
p18773
as(dp18774
g16
V100297
p18775
stp18776
a((dp18777
g2
(lp18778
VIterators are designed to save memory by dealing with one item at a time, and can potentially produce an unlimited number of items
p18779
aVAs a result of their design however, you usually cannot know their length without consuming the whole iterator, and you are normally not expected to be able to steer them
p18780
aVThat said, there is nothing stopping you from making a custom class that can be used both as an iterator and can provide additional functionality
p18781
aVDatabase cursors are the canonical example of such a class; the cursor can be iterated over to yield rows, but you can also ask it for a rowcount (so the length of the sequence), and get additional information about columns, get multiple rows, or point to a new result set by calling the  method
p18782
aVIf you want to build a custom class that acts as an iterator, you need to give it a  method
p18783
aVYou either make this method into a generator (by using the  statement), or just  and give your class a  method; the latter is expected to return one item (do not use ), or raise  when no more items can be returned
p18784
aVYou can then add other methods that return length information, or re-set the query to start from a given primary key
p18785
aVUntested, python-ish code:
p18786
as(dp18787
g16
V100297
p18788
stp18789
a((dp18790
g2
(lp18791
VYou can indeed run  using the  module, and pass arguments to that
p18792
aVIn essence you'd be running a completely new program; this is not the same as calling a function
p18793
aVUsually there is no need to go to such drastic lengths though
p18794
aVIf you do run a separate python script, you need to parse the arguments passed from
p18795
aVThe  module makes that easier but is not required if all you do is pass a list of arguments
p18796
as(dp18797
g16
V100297
p18798
stp18799
a((dp18800
g2
(lp18801
VYou are concatenating a string and a datetime object
p18802
aVConvert the datetime object to a string first:
p18803
aVIf you use a comma instead, the  statement will do the string conversion for you and insert a space:
p18804
aVor you could use string formatting:
p18805
aVIf you want to influence how the datatime object is converted to a string, use the  method to format the date and time more precisely:
p18806
aVor you could use the  method to format the string to a specific standards-compliant format:
p18807
as(dp18808
g16
V100297
p18809
stp18810
a((dp18811
g2
(lp18812
VUse the  keyword instead and the content length will be set automatically:
p18813
aVYou'll have to combine the two dictionaries into one:
p18814
as(dp18815
g16
V100297
p18816
stp18817
a((dp18818
g2
(lp18819
VThe Babel project provides several commands for use in  files
p18820
aVYou need to define a  entry point with commands; example from the Babel  file:
p18821
aVwhere the extra commands are then available as
p18822
aVThe entry points point to subclasses of
p18823
aVExample again from Babel, from the  module:
p18824
as(dp18825
g16
V100297
p18826
stp18827
a((dp18828
g2
(lp18829
VYou need to use sets instead of lists:
p18830
aVDemonstration:
p18831
aVFor your purposes you probably don't have to convert it back to a list again, you can iterate over the resulting set just fine
p18832
as(dp18833
g16
V100297
p18834
stp18835
a((dp18836
g2
(lp18837
VThe  loader also inspects , to let you limit the modules loaded for testing from the command line
p18838
aVWhat happens here is that the loader is looking for a test module named
p18839
aVYou'll have to manipulate  from your unittest instead; it's a standard python list that you can alter
p18840
aVAlternatively, create a  function that, by default, you call with :
p18841
aVand now you can test  with different arguments without having to rely on passing arguments to your test script
p18842
as(dp18843
g16
V100297
p18844
stp18845
a((dp18846
g2
(lp18847
VThe  buildout recipe package does exactly this
p18848
aVIt takes test runner output and creates a XML file suitable for JUnit
p18849
aVIt is, however, buildout specific and uses the  test runner package
p18850
aVIf switching to buildout is not an option for you, you could study it's source code to extract the important parts
p18851
as(dp18852
g16
V100297
p18853
stp18854
a((dp18855
g2
(lp18856
VIn order for python to see  as a valid python structure, you must make it a package
p18857
aVYou make it a package by including a  file in that directory
p18858
aVThe file can be empty
p18859
aVOnce  has such a file, the statement  should work
p18860
as(dp18861
g16
V100297
p18862
stp18863
a((dp18864
g2
(lp18865
VYou write  to the file, but never define it in your function:
p18866
aVYou must have a  global that is being used instead
p18867
aVYour actual message variable is called , write that instead:
p18868
as(dp18869
g16
V100297
p18870
stp18871
a((dp18872
g2
(lp18873
VBecause  is a subclass of float, it satisfies all the requirements that the  instance factory has
p18874
aVIt is the job of the  static method to create instances of the first argument, not of it's 'own' class
p18875
aVNote the word 'static method' there
p18876
aVThe  factory is really just a specialist function tied to a class only for inheritance reasons
p18877
aVIn other words, it is a function that plays well in a object-oriented hierarchy
p18878
aVYou are supposed to find it via  or perhaps call it directly (as done here)
p18879
aVThe following would actually be a little more pythonic:
p18880
aVbecause that would call the 'correct'  function if  were to be used in a multiple-inheritance hierarchy; in this simple example it'll end up calling  just the same
p18881
aVSo,  is expected to create an instance of type
p18882
aVWhy then tie it to a class at all and not make it a more generic function then
p18883
aVBecause in the case of  it not only creates a new instance of type , it also sets it's initial value to
p18884
aVAnd in order for that to work,  needs to have intimate knowledge of what the  class looks like
p18885
aVBecause  is a subclass of , it has the exact same necessary bits to be a  too, and thus when the  factory creates a new  instance, all those bits are there to make it a  instance instead
p18886
as(dp18887
g16
V100297
p18888
stp18889
a((dp18890
g2
(lp18891
VAll Nagare components have those methods, see the class  documentation
p18892
aVThis was referred to in the first sentence of the Component Model chapter:
p18893
aVA component is an object, instance of the  class in
p18894
as(dp18895
g16
V100297
p18896
stp18897
a((dp18898
g2
(lp18899
VThe page uses JavaScript to create the URL:
p18900
aVIt combines a path, that the browser will use against the current site
p18901
aVSo each URL is:
p18902
aVBy the looks of it, the data only covers weekdays
p18903
aVThese are easy enough to cobble together into automated URLs:
p18904
aVI used  for it's easier-to-use API, but you can use  for this task too if you so wish
p18905
as(dp18906
g16
V100297
p18907
stp18908
a((dp18909
g2
(lp18910
VYou seem to be under the impression that your implementation of  is merely a hook, that if you provide it Python will call it, and otherwise the interpreter will do it's normal magic directly
p18911
aVThat is not correct
p18912
aVWhen python looks up attributes on instances,  is the main entry for all attribute access, and  provides the default implementation
p18913
aVYour implementation is thus overriding the original, and if your implementation provides no alternative means of returning attributes it fails
p18914
aVYou cannot use attribute access in that method, since all attribute access to the instance () is channelled again through
p18915
aVThe best way around this is by calling the overridden original again
p18916
aVThat's where  comes in; you are asking the next class in the class-resolution order to take care of the attribute access for you
p18917
aVAlternatively, you can call the unbound  method directly
p18918
aVThe C implementation of this method is the final stop for attribute access (it has direct access to  and is thus not bound to the same limitations)
p18919
aVNote that  returns a proxy object that'll look up whatever method can be found next in the method-resolution ordered base classes
p18920
aVIf no such method exists, it'll fail with an attribute error
p18921
aVIt will never call the original method
p18922
aVThus  looking up  will either be a base-class implementation or an attribute error, never  itself
p18923
as(dp18924
g16
V100297
p18925
stp18926
a((dp18927
g2
(lp18928
VUse  to combine two iterables into pairs, then pass that to the  constructor:
p18929
aVQuick demo (take into account that  does not retain ordering):
p18930
aVWith a for loop and no :
p18931
as(dp18932
g16
V100297
p18933
stp18934
a((dp18935
g2
(lp18936
VIf you want to compare different python approaches, such as the  operator versus , use the  module to test the speed differences
p18937
aVPython data type complexities are documented on http://wiki
p18938
aVpython
p18939
aVorg/moin/TimeComplexity
p18940
aVDo note that there is a big difference between  and ; the first one returns a boolean, the latter the index of the found item (an integer) or it'll raise an exception
p18941
aVIt thus is (slightly) slower for the average case:
p18942
aVIf you need to optimize for membership testing, use a  instead:
p18943
as(dp18944
g16
V100297
p18945
stp18946
a((dp18947
g2
(lp18948
VTest each key as you produce the second  iteratively
p18949
aVLooking up a key/value pair from the dict you are comparing with is cheap (linear cost), and round the values as you find them
p18950
aVYou are essentially performing a set difference to test for equality of the keys, which requires at least a full loop over the smallest of the sets
p18951
aVIf you already need to loop to generate one of the dicts, you are at an advantage as that'll give you the shortest route to determining *in*equality soonest
p18952
aVTo test for two floats being the same within a set tolerance, see what is the best way to compare floats for almost equality in python
p18953
as(dp18954
g16
V100297
p18955
stp18956
a((dp18957
g2
(lp18958
VYou are changing the string  in the loop, making it shorter
p18959
aVSo you end up with an index that lies beyond the length of :
p18960
aVUse  instead to find matches:
p18961
as(dp18962
g16
V100297
p18963
stp18964
a((dp18965
g2
(lp18966
V is  and you cannot write that to a file
p18967
aVYou need to actually send  data from your JavaScript handler; currently you only send the value and nothing else
p18968
aVPrefixing the string with  should be enough:
p18969
as(dp18970
g16
V100297
p18971
stp18972
a((dp18973
g2
(lp18974
VThe compression method used by tar -z relies on repeating patterns in the input file, replacing these patterns by a count of how many times the pattern repeated (grossly simplified)
p18975
aVHowever, when you encrypt a file, you are basically trying to hide any repeating patterns in as much 'random'-looking noise as possible
p18976
aVThat makes your file nearly incompressible
p18977
aVCombine that with the overhead of the archive and compression file format (metadata, etc
p18978
aVand your file actually ends up slightly larger instead
p18979
aVYou should reverse the process; compress first, then encrypt, and you'll increase the chances you end up with a smaller payload significantly
p18980
as(dp18981
g16
V100297
p18982
stp18983
a((dp18984
g2
(lp18985
V lists any entry points by the given name in any egg, including your own package
p18986
aVThus, if your  entry in  lists the following, and you've run  to generate the metadata, your own entry point will be included:
p18987
aVThe Babel project does exactly this; in it's  it lists entry points for both  and , and these are looked up by  and , respectively
p18988
aVIf you do not want to have a  file (which is easy enough to create and/or generate from a template), then you are facing having to alter the internal state of  instead:
p18989
aVis a list of eggs
p18990
aVYou'll have to add the path of your project's top-level directory to this
p18991
aVis a mapping from paths in  to a list of package names
p18992
aVAdd your project as `working_set
p18993
aVentry_keys[path] = ['package
p18994
aVname']
p18995
aVis a mapping from package name to a  instances
p18996
aVYou'll need to create a  instance and store it under your package name:
p18997
aVFor your purposes the  instance can be fairly sparse, but I'd include at least the project name
p18998
aVYou'll need to have a entry-point map on it though:
p18999
aVThe internal structure  is normally parsed on demand from the egg-info metadata
p19000
aVPlease note that this is relying entirely on undocumented internal data structures that can change between versions
p19001
aVIn other words, you are on your own here
p19002
aVI'd generate a  file instead, and run  to generate the egg metadata instead
p19003
as(dp19004
g16
V100297
p19005
stp19006
a((dp19007
g2
(lp19008
VJust use a generator expression to get your dicts:
p19009
aVAlternatively you can use tuple assignment:
p19010
aVbut that assumes that all your tuples have 2 values
p19011
as(dp19012
g16
V100297
p19013
stp19014
a((dp19015
g2
(lp19016
VYou need to run the  command as root:
p19017
aVOtherwise you won't have permission to copy the files to your  directory
p19018
aVTo install the package on Python 2, you'll need to install the  package first
p19019
as(dp19020
g16
V100297
p19021
stp19022
a((dp19023
g2
(lp19024
VNo, there isn't any such race condition
p19025
aVYou are clearing the reference, so the ref count drops to 1 and the object will be cleaned up once you delete the method reference
p19026
aVThe  reference points to a method, which points to the instance (as well as the class), so there is still a reference there
p19027
aVCurrently executing methods have a local variable , which is a reference to the instance as well, but mostly it's the method wrapper that provides that reference
p19028
as(dp19029
g16
V100297
p19030
stp19031
a((dp19032
g2
(lp19033
VThe login page uses a CSRF token to prevent cross-site scripting attacks
p19034
aVYou'll need to retrieve that token first
p19035
aVThe login page sets a cookie with the same token, we need to load the login page and grab that token first, before we pass this on to the login POST:
p19036
as(dp19037
g16
V100297
p19038
stp19039
a((dp19040
g2
(lp19041
VAll you have to do is provide unique filenames
p19042
aVYou could use a counter:
p19043
aVWhat I did:
p19044
aVCreate a template using python's string formatting syntax
p19045
aVAdded a counter to the loop using the  function
p19046
aVUsed the counter and the template to generate a new filename for each plot
p19047
as(dp19048
g16
V100297
p19049
stp19050
a((dp19051
g2
(lp19052
VYou could sort, which will put at least the starting points in sorted order
p19053
aVThen you only really need to check the endpoint against the previous entry; it should be smaller:
p19054
aVI'm using the  example tool from an older itertools documentation page here to create the sliding window
p19055
aVThis implementation returns:
p19056
aVIt is not entirely clear if matching end points would be a problem or not; if they are not, then you could change the  to a  test instead
p19057
as(dp19058
g16
V100297
p19059
stp19060
a((dp19061
g2
(lp19062
VJust select the  tag instead, then loop over the contained string elements:
p19063
aVIt is a slight shortcut; you could instead loop over  instead and get the  property from each, but since no other elements are present anyway, why not go straight for the string iterable and be done with it
p19064
aVAfter all, only  and  tags are permitted in a  tag, and only  tags hold text
p19065
aVOutput from the interactive interpreter:
p19066
aVIf you need to turn this into a list, simply use:
p19067
as(dp19068
g16
V100297
p19069
stp19070
a((dp19071
g2
(lp19072
VYou pass in the result of  to your function
p19073
aVreturns None:
p19074
aVYou need to call  separately, then pass in just :
p19075
aVNote that the  argument in the function is both redundant and only ever executed once, namely when you create the function
p19076
aVIt won't be evaluated each time you call the function
p19077
aVYou can omit it safely from the version you posted here in any case
p19078
as(dp19079
g16
V100297
p19080
stp19081
a((dp19082
g2
(lp19083
VYou can't do what you want to do on one line
p19084
aVYou can create a new dictionary on one line though:
p19085
aVResult:
p19086
aVThis is called a dict comprehension
p19087
aVLike a list comprehension and a generator expression, you can use multiple loops in one of those, but you don't need one here
p19088
aVwill pair up the keys from  with the integers from
p19089
aVTo modify a  in-place, you'll have to use 2 lines at least:
p19090
aVPython does accept that on one line, but that goes against just about every styleguide I can look up for you:
p19091
aVPython throws a syntax error because it interprets your line as a tuple of expressions (the commas make it a tuple), and two of your expressions are  statements, which cannot be used in an expression
p19092
as(dp19093
g16
V100297
p19094
stp19095
a((dp19096
g2
(lp19097
VYou can obtain each file from a tar file as a python  object using the  method
p19098
aVLoop over the  instance to list all entries:
p19099
as(dp19100
g16
V100297
p19101
stp19102
a((dp19103
g2
(lp19104
VJinja2 has no support for comments within a  statement
p19105
aVYou can only use comments outside of such statements, and then only with  or
p19106
aVis only meant for disabling part of a template
p19107
aVis the equivalent of , if line statements are enabled and so configured
p19108
aVonly works if line statements are enabled, at which point it regarded as a comment
p19109
aVGenerally, outside of Jinja statements, use  XML comments instead
p19110
as(dp19111
g16
V100297
p19112
stp19113
a((dp19114
g2
(lp19115
VYou imported  as , together with other elements from that module, so you don't need to use the module name to refer to it:
p19116
aVAlternatively, change the import line to:
p19117
aVand continue referring to items from that module by attribute access
p19118
as(dp19119
g16
V100297
p19120
stp19121
a((dp19122
g2
(lp19123
VYour  approach was correct, you just need to turn the results of each combination into a dict again:
p19124
aVThis version is a generator, yielding pairs efficiently, nothing is held in memory any longer than absolutely necessary
p19125
aVIf you need a list, just call  on the generator:
p19126
aVOutput:
p19127
aVYou can even combine the whole thing into a one-liner generator:
p19128
aVWhich outputs:
p19129
aVIf you are on Python 3, replace  and  by  and  respectively
p19130
as(dp19131
g16
V100297
p19132
stp19133
a((dp19134
g2
(lp19135
VYou create only one instance of , then alter it's value each time in the loop
p19136
aVYou are updating one row in the database instead of creating a new row each time
p19137
aVDo this instead:
p19138
aVNote that we pass in each  explicitly instead of the whole set of  values; in that case it'll just grab the last name from the  list, then fail during the next iteration as  is no longer available from the request
p19139
as(dp19140
g16
V100297
p19141
stp19142
a((dp19143
g2
(lp19144
V objects do not define any ordering, it's  and  methods return the  singleton indicating that they don't support ordering:
p19145
aVThus, Python 2 sorts these using an internal, consistent ordering
p19146
aVIn Python 3 a  will be raised instead when you attempt to use the  and  operators
p19147
aVIn python 2, when objects don't support ordering, they are instead ordered by their memory address (for the object itself, not the 'memory' the memoryview is pointing at); see Custom class ordering: no error thrown, what is Python testing for
p19148
aVfor more details on what happens
p19149
aVOnly equality and inequality testing is supported:
p19150
aVYour only options are to use  or
p19151
as(dp19152
g16
V100297
p19153
stp19154
a((dp19155
g2
(lp19156
VAttributes on XML tags do not have a fixed order, changing their ordering doesn't change their meaning
p19157
aVElementTree will only write out namespace qualifiers for namespaces actually in use
p19158
aVYour example is very brief, but I suspect it doesn't make use of the  and  namespaces at all
p19159
as(dp19160
g16
V100297
p19161
stp19162
a((dp19163
g2
(lp19164
VThe recipe does not start your varnish server
p19165
aVIt only configures it for you
p19166
aVUse something like  to manage the process, or start it by hand with
p19167
as(dp19168
g16
V100297
p19169
stp19170
a((dp19171
g2
(lp19172
VUse a stack, and push and pop items from it as you find more or fewer levels of indentation; each level on the stack holds the indentation depth and the entry:
p19173
as(dp19174
g16
V100297
p19175
stp19176
a((dp19177
g2
(lp19178
VYou are missing a closing parens on line 22:
p19179
aVWhen you get a  in Python, check that your parenthesis are balanced on the lines preceding it
p19180
as(dp19181
g16
V100297
p19182
stp19183
a((dp19184
g2
(lp19185
VSince you have a custom class handling your context,  will be the context manager instance
p19186
aVYou'll need to examine its state (stored at  creation time or when  was called) to determine which one you just exited
p19187
aVThe following example stores the return value of  on the instance so you can retrieve it again when  is being called:
p19188
as(dp19189
g16
V100297
p19190
stp19191
a((dp19192
g2
(lp19193
VUse :
p19194
aVThis produces  data, which is the default mime-type used by browsers when POST-ing HTML forms
p19195
as(dp19196
g16
V100297
p19197
stp19198
a((dp19199
g2
(lp19200
VYou need to set the referrer to the same URL as the login page:
p19201
as(dp19202
g16
V100297
p19203
stp19204
a((dp19205
g2
(lp19206
VYou could generate the column names:
p19207
aVYou do need to make sure that the keys in the  result are safe to interpolate into a SQL query (remember your SQL injection attack vectors)
p19208
aVIf you have a list of possible column names handy, I'd certainly check against that to filter out any stray 'extra' keys you may find in that
p19209
as(dp19210
g16
V100297
p19211
stp19212
a((dp19213
g2
(lp19214
VYou apparently upgraded you Django installation as well
p19215
aVRecent Django versions need the full name of the backend module
p19216
aVThe way you specify databases was changed in version 1
p19217
aV2 and you'll need to follow the upgrade notes to update your Django project codebase
p19218
aVFor MySQL the correct backend is now ; open  and update your  entry
p19219
as(dp19220
g16
V100297
p19221
stp19222
a((dp19223
g2
(lp19224
VThe  method returns , because it alters the affected dictionary in-place
p19225
aVdoes return the popped value, the nested dictionary
p19226
aVYou are updating the contained , why not update the parent  instead
p19227
aVResult:
p19228
aVOr you could do this recursively:
p19229
as(dp19230
g16
V100297
p19231
stp19232
a((dp19233
g2
(lp19234
VYou need to use absolute paths, your  variable is just a local filename without a directory path
p19235
aVThe  variable is that path:
p19236
as(dp19237
g16
V100297
p19238
stp19239
a((dp19240
g2
(lp19241
VUse  with  as the  and  arguments
p19242
aVBecause  can take input from  you can then 'write' your file straight to  instead of to the filesystem:
p19243
aVThe  method returns both the  and  results
p19244
aVNote that the  argument to  needs to be a string
p19245
aVIf  is some kind of file object, you'll have to pass in the result of  or similar; in the example above I used the variable name  to indicate that you pass in the data from  as a string as I don't know what API you can use on those objects
p19246
as(dp19247
g16
V100297
p19248
stp19249
a((dp19250
g2
(lp19251
VUse the  method instead of :
p19252
aVIt includes all results in between the matches, including the empty strings at the start and end
p19253
aVYou can filter those out:
p19254
aValthough on Python 3 you'd need to use , or iterate over the result of
p19255
as(dp19256
g16
V100297
p19257
stp19258
a((dp19259
g2
(lp19260
VWhen you use  to direct the output of a file to a python script, that script receives that data on it's  stream
p19261
aVSimply read from  to get that data:
p19262
as(dp19263
g16
V100297
p19264
stp19265
a((dp19266
g2
(lp19267
VYour code is all on one line, but you are using a line continuation escape character ()
p19268
aVRemove that character:
p19269
aVYou do not need to use such a line continuation trick at all when you break the line inside parenthesis or brackets, you can safely put the statement on multiple lines without it:
p19270
as(dp19271
g16
V100297
p19272
stp19273
a((dp19274
g2
(lp19275
VThere is no value associated with an ; you are looking at a table declaration, not a result set
p19276
aVis used to define a relationship to another table, for example
p19277
aVQuery the database for results, and the resulting objects will have the reference filled in for you:
p19278
as(dp19279
g16
V100297
p19280
stp19281
a((dp19282
g2
(lp19283
VUse  on the value; it'll interpret it as a python literal
p19284
aVIf that fails, you have a string instead
p19285
as(dp19286
g16
V100297
p19287
stp19288
a((dp19289
g2
(lp19290
VYou can't do that with
p19291
aVHowever, you can achieve the same effect with  and some list comprehension magic:
p19292
aVThis prints:
p19293
aVSo we loop over each match yielded by  and take it's  result
p19294
as(dp19295
g16
V100297
p19296
stp19297
a((dp19298
g2
(lp19299
VYour server is trying to return data to a client that closed the connection
p19300
aVThis happens from time to time, and is not something your server can do anything about or something that needs to worry you
p19301
as(dp19302
g16
V100297
p19303
stp19304
a((dp19305
g2
(lp19306
VYou are using Python 2
p19307
aV6 or earlier
p19308
aVwas not added to Python until version 2
p19309
ag4892
aVFrom the documentation:
p19310
aVNew in version 2
p19311
ag4892
aVYou could use this backport instead (also available from PyPI), it'll work on python versions 2
p19312
aV4 and up, or install python 2
p19313
aV7 and run your script with that version instead
p19314
as(dp19315
g16
V100297
p19316
stp19317
a((dp19318
g2
(lp19319
VYou already loop over the word; instead of using  keep a counter
p19320
aVPython makes that very easy for you; use the  function:
p19321
aVNow you are no longer using the  variable though, so just  instead:
p19322
aVWe can simplify this down to a list comprehension:
p19323
aVNote the  there; instead of testing if  is 0, we set a minimum of  for the slice
p19324
aVSince you then proceed to remove the first entry again (since it is the same as the second result) and you add the full word, just add 1 to the  counter instead:
p19325
aVThe second half of your function can use the  function effectively, instead of :
p19326
aVNow your function is a lot simpler; note that there is no need to return  since you are manipulating that in-place:
p19327
as(dp19328
g16
V100297
p19329
stp19330
a((dp19331
g2
(lp19332
VPrinting stats is a fine use of
p19333
aVSimply use string formatting to return a single string value:
p19334
as(dp19335
g16
V100297
p19336
stp19337
a((dp19338
g2
(lp19339
VStrings have a  method to pad it with zeros:
p19340
aVFor binary numbers however, I'd use string formatting:
p19341
aVThe  formatting specification formats the number passed in as binary, with 5 digits, zero padded
p19342
aVSee the Python format string syntax
p19343
aVI've used  here, but the built-in  function can take the same formatting instruction, minus the  placeholder syntax:
p19344
aVif you find that easier
p19345
as(dp19346
g16
V100297
p19347
stp19348
a((dp19349
g2
(lp19350
VBecause sublime plugins are not scripts
p19351
aVThere is no command line, so there are no command line arguments to parse
p19352
aVPython, in Sublime, is embedded, and for embedded python code to have  set, Sublime would have to set the arguments explicitly
p19353
aVSee Intro to embedding Python
p19354
aVIf you feel strongly about this, you'd have to make a case with the Sublime Text 2 developer to add a  call after
p19355
as(dp19356
g16
V100297
p19357
stp19358
a((dp19359
g2
(lp19360
VYou'd need to use a state variable to detect when you should read lines, and when you are done just  the loop:
p19361
aVThe above code will skip all lines until it finds the correct  line, at which point it'll set  to True
p19362
aVOnce the flag is set, it'll add all subsequent lines to  until it finds an empty line or another that starts with
p19363
aVAt that point it'll break the reading loop
p19364
aVAnother alternative is to use :
p19365
aVwill take lines from ballots until the test returns False
p19366
aVAfter that, we can take more lines with a different test, namely that the line is not empty and doesn't start with
p19367
aVNeither solution needs to read the whole file
p19368
aVWe stop reading when we found the correct riding and all it's votes have been read into
p19369
aVI use the  file object like an iterator
p19370
aVThat's not quite the same method as ; if  is a hard requirement (uhoh, teachers and homework), you can turn  into an iterator too:
p19371
aVthen use  instead of  wherever you see ,  or
p19372
as(dp19373
g16
V100297
p19374
stp19375
a((dp19376
g2
(lp19377
VIt'll be easier just to filter your string for digits and picking out the last 10:
p19378
aVResult:
p19379
aVThe regular expression approach (filtering everything but digits), is faster though:
p19380
as(dp19381
g16
V100297
p19382
stp19383
a((dp19384
g2
(lp19385
VIt'll be much simpler to use a quick generator loop and the  function:
p19386
aVThis solution is generic, you can add extra keys to  and it'll continue to work
p19387
as(dp19388
g16
V100297
p19389
stp19390
a((dp19391
g2
(lp19392
VMatch anything before a multi-space group:
p19393
aVoutputs:
p19394
as(dp19395
g16
V100297
p19396
stp19397
a((dp19398
g2
(lp19399
VInstead of using relative paths, store an absolute path based on the current module path:
p19400
aVis the filename of the current module,  is the directory the module resides in
p19401
aVYou should never rely on relative paths in Python code; the current working directory is not changed when running a python program
p19402
as(dp19403
g16
V100297
p19404
stp19405
a((dp19406
g2
(lp19407
VAutocompletion most often makes use of the output of the  function, which can be hooked
p19408
aVSimply implement a  method:
p19409
aVAs for wrapping a function while matching it's signature, you'll need to build a facade based on that signature
p19410
aVI've done exactly that for a Zope security feature:
p19411
aVThis will do the correct thing when it comes to method signatures, almost
p19412
aVYou cannot get around the mutable defaults here, and need to handle those explicitly to preserve them
p19413
aVA small demonstration:
p19414
aVThe whole  dance is required to preserve mutable defaults, which, although a generally a bad idea, do need to continue to work as originally intended
p19415
aVThe facade built will look just like the original, and will act like it, but mutables continue to live in the 'correct' location
p19416
aVNote that the facade gets updated to match the original as closely as possible; by using  various pieces of metadata are copied over from the original to the facade, but we take care to exclude the  string from that, since our facade explicitly uses it's own docstring instead
p19417
as(dp19418
g16
V100297
p19419
stp19420
a((dp19421
g2
(lp19422
VDo not reuse connections across threads
p19423
aVCreate a new connection for each thread instead
p19424
aVFrom the MySQLdb User Guide:
p19425
aVThe MySQL protocol can not handle multiple threads using the same connection at once
p19426
aVSome earlier versions of MySQLdb utilized locking to achieve a threadsafety of 2
p19427
aVWhile this is not terribly hard to accomplish using the standard Cursor class (which uses ), it is complicated by SSCursor (which uses ; with the latter you must ensure all the rows have been read before another query can be executed
p19428
aVIt is further complicated by the addition of transactions, since transactions start when a cursor execute a query, but end when  or  is executed by the Connection object
p19429
aVTwo threads simply cannot share a connection while a transaction is in progress, in addition to not being able to share it during query execution
p19430
aVThis excessively complicated the code to the point where it just isn't worth it
p19431
aVThe general upshot of this is: Don't share connections between threads
p19432
aVIt's really not worth your effort or mine, and in the end, will probably hurt performance, since the MySQL server runs a separate thread for each connection
p19433
aVYou can certainly do things like cache connections in a pool, and give those connections to one thread at a time
p19434
aVIf you let two threads use a connection simultaneously, the MySQL client library will probably upchuck and die
p19435
aVYou have been warned
p19436
aVEmphasis mine
p19437
aVUse thread local storage or a dedicated connection pooling library instead
p19438
as(dp19439
g16
V100297
p19440
stp19441
a((dp19442
g2
(lp19443
VYou don't, because you can't
p19444
aVYou will have to either limit your unit testing to the outer function, or you move the inner function elsewhere
p19445
as(dp19446
g16
V100297
p19447
stp19448
a((dp19449
g2
(lp19450
VLooks like you forgot to include the full path:
p19451
aVStatic assets are looked up based on the matching path you registered for the static assets
p19452
aVFor your two static view registrations, you use the paths  and , respectively
p19453
aVThe first one is relative to , but the second one is an absolute path
p19454
aVWhen using an absolute path for a static view, you need to use the same absolute path when generating static URLs
p19455
as(dp19456
g16
V100297
p19457
stp19458
a((dp19459
g2
(lp19460
VYou are trying to use , which is not defined on the  module
p19461
aVPerhaps you meant to use the  argument of the method instead
p19462
aVYou don't use the  argument for anything else in that method
p19463
aVYou'll need to update your  function to return a valid  filter:
p19464
aVYou could simplify that function by using a mapping:
p19465
as(dp19466
g16
V100297
p19467
stp19468
a((dp19469
g2
(lp19470
VThe  module lets you run and control other programs
p19471
aVAnything you can start with the command line on the computer, can be run and controlled with this module
p19472
aVUse this to integrate external programs into your Python code
p19473
aVThe  module lets you divide tasks written in python over multiple processes to help improve performance
p19474
aVIt provides an API very similar to the  module; it provides methods to share data across the processes it creates, and makes the task of managing multiple processes to run Python code (much) easier
p19475
aVIn other words,  lets you take advantage of multiple processes to get your tasks done faster by executing code in parallel
p19476
as(dp19477
g16
V100297
p19478
stp19479
a((dp19480
g2
(lp19481
VJust put  inside another dict:
p19482
aVYou'll have to add the  key to the  dictionaries first:
p19483
aVor use create a copy of each dict on-the-fly:
p19484
aVThe latter method, with some indentation, produces:
p19485
aVReading between the lines, it seems as if the  and  keys in your input example are actually the week numbers you are referring to
p19486
aVIf so, they are easily incorporated:
p19487
aVwould produce:
p19488
as(dp19489
g16
V100297
p19490
stp19491
a((dp19492
g2
(lp19493
VYou'll have to decode the JSON structure and loop through all the dictionaries until you find a match:
p19494
aVIf you need to make multiple lookups, you probably want to transform this structure to a  to ease lookups:
p19495
aVthen look up the  directly:
p19496
aVThe above example assumes that names are unique, if they are not, use:
p19497
aVThis is as always a trade-off, you trade memory for speed
p19498
as(dp19499
g16
V100297
p19500
stp19501
a((dp19502
g2
(lp19503
VFirst of all, you are not actually using  in your code
p19504
aVYou import the  HTML parser, but otherwise ignore it and just use the standard library  module instead
p19505
aVSecondly, you search for  but you do not have any  elements in your document, so no matches will be found
p19506
aVAnd last, but not least, you have a document there that uses namespaces
p19507
aVYou'll have to include those when searching for elements, or use a  wildcard search
p19508
aVThe following finds songs for you:
p19509
aVTo use an explicit namespace, you'd have to replace the  wildcard with the full namespace URL; the default namespace is available in the  namespace dict on the  object:
p19510
as(dp19511
g16
V100297
p19512
stp19513
a((dp19514
g2
(lp19515
VYou are confusing what your terminal can print with what Python knows about unicode characters
p19516
aVYour terminal font doesn't recognize those code points
p19517
aVPython can handle them just fine:
p19518
aVIronically enough, the font used by my browser doesn't define an image for either codepoint
p19519
aVYour post shows two placeholder characters for me:
p19520
as(dp19521
g16
V100297
p19522
stp19523
a((dp19524
g2
(lp19525
VNo, python doesn't support overloading because it doesn't need to
p19526
aVPython documentation often shows different ways of calling a method to illustrate different uses, but there is only one  callable (a type in this case)
p19527
aVIn this case,  accepts multiple keyword arguments, which have default values if not specified
p19528
aVThe  type then uses the those extra keyword arguments, if specified, to interpret a  byte string argument
p19529
aVIf no keyword arguments were passed in,  behaves differently
p19530
aVIn other words,  adjusts it's behaviour based on wether or not the keyword arguments have been supplied
p19531
aVIf that is the case and the first argument is a bytestring or bytearray,  it'll decode that argument to unicode text, using the extra keyword arguments to control the decoding process
p19532
aVYou can define your own function that'll behave the same way as regards to the keyword arguments, checking the type of the first argument:
p19533
as(dp19534
g16
V100297
p19535
stp19536
a((dp19537
g2
(lp19538
VYou'll need to create a Text node, using , then add it to the desired parent node using  or similar method:
p19539
aVI've added a  argument here for ease of use, call this with:
p19540
aVYour  function can be dropped altogether
p19541
aVWith these modifications, your  function prints:
p19542
as(dp19543
g16
V100297
p19544
stp19545
a((dp19546
g2
(lp19547
VRead the csv file using the  class, and ignore the columns you don't want:
p19548
as(dp19549
g16
V100297
p19550
stp19551
a((dp19552
g2
(lp19553
VYou'd be better off using the  method instead:
p19554
aVor, when filtering with a mapper config and a session:
p19555
aVThe  method will be translated to whatever SQL is best for your particular engine, matching column values that end with
p19556
aVYou can always use the function generator to create arbitrary SQL functions if you have to use the  sql function directly:
p19557
aVand the  call will be translated to  by the SQL generation layer
p19558
as(dp19559
g16
V100297
p19560
stp19561
a((dp19562
g2
(lp19563
VYour  is undefined; you'll need to import it from :
p19564
aVis backwards compatible with  but you'll need to use the template engine from  still, see Using templates
p19565
as(dp19566
g16
V100297
p19567
stp19568
a((dp19569
g2
(lp19570
VYou could work around that by accepting an arbitrary number of arguments, ignoring them in your own constructor:
p19571
aVSince you call  with  as the second positional argument anyway, it is safe to ignore that same argument when  passes it back to the instance initializer again
p19572
as(dp19573
g16
V100297
p19574
stp19575
a((dp19576
g2
(lp19577
VThis problem is not shaped like a regular expression nail, so please put that hammer down
p19578
aVThe correct tool would be to parse the contents into a python structure, filtering out the items you don't want, then writing out the remaining entries again
p19579
aVpyparsing would make the parsing job easy; the following is based on an existing example:
p19580
aVThe above code tersely defines the grammar of a  file, then uses  to parse out each lease in the file
p19581
aVreturns a sequence of matches, each consisting of a parse result and the start and end positions in the original string
p19582
aVThe parse result has a  attribute (you may want to catch  exceptions on that, in case no hardware statement was present in the input), making it easy to test for your MAC address to remove
p19583
aVIf the MAC address doesn't match, we write the whole lease back to an output file, using the  and  positions to get the original text for that lease (much easier than formatting the lease from the parsed information)
p19584
as(dp19585
g16
V100297
p19586
stp19587
a((dp19588
g2
(lp19589
V returns an iterator, and will not process elements until you ask it to
p19590
aVTurn it into a list to force all elements to be processed:
p19591
as(dp19592
g16
V100297
p19593
stp19594
a((dp19595
g2
(lp19596
VYou can use  in  (at the module level)
p19597
aVAlternatively, from another module, you can add  as an attribute on :
p19598
aVor, if the name must be taken from the generated class:
p19599
aVFrom within the  module, you can set it directly on :
p19600
aVwith an optional  statement to remove the  name from the namespace again
p19601
as(dp19602
g16
V100297
p19603
stp19604
a((dp19605
g2
(lp19606
VI'd simply register the new converter for a more specific interface:
p19607
aVI used  as an example, register it for the widgets where you want your custom converter to be used
p19608
aVOverrides replace adapters with the same registration
p19609
aVJust like the  registration in a regular ZCML file, it'll take the interface(s) it (multi-)adapts and the interface it provides from the factory object, if need be, so if you used  on your own converter then you do not need to repeat that information in the  registration
p19610
as(dp19611
g16
V100297
p19612
stp19613
a((dp19614
g2
(lp19615
VBy default, only functions whose name that start with  are run:
p19616
aVFrom the unittest basic example:
p19617
aVA testcase is created by subclassing
p19618
aVThe three individual tests are defined with methods whose names start with the letters
p19619
aVThis naming convention informs the test runner about which methods represent tests
p19620
as(dp19621
g16
V100297
p19622
stp19623
a((dp19624
g2
(lp19625
VYou don't want to do that, as you discovered you break your code
p19626
aVPython is a dynamic language, introspection gives us unfettered access to almost everything the interpreter can reach
p19627
aVThis applies to your module too
p19628
aVIf it makes you feel any better, the same thing applies to the standard library:
p19629
aVEverything a module needs in it's global namespace can be seen from the outside
p19630
aVThis is normal
p19631
aVAs you already discovered, use  to control  wildcard importing, and leave your module namespace alone otherwise
p19632
aVOf course, if you want to provide users of your package a clean API, there is nothing stopping you from importing the names that are part of the API into the top-level package , or by using a  module
p19633
aVImporting just means adding the same name as a variable in the current module;  is the exact same thing as , or  in your current module after you ran
p19634
as(dp19635
g16
V100297
p19636
stp19637
a((dp19638
g2
(lp19639
VYou'll need to convert the  components to a  object to sanely deal with time durations:
p19640
aVThere is no easy way otherwise to convert the  information to a duration; it is actually meant for date-time values, although using  to parse a duration is not too bad an idea
p19641
aVYour  value is now a  object
p19642
aVTo get the total number of seconds, use the  method on it:
p19643
as(dp19644
g16
V100297
p19645
stp19646
a((dp19647
g2
(lp19648
V could be , or , or , or ; be 'falsy' in other words, and then the  statement would be skipped
p19649
aVSee Truth testing for more detail on what is considered false in a boolean context
p19650
aVIn short, testing if  allows  to be anything else, including values that would otherwise be considered False in a boolean context
p19651
as(dp19652
g16
V100297
p19653
stp19654
a((dp19655
g2
(lp19656
VUse  to generate that information:
p19657
aVThat'll produce absolute paths; you can process the  variable a little more to make them relative to the  directory if needed
p19658
as(dp19659
g16
V100297
p19660
stp19661
a((dp19662
g2
(lp19663
VNo, you don't increase the precision that way
p19664
aVYou could just as well do:
p19665
aVbut to measure performance of a function accurately, you really need to re-run it several times to remove the effects of OS scheduling, coinciding disk flush interrupts, etc
p19666
aVFor timing methods as accurately as your platform will allow, use the  module, or at least re-use it's  function
p19667
as(dp19668
g16
V100297
p19669
stp19670
a((dp19671
g2
(lp19672
VYou are trying to lowercase the string in the assignment expression
p19673
aVYou don't need to do that
p19674
aVTry this instead:
p19675
aVThis makes the this equivalent to:
p19676
aVYour attempt at the loop tried to do this instead:
p19677
aVwhich is a syntax error in Python
p19678
as(dp19679
g16
V100297
p19680
stp19681
a((dp19682
g2
(lp19683
VIt'll work for strings as well, but it'll iterate over the string character by character
p19684
aVThe user should call your function with a list of strings instead
p19685
aVIf you explicitly want to support passing in one string, that then is to be interpreted as a line, you'll have to test for that:
p19686
aVAlternatively, you could split the string on newlines instead:
p19687
as(dp19688
g16
V100297
p19689
stp19690
a((dp19691
g2
(lp19692
VYou are looking for list displays and generator expressions
p19693
aVThe first form is called a "list comprehension", and is a specialized form of defining a list
p19694
aVAs for the second form, the generator expression, this is what the documentation has to say:
p19695
aVA generator expression yields a new generator object
p19696
aVIts syntax is the same as for comprehensions, except that it is enclosed in parentheses instead of brackets or curly braces
p19697
as(dp19698
g16
V100297
p19699
stp19700
a((dp19701
g2
(lp19702
V has no support for sending arbitrary signals to the processes it manages
p19703
aVInstead, use  to list the s of the managed processes
p19704
aVThen use  to send signals to those s
p19705
aVWith a little  magic, you can even extract those s to be acceptable as input to the  command:
p19706
aVwould send  to all active processes under  control
p19707
as(dp19708
g16
V100297
p19709
stp19710
a((dp19711
g2
(lp19712
VFiles are iterators, so all you have to do is group the input by three items each
p19713
aVThe  module comes with a recipe for grouping iterators:
p19714
aVNow you can group your input file lines in bunches of three:
p19715
as(dp19716
g16
V100297
p19717
stp19718
a((dp19719
g2
(lp19720
VYou are not changing the attributes on the instance, only in the dictionary itself
p19721
aVVariables in python are not pointers; changing a string in one place won't make the change visible elsewhere
p19722
aVYou can use  to dynamically change attributes on an instance:
p19723
aVBut you'll have to store the  instance somewhere, the above code just 'drops the ball' so to speak
p19724
as(dp19725
g16
V100297
p19726
stp19727
a((dp19728
g2
(lp19729
VYou cannot do this atomically
p19730
aVThe Python SQLite library  implicitly issues a  whenever you execute a  statement, because SQLite does not support executing the  statement while a transaction is active
p19731
aVYou can test this by opening the database in both the python interpreter and the  command line tool
p19732
aVAs soon as you issue the  statement, you can run a  command in the  command line tool and see the result of that statement
p19733
aVNote that this means that anything you did in the transaction before the  statement will also have been committed
p19734
aVTo look it in another way, the  statement first commits, then starts a completely new transaction
p19735
as(dp19736
g16
V100297
p19737
stp19738
a((dp19739
g2
(lp19740
VUse the  option
p19741
aVFrom :
p19742
aVYou can specify the top-level package directory with the  keyword argument to :
p19743
aVI can recommend the Hitchhiker\u2019s Guide to Packaging for a good tutorial on how to package your python projects
p19744
as(dp19745
g16
V100297
p19746
stp19747
a((dp19748
g2
(lp19749
VThe  function can be passed a function and a sentinel, use that to read a file in 820 byte chunks:
p19750
aVEvery iteration, the  function will be called, reading 820 bytes, until  returns an empty string (signifying EOF)
p19751
aVThe chunk is just a string, so you can use slicing to get your filename:
p19752
aVUsed together:
p19753
as(dp19754
g16
V100297
p19755
stp19756
a((dp19757
g2
(lp19758
VUse a bytearray instead, which is mutable
p19759
as(dp19760
g16
V100297
p19761
stp19762
a((dp19763
g2
(lp19764
VNo,  is a simple attribute and will not automatically update
p19765
aVFor dynamic attributes, use a  instead:
p19766
as(dp19767
g16
V100297
p19768
stp19769
a((dp19770
g2
(lp19771
VYou can use item access to get to the innermost string:
p19772
aVor you could loop over all the translations listed (it's a list):
p19773
aVas Google's translation service can give more than one translation for a given text
p19774
as(dp19775
g16
V100297
p19776
stp19777
a((dp19778
g2
(lp19779
VInvert the list and nest the results:
p19780
aVThis doesn't deal with keys duplicated 'higher up' all that well; if you have duplicate keys you'd need to use a slightly more cumbersome setup ( wouldn't handle the situation any better I don't think):
p19781
as(dp19782
g16
V100297
p19783
stp19784
a((dp19785
g2
(lp19786
V is a class, not an instance
p19787
aVCreate an instance instead:
p19788
aVWhat you did was the equivalent of:
p19789
as(dp19790
g16
V100297
p19791
stp19792
a((dp19793
g2
(lp19794
VYou will have to rebuild your entire dictionary, as each key/value pair is going to be affected
p19795
aVYou can use a  to make the merging easier when you encounter now-overlapping keys:
p19796
aVBecause when first looking up  in  it'll be set to  by default, all we have to do is add the old value to update  for when we first encounter a key
p19797
aVThe next time we encounter the key the values are 'merged' by adding them up
p19798
as(dp19799
g16
V100297
p19800
stp19801
a((dp19802
g2
(lp19803
VNo idea why you would want to do that, but here is one way, using the  decorator:
p19804
aVbut this is completely nonsensical
p19805
aVIt'll achieve what your example tries to do, but when you access  a lambda function is returned that is otherwise useless
p19806
aVIf you are fine with returning instances of a custom class, then you can also give that custom class a  method that simply returns  to give  slightly more meaning:
p19807
aVwhere  could be fleshed out more to actually mean something to the user of
p19808
aVHowever, in Python callables (such as functions and methods) are objects in and of themselves
p19809
aVYou can manipulate them, add attributes to them, assign them to different variables for later use, etc
p19810
aVTo get their result you call them, but if you don't call them you can retrieve that reference to be re-used elsewhere
p19811
aVYou should not try and circumvent that
p19812
aVIn other words, either stick with  being an attribute, a , or a method, but don't try to be all at once
p19813
as(dp19814
g16
V100297
p19815
stp19816
a((dp19817
g2
(lp19818
VIt is one operation; the right-hand expression is evaluated before the left-hand assignment is applied:
p19819
aVOr, if you are talking about multi-threaded environments, then the assignment is not atomic; the interpreter evaluates a tuple assignment with a single opcode, but uses separate opcodes to then store the results into each affected variable:
p19820
aVHowever, normal assigment is always going to be at least two opcodes (one for the right-hand expression, one for storing the result), so in python in general assigment is not atomic
p19821
aVSequence unpacking is no different
p19822
as(dp19823
g16
V100297
p19824
stp19825
a((dp19826
g2
(lp19827
VYou misunderstood what the  operator tests
p19828
aVIt tests if two variables point the same object, not if two variables have the same value
p19829
aVFrom the documentation for the  operator:
p19830
aVThe operators  and  test for object identity:  is true if and only if  and  are the same object
p19831
aVUse the  operator instead:
p19832
aVThis prints
p19833
aVand  are two separate lists:
p19834
aVIf you use the  function you'll see that  and  have different identifiers:
p19835
aVbut if you were to assign  to  then both point to the same object:
p19836
aVand  shows both are the same object, it returns
p19837
as(dp19838
g16
V100297
p19839
stp19840
a((dp19841
g2
(lp19842
VIf you create your functions as nested functions it's easier;  is then a variable taken from the nested scope:
p19843
aVThis results in:
p19844
as(dp19845
g16
V100297
p19846
stp19847
a((dp19848
g2
(lp19849
VNote that  is a perfectly valid character in a URL-encoded value
p19850
aVYou'd need to encode the values yourself, bypassing the standard encoding
p19851
aVI'd use , then replace the  characters by  by hand
p19852
aVYou then have to append the encoded string as a query parameter to the URL, and configure  to not re-encode the values:
p19853
aVThe  parameter set to  does the trick here; it's this  default that otherwise will re-encode the whole URL to ensure RFC compliancy
p19854
as(dp19855
g16
V100297
p19856
stp19857
a((dp19858
g2
(lp19859
VUse  to create Javascript literals:
p19860
aVThis will generate a full JS list with properly quoted strings:
p19861
as(dp19862
g16
V100297
p19863
stp19864
a((dp19865
g2
(lp19866
Vtl;dr: multiple assignments (multiple  statements on one line) are evaluated from left-to-right, not from right-to-left (after evaluating the right-hand-side expression)
p19867
aVTo complicate matters, you are using tuple assignment and 'normal' assignment in a heady mix
p19868
aVTuple assignment uses one assignment operator, so to swap two variables, use:
p19869
aVThe right-hand side must evaluate to a tuple of the same number of elements as there are variables on the left-hand side
p19870
aVYou do that, so that's fine
p19871
aVNow, in your examples, you are not only unpacking tuples
p19872
aVWhen the left-hand side contains only one variable, the tuple is not unpacked, just simply assigned:
p19873
aVbecomes
p19874
aVThe fun starts when you use multiple assignments on the same line
p19875
aVThese are processed from left to right
p19876
aVSo, the following simple example:
p19877
aVmeans that  becomes , then , then
p19878
aVNow we can understand each case:
p19879
aV, where , ,
p19880
aVThis becomes: evaluate  -> , then assign that to  ->
p19881
aVThen assign it to , so ,
p19882
aVResult: , ,
p19883
aV, where , ,
p19884
aVSame as the case before, but now  is set first, then  again, same result as case 1
p19885
aV, where , ,
p19886
aVInput on the right-hand side the same as cases 1
p19887
aVand 2
p19888
aV, but now we first set
p19889
aVEnd result as expected, , ,
p19890
aV, where , ,
p19891
aVSame as case 3
p19892
aVbut now we set  instead
p19893
aVNo surprises
p19894
aVWhat confused you here is that the assignments, after the right-hand side has been evaluated, are processed from left to right, not from right to left
p19895
aVFor cases like these, it's actually easiest to run your code (wrapped in a function), through the  function to disassemble the python bytecode:
p19896
aVThis is the first case; note how after the  and the  opcode (the latter creates an extra copy on the stack to serve the extra assignment), the first thing that happens is the  operation on , followed by a  (the tuple assignment opcode), to then store the results into  and
p19897
as(dp19898
g16
V100297
p19899
stp19900
a((dp19901
g2
(lp19902
VFor all  greater than 1, the  function calls itself twice:
p19903
aVbecomes
p19904
aVand expands to
p19905
aVand expands to
p19906
aVexpands to
p19907
aVexpands to
p19908
aVwhich sums up to
p19909
as(dp19910
g16
V100297
p19911
stp19912
a((dp19913
g2
(lp19914
VFrom the  recipes section:
p19915
aVthen call with:
p19916
aVreturns an iterator; if you have to have a list, simply consume the iterable into a new list:
p19917
as(dp19918
g16
V100297
p19919
stp19920
a((dp19921
g2
(lp19922
VBoth functions are part of a class definition (the  is a hint)
p19923
aVNeither  nor  are python built-ins
p19924
aVThey must've come from a custom library or were defined earlier in the same source file
p19925
aVPerhaps these methods are actually part of the  class definition itself
p19926
aVMost likely,  is expected to be an instance of class
p19927
aVI suggest you start with reading the python tutorial before you continue; work your way through it at least until the section on classes and instances (chapter 9)
p19928
as(dp19929
g16
V100297
p19930
stp19931
a((dp19932
g2
(lp19933
VYou need to write 2 separate rows, one with the keys, one with the values, instead:
p19934
aVThe two list comprehensions extract first all the keys, then all the values, from the dictionaries in your input list, combining these into one list to write to the CSV file
p19935
as(dp19936
g16
V100297
p19937
stp19938
a((dp19939
g2
(lp19940
VUse the  or  triple-quoted string literal:
p19941
aVI used a  newline escape after the opening tripple-quote to avoid having to put the first line right after the opening quotes
p19942
aVThe string thus starts at  (no newline before it):
p19943
as(dp19944
g16
V100297
p19945
stp19946
a((dp19947
g2
(lp19948
VIn Python 2,  only works correctly for new style objects; your  class must inherit from :
p19949
aVOnce you make that correction, the property works as expected:
p19950
as(dp19951
g16
V100297
p19952
stp19953
a((dp19954
g2
(lp19955
VThe following works just fine:
p19956
aVDemo:
p19957
aVThe expression  matches 1 or more digits, and I replace that with a newline followed by the matched digits (via the capturing group)
p19958
as(dp19959
g16
V100297
p19960
stp19961
a((dp19962
g2
(lp19963
VJust use  and :
p19964
aVYou can combine that with a  instance to get a full  instance:
p19965
aVTo re-use an existing  instance, use the  method together with the  method on the  instance to create a new  instance:
p19966
aVTo get a series of dates, use  instances to create offsets
p19967
aVA series of dates relative to today is then easy:
p19968
as(dp19969
g16
V100297
p19970
stp19971
a((dp19972
g2
(lp19973
VThe  data type is only meant to communicate with a c library
p19974
aVIt should only be used to convert to and from at the boundaries, the location you do that communication
p19975
aVThus, for bitwise operations, convert the type to native Python types first, such as an python
p19976
aVExtracting the values for a quick bitmask operation isn't that hard:
p19977
as(dp19978
g16
V100297
p19979
stp19980
a((dp19981
g2
(lp19982
VMostly, just access them directly
p19983
aVPython is not Java
p19984
aVIn Java, you have to use getters and setters because you cannot change your mind and change the public fields to getters and setters later on
p19985
aVIn python, you can, so don't use getters and setters until you have an actual need to
p19986
aVThen you switch to a  instead
p19987
as(dp19988
g16
V100297
p19989
stp19990
a((dp19991
g2
(lp19992
VJust create a python  with a contained  instead, then dump that to JSON in one go:
p19993
aVYour desired output format seems to be missing the outer  and  brackets to mark it a proper JSON object
p19994
aVIf you really have to produce that output (so missing those brackets), just remove them again:
p19995
as(dp19996
g16
V100297
p19997
stp19998
a((dp19999
g2
(lp20000
VYou'll have to wait over 63 years before you will see  being output instead of question marks
p20001
aVoutputs the time in seconds since the epoch
p20002
aV2,000,000,000 (2 billion) seconds is a  long time to wait
p20003
aVIf you start it now, it'll be done on the 17th of april, 2076
p20004
as(dp20005
g16
V100297
p20006
stp20007
a((dp20008
g2
(lp20009
VUse  to list the s of the managed processes
p20010
aVWith a little ,  and  massaging, you can extract those s to be acceptable as input to other commands:
p20011
aVwould list all pids of running programs as a space-separated list
p20012
aVReplace  with a  command to send them all the  signal, for example
p20013
as(dp20014
g16
V100297
p20015
stp20016
a((dp20017
g2
(lp20018
VTo get all the numbers from each line, use  together with :
p20019
aVIt is not entirely clear what you want to do with the  lines, but the very simple loop would print out:
p20020
aVetc
p20021
as(dp20022
g16
V100297
p20023
stp20024
a((dp20025
g2
(lp20026
VYou don't need to use an  for this
p20027
aVMuch easier with a list comprehension:
p20028
aVThe  list comprehension applies the  method to each string we get from sorting the keys of
p20029
aVThis way, you can format each word separately, instead of applying  to the already joined whole
p20030
aVThis prints:
p20031
aVHere are the 3 possible choices:  Easy - Medium - Hard
p20032
aVIf you want to see why this works, here are some of the constituent parts:
p20033
aVHopefully that gives you some ideas on how to manipulate each option string with other methods
p20034
as(dp20035
g16
V100297
p20036
stp20037
a((dp20038
g2
(lp20039
VIf  is just a python , just append it to the list of fields from :
p20040
aVwhich would be the same as
p20041
aVIt looks like you can just loop over  (a list) itself instead of using a :
p20042
as(dp20043
g16
V100297
p20044
stp20045
a((dp20046
g2
(lp20047
VYou misspelled your  parameter, you wrote  instead:
p20048
aVwon't be called if you specify the mode correctly
p20049
aV:-)
p20050
aVYou'll then have to loop over the tarfile object to extract the members, you cannot read arbitrary files from the tarfile:
p20051
aVYou cannot use any of the ,  or  methods as these require a full scan of the file, putting the file pointer at the end and leaving you without a means to read the entry data itself
p20052
as(dp20053
g16
V100297
p20054
stp20055
a((dp20056
g2
(lp20057
VYou did not post JSON data
p20058
aVSet the  parameter to :
p20059
as(dp20060
g16
V100297
p20061
stp20062
a((dp20063
g2
(lp20064
VYou are using an XPath expression, that is not supported by the  version included in Python 2
p20065
ag5279
aVYou'll need to filter for the attribute manually, after a :
p20066
as(dp20067
g16
V100297
p20068
stp20069
a((dp20070
g2
(lp20071
VDo not use  on the  instance; it'll read the  stream until it is finished
p20072
aVFrom the documentation:
p20073
aVInteract with process: Send data to stdin
p20074
aVRead data from stdout and stderr, until end-of-file is reached
p20075
aVThe code for  even adds an explicit  call on the  of the pipe
p20076
aVSimply removing the call to  should be enough, but do also add a  after reading the tarfile contents:
p20077
aVIt could be that  also closes , but an extra  there should not hurt
p20078
as(dp20079
g16
V100297
p20080
stp20081
a((dp20082
g2
(lp20083
VThe code is trying to import the BeautifulSoup library, but cannot find it
p20084
aVMake sure you've installed  in your local project path
p20085
aVDownload the  tarball, unpack it and copy the  directory to your project
p20086
as(dp20087
g16
V100297
p20088
stp20089
a((dp20090
g2
(lp20091
VA  is an anonymous function:
p20092
aVIt is often used in functions such as  that take a callable as a parameter (often the  keyword parameter)
p20093
aVYou could provide an existing function instead of a  there too, as long as it is a callable object
p20094
aVTake the  function as an example
p20095
aVIt'll return the given iterable in sorted order:
p20096
aVbut that sorts uppercased words before words that are lowercased
p20097
aVUsing the  keyword you can change each entry so it'll be sorted differently
p20098
aVWe could lowercase all the words before sorting, for example:
p20099
aVWe had to create a separate function for that, we could not inline the  line into the  expression:
p20100
aVA  on the other hand, can be specified directly, inline in the  expression:
p20101
aVLambdas are limited to one expression only, the result of which is the return value
p20102
aVThere are loads of places in the Python library, including built-in functions, that take a callable as keyword or positional argument
p20103
aVThere are too many to name here, and they often play a different role
p20104
as(dp20105
g16
V100297
p20106
stp20107
a((dp20108
g2
(lp20109
VUse the  function on the filedescriptor of the  stream or any other file you need to test:
p20110
aVFor open files (like the  stream) the  method returns the necessary descriptor
p20111
as(dp20112
g16
V100297
p20113
stp20114
a((dp20115
g2
(lp20116
VUse the  keyword argument to :
p20117
aVInstead of the lambda you can use  as well:
p20118
aVor pass in :
p20119
as(dp20120
g16
V100297
p20121
stp20122
a((dp20123
g2
(lp20124
VYou are confusing raw string literals  with string representations
p20125
aVThere is a big difference
p20126
aVand  are not the same thing
p20127
aVraw string literals produce a string just like a normal string literal does, with the exception to how it handles escape codes
p20128
aVThe produced result is still a python string
p20129
aVYou can produce the same strings using either a raw string literal or a normal string literal:
p20130
aVWhen not using a  raw string literal I had to double the slash to escape it, otherwise it would be interpreted as the newline character
p20131
aVI didn't have to escape it when using the  syntax because it does not interpret escape codes such as  at all
p20132
aVThe output, the resulting python string value, is exactly the same:
p20133
aVThe interpreter is using  to echo those values back to us; the representation of the python value is produced:
p20134
aVNotice how the  result includes the quotes
p20135
aVWhen we echo just the  of a string, the result is itself a string, so it has two sets of quotes
p20136
aVThe other  quotes mark the start and end of the result of , and contained within that is the string representation of the python string
p20137
aVSo  is a syntax to produce python strings,  is a method to produce strings that represent a python value
p20138
aValso works on other python values:
p20139
aVThe  integer is represented as a string  (the character  in a string)
p20140
as(dp20141
g16
V100297
p20142
stp20143
a((dp20144
g2
(lp20145
VAs long as you use a list of parameters and leave  set to False, yes, the parameters are safe from code injection
p20146
aVThey will not be parsed by a shell and thus not subject to any code execution opportunities
p20147
aVNote that on Windows, the chances of using code injection are already mitigated by the fact that a  call is used
p20148
as(dp20149
g16
V100297
p20150
stp20151
a((dp20152
g2
(lp20153
V is a string, not a tuple
p20154
aVStrings are indexable too, so  is then the string ' (the character at position 1)
p20155
aVYou'd need to convert the input to a tuple first
p20156
aVAn easy method to do that would be to use the  function:
p20157
aVThe  function interprets it's input as a python literal, and will try and return you a python value that matches that input
p20158
as(dp20159
g16
V100297
p20160
stp20161
a((dp20162
g2
(lp20163
VUse , and only specify these requirements:
p20164
aVThen use a proper installing tool such as ,  (comes with  and ) or  to manage installation of those dependencies
p20165
aVBy separating dependency management and installation, you have much better control over what gets installed when
p20166
aVI can recommend you read the Hitchhikers Guide to Packaging to learn more about packaging of python code and dependency management
p20167
as(dp20168
g16
V100297
p20169
stp20170
a((dp20171
g2
(lp20172
VPresumably, with  you mean
p20173
aVThe  function expressly takes a set of columns as it's argument, and it's result is a stand-alone  instance
p20174
aVThis is described in detail in the Selecting chapter of the core tutorial
p20175
aVThe  method on a table on the other hand, takes a  first argument, not a set of columns
p20176
aVIn other words, whatever you pass to that method, form the  filter for the select, not the columns you wanted to select
p20177
aVBy passing in a column for the where clause, you are selecting all columns, but filtering on
p20178
aVNot much of a filter, since there the expression doesn't really filter
p20179
aVIn other words, proper use of the  function is to pass in a selection filter, and the intention to select all columns:
p20180
aVwhich would be compiled to:
p20181
aV(although in SQLAlchemy 0
p20182
aV8 at least the  is expanded to an explicit list of all  column names)
p20183
aVYou should stick to the  function to select only specific columns
p20184
as(dp20185
g16
V100297
p20186
stp20187
a((dp20188
g2
(lp20189
VDuck typing means testing for methods, not using
p20190
aVWhat do you intend to do with the input
p20191
aVIf, for example, you'll accept a string, then split that string on newlines and use it otherwise like a list, test for :
p20192
as(dp20193
g16
V100297
p20194
stp20195
a((dp20196
g2
(lp20197
VIf all your file contains are one element per line, don't use the  module
p20198
aVJust read the file directly:
p20199
aVThe  module is used to parse multiple comma, space or tab-separated values per line, and thus each line is returned as a list of columns
p20200
aVIf you must use  for the file, 'unwrapping' the resulting nested lists is easy enough:
p20201
aVThat is a list comprehension, that takes the first column of each row produced by the  call
p20202
as(dp20203
g16
V100297
p20204
stp20205
a((dp20206
g2
(lp20207
VYou are passing a value into the  constructor that is not supported by that class
p20208
aVWhat you are passing in is unclear though
p20209
aVIn Zope, when it reports a traceback for an exception (writes it to the log, passes it to the error view), it includes any local variable with the name  when printing each stack
p20210
aVThis is used to include debug information in the logged exception
p20211
aVUse this to track what values you are passing to :
p20212
aVRun Zope in foreground mode ( or , depending on what version you have and how it was installed), and watch for the traceback being dumped to stderr
p20213
aVIt'll have an extra line with the value of  included in the traceback
p20214
as(dp20215
g16
V100297
p20216
stp20217
a((dp20218
g2
(lp20219
VYou are trying to pass in a  keyword argument to the  function; you need to pass in a  argument instead (it takes a dictionary):
p20220
as(dp20221
g16
V100297
p20222
stp20223
a((dp20224
g2
(lp20225
VYour  method is called before  has been called, and there is no  attribute set at that moment
p20226
aVSimply add  to your class:
p20227
aVis called for all text nodes in your document, including whitespace, so it's not that unusual for it to be called before
p20228
as(dp20229
g16
V100297
p20230
stp20231
a((dp20232
g2
(lp20233
VDon't use  when a simple generator expression counting the lines with  is enough:
p20234
aVis enough to test if the string  is not present in a string
p20235
aVLooping over the open file is looping over all the lines
p20236
aVThe  function will add up all the s, which are generated for each line not containing , giving you a count of lines without  in them
p20237
aVIf you need to count the lines from  to , you need a little  magic:
p20238
as(dp20239
g16
V100297
p20240
stp20241
a((dp20242
g2
(lp20243
VYou are trying to run  in a directory that has been removed
p20244
aVRecreate the directory, or use  to go to an existing directory instead
p20245
as(dp20246
g16
V100297
p20247
stp20248
a((dp20249
g2
(lp20250
V is the path of your script as executed by Python
p20251
aVYou can use  to get just the directory name from that:
p20252
aVIt is OS-dependent if it is the full path entered on the command line; Mac OS X and Linux both include the path
p20253
aVThe path can, however, differ based on how Python invoked it
p20254
aVAn alternative is to use , and you can make the path absolute by using  and  to cover all variations:
p20255
as(dp20256
g16
V100297
p20257
stp20258
a((dp20259
g2
(lp20260
VDon't use  to create the output
p20261
aVUse  instead, which has a  option:
p20262
as(dp20263
g16
V100297
p20264
stp20265
a((dp20266
g2
(lp20267
VLooks like you are trying to deploy to a Python 2
p20268
aV5 app engine instance
p20269
aVBeautifulSoup 4 needs Python 2
p20270
ag4892
aVConvert your code to use BeautifulSoup version 3, or upgrade your app engine instance to Python 2
p20271
ag4892
as(dp20272
g16
V100297
p20273
stp20274
a((dp20275
g2
(lp20276
VJust create a mapping from number to count
p20277
aVThe  class makes that easiest:
p20278
aVUsing a  is also an option:
p20279
aVor you can use a normal :
p20280
as(dp20281
g16
V100297
p20282
stp20283
a((dp20284
g2
(lp20285
VBecause selecting an empty slice is legal
p20286
aVYou can even select nonsensical slices:
p20287
as(dp20288
g16
V100297
p20289
stp20290
a((dp20291
g2
(lp20292
VYou are trying to read a file that is not encoded in the default platform encoding ()
p20293
aVBy opening the file in text mode () Python 3 will try and decode the file contents to unicode
p20294
aVYou didn't specify an encoding, so the platform preferred encoding is used
p20295
aVOpen the files in binary mode instead, using  as the mode
p20296
aVSince you are only calculating the MD5 hash (a function that expects bytes), you should not be using text mode anyway
p20297
as(dp20298
g16
V100297
p20299
stp20300
a((dp20301
g2
(lp20302
VUnfortunately, that project provides only a python 2
p20303
aV5 egg, which does not include a setup
p20304
aVpy file at all
p20305
aVThat is an error on the part of the author of the package
p20306
aVYou need to find a  source distribution instead
p20307
aVI cannot locate one, though
p20308
as(dp20309
g16
V100297
p20310
stp20311
a((dp20312
g2
(lp20313
VThe navigation tree uses the  component to find all elements shown
p20314
aVThe default implementation filters out anything used as a default page
p20315
aVYou'll have to provide your own implementation instead; but you can re-use the original implementation
p20316
aVAll you have to do is alter the generated query a little; normally, if no more specific query is present, the  index is used to filter out default pages
p20317
aVBut if your altered query adds a search for that index, then it'll not try to add a more specific filter
p20318
aVSetting it to search for  means it'll return both default and non-default pages, effectively neutralizing the filter
p20319
aVThe implementation then becomes:
p20320
aVYou'll have to register this as an adapter, and add the  to your portlet to 'activate' this builder:
p20321
aVAll with the caveat that this is untested, but it should work
p20322
as(dp20323
g16
V100297
p20324
stp20325
a((dp20326
g2
(lp20327
VUse absolute imports instead:
p20328
aVYou can still import the 'masking', local  module using the relative import syntax:
p20329
aVSupport for absolute imports as an option has been introduced in python 2
p20330
aV5, and is the default in python 3
p20331
aVIt'd be better to rename the 'masking' module, however
p20332
as(dp20333
g16
V100297
p20334
stp20335
a((dp20336
g2
(lp20337
VYou have to specify the source encoding used to create your python source
p20338
aVDo this by adding a source encoding declaration:
p20339
aVThis should be the first or second line of your python source file
p20340
aVThe encoding has to match the encoding you saved the file in; check your text editor settings
p20341
aVThe error message you added to your question indicates that the encoding doesn't match, I suspect you used latin-1 (ISO 8859-1) instead
p20342
aVAlternatively, use unicode escapes to include non-ASCII characters;  represents the e with accent grave in a as a unicode code point
p20343
aVPlease do study up on how Python handles Unicode in the Python Unicode HOWTO
p20344
aVThe Joel Spolsky Unicode article is also essential reading for any software developer dealing with any non-ASCII data
p20345
as(dp20346
g16
V100297
p20347
stp20348
a((dp20349
g2
(lp20350
VPython lists do not automatically grow when you address indices beyond it's current size
p20351
aVYou created an empty list, so you cannot address any index in it
p20352
aVUse  to add new values to the end of the list:
p20353
aVAlternatively, you'd have to create a list that can hold all the indices you want to generate instead, by pre-filling it with None or another default value:
p20354
as(dp20355
g16
V100297
p20356
stp20357
a((dp20358
g2
(lp20359
VLooks like something went wrong:
p20360
aVYou have to run  from within the source distribution directory:
p20361
aVThe  script included expect to be able to find files in the current working directory and running the script from outside the directory fails those expectations
p20362
as(dp20363
g16
V100297
p20364
stp20365
a((dp20366
g2
(lp20367
VYou are getting Unicode strings, which is normal
p20368
aVThis is not a problem
p20369
aVDjango has decoded incoming form data to Python unicode strings based on the encoding used
p20370
aVThis is normal behaviour
p20371
aVPlease do read up on Python and Unicode in the Python Unicode HOWTO to avoid future confusion
p20372
as(dp20373
g16
V100297
p20374
stp20375
a((dp20376
g2
(lp20377
VThe exception was raised after several attempts to call , which is used to translate the hostname () into a network address
p20378
aVYou must have had some network problems, your DNS server was temporarily not reachable
p20379
aVThe fact that it then worked when you changed your script has nothing to do with that error
p20380
aVYour DNS server became reachable again
p20381
as(dp20382
g16
V100297
p20383
stp20384
a((dp20385
g2
(lp20386
VNo, you cannot assign in an if statement
p20387
aVYour initial code is fine
p20388
as(dp20389
g16
V100297
p20390
stp20391
a((dp20392
g2
(lp20393
VThere is no support for  and  for  sections, and supervisord ignores these options altogether in such sections
p20394
aVYou probably meant to specify the , ,  and / or  options instead
p20395
aVThese options do not take  settings into account, you have to set them explicitly
p20396
as(dp20397
g16
V100297
p20398
stp20399
a((dp20400
g2
(lp20401
VThere is not going to be much of a speed difference between the two; you are iterating over two sequences, and only the exact datatype of those structures differs
p20402
aVYour  loop could be ever so slightly more efficient by using the  method:
p20403
aVSince  gives you a iterable of  pairs this method is exactly the same as using a tuple
p20404
aVUsing the  module, you can see there is no real difference between the two methods:
p20405
as(dp20406
g16
V100297
p20407
stp20408
a((dp20409
g2
(lp20410
VIn the expression  the first function call will have to complete before the second function call is invoked
p20411
aVSo, the whole recursion stack for the first call has to be complete before the second call is started
p20412
as(dp20413
g16
V100297
p20414
stp20415
a((dp20416
g2
(lp20417
VThere is a much better way: import  in , copy it, then add to the copy:
p20418
as(dp20419
g16
V100297
p20420
stp20421
a((dp20422
g2
(lp20423
VYou need to use absolute filepaths to open them, but  only lists filenames without a path
p20424
aVHowever, the  variable does contain the path to the current directory
p20425
aVUse  to join the two:
p20426
as(dp20427
g16
V100297
p20428
stp20429
a((dp20430
g2
(lp20431
VYou can use the  syntax for your  class:
p20432
aVthen use  instead of  in your code
p20433
aVIf you need to use  from another module, and you run into a circular import, then you should re-organize your modules
p20434
aVMove  to a new module, and import that class from both  and from
p20435
as(dp20436
g16
V100297
p20437
stp20438
a((dp20439
g2
(lp20440
VYou can split each line on whitespace:
p20441
aVre-arranges the 3 columns into 3 lists
p20442
as(dp20443
g16
V100297
p20444
stp20445
a((dp20446
g2
(lp20447
VYou are creating a deeply nested structure of method wrappers
p20448
aVEach method wrapper still has a reference to , where  is a reference to the parent method wrapper, all the way back to the original function:
p20449
aVNote how the memory address of the method wrapper  attribute points to the parent object
p20450
aVIf you create enough of these wrappers, you could run out of memory
p20451
aVPython creates such wrappers for all functions bound to an instance
p20452
aVIt's the same for a custom class with a method:
p20453
aVMethods are created from functions as needed, when accessing the method via attribute access
p20454
aVBecause they hold a reference to , they are retained in memory as long as you hold a reference to them
p20455
aVYour chain of references thus holds 100000 memory wrappers alive
p20456
as(dp20457
g16
V100297
p20458
stp20459
a((dp20460
g2
(lp20461
VIn a generator expression (or a list comprehension), the statements should be listed as if you were nesting them
p20462
aVYour  expression can be nested as:
p20463
aVYou cannot change that ordering, the following would not make sense since  is not defined:
p20464
as(dp20465
g16
V100297
p20466
stp20467
a((dp20468
g2
(lp20469
VThe  line is part of a generated console script
p20470
aVIt has no meaning to Python itself, only the  library itself uses this information
p20471
aVConsole scripts are python scripts defined in a python package metadata, and  installs wrapper script files to let you run them as command line scripts
p20472
aVThe  file installed in your virtualenv is such a script, defined by the  package  file
p20473
aVThe  module imported in the wrapper script inspects the value of   in the main script to make sure the correct version of the library is available and loaded before the  function (or any other  function) is run
p20474
aVIt'll not install the version specified, it is assumed that that version is already installed on your system
p20475
aVIt's purpose is to avoid loading incorrect, incompatible resources when the script runs and loads dependencies
p20476
as(dp20477
g16
V100297
p20478
stp20479
a((dp20480
g2
(lp20481
VYou have to store  in a separate variable:
p20482
aVNow  is only set when the exception is raised the first time
p20483
aVYou don't need to use  in this case
p20484
aVOnly use it when your for loop contains a  statement, which would skip the  suite, otherwise just put the test for  below the  loop without using the redundant  suite indentation
p20485
as(dp20486
g16
V100297
p20487
stp20488
a((dp20489
g2
(lp20490
VYou do not need to use a  statement here
p20491
aVJust use Python:
p20492
aVThis is called a conditional expression; it's constructed as , where  is used if the  evaluates to True, otherwise the  part is used
p20493
aVIf  is not a constant but a column reference, then you do need to use a  statement
p20494
aVUse  for that:
p20495
aVbut you need to make sure your  and  parenthesis are balanced (you had one too many)
p20496
as(dp20497
g16
V100297
p20498
stp20499
a((dp20500
g2
(lp20501
VYour  file does have syntax errors:
p20502
aVand
p20503
aVhave commas between the string and the  string formatting operator, and that is not legal python syntax
p20504
aVRemove the commas before the  operators
p20505
aVPlease, in future, always include the full python traceback when reporting a problem with your Python code, that saves us from having to guess what your problem is
p20506
as(dp20507
g16
V100297
p20508
stp20509
a((dp20510
g2
(lp20511
VYou didn't complete your SQL syntax and you missed a closing parenthesis there
p20512
as(dp20513
g16
V100297
p20514
stp20515
a((dp20516
g2
(lp20517
VReturn a unicode character that is guaranteed to be sorted last: :
p20518
as(dp20519
g16
V100297
p20520
stp20521
a((dp20522
g2
(lp20523
VYou are splitting the whole file, not each line
p20524
aVMoreover, your function only prints, it doesn't actually use  to return the result to the caller
p20525
aVwould return only a list of ip addresses
p20526
aVYou can assign the result directly to :
p20527
aVYour own code did not return anything in , and the default return values for a python function is
p20528
as(dp20529
g16
V100297
p20530
stp20531
a((dp20532
g2
(lp20533
VJust convert it to a dict directly:
p20534
aVThis takes each two-column result from your  CVS reader and uses that as the key and value for a python dictionary
p20535
aVTo convert each value to integers, you'd need to use a dict comprehension to process each value:
p20536
as(dp20537
g16
V100297
p20538
stp20539
a((dp20540
g2
(lp20541
VThere are  links on that page that do not have a  attribute
p20542
aVUse the following instead:
p20543
aVFor example, it is perfectly normal to declare a link target with ; you are selecting those tags too, but they do not have a  attribute and your code fails on that
p20544
as(dp20545
g16
V100297
p20546
stp20547
a((dp20548
g2
(lp20549
VYou are not posting JSON data; instead it'll be converted to URL-encoded data instead
p20550
aVdoes not provide automatic JSON encoding, even if you do set the content type to
p20551
aVUse the  module to encode:
p20552
aVYou can see this when using the  POST echo service:
p20553
as(dp20554
g16
V100297
p20555
stp20556
a((dp20557
g2
(lp20558
VYou need to use the  module to serialize your results, not the  conversion of your dictionary
p20559
aVBetter still, use a Django serializer to create the JSON result for you
p20560
as(dp20561
g16
V100297
p20562
stp20563
a((dp20564
g2
(lp20565
VYour output is valid Unicode
p20566
aVPython echoes that back to you with Unicode escape values () because the row consists of a tuple with two items; when printing a tuple it's contents are represented as python literals instead
p20567
aVIf you were to use the following code:
p20568
aVinstead it would print:
p20569
aVYou can test this by printing the literal value with the python prompt:
p20570
as(dp20571
g16
V100297
p20572
stp20573
a((dp20574
g2
(lp20575
VCorrect, the problem is with the procedure, not with Python
p20576
as(dp20577
g16
V100297
p20578
stp20579
a((dp20580
g2
(lp20581
VPython is a dynamically typed language
p20582
aVThe compiler doesn't interpret any type information when compiling python code
p20583
aVIt's all just objects with methods, and it's up to your own code to use the values as it pleases
p20584
as(dp20585
g16
V100297
p20586
stp20587
a((dp20588
g2
(lp20589
VJust add an extra value to , formatted to include the comma:
p20590
aVor use :
p20591
aVbut do include  in your fields for :
p20592
aVIf you configure your  instance to ignore extra columns, you don't need to create a separate loop for it or create a copy of  in your existing loop:
p20593
aVThe csv writer will take care of the quoting for you
p20594
as(dp20595
g16
V100297
p20596
stp20597
a((dp20598
g2
(lp20599
VSet the  option to  or more:
p20600
aVFrom the documentation:
p20601
aVIf indent is a non-negative integer, then JSON array elements and object members will be pretty-printed with that indent level
p20602
aVAn indent level of 0, or negative, will only insert newlines
p20603
aV(the default) selects the most compact representation
p20604
aVYour example would be output as:
p20605
as(dp20606
g16
V100297
p20607
stp20608
a((dp20609
g2
(lp20610
VTurn it into an  statement, with the  clause 'commented out' by the  branch (which will never be executed):
p20611
aVThe  is optional, you could also just comment out the whole  suite, but by using  you can leave the whole  suite indented and uncommented
p20612
aVSo:
p20613
aVbecomes:
p20614
as(dp20615
g16
V100297
p20616
stp20617
a((dp20618
g2
(lp20619
VWhen you print unicode, the printed text has to be encoded to match whatever encoding is used for the output stream
p20620
aVFor Linux terminals, for example, that is usually UTF-8 these days
p20621
aVBut when you use a different program to run your python script, the output stream encoding (a pipe, or a program window other than a terminal), may well use a different encoding
p20622
aVIn this case, no encoding appears to be set and python then falls back to ASCII
p20623
aVThe  character cannot be encoded to ASCII and the encode fails
p20624
aVPerhaps for this program, printing a lowercase  would suffice instead
p20625
aVOr, the as the Conky FAQ seems to suggest, explicitly encode to Latin 1 (ISO 8859-1) to output the degree symbol:
p20626
aVAnd this posting seems to hint that encoding to UTF-8 is also an option (depending on Conky configuration)
p20627
aVReplace  in the above example with  to try that encoding instead
p20628
aVAlso see the Python Unicode HOWTO, which specifies how output encoding is handled
p20629
as(dp20630
g16
V100297
p20631
stp20632
a((dp20633
g2
(lp20634
VWhat you want is to edit your buildout to create a second instance to run
p20635
aVYou'll need to add a ZEO server too, plus the necessary changes to your setup to have the instances connect to that port
p20636
aVYou cannot just change the configuration file to start a second instance on a different port otherwise; to run multiple instances you need, at the very least, a ZEO server or a RelStorage ZODB setup to be able to share access to the object database
p20637
aVSee the Plone developer manual on how to set up multiple instances and a ZEO server for your setup
p20638
aVAnd if your buildout takes 15 minutes to run, then it sounds like your buildout is perhaps doing too much network connection checking
p20639
aVTry running it with the  switch to switch off the default 'newer package' checks
p20640
aVAs for the configuration file used by , that would be
p20641
aVGenerally speaking, a  instance script is paired with a  directory, and Zope instances look for a  file there for configuration
p20642
aVAltering files by hand in  directories will be lost when re-running buildout, as it'll generate new copies
p20643
as(dp20644
g16
V100297
p20645
stp20646
a((dp20647
g2
(lp20648
VThe strings are not presented differently
p20649
aVTheir presentation is just adjusted to avoid having to quote the contained quote
p20650
aVBoth  and  are legal string literal delimiters
p20651
aVNote that the contents of the string are very different
p20652
aVis not the same string as ;  is (patently)
p20653
aVPython would have to use a  backslash for the  or  character otherwise
p20654
aVIf you use both characters in a string, then python is forced to use quoting:
p20655
aVAs you can see, the string representation used by Python still uses single quotes and a backslash to represent that last string
p20656
as(dp20657
g16
V100297
p20658
stp20659
a((dp20660
g2
(lp20661
VIt's better to raise an exception, that's what exceptions are for
p20662
aVAlso, returning  would require your code to handle testing the difference between  and
p20663
aVSuddenly you need to test the return value of your function
p20664
aVYour function does seem to suffer from a split personality
p20665
aVOn the one hand you named it , and your documentation claims it is checking if the number is valid
p20666
aVOn the other hand it is transforming, altering that number, converting it to a string, and even prepending a  to it if the  global has a length of 7
p20667
aVIf all your function does is testing if the number is valid, then returning a boolean makes sense
p20668
aVUsing exceptions can then give you more information on the nature of the validation failure perhaps, but a boolean could be enough if you do not need that information
p20669
aVBut if you also need to transform your number to a different type and format, you need to rename your function, and make then a validation error is really an exception to the normal behaviour
p20670
aVThe expectation is then that the function returns a transformed value, and invalid input should raise an exception to indicate that it could not return a normal value because of some error in the input
p20671
as(dp20672
g16
V100297
p20673
stp20674
a((dp20675
g2
(lp20676
V provides the  module, letting you load resources from python eggs and look up metadata
p20677
aVYou can use this to load resources from eggs you include in your deployment
p20678
as(dp20679
g16
V100297
p20680
stp20681
a((dp20682
g2
(lp20683
VUse a  instead:
p20684
aVA set will only hold one copy of each value, so converting your list to a set has the handy side-effect of removing all the duplicates
p20685
aVThe length of the resulting set is the answer you are looking for
p20686
aVUsing a set is the most efficient method; alternatively you could use a dict() too:
p20687
aVwhich is ever so slightly less efficient because it'll reserve space for the values associated with the keys
p20688
aVIf all you want to use is a list, (least efficient), use the  negative membership test:
p20689
as(dp20690
g16
V100297
p20691
stp20692
a((dp20693
g2
(lp20694
VYou can use  together with  to make a dictionary instead:
p20695
aVThe  function is reduced to a  and a generator expression looping over each character in the input code
p20696
aVThe  dictionary now makes for a very fast lookup of codes, the  removes the  results for anything that isn't a letter
p20697
aVResult:
p20698
as(dp20699
g16
V100297
p20700
stp20701
a((dp20702
g2
(lp20703
VIf you haven't yet packed away the transaction that deleted the folder, you can recover the folder
p20704
aVFirst, use the "Undo" tab on the parent folder, in the ZMI
p20705
aVIt could that doesn't work, too many other things on the system have changed (usually the catalog), for all the changes to be rolled back effectively
p20706
aVNext step is a little more cumbersome and involved
p20707
aVWhat you then have to do is open the Object Database (ZODB) with a wrapper that will show you the state of the database at a given point in history
p20708
aVDoing this requires some manual editing of your Zope server configuration
p20709
aVI've written up the steps in a blog post but those steps are a little outdated
p20710
aVIn a modern Plone buildout, you need to add the  egg to your buildout, and you need to switch the  setting of Zope to ; using the beforestorage wrapper makes your database read-only and the product installation code would try to commit to database, resulting in a failure to start:
p20711
aVAfter rebuilding the buildout, you need to open the  file associated with your instance
p20712
aVIf you normally start your server with , then that file is located in ; the script in  used matches the part name ( in this example)
p20713
aVLocate the part where it defines the ZODB main database:
p20714
aVYou need to add the  wrapper into that declaration:
p20715
aVNote the  line in there; when you start your instance, the site will be presented as it was at that timestamp
p20716
aVChoose one close to when you deleted the folder
p20717
aVNow you can export it (again using the ZMI) to a  file
p20718
aVUndo the changes to your  file, restart, and import the recovered folder
p20719
as(dp20720
g16
V100297
p20721
stp20722
a((dp20723
g2
(lp20724
VYou are looking at url encoding
p20725
aVUse  to interpret these to UTF-8 encoded text, then decode to unicode:
p20726
aVIn Python 3, you need to use ; the function was moved
p20727
as(dp20728
g16
V100297
p20729
stp20730
a((dp20731
g2
(lp20732
VUse :
p20733
aVYou could store a reference to the  method to simply usage:
p20734
as(dp20735
g16
V100297
p20736
stp20737
a((dp20738
g2
(lp20739
VThere is a much better way to generate JSON strings: the  module
p20740
aVThis takes advantage of the fact that  can take a sequence of key-value pairs (two-value tuples) and turn that into a mapping, which the  module directly translates to a JSON object structure
p20741
aVDemonstration:
p20742
as(dp20743
g16
V100297
p20744
stp20745
a((dp20746
g2
(lp20747
VThe verbosity is set on the anonymous  instance, and passed on to the  instance created to run the tests
p20748
aVHowever, there is no API to retrieve these objects; the test loader does not add a reference to test cases to these instances either
p20749
aVYou'd have to store the result of  in a global variable, then refer to that from your testcase:
p20750
aVthen use:
p20751
as(dp20752
g16
V100297
p20753
stp20754
a((dp20755
g2
(lp20756
VUse a set, and just all the items in one go:
p20757
aVThis uses a set comprehension to generate your set in one line of code
p20758
aVSet comprehensions were introduced in Python 2
p20759
aV7; in earlier versions use:
p20760
aVIn Python 3, you'd need to replace  by
p20761
aVYour own code doesn't work because python dictionaries are not lists; you don't retrieve values by index, but by key
p20762
aVYou'd have to change it to:
p20763
aVbut that is really inefficient, not to mention incorrect
p20764
as(dp20765
g16
V100297
p20766
stp20767
a((dp20768
g2
(lp20769
VIf  is a file-like object, you need to use the  function instead
p20770
aV(with  at the end) requires that you pass in a string and  is not a string
p20771
aVIf you are using the  library, then you do not need to decode the  value on a response, it is automaticaclly decoded for you by the library when you access that attribute
p20772
as(dp20773
g16
V100297
p20774
stp20775
a((dp20776
g2
(lp20777
VThe  constructor returns a class, not an instance itself
p20778
aVYou are adding methods to that class
p20779
aVAs such, your lambda's must accept a  argument
p20780
aVIn any case, you should create instances of the named tuple class you created
p20781
aVIf you don't want to give your lambdas a  first argument, adding them to the instance you then created would work fine:
p20782
as(dp20783
g16
V100297
p20784
stp20785
a((dp20786
g2
(lp20787
VThis is entirely platform dependent
p20788
aVUse the  function, it'll return the most precise timer for your platform
p20789
aVFrom the documentation:
p20790
aVDefine a default timer, in a platform-specific manner
p20791
aVOn Windows,  has microsecond granularity, but \u2018s granularity is 1/60th of a second
p20792
aVOn Unix,  has 1/100th of a second granularity, and  is much more precise
p20793
aVSo, on Windows, you get microseconds, on Unix, you'll get whatever precision the platform can provide, which is usually (much) better than 1/100th of a second
p20794
as(dp20795
g16
V100297
p20796
stp20797
a((dp20798
g2
(lp20799
VIf your files have a fixed list of fields, then define the fields as a list and use the line number with a modulus as an index to get the field name:
p20800
aVYou can add fields as needed if there are more than 5
p20801
as(dp20802
g16
V100297
p20803
stp20804
a((dp20805
g2
(lp20806
VPerhaps you are looking for a list comprehension
p20807
aVA list comprehension lets you process each element of an iterable to produce a new list
p20808
aVThe above example takes the first element of the nested lists, adding each to a new list
p20809
aVYour input list would then be transformed to:
p20810
as(dp20811
g16
V100297
p20812
stp20813
a((dp20814
g2
(lp20815
VYou can loop over all but the last of the references and then use the last one to delete the item:
p20816
aVBy using all but the last index you resolved the reference to the parent of the referenced item, so now you can delete it with the last index
p20817
as(dp20818
g16
V100297
p20819
stp20820
a((dp20821
g2
(lp20822
VWhen you loop over a file, the lines yielded include the newline at the end of the line
p20823
aVUsing  outputs those lines with an extra newline
p20824
aVYou can use  to remove whitespace from the start and end of the line, including the newline
p20825
aVIf you only want to remove the newline at the end, use  or  to remove it
p20826
aVLast but not least, you can also tell  not to add a newline:
p20827
as(dp20828
g16
V100297
p20829
stp20830
a((dp20831
g2
(lp20832
VIn python dictionary item access uses ; so you need to correct your lines for  and :
p20833
aVThis assumes that  is itself already a dictionary
p20834
aVYou could define that as a :
p20835
aVNow each  key is automatically another  when accessed
p20836
as(dp20837
g16
V100297
p20838
stp20839
a((dp20840
g2
(lp20841
VYou should not use  to include values in a sql query
p20842
aVUse sql parameters instead:
p20843
aVwhere  is the original list
p20844
aVThe idea is to generate a SQL query with the  test using SQL parameter syntax matching the number of providers in your list:  for a two-provider list
p20845
aVYes, the MySQLdb sql parameter syntax echoes the old-style python formatting syntax, but is not the same thing
p20846
as(dp20847
g16
V100297
p20848
stp20849
a((dp20850
g2
(lp20851
VYes, you can copy and paste code into the terminal, as long as complete definitions do not have blank lines in them
p20852
aVYou can paste:
p20853
aVbut not
p20854
aVbecause the interpreter interprets the empty line as the end of the definition of
p20855
aVThe same applies to class definitions and suites (, , , , , etc
p20856
aV; no blank lines allowed anywhere in attribute and function definitions
p20857
as(dp20858
g16
V100297
p20859
stp20860
a((dp20861
g2
(lp20862
VIt looks as if you got confused between the  and  methods, since you are passing in a separate  argument (which  doesn't accept as a dataType argument)
p20863
aVMoreover, you really should not set the  to , and you are setting  to , making for a very confusing mix as to what Pyramid will have to do with whatever jQuery makes of that combination
p20864
aVTo POST to a server with the  parameter set to , use:
p20865
aVNote that the  is set to , which means your Pyramid view needs to return JSON, the jQuery AJAX code is expecting a JSON response
p20866
as(dp20867
g16
V100297
p20868
stp20869
a((dp20870
g2
(lp20871
VPython compiles the code to bytecode first
p20872
aVIf that fails, a  is raised, indicating a failure to compile
p20873
aVAs such you cannot catch a  exception from within the module that has a syntax error itself
p20874
aVSince Python compiles files as needed, you can catch  exceptions for modules you import
p20875
aVThe following prints :
p20876
aVtest
p20877
aVpy
p20878
aVcatchsyntaxerror
p20879
aVpy
p20880
aVthen run
p20881
as(dp20882
g16
V100297
p20883
stp20884
a((dp20885
g2
(lp20886
VYou are not printing  in your  function
p20887
aVThe function finds the  attribute on the Child instance and returns that
p20888
aVAs it happens, that attribute is a method, so it is callable
p20889
aVPython thus calls the returned method, and that method then prints
p20890
aVIf you were to remove the  call, it would still work; we can store the method and call it separately to get  printed:
p20891
aVIf you have to see the arguments, you'd have to return a wrapper function instead:
p20892
aVThis now results in:
p20893
as(dp20894
g16
V100297
p20895
stp20896
a((dp20897
g2
(lp20898
VYou are running Python 2 code on Python 3
p20899
aVIn Python 3, the module has been renamed to
p20900
aVYou could try to run the  tool on your code, and try to have it translated automatically
p20901
aVReferences to  will automatically be rewritten to use  instead
p20902
as(dp20903
g16
V100297
p20904
stp20905
a((dp20906
g2
(lp20907
Vis cleaned up when the function exists when not returned
p20908
aVIt's reference count drops to 0, and it can be garbage collected
p20909
aVOn current cpython implementations that happens immediately
p20910
aVIf it is returned, the value referenced by  replaces ; the list referred to by  sees it's reference count drop by 1, but the value originally referred to by  is still being referred to by another variable
p20911
aVThe  key is a value stored in the , so that's not a temporary
p20912
aVNo extra objects are created other than that tuple
p20913
aVReplacing the old  dict with a new one will reduce the reference count by one
p20914
aVIf  was the only reference to the dict it'll be garbage collected
p20915
aVThis then causes the reference count for all contained tuple keys to drop by one
p20916
aVIf nothing else references to those those will be garbage collected
p20917
aVNote that when Python frees memory, that does not necessarily mean the operating system reclaims it immediately
p20918
aVMost operating systems will only reclaim the memory when it is needed for something else, instead presuming the program might need some or all of that memory again soon
p20919
as(dp20920
g16
V100297
p20921
stp20922
a((dp20923
g2
(lp20924
VThe  string formatter still is available in Python 3
p20925
aVIt is preferred you use the  string formatting syntax, which also supports specifying float precisions
p20926
aVBoth of these work:
p20927
aVIf it is just the one float you are converting to a string, then the  function is probably more convenient as you do not need to use a  placeholder:
p20928
as(dp20929
g16
V100297
p20930
stp20931
a((dp20932
g2
(lp20933
VWhen multiplying a list, you are not creating separate lists but rather create multiple references to the same list
p20934
aVInstead, do this:
p20935
aVYou can see the difference when using the  function:
p20936
aVSeparate objects have separate memory id values, while your lists have the same result for each  call, showing they are all the same list
p20937
as(dp20938
g16
V100297
p20939
stp20940
a((dp20941
g2
(lp20942
VThe  means the value is a unicode literal
p20943
aVEverything is working as intended, you don't need to get rid of those
p20944
aVJSON is a standard that supports Unicode values natively, and thus the  module accepts  unicode strings when converting a Python value to JSON:
p20945
as(dp20946
g16
V100297
p20947
stp20948
a((dp20949
g2
(lp20950
VThis is not CSV
p20951
aVThe format is terrible
p20952
aVThere is no delimiter between the  and the  fields, for example, and some fields have a space after the  colon and others don't
p20953
aVYou'll have to process this using custom code, then write it out to a CSV file:
p20954
aVThis uses a regular expression with named groups to parse out the line into a dictionary, for easy writing out to the CSV file
p20955
aVI've picked 'count' as the name for the first numeric value in your input file, feel free to change it (but do so in both the regular expression and the  tuple)
p20956
as(dp20957
g16
V100297
p20958
stp20959
a((dp20960
g2
(lp20961
VThe column default only applies to INSERT and UPDATE statements, and thus isn't being applied until you  the session
p20962
aVTo see the same value on new instances before you flush, you need to apply the default when a new instance is being created; in the  method of the  object:
p20963
aVIf no  attribute is being set, we add one directly based on the default configured for the column
p20964
as(dp20965
g16
V100297
p20966
stp20967
a((dp20968
g2
(lp20969
VThe idiomatic style is to not cast to ; that way someone could use any object that implements the correct mapping methods
p20970
aVSo, the most pythonic method is to use:
p20971
aVand then just use mapping methods
p20972
aVSo, you generally should not cast arguments to a dict
p20973
aVYou state your API accepts a mapping object instead, and expect callers to do the casting
p20974
aVThe only reason to accept both a  and an iterable is when you want to support ordered key-value pairs where duplicate keys are allowed, such as for the  function
p20975
aVIn such a case a  cannot retain that information, and that method does not cast the iterable to a dict, but rather uses the dict as an iterable
p20976
as(dp20977
g16
V100297
p20978
stp20979
a((dp20980
g2
(lp20981
VI think you want to have a class method instead:
p20982
aVNow you can refer to the pool defined on your class with ease
p20983
aVYour  and  'attributes' will not work, however
p20984
aVYou can add these after having created the class definition:
p20985
aVwhere they are then module-level constants, or you can add them to the class as attributes after the fact:
p20986
as(dp20987
g16
V100297
p20988
stp20989
a((dp20990
g2
(lp20991
VYou have at least one  in  that does not have a  comma in it:
p20992
aVIf  is supposed to be a comma-separated file with two columns, why not use the  module to read it instead
p20993
aVThat won't solve your issue with there being a line with no comma in it in that file though, you'll have to fix that first
p20994
as(dp20995
g16
V100297
p20996
stp20997
a((dp20998
g2
(lp20999
VYou can only access the outer class with the full global name:
p21000
aVIn python, there generally is no need to nest classes in any case
p21001
aVThere are use-cases where it makes sense to define a class in a function (to use scoped variabels), but rarely is there a need for nested classes
p21002
as(dp21003
g16
V100297
p21004
stp21005
a((dp21006
g2
(lp21007
VYou can use  to tie the wrapped function to , just like a method would be:
p21008
aVNow you are yielding partials instead, which, when called as , will call
p21009
as(dp21010
g16
V100297
p21011
stp21012
a((dp21013
g2
(lp21014
VYou are assigning to a global variable, which means you need to mark it as a global:
p21015
aVWhen you assign to a variable in a local scope, it is assumed to be a local variable unless you use a  statement to tell python otherwise first
p21016
as(dp21017
g16
V100297
p21018
stp21019
a((dp21020
g2
(lp21021
VThe operation of the  character (ASCII 7F) depends on the terminal; because it is being printed before the next character, it often does nothing at all
p21022
aVHistorically, the meaning of the 7F unicode codepoint has been unclear
p21023
aVThe  code, 08, operates on the previous character
p21024
aVAs the terminal has already printed that, works correctly:
p21025
aVPerhaps you can use that instead
p21026
as(dp21027
g16
V100297
p21028
stp21029
a((dp21030
g2
(lp21031
VTo get the second line from the  iterable, just call  twice:
p21032
aVYou can also use the  function to select just the second line:
p21033
aVBoth methods ensure that no more than two lines are ever read from the input
p21034
aVThe  function returns a global singleton object, that the other functions operate on
p21035
aVYou can only run one  instance at a time
p21036
aVMake sure you called  before you open a new  object
p21037
aVYou should use the  class instead to create multiple instances
p21038
as(dp21039
g16
V100297
p21040
stp21041
a((dp21042
g2
(lp21043
VI'd refactor this to returning separate generators; you can use nested functions:
p21044
aVNow you can also use the  function to add numbers to the items; that is much more readable than zipping together an  and the generator
p21045
as(dp21046
g16
V100297
p21047
stp21048
a((dp21049
g2
(lp21050
VYou can't disable it with a switch, no
p21051
aVThe  type implements a  method to handle the formatting, it's not that Python special-cased the expression just for strings
p21052
aVAs such, to prevent this you either need to cast the  argument to something that is not a string (by converting it to  for example), or subclass  to override the  method:
p21053
aVYou can assign this to , but this does not mean that all string literals will then use your subclass
p21054
aVYou'd have to explicitly cast your  values to  instances instead
p21055
as(dp21056
g16
V100297
p21057
stp21058
a((dp21059
g2
(lp21060
VUse the Rolling or sliding window iterator in Python solution:
p21061
aVThis happens to follow sorted order, because for python integers  and thus the sequence of 1, 2, 3, 4 is inserted in that order into the set
p21062
as(dp21063
g16
V100297
p21064
stp21065
a((dp21066
g2
(lp21067
VTurn the  value taken from the command line into a list instead, then loop over the query list:
p21068
as(dp21069
g16
V100297
p21070
stp21071
a((dp21072
g2
(lp21073
VThe catch-all  parameter must come after any explicit arguments:
p21074
aVIf you also add the catch-all  keywords parameter to a definition, then that has to come after the  parameter:
p21075
aVMixing explicit keyword arguments and the catch-all  argument does lead to unexpected behaviour; you cannot both use arbitrary positional arguments and explicitly name the keyword arguments you listed at the same time
p21076
aVAny extra positionals beyond  are first used for  which can also act as a positional argument:
p21077
aVThis is because the any second positional argument to  will always be used for
p21078
aVIn Python 3, the  parameter can be placed before the keyword arguments, but that has a new meaning
p21079
aVNormally, keyword parameters can be specified in the call signature as positional arguments (e
p21080
ag1298
aVcall your function as  would have  assigned to )
p21081
aVBy placing  or a plain  in between the positional and the named arguments you exclude the named arguments from being used as positionals; calling  would raise an exception instead
p21082
as(dp21083
g16
V100297
p21084
stp21085
a((dp21086
g2
(lp21087
VYou have to specify a custom function or lambda instead
p21088
aVThe following works:
p21089
aVwhere  becomes:
p21090
as(dp21091
g16
V100297
p21092
stp21093
a((dp21094
g2
(lp21095
VTo get more than one match use
p21096
aVHowever, using regular expressions to parse HTML is going to get ugly and complicated fast
p21097
aVUse a proper HTML parser instead
p21098
aVPython has several to choose from:
p21099
aVElementTree is part of the standard library
p21100
aVBeautifulSoup is a popular 3rd party library
p21101
aVlxml is a fast and feature-rich C-based library
p21102
aVElementTree example:
p21103
aVBeautifulSoup example:
p21104
as(dp21105
g16
V100297
p21106
stp21107
a((dp21108
g2
(lp21109
VIt's just a parameter of the function, and the code expects it to be a callable
p21110
aVPython functions, methods and objects with a  method are all callable and could be used to supply  with an argument
p21111
aVThere is not much else we can say about this without a lot more context
p21112
as(dp21113
g16
V100297
p21114
stp21115
a((dp21116
g2
(lp21117
VThe variable is not considered private; rather it's seen as a local variable
p21118
aVUse the  keyword to mark it as such:
p21119
as(dp21120
g16
V100297
p21121
stp21122
a((dp21123
g2
(lp21124
VBy using a full or relative path
p21125
aVYou are specifying just a filename, with no path, and that means that it'll be saved in the current directory
p21126
aVTo save the file in the  directory, relative from the current directory, use:
p21127
aVor better still, construct the path with  and string formatting:
p21128
aVBest is to use an absolute path:
p21129
as(dp21130
g16
V100297
p21131
stp21132
a((dp21133
g2
(lp21134
VYou might still mixing tabs and spaces, don't do that
p21135
aVRun  to detect where the indentation has become inconsistent
p21136
aVAdjust your editor to only use spaces (expand tabs to spaces, use spaces for indentation, etc
p21137
aVNote that you do need to specify a body for the new function, otherwise you'll get that same error:
p21138
as(dp21139
g16
V100297
p21140
stp21141
a((dp21142
g2
(lp21143
VNo, you cannot know what the name was of the local variable used to pass a value to your function
p21144
aVThis is an impossible task in any case
p21145
aVWhat would be the variable name in the following example
p21146
aVHere we pass in 3 arguments, two taken from a tuple we defined earlier, and one literal value, and all three are passed in using the variable argument list syntax
p21147
as(dp21148
g16
V100297
p21149
stp21150
a((dp21151
g2
(lp21152
VYou need to put the  operator in the correct locations:
p21153
aVYou cannot just put the  on a separate line, the operator requires a string to operate on
p21154
aVI corrected the indentation of your post, but I suspect that you don't realize that in Python, indentation is crucial
p21155
aVYou need to make sure that all the lines that are part of the loop, are indented properly as is now displayed in your question
p21156
as(dp21157
g16
V100297
p21158
stp21159
a((dp21160
g2
(lp21161
V is the hook method that  calls if it is present
p21162
aVThe  function will fall back to a sensible default if no such method is defined
p21163
aVHooks are there to override the default behaviour, and you should not assume they are always implemented
p21164
aVMoreover, it's more readable to just use the  callable
p21165
as(dp21166
g16
V100297
p21167
stp21168
a((dp21169
g2
(lp21170
VYou need to use the  function:
p21171
as(dp21172
g16
V100297
p21173
stp21174
a((dp21175
g2
(lp21176
VBeautifulSoup can use the  parser directly, no need to go to these lengths
p21177
as(dp21178
g16
V100297
p21179
stp21180
a((dp21181
g2
(lp21182
VUse the  module:
p21183
aVDo carefully study the module documentation; the format  means 'unsigned long long', which has a standard size of 8 bytes
p21184
aVYou can add a flag to indicate byte-order and alignment behaviour
p21185
aVWithout a flag native byte order is assumed, use  or  to signify little or big endian byte ordering for example
p21186
as(dp21187
g16
V100297
p21188
stp21189
a((dp21190
g2
(lp21191
VIndeed,  does nothing if a handler has been set up already:
p21192
aVThis function does nothing if the root logger already has handlers configured for it
p21193
aVYou'll need to replace the current handler on the root logger:
p21194
aVSee the Configuring Logging chapter in the Python Logging HOWTO
p21195
as(dp21196
g16
V100297
p21197
stp21198
a((dp21199
g2
(lp21200
VThe instance controller uses two command-line switches;  for interactive mode, and  to  load the Zope configuration and set up the  variable
p21201
aVThe  switch is what disables the  environment variable
p21202
aVYou could modify the  package to run the script anyway
p21203
aVIn , find the  file, alter the  method to:
p21204
aVIn fact, I like the idea of supporting  so much I committed that change to the recipe already, see rev 536f8fc1c4
p21205
as(dp21206
g16
V100297
p21207
stp21208
a((dp21209
g2
(lp21210
VNo, that is not a bug
p21211
aVEggs, when being created, have their bytecode compiled in a  path, and you see that reflected in the  variable
p21212
aVThe  stands for binary distribution
p21213
as(dp21214
g16
V100297
p21215
stp21216
a((dp21217
g2
(lp21218
VThe  contains the global namespace for a given function; you'll need it to be able to exec the transformed and recompiled code object:
p21219
aVDo not use  directly; you wouldn't want to overwrite items in that namespace
p21220
as(dp21221
g16
V100297
p21222
stp21223
a((dp21224
g2
(lp21225
VSince  is a method, you need to call it on an instance of :
p21226
aVI strongly urge you to study up on Python and classes, I can recommend the Python tutorial, before you continue
p21227
as(dp21228
g16
V100297
p21229
stp21230
a((dp21231
g2
(lp21232
VYou should be reusing the whole session object, not the associated cookiejar
p21233
aVUse  for all requests you make
p21234
aVIf your requests are still failing when reusing the session, they will be failing for a different reason, not because you are not properly returning cookies
p21235
aVNote that if you need to use  then the authentication is HTTPAuth-based, not cookie-based
p21236
aVYou need to pass in the same authentication for all calls
p21237
aVThe requests session can do that for you too:
p21238
aVIf, however, the login page is a form with a username and password field, you'll need to call the form target instead
p21239
aVCheck if the form is POST or GET, and check the fieldnames:
p21240
aVand not use HTTP authentication at all
p21241
as(dp21242
g16
V100297
p21243
stp21244
a((dp21245
g2
(lp21246
VI would special-case the  branch:
p21247
aVand you'll handle ranges that need to count down correctly
p21248
as(dp21249
g16
V100297
p21250
stp21251
a((dp21252
g2
(lp21253
VYou are not returning anything
p21254
aVAlways use the  statement to return a value from a function
p21255
aVPython does not use the last statement in a function as a return value
p21256
aVA function that exits without an explicit , returns  instead
p21257
as(dp21258
g16
V100297
p21259
stp21260
a((dp21261
g2
(lp21262
VYou need to pass in an open file to ; you are passing in a filename only:
p21263
aVNote that the file is opened in binary mode to prevent  bytes being translated on non-UNIX platforms
p21264
as(dp21265
g16
V100297
p21266
stp21267
a((dp21268
g2
(lp21269
VYour list and dict literal definitions can be much simplified:
p21270
aVI'm using the  method to initialize a dict with a sequence of keys, all with a given default value (a one-space string)
p21271
aVWhen you define an empty list in Python, you cannot simply address elements that don't exist
p21272
aVAlternatively, use the  method to add new elements to a list:
p21273
aVThe above example uses the  dict literal notation
p21274
aVI suspect you would benefit from reading the (excellent) Python tutorial first
p21275
as(dp21276
g16
V100297
p21277
stp21278
a((dp21279
g2
(lp21280
VYou can use the  function:
p21281
as(dp21282
g16
V100297
p21283
stp21284
a((dp21285
g2
(lp21286
VThe  module can not handle Unicode input
p21287
aVIt says so specifically on its documentation page:
p21288
aVNote: This version of the  module doesn\u2019t support Unicode input
p21289
aVAlso, there are currently some issues regarding ASCII NUL characters
p21290
aVAccordingly, all input should be UTF-8 or printable ASCII to be safe;
p21291
aVYou need to convert your CSV file to UTF-8 so that the module can deal with it:
p21292
aVAlternatively, you can use the command-line utility  to convert the file for you
p21293
aVThen use that re-coded file to read your data:
p21294
aVNote that the columns then need decoding to unicode manually
p21295
as(dp21296
g16
V100297
p21297
stp21298
a((dp21299
g2
(lp21300
VYou can't
p21301
aVNot with  in any case
p21302
aVFrom the source code:
p21303
aVUse the  library instead, it supports connection keep-alive:
p21304
aVThe above example uses http://httpbin
p21305
aVorg to reflect the request headers; as you can see  used a  header
p21306
as(dp21307
g16
V100297
p21308
stp21309
a((dp21310
g2
(lp21311
VYou are calling  passing in the class, not an instance of that class
p21312
aVFrom the  documentation:
p21313
aVCalled unconditionally to implement attribute accesses for instances of the class
p21314
aVThe fact that this works at all with the class as a first argument in cPython is a happy coincidence; officially, the first argument should be an instance instead
p21315
as(dp21316
g16
V100297
p21317
stp21318
a((dp21319
g2
(lp21320
VYour list currently contains one dimension, with comma-separated strings representing your prices
p21321
aVSimply use  to turn those strings into lists; a list comprehension makes that a breeze:
p21322
aVThis results in a list of lists:
p21323
aVand  is the string
p21324
aVIf you need to end up with floating point values instead of strings, simply apply  on the split string:
p21325
aVso that each individual price is mapped to a  call
p21326
aVNow you have:
p21327
aVand  has the floating point value
p21328
as(dp21329
g16
V100297
p21330
stp21331
a((dp21332
g2
(lp21333
VYou are trying to use tuple assignment:
p21334
aVyou probably meant to use multiple assignment:
p21335
aVwhich will not do what you expect it to; use the following instead:
p21336
aVor, best still:
p21337
aVWhen using a comma-separated list of variable names, Python expects there to be a sequence of expressions on the right-hand side that matches the number variables; the following would be legal too:
p21338
aVThis is called tuple unpacking
p21339
aVIf, on the other hand, you tried to use multiple assignment with one empty list literal () then both  and  would be pointing to the same list and any changes made through one variable will be visible on the other variable:
p21340
aVBetter keep things crystal clear and use two separate assignments, giving each variable their own empty list
p21341
as(dp21342
g16
V100297
p21343
stp21344
a((dp21345
g2
(lp21346
VThe module is called :
p21347
as(dp21348
g16
V100297
p21349
stp21350
a((dp21351
g2
(lp21352
VIf you want to store per-file data in a data structure, you'll need to use a  or similar to do so:
p21353
aVI also replaced your  with  to just read three characters instead of reading the whole file; it's more efficient
p21354
aVNow  will have three keys, each pointing to the 3 characters read from each file:
p21355
as(dp21356
g16
V100297
p21357
stp21358
a((dp21359
g2
(lp21360
VYou must have already run that command; the row with values  already exists
p21361
as(dp21362
g16
V100297
p21363
stp21364
a((dp21365
g2
(lp21366
VYou do not need to pass  on to :
p21367
aVPython does this for you; by looking up , you are given a bound method, which means that Python will automatically add in  when you call
p21368
aVYou were, in effect, calling ; three elements where only 2 were expected
p21369
as(dp21370
g16
V100297
p21371
stp21372
a((dp21373
g2
(lp21374
VFiles in Python are iterators, meaning they can be looped over, or have iteration operations applied to them
p21375
aVTo get every 5th line, for example, would be:
p21376
aVTo skip a series of lines, use a noop for loop; here we skip 10 lines, then read 10:
p21377
aVWith the  library, and a quick scan through the Python tutorial you can figure out the rest of the script easily enough
p21378
as(dp21379
g16
V100297
p21380
stp21381
a((dp21382
g2
(lp21383
VFrom section 4
p21384
aV3 of the RFC:
p21385
aVThe version 3 or 5 UUID is meant for generating UUIDs from "names"
p21386
aVthat are drawn from, and unique within, some "name space"
p21387
aVThe
p21388
aVconcept of name and name space should be broadly construed, and not
p21389
aVlimited to textual names
p21390
aVFor example, some name spaces are the
p21391
aVdomain name system, URLs, ISO Object IDs (OIDs), X
p21392
aV500 Distinguished
p21393
aVNames (DNs), and reserved words in a programming language
p21394
aVSo UUID3 takes a namespace identifier (a UUID) and a name
p21395
aVNot a domain name and a object name
p21396
aVIf you are using a domain name as the name, use the  UUID
p21397
as(dp21398
g16
V100297
p21399
stp21400
a((dp21401
g2
(lp21402
VThere are three options:
p21403
aVYou have another terminal open with  still running
p21404
aVFind it and stop pserve there
p21405
aVYou are still running  in daemon (background) mode
p21406
aVCheck with
p21407
aVIf a daemon is running, stop it with , or if you want it to run in background modus, use
p21408
aVYou changed the port to something that conflicts with an already running program
p21409
aVYou'll have to figure out what that is
p21410
aVTry connecting to that port with your browser or using the  command, for example
p21411
aVEither change your  to not conflict or stop the other program
p21412
as(dp21413
g16
V100297
p21414
stp21415
a((dp21416
g2
(lp21417
VYou can't, not without storing the information of the last run somewhere
p21418
aVCron, by itself, does not track that for you
p21419
as(dp21420
g16
V100297
p21421
stp21422
a((dp21423
g2
(lp21424
VUsing  you can pair up elements from two lists:
p21425
aVYour sublists contain floating point values, and your list A contains strings
p21426
aVYou'll need to figure out a tolerance for comparisons
p21427
aVPerhaps turning the floats to strings with the matching precision would suffice
p21428
aVUsing a slice assignment () we replace the contents of the sublist with all elements that do not match  at 4 digits after the decimal
p21429
aVRunning that on your example input gives me:
p21430
aVIf you only want the first match to be removed, use:
p21431
aVThis'll find the first index that matches, and remove that from
p21432
aVResult (in this case exactly the same as before):
p21433
as(dp21434
g16
V100297
p21435
stp21436
a((dp21437
g2
(lp21438
VIn this case, it'll probably be simplest to just patch the code that remaps the workflows
p21439
aVOpen the  egg (it's path will be listed in your  script), find the  file and edit it
p21440
aVAbout halfway down you'll find the following line (line 79 in my copy):
p21441
aVand add  to that:
p21442
aVThe alternative is copying that whole file into your own project, make that change locally, then calling it with:
p21443
aVThe  script then uses the current state of the object to find the new state it should have in the new target workflow(s) (it'll do this for each new workflow); if the old state is not listed in the map it'll use the initial state of the target workflow
p21444
as(dp21445
g16
V100297
p21446
stp21447
a((dp21448
g2
(lp21449
VThe resolver is not publicly accessible; the  function is used, and it has a nested (hidden)  function
p21450
aVThe function uses the following logic to resolve names:
p21451
aVwhere  is a declarative class (derived from )
p21452
aVAs you can see from the code, one way to resolve a name is to use the  structure, given a class , you can resolve the string  to a class using
p21453
aVThe  structure is just a python ; you can also specify your own mapper when creating the  class:
p21454
aVand then you can look up classes directly in the  mapping
p21455
as(dp21456
g16
V100297
p21457
stp21458
a((dp21459
g2
(lp21460
VYou need to pass in a matching number of arguments for your format slots
p21461
aVYour format string has 10 slots, but you are only passing in 3 values
p21462
aVReduced to 4 format slots, with only 3 arguments to , shows the same error:
p21463
aVWhen I passed in 4 arguments the  call succeeds
p21464
as(dp21465
g16
V100297
p21466
stp21467
a((dp21468
g2
(lp21469
VYou'll need to re-open the file for writing each time
p21470
aVCurrently, you are writing new records each time the score changes, all one after the other, in your file
p21471
aVYour file now contains several pickles but only the first is being read
p21472
aVChange your code to:
p21473
aVwith  unchanged
p21474
aVThe highscore file is now being written from scratch each time the score changes
p21475
as(dp21476
g16
V100297
p21477
stp21478
a((dp21479
g2
(lp21480
VSimple:
p21481
as(dp21482
g16
V100297
p21483
stp21484
a((dp21485
g2
(lp21486
VYes
p21487
aVBecause python can simply return a tuple, you use that to change multiple values:
p21488
aVSince passing by reference is mainly used (in C at least) to work around the fact you cannot return more than one value from a function, you don't need passing by reference in Python
p21489
as(dp21490
g16
V100297
p21491
stp21492
a((dp21493
g2
(lp21494
VPython distinguishes between the  and  operators and provides separate hooks for these;  and
p21495
aVThe  type simply provides a different implementation for the latter
p21496
aVIt is more efficient for lists to implement these separately;  has to return a completely new list, while  can just extend  then return
p21497
aVIn the C code,  is implemented by , which simply calls , or, in python code,
p21498
aVThe latter takes any sequence, by design
p21499
aVThe  method on the other hand, represented in C by , only takes a  as input, probably for efficiency's sake; it can loop directly over the internal C array and copy items over to the new list
p21500
aVIn conclusion, the reason  accepts any sequence is because when PEP 203 (the Augmented Add proposal) was implemented, for lists it was simplest just to reuse the  method
p21501
as(dp21502
g16
V100297
p21503
stp21504
a((dp21505
g2
(lp21506
VThey are very different
p21507
aVOne set changes the set in place, while the other leaves the original set alone, and returns a copy instead
p21508
aVNote how  has remained unchanged
p21509
aVNow I've changed  itself
p21510
aVNote also that  didn't return anything; it did not return  to the caller
p21511
aVMethods that change objects in-place never return anything in Python
p21512
aVTheir return value is always
p21513
as(dp21514
g16
V100297
p21515
stp21516
a((dp21517
g2
(lp21518
VClass scope and list comprehensions do not mix
p21519
aVThe why; or, the official word on this
p21520
aVIn Python 3, list comprehensions were given a proper scope (local namespace) of their own, to prevent their local variables bleeding over into the surrounding scope (see Python list comprehension rebind names even after scope of comprehension
p21521
aVIs this right
p21522
aVThat's great when using such a list comprehension in a module or in a function, but in classes, scoping is a little, uhm, strange
p21523
aVThis is documented in pep 227:
p21524
aVNames in class scope are not accessible
p21525
aVNames are resolved in
p21526
aVthe innermost enclosing function scope
p21527
aVIf a class definition
p21528
aVoccurs in a chain of nested scopes, the resolution process skips
p21529
aVclass definitions
p21530
aVand in the  compound statement documentation:
p21531
aVThe class\u2019s suite is then executed in a new execution frame (see section Naming and binding), using a newly created local namespace and the original global namespace
p21532
aV(Usually, the suite contains only function definitions
p21533
aVWhen the class\u2019s suite finishes execution, its execution frame is discarded but its local namespace is saved
p21534
aV[4] A class object is then created using the inheritance list for the base classes and the saved local namespace for the attribute dictionary
p21535
aVEmphasis mine; the execution frame is the temporary scope
p21536
aVBecause the scope is repurposed as the attributes on a class object, allowing it to be used as a scope as well leads to undefined behaviour; what would happen if a class method referred to  as a nested scope variable, then manipulates  as well, for example
p21537
aVMore importantly, what would that mean for subclasses of
p21538
aVPython has to treat a class scope differently as it is very different from a function scope
p21539
aVLast, but definitely not least, the linked Naming and binding section in the Execution model documentation mentions class scopes explicitly:
p21540
aVThe scope of names defined in a class block is limited to the class block; it does not extend to the code blocks of methods \u2013 this includes comprehensions and generator expressions since they are implemented using a function scope
p21541
aVThis means that the following will fail:
p21542
aVSo, to summarize: you cannot access the class scope from functions, list comprehensions or generator expressions enclosed in that scope; they act as if that scope does not exist
p21543
aVIn Python 2, list comprehensions were implemented using a shortcut, but in Python 3 they got their own function scope (as they should have had all along) and thus your example breaks
p21544
aVLooking under the hood; or, way more detail than you ever wanted
p21545
aVYou can see this all in action using the  module
p21546
aVI'm using Python 3
p21547
aV3 in the following examples, because it adds qualified names that neatly identify the code objects we want to inspect
p21548
aVThe bytecode produced is otherwise functionally identical to Python 3
p21549
ag5740
aVTo create a class, Python essentially takes the whole suite that makes up the class body (so everything indented one level deeper than the  line), and executes that as if it were a function:
p21550
aVThe first  there loads a code object for the  class body, then makes that into a function, and calls it
p21551
aVThe result of that call is then used to create the namespace of the class, it's
p21552
aVSo far so good
p21553
aVThe thing to note here is that the bytecode contains a nested code object; in Python, class definitions, functions, comprehensions and generators all are represented as code objects that contain not only bytecode, but also structures that represent local variables, constants, variables taken from globals, and variables taken from the nested scope
p21554
aVThe compiled bytecode refers to those structures and the python interpreter knows how to access those given the bytecodes presented
p21555
aVThe important thing to remember here is that Python creates these structures at compile time; the  suite is a code object () that is already compiled
p21556
aVLet's inspect that code object that creates the class body itself; code objects have a  structure:
p21557
aVThe above bytecode creates the class body
p21558
aVThe function is executed and the resulting  namespace, containing  and  is used to create the class (except that it doesn't work because  isn't defined as a global)
p21559
aVNote that after storing  in , it loads another code object; that's the list comprehension; it is wrapped in a function object just like the class body was; the created function takes a positional argument, the  iterable to use for it's looping code, cast to an iterator
p21560
aVFrom this you can see that the only difference between a code object for a function or a generator, and a code object for a comprehension is that the latter is executed immediately when the parent code object is executed; the bytecode simply creates a function on the fly and executes it in a few small steps
p21561
aVPython 2
p21562
aVx uses inline bytecode there instead, here is output from Python 2
p21563
aV7:
p21564
aVNo code object is loaded, instead a  loop is run inline
p21565
aVSo in Python 3
p21566
aVx, the list generator was given a proper code object of it's own, which means it has it's own scope
p21567
aVHowever, the comprehension was compiled together with the rest of the python source code when the module or script was first loaded by the interpreter, and the compiler does not consider a class suite a valid scope
p21568
aVAny referenced variables in a list comprehension must look in the scope surrounding the class definition, recursively
p21569
aVIf the variable wasn't found by the compiler, it marks it as a global
p21570
aVDisassembly of the list comprehension code object shows that  is indeed loaded as a global:
p21571
aVThis chunk of bytecode loads the first argument passed in (the  iterator), and just like the Python 2
p21572
aVx version uses  to loop over it and create it's output
p21573
aVHad we defined  in the  function instead,  would be a cell variable (cells refer to nested scopes):
p21574
aVThe  will indirectly load  from the code object cell objects:
p21575
aVThe actual referencing looks the value up from the current frame data structures, which were initialized from a function object's  attribute
p21576
aVSince the function created for the comprehension code object is discarded again, we do not get to inspect that function's closure
p21577
aVTo see a closure in action, we'd have to inspect a nested function instead:
p21578
aVSo, to summarize:
p21579
aVList comprehensions get their own code objects in Python 3, and there is no difference between code objects for functions, generators or comprehensions; comprehension code objects are wrapped in a temporary function object and called immediately
p21580
aVCode objects are created at compile time, and any non-local variables are marked as either global or as free variables, based on the nested scopes of the code
p21581
aVThe class body is not considered a scope for looking up those variables
p21582
aVWhen executing the code, Python has only to look into the globals, or the closure of the currently executing object
p21583
aVSince the compiler didn't include the class body as a scope, the temporary function namespace is not considered
p21584
aVA workaround; or, what to do about it
p21585
aVIf you were to create an explicit scope for the  variable, like in a function, you can use class-scope variables for a list comprehension:
p21586
aVThe 'temporary'  function can be called directly; we replace it when we do with it's return value
p21587
aVIt's scope is considered when resolving :
p21588
aVOf course, people reading your code will scratch their heads over this a little; you may want to put a big fat comment in there explaining why you are doing this
p21589
aVThe best work-around is to just use  to create an instance variable instead:
p21590
aVand avoid all the head-scratching, and questions to explain yourself
p21591
aVFor your own concrete example, I would not even store the  on the class; either use the output directly (don't store the generated class at all), or use a global:
p21592
as(dp21593
g16
V100297
p21594
stp21595
a((dp21596
g2
(lp21597
VTo be able to run any subprocess as a different user from what  is running as, you must run  as root
p21598
aVWhen you run  as a user other than root, it cannot run subprocesses under another user
p21599
aVThis is a UNIX process security restriction
p21600
as(dp21601
g16
V100297
p21602
stp21603
a((dp21604
g2
(lp21605
VYou are looking for a python generator instead:
p21606
aVThe  package comes with a pre-built  generator
p21607
as(dp21608
g16
V100297
p21609
stp21610
a((dp21611
g2
(lp21612
VYou need to use a reference to the class to refer to it's variables; you could perhaps use a class method (with the  decorator), but there is really no need to
p21613
aVBetter use  to get a fool-proof 'static' counter; no need to reassign back to the class attribute then:
p21614
aV(code above assumes Python 2; on Python 3 iterables do not have a  method and you'd need to use  instead)
p21615
aVBecause the counter is an iterator, we don't need to assign to  at all
p21616
aVSubclasses can provide their own counter as needed, or re-use the parent class counter
p21617
as(dp21618
g16
V100297
p21619
stp21620
a((dp21621
g2
(lp21622
VWhy not just use integer division then
p21623
aVFor 0, 1 and 2, that'll result in bucket , for 3, 4 and 5, it'll be , etc
p21624
as(dp21625
g16
V100297
p21626
stp21627
a((dp21628
g2
(lp21629
VUnfortunately, you cannot combine  class filtering with  output; even in the latest version JSON output is severely broken
p21630
aVInstead, filter the full JSON output yourself
p21631
aVNote that you should avoid using  when using , pass in a list instead; no need to pipe stdin either, but do capture (silence) stderr
p21632
aVThen we can recurse over the 'children' structures, picking out anything that has a matching  key:
p21633
aVthen loop over :
p21634
as(dp21635
g16
V100297
p21636
stp21637
a((dp21638
g2
(lp21639
VHaving checked the sqlite connection object C source code I can definitively state that that information is not available
p21640
aVYou'll have to store that path before you open the connection:
p21641
as(dp21642
g16
V100297
p21643
stp21644
a((dp21645
g2
(lp21646
VOne of those fields is a  object, the other a  object
p21647
aVYou'll have to decide what you want subtraction to mean
p21648
aVYou could, for example, turn the  object into a  object with a fixed time of day, say, midnight:
p21649
aVtakes a  and a  object and creates a new  object; we use  as an easy short-cut to a  object representing midnight
p21650
aVOr, you could just turn the  object into a  object and then subtract:
p21651
aVThe  method returns just the date component of a  object
p21652
aVThe result is a  object representing the number of days between the two dates
p21653
as(dp21654
g16
V100297
p21655
stp21656
a((dp21657
g2
(lp21658
VYou are looking at the  representation output of your classes
p21659
aVwill call the  hook if defined on your custom classes:
p21660
as(dp21661
g16
V100297
p21662
stp21663
a((dp21664
g2
(lp21665
VNo, not for variables
p21666
aVVariables are just references to arbitrary python objects, and if you can find the variable, you have found the function, class, or the module it is defined in
p21667
aVI suspect you wanted to know where python objects are defined in instead; for many objects that can be determined from the  attribute of the object
p21668
aVFor classes, you'd have to traverse back it's module first, for methods, traverse to it's function, for functions, find it's code object, for code objects, use their  attribute, etc
p21669
aVOr use the  function to automate that process:
p21670
as(dp21671
g16
V100297
p21672
stp21673
a((dp21674
g2
(lp21675
VUse :
p21676
as(dp21677
g16
V100297
p21678
stp21679
a((dp21680
g2
(lp21681
VDon't use  and string concatenation when you can use SQL parameters instead; also, your  variable contains a list of tuples, not a list of integers; your function must be returning all results as rows
p21682
aVThe following would work if you had a database cursor reference:
p21683
aVUsing SQL parameters has the added advantage that the database adapter will apply the correct quoting to whatever values you are passing in
p21684
aVStrings will be quoted, integers not, for example, and most importantly, dangerous SQL injection attempts are thwarted
p21685
aVThe exact syntax for specifying SQL parameters depends on your database adapter
p21686
aVI used  style positional parameters (as you used the mysql tag), but depending on the database adapter, any of the following can be supported:
p21687
aVpositional parameters
p21688
aVpositional parameters (used my MySQLdb, for example)
p21689
aVnamed parameters
p21690
aVnamed parameters
p21691
aVCheck your database adapter documentation for the exact variants that are supported
p21692
aVWhat happened in your case is that  is a tuple containing a python long integer, whose string representation includes an
p21693
aVYour database would not have accepted your query even if it didn't, as you were assuming all input values were strings anyway, and you were putting quotes around the value regardless
p21694
aVQuerying for a string  where an integer is expected won't work
p21695
aVTo extrapolate this to your expanded function:
p21696
aVand call with:
p21697
as(dp21698
g16
V100297
p21699
stp21700
a((dp21701
g2
(lp21702
VYou are zipping together the wrong items
p21703
aVZip only  and , you do not need to use the second item in the  tuples:
p21704
as(dp21705
g16
V100297
p21706
stp21707
a((dp21708
g2
(lp21709
VI suspect the server is returning JSON strings
p21710
aVJSON uses the same escape sequence, and if you add quotes around the string  is perfectly happy to decode that example for you:
p21711
aVTry using  to decode the response to Unicode
p21712
aVYour updated version does contain quotes, a little vexing, since those would have to be escaped to be using in valid JSON
p21713
aVIt probably is not JSON then, but some other form of escapes; Java and Ruby also use  escapes
p21714
aVNext thing we can try is to use a regular expression to replace these:
p21715
aVThis regular expression will decode any  match to it's unicode character equivalent, provided that it is not preceded by a , which effectively escapes the escape;  is not going to be replaced
p21716
aVThe regular expression approach decodes your both examples (second decoded first):
p21717
as(dp21718
g16
V100297
p21719
stp21720
a((dp21721
g2
(lp21722
VIf a given instance already provides the interface, then  will return the passed-in instance
p21723
aVAfter all, it already satisfies the requirement, you can use  directly if you need to use  methods:
p21724
aVgoes directly to the adapter registry, and if you registered an adapter for the given class to  then that adapter will be returned
p21725
aVThis is somewhat pointless, since the original object already provided the interface, so no adaptation was needed
p21726
as(dp21727
g16
V100297
p21728
stp21729
a((dp21730
g2
(lp21731
VYou are confusing assignment with mutation of an object
p21732
aVIn one method, you assigned new values to , changing what it points to:
p21733
aVbut in the other method you changed values contained in :
p21734
aVNote the  there; you are, in essence, telling python to do this:
p21735
aVThe value of the variable , which points to a list, is never changed
p21736
aVThe values in the list referred to by , do change
p21737
aVTake a look at this previous answer of mine, which goes into more detail as to what the difference is between these two statements: Python list doesn't reflect variable change, new to python
p21738
as(dp21739
g16
V100297
p21740
stp21741
a((dp21742
g2
(lp21743
VSQLite can handle huge transactions with ease, so why not commit at the end
p21744
aVHave you tried this at all
p21745
aVIf you do feel one transaction is a problem, why not commit ever  transactions
p21746
aVProcess rows one by one, insert as needed, but every  executed insertions add a  to spread the load
p21747
as(dp21748
g16
V100297
p21749
stp21750
a((dp21751
g2
(lp21752
VUse polymorphism and duck-typing before  or interfaces
p21753
aVYou generally define what you want to do with your objects, then either use polymorphism to adjust how each object responds to what you want to do, or you use duck typing; test if the object at hand can do the thing you want to do in the first place
p21754
aVThis is the invocation versus introspection trade-off, conventional wisdom states that invocation is preferable over introspection, but in Python, duck-typing is preferred over  testing
p21755
aVSo you need to work out why you need to filter on wether or not something is iterable in the first place; why do you need to know this
p21756
aVJust use a ,  to test
p21757
aVOr perhaps you just need to throw an exception if whatever that was passed was not an iterable, as that would signal an error
p21758
aVABCs
p21759
aVWith duck-typing, you may find that you have to test for multiple methods, and thus a  test may look a better option
p21760
aVIn such cases, using a Abstract Base Class (ABC) could also be an option; using an ABC let's you 'paint' several different classes as being the right type for a given operation, for example
p21761
aVUsing a ABC let's you focus on the tasks that need to be performed rather than the specific implementations used; you can have a  ABC, a  ABC, etc
p21762
aVZope interfaces and component architecture
p21763
aVIf you find your application is using an awful lot of ABCs or you keep having to add polymorphic methods to your classes to deal with various different situations, the next step is to consider using a full-blown component architecture, such as the Zope Component Architecture (ZCA)
p21764
aVinterfaces are ABCs on steroids, especially when combined with the ZCA adapters
p21765
aVInterfaces document expected behaviour of a class:
p21766
aVbut it also let's you look up adapters; instead of putting all the behaviours for every use of shapes in your classes, you implement adapters to provide polymorphic behaviours for specific use-cases
p21767
aVYou can adapt your objects to be printable, or iterable, or exportable to XML:
p21768
aVand your code merely has to look up adapters for each shape:
p21769
as(dp21770
g16
V100297
p21771
stp21772
a((dp21773
g2
(lp21774
VWhen you encountered a bug, always upload a new release
p21775
aVIncrease the version number, include a changelog, call it a brown-bag release (it wasn't me, it was someone wearing a brown bag over their heads, really, honestly)
p21776
aVYou never know whom already may have downloaded a copy of the release (on a mirror, directly from your github page, whatever) that will never know that you fixed a bug quietly
p21777
aVMoreover, those that did figure out you replaced the release, now have to learn how to force a reinstall
p21778
aVDon't replace a released package with a silent bugfix
p21779
aVDo not be tempted
p21780
aVJust make a new release
p21781
aVIf, on the other hand, you managed somehow to corrupt the distribution file itself, so the  or  file is b0rken, then you need to manually remove the file using the PyPI web interface and re-upload
p21782
as(dp21783
g16
V100297
p21784
stp21785
a((dp21786
g2
(lp21787
VIf the URL is returning valid JSON-encoded data, use the  library to decode that:
p21788
as(dp21789
g16
V100297
p21790
stp21791
a((dp21792
g2
(lp21793
VYour observation is inaccurate; there must be 2 places that raise , or you are explicitly re-raising it
p21794
aVOnce an exception has correctly been caught, it will not be caught by other handlers higher up in the stack
p21795
aVThis is easiest shown with a little demonstration:
p21796
aVOnly the inner  handler was invoked
p21797
aVIf, on the other hand, we re-raise the exception, you'll see both handlers print a message:
p21798
aVAs such, there is no need to have to handle 'exceptions that are not caught by the function'; you will only need to handle exceptions that were not already caught earlier
p21799
as(dp21800
g16
V100297
p21801
stp21802
a((dp21803
g2
(lp21804
VYou'll have to make the translation manually; go through the string with a regular expression for example, and replace each occurrence with the hex equivalent
p21805
aVThe above example only matches newlines and carriage returns, but you can expand what characters are matched, including using  escape codes and ranges
p21806
as(dp21807
g16
V100297
p21808
stp21809
a((dp21810
g2
(lp21811
VIf your  list is already sorted by fruit, use :
p21812
aVOr in short without a generator:
p21813
aVbut it could be you could just use the generator without replacing  wholesale
p21814
aVOtherwise use  and use  to grab the first item of each group:
p21815
as(dp21816
g16
V100297
p21817
stp21818
a((dp21819
g2
(lp21820
VNo, you'd have to use  and support more mapping methods
p21821
aVHowever, you'd be much better off using the format support for attribute access instead:
p21822
aVNow it'll use attribute access to find , , etc
p21823
aVfrom the first positional argument to , which is
p21824
as(dp21825
g16
V100297
p21826
stp21827
a((dp21828
g2
(lp21829
VUse a generator:
p21830
aVDemo:
p21831
as(dp21832
g16
V100297
p21833
stp21834
a((dp21835
g2
(lp21836
VPython output is buffered, make sure you flush the  handler to see log messages sooner:
p21837
aVOn python 3
p21838
aV3 and up, you can add the  parameter to have the function do this for you:
p21839
as(dp21840
g16
V100297
p21841
stp21842
a((dp21843
g2
(lp21844
VBy using :
p21845
aVBy putting the words to split on in a capturing group, the output includes the words we split on
p21846
aVIf you need the spaces removed, use  on the  output:
p21847
aVand you could use  to remove any empty strings if need be:
p21848
aVTo split on words but keep them attached to the following group, you need to use a lookahead assertion instead:
p21849
aVNow we are really splitting on whitespace, but only on whitespace that is followed by a whole word, one in the set of ,  and
p21850
as(dp21851
g16
V100297
p21852
stp21853
a((dp21854
g2
(lp21855
VWith SQL, you really want to avoid just inserting your value into the query
p21856
aVYou normally leave that to the database adapter, which has specialized knowledge about how to avoid creating dangerous SQL from your values (SQL quotation escaping, a
p21857
aVk
p21858
ag524
aVSQL injection attacks)
p21859
aVUnfortunately, the  module has only half-heartedly implemented parameter support
p21860
aVInstead of using , just use  directly
p21861
aVFirst, generate the SQL query with parameters
p21862
aVThe format of the SQL parameters differs from database adapter to database adapter, since the Python DB API standard allows for a few variants
p21863
aVI'll assume you are using MySQL here, which uses  for positional parameters, echoing Python's syntax:
p21864
aVThat creates enough parameters for each of the values in
p21865
aVThen query the database:
p21866
aVSince you appear to be using the  module module for your connection, you'll have to adjust this for the (somewhat non-standard) SQL parameter syntax that library uses
p21867
aVIt only accepts named parameters, which use the form :
p21868
as(dp21869
g16
V100297
p21870
stp21871
a((dp21872
g2
(lp21873
VSince you cannot assign a new  docstring to a class (in CPython at least), you'll have to use a metaclass:
p21874
aVYes, we jump through an extra hoop or two, but the above metaclass will find the correct  however convoluted you make your inheritance graph
p21875
aVUsage:
p21876
aVThe alternative is to set  in , as an instance variable:
p21877
aVThen at least your instances have a docstring:
p21878
aVAs of Python 3
p21879
aV3 (which fixed issue 12773), you can finally just set the  attribute of custom classes, so then you can use a class decorator instead:
p21880
aVwhich then can be applied thus:
p21881
as(dp21882
g16
V100297
p21883
stp21884
a((dp21885
g2
(lp21886
VYou'll have to downgrade your  library to version 0
p21887
aV14
p21888
ag5740
aVThe  API python library wraps the  object, and with the refactor made for version 1
p21889
ag2391
aV0, the  attribute was removed
p21890
aVhowever still expects it to be there
p21891
aVI recommend you use a virtualenv to install libraries
p21892
aVYou could manually remove the  library from that virtualenv, or use  to downgrade it:
p21893
aVYou may want to report this issue to the soundcloud-python code project so that they can either fix their  dependency or fix the library to work with  1
p21894
ag2391
aV0 or newer
p21895
as(dp21896
g16
V100297
p21897
stp21898
a((dp21899
g2
(lp21900
VThe ZODB takes care of unused blobs by itself
p21901
aVPacking will remove blobs together with removed transactions as required
p21902
as(dp21903
g16
V100297
p21904
stp21905
a((dp21906
g2
(lp21907
VWhen it simplifies the API for the case where otherwise you'll always have to pass in a list:
p21908
aVversus:
p21909
aVwhere your usual parameters are taken from different locations; e
p21910
ag1298
aVand  are more likely to be separate variables than already collected in one list
p21911
aVThe Python 3
p21912
aVx  function does exactly that, as well as the  function
p21913
aVYou rarely have all your print arguments or path-elements-to-join combined in a list before calling the API
p21914
aVCompare:
p21915
aVvs
p21916
aVIf  or  were to accept only one positional argument (a list), the users of the API would find themselves typing the  and  brackets over and over again
p21917
aVBy accepting a variable number of positional arguments, you save users of your API the trouble of having to create  list just for the function call
p21918
aVIn the rare cases where the parameters have already been collected into a list, they can use the  calling convention:
p21919
aVto echo your function signature
p21920
as(dp21921
g16
V100297
p21922
stp21923
a((dp21924
g2
(lp21925
VYou are missing a colon in the  field definition:
p21926
as(dp21927
g16
V100297
p21928
stp21929
a((dp21930
g2
(lp21931
VYou are converting Unicode data to a bytestring:
p21932
aVWhen you do that without specifying an encoding, Python falls back to the default, which is ASCII
p21933
aVYou'll need to settle on a different encoding instead, one that can handle all Unicode codepoints your data contains
p21934
aVFor most text, UTF-8 is a good choice for that; if you have a lot of non-western text (Arabic, Asian, etc
p21935
aVthen UTF-16 might be more efficient
p21936
aVIn either case, you'll have to explicitly encode:
p21937
aVWhen reading back the data from that file, use  to decode back to Unicode
p21938
aVSee the Python Unicode HOWTO for more information on Python and Unicode
p21939
as(dp21940
g16
V100297
p21941
stp21942
a((dp21943
g2
(lp21944
VYou need to set the content type header:
p21945
aVIf I set  to , that server echos back to me what was posted:
p21946
as(dp21947
g16
V100297
p21948
stp21949
a((dp21950
g2
(lp21951
VYield goes both ways
p21952
aVUsed in a right-hand expression, it'll receive, and used as a statement it yields the result of the expression
p21953
aVJust yield that result value:
p21954
as(dp21955
g16
V100297
p21956
stp21957
a((dp21958
g2
(lp21959
VUsing the  module of course:
p21960
as(dp21961
g16
V100297
p21962
stp21963
a((dp21964
g2
(lp21965
VThat's to be expected; you write the file from scratch each time you find an element
p21966
aVOpen the file only once before looping over the links, then write rows for each anchor you find:
p21967
aVOpening a file for writing with  clears the file first, and you were doing that for each anchor
p21968
aVAs for your unicode error, please avoid, at all cost, changing the default encoding
p21969
aVInstead, encode your rows properly; I did so in the above example, you can remove the whole  call (and the  before it)
p21970
as(dp21971
g16
V100297
p21972
stp21973
a((dp21974
g2
(lp21975
VJust take the one element out of the list and replace on there:
p21976
aVThere is no need to convert the list itself to string here
p21977
aVYou could, in this case, also combine  with a  to remove whitespace from each line, then rejoin:
p21978
aVThis prints:
p21979
as(dp21980
g16
V100297
p21981
stp21982
a((dp21983
g2
(lp21984
VYou are printing the found tag
p21985
aVTo only print the contained text, use the  attribute:
p21986
aVThe  value is a  instance; to use it like a normal unicode object, convert it first
p21987
aVThen you could use  to remove the extra whitespace:
p21988
aVAdjusting this a little to allow for empty values:
p21989
aVwhich gives me:
p21990
as(dp21991
g16
V100297
p21992
stp21993
a((dp21994
g2
(lp21995
V is interpreting the value using little-endian notation, while using  and  interprets it as a big-endian unsigned integer
p21996
aVUse  or  to specify the endianness of your input, and use  to interpret it as a signed int:
p21997
aVSee the Byte Order, Size and Alignment section of the  documentation page
p21998
as(dp21999
g16
V100297
p22000
stp22001
a((dp22002
g2
(lp22003
VTo create a dictionary in a loop, use a dict comprehension
p22004
aVAssuming that your  variable is a string with comma-separated values, the following would work:
p22005
aVwhere we use each value in the comma-separated list as both key and value for the resulting dictionary
p22006
aVThe  dict comprehension was added in Python 2
p22007
aV7 and 3
p22008
aV0, in earlier python versions generate 2-value tuples instead:
p22009
as(dp22010
g16
V100297
p22011
stp22012
a((dp22013
g2
(lp22014
VYou can use the  attribute to get an iterable of all (stripped) text values in a given tag:
p22015
aVYou may have to select just one or two values of those;  could help there:
p22016
aVThe  call only selects the first and third elements, which are the from and to prices in the grid
p22017
as(dp22018
g16
V100297
p22019
stp22020
a((dp22021
g2
(lp22022
VTraceback frames have a line number too:
p22023
aVYou can also reach the code object, which will have a name, and a filename:
p22024
aVYou can use the filename and line number, plus the frame globals and the  module to efficiently turn that into the correct source code line:
p22025
aVThis is what the  module uses to turn a traceback into a useful piece of information, in any case
p22026
aVSince bytecode only has a line number associated with it, you cannot directly lead the bytecode back to the precise part of a source code line; you'd have to parse that line yourself to determine what bytecode each part would emit then match that with the bytecode of the code object
p22027
aVYou could do that with the  module, but you can't do that on a line-by-line basis as you'd need scope context to generate the correct bytecodes for local versus cell versus global name look-ups, for example
p22028
as(dp22029
g16
V100297
p22030
stp22031
a((dp22032
g2
(lp22033
V objects are file objects
p22034
aVHowever, if you are using the  module (the C-optimized version of the  module) then do note that once you ceate an empty instance, it is optimized for writing only, and you cannot use it as in input file, and vice-versa
p22035
aVSimply reinitialize it in that case:
p22036
aVFor the python version (the  module), simply seek to the start again:
p22037
aVYou do not need to specify a file mode for the  call; unless  is a string it'll be ignored in any case:
p22038
as(dp22039
g16
V100297
p22040
stp22041
a((dp22042
g2
(lp22043
VBest is to use the  method:
p22044
aVDemo:
p22045
aVYou are not passing , etc
p22046
aVin though, your method would have worked had you done that or:
p22047
as(dp22048
g16
V100297
p22049
stp22050
a((dp22051
g2
(lp22052
VThe  method and the  function take a key argument:
p22053
aVThe function named in  is called for each value and the return value is used when sorting, without affecting the actual values:
p22054
aVTo sort  before , you'd have to include a little more info in the key, so that otherwise equal values are sorted in a given order:
p22055
aVThe more complex key generates  for , and  for ;  is sorted after  and so uppercased words are sorted before their lowercase equivalent
p22056
aVSee the Python sorting HOWTO for more information
p22057
as(dp22058
g16
V100297
p22059
stp22060
a((dp22061
g2
(lp22062
VAn accent character is the combination of a space and a combining accent character, as specified in the Unicode standard:
p22063
aVThe  character has a somewhat ambiguous history, but the Unicode standard has decided to treat it as whitespace + accent, even though it has often been used as just a diacritic mark, see this discussion
p22064
aVYou could perhaps use  as an alternative; it is not treated as whitespace, and has no decomposition specified
p22065
aVIt is instead qualified as a letter, so your mileage may vary
p22066
as(dp22067
g16
V100297
p22068
stp22069
a((dp22070
g2
(lp22071
VThe  character is used to form character escapes;  has special meaning
p22072
aVUse  or use raw string  instead
p22073
aVAlternatively, you could ensure that Python reads the backslash as a backslash by escaping it with an additional
p22074
aVDemo to show the difference:
p22075
as(dp22076
g16
V100297
p22077
stp22078
a((dp22079
g2
(lp22080
VJust add it before the command without exporting it:
p22081
as(dp22082
g16
V100297
p22083
stp22084
a((dp22085
g2
(lp22086
VUse the  method:
p22087
as(dp22088
g16
V100297
p22089
stp22090
a((dp22091
g2
(lp22092
VYou should really use the  module instead of :
p22093
aVThe first argument of the  function is a list of command arguments, including the command itself
p22094
aVJust use the variable  as an element of that list
p22095
as(dp22096
g16
V100297
p22097
stp22098
a((dp22099
g2
(lp22100
VThis requires a decorate-sort-undecorate step:
p22101
aVor, combined into one line:
p22102
aVOutput:
p22103
as(dp22104
g16
V100297
p22105
stp22106
a((dp22107
g2
(lp22108
V causes an exception to be raised
p22109
aVSome other languages use the verb 'throw' instead
p22110
aVIt's intended to signal an error situation; it flags that the situation is exceptional to the normal flow
p22111
aVRaised exceptions can be caught again by code 'upstream' (a surrounding block, or a function earlier on the stack) to handle it, using a ,  combination
p22112
as(dp22113
g16
V100297
p22114
stp22115
a((dp22116
g2
(lp22117
VUse  to get a random set from a sequence
p22118
aVList the days that are available, then pass that to the  function:
p22119
aVIn the above example I used the day of the month, and the list omits certain days (say, sundays and the last 10 days of the month), then we pick 8 random days from that population
p22120
as(dp22121
g16
V100297
p22122
stp22123
a((dp22124
g2
(lp22125
VUse the  module to dynamically import, and  to find your function:
p22126
aVOr, simply import all your modules and add them to a dict to map command to callable:
p22127
as(dp22128
g16
V100297
p22129
stp22130
a((dp22131
g2
(lp22132
VYes, in Python 2
p22133
aVx iterating directly over the dictionary saves some memory, as the keys list isn't duplicated
p22134
aVYou could also use , or in Python 2
p22135
aV7, use
p22136
aVIn Python 3
p22137
aVx,  is a view, and there is no difference
p22138
aVSo, in conclusion: use  (or  in python 3) only if you need a copy of the keys, such as when you'll change the dict in the loop
p22139
aVOtherwise iterate over the dict directly
p22140
as(dp22141
g16
V100297
p22142
stp22143
a((dp22144
g2
(lp22145
VThe list comprehension syntax () is a shorthand loop syntax for producing a list
p22146
aVYou are not producing a list, you want to print items in a loop
p22147
aVSince you are not producing a python list, you have to use a regular loop
p22148
aVAlternatively, since all you are doing is printing the items on separate lines, just add the newlines yourself:
p22149
aVThis produces the same output as:
p22150
as(dp22151
g16
V100297
p22152
stp22153
a((dp22154
g2
(lp22155
VYou are using , instead of
p22156
aVis the last item from the previous loop, instead of the item in the current loop
p22157
aVPerhaps using clearer variable names would help avoid confusion here; use  and  perhaps
p22158
aVIt could be I misunderstood though and you want to combine each  with a corresponding
p22159
aVYou'll have to loop over them together, perhaps using :
p22160
aVNormally it should be easier to loop over the parent table row instead, then find the cells within that row within a loop
p22161
aVBut the  should work too, provided the  cells line up with the  matches
p22162
as(dp22163
g16
V100297
p22164
stp22165
a((dp22166
g2
(lp22167
VUse sets:
p22168
aVThis presumes the  global is a list
p22169
aVNote that it'd be much better to pass in services then return the result:
p22170
as(dp22171
g16
V100297
p22172
stp22173
a((dp22174
g2
(lp22175
VYou need to encode the string to bytes:
p22176
aVYou'll need to pick a suitable encoding, one that can represent your text properly; I am presuming that your unicode characters fall in the 0-127 range here
p22177
aVIf you encode to a different encoding, the result will be a hex representation of that encoding
p22178
aVUTF-8 will use between 1 and 6 bytes per character for example
p22179
aVAlternatively, you could use the  function and format the result to hex:
p22180
aVand it'll work with any unicode character
p22181
aVIt'll use the Unicode code point for the hex representation, so between 1 and 4 bytes (the latter for  wide characters)
p22182
aVDepending on your maximum character width, you may want to pad the bytes to prevent ambiguous code points; say you need to encode up to codepoint  then you'll need to use 2 bytes for every codepoint, or 4 hex characters:
p22183
as(dp22184
g16
V100297
p22185
stp22186
a((dp22187
g2
(lp22188
VYou need to locate your  current directory at :
p22189
aVbecause the path  loads is relative
p22190
aVYou can also use a full path:
p22191
as(dp22192
g16
V100297
p22193
stp22194
a((dp22195
g2
(lp22196
VThe XML-RPC server in  supports the  endpoint
p22197
aVUse that to send a group of  calls, using the  XML-RPC proxy:
p22198
aVwhere  is your XML-RPC proxy to the  server
p22199
aVThe calls will be sent as one HTTP request and processed on the server in series, being no faster or slower than ; the latter internally calls  for each process found anyway
p22200
as(dp22201
g16
V100297
p22202
stp22203
a((dp22204
g2
(lp22205
VThe  value is indeed not a string
p22206
aVYou need to cast it to :
p22207
aVIt's a unicode-like object called
p22208
aVIf you really need it to be a  instead, you can encode it from there:
p22209
aVor similar
p22210
aVFor use in a  I'd use  objects and not encode
p22211
aVTo understand the difference between  and  and what encoding to use, I recommend you read the Python Unicode HOWTO
p22212
as(dp22213
g16
V100297
p22214
stp22215
a((dp22216
g2
(lp22217
VYes, read the Python Unicode HOWTO; you are dealing with encoded and unicode text
p22218
aVThe first string is UTF-8 data being interpreted as Latin-1, the second string is a unicode string and cannot be passed to  without encoding first:
p22219
aVYou'll need to figure out what encoding your external process can handle and call  on your data before passing it to
p22220
as(dp22221
g16
V100297
p22222
stp22223
a((dp22224
g2
(lp22225
VThe feed is gzipped by the server for efficient downloading; it has a  header set
p22226
aVUse  to download and parse it instead of using  and BeautifulSoup
p22227
aVIf you have to use , also use the  module to decompress the content first:
p22228
as(dp22229
g16
V100297
p22230
stp22231
a((dp22232
g2
(lp22233
VYou could print  to get the script filename
p22234
aVTo get the filename of the caller, you need to use the  function to get the calling frame, then you can retrieve the filename from that:
p22235
as(dp22236
g16
V100297
p22237
stp22238
a((dp22239
g2
(lp22240
VThe query plan information is used to improve catalog performance, but you cannot optimize your own queries based on plan information
p22241
aVThe catalog only builds up that information as needed, based on your index sizes; unlike a SQL database the catalog does not plan each query based on such information but rather looks up pre-calculated plans from the structure reflected in the Query Plan tab
p22242
aVThe query report tab does give you information about what indexes are performing poorly for your code; you may want to rethink code that uses those combinations of indexes and/or look into why those indexes performed poorly; perhaps your query didn't limit the result quickly enough or the slow index is very large, indicating that perhaps your ZODB cache is too small to hold that large index or that other results keep pushing it out
p22243
aVOn the whole, for large applications it is a good idea to retain the query plan; in one project we dump cache information before stopping instances and reload that after starting again, and that includes the catalog query plan:
p22244
aVand on load:
p22245
as(dp22246
g16
V100297
p22247
stp22248
a((dp22249
g2
(lp22250
VJust detect those 2 items with an additional  statement:
p22251
aVthen use  for your CSV file
p22252
aVNote that I removed the  quotes with a simple replace call
p22253
as(dp22254
g16
V100297
p22255
stp22256
a((dp22257
g2
(lp22258
VIf you want to limit the number of lines read, use the file object as an iterable, then slice the lines using :
p22259
aVNote that we pass the 5 read lines to the  function as a series of arguments, not as one object, using the  syntax, then disable the automatic space and newline characters; the lines do not need to be separated by spaces and already include newlines
p22260
aVThe above code will only ever read 10 lines of your file, regardless of how large it is
p22261
aVCalling  will (try to) read the whole file into memory, regardless of size and available memory
p22262
as(dp22263
g16
V100297
p22264
stp22265
a((dp22266
g2
(lp22267
VWhen writing to a file, you need to encode your unicode data to bytes explicitly;  objects do not do this for you, it's a text memory file
p22268
aVUse  instead and encode:
p22269
aVAdjust your encoding to your data, of course
p22270
as(dp22271
g16
V100297
p22272
stp22273
a((dp22274
g2
(lp22275
VYou are missing a space between  and :
p22276
aVAdd that in:
p22277
aVNote that your  method is missing the  argument;  will be set to the instance instead when called
p22278
as(dp22279
g16
V100297
p22280
stp22281
a((dp22282
g2
(lp22283
VUse a list comprehension:
p22284
aVBy using  you exit the loop early
p22285
aVThe  helps avoid attempting to use the empty lists as keys (which would raise a TypeError; lists are not hashable and thus not allowed as keys)
p22286
aVThe alternative strategy would be:
p22287
aVThe  map is a little easier to extend; but using a function to map the value (as used in Jacob's answer) could be more readable to you
p22288
as(dp22289
g16
V100297
p22290
stp22291
a((dp22292
g2
(lp22293
VPython hashlib objects can provide you with either the raw bytes or a hex digest, depending on the method used
p22294
aVCalling  gives you raw bytes:
p22295
aVIf you want to get the hex digest, use the  method instead:
p22296
as(dp22297
g16
V100297
p22298
stp22299
a((dp22300
g2
(lp22301
VThat's because using literal syntax, python knows to build the list with one bytecode
p22302
aVCalling the constructor requires looking up the  global and calling it instead:
p22303
as(dp22304
g16
V100297
p22305
stp22306
a((dp22307
g2
(lp22308
VUse a different font, or a better method of displaying those
p22309
aVAll tweets in the streaming API are encoded with the same codec (JSON data is fully unicode aware), but not all characters can be displayed by all fonts
p22310
as(dp22311
g16
V100297
p22312
stp22313
a((dp22314
g2
(lp22315
VThe  is a combining diaeresis; you'll need to normalize your unicode string before decoding to mac-roman:
p22316
aVDemo, encoding a  character in denormalized form ( plus combining diaeresis) to mac-roman after normalization to composed characters:
p22317
aVI've used this technique in the past to produce CSV for Excel for specific clients where their platform encoding was known upfront (Excel will interpret the file in the current Windows encoding, IIRC)
p22318
aVIn that case I encoded to
p22319
as(dp22320
g16
V100297
p22321
stp22322
a((dp22323
g2
(lp22324
VI would not raise an exception from a function named , but rather return  or  instead
p22325
aVThe normal operation of  is not affected by wether or not there is a correct suffix on the value, it's job is to check for that suffix
p22326
aVThe function that uses  could still raise an exception;  may be a better exception to use in that case
p22327
as(dp22328
g16
V100297
p22329
stp22330
a((dp22331
g2
(lp22332
VYou should use the  module to read the tab-separated value file
p22333
aVDo not read it into memory in one go
p22334
aVEach row you read has all the information you need to write rows to the output CSV file, after all
p22335
aVKeep the output file open throughout
p22336
aVor, using the  module to do the repeating with :
p22337
as(dp22338
g16
V100297
p22339
stp22340
a((dp22341
g2
(lp22342
VJust define them on class C
p22343
aVThe functions are looked up on , not on the class the calling method is defined in
p22344
as(dp22345
g16
V100297
p22346
stp22347
a((dp22348
g2
(lp22349
VThe  API does not give you any options to write out a  attribute in the XML declaration
p22350
aVYou may want to use the  library instead; it uses the same ElementTree API, but offers more control over the output
p22351
aVsupports a  flag:
p22352
aVor use , which support the same options:
p22353
as(dp22354
g16
V100297
p22355
stp22356
a((dp22357
g2
(lp22358
VYes, your code will work as a one-liner if you combine the 'inner' expression with the outer:
p22359
aVThe  of the outer expression is evaluated first; see the compiled bytecode of the above 'beauty':
p22360
aVSo, if  is not found in , it'll jump to instruction 48 and load  and not look at  at all
p22361
aVNot sure how readable the line is, I find your explicit version much easier to understand
p22362
as(dp22363
g16
V100297
p22364
stp22365
a((dp22366
g2
(lp22367
VUse  to localize the instance
p22368
aVFrom the documentation:
p22369
aVThe first is to use the localize() method provided by the pytz library
p22370
aVThis is used to localize a naive datetime (datetime with no timezone information):
p22371
aVIf you don't use , but use  instead, chances are that a historical offset is used instead;  will pick the right offset in effect for the given date
p22372
aVThe US Eastern timezone DST start and end dates have changed over time, for example
p22373
aVWhen you try to localize a datetime value that is ambiguous because it straddles the transition period from summer to winter time or vice-versa, the timezone will be consulted to see if the resulting datetime object should have  return True or False
p22374
aVYou can override the default for the timezone with the  keyword argument for :
p22375
aVor even switch off the choice altogether by setting
p22376
aVIn that case, or in the rare cases there is no default set for a timezone, an ambiguous datetime value would lead to a  exception being raised
p22377
aVThe  flag is only consulted for datetime values that are ambiguous and is ignored otherwise
p22378
aVTo go back the other way, turn a timezone-aware object back to a naive object, use :
p22379
as(dp22380
g16
V100297
p22381
stp22382
a((dp22383
g2
(lp22384
VA post-mortem is invoked when an exception has been thrown
p22385
aVAt that point, the stack is no longer 'active' and you cannot step through the code anymore
p22386
aVAfter all, an exception has just been thrown, signalling that the code path can no longer continue
p22387
aVWhat would you expect  to be if you had the expression  for example
p22388
aVA literal Post-Mortem is used to see, after the patient has died (post mortem, in latin), what the cause of death was
p22389
aVA pdb post-mortem is no different
p22390
aVYou get to see what the state of the program was at the moment of death, but you do not get to re-animate the deceased
p22391
aVIn other words, the purpose of a Post Mortem is to understand why the program has failed, by examining, in detail, what the program state was at the moment of failure
p22392
aVThe term has not been explicitly documented in the pdb manual probably because the term "Post Mortem" is thought to be in common use
p22393
aVThe WikiPedia article on debugging mentions it in passing, and Python is not the only language that offers the technique; Windows debuggers offer the feature as well, R does so too, as do others
p22394
as(dp22395
g16
V100297
p22396
stp22397
a((dp22398
g2
(lp22399
VYou should disable versioning when running a transmogrifier pipeline
p22400
aVThis is documented in the  documentation; the  blueprint offers an easy drop-in recipe for toggling this:
p22401
as(dp22402
g16
V100297
p22403
stp22404
a((dp22405
g2
(lp22406
VTake the parent element of those divs, then get the three strings and join them into one string:
p22407
aVwhich would result in
p22408
aVIf you need to manipulate the date, you'll need to parse it out to a  object; I strongly suggest you use the  external library to do that
p22409
aVHowever, since the year is missing from this date, your mileage may vary
p22410
as(dp22411
g16
V100297
p22412
stp22413
a((dp22414
g2
(lp22415
VThe  function expects you to pass a , not individual sprites
p22416
aVJust test with your whole group in one go:
p22417
aVNow you also avoid removing and adding items to a list while looping over it
p22418
aVIf you want to remove the sprites  collides with from the group, do so after calling :
p22419
aVInstead of manually removing each item though, you could just set the  flag to True, and they will be removed from the group for you:
p22420
aVIf you do not need to know what items collided and do not want to remove items from the group, use  instead; it returns just True or False and is faster:
p22421
as(dp22422
g16
V100297
p22423
stp22424
a((dp22425
g2
(lp22426
VYou are missing a dependency, SDL
p22427
aVIf you have macports install, use that to install
p22428
aVOr better still, download the Pygame binary for Mac; it includes the SDL library in the installer
p22429
as(dp22430
g16
V100297
p22431
stp22432
a((dp22433
g2
(lp22434
VIf all you are looking for is one framework that can do this easily, then use
p22435
aVPyramid view definitions are made with predicates, not just routes, and a view only matches if all predicates match
p22436
aVOne such predicate is the  predicate, which does exactly what you want; make view switching depending on the  header easy and simple:
p22437
as(dp22438
g16
V100297
p22439
stp22440
a((dp22441
g2
(lp22442
VYou can't, not with
p22443
aVIt does not support , that's a setuptools-only feature
p22444
aVUse  instead; it supports Python 3
p22445
as(dp22446
g16
V100297
p22447
stp22448
a((dp22449
g2
(lp22450
VPython will encode unicode values to bytes when printing to the console
p22451
aVEncode explicitly when sending to a browser, by writing directly to :
p22452
aVNote that HTTP headers should use a  (carriage return, newline) combo, really
p22453
aVI've also added the encoding used to the  header so the browser knows how to decode it again
p22454
aVFor HTML, you really want to use character entity references instead of Unicode code points:
p22455
aVat which point you could also just use ASCII as your encoding
p22456
aVIf you really, really, really want to use , then re-open  with the correct encoding:
p22457
aVYou could simplify that somewhat with :
p22458
aVthen use  without the extra keywords:
p22459
aVAlso see the Python Unicode HOWTO for details on how Python sets output encoding, as well as this question here on Stack Overflow about printing and encoding
p22460
as(dp22461
g16
V100297
p22462
stp22463
a((dp22464
g2
(lp22465
VWhen timing a statement, you want to time just that statement, not the setup
p22466
aVThe setup could be considerably slower than the statement-under-test
p22467
aVNote that  runs your statement thousands of times to get a reasonable average
p22468
aVIt does this to eliminate the effects of OS scheduling and other processes (including but not limited to disk buffer flushing, cronjob execution, memory swapping, etc); only an average time would have any meaning when comparing different code alternatives
p22469
aVFor your case, just test  directly, and just use the  function:
p22470
aVThe setup code retrieves the  function, as well as  taken from  from the main script; the function and number won't otherwise be seen
p22471
aVThere is absolutely no point in performance testing the  statement, that's not what you are trying to time
p22472
aVUsing  is not about seeing the result of the call, just the time it takes to run it
p22473
aVSince the code-under-test is run thousands of times, all you'd get is thousands of prints of (presumably) the same result
p22474
aVNote that usually  is used to compare performance characteristics of short python snippets; to find performance bottlenecks in more complex code, use profiling instead
p22475
aVIf you want to time just one run, use the  function to get the most accurate timer for your platform:
p22476
as(dp22477
g16
V100297
p22478
stp22479
a((dp22480
g2
(lp22481
VYou only loop twice; the  is only evaluated to create the , not on every iteration of the loop
p22482
aVThus, you only end up with a list of length 4
p22483
aVUse a  statement instead:
p22484
aVor  with the correct number of s:
p22485
aVor use  (which is short-hand for ):
p22486
aVBoth of these approaches avoid loops altogether
p22487
as(dp22488
g16
V100297
p22489
stp22490
a((dp22491
g2
(lp22492
VDon't back up; record comments regardless, until you hit another line
p22493
aVIf it's not a  line, discard the comments gathered:
p22494
as(dp22495
g16
V100297
p22496
stp22497
a((dp22498
g2
(lp22499
VYou didn't copy the code correctly; linked page has this line:
p22500
aVNote that it's just , not ; at the top of the script all names from the  module are imported into the current namespace, making the  a local name
p22501
aVMake sure you do have the statement  at the top of your script, from the error message it appears that you did not import it correctly (the  indicates that there is nothing named  imported in your script)
p22502
as(dp22503
g16
V100297
p22504
stp22505
a((dp22506
g2
(lp22507
VTry adding headers to your request based on what your browser sends; start with adding an  header (406 normally means the server didn't like what you want to accept)
p22508
aVSee "Adding headers" in the documentation:
p22509
aVThe  header value there is based on the header sent by Chrome
p22510
as(dp22511
g16
V100297
p22512
stp22513
a((dp22514
g2
(lp22515
VIf order doesn't matter, use intersections:
p22516
aVMost of your time is probably going to be spent in  in any case, so don't micro-optimize
p22517
aVInstead optimize for readability (within reason)
p22518
aVAs for the choice of  test vs
p22519
aVexception handling: exception handling will be faster if the number of misses is low (relatively few exceptions), but if you have a lot of misses the  test will be faster than handling loads of exceptions
p22520
aVIf you really care, use the   module to find a balance
p22521
aVSee my answer on the subject on Programmers
p22522
aVSE
p22523
as(dp22524
g16
V100297
p22525
stp22526
a((dp22527
g2
(lp22528
VYour  model has no  reference
p22529
aVAdd a column to  referencing the  a post belongs to:
p22530
aVWe can't use the name  because that's what the  relationship will add to retrieved  instances
p22531
aVThis is a One to Many relationship as documented in the SQLAlchemy Relationship Configuration documentation
p22532
as(dp22533
g16
V100297
p22534
stp22535
a((dp22536
g2
(lp22537
VUse the  API (or the faster API equivalent ), then use the  function to serialize the tree back to just the text content:
p22538
as(dp22539
g16
V100297
p22540
stp22541
a((dp22542
g2
(lp22543
VThere is no need to use the external  library
p22544
aVThe  module included in the Python 3 standard library is the exact same module, but maintained as part of the Python distribution
p22545
aVQuoting from the  PyPI page:
p22546
aVis the externally maintained development version of the  library included with Python 2
p22547
aV6 and Python 3
p22548
aV0, but maintains backwards compatibility with Python 2
p22549
ag2176
aVUse the following code to switch to  if  isn't present (only for Python 2
p22550
aV5, the library is included in 2
p22551
aV6 and up):
p22552
as(dp22553
g16
V100297
p22554
stp22555
a((dp22556
g2
(lp22557
VDead simple, just nest your functions:
p22558
aVNested functions automatically look up unknown variables ( in this case) from their surrounding scope, using the value of  as it was when the outer function was called
p22559
aVThe thing to remember here is that functions are just objects too, you can store them in a variable just like you can with other python objects, and defer calling them
p22560
aVThis gives:
p22561
aVNote how  was given a different value for , which is independent from the value for  in
p22562
aVYou could use a lambda as well; lambdas are just anonymous functions limited to one expression; that's enough here:
p22563
aVAnother alternative technique is binding  to a keyword parameter, which means you could override it if you so wish:
p22564
aVor the lambda version:
p22565
aVand then pass in one or two arguments to the returned callable:
p22566
as(dp22567
g16
V100297
p22568
stp22569
a((dp22570
g2
(lp22571
VThat depends on how module  takes it's arguments
p22572
aVIf it only looks at  and has no  test, then you could alter :
p22573
aVthen import module
p22574
aVHowever, if you are writing  yourself, use a function, called from a  test instead:
p22575
aVthen you can import  and call  directly:
p22576
aVNote that if module  is not your own, and it does have a  test, but does all the work in that  suite, then you are sunk and have to reproduce that code
p22577
as(dp22578
g16
V100297
p22579
stp22580
a((dp22581
g2
(lp22582
VWhat you want to do is influence the name chooser, and you can do that with a custom behavior for your interface
p22583
aVSubclassing the  interface is the easiest:
p22584
aVThe default name chooser tries to adapt the new-to-be-added object to the  interface, then if that succeeds, will use the  attribute to build a new name for the object
p22585
aVBy implementing a subclass of that interface as an adapter for your  objects, you get to substitute the title for your  field instead, thus making sure that that is used for new names instead
p22586
aVRegister this as:
p22587
aVand add this behavior to your  type definition instead of the  behavior
p22588
as(dp22589
g16
V100297
p22590
stp22591
a((dp22592
g2
(lp22593
VYou can start a new console shell by executing the command  in iPython
p22594
aVWhen you exit that console you're returned to the iPython prompt
p22595
aVThis is analogous to the UNIX trick of using  or  to create a child shell
p22596
as(dp22597
g16
V100297
p22598
stp22599
a((dp22600
g2
(lp22601
V supports reading URL data in chunks, and the  library lets you calculate a MD5 in chunks, so you have everything you need right there already
p22602
aVYou can choose between  or :
p22603
aVIf you have to view it as a filter, use a generator:
p22604
aVthen use that on your  or  iterator:
p22605
aVFor  you'd need to implement a  interface instead of , but the principles are the same:
p22606
aVThe  class takes your  or  iterator, and return data from that on each call to , as well as calculate the MD5 on the fly
p22607
aVThis can be used directly for your  example
p22608
as(dp22609
g16
V100297
p22610
stp22611
a((dp22612
g2
(lp22613
VUse an absolute path based on the  path of the module:
p22614
aVis the filename of the current module, using the  of that gives you the directory the module is in
p22615
aVI used  to make sure you have an absolute path for your module file at all times, heading off some edgecases you could hit otherwise
p22616
aVis a global in your module
p22617
as(dp22618
g16
V100297
p22619
stp22620
a((dp22621
g2
(lp22622
VUse the  class factory to create a custom class for your return value:
p22623
aVThe returned value can be used both as a tuple and by attribute access:
p22624
as(dp22625
g16
V100297
p22626
stp22627
a((dp22628
g2
(lp22629
VYou already have the user object, ( returns it, so just retrieve information from
p22630
aVSee the  documentation to see what you can get from it:
p22631
as(dp22632
g16
V100297
p22633
stp22634
a((dp22635
g2
(lp22636
VThere will be an exception;  will be raised:
p22637
aVAny insertions before the exception is raised will have succeeded, so you want to call  when the exception occurs
p22638
aVBetter still, use the connection as a context manager to automatically roll back or commit:
p22639
as(dp22640
g16
V100297
p22641
stp22642
a((dp22643
g2
(lp22644
VDo not use  to test for equality; use  instead
p22645
aVtests for object identity, which is a whole different kettle of fish
p22646
aVUse the  function to construct paths
p22647
aVAnd use  raw strings for paths containing  backslashes, double the  backslashes to  or use forward slashes instead (),  in a python string means "insert a literal  character in the string here", which doesn't work when what you really wanted was to close the string instead
p22648
aVonly opens the file, to get the data out you also need to call  on the open file
p22649
aVSince  is already a built-in name, it's best not to use that as a variable, so I've renamed it in the above code
p22650
aVLast, but not least, by using a  construct the fileobject will be closed automatically when we have read the data and return it from the function
p22651
as(dp22652
g16
V100297
p22653
stp22654
a((dp22655
g2
(lp22656
VIt's the  in your format, from the documentation:
p22657
aVDay of the year as a decimal number [001,366]
p22658
aVand the 12th day in the year is the 12th of january
p22659
aVUse  instead:
p22660
as(dp22661
g16
V100297
p22662
stp22663
a((dp22664
g2
(lp22665
VUse  to remove whitespace from the start and end of a python string
p22666
as(dp22667
g16
V100297
p22668
stp22669
a((dp22670
g2
(lp22671
VIt means that whatever binary named by the variable  was not found
p22672
aVThe  error will be thrown for any non-existent binary:
p22673
as(dp22674
g16
V100297
p22675
stp22676
a((dp22677
g2
(lp22678
VAssignment always has the lowest precedence; it is not part of the expression
p22679
aVIn fact, assignment is a statement; you can never use assignment in an expression
p22680
as(dp22681
g16
V100297
p22682
stp22683
a((dp22684
g2
(lp22685
VYou can't just copy the Windows version over to a Linux server;  uses C extensions which need to be compiled for the target platform
p22686
aVThe  module is such a compiled extension, on Linux that'd be , while on Windows it would be a  file instead, for example
p22687
aVFor Ubuntu, look for , or install the dependencies ,  and , plus , then use  to install  on your server
p22688
as(dp22689
g16
V100297
p22690
stp22691
a((dp22692
g2
(lp22693
VYou need to create aliased tables:
p22694
as(dp22695
g16
V100297
p22696
stp22697
a((dp22698
g2
(lp22699
VThe  anchor in your expression is preventing you from finding anything but the last entry
p22700
aVRemove that, then use the list returned by :
p22701
as(dp22702
g16
V100297
p22703
stp22704
a((dp22705
g2
(lp22706
VI'd use a property for that, one that tests if the  column is not NULL
p22707
aVA  seems appropriate here:
p22708
aVNow  will be either  or
p22709
aVAlternatively, use a hybrid property:
p22710
aVA hybrid property has the advantage of being usable in a query as well
p22711
aVLast but not least, for this case, perhaps an ordinary property would do too, it'll only work on already loaded instances though:
p22712
aVI'd use a different name, though
p22713
aVmight be better; the Python style guide (PEP 8) advocates the  for methods and instance attributes
p22714
as(dp22715
g16
V100297
p22716
stp22717
a((dp22718
g2
(lp22719
VThe line  is not Python code itself, so IDLE will tell you it's a syntax error
p22720
aVRun it on the  console instead
p22721
aVMake sure you are in the correct directory first, or use the full path:
p22722
aVor
p22723
as(dp22724
g16
V100297
p22725
stp22726
a((dp22727
g2
(lp22728
VAdd a  keyword argument to your function, then check that against a list of nicks allowed to execute administrator commands:
p22729
as(dp22730
g16
V100297
p22731
stp22732
a((dp22733
g2
(lp22734
VInstead of removing the file, just open it for writing:
p22735
aVOpening a file with  truncates the file first, so data written to it replaces the old contents
p22736
aVNote that you are writing the file for each iteration in the loop
p22737
aVBy using the file as a context manager () it's closed automatically
p22738
aVIf you want to write all entries to the file, open the file outside of the loop:
p22739
aVIf you need to re-write the file only if there are no inactive items in , use:
p22740
aVNow you first remove the inactive items, then if there are still contracts left, write those out to the file
p22741
aVIf there are none left, the  file is left untouched
p22742
as(dp22743
g16
V100297
p22744
stp22745
a((dp22746
g2
(lp22747
VThere are no  elements with text on that page, so  is an empty list
p22748
aVRemove the  filter:
p22749
aVand extract all text from it:
p22750
aVor, integrated into your existing code:
p22751
as(dp22752
g16
V100297
p22753
stp22754
a((dp22755
g2
(lp22756
VThis is not supported by , unfortunately
p22757
aVThe underlying  library does support handling of 3-value tuples (with filename, data and mime-type), but  doesn't support any handling of the  parameter that allows for you to pass in the mime-type
p22758
aVThe way files for POST requests are being handled is currently being reworked, but there is a patch that you could perhaps use for now
p22759
as(dp22760
g16
V100297
p22761
stp22762
a((dp22763
g2
(lp22764
VBy printing multiple values separated by a comma:
p22765
aVThe print statement will output each expression separated by spaces, followed by a newline
p22766
aVIf you need more complex formatting, use the  method:
p22767
aVor by using the older and semi-deprecated  string formatting operator
p22768
as(dp22769
g16
V100297
p22770
stp22771
a((dp22772
g2
(lp22773
VUse a , then add or subtract  instances
p22774
aVarithmetic is not supported for  objects; if you need to use offsets from an existing  object, just use  to form a  instance, do your calculations, and 'extract' the time again with the  method:
p22775
as(dp22776
g16
V100297
p22777
stp22778
a((dp22779
g2
(lp22780
V must be a class method
p22781
aVFrom the documentation:
p22782
aVA class method called before tests in an individual class run
p22783
aVis called with the class as the only argument and must be decorated as a :
p22784
aV@classmethod
p22785
aVdef setUpClass(cls):
p22786
aVSee Class and Module Fixtures for more details
p22787
aVYour version is missing the  decorator:
p22788
aVThe error is thrown because  is called on the class, not on an instance, but you didn't mark your method as a classmethod and thus it was not passed in the automatic  argument
p22789
as(dp22790
g16
V100297
p22791
stp22792
a((dp22793
g2
(lp22794
VJust use a HTML parser anyway
p22795
aVPython comes with a few included, and the  API is easier to get working than a regular expression for even simple  tags with arbitrary attributes:
p22796
aVIf you use  you can get the text out of anything nested under the  tag, if you find that some of the links have nested , ,  or other inline tags to mark up the link text further:
p22797
aVThis gives:
p22798
as(dp22799
g16
V100297
p22800
stp22801
a((dp22802
g2
(lp22803
VYou are looping over the result rows, not a series of numbers
p22804
aVUse  to add items to  and  instead:
p22805
aVThe  loop takes each item of  and assigns it to the variable , so  is a result row tuple, not an integer
p22806
aVIt might be easier to understand if you renamed the variable:
p22807
aVIf your result rows contain only 2 columns per row, you can also use a  trick to split out the columns into separate lists:
p22808
aVmeans: apply each element from  as a separate argument to the  built-in function, so  is called with
p22809
aVtakes each element from those individual rows, and combines those into new output lists
p22810
aVTwo columns per row means  produces two output lists
p22811
as(dp22812
g16
V100297
p22813
stp22814
a((dp22815
g2
(lp22816
VI suspect that PyKDE is not yet Python 3 ready, at least as far as that error message is concerned; try passing in a bytestring instead:
p22817
as(dp22818
g16
V100297
p22819
stp22820
a((dp22821
g2
(lp22822
V doesn't know anything about dates; it just reads text
p22823
aVYou are comparing strings with other strings, and  and  are different strings altogether
p22824
aVYou'd need to parse the dates into something that can be compared, when reading
p22825
aVUse the  function for that:
p22826
aVThe  format above would turn both  and  into a , and two copies of that  instance would compare as equal
p22827
as(dp22828
g16
V100297
p22829
stp22830
a((dp22831
g2
(lp22832
VAll logging output is handled by the handlers; just add a  to the root logger
p22833
aVHere's an example configuring a stream handler (using  instead of the default ) and adding it to the root logger:
p22834
as(dp22835
g16
V100297
p22836
stp22837
a((dp22838
g2
(lp22839
VYou import , but don't use that full name
p22840
aVInstead, you refer only to
p22841
aVIf you get an import error, the  package is not being found; there may be one of two things wrong:
p22842
aVYou should use  instead, which would also solve the incorrect reference
p22843
aVThe  directory is missing it's  file (can be empty)
p22844
aVThat file would make it a package and would allow you to import it
p22845
aVThen change the references to  to :
p22846
aVor change the import to read:
p22847
aVYou also try to run  before it is defined
p22848
aVChange the last lines to:
p22849
aVLast but not least, you need to add the  directory (full, absolute path) to the ; if you are using  look at the  directive
p22850
as(dp22851
g16
V100297
p22852
stp22853
a((dp22854
g2
(lp22855
VUse a list comprehension:
p22856
as(dp22857
g16
V100297
p22858
stp22859
a((dp22860
g2
(lp22861
VYou can only call a function after it is defined
p22862
aVMove the  line after defining :
p22863
as(dp22864
g16
V100297
p22865
stp22866
a((dp22867
g2
(lp22868
VPut a capturing group around the character(s) you want to preserve in the split:
p22869
aVThe periods will be added as new elements in the resulting list
p22870
aVFrom the documentation:
p22871
aVIf capturing parentheses are used in pattern, then the text of all groups in the pattern are also returned as part of the resulting list
p22872
aVIf you don't want this, you'll have to split on the space itself, by ensuring that the space is preceded by a matching period of other punctuation marks (using a look-behind assertion)
p22873
as(dp22874
g16
V100297
p22875
stp22876
a((dp22877
g2
(lp22878
VYou need to encode the URL from unicode to a bytestring
p22879
aVand  produce two different kinds of objects; a unicode string and a bytestring
p22880
aVYou can encode a unicode string to bytecode with the  method, but you need to know what encoding to use
p22881
aVUsually, for URLs, UTF-8 is great, but you do need to escape the bytes to fit the URL scheme as well:
p22882
aVThe above example is based on an educated guess that the problem you are facing is due to non-ASCII characters in the path part of the URL, but without further details from you it has to remain a guess
p22883
aVFor domain names, you need to apply the IDNA RFC3490 encoding:
p22884
aVSee the Python Unicode HOWTO for more information
p22885
aVI also strongly recommend you read the Joel on Software Unicode article as a good primer on the subject of encodings
p22886
as(dp22887
g16
V100297
p22888
stp22889
a((dp22890
g2
(lp22891
VYou are lowercasing the file object, not the line
p22892
aVwould work better
p22893
as(dp22894
g16
V100297
p22895
stp22896
a((dp22897
g2
(lp22898
VThe  function cannot handle  timezone parsing very well
p22899
aVOnly UTC and GMT are really supported, and the current value of
p22900
aVSee the  documenation:
p22901
aVSupport for the  directive is based on the values contained in  and whether  is true
p22902
aVBecause of this, it is platform-specific except for recognizing UTC and GMT which are always known (and are considered to be non-daylight savings timezones)
p22903
aVRemoving the  part of your input and the  part of your format string makes things work:
p22904
aVor replacing the timezone  with :
p22905
aVTo parse strings with a timezone other than ,  or , use a different date parsing library
p22906
aVThe  library has an excellent  function that handles timezones properly:
p22907
aVWhen using  you do have to provide your own timezone offsets for your format though
p22908
as(dp22909
g16
V100297
p22910
stp22911
a((dp22912
g2
(lp22913
VPyQuery wraps , so you use the ElementTree API to access attributes:
p22914
aVAlternatively, to use the PyQuery API on any found element, wrap the element in a  call, echoing the way you need to use jQuery  or  to wrap DOM elements:
p22915
aVor
p22916
aVfor a more pythonic way to accessess the attributes
p22917
aVYou could also loop over the  method instead, which returns PyQuery elements instead:
p22918
as(dp22919
g16
V100297
p22920
stp22921
a((dp22922
g2
(lp22923
VMark the  column as a foreign key:
p22924
aVThen simply refer to :
p22925
aVIf you are unwilling or unable to add a  constraint to , you can also add that information to the  declaration:
p22926
as(dp22927
g16
V100297
p22928
stp22929
a((dp22930
g2
(lp22931
VYou want to truncate your tuples, use a list comprehension:
p22932
aVor, as a simple demonstration:
p22933
as(dp22934
g16
V100297
p22935
stp22936
a((dp22937
g2
(lp22938
VYup, the condition  is always going to be True
p22939
aVThus, if  is not empty, the whole expression  is also going to be True:
p22940
aVDid you mean:
p22941
aVinstead
p22942
as(dp22943
g16
V100297
p22944
stp22945
a((dp22946
g2
(lp22947
VEither do not use a list comprehension, or return a new dict based on the original dict plus the new key:
p22948
as(dp22949
g16
V100297
p22950
stp22951
a((dp22952
g2
(lp22953
VNested functions only take scoped variables from the scope where they are defined, and the binding takes place at compile time
p22954
aVYou cannot add scoped variables later on, and certainly not with a simple wrapper
p22955
as(dp22956
g16
V100297
p22957
stp22958
a((dp22959
g2
(lp22960
VNo, you cannot apply slicing to strings inside a the replacement field
p22961
aVYou'll need to refer to the Format Specification Mini-Language; it defines what is possible
p22962
aVThis mini language defines how you format the referenced value (the part after the  in the replacement field syntax)
p22963
as(dp22964
g16
V100297
p22965
stp22966
a((dp22967
g2
(lp22968
VThe easiest method would be to re-attach the captured punctiation back onto the preceding element in the list:
p22969
aVRunning that method on your example input gives me:
p22970
as(dp22971
g16
V100297
p22972
stp22973
a((dp22974
g2
(lp22975
VUse  and a generator expression:
p22976
aVWhat this does: it loops over each item in , and if that item is equal to , it generates a , which  adds up to get the total count
p22977
aVUsing a generator expression like this means that there is only ever one item of  being referenced at a time, allowing you to scan huge sequences efficiently
p22978
as(dp22979
g16
V100297
p22980
stp22981
a((dp22982
g2
(lp22983
V is not a built-in python type
p22984
aVYou wanted  perhaps:
p22985
aVbut that's redundant, as  is already of type
p22986
aVThe same goes for the lines  and , but you will need to cast  to a string when concatenating:
p22987
aValthough it would be better if you used string formatting instead:
p22988
as(dp22989
g16
V100297
p22990
stp22991
a((dp22992
g2
(lp22993
VThe  function has no direct access to the locals of the code you called  from
p22994
aVIt has it's own scope
p22995
aVIn this case, you are looking at the local namespace of one of the methods on the  instance that is handling your  call
p22996
aVYou'd have to use  to access the calling stack, then look at the  mapping of individual frames to reach locals of calling functions
p22997
aVGuessing from the  source I'd say you need to skip 3 frames, the current dispatch method, the  method calling the current dispatch method, and the module level  function, so  aught to get you the reference you want
p22998
as(dp22999
g16
V100297
p23000
stp23001
a((dp23002
g2
(lp23003
VYou really want to avoid using , split it out into a list instead and you'll save yourself having to use interpolation to boot
p23004
aVTo test for equality, use ;  is for assignment only which is not allowed in a  statement
p23005
aVYou need to use  if you wanted to check for  output:
p23006
as(dp23007
g16
V100297
p23008
stp23009
a((dp23010
g2
(lp23011
V is a list (you used , which returns a list); use:
p23012
aVor use  to pick one element:
p23013
as(dp23014
g16
V100297
p23015
stp23016
a((dp23017
g2
(lp23018
VThe result of  is a list
p23019
aVJust print :
p23020
as(dp23021
g16
V100297
p23022
stp23023
a((dp23024
g2
(lp23025
V is a string, not an int
p23026
aVFrom the documentation:
p23027
aVThe  options to commands below is a string specifying one or more messages to be acted upon
p23028
aVIt may be a simple message number (), a range of message numbers (), or a group of non-contiguous ranges separated by commas ()
p23029
aVA range can contain an asterisk to indicate an infinite upper bound ()
p23030
aVConverting it to string directly should be enough:
p23031
as(dp23032
g16
V100297
p23033
stp23034
a((dp23035
g2
(lp23036
VThis is not a problem with how you open and write files in Python
p23037
aVIt's a problem with Python trying to read your python source files
p23038
aVYou need to specify an encoding for your source file so that Python can read the  file correctly
p23039
aVYou need to figure out what encoding your editor used when writing this file
p23040
aVAdd that as a comment to the top of the file (first or second line):
p23041
aVSee the Unicode Literals in Python Source Code section of the Python Unicode HOWTO
p23042
aVNote that the error message you gave is not complete, the following text is part of that:
p23043
aVThe linked PEP 263 explains source code encoding in more detail
p23044
as(dp23045
g16
V100297
p23046
stp23047
a((dp23048
g2
(lp23049
VYou can use the  operator to determine object identity:
p23050
aVTo quote the documentation:
p23051
aVThe operators  and  test for object identity:  is true if and only if  and  are the same object
p23052
aVyields the inverse truth value
p23053
aVAnother way to detect if two variables refer to the same object (such as a list) is to check te return value of the  function:
p23054
as(dp23055
g16
V100297
p23056
stp23057
a((dp23058
g2
(lp23059
VBecause you are not assigning to , you are changing the dictionary itself instead
p23060
aVis still pointing to the dictionary, thus is itself unchanged
p23061
aVThe line  translates to
p23062
aVIn other words, the value of  is a python , and that value is itself mutable
p23063
aVIf you tried to change what  refers to by using  instead, you would be changing what  points to and then you need the  keyword
p23064
aVPerhaps this older answer of mine to a similar question helps you understand the difference: Python list doesn't reflect variable change, new to python
p23065
as(dp23066
g16
V100297
p23067
stp23068
a((dp23069
g2
(lp23070
VBecause the default is UTF-8, you only need to use that declaration when you deviate from the default
p23071
aVIn other words, only when you want to use an encoding that differs do you have to use that declaration
p23072
aVNote that it only applies to how Python reads the source code
p23073
aVIt doesn't apply to printing, opening files, or any other I/O operations
p23074
aVFor more details on Python, Unicode, and encodings, I strongly urge you to read the Python Unicode HOWTO
p23075
as(dp23076
g16
V100297
p23077
stp23078
a((dp23079
g2
(lp23080
VYou are much better off using  instead of going directly to the  structure
p23081
aVNot because it's faster or slower, but because the official API works in all circumstances, including for classes that do not have a  (when using  for example), or when an object implements the  or  hooks, or when the attribute in question is a descriptor (such as a ), or a class attribute
p23082
aVIf you want to know if any one python statement or technique is faster than another, use the  module to measure the difference:
p23083
aVYou can see that directly accessing  is faster, but  does a lot more work
p23084
as(dp23085
g16
V100297
p23086
stp23087
a((dp23088
g2
(lp23089
V is a shell feature
p23090
aVRun the commands separately:
p23091
as(dp23092
g16
V100297
p23093
stp23094
a((dp23095
g2
(lp23096
VDo you have a file called repr
p23097
aVpy in the current directory
p23098
aVThat file is incomplete, and shadows the standard library  module
p23099
aVYou can see from the traceback that the file has no full path, only a local path
p23100
aVRename it or remove it
p23101
aVPlease, do not just delete
p23102
aVpyc files from your system folders, please reinstall python from packages (using your package manager)
p23103
as(dp23104
g16
V100297
p23105
stp23106
a((dp23107
g2
(lp23108
VWho says that the information in the  object is solely based on the  header
p23109
aVThat header is only meant to be sent to servers when retrieving a URL
p23110
aVYes, some values on the  object are taken from the current header, but, as you have found out, not all are, nor are they meant to
p23111
aVIn fact, only the  and  strings are taken from that header, everything else reflects the native browser instead
p23112
aVThe Qt browser is based on WebKit, which is a Apple project, hence the vendor string
p23113
aVYou can see that when you run your  reflection code in Safari:
p23114
aVSafari let's me switch the  header too, from the  menu
p23115
aVSwitching it only changes the  and  strings too
p23116
aVSwitching to , for example, changes just those two variables to:
p23117
aVAnother browser based on WebKit is Chrome, and it's  information is quite similar:
p23118
as(dp23119
g16
V100297
p23120
stp23121
a((dp23122
g2
(lp23123
VYou'll have to use a list comprehension to apply slicing to contained elements:
p23124
aVThis gives:
p23125
aVreturns a list itself, and  just takes the last two elements from that list, and does not apply that slice to the contained elements of the list
p23126
as(dp23127
g16
V100297
p23128
stp23129
a((dp23130
g2
(lp23131
VThe traceback is the one way to determine if an import is cyclical
p23132
aVThe other possibility is that the name doesn't exist in the imported module
p23133
aVYou either misspelled the name, or you imported a different module from what you expected
p23134
aVDiagnose by running:
p23135
aVto check if you got the right module
p23136
aVUse  to check what names it defines
p23137
as(dp23138
g16
V100297
p23139
stp23140
a((dp23141
g2
(lp23142
VYou need to pass in the  class instead:
p23143
aVwill look through the base classes of the first argument to find the next  method, and  doesn't have a parent with that method
p23144
aVWith that change, the output is:
p23145
aVNote that you make the same mistake in your ; you are not calling the inherited  at all
p23146
aVThis works:
p23147
aVand then the output becomes:
p23148
as(dp23149
g16
V100297
p23150
stp23151
a((dp23152
g2
(lp23153
VI'd use a dictionary to map labels to indices:
p23154
aVUsing a smaller  set to facilitate multiple passes in a more managable time gives:
p23155
aVbut as you can see, for your small input sets, your method is faster
p23156
aVIt appears that setting up the mapping takes more time than up to 4  look-ups
p23157
aVIf your label sequences consist of (much) more elements, my method would win:
p23158
aVThe most important lesson here is to use the  module to compare different methods
p23159
aVThe  module uses the best timer for your platform, and compares many runs of the code-under-test to eliminate outside scheduling influences (disk I/O, other processes, etc)
p23160
aVEven when timing just one run, using  is preferable over using ; it may be the same timer still, but then it'll be the most accurate clock for your platform
p23161
as(dp23162
g16
V100297
p23163
stp23164
a((dp23165
g2
(lp23166
V expects a list, but you are passing in a  instead
p23167
aVI think you wanted to write the values of  only:
p23168
aVPersonally, I'd read the file with just the  rows, add those to a dict, then read the other file and write each row one at a time by adding the corresponding  entry
p23169
as(dp23170
g16
V100297
p23171
stp23172
a((dp23173
g2
(lp23174
VIf you have to use recursion, use a better termination clause:
p23175
aVSo, when your string is reduced to 1 or 0 characters, you have a palindrome
p23176
aVThis gives:
p23177
aVYour original error was to test for a space, while  is being reduced to an empty string instead
p23178
aVTesting for  would also work, but since a single-character string also qualifies as a palindrome you may as well make that an explicit termination test
p23179
as(dp23180
g16
V100297
p23181
stp23182
a((dp23183
g2
(lp23184
VUsing the new Python 3
p23185
aV3 native virtual env implementation, I can use Pyramid on Python 3
p23186
aV3 just fine:
p23187
as(dp23188
g16
V100297
p23189
stp23190
a((dp23191
g2
(lp23192
VUse the  parameter to :
p23193
aVDemo:
p23194
aVThe  parameter takes a function, and for each entry in the iterable, it'll find the one for which the  function returns the highest value
p23195
as(dp23196
g16
V100297
p23197
stp23198
a((dp23199
g2
(lp23200
VFor short strings, to test for palindromes just compare it against the reverse:
p23201
aVYour version of  works fine, but your method itself calls  (no  at the end), so perhaps you have another definition of the function
p23202
aVYou don't actually pass the result of the function to ; you pass the function instead
p23203
aVUse a variable:
p23204
aVYou can simplify this down a little:
p23205
aVYou can exit early when you find the first non-matching character
p23206
aVYou don't need to test for  in if statements, just do:
p23207
as(dp23208
g16
V100297
p23209
stp23210
a((dp23211
g2
(lp23212
VYou need to use the full classname to set class variables
p23213
aVin  and  will refer to subclasses ( and , respectively), and setting attributes on those subclasses will store new variables, not alter the class variable
p23214
aVYou can only alter base class variables by directly accessing them
p23215
aVUsing your code, we get:
p23216
aVWhat happened is that in ,  was set to  or , depending on what instance you created, and each subclass got their own copies of the variables  and
p23217
aVUsing  (to ensure that  is initialized, and not the subclasses) gives:
p23218
aVSo now  used  as the target to set  and the initial value for , but  and  still used their own subclasses to set the new value of  and are not sharing that value through
p23219
aVThe only option you have to set class variables on a specific base class is to refer to it directly in all class methods:
p23220
aVwhich would give:
p23221
aVNote that I called  to make sure that  is  and not a subclass
p23222
aVThen, when setting  the  and  methods still refer directly to  to ensure that the variable is set directly on the base class
p23223
aVWhen reading the value of  the above example still uses , which uses the class MRO to find  on the base class when not set locally
p23224
as(dp23225
g16
V100297
p23226
stp23227
a((dp23228
g2
(lp23229
VUse  to get all text elements from a given location:
p23230
as(dp23231
g16
V100297
p23232
stp23233
a((dp23234
g2
(lp23235
VTo get the second table from the call , use it as a list, just index it:
p23236
as(dp23237
g16
V100297
p23238
stp23239
a((dp23240
g2
(lp23241
VThis is documented in the Python datamodel documentation: Special method lookup for new-style classes:
p23242
aVFor new-style classes, implicit invocations of special methods are only guaranteed to work correctly if defined on an object\u2019s type, not in the object\u2019s instance dictionary
p23243
aVand
p23244
aVThe rationale behind this behaviour lies with a number of special methods such as  and  that are implemented by all objects, including type objects
p23245
aVIf the implicit lookup of these methods used the conventional lookup process, they would fail when invoked on the type object itself[
p23246
aVSo, because both  and  must work, special methods are looked up on the type instead of on the instance
p23247
aVIf  was looked up straight on the object,  would be translated to , and that would fail, because  is an unbound method and it expects to be called on an actual instance of  (e
p23248
ag1298
aV); so for ,  should called instead:
p23249
aVThis is a backwards-incompatible change, so it only applies to new-style objects
p23250
as(dp23251
g16
V100297
p23252
stp23253
a((dp23254
g2
(lp23255
VYou are creating a tuple when using commas in a expression
p23256
aVUse a tuple to test:
p23257
aVYou could also have looked at  to learn this:
p23258
as(dp23259
g16
V100297
p23260
stp23261
a((dp23262
g2
(lp23263
VYou cannot use  as a keyword argument
p23264
aVUse  instead:
p23265
aVAlternatively, bs4 supports a  spelling too:
p23266
as(dp23267
g16
V100297
p23268
stp23269
a((dp23270
g2
(lp23271
VYour  value is not , it's
p23272
aVThe rest of your variables suffer from the same ailment, they have quotes as part of the string value
p23273
aVUse  as a diagnostic aid in this
p23274
aVYou could use:
p23275
aVbut you have a more fundamental problem, one where you end up with extra quotes in your string values
p23276
aVTo illustrate, a short Python interpreter session:
p23277
as(dp23278
g16
V100297
p23279
stp23280
a((dp23281
g2
(lp23282
VYou have a local file named
p23283
aVCheck your current directory and rename it or delete it
p23284
aVYou can see this in the traceback:
p23285
aVThe preceding module has a full filepath, but the  file does not, making it a local file that is shadowing the relative import in
p23286
as(dp23287
g16
V100297
p23288
stp23289
a((dp23290
g2
(lp23291
VYes, by using the  function:
p23292
as(dp23293
g16
V100297
p23294
stp23295
a((dp23296
g2
(lp23297
VThe  statement expects a context manager, which is simply an object with an  and  method
p23298
aVYour  class should have a  class method returning an alias; it's  can probably remain empty
p23299
aVYour  class could be a subclass of , or it could be a proxy (using  or similar to pass along attribute access to the original )
p23300
aVYou cannot detect what name the return value will be bound to, you'd have to have that passed into your context manager callable
p23301
aVI suggest you create a  context manager instead:
p23302
as(dp23303
g16
V100297
p23304
stp23305
a((dp23306
g2
(lp23307
VTo support the zero-argument form of , the compiler adds an implicit reference to the class if  or  are being used in a class method
p23308
aVSee Creating the class object
p23309
aVThe example code you found (ab)uses this little factoid to create new instances of  when adding
p23310
aVPersonally, I'd use  instead, as that is the proper API method of determining the type or class of any object
p23311
aVwill use  where appropriate:
p23312
aVThat is a good idea if you want to support subclassing
p23313
aVAny subclasses of  will return the correct subclassed type when being added together
p23314
aVUsing  does not do that, as it will always be pointing to , even for subclasses:
p23315
aVOf course, if that was your intention all along (to bypass subclasses), I'd still prefer using the explict class name over using ; explicit is better than implicit
p23316
as(dp23317
g16
V100297
p23318
stp23319
a((dp23320
g2
(lp23321
VAs of Flask 0
p23322
aV10, you can use  and set  to :
p23323
aVFrom the documentation:
p23324
aVBy default this function will only load the json data if the mimetype is  but this can be overridden by the force parameter
p23325
aVParameters:
p23326
aVforce \u2013 if set to True the mimetype is ignored
p23327
aVFor older versions, if you want to be forgiving and allow for JSON, always, you can do the decode yourself, explictly:
p23328
as(dp23329
g16
V100297
p23330
stp23331
a((dp23332
g2
(lp23333
V starts a block of code where exceptions can be handled
p23334
aVThe  clause means that if anything throws the  exception in the block, then that exception will be caught and handled by the code under
p23335
aVIn this case that means that if someone enters a value that is not a valid integer,  will be set to
p23336
aVBecause  is now set to , the while loop asks for a price again ( is ):
p23337
aVHere is a short demonstration of how the exception would disrupt the program otherwise:
p23338
aVSee the Python tutorial on exception handling for more information on how this works
p23339
as(dp23340
g16
V100297
p23341
stp23342
a((dp23343
g2
(lp23344
VThe  tab is only shown because there is a  folder (with the title ) in the root that is publicly visibile
p23345
aVYou have three options to deal with the default; make the  folder private, delete it  altogether, or remove the  default view
p23346
aVUnpublish
p23347
aVYou can 'unpublish', retract, the folder workflow to make it private, and anonymous users are then redirected to the login form instead of seeing the user search form:
p23348
aVSimply go to the folder, click on the workflow state () and choose
p23349
aVDelete
p23350
aVIf you do not need to have per-user folders, you can remove the  folder altogether
p23351
aVYou do need to make sure that user folder creation is not enabled first
p23352
aVGo to the Control Panel (click on your username, top right, select ):
p23353
aVselect :
p23354
aVand make sure that  is not checked
p23355
aVIf it is, uncheck it and save the settings
p23356
aVNow just delete the  folder; click , find the  menu on the right, then select :
p23357
aVthen confirm the deletion in the popup:
p23358
aVDeletion means all users will get a 404 when visiting  in your site
p23359
aVDelete the default view
p23360
aVThe  folder contains a  object that provides the user form search
p23361
aVIf all you want to get rid of is this view, you can delete it
p23362
aVIf your  folder is still public, visitors can see any userfolders that have been created though
p23363
aVDeleting this view requires going to the ZMI, the Zope Management Interface, navigating to the  folder and deleting the  object there
p23364
aVSince this is not really the recommended course of action I'm leaving out the screenshots for this part
p23365
as(dp23366
g16
V100297
p23367
stp23368
a((dp23369
g2
(lp23370
VYou need to double the slash:
p23371
aVor use a  raw string literal:
p23372
aVWithout the doubled slash or raw string literal, the  is interpreted as an espace code meaning
p23373
aVDo doublecheck that you are not looking at a string representation where python represents  characters using the escape code:
p23374
aVIn the above example I create a string with both a double and a single quote character () and Python echoes that back to me as a string representation
p23375
aVUsing  prints the actual string contents and not a representation
p23376
aVNote how Python has escaped the  quote for me there
p23377
as(dp23378
g16
V100297
p23379
stp23380
a((dp23381
g2
(lp23382
VUse :
p23383
aVDemo:
p23384
aVThis returns a tuple; cast to a list with  if a that is a requirement
p23385
aVNote that this is the equivalent of a slice expression () with a set of indices instead of a range; it can not be used as a left-hand-side slice assignment ()
p23386
as(dp23387
g16
V100297
p23388
stp23389
a((dp23390
g2
(lp23391
VYou are using Python 3, while the script requires Python 2:
p23392
aVIts main part is a simple  Python 2
p23393
aV6 script
p23394
aVIn python 2, print is a statement, in 3, it's a function
p23395
aVThis difference leads to syntax errors when trying to run python 2 code with python 3:
p23396
as(dp23397
g16
V100297
p23398
stp23399
a((dp23400
g2
(lp23401
V does not (significantly) speed up attribute access:
p23402
aVThe goal of using  is to save memory; instead of using a  mapping on the instance, the class has descriptors for each and every attribute named in  and instances have the attribute assigned wether or not they have an actual value:
p23403
aVSo python still has to look at the class for each attribute access on an instance of  (to find the descriptor)
p23404
aVAny unknown attribute (say, ) will still result in Python looking through the class MRO to search for that attribute, and that includes dictionary searches
p23405
aVAnd you can still assign additional attributes to the class:
p23406
as(dp23407
g16
V100297
p23408
stp23409
a((dp23410
g2
(lp23411
VThe content of the file in question is included in the returned data
p23412
aVYou are getting the full GitHub view of that file, not just the contents
p23413
aVIf you want to download just the file, you need to use the  link at the top of the page, which will be (for your example):
p23414
aVNote the change in domain name, and the  part of the path is gone
p23415
aVTo demonstrate this with the  GitHub repository itself:
p23416
as(dp23417
g16
V100297
p23418
stp23419
a((dp23420
g2
(lp23421
VYou need to pass the flags to the  call instead:
p23422
aVand you can call  on the compiled pattern:
p23423
aVYour full script then becomes:
p23424
aVand prints  5 times
p23425
as(dp23426
g16
V100297
p23427
stp23428
a((dp23429
g2
(lp23430
VThe package is called :
p23431
aVDo check the installation requirements; you have python and setuptools, but you need the  package too
p23432
as(dp23433
g16
V100297
p23434
stp23435
a((dp23436
g2
(lp23437
VThe page uses a large JavaScript structure to load the prices
p23438
aVYou can load just that structure:
p23439
aVThis results in a large JavaScript structure, starting with:
p23440
aVUnfortunately, that's not directly loadable with the  module; although valid JavaScript, without quoting around the keys it is not valid JSON
p23441
aVYou'd need to use regular expressions to clean that up further, or grab the  information directly from that string
p23442
aVLuckily the structure can be fixed with a small amount of regular expression magic:
p23443
aVThis gives you a large dictionary, with SKU keys and dictionaries with nested dicts as data, including nested SKUs with  product codes and  prices:
p23444
as(dp23445
g16
V100297
p23446
stp23447
a((dp23448
g2
(lp23449
VYour Python binary was compiled with Unicode disabled ()
p23450
aVNumPy requires a Python build with Unicode support enabled
p23451
aVYou'll have to install one that does have it enabled (the default)
p23452
aVIf you find your Python has Unicode enabled after all (run , type  and you get no errors), then the build system is failing to pick up the Python C headers from  instead
p23453
aVSpecifically, the  file could be missing:
p23454
as(dp23455
g16
V100297
p23456
stp23457
a((dp23458
g2
(lp23459
VYou are looping over keys, but trying to assign those to both a key and value variable:
p23460
aVchange that to loop over :
p23461
aVor better still, if on Python 2
p23462
aVx, use `
p23463
aViteritems():
p23464
aVNote that the way you read the files, you only ever store the last-read gene for any given snpID; you overwrite the previous one if you find another entry for that id
p23465
aVPersonally, I'd use  with a  default:
p23466
aVNow the values in  are sets of genes, each unique
p23467
aVNote that I split your line into 2 pieces on whitespace () so that if there is any whitespace in the gene value, it'll be stored as such:
p23468
aVBy using `snpid, gene' as left-hand assignment expression Python takes the result of the split and assigns each piece to a separate variable; a handy trick here to save a line of code
p23469
aVTo output this to a new file, simply loop over the resulting  structure
p23470
aVHere is one that sorts everything:
p23471
as(dp23472
g16
V100297
p23473
stp23474
a((dp23475
g2
(lp23476
VIt looks like the documentation hasn't been updated on how to use namespaces and
p23477
aVThe  function (as well as ,
p23478
aViterfind()namespaces` argument which is supposed to be a mapping
p23479
aVThat is the only structure consulted when finding tags:
p23480
aVThe  function is only useful for when serializing a tree out to text again
p23481
as(dp23482
g16
V100297
p23483
stp23484
a((dp23485
g2
(lp23486
VYou are never calling your  function, so it is not doing anything
p23487
aVList comprehensions are in fact faster:
p23488
aVIf you use the  module to look at the bytecode for each function, you can see why:
p23489
aVThe  function looks up the  method of the list in each iteration, and calls it
p23490
aVThe  function has to grow the list by one element each time it is called
p23491
aVThe list comprehension on the other hand doesn't have to do that work
p23492
aVInstead, python uses the  bytecode, which uses the C API to append a new element to the list, without having to do the lookup and a python call to the function
p23493
as(dp23494
g16
V100297
p23495
stp23496
a((dp23497
g2
(lp23498
VIt is a nested list
p23499
aVUnwrap the outer list, then iterate over the inner, taking out the  value:
p23500
aVYou can also combine that into a generator expression:
p23501
as(dp23502
g16
V100297
p23503
stp23504
a((dp23505
g2
(lp23506
VIn Plone 4
p23507
aV2, the options of the old advanced form have been integrated into the search results page; there is now a filter dropdown after you searched:
p23508
aVChanging options in this filter will automatically update the search results
p23509
as(dp23510
g16
V100297
p23511
stp23512
a((dp23513
g2
(lp23514
VYou should not remove items from a list you are looping over
p23515
aVCreate a copy instead:
p23516
aVand
p23517
aVModifying a list while looping over it, affects the loop:
p23518
aVRemoving items from a list you are looping over twice makes things a little more complicated still, resulting in a ValueError:
p23519
aVWhen creating a copy of the lists you are modifying at each level of your loops, you avoid the problem:
p23520
aVWhen you have a collision, you only need to remove the  bolt once, not in the loop where you hurt the aliens
p23521
aVClean out the aliens separately later:
p23522
as(dp23523
g16
V100297
p23524
stp23525
a((dp23526
g2
(lp23527
VFor tabular data, use a database
p23528
aVYou can access Postgres from Plone, using either the (elderly and aging) ZSQLMethods of Zope, or by using python code and custom code
p23529
aVThe latter is not that hard or daunting, but it does require that you read up on how to create a custom package for Plone
p23530
aVPersonally, I'd use SQLAlchemy to integrate the database into Plone views
p23531
as(dp23532
g16
V100297
p23533
stp23534
a((dp23535
g2
(lp23536
VWhen  is an empty list, your function doesn't return anything, and the default return value is
p23537
aVTest for the empty list at the top:
p23538
aVIn your second function you only test for , but an empty list  is never equal to
p23539
aVNote that the idiomatic way to test for  is using the  object identity test instead:
p23540
aVBy testing for  instead, you catch both the case where  is an empty list and a being
p23541
aVYour code otherwise makes little sense
p23542
aVYou loop over  but return and exit the function in the first iteration:
p23543
aVHowever, I had to fix the indentation in your post and may have misunderstood the indentation of those  statements, in which case you would get a  instead when passing in an empty list
p23544
as(dp23545
g16
V100297
p23546
stp23547
a((dp23548
g2
(lp23549
VThe  links on reddit do not have any  extensions, so your regular expression won't match anything
p23550
aVYou should be looking for the  domain instead
p23551
aVMatching  does return results:
p23552
aVYou can expand this to other file extensions:
p23553
aVYou may want to use a proper HTML parser instead of a regular expression; I can recommend both BeautifulSoup and
p23554
aVIt'll make it much easier to find all  tags that use  links with those tools, including  and  files, if any
p23555
as(dp23556
g16
V100297
p23557
stp23558
a((dp23559
g2
(lp23560
V does not do what you think it does
p23561
aVIt finds the parents of the current element that match the search
p23562
aVYou are trying to find the parents of a page element, which is already the top-level element
p23563
aVIf you had a structure like this:
p23564
aVwhere  is a BeautifulSoup variable for the whole structure, you can find the  with:
p23565
aVand then calling  will return a result, namely the  element
p23566
aVSo, calling  on a top-level element will always return an empty result, there are no parents
p23567
aVCall it on something that does have a parent element instead
p23568
as(dp23569
g16
V100297
p23570
stp23571
a((dp23572
g2
(lp23573
VBecause in the course of normal operations Python will create and destroy a lot of small tuples, Python keeps an internal cache of small tuples for that purpose
p23574
aVThis helps cut down on a lot of memory allocation and deallocation churn
p23575
aVFor the same reasons small integers from -5 to 255 are interned (made into singletons)
p23576
aVThe  definition controls at the maximum size of tuples that qualify for this optimization, and the  definition controls how many of these tuples keeps around in memory
p23577
aVWhen a tuple of length <  is discarded, it is added to the free list if there is still room for one (in ), to be re-used when Python creates a new small tuple (in )
p23578
aVPython is being a little clever about how it stores these; for each tuple of length > 0, it'll reuse the first element of each cached tuple to chain up to  tuples together into a linked list
p23579
aVSo each element in the  array is a linked list of Python tuple objects, and all tuples in such a linked list are of the same size
p23580
aVThe only exception is the empty tuple (length 0); only one is ever needed of these, it is a singleton
p23581
aVSo, yes, for tuples over length  python is guaranteed to have to allocate memory separately for a new C structure, and that could affect performance if you create and discard such tuples a lot
p23582
aVIf you want to understand Python C internals, I do recommend you study the Python C API; it'll make it easier to understand the various structures Python uses to define objects, functions and methods in C
p23583
as(dp23584
g16
V100297
p23585
stp23586
a((dp23587
g2
(lp23588
V returns an iterator, as do the other calls
p23589
aVYou can only loop through an iterator once; it is then exhausted
p23590
aVYou can create such an iterator yourself with a generator function:
p23591
aVIf you were to loop over , the list  would be emptied
p23592
aVYou can only do that once, since  removes elements:
p23593
aVThe  call tries to get another value from the  iterator; it is already empty so the  exception is raised
p23594
aVThat exception signals there are no more elements to be gotten, and that's why you end up with an empty list the second time you try and get anything from an iterator:
p23595
aVdoes not return an iterator
p23596
aVIt returns a range object instead, which represents a memory-efficient series of numbers; only the start, end and stride need to be stored and everything else can be derived from those 3 points
p23597
as(dp23598
g16
V100297
p23599
stp23600
a((dp23601
g2
(lp23602
VThe reference count of  and  doesn't change, they are just variables and thus string keys in a  namespace
p23603
aVThe Python list objects that these two variables point to, though, yes, their reference count changes when passed to a function
p23604
aVDuring the call to the function two new variables refer to those lists ( and ) increasing the count, and when the function returns those variables are cleaned up and the ref count goes down again
p23605
aVInside the  function, you are accessing items of these two lists (, etc
p23606
aVItem access could use the  method of objects; methods are created on-the-fly when accessed, and hold a reference to the instance and the underlying function
p23607
aVFor a list that is another reference to the list object, and another temporary reference count increase
p23608
aVOnce the function has been called and returned it's value, the method is discarded again (nothing is referencing it) and the ref count for the list drops again
p23609
aVAs delnan rightly points out in the comments, for list subscription the  opcode optimizes access (provided the index is an integer) and no method is created in that specific case
p23610
aVThe python interpreter, when handling bytecode and values on the stack, is increasing and decreasing reference counts all the time though
p23611
aVTake a look through the Python bytecode evaluation loop and count the number of  and  occurrences to to get an idea of how common this is
p23612
as(dp23613
g16
V100297
p23614
stp23615
a((dp23616
g2
(lp23617
V let's you define a whole new property, by defining a getter for that property
p23618
aVThe  syntax lets you override just the existing getter
p23619
aVThere are also  and  decorators, to the other two methods available to a property
p23620
aVImagine you subclassing a custom class that is using a property, with both a getter and a setter defined
p23621
aVIf you only wanted to override the getter of that property but leaving the setter in place (or the deleter), using  lets you do that:
p23622
aVNote that I only replaced the  getter, while it's setter was preserved
p23623
aVThe  setter does not exist, I replaced the  property wholesale
p23624
as(dp23625
g16
V100297
p23626
stp23627
a((dp23628
g2
(lp23629
VYou can't, reference counting is fundamental to CPython (the reference implementation, and the one you are using)
p23630
aVUsing methods on objects cause reference counts to change, item subscription or attribute access causes objects to be added and removed from the stack, which uses reference counts, etc
p23631
aVYou cannot get around this
p23632
aVAnd if the contents of the lists don't change, use s instead
p23633
aVThat won't change the fact that they'll be refcounted though
p23634
aVOther implementations of Python (Jython (using the Java virtual machine), IronPython (a
p23635
aVNET runtime language) or PyPy (Python implemented in Python, but experimenting with JIT and other compiler techniques) are free to use different methods of memory management, and may or may not solve your memory problem
p23636
as(dp23637
g16
V100297
p23638
stp23639
a((dp23640
g2
(lp23641
VPython doesn't distinguish between 'normal' characters and ANSI colour codes, which are also characters that the terminal interprets
p23642
aVIn other words, printing  to a terminal may change the terminal text colour, Python doesn't see that as anything but a set of 5 characters
p23643
aVIf you use  instead, python will print the string literal form instead, including using escape codes for non-ASCII printable characters (so the ESC ASCII code, 27, is displayed as ) to see how many have been added
p23644
aVYou'll need to adjust your column alignments manually to allow for those extra characters
p23645
aVWithout your actual code, that's hard for us to help you with though
p23646
as(dp23647
g16
V100297
p23648
stp23649
a((dp23650
g2
(lp23651
VOn windows, it's the CMD console that closes, because the Python process exists at the end
p23652
aVTo prevent this, open the console first, then use the command line to run your script
p23653
aVDo this by right-clicking on the folder that contains the script, select  and typing in  in the console
p23654
aVThe alternative is, as you've found out, to postpone the script ending by adding a  call at the end
p23655
aVThis allows the user of the script to choose when the script ends and the console closes
p23656
as(dp23657
g16
V100297
p23658
stp23659
a((dp23660
g2
(lp23661
VUse  to execute a query that returns data
p23662
aVYou'll either have to use a loop, or use a  where clause:
p23663
as(dp23664
g16
V100297
p23665
stp23666
a((dp23667
g2
(lp23668
VIf your  list is in sorted order, you can use  the  module:
p23669
aVThe  functions return indices into the  list:
p23670
as(dp23671
g16
V100297
p23672
stp23673
a((dp23674
g2
(lp23675
VJust define the column to have a :
p23676
aVSee the SQLite  documentation
p23677
as(dp23678
g16
V100297
p23679
stp23680
a((dp23681
g2
(lp23682
VUse :
p23683
aVI've used the  library  recipe here to convert your data to dictionaries, but as other answers have shown you there are more ways to skin that particular cat
p23684
aVis a  with each id pointing to a total count:
p23685
aVs are multi-sets and will keep track of the count of each key with ease
p23686
aVIt feels like a much better data structure for your data
p23687
aVThey support summing, as used above, for example
p23688
as(dp23689
g16
V100297
p23690
stp23691
a((dp23692
g2
(lp23693
VUsing open files as an iterator uses a read-ahead buffer to increase efficiency
p23694
aVAs a result, the file pointer advances in large steps across the file as you loop over the lines
p23695
aVFrom the File Objects documentation:
p23696
aVIn order to make a for loop the most efficient way of looping over the lines of a file (a very common operation), the  method uses a hidden read-ahead buffer
p23697
aVAs a consequence of using a read-ahead buffer, combining  with other file methods (like ) does not work right
p23698
aVHowever, using  to reposition the file to an absolute position will flush the read-ahead buffer
p23699
aVIf you need to rely on , don't use the file object as an iterator
p23700
aVYou can turn  into an iterator instead (at the price of some performance loss):
p23701
aVThis uses the  function  argument to turn any callable into an iterator
p23702
as(dp23703
g16
V100297
p23704
stp23705
a((dp23706
g2
(lp23707
VThey both perform their function normally, if that's what you mean
p23708
aVThey both are callable
p23709
aVOtherwise there are few differences between them
p23710
aVOne difference is that you can set arbitrary attributes on  objects, but not on a C function (such as
p23711
aVAnother is that a Python function has a code object associated with it, containing the compiled bytecode and information about local variables and such
p23712
aVThe C function, naturally, lacks that information
p23713
as(dp23714
g16
V100297
p23715
stp23716
a((dp23717
g2
(lp23718
VThe following set and list comprehension lists columns where the column has a max value of 2:
p23719
aVThis returns
p23720
as(dp23721
g16
V100297
p23722
stp23723
a((dp23724
g2
(lp23725
VUse virtualenv to achieve isolation:
p23726
aVlet's you re-use existing eggs on purpose, it's aim is to satisfy the requirements set by the buildout
p23727
aVYou should really pin all your versions down, and not let buildout pick them for you:
p23728
as(dp23729
g16
V100297
p23730
stp23731
a((dp23732
g2
(lp23733
VYou are trying to use  as a function:
p23734
aVYou missed :
p23735
aVAlso, if your discriminant turns out to be lower than 0, you'll get an unbound local exception:
p23736
aVYou'll need to add a  there, or better still, raise an exception:
p23737
aVYour  function is missing it's default value for :
p23738
aVWith those changes, your function actually works:
p23739
as(dp23740
g16
V100297
p23741
stp23742
a((dp23743
g2
(lp23744
VList comprehensions to the rescue
p23745
aVWhen you want to transform the elements in a list, a list comprehension is usually the answer
p23746
as(dp23747
g16
V100297
p23748
stp23749
a((dp23750
g2
(lp23751
VYou are putting commas in your string concatenation:
p23752
aVand Python thus sees those elements as a tuple ()
p23753
aVUse  instead:
p23754
aVBetter yet, use string formatting:
p23755
aVWhen concatenating a series of strings in python, it's actually going to be faster to use a  as intermediary
p23756
aVBuild the list, then use  to get the output:
p23757
aVNote that you don't need to test for  at all, you just got the item from the list in the loop already
p23758
aVThat's just extra work that doesn't do anything
p23759
as(dp23760
g16
V100297
p23761
stp23762
a((dp23763
g2
(lp23764
VYou are using a regular expression, and matching XML with such expressions get too complicated, too fast
p23765
aVPlease don't make it hard on yourself and use a HTML parser instead, Python has several to choose from:
p23766
aVElementTree is part of the standard library
p23767
aVBeautifulSoup is a popular 3rd party library
p23768
aVlxml is a fast and feature-rich C-based library
p23769
aVElementTree example:
p23770
as(dp23771
g16
V100297
p23772
stp23773
a((dp23774
g2
(lp23775
VYour document has a namespace on it, you need to include the namespace when searching:
p23776
aVoutput:
p23777
aVThe  and  methods also take a namespace map; you can search for a arbitrary prefix, and the prefix will be looked up in that map, to save typing:
p23778
as(dp23779
g16
V100297
p23780
stp23781
a((dp23782
g2
(lp23783
VUse the  command, it takes the exact same formatting parameters, preceded by a :
p23784
as(dp23785
g16
V100297
p23786
stp23787
a((dp23788
g2
(lp23789
VUse  to get the 'interesting' text from a table row:
p23790
aVThis outputs:
p23791
aVor, to pull everything into one list of lists (with, by request, the last row not included):
p23792
aVwhich becomes:
p23793
aVThe result of , a , acts just like a Python list and you can slice it at will to ignore certain rows, for example
p23794
as(dp23795
g16
V100297
p23796
stp23797
a((dp23798
g2
(lp23799
VYou are not closing your file
p23800
aVYou need to call the close function:
p23801
aVWithout the  you are only referencing the function, not actually invoking it
p23802
aVUntil you properly close the file, the write buffer is not being flushed, and you only see the partial write
p23803
aVYou can use files as context managers in a  statement
p23804
aVWhen the block underneath the  statement is done, the file is closed automatically without you needing to call  at all:
p23805
aVIt's best to avoid the  parameter where possible, use this instead:
p23806
as(dp23807
g16
V100297
p23808
stp23809
a((dp23810
g2
(lp23811
VIf you already configured your setup to handle UTF-8, you do not need to decode your string to a Unicode object
p23812
aVWhat will happen then is that Python uses the current encoding detected for
p23813
aVTry not decoding:
p23814
as(dp23815
g16
V100297
p23816
stp23817
a((dp23818
g2
(lp23819
VYou are passing in a Python structure, which a Javascript framework won't know anything about
p23820
aVThe string representation interpolated into a template may look a lot like a JavaScript structure but there are (many) differences
p23821
aVTranslate it to a structure Javascript can read by using the  module:
p23822
aVthen interpolate that into your Javascript code as a (unescaped) variable:
p23823
as(dp23824
g16
V100297
p23825
stp23826
a((dp23827
g2
(lp23828
VApart from the  and  structure, the compiler adds information on 'free variables' in the form of cells pointing to locals in nested functions, for any local variable that is a) not being assigned to, and b) refers to a scoped variable (Python 3
p23829
aVx adds the  keyword to allow you to assign to such a variable too, just as with the  keyword)
p23830
aVIn your specific case, there are no such variables
p23831
aVNone of your nested code refers to ; only if  or  actually used that variable would the python compiler (so at byte compilation time) add the necessary structures to be able to pull out  from the scope
p23832
aVHere is an example nested setup:
p23833
aVNote how the  codeobject lists  in the  list, and the codeobject for  has  listed in ;  is not listed in either because  never uses it
p23834
aVThe reference to the  function has a  structure, that holds the current value for  as given by the scope when  was created
p23835
aVCode objects hold the bytecode for a function; they are created at compile time
p23836
aVThe  tuple is created at runtime based on the  and  structures
p23837
aVBecause this happens at compile time, creating a reference to such a scoped variable dynamically is, at best, tricky
p23838
aVI would, for your own sake, not even bother to support using scoped variables in this case
p23839
as(dp23840
g16
V100297
p23841
stp23842
a((dp23843
g2
(lp23844
VFile I/O in python is already buffered
p23845
aVThe  function lets you determine to what extend writing is buffered:
p23846
aVThe optional  argument specifies the file\u2019s desired buffer size:  means unbuffered,  means line buffered, any other positive value means use a buffer of (approximately) that size
p23847
aVA negative  means to use the system default, which is usually line buffered for tty devices and fully buffered for other files
p23848
aVIf omitted, the system default is used
p23849
aVPersonally, I'd use the file as a context manager through the  statement
p23850
aVAs soon as all the statements under the  suite (at least one indentation level deeper) have completed or an exception is raised the file object is closed:
p23851
aVwhere I've set the buffer to 20 MB in the above example
p23852
as(dp23853
g16
V100297
p23854
stp23855
a((dp23856
g2
(lp23857
VYou'd be better off just adding your function directly to the class:
p23858
aVThis works just fine:
p23859
as(dp23860
g16
V100297
p23861
stp23862
a((dp23863
g2
(lp23864
VYou are still looking at a reference to the tag, and when that's printed, all it's contained children are printed too
p23865
aVA tag is not just the opening  element, it also includes any children and the closing element
p23866
aVYou still need to reach those children in the tree, via  (which would be ), for example
p23867
aVNavigating around the tree does not move between opening and closing pieces of text, it moves among the elements in a tree
p23868
aVThe original XML/HTML document defined those elements in a certain ordering, but that's not what you are looking at here
p23869
aVYou are looking at the nested structure of tags and text fitting inside other tags, all the way to the root
p23870
aVSo the following HTML structure:
p23871
aVbecomes a structure along the following lines:
p23872
aV(simplified to remove a lot of whitespace)
p23873
aVIf you have a reference to the last  element, the previous element in that set is the text , the next is
p23874
aVAfter  comes the text
p23875
aVBefore the text  comes the text , etc
p23876
as(dp23877
g16
V100297
p23878
stp23879
a((dp23880
g2
(lp23881
VYou cannot get a reference to the class, because the class has yet to be created
p23882
aVYour parent frame points a temporary function, whose  when it completes will be used as the class body
p23883
aVAs such, all you need to do is add your variables to the parent frame locals, and these will be added to the class when class construction is finished
p23884
aVShort demo:
p23885
as(dp23886
g16
V100297
p23887
stp23888
a((dp23889
g2
(lp23890
VThis is going to be painful, but using default python you have 2 options:
p23891
aVdecorate the 1st and 2nd lists with , then sort these using the index to refer to values from the 3rd list:
p23892
aValthough it may help to sort  in-place instead of using ; you cannot get around using  for the other two
p23893
aVthe three lists together, then sort on the third element of this new list of lists, then  again to get back to the original structure:
p23894
aVNeither will be a performance buster, not with plain python lists of millions of numbers
p23895
as(dp23896
g16
V100297
p23897
stp23898
a((dp23899
g2
(lp23900
VThere is a better module, it's called :
p23901
aVfollows redirects (check  to see what redirects it followed)
p23902
aVBy using a session (optional), cookies are stored and passed on to subsequent requests
p23903
aVYou can set headers per request or per session (so the same extra headers will be sent with every request sent out for that session)
p23904
as(dp23905
g16
V100297
p23906
stp23907
a((dp23908
g2
(lp23909
VYour HTML input is broken; that  left angle bracket should have been encoded to  instead
p23910
aVFrom the  documentation on parsing broken HTML:
p23911
aVThe support for parsing broken HTML depends entirely on libxml2's recovery algorithm
p23912
aVIt is not the fault of lxml if you find documents that are so heavily broken that the parser cannot handle them
p23913
aVThere is also no guarantee that the resulting tree will contain all data from the original document
p23914
aVThe parser may have to drop seriously broken parts when struggling to keep parsing
p23915
aVEspecially misplaced meta tags can suffer from this, which may lead to encoding problems
p23916
aVIn other words, you take what you can get from such documents, the way  handles broken HTML is not otherwise configurable
p23917
aVOne thing you could try is to use a different HTML parser
p23918
aVTry BeautifulSoup instead, it's broken HTML handling may be able to give you a different version of that document that does give you what you want out of it
p23919
aVBeautifulSoup can re-use different parser backends, including  and  (the latter Python 2 only), so it'll give you more flexibility
p23920
aVThe  parser does give you the  character (converted to a  escape):
p23921
as(dp23922
g16
V100297
p23923
stp23924
a((dp23925
g2
(lp23926
VWhen python is executed, it creates  for you
p23927
aVThe values in that list are based on the arguments passed to it by the operating system, but it leaves off the  value from that list
p23928
aVIn other words, when Python is invoked, it sets  to everything but it's own executable
p23929
aVWhen you invoke a new executable via , you still need to include Python in that as that is what executable that the OS will run
p23930
aVThe first two values of what you a pass to  are still required, whatever you find in  later on
p23931
as(dp23932
g16
V100297
p23933
stp23934
a((dp23935
g2
(lp23936
VUse :
p23937
aVwhere  is the local variable name already present in your function
p23938
aVmakes  a path relative to
p23939
aVSince you started your walk from  that'll be  for a starting point of
p23940
as(dp23941
g16
V100297
p23942
stp23943
a((dp23944
g2
(lp23945
VYour function returns  (an empty  statement)
p23946
aVReturn an empty string instead:
p23947
aVYou also have a  definition there that is never used, and you can test for the empty list with
p23948
aVLast but not least, since  exits the function early, the  statement is optional
p23949
aVNext,  returns  as well, since you don't return anything from it
p23950
aVSimply discard it's return value:
p23951
aVNote that you never use the return value of  anyway, so you may as well not return anything; simply test if there is anything to print:
p23952
aVNow you can just inline the  function (which is just a one-liner):
p23953
aVThis is still recursive; Python isn't that strong at recursion, but it can do looping very well:
p23954
aVwhich can be reduced to a join on newlines too:
p23955
as(dp23956
g16
V100297
p23957
stp23958
a((dp23959
g2
(lp23960
VPrinting is not threadsafe
p23961
aVWhile some characters are being copied to the  stream by one thread, another thread is scheduled that is also printing and it gets to copy characters to  stream
p23962
aVThe result is that your  doesn't contain discreet results of  calls but mixed outputs from different threads, all jumbled together
p23963
aVThe work-around is to use  instead; that is an atomic (threadsafe) operation
p23964
aVMake sure you include an explicit  newline
p23965
as(dp23966
g16
V100297
p23967
stp23968
a((dp23969
g2
(lp23970
VThe  underscore convention is clear and prevalent through the python world
p23971
aVYou document your 'public' attributes, and just use default arguments with underscores to your  method
p23972
aVKeep it simple
p23973
aVIf someone wants to screw up a class by using those private parameters anyway, you are not going to stop them, not in Python
p23974
as(dp23975
g16
V100297
p23976
stp23977
a((dp23978
g2
(lp23979
VDouble the curly braces that you want to keep:
p23980
aVNow you have doubled braces ( and ) surrounding the replacement pattern ( and )
p23981
as(dp23982
g16
V100297
p23983
stp23984
a((dp23985
g2
(lp23986
VUse list comprehensions; storing the words in a set first for faster testing:
p23987
aVor, as a complete solution:
p23988
as(dp23989
g16
V100297
p23990
stp23991
a((dp23992
g2
(lp23993
VYou could use a mapping to turn letters to numbers
p23994
aVSuch a mapping is easy to generate from the  string:
p23995
aVUsing  it is then trivial to turn a letter (e
p23996
ag1298
aV), into a number ():
p23997
aVUsing a space-separated input, this becomes:
p23998
aVOther techniques use  to get the ASCII ordinal for a letter (subtract  to make it 0-based) or using  on  (which would be slower)
p23999
aVComparing their relative speed with the  module is the best way to figure out which one is the fastest technique (if you so care):
p24000
aVThe dictionary (mapping) approach is fastest; using  is close behind (if you compute  only once), and using  takes almost three times as long
p24001
as(dp24002
g16
V100297
p24003
stp24004
a((dp24005
g2
(lp24006
VI bet you have a local file named , and it's masking the system  module
p24007
aVYou can verify this by printing :
p24008
aVto get the file path of the module that is being imported
p24009
aVRename it, or delete it, to fix this
p24010
as(dp24011
g16
V100297
p24012
stp24013
a((dp24014
g2
(lp24015
VYou confused a module with the class contained within it
p24016
aVUse
p24017
aV(and give your modules better names; they do not have to match the contained class names like you do in Java)
p24018
as(dp24019
g16
V100297
p24020
stp24021
a((dp24022
g2
(lp24023
VMac OS X uses denormalized characters always for filenames on HFS+
p24024
aVUse  to denormalize the glob pattern
p24025
as(dp24026
g16
V100297
p24027
stp24028
a((dp24029
g2
(lp24030
VThe iterator protocol consists of two parts
p24031
aVThe  method is the most important one, it is expected to return the iterator when you use  on an object
p24032
aVJust replace the body of  with ; no need to raise  either:
p24033
aVNow  is an iterator and has a  method
p24034
aVIf you want your class to be useful as an iterator directly, you need  to return  and provide a  method
p24035
aVA  method produces one element per function body (and use )
p24036
aVA generator is just a function using , really, such a method itself implements the iterator protocol for you (which includes )
p24037
aVIf you were to use , it would look like this instead:
p24038
aVor you can reuse the  method of your generator:
p24039
as(dp24040
g16
V100297
p24041
stp24042
a((dp24043
g2
(lp24044
VYou need to create unique dicts for the subdict, you cannot reuse the same  value and expect this to result in separate dictionaries for your nested structure
p24045
aVUse:
p24046
aVinstead;  creates a fresh copy of  for each key
p24047
as(dp24048
g16
V100297
p24049
stp24050
a((dp24051
g2
(lp24052
VBy sub-classing  and adding guards to ,  and ; adding a  class method that takes the type from the default value is a nice extra:
p24053
aVUse this as:
p24054
as(dp24055
g16
V100297
p24056
stp24057
a((dp24058
g2
(lp24059
V is a descriptor; it hooks  to turn anything you assign to  into a tuple
p24060
aVSo, as soon as you assign your list to , the descriptor converts it back to a tuple
p24061
aVIt's not that your  call failed, it's just that  is special
p24062
aVis documented to be a tuple, and in Python 2, exception objects support slicing:
p24063
aVExceptions are also supposed to be immutable; keeping the  attribute a tuple helps keep them so
p24064
aVMoreover, the  handler for exceptions expects  to be a tuple, and setting it to something else has led to strange bugs in the past
p24065
as(dp24066
g16
V100297
p24067
stp24068
a((dp24069
g2
(lp24070
VTo add your product, just import the  function directly:
p24071
as(dp24072
g16
V100297
p24073
stp24074
a((dp24075
g2
(lp24076
VI'd use  to grab a local checkout, and use it as a development egg:
p24077
aVNow  will check out  into , run it's  to make it a development egg, and tell buildout it's available as such
p24078
aVNow buildout will use that local copy to satisfy any  requirement
p24079
as(dp24080
g16
V100297
p24081
stp24082
a((dp24083
g2
(lp24084
VUse slicing, rebuilding the string minus the index you want to remove:
p24085
as(dp24086
g16
V100297
p24087
stp24088
a((dp24089
g2
(lp24090
VNo, string and unicode objects can't have interfaces
p24091
aVBut for this use-case, I'd register named utilities instead and look up the utility by name, or list all utilities available:
p24092
as(dp24093
g16
V100297
p24094
stp24095
a((dp24096
g2
(lp24097
VUse the  parameter:
p24098
aVThe  of a string is based on the byte values of the string;  is higher than  because  is higher than
p24099
aVFor your example input,  is still the max value, because  >  and  is longer (more values) than , and  >  (with  being the character following the letters  in the longer string)
p24100
as(dp24101
g16
V100297
p24102
stp24103
a((dp24104
g2
(lp24105
VFor new-style classes, use  to get the 'current' class:
p24106
aVYou could also use  as that is the value  will use, but using the API method is always recommended
p24107
aVFor old-style classes (python 2, not inheriting from ),  is not so helpful, so you are forced to use :
p24108
as(dp24109
g16
V100297
p24110
stp24111
a((dp24112
g2
(lp24113
VUse :
p24114
aVIf one of these lists is longer than the other, you won't see the elements beyond the length of the shorter list
p24115
aVOn python 2,  results in a copy of both lists zipped together, and for large lists that can be a memory burden
p24116
aVUse  for such larger lists, it returns an iterator instead
p24117
aVOn python 3,  itself already returns an iterator
p24118
aVIf you need to loop over the longest list instead (and fill in a filler value for the missing shorter list elements), use  instead:
p24119
as(dp24120
g16
V100297
p24121
stp24122
a((dp24123
g2
(lp24124
VBy default, when installing a package as root, the data path is based on  plus your project name, I believe, so you can retrieve your files based on that
p24125
aVYou would be better off using the  extension to  and use the  module Resource API to load data files
p24126
aVIt comes with  for this very purpose
p24127
aVYou do want your data files included in the package for that to work best
p24128
aVSee Including data files (in the setuptools documentation)
p24129
aVYou can then load resource files with straight into a string with  for example:
p24130
as(dp24131
g16
V100297
p24132
stp24133
a((dp24134
g2
(lp24135
VThe GIL doesn't switch threads
p24136
aVThe GIL is a mutex that prevents multiple threads from executing bytecode at the same time
p24137
aVAs such, to prevent thread switching you need to look elsewhere
p24138
aVYou could call  with a really large value to prevent switching while your code is being profiled
p24139
aVWhenever you call  the current 'counter' is reset to the new value, so as soon as you call it no thread switch is allowed for at least  bytecode instructions
p24140
as(dp24141
g16
V100297
p24142
stp24143
a((dp24144
g2
(lp24145
VYou could use  to turn each  block into a python list:
p24146
aVAdding a print statement and using your example input, that results in:
p24147
aVand  is:
p24148
as(dp24149
g16
V100297
p24150
stp24151
a((dp24152
g2
(lp24153
VKML is a XML format
p24154
aVUse an XML parser to parse it (such as , included in the standard library, or )
p24155
aVYou could use a dedicated package such as PyKML to give you a higher-level API to the information contained, although that specific package is not yet Python 3 ready
p24156
aVI did manage to run the  tool on the files of that project though, so your mileage may vary
p24157
aVThe tests fail but the failures look benign (typical python 2 to 3 translation differences)
p24158
as(dp24159
g16
V100297
p24160
stp24161
a((dp24162
g2
(lp24163
VBrowser pages are separate components altogether
p24164
aVThey are not part of the target content type but a separate component altogether
p24165
aVIf all you need is a template (no view), just omit the class directive altogether:
p24166
aVThere is no need to create a  instance manually for that
p24167
aVIt is not entirely clear what you want to do with your link in your template
p24168
aVdoes not look like a valid TALES expression
p24169
aVIn plain Zope there are no easy tools to generate absolute URLs relative to a site root; perhaps you just want  and not use a TAL expression
p24170
as(dp24171
g16
V100297
p24172
stp24173
a((dp24174
g2
(lp24175
VViews are callable adapters that provide output based on the context and the request
p24176
aVTemplates are callables that render a piece of text based on a template
p24177
aVThey are often used in views
p24178
aVNote that views can return text without using a template:
p24179
aVViews can also be used by other Zope code, without themselves being published
p24180
aVZope code uses a lot of views internally
p24181
as(dp24182
g16
V100297
p24183
stp24184
a((dp24185
g2
(lp24186
VUse the  module; you need to define the types in a string format documented with that library:
p24187
aVThe above example expects native byte-order, two unsigned shorts, a float and a string of 255 characters
p24188
aVTo loop over an already fully read  string, I'd use ; there is a handy grouper recipe that I've adapter here:
p24189
aVThis produces tuples rather than lists, but it's easy enough to adjust if you have to:
p24190
as(dp24191
g16
V100297
p24192
stp24193
a((dp24194
g2
(lp24195
VThe  code wraps both  and  instances in a  object, which can only handle Latin-1 bytes (so not the full unicode codepoint range)
p24196
aVYou'll have to encode (to UTF-8 should work) if you still want to use ; the maintainers of the module meant that  objects are supported now, just not anything outside the Latin-1 range of codepoints
p24197
aVEncoding, splitting, decoding gives me:
p24198
aVA now closed Python issue tried to address this, but the module is very byte-stream oriented, and no new patch has materialized
p24199
aVFor now using  or  encoding is the best I can come up with for you
p24200
as(dp24201
g16
V100297
p24202
stp24203
a((dp24204
g2
(lp24205
VUse a dict comprehension:
p24206
aVThis takes each line in ,  away whitespace, turns it into the key and the length of the label as the value
p24207
aVIf you meant to count them, use :
p24208
aVThis takes each label from the file (again, ing away extra whitespace), and the  dict will give you a count for each label in the file (so if label  appears twice,  is 2)
p24209
as(dp24210
g16
V100297
p24211
stp24212
a((dp24213
g2
(lp24214
V is an external library; it is bundled with Python 2
p24215
aV6 and up as the  module
p24216
aVJust use  instead of , or install  on server B too
p24217
aVIf you replace your  import with , remember to fix any references in the file
p24218
aVAlternatively, import it like this:
p24219
aVand it'll use the stdlib  module, renamed, and all your references to  will continue to work
p24220
as(dp24221
g16
V100297
p24222
stp24223
a((dp24224
g2
(lp24225
VRemove the  call altogether:
p24226
aVNow you are making  a tuple, and you can loop over that directly
p24227
aVis only needed when you need to make a series of integers
p24228
aVWhen  is given an expression with a trailing comma, it won't print a newline, so to get all three values on one line, one (simple) way to do that would be:
p24229
aVWe can make this complicated fast, work through your tutorials a bit more and more powerful Python structures will be available soon enough
p24230
aV:-)
p24231
as(dp24232
g16
V100297
p24233
stp24234
a((dp24235
g2
(lp24236
VYou are looking for the process return code:
p24237
aVThe documentation is referring to the exist status of the process
p24238
as(dp24239
g16
V100297
p24240
stp24241
a((dp24242
g2
(lp24243
VAssign to the  attribute of  function pointers:
p24244
aVis the docstring attribute of Python objects, and  objects allow you to write to this attribute
p24245
aVObligatory libc demonstration (I use Mac, not Windows, but the principle is the same):
p24246
aVIPython seems to be able to pick that up just fine:
p24247
as(dp24248
g16
V100297
p24249
stp24250
a((dp24251
g2
(lp24252
VYou cannot open a directory for writing:
p24253
aVfollowed by
p24254
aVwon't work
p24255
aVDid you mean to add a filename to the latter statement
p24256
aVIf that was to be based on the  filename, you should add that name to the path:
p24257
aVTo move the file, use  instead; no need to 'open' the directory for that:
p24258
aVComplete code, simplified:
p24259
as(dp24260
g16
V100297
p24261
stp24262
a((dp24263
g2
(lp24264
VNo, but it's pretty easy to make one:
p24265
aVshort demonstration:
p24266
aVIn python 3 it'll return a  object, just like the regular  function would:
p24267
as(dp24268
g16
V100297
p24269
stp24270
a((dp24271
g2
(lp24272
VPython dictionaries are unordered, as are JSON objects
p24273
aVThe behaviour you see is normal
p24274
aVIf you need to retain ordering, don't use a  but a list up tuples instead:
p24275
aVOr you could also use the  string to read the body  values in order, since that is already ordered for you:
p24276
as(dp24277
g16
V100297
p24278
stp24279
a((dp24280
g2
(lp24281
VPython dictionaries have O(1) search complexity
p24282
aVSee the Time complexity wiki page
p24283
aVPython dictionaries are implemented as a hash table, and keys are hashed; you can influence the hashing by implementing a  method
p24284
as(dp24285
g16
V100297
p24286
stp24287
a((dp24288
g2
(lp24289
VFor a POSIX terminal you can use two techniques:
p24290
aVWrite a  carriage return to go back to start of the line
p24291
aVWrite a  backspace to clear a few characters
p24292
aVIn both cases, I'd use  together with a flush to write this out
p24293
aVUsing  backspace demo:
p24294
aVUsing  carriage return demo:
p24295
as(dp24296
g16
V100297
p24297
stp24298
a((dp24299
g2
(lp24300
VTo see if the user entered something other than the empty string
p24301
as(dp24302
g16
V100297
p24303
stp24304
a((dp24305
g2
(lp24306
VIt looks like you are confusing the term  with ; you cannot use  in the class definition itself, it is only available to a method
p24307
aVI think you are looking for the  descriptor:
p24308
aVBy using  (above used as a  decorator) you turn a method into an attribute:
p24309
aVThe  method is called every time the  attribute is accessed on an instance
p24310
aVAlternatively, set the list in the  initializer:
p24311
as(dp24312
g16
V100297
p24313
stp24314
a((dp24315
g2
(lp24316
VUse the  class factory to create a named tuple class:
p24317
aVYou can convert your existing list using a list comprehension:
p24318
as(dp24319
g16
V100297
p24320
stp24321
a((dp24322
g2
(lp24323
VYou never actually use your function, so  is never filled
p24324
aVWhat you want to do is make your function return the changed product name, and the color detected, as two separate values:
p24325
aVNow all you have to do is call this function and unpack it's return value into two variables for your CSV:
p24326
aVand  will either be an empty value or the matched color (now removed from )
p24327
as(dp24328
g16
V100297
p24329
stp24330
a((dp24331
g2
(lp24332
VThe author made a packaging mistake and didn't include the  file in the distribution
p24333
aVUpdate: Version 1
p24334
ag5740
aV1 was released fixing this issue
p24335
aVTry installing again
p24336
aVFor future reference, when you run into such a problem, you can pin  to a specific version (such as 1
p24337
aV1) in your  section:
p24338
aVor use  to get the development version:
p24339
aVI filed a bug report to let the author know; hopefully there will be a fixed version available soon
p24340
as(dp24341
g16
V100297
p24342
stp24343
a((dp24344
g2
(lp24345
VYou named your own file  as well; rename it or delete it, as it is being imported instead of the installed module
p24346
as(dp24347
g16
V100297
p24348
stp24349
a((dp24350
g2
(lp24351
VJust loop over the file directly:
p24352
aVThe above code:
p24353
aVLoops over the file; this gives you a line (including the newline  character)
p24354
aVUses  to remove whitespace around the word (including the newline)
p24355
aVUses  to put the word in quotes ( becomes )
p24356
aVUses  to join all quoted words together into one list with commas in between
p24357
as(dp24358
g16
V100297
p24359
stp24360
a((dp24361
g2
(lp24362
VYes, it is rebuilding the lambda on every loop; it needs to reevaluate that whole expression
p24363
aVTo see this, use the  module:
p24364
aVThe  opcode loads the compiled code for the lambda body;  creates the lambda from that
p24365
aVFor  this happens once, while for  this is repeated in each iteration of the loop (from the  opcode to the  opcode); note the  opcode for the variable  in  where it refers to the local variable instead
p24366
as(dp24367
g16
V100297
p24368
stp24369
a((dp24370
g2
(lp24371
VIt uses TimSort, an algorithm developed for Python by Tim Peters (of Zen of Python fame)
p24372
aVIt is a hybrid of Merge and Insertion sort, and now also in use in Java and Android
p24373
aVThe Python source code includes a more detailed description
p24374
aVYou'll find the implementation in the  C source
p24375
as(dp24376
g16
V100297
p24377
stp24378
a((dp24379
g2
(lp24380
VFrom the Python FAQ:
p24381
aVWhy is there no goto
p24382
aVYou can use exceptions to provide a \u201cstructured goto\u201d that even works across function calls
p24383
aVMany feel that exceptions can conveniently emulate all reasonable uses of the \u201cgo\u201d or \u201cgoto\u201d constructs of C, Fortran, and other languages
p24384
aVIn other words: there is no need for  when you have exception handling
p24385
as(dp24386
g16
V100297
p24387
stp24388
a((dp24389
g2
(lp24390
VThis does the following:
p24391
aVSplits the string on the text , and takes only the first element of the result; this is everything before the tab + Cart
p24392
aVSplits the part before  on whitespace ( is a tab, and that is whitespace)
p24393
aVThe length of that split is the number of words
p24394
as(dp24395
g16
V100297
p24396
stp24397
a((dp24398
g2
(lp24399
VYou can't remove elements from a list you are looping over
p24400
aVUse a list comprehension instead:
p24401
aVNote that we test for  to test with a (single element) tuple;  is just the single character string
p24402
aVIf you have to do this very often, consider using a set for  instead:
p24403
aVLookups in a set take constant time, vs
p24404
aVlinear time for a list membership test
p24405
as(dp24406
g16
V100297
p24407
stp24408
a((dp24409
g2
(lp24410
VIf you added  then it is up to you to make sure your new class can handle the arguments passed to
p24411
aVOld data that doesn't have the  data will still lead to  to be called but with no arguments
p24412
aVMake the arguments to  optional via keyword arguments:
p24413
aVWhen loading the old-style pickle, the data for these classes will still be restored
p24414
aVYou can use  to transform the internal state as needed
p24415
aVAlternatively, temporarily remove the  method from the class:
p24416
aVand re-dump your pickles from the now-loaded objects with  reinstated
p24417
aVI've tested both methods and in both cases the old data is loaded correctly and you can then dump your objects again to a new pickle file with  just fine
p24418
as(dp24419
g16
V100297
p24420
stp24421
a((dp24422
g2
(lp24423
VYou don't get a copy of the list, you get a reference to the list itself
p24424
aVSince lists are mutable, the behaviour is entirely expected
p24425
aVCompare this to using a second variable pointing to a list:
p24426
aVIf you wanted to have an independent list instead, make a copy:
p24427
aVAnother way to make a copy is to use the full-list slice:
p24428
as(dp24429
g16
V100297
p24430
stp24431
a((dp24432
g2
(lp24433
VYou use the current class in :
p24434
aVlooks for requested methods relative to the first argument; you started the search from  instead, looking for the parent classes;  is the next parent method that matches in that case
p24435
aVYou need to use the current class, because Python needs to search the base classes in Method Resolution Order; that ordering depends on how your current class is derived from it's base classes (especially if there is multiple inheritence or a base class ends up being referenced multiple times)
p24436
aVOn Python 3
p24437
aVx, you can use  without any arguments, and the compiler will add an extra hint to your method so that it can determine the correct class to start from
p24438
as(dp24439
g16
V100297
p24440
stp24441
a((dp24442
g2
(lp24443
VIn python 3, when you open a file for reading in text mode () it'll decode the contained text to unicode
p24444
aVSince you didn't specify what encoding to use to read the file, the platform default (from ) is being used, and that fails in this case
p24445
aVYou need to either specify an encoding that can decode the file contents, or open the file in binary mode instead (and use  bytes patterns for your regular expressions)
p24446
aVSee the Python Unicode HOWTO for more information
p24447
as(dp24448
g16
V100297
p24449
stp24450
a((dp24451
g2
(lp24452
VYou can 'dig down' and get the text out of a tag with the  iterable:
p24453
aVWe use  to only loop over tags contained in , not the direct text content (such as newlines)
p24454
aVNote that  will go over any nested tags, which could result in string duplication
p24455
aVThe following will only loop over direct tags of :
p24456
as(dp24457
g16
V100297
p24458
stp24459
a((dp24460
g2
(lp24461
V is a dict, just use  to get all the containd values:
p24462
aVHowever, if your function will in the future use , make your function use positional arguments instead:
p24463
as(dp24464
g16
V100297
p24465
stp24466
a((dp24467
g2
(lp24468
VYou need to create enough parameters to match your list of vars:
p24469
aVNote that you pass in  as the parameter values list
p24470
aVUsing the  we generate a string of  characters separated by commas, then use  to insert that into the statement
p24471
as(dp24472
g16
V100297
p24473
stp24474
a((dp24475
g2
(lp24476
VIf you need to do this often, it's easy enough to build yourself a re-usable map:
p24477
aVAnd from there on out use that map to translate back to a series of characters for a given category:
p24478
aVIf this is too costly for start-up time, consider dumping that structure to a file; loading this mapping from a JSON file or other quick-to-parse-to-dict format should not be too painful
p24479
aVOnce you have the mapping, looking up a category is done in constant time of course
p24480
as(dp24481
g16
V100297
p24482
stp24483
a((dp24484
g2
(lp24485
VYou can concatenate lists quite easily:
p24486
as(dp24487
g16
V100297
p24488
stp24489
a((dp24490
g2
(lp24491
VIt is not a portlet, but part of the custom Plone
p24492
aVorg frontpage view that uses the jQueryUI Accordion widget
p24493
aVSee the Plone
p24494
aVorg frontpage source
p24495
as(dp24496
g16
V100297
p24497
stp24498
a((dp24499
g2
(lp24500
V doesn't return the descriptor, it returns the result of getting the descriptor
p24501
aVIt doesn't return functions either, it returns the bound method; functions act as descriptors too, and their  method returns a method
p24502
aVBecause there is no  defined on the instance, there is no value and the descriptor  raises an AttributeError
p24503
aVThings work if you define  on instances of :
p24504
aVSo, accessing a  descriptor without a value raises an :
p24505
aVbut give the instance a value, and the  goes away:
p24506
aVNow  can find the result of the descriptor just fine (demonstrating with a different attribute name to not clobber ):
p24507
as(dp24508
g16
V100297
p24509
stp24510
a((dp24511
g2
(lp24512
VMac OS X 10
p24513
aV6 comes with Python 2
p24514
ag5279
ag1124
aVThe TKinter version on that platform is Apple 8
p24515
ag2176
aV7 and has known problems; IDLE won't run with it, for example
p24516
aVSee the IDLE and tkinter with Tcl/Tk on Mac OS X page on Python
p24517
aVorg for more details
p24518
aVTerminal output for  on a 10
p24519
aV6 machine:
p24520
aVThe  and  (, , , ) packages are non-default add-ons installed later on that machine, the rest should be standard issue
p24521
as(dp24522
g16
V100297
p24523
stp24524
a((dp24525
g2
(lp24526
VFirst of all, you double-escape the  and  input text, so you don't match your input:
p24527
aVRedefine  as:
p24528
aVYou'll need to use a negative look-arounds to match anything that is not the  or  comment opening and closing characters:
p24529
aVSo, this will match  followed by 0 or more characters (non-greedy) that are not a  slash, or they are a slash but only if not preceded by a
p24530
aVOn the other end of the string we do the same for the  pattern; slashes allowed but only if not followed by a
p24531
aVThere is no need for  anymore, since we don't use the  dot operator anymore
p24532
aVThis then works correctly:
p24533
as(dp24534
g16
V100297
p24535
stp24536
a((dp24537
g2
(lp24538
VFind the first : Use  instead; it'll return the first match
p24539
aVFind child , again, use  to find the first
p24540
aVElements act like a python , use item access to get element attributes such as
p24541
aVTogether, that makes:
p24542
as(dp24543
g16
V100297
p24544
stp24545
a((dp24546
g2
(lp24547
VFrom the source code:
p24548
aVthe first argument is not a dict ( test fails): raises
p24549
aVthe key is not hashable: could raise  or other exceptions, depends on the exact  or  hook implementation
p24550
aVthe key was not found in the dict: raises
p24551
aVYou need to check for an exception being set when -1 is returned by , in any case
p24552
as(dp24553
g16
V100297
p24554
stp24555
a((dp24556
g2
(lp24557
VEach feed item has an identifier, in
p24558
aVTrack those, together with their  (or ) entry, to check for new items
p24559
aVSo, see if you already have seen the item (via ) or if it has been updated since the last time you checked (via  or )
p24560
aVDo make sure you take advantage of the feedparser E-Tag support to check for changed feed contents though
p24561
aVThis will only save you from downloading feeds with no new items; you still need to detect items have been added or updated when you get a fresh new copy of the feed
p24562
as(dp24563
g16
V100297
p24564
stp24565
a((dp24566
g2
(lp24567
VYour  variable is an iterable, by looping over it you retrieve the rows
p24568
aVTo make it skip one item before your loop, simply call  and ignore the return value
p24569
aVYou can also simplify your code a little; use the opened files as context managers to have them closed automatically:
p24570
aVIf you wanted to write the header to the output file unprocessed, that's easy too, pass the output of  to :
p24571
as(dp24572
g16
V100297
p24573
stp24574
a((dp24575
g2
(lp24576
VFirst: It's rarely a good idea to rely on
p24577
aVYou could simply catch the  (and  as well) and assume the input was a string:
p24578
aVThere may be other exceptions raised here, but next to avoid using  I also want to caution against using a blanket  or  handler, those are generally also not good ideas
p24579
aVA better technique would be to use  instead:
p24580
aVonly accept python literal values (so  or  or ) and will throw a  if it cannot parse that input
p24581
aVIt does not suffer from the security problems that  suffers from, nor do you need to catch as many exceptions, only  needs to be handled
p24582
as(dp24583
g16
V100297
p24584
stp24585
a((dp24586
g2
(lp24587
VFrom :
p24588
aVThe manpage states:
p24589
aVPython opens the stdin, -out and -error streams in a buffered mode; it'll read or write in larger chunks, keeping data in memory until a threshold is reached
p24590
aVdisables those buffers
p24591
aVAlso, python can interpret newlines on open files and translate them from and to the native platform newlines (text mode)
p24592
aVThe  option disables this translation, allowing you to process binary data without having to worry about what might happen to  combinations
p24593
aVIt is the equivalent of using  or  modes when opening files with the  function
p24594
as(dp24595
g16
V100297
p24596
stp24597
a((dp24598
g2
(lp24599
VUse the  class method:
p24600
aVIt builds a dictionary using the elements from the first argument (a sequence) as the keys, and the second argument (which defaults to ) as the value for all entries
p24601
aVBy it's very nature, this method will reuse the value for all keys; don't pass it a mutable value such as a list or dict and expect it to create separate copies of that mutable value for each key
p24602
aVIn that case, use a dict comprehension instead:
p24603
as(dp24604
g16
V100297
p24605
stp24606
a((dp24607
g2
(lp24608
VUse  instead:
p24609
aVMost of all, remove whitespace (the newline specifically, but any other spaces or tabs might interfere too) when counting your lines
p24610
as(dp24611
g16
V100297
p24612
stp24613
a((dp24614
g2
(lp24615
VIf  can be present in more than one category, you could use a tuple to loop through them in priority order:
p24616
aVOtherwise use a  to map category types to dispatch methods instead; reusing the same tuple-of-tuples mapping above to build a dispatch:
p24617
aVThen just look up the request type on that:
p24618
aVA mapping lookup like that would be faster than a scan through the tuple, where we have to test against each category in turn until we find a match
p24619
aVIn fact, the priority ordering can be maintained by reversing that same tuple structure like so:
p24620
aVsince now the highest priority mapping for a given  key will be entered into the  structure last
p24621
aVThis will give you the fastest dispatch even if request types were present in multiple categories
p24622
aVDisadvantage is that if your  mappings are dynamic (request types get added to and removed from different categories over time) you'd need to maintain the  dict to reflect those changes too
p24623
as(dp24624
g16
V100297
p24625
stp24626
a((dp24627
g2
(lp24628
VYou'll have to add the key separately, after the creating the initial :
p24629
aVPython has no syntax to define a key as conditional; you could use a dict comprehension if you already had everything in a sequence:
p24630
aVbut that's not very readable
p24631
as(dp24632
g16
V100297
p24633
stp24634
a((dp24635
g2
(lp24636
VTo grab just the text content of a tag, the  iterable is ideal:
p24637
aVto get the contents including tags, use  or  on each child item:
p24638
aVwhich will work for both  and  items contained
p24639
as(dp24640
g16
V100297
p24641
stp24642
a((dp24643
g2
(lp24644
V only works in Python 3; it is a new addition to the language
p24645
aVIn Python 2 it'll raise a syntax error; python sees  as part of an expression instead of a statement
p24646
aVThis specific example works just fine when you actually use the correct Python version:
p24647
as(dp24648
g16
V100297
p24649
stp24650
a((dp24651
g2
(lp24652
VWe had the exact same problem with sqlalchemy 0
p24653
aV4; the session would get out of sync with the actual database contents
p24654
aVThe problem was somewhat masked in our case because users were sent to specific backends in the cluster through session affinity
p24655
aVIf the affinity was lost suddenly messages had disappeared
p24656
aVThe exact details are a little hazy, because I cannot locate the correct (ancient) revision history of the fix I put in place
p24657
aVFrom what I can glean from context is that the session identity map prevents the session from requiring the database for objects it retrieved before
p24658
aVIt thus won't see changes made to these objects in different sessions
p24659
aVThe fix is to call  on the session after each and every commit or rollback; SQLAlchemy 0
p24660
aV5 and up does this automatically ( on the session, now called  I believe), but for 0
p24661
aV4 you'll need to register a  to do this for you
p24662
aVLucky for you, we also use  for this project, so my fix is your fix:
p24663
aVWhen defining the mapper, you install this extension with:
p24664
as(dp24665
g16
V100297
p24666
stp24667
a((dp24668
g2
(lp24669
VThe returned  replaces the decorated function, and is thus treated as a method
p24670
aVThe original  took  and so does the new
p24671
aVSo, when calling  you are really calling the nested function , which is by that time a bound method
p24672
aVBound methods get  passed in, and  is assigned to the argument
p24673
aVcalls , passing these arguments on to the original decorated function
p24674
aVNote that  and  are hardcoded into the  signature; it is tightly bound to the decorated function
p24675
aVThese were not taken from the decorated function, the programmer who wrote the wrapper knew beforehand what arguments would be expected of the wrapped version
p24676
aVNote that the wrapper doesn't have to match arguments with the decorated function at all
p24677
aVYou could add arguments, for example:
p24678
aVNow you can make Lucy lie about her age in different ways:
p24679
as(dp24680
g16
V100297
p24681
stp24682
a((dp24683
g2
(lp24684
VYou need to open up your firewall to the download locations of any package you need to install
p24685
aVNote that the download location is not necessarily on PyPI
p24686
aVThe Python package index is a metadata service, one that happens to also provide storage for the indexed packages
p24687
aVAs such, not all packages indexed on PyPI are actually downloaded from PyPI, the download location could be anywhere on the internet
p24688
aVI'd say you start with opening , then as individual package installions fail, check their PyPI page and add the download location listed for those
p24689
as(dp24690
g16
V100297
p24691
stp24692
a((dp24693
g2
(lp24694
VYou are looping over  so each  is not itself a list; use  for individual elements:
p24695
aVYou could also use a list comprehension to grab all  attributes:
p24696
as(dp24697
g16
V100297
p24698
stp24699
a((dp24700
g2
(lp24701
VYour  function adds to the  list endlessly, without ever reseting the list:
p24702
aVNote that  is set outside the loop, and each row is appened to , then yielded as is
p24703
aVYour process memory footprint will thus grow and grow, forcing the OS to start swapping out memory eventually, thus slowing your process to a crawl
p24704
aVI think you meant to reset  when  doesn't appear in :
p24705
as(dp24706
g16
V100297
p24707
stp24708
a((dp24709
g2
(lp24710
VUse  instead and use it as a list with an index:
p24711
aVTo find a nth next sibling, use  instead, and select the 3rd element:
p24712
as(dp24713
g16
V100297
p24714
stp24715
a((dp24716
g2
(lp24717
VYou are looking at a list comprehension; for each  it will calculate
p24718
aVIf you were to write this out in a loop instead, it would be:
p24719
aVSo, for each string in the list, test the boolean expression  and add the result ( or ) in `tmplist
p24720
aVThe  function then returns the equivalent of:
p24721
aVbut expressed in a more tortuous manner
p24722
aVstarts with  and  as  and , then takes the result of the  as  and the next element in  as , and repeats this until all elements in senquence have been processed
p24723
aVA friendlier way to write this would be to use  instead:
p24724
aVis actually more efficient; it'll run the generator and will stop immediately when a match is found; if  contains  only one test will be performed
p24725
as(dp24726
g16
V100297
p24727
stp24728
a((dp24729
g2
(lp24730
VUse the  function to combine elements; zip will let you group two input lists into two output lists:
p24731
aVYou can turn this into a list comprehension with a bit more  magic:
p24732
aVNote that this does require the input to be sorted;  only groups elements based on the consecutive keys being the same
p24733
aVOn the other hand, it does preserve that initial sorted order
p24734
as(dp24735
g16
V100297
p24736
stp24737
a((dp24738
g2
(lp24739
VYou forgot a comma:
p24740
aVadd it between  and
p24741
aVYou are essentially passing in the arguments  instead of
p24742
aVPython will concatenate two adjacent strings if there is only whitespace between them:
p24743
aVSince  is the verbose switch that is required to make  produce output at all, it'll remain silent with it missing
p24744
aVWhenever you encounter problems with calling a subprocess, triple check the command line created
p24745
aVPre-pending  with  can help in that:
p24746
as(dp24747
g16
V100297
p24748
stp24749
a((dp24750
g2
(lp24751
VThe encoding your terminal is using doesn't support that character:
p24752
aVPython is handling it just fine, it's your output encoding that cannot handle it
p24753
aVYou can try using  in the Windows console to switch your codepage;  is a windows command line command to change code pages
p24754
aVMine, on OS X (using UTF-8) can handle it just fine:
p24755
as(dp24756
g16
V100297
p24757
stp24758
a((dp24759
g2
(lp24760
VUse string formatting instead:
p24761
as(dp24762
g16
V100297
p24763
stp24764
a((dp24765
g2
(lp24766
VYou forgot the closing parenthesis on the preceding line:
p24767
aVNote that there is no  after the closing quote
p24768
aVAs python lets you join multiple lines together when using parenthesis, the parser doesn't know anything is wrong until the next line, where you get your SyntaxError because what followed there doesn't make sense
p24769
aVAs for you second example, you need to put quotes around your strings,  is not a string but a variable, and you didn't define :
p24770
as(dp24771
g16
V100297
p24772
stp24773
a((dp24774
g2
(lp24775
VPython 3 refactored  and  into a new package called  with submodules
p24776
aVUse  and  instead
p24777
as(dp24778
g16
V100297
p24779
stp24780
a((dp24781
g2
(lp24782
VYes, you are supposed to create a clean slate for the tests, and keep your individual tests isolated
p24783
aVIt appears the test instances (one per test) are created in one batch, while  is called right before each test
p24784
aVIf your setup needs to reset external state, you'll need to do this in ; if you were to do this in  individual tests can screw up that external state for the rest of the test run
p24785
as(dp24786
g16
V100297
p24787
stp24788
a((dp24789
g2
(lp24790
VYou return  without calling it; it's a class and thus not iterable
p24791
aVPerhaps you meant to return  in the response
p24792
as(dp24793
g16
V100297
p24794
stp24795
a((dp24796
g2
(lp24797
VYou forgot a closing parenthesis on the line before the one with just  on it:
p24798
aVWhen you get a unexplained syntax error in Python, check the preceding line; Python expected to find more arguments to the  function there, and the next line violated that expectation
p24799
as(dp24800
g16
V100297
p24801
stp24802
a((dp24803
g2
(lp24804
VThe older ElementTree library included in Python 2
p24805
aV6 does indeed XML-escape data in comments unconditionally:
p24806
aVYou have a few options:
p24807
aVUpgrade to Python 2
p24808
aV7; it handles comment serialization correctly:
p24809
aVInstall the external ElementTree library
p24810
aVUse the Minidom (not recommended, the DOM API is overly verbose):
p24811
as(dp24812
g16
V100297
p24813
stp24814
a((dp24815
g2
(lp24816
VFunctions imported from a different module cannot see globals in the module they were imported to
p24817
aVGlobals are 'local' to the module a function is defined in only
p24818
aVYou could wrap your function in a lambda:
p24819
aVand alter your  function to accept  as an explicit argument:
p24820
as(dp24821
g16
V100297
p24822
stp24823
a((dp24824
g2
(lp24825
VIn recent Plone releases, folders use a BTree-backed storage, so you can store as many objects in there as you like
p24826
aVThe biggest folder that I can access in a production environment currently stores 25k items
p24827
aVYou will, of course, need to deal with large numbers of items in one location appropriately
p24828
aVThe usual caveats about really large numbers of content in a site apply
p24829
as(dp24830
g16
V100297
p24831
stp24832
a((dp24833
g2
(lp24834
VUse  and call  on the result:
p24835
aVThe first argument to  is the string to parse, the second is the expected format
p24836
as(dp24837
g16
V100297
p24838
stp24839
a((dp24840
g2
(lp24841
VYes, the library is still being maintained
p24842
aVJohn Hunter was the library creator, not it's sole maintainer
p24843
aVThe GitHub repository has plenty of recent commits, for example
p24844
aVThere are at least 100 contributors too (next to jdh2358, John's GitHub account)
p24845
aVThe GitHub matlibplot organisation lists 12 members apart from John; these people all help maintain the project
p24846
as(dp24847
g16
V100297
p24848
stp24849
a((dp24850
g2
(lp24851
VYou have two options:
p24852
aVDefine all these classes in a module
p24853
aVModules are just objects, so you can use  on them:
p24854
aVStore them all in a dictionary and look them up by name; you don't have to type out the name in a string, the class has a  attribute you can re-use:
p24855
aVIf these are defined in the 'current' module, the  function returns a dictionary too, so  is a reference to the class definition as well
p24856
as(dp24857
g16
V100297
p24858
stp24859
a((dp24860
g2
(lp24861
VThis is very easy, as strings and files are iterables too:
p24862
aVon a string turns it into a list of the individual characters; we use  to remove any extra whitespace, including the newline
p24863
aVThe  open file object is an iterable, so we can loop over it to process all the lines
p24864
aVResult:
p24865
as(dp24866
g16
V100297
p24867
stp24868
a((dp24869
g2
(lp24870
VOn the Google App Engine, count on 100 instances of both  and  being created; each user visiting your site potentially is routed to a different machine in the vast Google cloud
p24871
aVRun locally,  will be instantiated once per process; some WSGI servers run multiple procsses (forking) to handle incoming requests
p24872
aVA  itstance is created for each incoming request (so 100 times)
p24873
as(dp24874
g16
V100297
p24875
stp24876
a((dp24877
g2
(lp24878
VYou need to rethink your program logic, really
p24879
aVUsually, an API will not have all-optional parameters where you need to build a large decision tree from all the inputs
p24880
aVIn other words, in a real program you won't normally encounter a function where the behaviour is completely different for each of the different combinations of inputs
p24881
aVInvariably, the legal combinations is much, much smaller even for a larger number of optional parameters
p24882
aVFor your toy example, you can come up with other ways to create your return value not involving a decision tree:
p24883
aVmap responses:
p24884
aVbuild a string based on the inputs:
p24885
as(dp24886
g16
V100297
p24887
stp24888
a((dp24889
g2
(lp24890
VYou'll have to adjust your object to implement certain python hooks to behave in a 'generic' way
p24891
aVIn your second example, you could implement the  hook to make it behave like a sequence:
p24892
aVOr to give a little demonstration:
p24893
aVYou already discovered  for your self
p24894
as(dp24895
g16
V100297
p24896
stp24897
a((dp24898
g2
(lp24899
VThe tutorial is indeed wrong; both  and  return a method object
p24900
aVWhat goes on is that a function is a descriptor and their  method is invoked, returning a method
p24901
aVMethods have a  attribute pointing back to the original function:
p24902
aVThis all has changed in Python 3 though; there  returns the function itself, unbound methods no longer exist:
p24903
as(dp24904
g16
V100297
p24905
stp24906
a((dp24907
g2
(lp24908
VI'd use  to grab a local checkout:
p24909
aVNow  will check out  as part of the buildout run, into , run it's  to make it a development egg, and tell buildout it's available as such
p24910
aVNow buildout will use that local copy to satisfy any  requirement
p24911
aVIf your svn package is not a python egg, simply add  to it's  entry, and  won't look for a  to run
p24912
aVAlternatively, you can just use  to simply run the  command:
p24913
as(dp24914
g16
V100297
p24915
stp24916
a((dp24917
g2
(lp24918
VThe  statement syntax allows for a , and that includes a list or tuple of variable names
p24919
aVIt is intended for deleting several names at once:
p24920
aVwhich is the equivalent of:
p24921
aVor
p24922
aVBut python does not enforce the list to actually have any elements
p24923
aVThe expression
p24924
aVon the other hand is a syntax error;  is seen as a literal empty tuple in that case
p24925
as(dp24926
g16
V100297
p24927
stp24928
a((dp24929
g2
(lp24930
VYou really want to create a view for that; you can call a Product factory like that from a URL too, but it is not recommended
p24931
aVWith a view, you can combine the form and the code to create the new user in one place:
p24932
aVthen register this view with something like:
p24933
aVWhen your new page is registered, the named  is added as a  attribute on your  class, so the  method can invoke it () and return the results
p24934
aVBecause you combined the signup handling and the template together, you can now easily incorporate error handling
p24935
aVWhen someone loads the page for the first time  will be empty, but as soon as someone hits the submit button, you can detect this and call the  method
p24936
aVThat method can either create the user and then redirect away from this page, or set an error message and return, at which point the form is re-rendered
p24937
aVThis makes the  easy to set; you could just leave it empty, or you can set it to the current context URL plus the name of the view
p24938
aVTogether, the template then becomes:
p24939
aVNote how the form inputs are pre-filled with existing data from the request as well, making it easier for your visitor to correct any errors they may have made
p24940
as(dp24941
g16
V100297
p24942
stp24943
a((dp24944
g2
(lp24945
VYou are looking at the  representation of a custom class, which by default include the  (== memory address in CPython)
p24946
aVThis is the default used when printing a list, any contents are included using the representation:
p24947
as(dp24948
g16
V100297
p24949
stp24950
a((dp24951
g2
(lp24952
VUse the in-memory file object module , or it's faster C-coded equivalent cStringIO
p24953
as(dp24954
g16
V100297
p24955
stp24956
a((dp24957
g2
(lp24958
VYou are downloading JSON data without decoding it
p24959
aVUse the  library for that:
p24960
aVJSON encoded data looks a lot like Python, it uses  escaping as well, but it is in fact a subset of JavaScript
p24961
aVThe  variable now holds a deep datastructure
p24962
aVJudging by the string splitting, you wanted this piece:
p24963
aVNow articleContent is an actual  instance; it is the revision text of the page you were looking for:
p24964
as(dp24965
g16
V100297
p24966
stp24967
a((dp24968
g2
(lp24969
VYou are trying to subclass  but never call the list  method
p24970
aVAdd this:
p24971
aVto add the items to self
p24972
aVThere is no need to assign to :
p24973
as(dp24974
g16
V100297
p24975
stp24976
a((dp24977
g2
(lp24978
VFor a list, create a copy before iterating:
p24979
aVwhere the  slice notation creates a copy of the full list
p24980
aVYou cannot otherwise remove elements from a list while iterating over it
p24981
as(dp24982
g16
V100297
p24983
stp24984
a((dp24985
g2
(lp24986
VYou are using  instead of  in your  lambda:
p24987
aVIn python 2,  will try and process all elements of the input iterable
p24988
aVChange that to use  and everything works:
p24989
as(dp24990
g16
V100297
p24991
stp24992
a((dp24993
g2
(lp24994
V means indefinite, the result of a floating point equation that doesn't have a solution
p24995
aVOn other platforms, you'd get  instead, meaning 'not a number',  is specific to Windows
p24996
aVOn Python 2
p24997
aV5 on Linux I get:
p24998
aVYou'll only find this on python versions 2
p24999
aV5 and before, on Windows platforms
p25000
aVThe  code was improved in python 2
p25001
aV6 and consistently uses  for such results; mostly because there was no way to turn  and  back into an actual  instance again:
p25002
aVOn versions 2
p25003
aV6 and newer this has all been cleaned up and made consistent:
p25004
as(dp25005
g16
V100297
p25006
stp25007
a((dp25008
g2
(lp25009
VYou set  to a list; you cannot have both a function and a list use the same name:
p25010
aVmasking the function
p25011
aVYou even use  as a list again on the very next line
p25012
aVRename the list, or rename the function
p25013
aVMost of all, pick better, clearer names for your variables
p25014
as(dp25015
g16
V100297
p25016
stp25017
a((dp25018
g2
(lp25019
VYou can't
p25020
aVA value has no way to know what variable refers to it
p25021
aVThe reason is quite simple; you can have multiple variables refer to the same value:
p25022
aVNow what name does the instance have
p25023
as(dp25024
g16
V100297
p25025
stp25026
a((dp25027
g2
(lp25028
VEach  has an attribute  that is a dictionary; simply use it's mapping methods to ask it for it's keys or values:
p25029
aVor
p25030
aVor use  or any of the other methods available on a python
p25031
aVTo get an individual attribute, use the standard subscription syntax:
p25032
as(dp25033
g16
V100297
p25034
stp25035
a((dp25036
g2
(lp25037
VNo, you cannot do this in pure python
p25038
aVYou can use properties to mark your attributes as read-only though; using underscore-prefixed 'private' attributes instead:
p25039
aVThe above code only specifies a getter for the property; Python will not let you set a value for  now:
p25040
aVOf course, you can still access the 'private'  attribute from outside:
p25041
aVYou could use the double underscore convention, where attribute names with  at the start (but not at the end
p25042
aVare renamed on compilation
p25043
aVThis is not meant for making a attribute inaccessible from the outside, it's intent is to protect an attribute from being overwritten by a subclass instead
p25044
aVYou can still access those attributes:
p25045
as(dp25046
g16
V100297
p25047
stp25048
a((dp25049
g2
(lp25050
VJust return the test:
p25051
aVbecause the result of a  lower than operator is already a boolean
p25052
aVYou do not need to give a starting value either
p25053
aVNote that you need to use lower than if you want  to be returned for a given percentage; if  then you want  all of the time, e
p25054
ag1298
aVwhen all values that  produces are below the  value
p25055
as(dp25056
g16
V100297
p25057
stp25058
a((dp25059
g2
(lp25060
VYou cannot use  and  in a nested function
p25061
aVUse the return value of the function instead:
p25062
aVNote that there is little point in defining your functions in the loop
p25063
aVDefine them before the loop, as creating the function object takes some performance (albeit a small amount)
p25064
aVThe  function needs no arguments (you didn't use them at all), and the  is also not needed
p25065
aVIf you didn't break out of the loop, it'll just continue from the top when you reach the end
p25066
aVYou only need  if you want the loop to start at the top again skipping the rest of the code in the loop:
p25067
as(dp25068
g16
V100297
p25069
stp25070
a((dp25071
g2
(lp25072
V does not mean  is either  or , it means  instead, so test both  as a boolean, and test  as a boolean and then the whole expression is  if the first or the second part is
p25073
aVSince the first is a string of length greater than 0, it'll always be , and the second test is never made:
p25074
aVUse:
p25075
aVinstead, or:
p25076
aVor:
p25077
aVall of which test for the same thing
p25078
aVThis applies to all your  statements testing against upper and lowercase letters, such as , and
p25079
aVAs for your long list of  tests; just use a mapping to map letter to number:
p25080
aVNow you can use  to map to an index:
p25081
as(dp25082
g16
V100297
p25083
stp25084
a((dp25085
g2
(lp25086
VGenerator expressions to the resque:
p25087
aVSo, loop over all  dictionaries, and find the first one that matches the  you are looking for
p25088
aVThis loop stops as soon as a match is found
p25089
as(dp25090
g16
V100297
p25091
stp25092
a((dp25093
g2
(lp25094
VUse :
p25095
aVThis creates a  where the default value is a set, then loop and add the values for each key
p25096
aVIf you wanted a list instead, simply change the default type and how you add values to match the  interface:
p25097
aVSets are a better idea when you want to test for membership (); such tests take constant time, vs
p25098
aVlinear time for a list (so set membership tests take a fixed amount of time independent of the size of the set, while for lists it takes more time, proportional to the number of elements in the list)
p25099
as(dp25100
g16
V100297
p25101
stp25102
a((dp25103
g2
(lp25104
VYou are mixing generator expressions with a for loop
p25105
aVYou can't do that
p25106
aVPut the  statement on it's own line:
p25107
aVNote that you do not need to test for ; that's exactly what the  statement does already
p25108
as(dp25109
g16
V100297
p25110
stp25111
a((dp25112
g2
(lp25113
VYou'll have to resort to  I am afraid, that's the only option you have to make this work
p25114
aVUsing encoding to  then decode again from ASCII would have been nice, if it worked:
p25115
aVThis does the right thing with paths:
p25116
aVbut not with existing non-ASCII characters because  does not process  or  escapes
p25117
aVDon't use  to escape special characters in a string, that escapes a little too much:
p25118
aVnote the  there
p25119
aVOnly  results in a working replacement pattern, including non-ASCII characters:
p25120
as(dp25121
g16
V100297
p25122
stp25123
a((dp25124
g2
(lp25125
VUse the  parameter to  or the  function to provide a value to sort on
p25126
aVwhere  takes one argument (the value to be transformed)
p25127
aVThe list will then be sorted based on the return value of the  parameter, but the original values are themselves left untouched
p25128
aVFor your problem, you can then use:
p25129
aVwhich would transform  to  and  to , causing  or  to sort  before :
p25130
aVSee the Python Sorting HOWTO for more details and tips (use this Google cache link until  has recovered from the recent security exploit)
p25131
as(dp25132
g16
V100297
p25133
stp25134
a((dp25135
g2
(lp25136
VYou cannot do this with a property; you either have to use a , or create your own descriptor for that:
p25137
aVI'm abusing the  decorator here; it implements  and  as well, but we can just ignore those here for convenience sake
p25138
aVThen use that instead of :
p25139
aVNow accessing  works:
p25140
as(dp25141
g16
V100297
p25142
stp25143
a((dp25144
g2
(lp25145
VYou are running stale byte-code, remove the  files and rerun your code
p25146
aVThe traceback reads the source from the  file but is built from the bytecode, and the fact that is shows that the error is on a line that only consists of a comment is a hint that things are no longer in sync
p25147
aVNormally, Python will clean up the  file when stale, but only if the  modification time is newer
p25148
as(dp25149
g16
V100297
p25150
stp25151
a((dp25152
g2
(lp25153
VWhen using AJAX, your browser is not requesting a page to display
p25154
aVA redirect is merely pointing the client to a different URL to get the response from, and when doing that with AJAX, the browser simply gets the AJAX response from the new location instead
p25155
aVIf you were loading a page, the redirect means that the data is simply loaded from another location instead
p25156
aVIn other words, a response to an AJAX request is never going to change the browser page in and off itself
p25157
aVYou'll need to do that with JavaScript code instead
p25158
aVReturn a URL from your POST handler, then use
p25159
as(dp25160
g16
V100297
p25161
stp25162
a((dp25163
g2
(lp25164
VYou need to use the  property instead, see the  documentation:
p25165
as(dp25166
g16
V100297
p25167
stp25168
a((dp25169
g2
(lp25170
VYou cannot use  as keyword argument in that case; it cannot be interpreted as both a positional and a keyword argument, Python interprets it as a keyword argument in this case
p25171
aVUse
p25172
aVinstead
p25173
aVFunctions act as descriptors; when looked up on an instance, they get wrapped in a new object called a method, which automatically adds the instance as a first argument to the function when called
p25174
aVThis wrapper essentially does this:
p25175
aVYour  keyword argument is then lumped under the  catchall and passed on to the underlying function, with  left empty
p25176
aVBut the  method you defined has one positional argument (next to , and thus an exception is raised
p25177
as(dp25178
g16
V100297
p25179
stp25180
a((dp25181
g2
(lp25182
VI'd use  instead:
p25183
aVor, since you tagged this with python-3
p25184
aV3 you could use the new  syntax (look ma, no imports
p25185
ag4212
aVwhich both return iterators (use  on them if you must materialize the full list)
p25186
aVMost of the time you do not need to a sequence of concatenate sequences, really, you just want to loop over them to process and/or search for something instead
p25187
aVNote that for strings, you should use  instead of any of the techniques described either in my answer or your question:
p25188
aVCombined, to handle sequences fast and correct, I'd use:
p25189
aVThis works for tuples, lists and strings:
p25190
aVand uses the faster  for a sequence of strings
p25191
as(dp25192
g16
V100297
p25193
stp25194
a((dp25195
g2
(lp25196
VUse the  call convention:
p25197
aVThis works on any callable that takes keyword arguments:
p25198
aVor you could just call the function with keyword arguments:
p25199
aVYour error is unrelated, you didn't define , you probably meant to make that a string:
p25200
as(dp25201
g16
V100297
p25202
stp25203
a((dp25204
g2
(lp25205
VYou need to tell  explicitly to actually write the changes, using the  switch:
p25206
as(dp25207
g16
V100297
p25208
stp25209
a((dp25210
g2
(lp25211
VNormally, all data sent over HTTP is just bytes, or strings of characters
p25212
aVYou'll need to use a format that can handle lists
p25213
aVJSON is such a format, and flask supports that directly, provided you actually POST JSON data from your AJAX call:
p25214
aVwhich assumes you posted the JavaScript structure:
p25215
as(dp25216
g16
V100297
p25217
stp25218
a((dp25219
g2
(lp25220
VGiven a series of indices, you can simply loop over them all except for the last one to traverse your nested structure to the parent list to insert into:
p25221
aVYou can add a ,  combo to detect that you got your index wrong:
p25222
aVbut personally, I'd rather get an exception than having it swallowed and discarded like that
p25223
aVNote that you should not return  from your function, as it is altered in-place
p25224
aVPython stdlib methods like  and , that modify a list in-place don't return anything either
p25225
as(dp25226
g16
V100297
p25227
stp25228
a((dp25229
g2
(lp25230
VThere is a delay between file opening and file data being flushed to disk, so if you are watching for a file creation event, you can easily return what is essentially still an empty file
p25231
aVYou need to either change your notification to listen for changes instead of new files, or make sure that new files are fully formed
p25232
aVTo do the latter, change the external process to create the file in a different location, then move the file when the image has been created into the location you are watching
p25233
aVIf the two locations are on the same partition, the move will be atomic; if your file monitoring sees the file appear it's guaranteed that it'll be non-empty at that point
p25234
aVOr, pseudo-python-code, in your separate process:
p25235
aVAnd watch
p25236
as(dp25237
g16
V100297
p25238
stp25239
a((dp25240
g2
(lp25241
VUse the proper tool for  the job, you are not parsing JSON but Python, so use  instead:
p25242
as(dp25243
g16
V100297
p25244
stp25245
a((dp25246
g2
(lp25247
VA  loop in python loops over a series of values provided by the expression after
p25248
aVIn Python we use the term  for anything that can produce such a series
p25249
aVThat can be a , but it could be anything that can be iterated over (looped over)
p25250
aVThe loop variable  receives the next value on each iteration, whatever value there was before
p25251
aVThus, the following is legal:
p25252
aVbut the  essentially does nothing
p25253
aVYou'd have to approach it differently; skip those values instead:
p25254
aVEvery time you ask the user for an increase, we update the value  to be the sum of the current value of  plus that increase, and then proceed to ignore most of the loop body until  catches up with
p25255
as(dp25256
g16
V100297
p25257
stp25258
a((dp25259
g2
(lp25260
VUse string formatting instead:
p25261
aVString formatting automatically transforms integers to string when interpolating the values, and is more readable than
p25262
as(dp25263
g16
V100297
p25264
stp25265
a((dp25266
g2
(lp25267
VYes, don't create so many copies
p25268
aVJust reference the subdict:
p25269
aVAs long as you are not altering the  dict, making a copy is pointless
p25270
aVSince you discard the previous copy and make a new one on every iteration, you are wasting CPU time as well as memory
p25271
aVEven if you did have to modify  and don't want those changes to affect , you only need to copy the final  value after looping
p25272
as(dp25273
g16
V100297
p25274
stp25275
a((dp25276
g2
(lp25277
VYou can pickle any python class instance, as long as the  module can import it again when you load the pickle
p25278
aVIt doesn't matter where in your python code you use  or , it only matters if the data that you are going to pickle can be retrieved again later on, by importing them from the same location
p25279
aVSo, if you have a module  with a class  in it, then as long as you can do  you can pickle instances of that class, because  can later on load that class again from the same module
p25280
as(dp25281
g16
V100297
p25282
stp25283
a((dp25284
g2
(lp25285
V is itself already wrapped by your decorator
p25286
aVThe name  no longer points to the original method, it now points to the return value of :
p25287
aVThat's because the  syntax is the same as:
p25288
aVSo  is already producing the lines , then , then
p25289
aVNow you wrap that again
p25290
aVThe wrapper prints , calls the wrapped  (itself already wrapped), which prints , then , then , and then the wrapper prints
p25291
aVIn a diagram:
p25292
as(dp25293
g16
V100297
p25294
stp25295
a((dp25296
g2
(lp25297
VYou have your patterns and text-to-search mixed up
p25298
aVYou are looking for  in text , and the latter is not nearly long enough
p25299
aV:-)
p25300
aVIf you reversed the two (pattern , text ) things work:
p25301
as(dp25302
g16
V100297
p25303
stp25304
a((dp25305
g2
(lp25306
VThe  python module includes an extension written in C
p25307
aVThat extension cannot be loaded, because another C library that it is depending on is missing
p25308
aVCheck that you still have the PostgreSQL client libraries installed, and that  can find it
p25309
aVNote that if you run Django in a WSGI server, you need to have set the  environment variable before the WSGI server starts
p25310
aVAlternatively, recompile the  extension with  to 'hardcode' the path to the PostgreSQL client library at linking time, removing the need to set
p25311
aVA last resort would be to add the  path to , see the  manpage
p25312
as(dp25313
g16
V100297
p25314
stp25315
a((dp25316
g2
(lp25317
VBase the path off the  variable:
p25318
as(dp25319
g16
V100297
p25320
stp25321
a((dp25322
g2
(lp25323
VThe  method removes one (arbitrary) item from the  dictionary and returns that as a  tuple
p25324
aVThis is then assigned to two variables,  and
p25325
aVIn this case it means the class takes one keyword argument (one of , ,  or ) and if you specify more than one it'll complain (throw a ) after having looked at one of the keyword arguments you passed in
p25326
aVand  are special methods used by python when looking up attributes
p25327
aVtranslates to , and  translates to
p25328
aVSo, setting one of ,  or  to an integer is routed to the  method, which then uses the  mapping to calculate and set  instead
p25329
aVLooking up one of ,  or  is routed to the  method, which then returns a value based on the  mapping together with the existing value of  to give you a temperature in the requested scale
p25330
as(dp25331
g16
V100297
p25332
stp25333
a((dp25334
g2
(lp25335
VIf there are arbitrary spaces after the commas, just strip the whitespace using a list comprehension:
p25336
aVor use a regular expression split (somewhat overkill in this situation):
p25337
aVDemonstration:
p25338
as(dp25339
g16
V100297
p25340
stp25341
a((dp25342
g2
(lp25343
VThe  function returns the type of an object
p25344
aVYou could use  to diagnose what type of object  is in this case
p25345
as(dp25346
g16
V100297
p25347
stp25348
a((dp25349
g2
(lp25350
VThe  operator takes a tuple itself, so you are basically doing this:
p25351
aVWrap  in a one-element tuple:
p25352
aVIn principle you can use a string defined in a variable too:
p25353
aVin which case you want to leave it up to that variable (perhaps taken from a configuration file
p25354
aVhow to format , be it  or
p25355
aVYou could also use the  method instead:
p25356
aVThis format gives you more flexibility with the input given; you could address individual items in the  tuple, for example:
p25357
aVwhich would result in  for your example input
p25358
as(dp25359
g16
V100297
p25360
stp25361
a((dp25362
g2
(lp25363
VUse the  method:
p25364
as(dp25365
g16
V100297
p25366
stp25367
a((dp25368
g2
(lp25369
V is a new class added to Python 2
p25370
aV7, so it is missing in your case
p25371
aVYou can install a backport:
p25372
aVor add that as a dependency in your buildout, and edit  line 21 to change the import from:
p25373
aVto
p25374
aVI have filed an issue in the funnelweb issue tracker to request that this is added to a future release of the package, see issue 22
p25375
as(dp25376
g16
V100297
p25377
stp25378
a((dp25379
g2
(lp25380
VUse a  with a generator expression:
p25381
aVThe generator expression creates  2-value tuples; this works in both 2
p25382
aV6 and 2
p25383
aV7 (or python 3, for that matter)
p25384
as(dp25385
g16
V100297
p25386
stp25387
a((dp25388
g2
(lp25389
VNo, you are not misinterpreting it
p25390
aVIt's the package structure of this particular project
p25391
aVWhen you import , you import a special python file  in a directory , that has inside of it another package called
p25392
aVBut if  itself doesn't import the nested package into it's  file, you cannot use attribute traversal to get to that nested package
p25393
aVThe solution is to import the nested package explicitly, yourself:
p25394
as(dp25395
g16
V100297
p25396
stp25397
a((dp25398
g2
(lp25399
VCall  on it:
p25400
aVor just use  instead:
p25401
as(dp25402
g16
V100297
p25403
stp25404
a((dp25405
g2
(lp25406
V does much more than look up
p25407
aVFirst of all,  is a API method that knows how to use attributes like  to look up attributes of an object
p25408
aVNot all objects have a  attribute though
p25409
aVFor example, if you were to add a  attribute to your custom class, instances of that class won't have a  attribute, yet  can still list the available attributes on those instances:
p25410
aVThe same applies to many built-in types; s do not have a  attribute, but you can still list all the attributes using :
p25411
aVWhat  does with instances
p25412
aVPython instances have their own , but so does their class:
p25413
aVThe  method uses both these  attributes, and the one on  to create a complete list of available attributes on the instance, the class, and on all ancestors of the class
p25414
aVWhen you set attributes on a class, instances see these too:
p25415
aVbecause the attribute is added to the class :
p25416
aVNote how the instance  is left empty
p25417
aVAttribute lookup on Python objects follows the hierarchy of objects from instance to type to parent classes to search for attributes
p25418
aVOnly when you set attributes directly on the instance, will you see the attribute reflected in the  of the instance, while the class  is left unchanged:
p25419
aVTLDR; or the summary
p25420
aVdoesn't just look up an object's  (which sometimes doesn't even exist), it will use the object's heritage (it's class or type, and any superclasses, or parents, of that class or type) to give you a complete picture of all available attributes
p25421
aVAn instance  is just the 'local' set of attributes on that instance, and does not contain every attribute available on the instance
p25422
aVInstead, you need to look at the class and the class's inheritance tree too
p25423
as(dp25424
g16
V100297
p25425
stp25426
a((dp25427
g2
(lp25428
VUse :
p25429
aVWhen summing a  and a , only the  attribute is used
p25430
as(dp25431
g16
V100297
p25432
stp25433
a((dp25434
g2
(lp25435
VYou need to separate the search for the  value from the search through the rest of you data
p25436
aVYou really want to do that when you are already building , to avoid unnecessary loops:
p25437
aVNext, removing the dupe values is easiest using  to alter the sets in-place:
p25438
aVUsing your example , and presuming that  has already been set while building , the result of the second loop is:
p25439
aVNote how the values ,  and  have been removed from the  set
p25440
as(dp25441
g16
V100297
p25442
stp25443
a((dp25444
g2
(lp25445
VUnfortunately,  namespace support is rather patchy
p25446
aVYou'll need to use an internal method from the  module to get a namespace map out:
p25447
aVis now a dict with URIs as keys, and prefixes as values
p25448
aVYou could switch to  instead
p25449
aVThat library implements the same ElementTree API, but has augmented that API considerably
p25450
aVFor example, each node includes a  attribute which maps prefixes to URIs, including the default namespace under the key
p25451
as(dp25452
g16
V100297
p25453
stp25454
a((dp25455
g2
(lp25456
VYou do not need to create an instance; return the MyTestCase class itself:
p25457
as(dp25458
g16
V100297
p25459
stp25460
a((dp25461
g2
(lp25462
VSure there is, use the right tool for the job and ask the  module to decode the data to Python ; then encode the result to UTF-8:
p25463
aVUse  only for actual Python string literals
p25464
aVJSON strings are not the same as Python strings, even though they may, at first glance, look very similar
p25465
aVShort demo (take into account the python interactive interpreter echoes strings as literals):
p25466
aVNote that the JSON decoder decodes  on  just like a python literal would
p25467
aVIf you absolutely have to only process the  unicode literals in the JSON input but leave the rest intact, then you need to resort to a regular expression:
p25468
aVwhich gives:
p25469
as(dp25470
g16
V100297
p25471
stp25472
a((dp25473
g2
(lp25474
V returns the root logger instance, there is no further 'up' from that object, and there is nothing else to attach a handler to beyond the root
p25475
aVThe module-level functions like  use the root logger; quoting from the documentation:
p25476
aVLogs a message with level ERROR on the root logger
p25477
aVThe arguments are interpreted as for debug()
p25478
aVIn other words, functions like  simply call
p25479
aVAttaching your  to the root logger is the correct way to add it to the module
p25480
as(dp25481
g16
V100297
p25482
stp25483
a((dp25484
g2
(lp25485
VThe original name of a function is stored in the  attribute:
p25486
aVYou can find interesting bits of information like this in the datamodel documentation, and a lot of that information is also summarized in the documentation for the  module
p25487
aVYou may also want to take a look at the  decorator, which updates a wrapper function (often used in decorators) with attributes from the original, wrapped function, including it's name and it's documentation string
p25488
as(dp25489
g16
V100297
p25490
stp25491
a((dp25492
g2
(lp25493
VYou are confusing  and
p25494
aVIn a function scope,  lists only names defined in the function itself
p25495
aVUse  instead
p25496
as(dp25497
g16
V100297
p25498
stp25499
a((dp25500
g2
(lp25501
VThe  object you get from the request is already an open file(like) object
p25502
aVIf you look closely at the example in the documentation you linked to, it creates a new file using the filename of the upload, and uses the uploaded file to write data to that new file
p25503
aVis never opened in that code, only  is (note the different variable name there)
p25504
aVYou do not need to close the file object either, so no  is needed
p25505
aVYour code can be simplified to:
p25506
aVI personally would not use  for this though, you are reading the whole file into the  buffer while building vertices
p25507
aVInstead, I'd use a single loop:
p25508
aVNow only one line at a time is kept in memory (plus the vertices and normals structure)
p25509
aVNote: If you get a  error message, then the view did not receive a  HTTP request
p25510
aVDo double check your form method is set to  (case does not matter)
p25511
as(dp25512
g16
V100297
p25513
stp25514
a((dp25515
g2
(lp25516
VNo, there isn't
p25517
aVChameleon templates are not meant to implement complex logic; the original Zope Page Template philosophy is to leave all the business logic up to Python code, and the template has just enough power to turn the information generated into a presentation, and nothing more
p25518
aVThis is why Chameleon doesn't give you anything more than a for loop; it's not the responsibility of the template to traverse complex structures, its responsibility is limited to creating a representation of already-processed data
p25519
as(dp25520
g16
V100297
p25521
stp25522
a((dp25523
g2
(lp25524
VIt is already in memory
p25525
aVLoading a pickle returns a python structure
p25526
aVMoreover, a  object is a in-memory file-like object, not a Python object structure
p25527
aVYou cannot take the in-memory representation of a python structure and 'write' it into memory, you instruct the Python interpreter to construct those objects for you (which is what the  module does for you)
p25528
aVLast but not least, you really should avoid using  to close files
p25529
aVFile objects that are still open when Python exits are automatically closed
p25530
aVEven if Python doesn't this for some reason, the OS would do it anyway
p25531
as(dp25532
g16
V100297
p25533
stp25534
a((dp25535
g2
(lp25536
VThe Produce-and-publish set of components does indeed require the server to be set up
p25537
aVThe Plone product you installed is merely the integration point between Plone and that server
p25538
aVPlease to follow the instructions on http://docs
p25539
aVproduce-and-publish
p25540
aVcom/server/installation
p25541
aVhtml to install that separate server (it can have it's own buildout)
p25542
aV(If you run into problems with that installation, feel free to ask a new question here on Stack Overflow, or ask on the Plone Users mailinglist, or contact the author (which may require you to pay Zopyx for such support))
p25543
as(dp25544
g16
V100297
p25545
stp25546
a((dp25547
g2
(lp25548
VTwo things are wrong:
p25549
aVYou cannot create a generator expression without parenthesis around it
p25550
aVSimply putting  is invalid syntax for python
p25551
aVThe  string formatting operator requires a tuple, a mapping or a single value (that is not a tuple or a mapping) as input
p25552
aVA generator is not a tuple, it would be seen as a single value
p25553
aVEven worse, the generator expression would not be iterated over:
p25554
aVSo the following would work:
p25555
aVNote that your generator expression doesn't actually transform the words or make a selection from the  list, so it is redundant here
p25556
aVSo the simplest thing is to just cast the list to a  instead:
p25557
as(dp25558
g16
V100297
p25559
stp25560
a((dp25561
g2
(lp25562
VLookups in lists and tuples are always inefficient; use a  instead:
p25563
aVTesting for membership in a set is constant cost (O(1)), while list and tuple membership tests have linear cost (O(n))
p25564
as(dp25565
g16
V100297
p25566
stp25567
a((dp25568
g2
(lp25569
VYou have run into a bug, yes
p25570
aVI've filed this as an issue in the  issue tracker, see issue #3
p25571
aVThe  method was given an extra parameter but the call on line 155 was never updated to provide that extra parameter
p25572
aVYou should be able to fix this yourself by editing the file  and change line 155 from:
p25573
aVto
p25574
as(dp25575
g16
V100297
p25576
stp25577
a((dp25578
g2
(lp25579
VUse a :
p25580
aVNote that what you describe is a simple nested structure; you can also build it without using  but that class makes it all the easier to do so
p25581
as(dp25582
g16
V100297
p25583
stp25584
a((dp25585
g2
(lp25586
VI'd split the lines up by the first  and strip the results:
p25587
aVwhich outputs the following mapping:
p25588
as(dp25589
g16
V100297
p25590
stp25591
a((dp25592
g2
(lp25593
VYou are looking for a test for a range of codepoints, so you need a regular expression:
p25594
aVThis will return  for any unicode text that has codepoints past  ("")
p25595
as(dp25596
g16
V100297
p25597
stp25598
a((dp25599
g2
(lp25600
VYou can attach a new handler on a child logger, that has it's own formatter
p25601
aVYou should be able to create a handler that writes to the same file as the root handler, as the flush operation uses a lock
p25602
as(dp25603
g16
V100297
p25604
stp25605
a((dp25606
g2
(lp25607
VYou probably have a local file named  that is being imported instead
p25608
aVCheck with:
p25609
aVand rename or delete that file
p25610
as(dp25611
g16
V100297
p25612
stp25613
a((dp25614
g2
(lp25615
VYour  XPath expression failed to find any elements
p25616
aVCheck that expression for errors
p25617
as(dp25618
g16
V100297
p25619
stp25620
a((dp25621
g2
(lp25622
VYou did not specify a source to funnel from
p25623
aVThe error is thrown because there is no site url to crawl and upload
p25624
aVTry:
p25625
as(dp25626
g16
V100297
p25627
stp25628
a((dp25629
g2
(lp25630
VYou cannot use regular s as query parameters
p25631
aVUse a  instead:
p25632
aVThis makes  (so on the attribute on the class) useful in SQL expressions
p25633
as(dp25634
g16
V100297
p25635
stp25636
a((dp25637
g2
(lp25638
VYou do not get an exception, because you are always enter a string when using
p25639
aVThus  on the return value of  will never fail
p25640
aVInstead, add an  statement to your  or  tests:
p25641
aVNote that you should never use a blanket  statement; catch specific exceptions
p25642
aVOtherwise, you'll mask unrelated problems, making it harder for you to find those problems
p25643
aVYour first except handler should only catch ,  and  for example:
p25644
aVas that's what  would throw
p25645
aVAlso note that  takes any python expression
p25646
aVIf I enter  (with the quotes), no exception would be raised, but it is not a number either
p25647
aVUse  instead, and then catch  (what would be thrown if you entered anything that's not an integer) and  for :
p25648
aVTo use the second loop to control the first, make it a function that returns  or :
p25649
aVand in the other loop:
p25650
as(dp25651
g16
V100297
p25652
stp25653
a((dp25654
g2
(lp25655
VPython already tracks imported modules, in
p25656
aVEach key is a imported module name (and not the alias under which it was imported), each value is the actual module object with the global namespace for that module:
p25657
as(dp25658
g16
V100297
p25659
stp25660
a((dp25661
g2
(lp25662
VYou forgot to close the parenthesis on the preceding line:
p25663
aVNote that there should be two  there
p25664
aVWhen in doubt about a syntax error in Python, always check the line before
p25665
aVPython allows you to group multiple expressions into a tuple, a generator expression or a call, across multiple lines, and there is no way for Python to know you simply forgot to close the parenthesis until the next line
p25666
as(dp25667
g16
V100297
p25668
stp25669
a((dp25670
g2
(lp25671
VYou loop over all the values of the dict:
p25672
aVPerhaps you meant to pick the one that is affected instead
p25673
aVIn other words, you do not need a loop here at all
p25674
aVNote that, whenever you find yourself using a sequential series of numbers as keys to a dictionary, you may as well make it a list instead:
p25675
aVexcept now the indexes run from 0 to 11, so use  to find the right body part:
p25676
as(dp25677
g16
V100297
p25678
stp25679
a((dp25680
g2
(lp25681
VYou either create a temporary file, or you'll have to read the whole file into memory and pipe it to your command
p25682
as(dp25683
g16
V100297
p25684
stp25685
a((dp25686
g2
(lp25687
VClosure cells refer to values needed by the function but are taken from the surrounding scope
p25688
aVWhen Python compiles a nested function, it notes any variables that it references but are only defined in a parent function (not globals) in the code objects for both the nested function and the parent scope
p25689
aVThese are the  and  attributes on the  objects of these functions, respectively
p25690
aVThen, when you actually create the nested function (which happens when the parent function is executed), those references are then used to attach a closure to the nested function
p25691
aVA function closure holds a tuple of cells, one each for each free variable (named in ); cells are special references to local variables of a parent scope, that follow the values those local variables point to
p25692
aVThis is best illustrated with an example:
p25693
aVIn the above example, the function  has one closure cell, which points to  in the function
p25694
aVThe cell follows the value of
p25695
aVMore importantly, once  completes and  is returned, the cell continues to reference the value (the string ) even though the variable  inside  no longer exists
p25696
aVThus, the above code outputs:
p25697
aVand  is
p25698
aVNote that the closure is dereferenced when  is called; the closure doesn't capture the value here
p25699
aVThat makes a difference when you produce nested functions (with  expressions or  statements) that reference the loop variable:
p25700
aVThe above will print  three times in a row, because all three  functions reference the  variable, not the value it was bound to when the function object was created
p25701
aVBy the time the  loop finishes,  was bound to , so all three closures will resolve to that value
p25702
as(dp25703
g16
V100297
p25704
stp25705
a((dp25706
g2
(lp25707
VThe  loop listens for  explicitly
p25708
aVThe purpose of the  statement is to loop over the sequence provided by an iterator and the exception is used to signal that the iterator is now done;  doesn't catch other exceptions raised by the object being iterated over, just that one
p25709
aVA generator function is a special kind of iterator; it indeed raises  when the function is done (i
p25710
ag7233
aVwhen it returns, so yes,  raises )
p25711
aVIt is a requirement of iterators; they must raise  when they are done; in fact, once a  has been raised, attempting to get another element from them (through , or calling the  (py 2) or  (py 3) method on the iterator) must always raise  again
p25712
aVis an exception to communicate in the other direction
p25713
aVYou are explicitly closing a generator with a  expression, and the way Python communicates that closure to the generator is by raising  inside of that function
p25714
aVYou explicitly catch that exception inside of , it's purpose is to let a generator clean up resources as needed when closing
p25715
aVA  is not propagated to the caller; see the  documentation
p25716
as(dp25717
g16
V100297
p25718
stp25719
a((dp25720
g2
(lp25721
VThe  constructuctor expects pairs of  and  values, not one string:
p25722
aVThe pairs can be specified in different ways, or you need to provide a  argument (which is a websafe-base64-encoded serialized reference)
p25723
as(dp25724
g16
V100297
p25725
stp25726
a((dp25727
g2
(lp25728
VYou can just use  for the character length
p25729
aVYou can split  by lines using the  method, and length of that result is the number of lines
p25730
aVBut, a better approach would be to read the file line by line:
p25731
aVNow the program will work even if the file is very large; it won't hold more than one line at a time in memory (plus a small buffer that python keeps to make the  loop a little faster)
p25732
as(dp25733
g16
V100297
p25734
stp25735
a((dp25736
g2
(lp25737
VNo, you placed a  statement inside of the outer  loop
p25738
aVAt the end of the first iteration, you exit the function
p25739
aVThat's what a  statement does; it ends the function regardless of what loop construct you are currently executing
p25740
aVRemove the  statement and the loop will continue to run all the way to
p25741
as(dp25742
g16
V100297
p25743
stp25744
a((dp25745
g2
(lp25746
VYou cannot use assignments in a expression, and a  only takes an expression
p25747
aVYou can store lambdas in dictionaries just fine otherwise:
p25748
aVThe above  of course only returns the result, it won't alter  in-place
p25749
as(dp25750
g16
V100297
p25751
stp25752
a((dp25753
g2
(lp25754
VJust read the lines of the file into a list and use :
p25755
aVThe  call removes all whitespace from the start and end of the line, in this case the newline
p25756
aVUsing a comma with the  statement does more than just omit the newline, it also prints a space between the arguments
p25757
as(dp25758
g16
V100297
p25759
stp25760
a((dp25761
g2
(lp25762
VThere are two major differences between them:
p25763
aVDictionaries are unordered, a list of tuples is
p25764
aVSo if ordering matters, use the latter
p25765
aVMapping a key to a value takes constant time in a dict, doing the same in a list of tuples takes linear time
p25766
aVSo, the larger your amount of key-value pairs, the more time it'll take to scan the list of tuples to find a match, while in a dictionary the lookup is near-instant, always
p25767
aV(If your tuples are kept in sorted order, you can reduce search time to O(log n) by using binary search; but that's still slower than constant time for dictionaries)
p25768
aVIn most cases, you use a
p25769
aVEven if ordering is required, you can use a  instead to get the best of both worlds
p25770
as(dp25771
g16
V100297
p25772
stp25773
a((dp25774
g2
(lp25775
VI'd not use minidom for this task; the DOM API is very cumbersome, verbose, and not suited for searching and matching
p25776
aVThe Python library also includes the  API, I'd use that instead:
p25777
aVThe above piece of code counts the number of passed and failed tests per  element and stores them in a dictionary, keyed to the  attribute of the  element
p25778
aVI've tested the above code with Python 3
p25779
aV2 and the full XML document from another question you posted, which results in:
p25780
as(dp25781
g16
V100297
p25782
stp25783
a((dp25784
g2
(lp25785
VYou are looping over the list of characters, and  is thus a character
p25786
aVYou then try to store that back into  using the  character as an index
p25787
aVThat won't work
p25788
aVUse  to get indexes and the values:
p25789
aVYou can simplify this with a generator expression:
p25790
aVBut now you'll note that your  won't work; the ASCII codepoints start after 26:
p25791
aVYou'll need to use the  value to be able to use a modulus instead; subtracting puts your values in the range 0-25, and you add it again afterwards:
p25792
aVbut that will only work for lower-case letters; which might be fine, but you can force that by lowercasing the input:
p25793
aVIf we then move asking for the input out of the function to focus it on doing one job well, this becomes:
p25794
aVand using this on the interactive prompt I see:
p25795
aVOf course, now punctuation is taken along
p25796
aVLast revision, now only shifting letters:
p25797
aVand we get:
p25798
as(dp25799
g16
V100297
p25800
stp25801
a((dp25802
g2
(lp25803
VThe  call is slowing things down; repeated writing to the same directory is perhaps thrashing OS disk caches
p25804
aVWhen you removed the call, the OS was able to optimize the image read access times via disk caches
p25805
aVIf your machine has multiple CPU cores, you can indeed speed up the resize process, as the OS will schedule multiple sub-processes across those cores to run each resize operation
p25806
aVYou'll not get a linear performance improvement, as all those processes still have to access the same disk for both reads and writes
p25807
as(dp25808
g16
V100297
p25809
stp25810
a((dp25811
g2
(lp25812
VNo, you can't do that
p25813
aVFor your usecase, use a tuple instead:
p25814
aVSince you don't need to do date manipulations on the value a tuple more than suffices
p25815
as(dp25816
g16
V100297
p25817
stp25818
a((dp25819
g2
(lp25820
VBy catching all  exceptions, and re-raising it if the  attribute is not equal to 111
p25821
aVOr, better yet, use the  constant instead:
p25822
as(dp25823
g16
V100297
p25824
stp25825
a((dp25826
g2
(lp25827
VFirst of all, give your functions better names
p25828
aVThen use a mapping:
p25829
aVBecause Python functions are first-class citizens you can store them in a python dictionary, use a key to look them up, then call them
p25830
as(dp25831
g16
V100297
p25832
stp25833
a((dp25834
g2
(lp25835
VThe value is not an integer but a string
p25836
aVConvert it first:
p25837
aVMultiplying a python string means you want to repeat it:
p25838
aVThe URL regular expression matches digits, but that doesn't auto-magically turn the resulting value into an integer
p25839
as(dp25840
g16
V100297
p25841
stp25842
a((dp25843
g2
(lp25844
VYou'll have to implement your own Formatter subclass that truncates the path for you; the formatting string cannot do this:
p25845
aVUse this class instead of the normal  instance:
p25846
as(dp25847
g16
V100297
p25848
stp25849
a((dp25850
g2
(lp25851
VThe statements are exactly identical, and I was not able to reproduce your problem:
p25852
as(dp25853
g16
V100297
p25854
stp25855
a((dp25856
g2
(lp25857
VYou need to decode the page from UTF-8 to Unicode; there are UTF-8 sequences in there (next to non-breaking-space HTML entities):
p25858
aVYou got encoding and decoding confused; the content is already UTF-8 encoded
p25859
aVNote that the  is an error in the page itself, the  was omitted
p25860
aVA HTML5 parser or browser would probably assume that the  can be added and decode it anyway:
p25861
aVYou'd have to fix those entities with a regular expression first:
p25862
as(dp25863
g16
V100297
p25864
stp25865
a((dp25866
g2
(lp25867
VYour function is not returning anything; it is calling the question function again and again, but ignores the return value:
p25868
aVIf month is smaller than 1 or greater than 12 the function will return  (the default)
p25869
aVThe statement  then assigns  to  and when  runs it prints
p25870
aVBut since you called  recursively, that is then returned to the previous  call, which returns  again, and so forth
p25871
aVHere is a nested trace of your functions, as  calls  calls , etc
p25872
ag4212
aVInstead, have the check function return True or False to indicate correct results, and leave the asking for a re-enter to
p25873
aVDo that with a  loop instead of recursion though; if you have to ask often enough, you'll end up with a recursion-too-deep exception
p25874
aVYou may as well inline that check:
p25875
aVUsing a blanket  clause is never a good idea; in the above code I catch the  raised by  when you enter a non-integer value instead, and raise the same exception if you did enter an integer but it was not a value between 1 and 12 inclusive
p25876
aVThat simplifies the 'not a month' error handling significantly
p25877
as(dp25878
g16
V100297
p25879
stp25880
a((dp25881
g2
(lp25882
VYou'll have to give an  argument to  that uses a relative path
p25883
aVDo this by giving the root path to remove to :
p25884
aVand call this with:
p25885
aVI've removed the blanket , ; there is no use for that here and only serves to hide problems you want to know about
p25886
aVThe  function returns a path relative to , effectively removing that root path from the archive entry
p25887
aVOn python 2
p25888
aV5, the  function is not available; for this specific usecase the following replacement would work:
p25889
aVand use:
p25890
aVNote that the above  function only works for your specific case where  is guaranteed to start with ; on Windows the general case for  is a lot more complex
p25891
aVYou really want to upgrade to Python 2
p25892
aV6 or newer if at all possible
p25893
as(dp25894
g16
V100297
p25895
stp25896
a((dp25897
g2
(lp25898
VThe site is returning a standard image back to you because you are scraping the site
p25899
aVUse the same 'trick' of setting the headers when retrieving the image:
p25900
as(dp25901
g16
V100297
p25902
stp25903
a((dp25904
g2
(lp25905
VYou opened the file for appending, which adds data to the end
p25906
aVOpen the file for writing instead, using the  mode
p25907
aVBetter still, just use the  method on the ElementTree object:
p25908
aVUsing the  method has the added advantage that you can set the encoding, force the XML prolog to be written if you need it, etc
p25909
aVIf you must use an open file to prettify the XML, use the  mode,  opens a file for appending, leading to the behaviour you observed:
p25910
aVwhere  is something along the lines of:
p25911
ag7233
ag1298
aVthe minidom prettifying trick
p25912
as(dp25913
g16
V100297
p25914
stp25915
a((dp25916
g2
(lp25917
VThe notion is correct; the  code does not distinguish between a  and a
p25918
aVBoth of these decorators add an attribute to the decorated item, , which  uses to add an  attribute (a ) to the ABC you defined
p25919
aVThe  type then guards against creating an instance of any class where any of the names listed in  does not have a concrete implementation
p25920
aVNo checks are made for functions versus properties there
p25921
aVTo illustrate:
p25922
aVBy creating new overrides for these in a subclass, the  class will find fewer methods or properties with the  attribute, thus making the resulting  set smaller; once the set is empty you can create instances of such a subclass
p25923
aVThese checks are made in the  constructor and no checks are made to match descriptor types:
p25924
aVYou'd have to create a subclass of  that overrides the  method, and check that any abstract method or property named on a base class is indeed matched with a non-abstract method or property on  instead
p25925
as(dp25926
g16
V100297
p25927
stp25928
a((dp25929
g2
(lp25930
VYou are looking at a Quoted-printable encoding (a variant as used in MIME email headers, called encoded-word)
p25931
aVThe  module handles this for you:
p25932
as(dp25933
g16
V100297
p25934
stp25935
a((dp25936
g2
(lp25937
VIf you use , you can override the internal  method to add information to the  instance generated:
p25938
aVThis is the original method:
p25939
aVYou can subclass  and override this method:
p25940
aVThen use  instead of
p25941
as(dp25942
g16
V100297
p25943
stp25944
a((dp25945
g2
(lp25946
VTo decode a byte sequence from latin 1 to Unicode, use the  method:
p25947
aVPython uses  escapes for unicode codepoints below
p25948
aVThe above Latin-1 character can be encoded to UTF-8 as:
p25949
as(dp25950
g16
V100297
p25951
stp25952
a((dp25953
g2
(lp25954
VUse  (or the superset  or the fork ) instead to provide metadata about your project
p25955
aVEspecially when using , that metadata is then discoverable and reusable through the  module
p25956
aVThere is no standard for global variables such as , not even for the Python stdlib, which is why the effort to provide this metadata in the stdlib for Python 3 has not amounted to anything
p25957
aVI can recommend the The Hitchhiker\u2019s Guide to Packaging as a primer on how to package your project properly
p25958
as(dp25959
g16
V100297
p25960
stp25961
a((dp25962
g2
(lp25963
VLook for the  tags, then use   to grab everything until it's another  tag:
p25964
aVUsing your sample, this gives:
p25965
as(dp25966
g16
V100297
p25967
stp25968
a((dp25969
g2
(lp25970
VUse a XML parser for task instead;  is included with Python:
p25971
as(dp25972
g16
V100297
p25973
stp25974
a((dp25975
g2
(lp25976
VPython dictionaries do not preserve ordering:
p25977
aVKeys and values are listed in an arbitrary order which is non-random, varies across Python implementations, and depends on the dictionary\u2019s history of insertions and deletions
p25978
aVA dictionary in CPython is implemented as a hash table to enable fast lookups and membership tests, and enumerating the keys or values happens in the order the items are listed in that table; where they are inserted depends on the hash value for the key and if anything was hashed to the same slot before already
p25979
aVYou'll have to either sort the keys every time when displaying or use a a different type of data structure to preserve ordering
p25980
aVPython 2
p25981
aV7 or newer has a  type, or you can use a list of two-value tuples (at which point lookups of individual key-value pairs is going to be slow)
p25982
as(dp25983
g16
V100297
p25984
stp25985
a((dp25986
g2
(lp25987
VAvoid the temptation to be clever
p25988
aVUse option 1, it's intent is clear and unambiguous; you are applying the function  to each and every element in the iterable
p25989
aVOption 2 just confuses everyone, looking for what  is supposed to do (it certainly puzzled me until I realized you needed to iterate over  in Python 3)
p25990
aVOption 3 should be used when you actually get results from , never for the side effects
p25991
aVSmack anyone doing that just for the side-effects
p25992
aVList comprehensions should be used to generate a list, not to do something else
p25993
aVYou are instead making it harder to comprehend and maintain your code (and building a list for all the return values is slower to boot)
p25994
as(dp25995
g16
V100297
p25996
stp25997
a((dp25998
g2
(lp25999
VYou need to parse the  string to see what format the data is encoded in, see the IMAP RFC 3501, section 7
p26000
ag400
ag5740
aVThe 5th field is the content encoding:
p26001
aVThe fields are, in order, the type and subtype (so  in this case), body parameters (such as characterset, format-flowed, or the filename in this case), the attachment id, description, encoding, size, MD5 signature (if any), disposition and language
p26002
aVIn this case the data is base-64 encoded:
p26003
aVwhich looks like JPEG data to me
p26004
as(dp26005
g16
V100297
p26006
stp26007
a((dp26008
g2
(lp26009
VYou have the URL wrong; it's  (plural), see  the Repos create documentation
p26010
as(dp26011
g16
V100297
p26012
stp26013
a((dp26014
g2
(lp26015
VPrinting  objects requires Python to guess the output encoding and encoding the Unicode codepoints to that encoding
p26016
aVOn your VPS server, the output encoding appears to be ASCII, which is the default when no encoding could be detected (such as when using a pipe)
p26017
aVIf you run the same code on a terminal, the terminal encoding is usually detected and the encoding succeeds
p26018
aVThe solution is to encode explicitly depending on your script requirements
p26019
aVPlease do read the Python Unicode HOWTO to understand how Python does this detection and why it needs to encode for you
p26020
as(dp26021
g16
V100297
p26022
stp26023
a((dp26024
g2
(lp26025
VThe  documentation is quite clear on the difference:
p26026
aVReturn all non-overlapping matches of pattern in string, as a list of strings
p26027
aV[\u2026] If one or more groups are present in the pattern, return a list of groups; this will be a list of tuples if the pattern has more than one group
p26028
aVSo  returns a list containing one of three types of values, depending on the number of groups in the pattern:
p26029
aV0 capturing groups in the pattern (no  parenthesis): the whole matched string ( in your second example)
p26030
aV1 capturing group in the pattern: return the captured group ( in your first example)
p26031
aVmore than 1 capturing group in the pattern: return a tuple of all matched groups
p26032
aVUse non-capturing groups () if you don't want that behaviour, or add groups if you want more information
p26033
aVFor example, adding a group around the  part would result in a list of tuples with two elements each:
p26034
as(dp26035
g16
V100297
p26036
stp26037
a((dp26038
g2
(lp26039
VThe entry is called , but it's not being picked up from
p26040
aVFrom context and code I understand it is intended to be used through-the-web on PyPI only, as per-project metadata, and not the usual per-release information
p26041
aVThe official way to add such information is through the Project-URL list, but  and  do not yet support that new field
p26042
aVWith  dead in the water (at least for now), I'd add a  into  anyway and convert that to whatever distribution tools we get in the future when the time comes
p26043
as(dp26044
g16
V100297
p26045
stp26046
a((dp26047
g2
(lp26048
VThe splitting is relatively easy; make it a separate function:
p26049
aVThis uses the  function to turn each floating point pair (separated by a comma) into a tuple of python float values:
p26050
aVNow you just have to loop over each dictionary and apply that function to the polygons:
p26051
aVThis copies each result dictionary using  so we can alter it (replace the  value) before we store it in a new list
p26052
as(dp26053
g16
V100297
p26054
stp26055
a((dp26056
g2
(lp26057
VExpanding on my previous answer, please do use the ElementTree API for such tasks:
p26058
as(dp26059
g16
V100297
p26060
stp26061
a((dp26062
g2
(lp26063
VUse  instead
p26064
aVThe  command looks up binaries in the current ; activating your virtual environment adds your virtualenv  directory to the path and  will find your python binary there instead of the global python
p26065
as(dp26066
g16
V100297
p26067
stp26068
a((dp26069
g2
(lp26070
VYou are mostly doing it right, and your code is working fine:
p26071
aVbut for any key not yet in the dict you'd have to test first () or use :
p26072
aVwhich gets old fast
p26073
aVBut I'd use a  class instead:
p26074
aVAdvantages:
p26075
aVNo need to test for new keys; accessing a nonexisting key automatically assigns a count of 0
p26076
aVCreating a new counter from a list of items to count is as easy as
p26077
aVYou can sum counters;  returns a new  with all values summed
p26078
aVYou can subtract counters (negative values are removed), intersect them (find the minimum of either count), or create a union (maximum counts)
p26079
as(dp26080
g16
V100297
p26081
stp26082
a((dp26083
g2
(lp26084
VYou have a pickle file, use the  module instead
p26085
aVThe  module won't help here; that module is used for binary data packed following C struct conventions, and the pickle format you are looking at is textual
p26086
as(dp26087
g16
V100297
p26088
stp26089
a((dp26090
g2
(lp26091
VThe  function is used as the  function for the  function; the function is called for any type that JSON doesn't know how to handle
p26092
aVThe JSON standard only knows about numbers, strings, booleans, nulls (None in python), objects (dicts in python) and lists
p26093
aVIf you want to handle anything outside of that limited set of types, you need to express that 'something' in terms of those types
p26094
aVThe  is used for that purpose; it is called for any object that cannot be serialized to JSON as-is
p26095
aVA  object is one such type
p26096
aVWhen you a  object to , the  function will be asked to create a serializable version of it
p26097
aVNote that returning  is not the correct way to handle types you don't know how to convert
p26098
aVRaise  instead:
p26099
as(dp26100
g16
V100297
p26101
stp26102
a((dp26103
g2
(lp26104
VDon't sort 10 million lines in memory
p26105
aVSplit this up in batches instead:
p26106
aVRun 100 100k line sorts (using the file as an iterator, combined with  or similar to pick a batch)
p26107
aVWrite out to separate files elsewhere
p26108
aVMerge the sorted files
p26109
aVHere is an merge generator that you can pass 100 open files and it'll yield lines in sorted order
p26110
aVWrite to a new file line by line:
p26111
as(dp26112
g16
V100297
p26113
stp26114
a((dp26115
g2
(lp26116
VYour problem is not with reading the file, but with printing; the traceback shows that the line  preceeds the  (note the Encode in that exception)
p26117
aVWhen you read a file, you are decoding from cp1252 to  objects, and that is working just fine
p26118
aVYour windows terminal is using codepage 437 and cannot handle the characters you are trying to print
p26119
aVPython needs to convert your data from unicode to whatever your terminal is using to be able to display the characters to you
p26120
aVYou can switch your terminal codepage with the  command (not a Python expresssion but a Windows commandline tool)
p26121
aVCodepage 65001 is the UTF-8 codepage, which can handle all Unicode code points
p26122
aVYou may need to switch fonts to be able to display these characters too
p26123
aVSee Unicode characters in Windows command line - how
p26124
as(dp26125
g16
V100297
p26126
stp26127
a((dp26128
g2
(lp26129
VYou are looping over a list and altering it at the same time
p26130
aVBy using  you are shortening the list, but the iterator pointer is not updated
p26131
aVUse a copy instead:
p26132
aVor
p26133
aVwhere the  slice notation returns a list copy
p26134
aVAnother approach would be to use a  loop instead:
p26135
aVbecause an empty list tests as boolean
p26136
aVThe python  loop uses it's argument as an iterator, it does not itself keep an index
p26137
aVThere is no way for the  loop to 'know' you removed elements
p26138
aVInstead, it's the  iterator that keeps that pointer:
p26139
aVThat iterator keeps a counter, and every time you call  on the iterator it'll give you the value at the next index, whatever that value may be, until the counter is equal to the current lenght of the list
p26140
as(dp26141
g16
V100297
p26142
stp26143
a((dp26144
g2
(lp26145
VYour  state needs to give the View permission to Anonymous
p26146
aVCurrently it is restricted to these roles:
p26147
aVWithout the View permission anonymous cannot see your objects even when given the  state, nor can they be found in the catalog by that user
p26148
aVYou can override this behaviour of the catalog by using the  method of the catalog:
p26149
aVThis method cannot be used from restricted code
p26150
aVThe returned brain objects are perfectly accessible by anonymous users, but you cannot use the  method on them because that'll use the current user's permissions to traverse to it
p26151
aVIf you need to get the actual object from the brain, there is again a special, private method to get to the actual object without those restrictions, called :
p26152
aVThis method is, once again, only available to unrestricted code
p26153
as(dp26154
g16
V100297
p26155
stp26156
a((dp26157
g2
(lp26158
VIt asks your operating system for that information, by way of the stdlib C time functions
p26159
aVTo quote the  module documentation:
p26160
aVMost of the functions defined in this module call platform C library functions with the same name
p26161
aVIt may sometimes be helpful to consult the platform documentation, because the semantics of these functions varies among platforms
p26162
aVYou can pass in a -1 for the DST flag to have the library set it for you, see
p26163
aVOn my Mac OS X 10
p26164
ag4892
aV5 setup, configured for the Europe/Oslo timezone, that gives me:
p26165
aVor, as 'translated' by epochconverter:
p26166
as(dp26167
g16
V100297
p26168
stp26169
a((dp26170
g2
(lp26171
VYou want to strip the , it includes the newline from the file:
p26172
aVBy using  you remove whitespace (spaces, tabs, newlines, etc
p26173
aVfrom the start and end of the string
p26174
aVTo print the URL with the status code, simply add it to the  statement
p26175
as(dp26176
g16
V100297
p26177
stp26178
a((dp26179
g2
(lp26180
VUse :
p26181
aVtakes a function, an input list and an optional initial value, and re-applies that function to then next element and the return value of the last invocation (starting with the initial value)
p26182
aVThus, it runs  where the successive  values are taken from
p26183
aVShort demonstration:
p26184
as(dp26185
g16
V100297
p26186
stp26187
a((dp26188
g2
(lp26189
VIt's best to expand the list comprehension to analyze it:
p26190
aVThis expands  into a list of elements where each item is repeated according to their weight;  is added 3 times,  2 times, etc:
p26191
aVThe  function then takes one of those elements at random, but  occurs 4 times and thus has a higher chance of being picked than, say, , which is present only once in that expanded list
p26192
as(dp26193
g16
V100297
p26194
stp26195
a((dp26196
g2
(lp26197
VDon't use spaces in your urls:
p26198
as(dp26199
g16
V100297
p26200
stp26201
a((dp26202
g2
(lp26203
VConfigure  not to ask (see the  man page:
p26204
aVFor tools that cannot be configured, use  to steer the process
p26205
aVlets you listen for output from a subprocess, and send input based on a simple API:
p26206
as(dp26207
g16
V100297
p26208
stp26209
a((dp26210
g2
(lp26211
VInclude the length of the key in your sort function:
p26212
aVoutput:
p26213
aVSo each item is sorted on the tuple ; a shorter length is reverse sorted after a longer length, but only if the first element of the tuple is the same
p26214
as(dp26215
g16
V100297
p26216
stp26217
a((dp26218
g2
(lp26219
VSort the list using a  function:
p26220
as(dp26221
g16
V100297
p26222
stp26223
a((dp26224
g2
(lp26225
VBabel provides such tools:
p26226
aVA collection of tools for internationalizing Python applications
p26227
aVBabel is composed of two major parts:
p26228
aVtools to build and work with gettext message catalogs
p26229
aVa Python interface to the CLDR (Common Locale Data Repository), providing access to various locale display names, localized number and date formatting, etc
p26230
aVSo it helps you translate strings and provide localized float, currency, dates and other information based on a current locale:
p26231
aVIt builds on top of the default  library to do translations, giving you tools to extract messages from a variety of source files (python, templates, etc), including a plugin-system for other packages to provide additional extractors
p26232
as(dp26233
g16
V100297
p26234
stp26235
a((dp26236
g2
(lp26237
VUse  ( if empty) or  ( if not empty) instead of testing for the length:
p26238
aVOr, as a demonstration speaks louder than words:
p26239
aVApart from the fact that this is a micro optimization, testing for the falsy-ness of the empty  tuple is faster too
p26240
aVWhen in doubt about speed, use the  module:
p26241
as(dp26242
g16
V100297
p26243
stp26244
a((dp26245
g2
(lp26246
VYou need to store the return value of the  function:
p26247
aVThe function argument is the text you want to display, not the variable you want to receive the user input
p26248
as(dp26249
g16
V100297
p26250
stp26251
a((dp26252
g2
(lp26253
VWhen you loop over the values of a list, the values are assigned to local variables
p26254
aVChanging those local variables will not change the original values stored in the list
p26255
aVUse a  call to add indexes, then use that index to change the original list:
p26256
as(dp26257
g16
V100297
p26258
stp26259
a((dp26260
g2
(lp26261
VSince these are all python s and you are calling the  method on them, you can use an empty  to chain:
p26262
aVBy leaving off the default for the last  you fall back to
p26263
aVNow, if any of the intermediary keys is not found, the rest of the chain will use empty dictionaries to look things up, terminating in  returning
p26264
as(dp26265
g16
V100297
p26266
stp26267
a((dp26268
g2
(lp26269
VYou need to call the list initializer:
p26270
aVAssigning to  in the function just replaces the local variable with the list, not assign anything to the instance:
p26271
as(dp26272
g16
V100297
p26273
stp26274
a((dp26275
g2
(lp26276
VJust typing  by itself will not load the python from the local directory
p26277
aVIt'll be looked up in your  environment variable instead
p26278
aVUse  to invoke a binary in the local directory
p26279
aVThat means that your second  call already was different from the first; the Python installer must have added the new location to your  variable (usually via  or similar shell startup construct)
p26280
aVUse  to run the Mac OS X default, or use  to look up a python binary by version
p26281
as(dp26282
g16
V100297
p26283
stp26284
a((dp26285
g2
(lp26286
VThere is nothing weird about that, all is well
p26287
aVPython is using  escape sequences to represent the non-printable characters:
p26288
aVNote how the hex character 65 was printed as ; it is a printable ASCII letter after all
p26289
aVYour data is probably encoded to something different from ASCII; try decoding it with UTF-16 for example
p26290
aVThe first 1 bytes looks like the second byte of the UTF-16 BOM to me:
p26291
as(dp26292
g16
V100297
p26293
stp26294
a((dp26295
g2
(lp26296
VUse spaces, not tabs
p26297
aVSpaces are always interpreted as the same width, unlike tabs
p26298
aVPEP 8 (the python styleguide) recommends spaces over tabs, as does the Google Python styleguide
p26299
aVThus, if you consistently use spaces only, your code will always be indented properly
p26300
aVYou can check your python files for inconsistent tab usage by running the code with the  switch:
p26301
aVOnce you've cleaned up inconsistencies, use the Unix  command to replace tabs with spaces:
p26302
aVwhere  instructs  to replace tabs with 4 spaces
p26303
as(dp26304
g16
V100297
p26305
stp26306
a((dp26307
g2
(lp26308
VUCS-2 is UTF-16, really, for any codepoint that was assigned when it was still called UCS-2 in any case
p26309
aVOpen it with
p26310
aVIf there is no BOM (2 bytes at the start, for BE that'd be ), then use  to force a byte order
p26311
as(dp26312
g16
V100297
p26313
stp26314
a((dp26315
g2
(lp26316
VUse a regular expression:
p26317
aVDemonstration:
p26318
as(dp26319
g16
V100297
p26320
stp26321
a((dp26322
g2
(lp26323
VYou can use the same principle, by using the first three elements as a key, and using  as the default value factory for the  (so you get  as the initial value):
p26324
aVIf you are using Python 3, you can simplify this to:
p26325
aVbecause you can use a starred target to take all 'remaining' values from a list, so each sublist is assigned mostly to  and the last value is assigned to , making the loop just that little simpler (and there is no  method on a dict in Python 3, because  is an iterator already)
p26326
aVSo, we use a  that uses  as the default value, then for each key generated from the first 3 values (as a tuple so you can use it as a dictionary key) sum the last value
p26327
aVSo for the first item  we create a key , look that up in  (where it doesn't exist, but  will then use  to create a new value of ), and add the  from that first item
p26328
aVDo the same for the  key and value
p26329
aVfor the 3rd item we get the  key again and add  to the pre-existing  in
p26330
aVfor a total of 19
p26331
aVThen we turn the (key, value) pairs back into lists and you are done
p26332
aVThis results in:
p26333
aVAn alternative implementation that requires sorting the data uses :
p26334
aVfor the same output
p26335
aVThis is going to be slower if your data isn't sorted, but it's good to know of different approaches
p26336
as(dp26337
g16
V100297
p26338
stp26339
a((dp26340
g2
(lp26341
VYou are looking at the representation of the  object; the string message itself is contained in the  attribute:
p26342
aVThe  of the Fault class otherwise represents that value using ; you cannot get around that without changing the  class itself (by replacing it's  method or adding a  method to it)
p26343
aVYou could monkey patch that into the class:
p26344
as(dp26345
g16
V100297
p26346
stp26347
a((dp26348
g2
(lp26349
VThe request has both a  and a  entry, both contain the same value:
p26350
aVThis isn't documented; I had to find it in the  source
p26351
aVThe value is a  instance; it has both a  and a  attribute you could inspect to determine which route was matched
p26352
aVFor your specific example this is perhaps overkill, since you are only matching simple paths, but for more complex rules with regular expression rules this would work better than trying to match the  attribute (but it'd be a good idea to give your routes a  value)
p26353
as(dp26354
g16
V100297
p26355
stp26356
a((dp26357
g2
(lp26358
VIt's just a function
p26359
aVImport it and call it:
p26360
aVIf you need to parse arguments, you have two options:
p26361
aVParse them in , but pass in  as a parameter (all code below in the same module ):
p26362
aVNow you can import and call  from other another module
p26363
aVHave  accept parameters that are already parsed (again all code in the  module):
p26364
aVand import and call  elsewhere and passing in python arguments as needed
p26365
aVThe trick here is to detect when your module is being used as a script; when you run a python file as the main script () no  statement is being used, so python calls that module
p26366
aVBut if that same  code is treated as a module (), then python uses that as the module name instead
p26367
aVIn both cases the variable  is set, and testing against that tells you how your code was run
p26368
as(dp26369
g16
V100297
p26370
stp26371
a((dp26372
g2
(lp26373
VNo, it needs to be part of the package setup configuration instead
p26374
aVSee Supporting both Python 2 and 3 with Distribute
p26375
aVYou add metadata to your package installer:
p26376
aVSuch a package would then automatically run  on installation into a Python 3 system
p26377
aVis a tool, not a magic bullet, you cannot apply it to an arbitrary package  downloads from PyPI
p26378
aVThe package needs to support it in the way it is coded
p26379
aVThus, running it automatically from  is not going to work; the responsibility lies with the package maintainer
p26380
aVNote that just because  runs successfully on a package, it does not necessarily follow the package will work in Python 3
p26381
aVAssumptions about bytes vs
p26382
aVunicode usually crop up when you actually start using the package
p26383
aVContact the maintainers of the packages you are interested in and ask what the status is for that package for Python 3
p26384
aVSupplying patches to them usually helps
p26385
aVIf such requests and offers for help fall on deaf ears, for Open Source packages you can always fork them and apply the necessary changes yourself
p26386
as(dp26387
g16
V100297
p26388
stp26389
a((dp26390
g2
(lp26391
VYour hybrid property must return a sql expression; yours does not, it returns a python string instead
p26392
aVTo resolve that for this case, don't do the path join in python but in a SQL expression instead:
p26393
aVwhich will resolve to , which can be used both in queries and as a return value
p26394
as(dp26395
g16
V100297
p26396
stp26397
a((dp26398
g2
(lp26399
VThe class body is run before the class is constructed, yes
p26400
aVThe body of the class provides a temporary namespace, and all local names in that namespace are given as a dictionary to construct the class object, together with the base classes and a name for the class
p26401
aVYou can do this with the  constructor too:
p26402
aVThe class body is basically executed as a function, with the local namespace of that function being used to create the class attributes, the 3rd argument to  above
p26403
aVIn python 3 you have a little more influence on that process with the  hook on a metaclass
p26404
aVshould be a class method that returns a initial namespace for the class body; use it to inject extra names into the generated class body before the class body is executed:
p26405
as(dp26406
g16
V100297
p26407
stp26408
a((dp26409
g2
(lp26410
VYou are splitting your line into a list of words, but only giving it one key and value
p26411
aVThis will work:
p26412
aVNote that you don't need to give  an argument; without arguments it'll both split on whitespace and strip the results for you
p26413
aVThat saves you having to explicitly call
p26414
aVThe alternative is to split only on the first whitespace:
p26415
aVThe second argument to  limits the number of splits made, guaranteeing that there at most 2 elements are returned, making it possible to unpack the values in the assignment to  and
p26416
aVEither method results in:
p26417
aVIf you still see only one key and the rest of the file as the (split) value, your input file is using a non-standard line separator perhaps
p26418
aVOpen the file with universal line ending support, by adding the  character to the mode:
p26419
as(dp26420
g16
V100297
p26421
stp26422
a((dp26423
g2
(lp26424
VYes, that is exactly what  means; convert the argument to a string and interpolate it
p26425
aVYou can also specify other forms of conversion, such as  and  to convert values to different types of representations
p26426
aVSee String Formatting Operations for more details
p26427
aVAs an alternative, as of Python 2
p26428
aV6 and up you can also use a different form of string formatting using the  method:
p26429
aVThat method offers some extra features, such as referring to attributes of objects, keys in a mapping or indexes in a list to refer to values
p26430
as(dp26431
g16
V100297
p26432
stp26433
a((dp26434
g2
(lp26435
VUse a -based setup script, then install with  or
p26436
aVThat way you can specify  as a dependency and it'll be installed together with your script:
p26437
aVSee Declaring Dependencies and the Hitchhiker\u2019s Guide to Packaging for more information
p26438
aVIf for whatever reason you cannot use this infrastructure, just unpack the  tarball next to your script, and add the parent directory of your script to :
p26439
as(dp26440
g16
V100297
p26441
stp26442
a((dp26443
g2
(lp26444
VYou want to loop over the file itself, and set a flag for when you find the first line without a  character, after which you can start collecting numbers
p26445
aVBreak off reading when you find the  character on a line
p26446
aVSo the above:
p26447
aVsets 'reading' to , and only when a line without  is found, is that set to
p26448
aVwhen 'reading' is :
p26449
aVreturns the data read if the line contains
p26450
aVotherwise it's assumed the line contains two float values separated by whitespace, which are added to their respective lists
p26451
aVBy returning, the function ends, with the file closed automatically
p26452
aVOnly the first block is read, the rest of the file is simply ignored
p26453
as(dp26454
g16
V100297
p26455
stp26456
a((dp26457
g2
(lp26458
VPickle must be able to load the class directly
p26459
aVYour decorator replaces the class with a factory function, making it impossible for pickle to import the class itself
p26460
aVUse a separate factory function, not a decorator, returning a 'private' class (but still importable directly):
p26461
as(dp26462
g16
V100297
p26463
stp26464
a((dp26465
g2
(lp26466
VYou should be a little more specific in your search, then just loop over the table rows; grab the specific table by css class, loop over the  elements except the first one using slicing, grab all text from the first :
p26467
aVAlternatively to slicing off the first row, you can skip the  by testing for that:
p26468
aVIt would have been better all around if the page had used a proper  tag instead
p26469
aV:-)
p26470
as(dp26471
g16
V100297
p26472
stp26473
a((dp26474
g2
(lp26475
VYou could use sorting instead:
p26476
aVwhich takes  time for the sort; but it's easy and short as the longest elements are all at the start for easy picking
p26477
aVFor a  solution use a loop:
p26478
aVwhere  is built and replaced as needed to hold only the longest elements:
p26479
as(dp26480
g16
V100297
p26481
stp26482
a((dp26483
g2
(lp26484
VCall the  method on the slider to read the current value:
p26485
aVSee the Tkinter Scale widget documentation
p26486
as(dp26487
g16
V100297
p26488
stp26489
a((dp26490
g2
(lp26491
VIt is very inefficient, and not thread-safe to boot
p26492
aVUse a decent connection pool library instead
p26493
aVoffers pooling and a whole lot more, or find yourself a lighter-weight pool for sqlite
p26494
as(dp26495
g16
V100297
p26496
stp26497
a((dp26498
g2
(lp26499
VFirst you need to decode the URL encoding with  then use the  module to split out the filename and extension:
p26500
aVwhere  removes the directory path, and  gives you a filename and extension tuple
p26501
aVThis then gives you the filename:
p26502
as(dp26503
g16
V100297
p26504
stp26505
a((dp26506
g2
(lp26507
VIt is a constant, just like
p26508
aVPlatforms other than POSIX and Windows could use a different value to denote the 'current directory'
p26509
aVOn Risc OS it's  for example, on the old Macintosh OS it's
p26510
aVThe value is used throughout the standard library to remain platform agnostic
p26511
aVUse  instead;  uses that function under the hood to turn  into the current working directory anyway
p26512
aVHere is the POSIX implementation of :
p26513
as(dp26514
g16
V100297
p26515
stp26516
a((dp26517
g2
(lp26518
VConvert  to a number first:
p26519
as(dp26520
g16
V100297
p26521
stp26522
a((dp26523
g2
(lp26524
VIn the first, you first check if there are enough characters to test against, in the second you don't:
p26525
aVand
p26526
aVand pass in an empty string:
p26527
aVThe empty string has length 0, and no character at index 0:
p26528
aVThe  boolean expression is being evaluated left-to-right, and the  expression is evaluated before the  test, and then fails for that empty string
p26529
aVIn the other version, the  part is evaluated first, found to be  for the empty string (0 is not greater or equal to 2) and Python then doesn't need to look at the other half of the  expression at all, since there is no chance the  expression will become  whatever the second half evaluates to
p26530
aVSee Boolean expressions in the python documentation:
p26531
aVThe expression  first evaluates ; if  is false, its value is returned; otherwise,  is evaluated and the resulting value is returned
p26532
as(dp26533
g16
V100297
p26534
stp26535
a((dp26536
g2
(lp26537
VThe  function returns a special range object to save on memory (no need to keep all the numbers in memory when only the start, end and step size will do)
p26538
aVCast it to a list to 'expand' it:
p26539
aVTo quote the documentation:
p26540
aVThe advantage of the  type over a regular  or  is that a  object will always take the same (small) amount of memory, no matter the size of the range it represents (as it only stores the ,  and  values, calculating individual items and subranges as needed)
p26541
as(dp26542
g16
V100297
p26543
stp26544
a((dp26545
g2
(lp26546
VDjango only has experimental support for Python 3, so you'll have to go with Python 2
p26547
aV7 for now
p26548
as(dp26549
g16
V100297
p26550
stp26551
a((dp26552
g2
(lp26553
VThat specific key server works for me, with or without a  prefix:
p26554
aVOn most keyservers I tried, in fact, the keys are present; my setup uses :
p26555
aVAlternatively you'd have to manually download the 7D9DC8D2 key (Martin von Lwis), used for signing the Windows builds and import that manually:
p26556
as(dp26557
g16
V100297
p26558
stp26559
a((dp26560
g2
(lp26561
VThere are two problems:
p26562
aVreturns a tuple of , you need to pass just the data to
p26563
aVYou are reading only up to 1024 bytes from the socket, but the unpack format wants 2052 bytes
p26564
aVRead from the socket until you have received enough data first
p26565
as(dp26566
g16
V100297
p26567
stp26568
a((dp26569
g2
(lp26570
VThree options:
p26571
aVDon't use two print statements, but concatenate the values:
p26572
aVUse  to write your statements directly, not using the  statement
p26573
aVUse the forward-compatible new  function:
p26574
as(dp26575
g16
V100297
p26576
stp26577
a((dp26578
g2
(lp26579
VYou need to upgrade to Django 1
p26580
aV5c1 (still in development)
p26581
aVYou appear to be running a development version that predates even 1
p26582
aV5a1
p26583
aVThe error you see is due to a syntax change between the major Python versions and was fixed 9 months ago
p26584
aVOr better still, use Python 2
p26585
aV7 instead; even in Django 1
p26586
aV5 the Python 3 support is labelled as experimental
p26587
as(dp26588
g16
V100297
p26589
stp26590
a((dp26591
g2
(lp26592
VThe are not the same exactly, but the difference is minimal
p26593
aVWhen in doubt, use the  module to find out:
p26594
aVAs you can see, the  function adds a  and  operation
p26595
aVYou also use a little more memory, as the sorted results are kept around until the  variable is cleaned up, while in  the sorted results can be cleaned up immediately following the conclusion of the loop
p26596
aVThe  executes the  function; it is only executed once
p26597
as(dp26598
g16
V100297
p26599
stp26600
a((dp26601
g2
(lp26602
VYou were almost there, but it isn't your  or  that's the problem
p26603
aVYou end up setting the class back on , not the instance you created:
p26604
aVIt's the same thing as calling the class directly (), but now through a variable
p26605
as(dp26606
g16
V100297
p26607
stp26608
a((dp26609
g2
(lp26610
VYou'll have to remove the handlers if you want to stop logging like that, using the  method:
p26611
aVotherwise it'll continue to be used
p26612
as(dp26613
g16
V100297
p26614
stp26615
a((dp26616
g2
(lp26617
VI'd create a new security manager for such a job, after authentication:
p26618
as(dp26619
g16
V100297
p26620
stp26621
a((dp26622
g2
(lp26623
V is a python keyword and should not be used as an attribute
p26624
aVLucky for you, when using the  library that comes with python, JSON objects become dictionaries instead:
p26625
aVFor situations where you actually do have a object with a python keyword used as an attribute, you'd have to resort to using the  function instead:
p26626
as(dp26627
g16
V100297
p26628
stp26629
a((dp26630
g2
(lp26631
VYou need to make your data value a string; it's not a python expression:
p26632
as(dp26633
g16
V100297
p26634
stp26635
a((dp26636
g2
(lp26637
VPython adds a  for long numbers:
p26638
aVadding one more character
p26639
aVUse a different method to create a hex number:
p26640
aVinstead
p26641
aVThe  function lets you use the format spec mini language to transform your data;  is a lower-cased hex representation in this case, and you don't need to slice anything:
p26642
aVNote the 016 in the format there; if your number is smaller than 16 hex digits, it'll be padded with zeros for you:
p26643
aVYour byte swapping can be done more easily too; python supports multiple assignments letting you swap two values without the need for a temporary variable:
p26644
aVThus, your  method can be simplified to:
p26645
aVresulting in:
p26646
as(dp26647
g16
V100297
p26648
stp26649
a((dp26650
g2
(lp26651
V returns only filenames, not full paths
p26652
aVUse  to create a full path:
p26653
as(dp26654
g16
V100297
p26655
stp26656
a((dp26657
g2
(lp26658
V is the Python bitwise XOR operator
p26659
aVIt is how you spell  in python:
p26660
aVXOR stands for exclusive OR
p26661
aVIt is used in cryptography because it let's you 'flip' the bits using a mask in a reversable operation:
p26662
aVwhere  is the mask; (input XOR mask) XOR mask gives you the input again
p26663
as(dp26664
g16
V100297
p26665
stp26666
a((dp26667
g2
(lp26668
VYou forgot to close the parenthesis in two places:
p26669
aVAnd again at the end of your code
p26670
aVNote that your  statement also has an error;  is assignment, you meant  instead:
p26671
as(dp26672
g16
V100297
p26673
stp26674
a((dp26675
g2
(lp26676
VPython dictionaries have an arbitrary ordering, they are not sorted
p26677
aVYou want to use your prebuilt lists of keys instead:
p26678
aVwhich changes the dictionaries in-place
p26679
aVYou could even determine the  and  keys from each entry:
p26680
aVand omit the list literals with the  etc
p26681
aVhardcoded lists altogether
p26682
as(dp26683
g16
V100297
p26684
stp26685
a((dp26686
g2
(lp26687
VThe  manages one cookie, that is signed
p26688
aVThis means that the client can read1 what is in the cookie, but cannot change the values in the cookie
p26689
aVIf you set cookies directly using , the client can not only read the cookie, they can change the value of the cookie and you won't be able to detect that the contents have been tampered with
p26690
aVMoreover, the  let's you store any python structure and it'll take care of encoding these to fit within the limitations of a cookie; you'd have to do the same work manually with
p26691
aV1 You'd have to base64-decode the cookie, then use the  module to decode the contents
p26692
aVBecause the cookie is cryptographically signed, the usual security concerns that apply to  are mitigated
p26693
as(dp26694
g16
V100297
p26695
stp26696
a((dp26697
g2
(lp26698
VYou can't, not without passing a reference to the instance of  when you call  or when you create your  instance
p26699
aVYou could store references to that  instance anywhere, and because of that, you cannot, in Python, know from within the instance method where it has been assigned
p26700
aVSo, do this:
p26701
aVNow instances of  'know' about their parent, and can reference them via the  instance variable
p26702
as(dp26703
g16
V100297
p26704
stp26705
a((dp26706
g2
(lp26707
VIntuitively, we can see that a reverse sort of single digit numbers would lead to the higest number:
p26708
aVso reverse sorting should work
p26709
aVThe problem arises when there are multi-digit snippets in the input
p26710
aVHere, intuition again lets us order  before  and  before , but why does that work
p26711
aVAgain, if they had been the same length, it would have been clear how to sort them:
p26712
aVThe trick then, is to 'extend' shorter numbers so they can be compared with the longer ones and can be sorted automatically, lexographically
p26713
aVAll you need to do, really, is to repeat the snippet to beyond the maximum length:
p26714
aVcomparing  and : compare  and  instead and thus  comes first
p26715
aVcomparing  and : compare  and  instead and thus  comes first
p26716
aVcomparing  and : compare  and  instead and thus  comes firrst
p26717
aVcomparing  and : compare  and  instead and thus  comes first
p26718
aVThis works because python only needs to compare the two snippets until they differ somewhere; and it's (repeating) matching prefixes that we need to skip when comparing two snippets to determine which order they need to be in to form a largest number
p26719
aVYou only need to repeat a snippet until it is longer than the longest snippet * 2 in the input to guarantee that you can find the first non-matching digit when comparing two snippets
p26720
aVYou can do this with a search , but you need to determine the max length of the snippets first
p26721
aVUsing that length, you can 'pad' all snippets until they are longer than that max length:
p26722
aVwhere  pads the snippet with itself to be more than  in length
p26723
aVThis gives:
p26724
aVNote that this solution is a) 3 lines short and b) works on Python 3 as well without having to resort to  and c) does not bruteforce the solution (which is what the  option does)
p26725
as(dp26726
g16
V100297
p26727
stp26728
a((dp26729
g2
(lp26730
VI think you mean that the value  doesn't use your  variable
p26731
aVThat's because Python does not magically read your mind and replace parts of strings that happen to match a variable name
p26732
aVYou have to use the  variable explicitly, by concatenating it with the  part:
p26733
aVor, better yet, use the  function to take care of the path separators for you:
p26734
aVNote that your problem has nothing to do with global variables; this applies to wherever your variable that you want to concatenate comes from
p26735
as(dp26736
g16
V100297
p26737
stp26738
a((dp26739
g2
(lp26740
VYou should return the wrapper function itself, not it's result:
p26741
aVDecorators replace the decorated item with the return value of the decorator:
p26742
aVis equivalent to:
p26743
aVwhich expands to (in your code):
p26744
aVso you were replacing the function  with the result of the  call, not with  itself
p26745
as(dp26746
g16
V100297
p26747
stp26748
a((dp26749
g2
(lp26750
VYou can pass in a list:
p26751
aVand BS will match  elements with either class
p26752
aVFor more complex cases, you can pass in a regular expression, or a function (takes the element and returns a boolean)
p26753
as(dp26754
g16
V100297
p26755
stp26756
a((dp26757
g2
(lp26758
VYou should not use
p26759
aVLet the  library do the reading:
p26760
aVNote the function name, , no  at the end
p26761
aVThe object returned is a dictionary; each of the strings you see is a key into that dictionary
p26762
aVYou need to specify what titles you'd want; the  and  entries both have a list of items with titles; here is how you'd print the  entry titles:
p26763
aVWhich prints:
p26764
as(dp26765
g16
V100297
p26766
stp26767
a((dp26768
g2
(lp26769
VThe  method gives you that:
p26770
aVbut might include microsends; you could use the  method for some more control:
p26771
aVOutput
p26772
as(dp26773
g16
V100297
p26774
stp26775
a((dp26776
g2
(lp26777
VThe  module is cross-platform
p26778
aVIt works on POSIX (incl
p26779
aVMac OS X) and Windows platforms
p26780
aVThere are some caveats and differences that apply only to Windows, all documented in the module documentation
p26781
as(dp26782
g16
V100297
p26783
stp26784
a((dp26785
g2
(lp26786
VI'd keep this as simple as possible:
p26787
aVSo, for each line, strip whitespace then curly braces, then split on the comma-plus-space separating the commands and store the whitespace-stripped results
p26788
aVThis relies on the fact that the commands are separated by a comma plus a space, while the arguments in your sample only use commas without spaces
p26789
aVIf you have anything that violates that difference, then you do need to resort to a regular expression
p26790
aVI'd limit it to the split only though:
p26791
aVThe  expression splits on any comma-plus-optional-whitespace, provided it was preceded by a  closing parenthesis (using a look-behind assertion)
p26792
aVFor your input that results in:
p26793
aVIf these entries are embedded in a larger body of text, then a regular expression might help, but only to find the curly-brace-delimited values:
p26794
aVwhere  will find any text delimited by curly braces (no nesting)
p26795
as(dp26796
g16
V100297
p26797
stp26798
a((dp26799
g2
(lp26800
VIf you are parsing a Atom feed, you really want to use the  library instead, which takes care of all these details for you and many more
p26801
aVThe  part is a namespace
p26802
aVYou need to specify that namespace to select the  tags:
p26803
aVwhere I used a dictionary to map the  prefix to the namespace, or you can use the same curly braces syntax:
p26804
aVOnce you have the element, you still need to explicitly find it's children:
p26805
as(dp26806
g16
V100297
p26807
stp26808
a((dp26809
g2
(lp26810
VNo, there is no straightforward way because Python dictionaries do not have a set ordering
p26811
aVFrom the documentation:
p26812
aVKeys and values are listed in an arbitrary order which is non-random, varies across Python implementations, and depends on the dictionary\u2019s history of insertions and deletions
p26813
aVIn other words, the 'index' of  depends entirely on what was inserted into and deleted from the mapping before:
p26814
aVAs of Python 2
p26815
aV7, you could use the  type instead, if insertion order is important to your application
p26816
as(dp26817
g16
V100297
p26818
stp26819
a((dp26820
g2
(lp26821
VBy converting it to an :
p26822
as(dp26823
g16
V100297
p26824
stp26825
a((dp26826
g2
(lp26827
VIf you have a  value with UTF-8 bytes, encode to Latin-1 to preserve the 'bytes':
p26828
aVbecause the Unicode codepoints U+0000 to U+00FF all map one-on-one with the latin-1 encoding; this encoding thus interprets your data as literal bytes
p26829
aVFor your example this gives me:
p26830
as(dp26831
g16
V100297
p26832
stp26833
a((dp26834
g2
(lp26835
VYou are forgetting that JSON puts quotes around the string
p26836
aVYou have the following value:
p26837
aVNote the double quotes there
p26838
aVYou'd need to load that value using the  method again, which in this case just removes the quotes again:
p26839
aVNote that now the quotes are gone again
p26840
aVYou could also just strip the quotes with  if you have a mix:
p26841
aVbut since you are expecting JSON data, why not just treat it as json data and use the  module for this to turn it back to Python data
p26842
as(dp26843
g16
V100297
p26844
stp26845
a((dp26846
g2
(lp26847
VYou didn't pass in the dictionary as keywords
p26848
aVUse the  syntax to do so:
p26849
aVor don't use a dictionary at all:
p26850
as(dp26851
g16
V100297
p26852
stp26853
a((dp26854
g2
(lp26855
VNo, you have to test all path prefixes; routing allows for many, arbitrary URLs to be possible
p26856
aVMoreover, with path predicates in the mix, multiple routes could match the same URL and choosing between them depends on other information from the request
p26857
aVTo prepare your breadcrumbs, instead loop over the sub-paths once and determine for each if there is a matching view; the easiest way to do this is to reuse the code underlying the  command; this code needs the current request:
p26858
aVYou can now look up path prefixes in the  dictionary
p26859
as(dp26860
g16
V100297
p26861
stp26862
a((dp26863
g2
(lp26864
VDecode the string value using the  method; you are looking at UTF8 data actually:
p26865
aVThe first bytes represent unicode code point U+00a0, a no-breaking space ( as HTML entity):
p26866
as(dp26867
g16
V100297
p26868
stp26869
a((dp26870
g2
(lp26871
VIterate over all matches using , and pick the last one (using the resulting 's  method:
p26872
aVprints
p26873
aVDo note that your regular expression, as it stands, won't work with any punctuation that is the last character in your input; if  was changed to:
p26874
aVthe result would still be , and not
p26875
aVYou'd need to match punctuation followed by whitespace or the end of the string:
p26876
aVThis then gives:
p26877
as(dp26878
g16
V100297
p26879
stp26880
a((dp26881
g2
(lp26882
V will automatically provide an id for a INTEGER PRIMARY KEY column on INSERT on a table if you do not provide a value yourself
p26883
aVJust insert data for every column except for the  column
p26884
aVYou may want to add the keyword  to your  column though; the default is to pick the highest existing row id plus 1, and if you delete data from the table on a regular basis that can lead to reuse of ids (delete the current highest id and it'll be re-used next time round)
p26885
aVguarantees that each generated number will only be used once for a table, independent of deletes
p26886
aVNote that when you use a  connection as a context manager (using the  statement), the  is automatically applied for you
p26887
aVQuoting the documentation:
p26888
aVConnection objects can be used as context managers that automatically commit or rollback transactions
p26889
aVIn the event of an exception, the transaction is rolled back; otherwise, the transaction is committed
p26890
aVIn other words, you can safely remove the  line in your code, it is entirely redundant
p26891
as(dp26892
g16
V100297
p26893
stp26894
a((dp26895
g2
(lp26896
VPython is not running that code; it's running a previous version of your python file that had a different line in it; at a guess that was:
p26897
aVA python traceback has to read the source code again to show you the line that caused the error, but if you changed the source in the meantime it'll not match the actual bytecode that caused the error
p26898
aVRestart your python script (or whatever runs your script, like a WSGI module in a HTTP server); if the problem persists, delete all  files, and make sure that when you save a change to your script, it's modification date is updated
p26899
as(dp26900
g16
V100297
p26901
stp26902
a((dp26903
g2
(lp26904
VYou should register the function, not the result of the function:
p26905
aVotherwise you are trying to register the list returned by  as a view instead
p26906
aVNote that your function needs to accept a  parameter too; and it'll have to return a response object too
p26907
aVChange it to:
p26908
aVI've taken the liberty of encoding the tweets to UTF8 instead of leaving it up to Python to pick a default encoding for them (which will lead to UnicodeEncodeError exceptions if there are any international characters in your tweets)
p26909
aVYou really want to read up on pyramid views before you continue
p26910
aVAs an aside, your command-line version returned only first tweet as a list of individual characters ()
p26911
as(dp26912
g16
V100297
p26913
stp26914
a((dp26915
g2
(lp26916
VYou can use the  pointer to get to the next element
p26917
aVYou can use that to find everything following a comment, up to but not including another comment:
p26918
aVThis is a generator function, you use it to iterate over all 'next' elements:
p26919
aVor you can use it to create a list of all next elements:
p26920
aVYour example is a little too small for BeautifulSoup and it'll wrap each comment in a  tag but if we use a snippet from your original target  this works just fine:
p26921
aVIf  is a reference to the first comment in that snippet, the  generator gives me:
p26922
as(dp26923
g16
V100297
p26924
stp26925
a((dp26926
g2
(lp26927
VSee the  statement documentation; you can specify a context by adding  after the expression:
p26928
aVNote that you cannot add new locals to a function
p26929
aVYou can only change existing local variables (those that have been declared in the function at compile time)
p26930
aVSo, unless  is already defined in the function you are tracing, you cannot add  to that function's local variables
p26931
aVThe global variables are not limited in that manner; you can add to the globals namespace at will; just leave off the  part in that case
p26932
as(dp26933
g16
V100297
p26934
stp26935
a((dp26936
g2
(lp26937
VYou are seeing UTF-8 data being interpreted as Latin 1:
p26938
aVwhere  is the unicode codepoint for a latin small later n with tilde: 
p26939
aVYour terminal is probably configured for Latin-1 display; try decoding from UTF-8:
p26940
as(dp26941
g16
V100297
p26942
stp26943
a((dp26944
g2
(lp26945
VOn Windows, you want to use  instead;  only has 1/60th-second granularity, while the former gives you microsecond granularity instead
p26946
aVOr, to keep it cross-platform, use  instead, which will use the correct  function for your platform:
p26947
as(dp26948
g16
V100297
p26949
stp26950
a((dp26951
g2
(lp26952
VUse a separate function:
p26953
aVand then define  as:
p26954
aVAlternatively, use exception handling:
p26955
as(dp26956
g16
V100297
p26957
stp26958
a((dp26959
g2
(lp26960
VMake a  subclass of  and add the tree-only methods on that class instead
p26961
aVThen make your root an instance of , the rest of your graph uses  instances
p26962
as(dp26963
g16
V100297
p26964
stp26965
a((dp26966
g2
(lp26967
VUse the  function:
p26968
aVThe function will search for python packages (directories with a  file) and return these as a properly formatted list
p26969
aVIt'll start in the same dir as the setup
p26970
aVpy script but can be given an explicit starting directory instead, as well as exclusion patterns if you need it to skip some things
p26971
as(dp26972
g16
V100297
p26973
stp26974
a((dp26975
g2
(lp26976
VYou are adding a reference to the dictionary to your list, then clear the dictionary itself
p26977
aVThat removes the contents of the dictionary, so all references to that dictionary will show that it is now empty
p26978
aVCompare that with creating two variables that point to the same dictionary:
p26979
aVDictionaries are mutable; you change the object itself
p26980
aVCreate a new dictionary in the loop instead of clearing and reusing one:
p26981
aVor better still, have  return a dictionary instead:
p26982
as(dp26983
g16
V100297
p26984
stp26985
a((dp26986
g2
(lp26987
VYou can only use unicode escapes () in a unicode string literal
p26988
aVThey have no meaning in a byte string
p26989
aVA unicode literal () is a different type of Python object from a python byte string ()
p26990
aVIt's like using  versus ; the former has meaning in python literals (it's interpreted as a newline character), the latter just means a backslash and a capital N (two characters)
p26991
aVTo help understand the difference between Unicode and byte strings, please do read the Python Unicode HOWTO; I can also recommend the Joel Spolsky on Unicode article
p26992
as(dp26993
g16
V100297
p26994
stp26995
a((dp26996
g2
(lp26997
VYou could use sets for that, but a  can not be added to a set unfortunately
p26998
aVYou need to 'cast' the dictionaries to something that a set can handle, e
p26999
ag1298
aVa immutable type such as a sequence of tuples
p27000
aVCombine that with an index to return the referenced :
p27001
aVResult:
p27002
as(dp27003
g16
V100297
p27004
stp27005
a((dp27006
g2
(lp27007
VYou define a list literal by putting the elements in square brackets:
p27008
aVAlternatively, you build the list by defining an empty list, then appending the elements:
p27009
aVI strongly recommend you read the Python tutorial before continuing, it explains building python types and how to manipulate them for you
p27010
as(dp27011
g16
V100297
p27012
stp27013
a((dp27014
g2
(lp27015
VMySQL doesn't support real cursors, and the library only emulates them
p27016
aVAs such, you can only run one cursor per connection at a time
p27017
aVIn the loop you are opening a second cursor, and that's not something MySQL can handle
p27018
aVRead all rows from the first query before using the cursor for a new query
p27019
as(dp27020
g16
V100297
p27021
stp27022
a((dp27023
g2
(lp27024
VYour  elements contain some nested elements; search for the  tag within each  element, then take the  attribute with an item lookup:
p27025
as(dp27026
g16
V100297
p27027
stp27028
a((dp27029
g2
(lp27030
V1998 did not have 53 weeks; December 31st is week 52:
p27031
aVNote that the documentation for  states:
p27032
aVWeek number of the year (Sunday as the first day of the week) as a decimal number [00,53]
p27033
aVAll days in a new year preceding the first Sunday are considered to be in week 0
p27034
aVIt could be that your data source sees the days preceding the first sunday as week 1 instead
p27035
as(dp27036
g16
V100297
p27037
stp27038
a((dp27039
g2
(lp27040
VNote that the timeout only applies to users that do not contact the server in that time
p27041
aVA visit to your site within 20 minutes refreshes the cookie
p27042
aVYes, there is a security risk in allowing longer time-outs on cookies; it creates a longer window in which to compromise the client computer or try to exploit a XSS flaw in your application
p27043
aVI'd still set a limit on the cookie
p27044
aVI'd use the  to manage user authentication sessions anyway; it offers more fine-grained control over session lifetime (see this older answer of mine)
p27045
aVYou could even write a small piece of  javascript that pokes the server periodically when the user is active (keyboard and mouse input, poking, say, once every minute) to refresh that cookie; close the browser, session gone automatically within 20 minutes
p27046
as(dp27047
g16
V100297
p27048
stp27049
a((dp27050
g2
(lp27051
VYou are not appending the right variable to ; you are appending  but you should have appended  instead:
p27052
aVFor this use-case, you could use a  instead:
p27053
as(dp27054
g16
V100297
p27055
stp27056
a((dp27057
g2
(lp27058
VTake a look at the numeric types emulation in the datamodel and pick an operator hook that suits you
p27059
aVI don't think there is currently an operator that is an exact match though, so you'll end up surprising some poor hapless future code maintainer (could even be you) that you overloaded a standard operator
p27060
aVFor a Levenshtein Distance I'd just use a regular method instead
p27061
aVI'd find a  method a lot clearer when reading the code
p27062
as(dp27063
g16
V100297
p27064
stp27065
a((dp27066
g2
(lp27067
VYou could just use a less specific XPath expression:
p27068
aVYou could expand this (be ambitious) and select for the  >  tags, then go to the  ancestor (based off XPath query with descendant and descendant text() predicates):
p27069
aVbut since you need to then scan for the link anyway that doesn't actually buy you anything
p27070
as(dp27071
g16
V100297
p27072
stp27073
a((dp27074
g2
(lp27075
VYou can always manually delete the packages; you can run:
p27076
aVto remove that package from your  directory
p27077
aVYou may have to edit the  file in the same directory and remove the  entry from it
p27078
as(dp27079
g16
V100297
p27080
stp27081
a((dp27082
g2
(lp27083
VYou need to open  using an absolute path; the crondaemon may well be using different path from what you expect:
p27084
as(dp27085
g16
V100297
p27086
stp27087
a((dp27088
g2
(lp27089
VThat's 's fault, not Python's
p27090
aVRun  with the  switch:
p27091
aVor
p27092
aVLike , but only ANSI "color" escape sequences are output in "raw" form
p27093
aVUnlike ,
p27094
aVthe screen appearance is maintained correctly in most cases
p27095
aVANSI "color" escape sequences are sequences of the form:
p27096
aVwhere  the  "
p27097
aVis  zero  or  more color specification characters For the purpose of keeping track of
p27098
aVscreen appearance, ANSI color escape sequences are assumed to not move the cursor
p27099
aVYou  can  make  less
p27100
aVthink  that  characters  other  than  "m" can end ANSI color escape sequences by setting the environment
p27101
aVvariable LESSANSIENDCHARS to the list of characters which can end a color escape sequence
p27102
aVAnd you  can
p27103
aVmake  less  think  that  characters other than the standard ones may appear between the ESC and the m by
p27104
aVsetting the environment variable LESSANSIMIDCHARS to the list of characters which can appear
p27105
as(dp27106
g16
V100297
p27107
stp27108
a((dp27109
g2
(lp27110
VThe returned object is a file-like object, and you can use  to only read a partial response:
p27111
aVwould read only 10 lines, for example
p27112
aVNote that this won't guarantee a faster response
p27113
as(dp27114
g16
V100297
p27115
stp27116
a((dp27117
g2
(lp27118
VWhen you use the triple quote string you do not have to indent:
p27119
aVYou can also join string automatically by using parenthesis:
p27120
aVbecause python will join consecutive strings in one expression together automatically
p27121
aVYou are still free to use  signs to concatenate the strings explicitly, but do use parenthesis to make it one expression:
p27122
aVThe alternative would be to use a backslash before the end of the line:
p27123
aVbut I find parenthesis to be more readable
p27124
as(dp27125
g16
V100297
p27126
stp27127
a((dp27128
g2
(lp27129
VYou got the + operators mixed up:
p27130
aVotherwise you are just assigning the value  to , which is exactly the same as saying
p27131
aVand you do the same thing with your print statement, it's
p27132
aVor just use:
p27133
aV(no space at the end of the string)
p27134
as(dp27135
g16
V100297
p27136
stp27137
a((dp27138
g2
(lp27139
VIt indeed throws the error if your stacks do not support the containment tests
p27140
aVYou need to add a  method to them to support  testing
p27141
aVThere are other ways the  test can find items in your stack, but they are not recommended as they are less effcient than a  method could be; see the  expression documentation
p27142
as(dp27143
g16
V100297
p27144
stp27145
a((dp27146
g2
(lp27147
VSure there is, use  as the index:
p27148
aVNegative indexes are subtracted from the current length of the list, so index  is the one-but-last entry, etc
p27149
as(dp27150
g16
V100297
p27151
stp27152
a((dp27153
g2
(lp27154
VUse a generator:
p27155
aVThen  loop over that:
p27156
aVor turn in into a list again:
p27157
aVThe latter results in:
p27158
as(dp27159
g16
V100297
p27160
stp27161
a((dp27162
g2
(lp27163
VThe function call:
p27164
aVreturn , so the  item index failed
p27165
aVI guess no images where detected
p27166
as(dp27167
g16
V100297
p27168
stp27169
a((dp27170
g2
(lp27171
VNo, there is no way you can determine that
p27172
aVPython is a dynamic language, and a given function can return an arbitrary sequence of any size or no sequence at all, based on the inputs and other factors
p27173
aVFor example:
p27174
aVThis function will return a tuple half of the time, but  the other half, so Python has no way of telling you what  will return
p27175
aVThere are many more ways your decorator can fail, btw, not just when the function returns a sequence that the caller then unpacks
p27176
aVWhat if the caller expected a dictionary and starts trying to access keys, or a list and wants to know the length
p27177
as(dp27178
g16
V100297
p27179
stp27180
a((dp27181
g2
(lp27182
VYou are using the  file as an iterator, and that uses a largish buffer, delaying your prints
p27183
aVUse  instead; you can still make that into a loop using  with a sentinel:
p27184
aVYou can also add  to your print function call:
p27185
aVor, if you are on Python 2 instead of Python 3 (where  is a statement, not a function), you can directly flush the  buffer:
p27186
aVBy default,  is line-buffered, so python normally should flush the buffer whenever you print a newline
p27187
as(dp27188
g16
V100297
p27189
stp27190
a((dp27191
g2
(lp27192
VThe easiest would be to zero-pad the filenames when sorting:
p27193
aVwhich will pad each filename to 17 characters with  characters when sorting; so  is padded to  while  is left as is
p27194
aVLexographically,  sorts before
p27195
aVI picked 17 as a hardcoded value to simplify things; you could find the required value automatically by using this instead:
p27196
as(dp27197
g16
V100297
p27198
stp27199
a((dp27200
g2
(lp27201
VThe datastore Property classes are descriptors (like the python  decorator), but as custom classes that do not implement  you can set arbitrary attributes on those objects:
p27202
aVwhich can be generalized to a decorator with:
p27203
aVAs long as you access the Property via the class (and not the instance) you can retrieve those values again; given an instance you can do , for example
p27204
as(dp27205
g16
V100297
p27206
stp27207
a((dp27208
g2
(lp27209
VSublimeText clears auto-indent whitespace automatically if the  setting is enabled (default)
p27210
aVThis only affects blank lines
p27211
aVPython does not care about whitespace on blank lines; blank lines do not need to match the indentation of the rest of the code
p27212
aVHowever, if you copy lines to the python interpreter, empty lines signal the end of a block and that block is then compiled; this is different from running a saved file directly
p27213
aVIf you see indentation errors when running your python file, you are mixing tabs and spaces elsewhere in your code
p27214
aVRun your code with  to test
p27215
aVFor python code, you really want to use spaces only (convert tabs to spaces, set sublime to use spaces for indentation)
p27216
as(dp27217
g16
V100297
p27218
stp27219
a((dp27220
g2
(lp27221
VYou can define a special version of  using  to give it default arguments:
p27222
aVand  will then use those defaults throughout your code:
p27223
as(dp27224
g16
V100297
p27225
stp27226
a((dp27227
g2
(lp27228
VThe country name is missing, but the  library is not dealing with that case correctly
p27229
aVYou'll have to test for the empty country case yourself:
p27230
as(dp27231
g16
V100297
p27232
stp27233
a((dp27234
g2
(lp27235
VUse the  to create a callable that'll apply a set of arguments to another callable:
p27236
aVNow the  value is a callable object;  will in turn call  and return the result
p27237
aVYou'd still need to 'process' this dictionary (testing with the  function:
p27238
aVof course
p27239
aVIf you are using Python 3, use  instead
p27240
aVA  setup let's you add additional arguments as needed (provided  supports them):
p27241
aVYou could even create a dictionary subclass that does this automatically when accessing a key:
p27242
aVthen define  as:
p27243
as(dp27244
g16
V100297
p27245
stp27246
a((dp27247
g2
(lp27248
VThere is no way to detect how the returned attribute was intended to be used
p27249
aVEverything on python objects are attributes, including the methods:
p27250
aVPython first looks up the attribute ( or ), and if you meant to call it (added parenthesis) then Python invokes the callable after lookup up the attribute:
p27251
aVIn the above code I separated the lookup of  from calling
p27252
aVSince there is no distinction, you cannot detect in  what the returned attribute will be used for
p27253
aVis called whenever normal attribute access fails; in the following example  is defined on the class, so  is not called; it is only called for  and :
p27254
aVNote that functions are not the only objects that you can invoke (call); any custom class that implements the  method will do:
p27255
aVYou could use that return objects from  that can both be called and used as a value in different contexts
p27256
as(dp27257
g16
V100297
p27258
stp27259
a((dp27260
g2
(lp27261
VIf you parsed the  file using the  library, the value of  would still be a string containing a Python dict literal; it is not yet a dictionary
p27262
aVUse the  function to load it into an actual dictionary:
p27263
aVIf you control the output format, you may want to rethink the strategy though; there are better formats for storing the same information
p27264
as(dp27265
g16
V100297
p27266
stp27267
a((dp27268
g2
(lp27269
VOn Linux, if you have an open file you can still read it even when deleted
p27270
aVDo this:
p27271
aVThe  file is deleted as soon as it is created; the OS will reclaim the space once the file is closed (which cpython will do for you as soon as the request is completed and the last reference to the file object is deleted)
p27272
aVOptionally, you could use the  hook to explicitly close the file object
p27273
as(dp27274
g16
V100297
p27275
stp27276
a((dp27277
g2
(lp27278
VIn the module itself, the  function returns the module namespace as a dictionary; simply use the first element of each named tuple as the key to set the integer values:
p27279
aVor from outside the module, use  to add attributes to the module:
p27280
as(dp27281
g16
V100297
p27282
stp27283
a((dp27284
g2
(lp27285
VUsing :
p27286
aVwhere  is now a iterable; call  if you want to materialize that to a full list:
p27287
as(dp27288
g16
V100297
p27289
stp27290
a((dp27291
g2
(lp27292
VYou can split on more than one space with a simple regular expression:
p27293
aVDemonstration:
p27294
as(dp27295
g16
V100297
p27296
stp27297
a((dp27298
g2
(lp27299
VPython unicode escapes either are 4 hex digits () or 8 (); for a codepoint beyond U+FFFF you need to use the latter (a capital U), make sure to left-fill with enough zeros:
p27300
aV(And yes, the U+1D15D codepoint (MUSICAL SYMBOL WHOLE NOTE) is in the above example, but your browser font may not be able to render it, showing a place-holder glyph (a box or question mark) instead
p27301
aVBecause you used a  escape, you replaced  in  with two characters, the codepoint U+1D15 (, latin letter small capital ou), and the ASCII character
p27302
aVUsing a 32-bit unicode literal works:
p27303
aVwhere again the U+1D15D codepoint could be displayed by your font as a placeholder glyph instead
p27304
as(dp27305
g16
V100297
p27306
stp27307
a((dp27308
g2
(lp27309
VIt's generally not a good idea to use
p27310
aVWildcard importing leads to namespace pollution; you imported more names than you need and if you accidentally refer to an imported name you may not get the NameError you wanted
p27311
aVAlso, if a future version of the library added additional names, you could end up masking other names, leading to stranger bugs still:
p27312
aVIf you upgrade  and it now includes a  it'll replace the  import in the line above
p27313
as(dp27314
g16
V100297
p27315
stp27316
a((dp27317
g2
(lp27318
VThe number is a key in the dictionary:
p27319
aVreturns a list of dictionary keys, see the Python  type documentation for the full API of dictionaries
p27320
as(dp27321
g16
V100297
p27322
stp27323
a((dp27324
g2
(lp27325
VYou are looking at UTF-8 encoded data:
p27326
aVTo decode it to Unicode text use
p27327
aVIf you printed that string directly to the terminal and your terminal is configured to handle UTF-8, it'll display those characters decoded for you, but the  representation shows python literal representations for data contained
p27328
aVPlease, please, do read the Python Unicode HOWTO and The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p27329
as(dp27330
g16
V100297
p27331
stp27332
a((dp27333
g2
(lp27334
VYou should use the  built-in function to list members of objects instead accessing of either  or  directly
p27335
aVAn instance  will only list attributes set directly on the instance, while  will list attributes (including methods) on the class and bases of that class as well
p27336
aVIt'll also list anything defined as a slot
p27337
aVYou can use the  module to help you filter the output of ; if you are not interested in methods for example the  can help
p27338
as(dp27339
g16
V100297
p27340
stp27341
a((dp27342
g2
(lp27343
VThe underlying  code also scans for  and  links from the simple index and does this quite aggressively
p27344
aVThe   file lists  as the homepage, so all  links on the simple index link there
p27345
aVYou can prevent  from trying to connect to that host by setting up a whitelist of hosts it can connect to:
p27346
aVfor example
p27347
as(dp27348
g16
V100297
p27349
stp27350
a((dp27351
g2
(lp27352
VSetuptools does not override the   command itself; only the  and  subcommands
p27353
aVSo, to create your own subclass you need to import from the  module, which contains a  class (subclass of ):
p27354
as(dp27355
g16
V100297
p27356
stp27357
a((dp27358
g2
(lp27359
VThe error you see is unrelated to image storing in the ZODB
p27360
aVTo store larger pieces of data, you really want to use a ZODB  instead of putting the image data directly in an attribute
p27361
aVs are stored separately on disk and do not flush the ZODB cache, and can be streamed back to the client on access again
p27362
aVTo create and store a , use:
p27363
aVOnce created like that, you can later use  as a file; you need to open it in read or write mode first
p27364
aVTo return the contents of the blob from a view, for example, use:
p27365
aVBlobs are bound to transactions and changes to them are automatically discarded if the transaction is rolled back
p27366
as(dp27367
g16
V100297
p27368
stp27369
a((dp27370
g2
(lp27371
VYou can turn a path into an object by using the traversing API:
p27372
aVYou'll need a context to traverse from; use the site root for URL paths for example
p27373
aVIf all you have is a URL, you'd need to parse out the path from it:
p27374
as(dp27375
g16
V100297
p27376
stp27377
a((dp27378
g2
(lp27379
VYou want to select all descendant text, not just child text:
p27380
aVNote the double slash between  and  there
p27381
aVThis potentially will also include a lot of inter-tag whitespace though, you you'll need to clean that up
p27382
aVExample using :
p27383
as(dp27384
g16
V100297
p27385
stp27386
a((dp27387
g2
(lp27388
VTesting for identity () is as simple pointer comparison (are the two values the same object)
p27389
aVTesting for equality needs to do more work than that; for lists for example it does need to test for equality of each and every element in both lists until either something tests negative for equality or all elements in the shortest list have been tested
p27390
aVNote that the two operators are quite different in what they test:
p27391
aVJust because two objects are equal does not mean that they are the same object;  tests for the latter
p27392
as(dp27393
g16
V100297
p27394
stp27395
a((dp27396
g2
(lp27397
VYou want to make your type a subclass of , not of , really
p27398
aVEven better still, use  directly instead, it already is a subclass of  and can be used to implement your tree 'type' easily:
p27399
aVDemonstration:
p27400
aVIf you must add your own methods and behaviour, then I'd subclass  and build upon that base:
p27401
aVAs this is still a subclass of , the  library will happily convert that to a JSON object without special handling
p27402
as(dp27403
g16
V100297
p27404
stp27405
a((dp27406
g2
(lp27407
VYou need to figure out what encoding  used; according to this post that could any of the MS-DOS codepages
p27408
aVYou could go through each of the MS-DOS encodings; most of those have a codec in the python standard library
p27409
aVI'd try  and  first; the latter is the MS-DOS predecessor of cp1252 I think
p27410
aVPass the encoding to :
p27411
aVYou really should look into using  instead of using  for this task though, it'll save you having to deal with issues like these at least
p27412
as(dp27413
g16
V100297
p27414
stp27415
a((dp27416
g2
(lp27417
VWithin your  function you are referring to the function as if it's a list:
p27418
aVBecause  is not a list, Python tries to ask it for item  with the  method, but that doesn't exist either
p27419
aVPerhaps you meant to use  instead
p27420
as(dp27421
g16
V100297
p27422
stp27423
a((dp27424
g2
(lp27425
VYou mixed up  and  in your  function; you test if  is a prime, not ; here is the correct function:
p27426
aVThis,  will be set to an empty list (as  returns an empty list) and your  (for any ) will fail with an index error
p27427
aVAnother way for  to be empty is when  never returns True; you don't show us that function to verify it
p27428
aVYour next error is in ; you define a  variable (a list) first, but later refer to a non-existing  variable, leading to a
p27429
aVThe next name error is going to be  further in that function
p27430
aVYou really want to re-read the Python tutorial; you are missing out on many python idioms in your code; specifically on how to create loops over sequences (hint:  is easier to use than a  loop with an index variable) and how to append items to a list
p27431
aVMy personal toolkit defines this:
p27432
aVwhich doesn't need a  test
p27433
as(dp27434
g16
V100297
p27435
stp27436
a((dp27437
g2
(lp27438
VWhen you fork a process, it 'inherits' the parent process memory, including the logger configuration
p27439
aVFrom the Fork Wikipedia page:
p27440
aVThe fork operation creates a separate address space for the child
p27441
aVThe child process has an exact copy of all the memory segments of the parent process, though if copy-on-write semantics are implemented actual physical memory may not be assigned (i
p27442
ag7233
aV, both processes may share the same physical memory segments for a while)
p27443
aVBoth the parent and child processes possess the same code segments, but execute independently of each other
p27444
aVThis is not unique to Python; this happens for any UNIX process that is forked, be it implemented in C, Perl or Python
p27445
aVThe  module uses this (on platforms that support it) to spin up new processes quickly
p27446
aVNote that inheriting a logger may lead to race conditions; the  module only knows about thread-safety; it uses a thread lock to serialize access to handlers, but that lock is not shared across processes (everything in the child process is a copy, and not the same object)
p27447
aVThis means that when you log messages from both the parent and child at the same time, the log entries can end up mixed together as the OS switches between the two processes while writing the log entries to the file
p27448
as(dp27449
g16
V100297
p27450
stp27451
a((dp27452
g2
(lp27453
VSince everything in Python is an object, there is no black magic about it; this is simply duck typing; if you create an object that walks and talks like a module, then the rest of Python is none the wiser
p27454
aVHowever, for your specific use-case, you don't need to resort to this level of deception
p27455
aVSimply calculate version name at import time:
p27456
aVNowhere is it stated that module globals can only be literal values; just use a Python expression for them instead
p27457
aVAfter all, your  variable is not going to change during the lifetime of your program, you only need to generate it once
p27458
aVUse a property only when you need an attribute that needs to be re-calculated every time you access it
p27459
as(dp27460
g16
V100297
p27461
stp27462
a((dp27463
g2
(lp27464
VAll you need to do is wrap the function in a  call:
p27465
aVor apply it as a decorator to the function definition:
p27466
aVwhich comes down to the same thing
p27467
aVJust remember; the  syntax is just syntactic sugar for writing , where  is the decorated object
p27468
as(dp27469
g16
V100297
p27470
stp27471
a((dp27472
g2
(lp27473
VI'd use a ABC class for that, but yes; you can even use a  for that very use-case
p27474
aVSubclasses of the ABC are still free to implement  as an attribute instead; the ABC will only verify the existence of , not what type it is
p27475
as(dp27476
g16
V100297
p27477
stp27478
a((dp27479
g2
(lp27480
VThere is no  function, because SSH treats all files as binary
p27481
aVFTP on the other hand, treats files as textfiles by default, translating line endings, so a separate  was added to prevent that translation for binary files
p27482
aVTo quote from the  method:
p27483
aVThe mode indicates how the file is to be opened:  for reading,  for writing (truncating an existing file),  for appending,  for reading/writing,  for reading/writing (truncating an existing file),  for reading/appending
p27484
aVThe python  flag is ignored, since SSH treats all files as binary
p27485
as(dp27486
g16
V100297
p27487
stp27488
a((dp27489
g2
(lp27490
VYou are misunderstanding what  does
p27491
aVIt removes any of the characters found in the string you pass
p27492
aVFrom the  documentation:
p27493
aVThe chars argument is a string specifying the set of characters to be removed
p27494
aVemphasis mine; the word  there is crucial
p27495
aVBecause  is treated as a set,  will remove all , , , , , , , ,  and  characters from the start and end of your input string
p27496
aVSo the  and  characters from the end of your input string were also removed; those characters are part of the set
p27497
aVTo remove a string from the start or end, use slicing instead:
p27498
as(dp27499
g16
V100297
p27500
stp27501
a((dp27502
g2
(lp27503
VYou are seeing the effects of line buffering
p27504
aVFlush  first (using  for backwards compatibility with Python 2):
p27505
aVThe  function in Python 2 is certainly different from the one in Python 3 (where the  line is effectively meaningless)
p27506
aVIn Python 3, I/O has been overhauled and  buffering semantics have changed subtly
p27507
aVIn Python 2, the  call flushes  automatically, in Python 3 this is no longer the case
p27508
aVIf you use the  function instead of reading from  directly, you do not need to flush at all:
p27509
as(dp27510
g16
V100297
p27511
stp27512
a((dp27513
g2
(lp27514
VYou are comparing apples and pears here
p27515
aVOne method does simple assignment, the other calls a function
p27516
aVYes, function calls will add overhead
p27517
aVYou should strip this down to the bare minimum for :
p27518
aVNow all we did was add a function call ( does the same thing), so you can measure the extra time a function call takes
p27519
aVYou cannot state that this is nearly 4 times slower, no, the function call adds a 0
p27520
aV11 second overhead for 1
p27521
aV000
p27522
aV000 iterations
p27523
aVIf instead of  we do something that takes 0
p27524
aV5 seconds to execute one million iterations, moving them to a function won't make things take 2 seconds
p27525
aVIt'll now take 0
p27526
aV61 seconds because the function overhead doesn't grow
p27527
aVA function call needs to manipulate the stack, pushing the local frame onto it, creating a new frame, then clear it all up again when the function returns
p27528
aVIn other words, moving statements to a function adds a small overhead, and the more statements you move to that function, the smaller the overhead becomes as a percentage of the total work done
p27529
aVA function never makes those statements themselves slower
p27530
aVA Python function is just an object stored in a variable; you can assign functions to a different variable, replace them with something completely different, or delete them at any time
p27531
aVWhen you invoke a function, you first reference the name by which they are stored () and then invoke the function object (); that lookup has to happen every single time in a dynamic language
p27532
aVYou can see this in the bytecode generated for a function:
p27533
aVThe  opcode looks up the name () in the global namespace (basically a hash table lookup), and pushes the result onto the stack
p27534
aVthen invokes whatever is on the stack, replacing it with the return value
p27535
aVreturns from a function call, again taking whatever is topmost on the stack as the return value
p27536
as(dp27537
g16
V100297
p27538
stp27539
a((dp27540
g2
(lp27541
VYou have at least one stale object in your catalog that is breaking your sharing tab; please do a full reindex
p27542
aVVia your control panel ('site setup'), go to the ZMI, locate the  tool object, go to the "Advanced" tab
p27543
aVThere, under "Catalog Maintenance" click on the "Update Catalog" button, and wait for a full reindex to complete
p27544
as(dp27545
g16
V100297
p27546
stp27547
a((dp27548
g2
(lp27549
VCall it in your program startup code; triggered from a  test preferably:
p27550
aVand put everything you need to do that is not part of your module-the-library into the main function, including logging configuration
p27551
as(dp27552
g16
V100297
p27553
stp27554
a((dp27555
g2
(lp27556
VPopping an item from the list moves everything after that item up one place
p27557
aVThus, you end up with an index  that is easily outside of the range
p27558
aVRemove items from your list after the loop, or loop over the list in reverse:
p27559
as(dp27560
g16
V100297
p27561
stp27562
a((dp27563
g2
(lp27564
VUse tuple unpacking (assigning each key and value to a separate variable,  and  in the following examples) and a dict comprehension:
p27565
aVor test explicitly for  instead of all falsey values (numeric 0, empty sequences, etc
p27566
ag4212
aVIn Python 3, you need to use just :
p27567
aVFor your sample, all above variations result in:
p27568
as(dp27569
g16
V100297
p27570
stp27571
a((dp27572
g2
(lp27573
VCall the  method on the  object, pass that to  to create a UNIX timestamp:
p27574
as(dp27575
g16
V100297
p27576
stp27577
a((dp27578
g2
(lp27579
VYou'll need to convert it to a normal loop; don't try to mix in a side-effect function:
p27580
aVor, if you want to track combinations tested, move the count before the :
p27581
as(dp27582
g16
V100297
p27583
stp27584
a((dp27585
g2
(lp27586
VWhen using a setuptools install script (), you test for the required module, and update the installation dependencies list to add backports if needed
p27587
aVFor example, say you need the  class
p27588
aVThe documentation states it was added in Python 2
p27589
aV7, but a backport is available that works on Python 2
p27590
aV4 and up
p27591
aVIn  you test for the presence of the class in
p27592
aVIf the import fails, add the backport to your requirements list:
p27593
aVthen in your code where you need  use the same test:
p27594
aVand rely on  or  or  or other installation tools to fetch the extra library for you
p27595
aVMany recent core library additions have backports available, including  (called ), ,  (the  package, use  as a fallback)
p27596
aVYou'll still have to read the documentation; the Python documentation is excellent, and for new modules, classes, methods, functions or arguments the documentation mentions explicitly in what Python version they were added
p27597
as(dp27598
g16
V100297
p27599
stp27600
a((dp27601
g2
(lp27602
VYou cannot chain a expression like that; chain the tests using  operators or use a  expression instead:
p27603
aVThe expression  means something different, it is interpreted as  instead; the first test is either  or , and neither of those two values will ever be equal to any of the other numbers and that branch will always evaluate to
p27604
aVYou will still get the  for  though, since your  branch refers to  but it is never set in that branch
p27605
aVWhen the  branch executes, all Python sees is:
p27606
aVand  is never assigned a value in that case
p27607
aVYou need to calculate  separately in that branch still, or move the calculation of the  value out of the  statement altogether; I am not familiar with the calculation of Easter so I don't know what you need to do in this case
p27608
as(dp27609
g16
V100297
p27610
stp27611
a((dp27612
g2
(lp27613
VDo not use ; instead use the  codec to interpret that data:
p27614
aVThe  encoding interprets  character sequences the same way Python would when parsing a unicode literal in the source code:
p27615
aVThe exception you see is not caused by the  statement though; I suspect it is being caused by an attempt to print the result instead
p27616
aVPython will try to encode  values automatically and will detect what encoding the current terminal uses
p27617
aVYour Eclipse output window uses a different encoding from your terminal; if the latter is configured to support Latin-1 then you'll see that exact exception, as Python tries to encode Hebrew codepoints to an encoding that doesn't support those:
p27618
aVThe solution is to reconfigure your terminal (UTF-8 would be a good choice), or to not print  values with codepoints that cannot be encoded to Latin-1
p27619
aVIf you are redirecting output from Python to a file, then Python cannot determine the output encoding automatically
p27620
aVIn that case you can use the  environment variable to tell Python what encoding to use for standard I/O:
p27621
as(dp27622
g16
V100297
p27623
stp27624
a((dp27625
g2
(lp27626
VWhen you use a leading  on a number, Python interprets that as a base-8 (octal) number
p27627
aVRemove the leading :
p27628
aVPython 3 has improved on this; all numbers with a leading  are considered invalid now, to create a octal number you always have to use the  prefix instead:
p27629
as(dp27630
g16
V100297
p27631
stp27632
a((dp27633
g2
(lp27634
VYou create the relationships the other way around; add foreign keys to the  type to create a Many-to-One relationship:
p27635
aVAny one person can only be connected to one address and one anniversary, but addresses and anniversaries can be referenced from multiple  entries
p27636
aVand  objects will be given a reverse, backwards relationship too; by default it'll be called  but you can configure a different name if you need to
p27637
aVSee Following relationships "backward" in the queries documentation
p27638
as(dp27639
g16
V100297
p27640
stp27641
a((dp27642
g2
(lp27643
VMove the  test to the bottom (leaving the  part at the top):
p27644
aVand then it'll work:
p27645
aVBy the time  is executed, you need to have defined your test case; if you call  at the top, no tests are defined yet
p27646
as(dp27647
g16
V100297
p27648
stp27649
a((dp27650
g2
(lp27651
VRelative imports only work for packages, but when you import  you are running a module instead
p27652
aVThe current directory may hold a  file but that doesn't make  part of a package yet
p27653
aVFor something to be considered a package, you need to import the directory name instead
p27654
aVThe following would work:
p27655
aVthen in  put:
p27656
aVand only then is  part of a package and do relative imports work
p27657
aVThe relative import now has something to be relative to, the  parent
p27658
as(dp27659
g16
V100297
p27660
stp27661
a((dp27662
g2
(lp27663
VFor this specific case, use either a  or a  object instead:
p27664
aVor
p27665
aVBoth are subclasses of the standard  type
p27666
aVThe  type adds some more helpful functionality like summing two counters or listing the most common entities that have been counted
p27667
aVThe  class can also be given other default types; use  for example to collect things into lists per key
p27668
aVWhen you want to compare performance of two different approaches, you want to use the  module:
p27669
aVThis shows that using  is a little faster
p27670
aVThere is, however, a third option to consider; catching the  exception:
p27671
aVwhich happens to be the fastest, because only 1 in 10 cases are for a new key
p27672
aVLast but not least, the two alternatives I proposed:
p27673
aVSo the  type is slowest, but  is very fast indeed
p27674
aVs do a lot more work though, and the extra functionality can bring ease of development and execution speed benefits elsewhere
p27675
as(dp27676
g16
V100297
p27677
stp27678
a((dp27679
g2
(lp27680
VYou need to install setuptools first; it has it's own installation script (it's part of the egg file):
p27681
aVNote that it, too, supports a  option
p27682
aVIt'll find your  binary (and not the 2
p27683
aV6 version) because you downloaded the  egg version
p27684
as(dp27685
g16
V100297
p27686
stp27687
a((dp27688
g2
(lp27689
VIt's located in the  file
p27690
aVThere is a  file there too, to guide you in understanding the source
p27691
aVPython dictionaries use a hashtable with open addressing to map keys to slots
p27692
aVConflicts are resolved by 'perturbing' the key; an algorithm that'll start with a large step, then use smaller and smaller steps until it scans the table for the next empty slot
p27693
aVThere are several articles on the web, including this blog post; you can also pick up the book Beautiful Code for an excellent exposure of the code
p27694
as(dp27695
g16
V100297
p27696
stp27697
a((dp27698
g2
(lp27699
VYour  value still has a newline attached to it
p27700
aVStrip it first:
p27701
as(dp27702
g16
V100297
p27703
stp27704
a((dp27705
g2
(lp27706
VGo straight to the  library; it holds a connection pool in the  module
p27707
aVYou could replace the pool or adjust it by hacking the  module perhaps
p27708
as(dp27709
g16
V100297
p27710
stp27711
a((dp27712
g2
(lp27713
VNo, I don't think there is a way to load all replies at once
p27714
aVBut, you can add extra metadata to the post type to be able to run a in-order-style query, where counting the number of replies becomes a simple calculation with data already loaded for the parents node
p27715
aVSee this article on how you could do that (it uses the MySQL SQL dialect, and PHP, but the principles still apply)
p27716
aVBasically, you add  and  fields to the nodes in your tree that define an ordering, letting you easily count the number of items below a given root element in the tree
p27717
aVIt's like a Binary Tree in a database table
p27718
aVThe principle is taken from this excellent database design book: "Joe Celko's Trees and Hierarchies in SQL for Smarties"
p27719
as(dp27720
g16
V100297
p27721
stp27722
a((dp27723
g2
(lp27724
VIf you want  to be a property, you still need to use the  decorator in your implementation:
p27725
aVAll that an ABC metaclass does is test wether or not you have provided the same name in the concrete class; it doesn't care if it is a method or a property or a regular attribute
p27726
aVBecause it doesn't care, it doesn't magically apply  decorators either
p27727
aVThis is a good thing; perhaps in a specific implementation a static attribute is enough to satisfy the requirement, and a property would be overkill
p27728
aVThe purpose of a ABC metaclass is to help you detect gaps in your implementation; it never was intended to enforce the types of the attributes
p27729
aVNote that before Python 3
p27730
aV3 you can not combine a  with an
p27731
aVYou would have to use an  decorator instead
p27732
aVThere is an ambiguity there when your property needs more than a simple getter in that case; Python 3
p27733
aV3 covers that case much better (see issue 11610 for the painful details)
p27734
as(dp27735
g16
V100297
p27736
stp27737
a((dp27738
g2
(lp27739
VBecause  is a immutable, you cannot magically turn it into a mutable type
p27740
aVYour methods are no-ops
p27741
aVThey change  in the local namespace, by reassigning it to something else
p27742
aVThey no longer point to the instance
p27743
aVIn other words, both methods leave the original instance unaltered
p27744
aVYou cannot do what you want to do with a subclass of
p27745
aVYou'll have to create a custom class from scratch using the numeric type hooks instead
p27746
aVBackground:  has a  method that assigns the actual value to , and there is no  method to support in-place adding
p27747
aVThe  method is not ignored, but you can leave it out altogether since  already did the work
p27748
aVAssigning to  means you just replaced the reference to the instance with something else, you didn't alter anything about :
p27749
aVBecause  does not have a  in-place add method, your  is interpreted as  instead; again, you are assigning to  and replacing it with a new value altogether
p27750
as(dp27751
g16
V100297
p27752
stp27753
a((dp27754
g2
(lp27755
VNo, character classes can only contain literal characters or other character classes; your example matches anything that is not a , the  anchor, is ignored as it is not a character class itself
p27756
aVNote that the  caret negates the character group
p27757
aVUse a group instead with a  'or' symbol instead:
p27758
aVI used a non-capturing group there () to group the two options
p27759
aVThe group matches any characters that are not , or it matches the  end-of-string anchor
p27760
as(dp27761
g16
V100297
p27762
stp27763
a((dp27764
g2
(lp27765
VModules are just a namespace, an object, stored in the  mapping
p27766
aVIf there are no other references to anything belonging in that module, you can remove it from the  mapping to delete it again:
p27767
as(dp27768
g16
V100297
p27769
stp27770
a((dp27771
g2
(lp27772
VSlicing in python strings refers to using the  notation
p27773
aVIn your case, you can simply use:
p27774
aVto split the line and rejoin it with a tab:
p27775
as(dp27776
g16
V100297
p27777
stp27778
a((dp27779
g2
(lp27780
VYou don't
p27781
aVA tripple-quoted string is just notation sugar, it results in a normal Python string regardless:
p27782
aVYou use tripple quotes to make inclusion of newlines easier:
p27783
aVis easier to read than:
p27784
aVbut the end result for these two ways of declaring a string value is exactly the same
p27785
as(dp27786
g16
V100297
p27787
stp27788
a((dp27789
g2
(lp27790
VYes, deploy your application on a different WSGI server, see the Flask deployment options documentation
p27791
aVThe server component that comes with Flask is really only meant for when you are developing your application; it can only handle one request at a time
p27792
aVThe above document lists several options for servers that can handle concurrent requests
p27793
as(dp27794
g16
V100297
p27795
stp27796
a((dp27797
g2
(lp27798
VYou need to create subqueries, then select from those subqueries:
p27799
aVThe  method returns an Alias object, which does not support  queries directly
p27800
aVSo instead, we need to build a  construct, passing in the  function result instead, so you still get the results mapped to the correct objects
p27801
as(dp27802
g16
V100297
p27803
stp27804
a((dp27805
g2
(lp27806
VThe  database offers a in-memory option itself
p27807
aVUse  as the filename to create it
p27808
aVNo file is created for the connection, and closing python will close the in-memory database and the schema and all data in it is discarded
p27809
aVYour only other option is to use a temporary filename;  insists on handling the file itself in it's entirety
p27810
aVYou cannot pass in a file-like object, it must be a filename or the string
p27811
as(dp27812
g16
V100297
p27813
stp27814
a((dp27815
g2
(lp27816
VYou should not use ; remove the  wildcard character and your code will work
p27817
aVWith the wildcard character, the argument passed into  is seen as one of potentially more extra positional arguments, so  inside  is a list of those arguments, with the first element being the list you passed in when you called :
p27818
aVYour function also will always return ; you do not update  anywhere
p27819
aVYou probably meant to assign the result of  to :
p27820
as(dp27821
g16
V100297
p27822
stp27823
a((dp27824
g2
(lp27825
VYou use  to add items to an initially empty list instead
p27826
aVNote that python can loop over sequences directly, and you usually do not need indexes at all
p27827
aVI've used the  function to add indexes to the outer loop instead (because you seem to need to index into  and  there)
p27828
aVadds items to the end of the list:
p27829
aVYou may want to read over the Python tutorial; it explains how python lists work nicely
p27830
as(dp27831
g16
V100297
p27832
stp27833
a((dp27834
g2
(lp27835
VThat would be quite correct;  contains an invalid escape, the JSON standard does not allow for a  followed by just numbers
p27836
aVWhatever produced that code should be fixed
p27837
aVIf that is impossible, you'll need to use a regular expression to either remove those escapes, or replace them with valid escapes
p27838
aVIf we interpret the  number as an octal number, that would point to the unicode code point U+00E9, the  character (LATIN SMALL LETTER E WITH ACUTE)
p27839
aVYou can 'repair' your JSON input with:
p27840
aVUsing  your example can be loaded:
p27841
aVYou may need to adjust the interpretation of the codepoints; I choose octal (because  is an actual word), but you need to test this more with other codepoints
p27842
as(dp27843
g16
V100297
p27844
stp27845
a((dp27846
g2
(lp27847
VUse the  function to access dynamic attributes:
p27848
aVwhich would do exactly the same thing as
p27849
as(dp27850
g16
V100297
p27851
stp27852
a((dp27853
g2
(lp27854
VUse the  function with a  format
p27855
aVThe  part tells  to use at least 2 digits and to use zeros to pad it to length,  means lower-case hexadecimal
p27856
as(dp27857
g16
V100297
p27858
stp27859
a((dp27860
g2
(lp27861
VYou could try a few different things:
p27862
aVmove the file to a different directory, cd to the same directory, and again try running
p27863
aVOpen the python2
p27864
aV7 interactive prompt (just run ) in the same directory as where the file resides
p27865
aVThen run:
p27866
aVto attempt the installation manually
p27867
aVIf that still doesn't work, run  and run the following python code, and add the information shown to your question:
p27868
aVLast but not least, test that the downloaded egg was not somehow corrupted or truncated
p27869
aVTest for the md5 hash and size:
p27870
aVIf they don't match, redownload the file and try again
p27871
as(dp27872
g16
V100297
p27873
stp27874
a((dp27875
g2
(lp27876
VYou are understanding it correctly
p27877
aVYou cannot use  to assign to in a nested scope in Python 2
p27878
aVIn Python 3, you can still use it as a binding occurrence by marking the variable as ; this is a keyword introduced for just this usecase:
p27879
aVIn python 2, you have a few work-arounds; using a mutable to avoid needing to bind it, or (ab)using a function property:
p27880
aVor
p27881
as(dp27882
g16
V100297
p27883
stp27884
a((dp27885
g2
(lp27886
VSure, you created  in the function, when the function exits it goes out of scope and is automatically cleaned up
p27887
aVReturn it at the end of the function and store the result:
p27888
as(dp27889
g16
V100297
p27890
stp27891
a((dp27892
g2
(lp27893
VPlease do read the Python Unicode HOWTO; it explains how to process and include non-ASCII text in your Python code
p27894
aVIf you want to include Japanese text literals in your code, you have several options:
p27895
aVUse unicode literals (create  objects instead of byte strings), but any non-ascii codepoint is represented by a unicode escape character
p27896
aVThey take the form of , so a backslash, a  and 4 hexadecimal digits:
p27897
aVwould be one character, the katakana 'ru' codepoint ('\u30eb')
p27898
aVUse unicode literals, but include the characters in some form of encoding
p27899
aVYour text editor will save files in a given encoding (say, UTF-16); you need to declare that encoding at the top of the source file:
p27900
aVwhere '\u30eb' is included without using an escape
p27901
aVThe default encoding for Python 2 files is ASCII, so by declaring an encoding you make it possible to use Japanese directly
p27902
aVUse byte string literals, ready encoded
p27903
aVEncode the codepoints by some other means and include them in your byte string literals
p27904
aVIf all you are going to do with them is use them in encoded form anyway, this should be fine:
p27905
aVI encoded '\u30eb' to UTF-16 little-endian because that's the default Windows NTFS filename encoding
p27906
aVNext problem will be your terminal, the Windows console is notorious for not supporting many character sets out of the box
p27907
aVYou probably want to configure it to handle UTF-8 instead
p27908
aVSee this question for some details, but you need to run the following command in the console:
p27909
aVto switch to UTF-8, and you may need to switch to a console font that can handle your codepoints (Lucida perhaps
p27910
as(dp27911
g16
V100297
p27912
stp27913
a((dp27914
g2
(lp27915
VYou'll have to pass it in explicitly:
p27916
aVand extend  to accept that as an argument
p27917
as(dp27918
g16
V100297
p27919
stp27920
a((dp27921
g2
(lp27922
VUse the  tool:
p27923
aVThe  function loops over each row in , take the first letter of the first column, and give you a tuples with each  values
p27924
aVThe  value is another iterable, you can loop over that (with a  loop, for example) to list all rows that have that first letter
p27925
aVThis does rely on the rows being sorted already
p27926
aVIf your rows alternate between first letters:
p27927
aVit'll print those as separate groups:
p27928
aVYou may want to add a  ordering instruction to your query to ensure correct grouping
p27929
aVThis is what I see when I create a test db:
p27930
as(dp27931
g16
V100297
p27932
stp27933
a((dp27934
g2
(lp27935
VYou can put the pipeline
p27936
aVcfg file anywhere; you tell  where to find it from the command line:
p27937
aVThis is more complex
p27938
aVYour target site is a Wiki, and the page names are part of the query string there
p27939
aVThe  needs to be used as the id of the new Plone page, and URLs used in other pages need to be rewritten to match
p27940
aVYou can certainly do that in the pipeline, but is a little more complex than can easily be written up here
p27941
aVFollow the documentation for  (the  component will help rewrite URLs), and feel free to ask specific questions about problems you encounter here on SO
p27942
aVCheck the logs and see what funnelweb already finds and uploads
p27943
aVYou may have to adjust the webcrawler settings; this varies from site to site
p27944
aVWithout more details about the site I can only give you this general hint
p27945
as(dp27946
g16
V100297
p27947
stp27948
a((dp27949
g2
(lp27950
VSure, use the  built-in function and a list comprehension:
p27951
aVDemo:
p27952
as(dp27953
g16
V100297
p27954
stp27955
a((dp27956
g2
(lp27957
VYou need to remove your  registration from the  file, because your legacy package is using the  namespace
p27958
aVThe  namespace has always been auto-loaded; the  function is implicitly being loaded for that namespace since before it was an official namespace
p27959
aVWhen Zope started to support packages outside of the  namespace, however, the decision was made (wisely) to make registration explicit instead, and the  was introduced to let you use the old registration hook if you still needed it
p27960
aVIn your case, however, that means your  function is being called twice; once because it is a  package, and once because you explicitly registered it
p27961
as(dp27962
g16
V100297
p27963
stp27964
a((dp27965
g2
(lp27966
VThe  library uses the  library, which in turn uses the standard python  library to log debug messages
p27967
aVThe following configuration will show you what exact requests are being run:
p27968
aVThis configures the  module to show debug-level messages (and up) on stderr
p27969
aVRunning your example URL and parameters, I see:
p27970
aVSo for me, without additional headers set, the URL certainly works as expected
p27971
as(dp27972
g16
V100297
p27973
stp27974
a((dp27975
g2
(lp27976
VUse :
p27977
aVor:
p27978
aVDemo:
p27979
as(dp27980
g16
V100297
p27981
stp27982
a((dp27983
g2
(lp27984
VUse  and  magic:
p27985
aVWe start at index 1 because the leading  slash gives you an empty element at the start
p27986
aVAlternatively, strip of the slashes at start and end:
p27987
aVOutput:
p27988
aVWrapped up as magic method:
p27989
as(dp27990
g16
V100297
p27991
stp27992
a((dp27993
g2
(lp27994
VUse  to traverse the dictionary:
p27995
aVand reuse  to find the location to store the value for :
p27996
aVAll but the last element in  is needed to find the 'parent' dictionary to add the value to, then use the last element to set the value to the right key
p27997
aVDemo:
p27998
as(dp27999
g16
V100297
p28000
stp28001
a((dp28002
g2
(lp28003
VNot all tracks have a  key, test for it first:
p28004
aVIn fact, only the very first entry has that key, probably because you only play one track at a time, the topmost one in the list of tracks played
p28005
as(dp28006
g16
V100297
p28007
stp28008
a((dp28009
g2
(lp28010
VDelete them with a regular expression:
p28011
aVDemo:
p28012
as(dp28013
g16
V100297
p28014
stp28015
a((dp28016
g2
(lp28017
VYou need to insert a  into your command-line arguments:
p28018
aVThe double-dash stops argparse looking for any more optional switches; it's the defacto standard way of handling exactly this use case for command-line tools
p28019
as(dp28020
g16
V100297
p28021
stp28022
a((dp28023
g2
(lp28024
VOnly keywords are reserved
p28025
aVis not a keyword but a built-in type, as are , , , , , , etc
p28026
aVThere is no point in reserving each and every possible built-in type; python is a dynamic language and if you want to replace the built-in types with a local name that shadows it, you should be able to
p28027
aVThink of  and the other types as a pre-imported library of object types; you wouldn't expect  from  to be reserved either
p28028
aVUse a static code analyzer to catch errors like these; most IDEs let you integrate one with ease
p28029
as(dp28030
g16
V100297
p28031
stp28032
a((dp28033
g2
(lp28034
VYour best bet is to create a new view for the  viewlet; template:
p28035
aVregistered with:
p28036
aVThen you can use that view with a simple traverse:
p28037
aVThis looks up the view in the context of the other object; the template is rendered and returned, replacing the
p28038
as(dp28039
g16
V100297
p28040
stp28041
a((dp28042
g2
(lp28043
VGive your  class a  method, this will make testing if the stack is empty easier:
p28044
aVNote that I simply  to the end of the  list, then later on  (no arguments) again, removing from the end of the list
p28045
aVTo make your class an iterable type, you'd need to add at least an  method, optionally together with a  method:
p28046
as(dp28047
g16
V100297
p28048
stp28049
a((dp28050
g2
(lp28051
VYou use SQL parameters instead of string formatting:
p28052
aVWhen using SQL parameters you let the database library handle the quoting, and even better, give the database to optimize the query and reuse the optimized query plan for multiple executions of the same basic query (with different parameters)
p28053
aVLast but not least, you are much better defended against SQL injection attacks as the database library knows best how to escape dangerous SQL-like values
p28054
aVTo quote the sqlite3 documentation:
p28055
aVUsually your SQL operations will need to use values from Python variables
p28056
aVYou shouldn\u2019t assemble your query using Python\u2019s string operations because doing so is insecure; it makes your program vulnerable to an SQL injection attack (see http://xkcd
p28057
aVcom/327/ for humorous example of what can go wrong)
p28058
aVInstead, use the DB-API\u2019s parameter substitution
p28059
aVPut  as a placeholder wherever you want to use a value, and then provide a tuple of values as the second argument to the cursor\u2019s  method
p28060
as(dp28061
g16
V100297
p28062
stp28063
a((dp28064
g2
(lp28065
VYou need to define the constants at module level, not in your  class:
p28066
as(dp28067
g16
V100297
p28068
stp28069
a((dp28070
g2
(lp28071
VTo use Grok on the Zope2 platform (used by Plone), you need to install the correct version of the  package
p28072
aVGrok is developed against the Zope Toolkit, and the publisher package in the ZTK has a slightly different API than what the Zope2 publisher offers
p28073
aVbridges that difference
p28074
aVBut you need to have the right version to make the correct match
p28075
aVFor Plone 4
p28076
aV1 (Zope 2
p28077
aV13), make sure you use  version 1
p28078
ag35
aV1 or newer:
p28079
aVFix the redirect method to properly work
p28080
aVUnlike in Zope 3, it doesn't support trusted
p28081
aVIf you were to upgrade to Plone 4
p28082
aV2, the right version pin is included in the included versions
p28083
aVcfg file
p28084
as(dp28085
g16
V100297
p28086
stp28087
a((dp28088
g2
(lp28089
VAdd styling that hides it:
p28090
aVthen use jQuery to show it:
p28091
as(dp28092
g16
V100297
p28093
stp28094
a((dp28095
g2
(lp28096
VUpdate your local namespace with the result of the  function:
p28097
aVThis is generally not that great an idea; leave those attributes in the namespace instead
p28098
aVYou could create more problems than you solved with this approach, especially if you accidentally configure arguments with a  name that shadows a built-in or local you care about, such as  or  or something
p28099
aVHave fun hunting down that bug
p28100
aVTim Peters already stated this in his Zen of Python:
p28101
aVNamespaces are one honking great idea -- let's do more of those
p28102
as(dp28103
g16
V100297
p28104
stp28105
a((dp28106
g2
(lp28107
VYou are missing the formatter type:
p28108
aVNote the  after the parenthesis; you want to interpolate the values as strings
p28109
aVHere is a working version instead:
p28110
aVDollar symbols have no meaning in -style string formats and I've added the  id selectors for you
p28111
aV:-)
p28112
aVPersonally, I would use  triple-quotes instead:
p28113
aVBetter still, put this into a Jinja template anyway (since you are using Flask) and render that instead:
p28114
aVwhere  is the Jinja template version of the jQuery snippet:
p28115
as(dp28116
g16
V100297
p28117
stp28118
a((dp28119
g2
(lp28120
VDecorators usually return a wrapper function; just put your logic in the wrapper function after invoking the wrapped function
p28121
aVSo  is a decorator factory that returns a scoped , which is used to decorate your  ()
p28122
aVAfter decorating, your  reference has been replaced by
p28123
aVCalling  causes the original  to be called, and then your code in the wrapper func can do things
p28124
aVThe above code, combined with your example function, gives the following output:
p28125
as(dp28126
g16
V100297
p28127
stp28128
a((dp28129
g2
(lp28130
VYou can reuse the code from the  command to turn a path into a view reference:
p28131
aVThe actual code to do this is a little involved, but the  does it all for us already
p28132
as(dp28133
g16
V100297
p28134
stp28135
a((dp28136
g2
(lp28137
VThis works just fine for me:
p28138
aVoutputs
p28139
as(dp28140
g16
V100297
p28141
stp28142
a((dp28143
g2
(lp28144
VUse  to turn it into a python structure, then print the values:
p28145
aVFor your example that results in:
p28146
aVHowever: If you got this from the Facebook API, then you transcribed the format incorrectly
p28147
aVThe Facebook API gives you JSON data, which uses double quotes () instead:
p28148
aVin which case you should use the  library that comes with Python:
p28149
aVIf you have a filename, you can ask  the library to read straight from the file using:
p28150
as(dp28151
g16
V100297
p28152
stp28153
a((dp28154
g2
(lp28155
VYou need to recurse over the nested dictionaries and convert those recursively:
p28156
aVHave you looked into  at all
p28157
aVYou can create a tree from scratch with that quite easily:
p28158
as(dp28159
g16
V100297
p28160
stp28161
a((dp28162
g2
(lp28163
VEach line is presented as a separate expression, pdb will step into a function right after evaluating the last expression before the closing parenthesis
p28164
aVYou cannot prevent stepping into ; step in, straight out with , then use  to step into  when  has returned
p28165
aVIf you were to step over  instead (when the line with  is presented) you'd step over both  and  in one go instead
p28166
as(dp28167
g16
V100297
p28168
stp28169
a((dp28170
g2
(lp28171
VServe the  file as a static resource:
p28172
aVmove the file to a  subdirectory of your package
p28173
aVgenerate a static URL for it in a Jinja2 template like so:
p28174
as(dp28175
g16
V100297
p28176
stp28177
a((dp28178
g2
(lp28179
VUsing a list comprehension:
p28180
aV(Don't name your variables ; it shadows the built-in and can lead to unexpected bugs)
p28181
as(dp28182
g16
V100297
p28183
stp28184
a((dp28185
g2
(lp28186
VDon't generate SQL from string concatenation
p28187
aVUse SQL parameters instead:
p28188
aVThe database can then reuse the  statement (it prepares a query plan for it), the database client layer will handle quoting for you, and you prevent SQL injection attacks to boot
p28189
as(dp28190
g16
V100297
p28191
stp28192
a((dp28193
g2
(lp28194
VUse the  result of finding elements with a  class perhaps
p28195
as(dp28196
g16
V100297
p28197
stp28198
a((dp28199
g2
(lp28200
VYes, there is a difference
p28201
aVWhen you run:
p28202
aVYou are not passing in a function reference
p28203
aVYou are calling the function and instead are passing in the result of that call
p28204
aVYou are timing  instead of
p28205
aVMove out the lambda:
p28206
aVThis means you need to remove it from your  function, and instead pass the function straight to the  class:
p28207
as(dp28208
g16
V100297
p28209
stp28210
a((dp28211
g2
(lp28212
VNo, that's what AJAX is, a Javascript technique
p28213
aVYou cannot initiate a XMLHTTPRequest from your browser without it
p28214
aVJust use jQuery to load a URL from you Pyramid server; have one route serve up a HTML snippet instead of a full page:
p28215
aVand jQuery will request  from your server, and place the result wholesale under
p28216
as(dp28217
g16
V100297
p28218
stp28219
a((dp28220
g2
(lp28221
VUse the included  library to detect if  is available and if so, what version it is
p28222
aVIf you cannot import , there is no  library installed, full stop:
p28223
aVThe project name is either  or ; for me this prints:
p28224
aVSee the  attributes documentation for further details on what information is available
p28225
as(dp28226
g16
V100297
p28227
stp28228
a((dp28229
g2
(lp28230
VUse the stdlib  library to parse the data, the result is a python dictionary:
p28231
as(dp28232
g16
V100297
p28233
stp28234
a((dp28235
g2
(lp28236
VNo, pyScss has no support whatsoever for either  or
p28237
aVInstead,  paths are always looked up against the  config variable only
p28238
aVSmall comfort:  can be a callable that yields  tuples; for  it'll only use the first value yielded
p28239
aVThe  object needs to implement the Django  API (it'll use the  and perhaps the  methods), so you could perhaps use that to intercept , , etc
p28240
aVpaths to 'redirect' to your images dir of choice
p28241
aVThe generated URL however will (stubbornly) consist of  + the path passed to
p28242
aVI suggest you add a feature request / bug report to the issue tracker to request they add proper support for setting  and  instead
p28243
as(dp28244
g16
V100297
p28245
stp28246
a((dp28247
g2
(lp28248
VYou need to run the code in a terminal, because the  function is asking you to enter some text
p28249
aVThe Sublime environment is not sufficient
p28250
as(dp28251
g16
V100297
p28252
stp28253
a((dp28254
g2
(lp28255
VYou are not using the correct syntax for catching an exception
p28256
aVInstead, use:
p28257
aVThe  exception has two extra attributes,  and
p28258
aVOlder code used to catch it like this:
p28259
aVbecause in Python 2 you can treat an exception like a tuple and unpack it, but that's gone in Python 3 and should really not be used
p28260
aVMoreover, the older  has been replaced by the  syntax as that is less ambiguous when you try to catch more than one exception type in the same statement
p28261
aVWhen an exception is thrown, the normal flow of code is interrupted; instead the flow 'jumps' to the exception handler
p28262
aVBecause of this jump, you have another problem in your code
p28263
aVIn the exception handler you refer to , but the variable  is defined after the point where the socket exception will be thrown (the various socket operations)
p28264
aVThis will result in a
p28265
aVIn this case, there is no path through your code that'll result in  being assigned an open socket connection, you can remove the  line altogether
p28266
aVIf there was a need to call  on , you'd need to detect if it was set in the first place
p28267
aVSet it to , beforehand, then call  only if  is no longer :
p28268
as(dp28269
g16
V100297
p28270
stp28271
a((dp28272
g2
(lp28273
VYou can capture the  variable on a frame in the traceback:
p28274
aVTo demonstrate that it works:
p28275
as(dp28276
g16
V100297
p28277
stp28278
a((dp28279
g2
(lp28280
VYour terminal is entering encoded characters; you are using UTF-8, and thus Python receives two bytes when you type
p28281
aVDecode from UTF-8 in that case:
p28282
aVYou really want to read up on Python and Unicode though:
p28283
aVThe Python Unicode HOWTO
p28284
aVPragmatic Unicode by Ned Batchelder
p28285
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p28286
aVby Joel Spolsky
p28287
as(dp28288
g16
V100297
p28289
stp28290
a((dp28291
g2
(lp28292
VUse  perhaps; those are multi-sets, or bags, in datatype parlance:
p28293
aVNow you can compare these by entries or frequencies:
p28294
aVYou can calculate their cosine similarity using:
p28295
aVWhich gives:
p28296
aVThe closer to 1 that value, the more similar the two lists are
p28297
aVThe cosine similarity is one score you can calculate
p28298
aVIf you care about the length of the list, you can calculate another; if you keep that score between 0
p28299
aV0 and 1
p28300
aV0 as well you can multiply the two values for a final score between -1
p28301
aV0 and 1
p28302
ag2391
aVFor example, to take relative lengths into account you could use:
p28303
aVand then combine into a function that takes the lists as inputs:
p28304
aVFor your two example lists, that results in:
p28305
aVYou can mix in other metrics as needed
p28306
as(dp28307
g16
V100297
p28308
stp28309
a((dp28310
g2
(lp28311
VYou have exhausted the generator
p28312
aVRe-define it before using it again:
p28313
aVIn python, once you have looped over all the elements of an iterator, you cannot loop over the iterator again (it is now empty)
p28314
aVBecause the  iterator is empty, you are not passing any arguments to  and it thus complains:
p28315
aVJust to be explicit: you did not find a bug in ipython
p28316
aVYou can reproduce the same issue in a regular python prompt
p28317
as(dp28318
g16
V100297
p28319
stp28320
a((dp28321
g2
(lp28322
VThe  adapter uses  for SQL parameters, not :
p28323
aVYour schema also restricts the :
p28324
aVwhich means it can no longer be NULL
p28325
aVYou have to include a value for that column too:
p28326
aVsucceeds
p28327
as(dp28328
g16
V100297
p28329
stp28330
a((dp28331
g2
(lp28332
VYou printed the whole row, which is a tuple
p28333
aVTo print it with a little formatting, you could use :
p28334
as(dp28335
g16
V100297
p28336
stp28337
a((dp28338
g2
(lp28339
VThere is no need to use a generator to loop over
p28340
aVJust pass in  directly:
p28341
aVThe database adapter will loop over  for you and a generator expression only inserts a needless extra loop
p28342
aVIf you do not get any error messages but there are no changes either, check the following:
p28343
aVMake sure you commit the transaction; run  after the  call
p28344
aVTripple-check that  is not empty
p28345
aVThe database adapter will correctly handle float values for you; if a column is marked as  and you pass in a Python float value for that column, Things Just Work
p28346
aVThat's what SQL parameters are for, handling quoting of different datatypes correctly
p28347
as(dp28348
g16
V100297
p28349
stp28350
a((dp28351
g2
(lp28352
VLooks like you really want to use a HTML parser instead
p28353
aVMixing Regular expressions and HTML get's real painful, really really fast
p28354
aVIn your regular expression, you created a character class (a set of characters that is allowed to match) consisting of <, h, 2, >, etc
p28355
aVhere:
p28356
aVwhich could have been written as:
p28357
aVand it would match the same characters
p28358
aVDon't use [
p28359
aVunless you want to create a set of characters for a match (\u005cs, \u005cd, etc
p28360
aVare pre-built character classes)
p28361
aVHowever, even if you were to remove the brackets, the lookbehind is not allowed
p28362
aVYou are not allowed to use variable-width patterns in a lookbehind (no + or *)
p28363
aVSo, with the character class the lookbehind no longer matches what you think it matches, without it the lookbehind is not permissable
p28364
aVAll in all, just just BeautifulSoup instead
p28365
as(dp28366
g16
V100297
p28367
stp28368
a((dp28369
g2
(lp28370
VYou were so close, all you had to do was  the file:
p28371
aVBy using a  context manager block, the file is automatically closed when you are done with the loop
p28372
as(dp28373
g16
V100297
p28374
stp28375
a((dp28376
g2
(lp28377
VYour input file appears to be encoding in Latin-1
p28378
aVDecode this to  data; cx_Oracle will do the rest for you:
p28379
aVor use the  function to open the file for automatic decoding:
p28380
aVReading from  will give you  data
p28381
aVOn insertion, the  library will encode  values to the correct encoding that Oracle expects
p28382
aVYou do need to set the  environment variable to  before connecting, either in the shell or in Python with:
p28383
aVYou may want to review the Python Unicode HOWTO for more details
p28384
as(dp28385
g16
V100297
p28386
stp28387
a((dp28388
g2
(lp28389
VYou could use a regular expression (with the built-in  module):
p28390
aVThe pattern matches a literal  character, followed by 1 or more digits (the  escape signifies the digits character group,  means 1 or more), followed by a literal
p28391
aVBy putting parenthesis around the  part, we create a capturing group, which we can extract by calling  ("get the first capturing group result")
p28392
aVResult:
p28393
as(dp28394
g16
V100297
p28395
stp28396
a((dp28397
g2
(lp28398
V is a nested dictionary
p28399
aVThe top level has no  key, so that's why you get a key error:
p28400
aVThere is such a key in the nested dictionary though:
p28401
aVI think you want to define a variable  that has the value :
p28402
aVIf you loop over the keys in  that would work:
p28403
as(dp28404
g16
V100297
p28405
stp28406
a((dp28407
g2
(lp28408
VFrom the documentation:
p28409
aVWith the default settings of , no redirection will occur
p28410
aVYou need to set  to , then call  and simply ignore the captured output
p28411
aValthough I suspect that using  more than suffices for your needs:
p28412
as(dp28413
g16
V100297
p28414
stp28415
a((dp28416
g2
(lp28417
VUse  to add those zeros back as needed:
p28418
aVBy using  we remove that pesky trailing dot, and  will add enough  characters to the left to make it to 4 digits
p28419
aVDemo:
p28420
aVIf they are float values instead, use the  function on them to give you zero-padded values:
p28421
aVSo do this:
p28422
aVwhere  normalizes your values to the 0
p28423
aVto 2399
p28424
aVrange
p28425
as(dp28426
g16
V100297
p28427
stp28428
a((dp28429
g2
(lp28430
VUse  and  instead:
p28431
as(dp28432
g16
V100297
p28433
stp28434
a((dp28435
g2
(lp28436
VYou need to convert the JSON response to a python structure with the  library (included with Python):
p28437
as(dp28438
g16
V100297
p28439
stp28440
a((dp28441
g2
(lp28442
V does not return anything, so  is set to None
p28443
aVDo this instead:
p28444
aVYou really want to use  and string formatting to build paths though, it'll be a lot easier to read:
p28445
aVFor , pass in a list instead of a string for the command and arguments, and leave  to the default value of , there is no need to have the shell handle that:
p28446
as(dp28447
g16
V100297
p28448
stp28449
a((dp28450
g2
(lp28451
VParse it to a  object, add 5 days, then reformat back to your number:
p28452
aVDemonstration:
p28453
aVFor Python versions before Python 2
p28454
aV5, you'll need to use the  version:
p28455
as(dp28456
g16
V100297
p28457
stp28458
a((dp28459
g2
(lp28460
VYou want to restructure this; in the  package  file, import all modules that need to be imported dynamically
p28461
aVThen just use attribute access instead:
p28462
aVIf your  modules are dynamically generated, the  callable works very simply:
p28463
aVFrom the interactive command prompt this works fine:
p28464
aVTested that in Python 2
p28465
aV7, 3
p28466
aV2 and 3
p28467
ag35
as(dp28468
g16
V100297
p28469
stp28470
a((dp28471
g2
(lp28472
VThat is UTF-8 data already; python is showing you the string literal form
p28473
aVThe above line decodes the UTF-8 data to a  object with printunicode` object so that my terminal can display it properly
p28474
aVYou may want to read up on Python and Unicode:
p28475
aVThe Python Unicode HOWTO
p28476
aVPragmatic Unicode by Ned Batchelder
p28477
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p28478
aVby Joel Spolsky
p28479
as(dp28480
g16
V100297
p28481
stp28482
a((dp28483
g2
(lp28484
VStill the easiest way is to use the  hook on the  object:
p28485
aVThis method is called by the publisher before traversing further; so the publisher has already located the  object, and this method is passed itself (), and the request
p28486
aVOn the request you'll find the traversal stack; in your example case that'll hold  and this method moves  to the request under the key  (after an optional validation)
p28487
aVWhen this method returns, the publisher will use the remaining stack to continue the traverse, so it'll now traverse to , which should be a browser view that expects a  key in the request
p28488
aVIt then can do it's work:
p28489
as(dp28490
g16
V100297
p28491
stp28492
a((dp28493
g2
(lp28494
VYou need to start searching at the next position, so search at:
p28495
aVbecause the search starts at , and if  is found at that position, find will return  of course
p28496
aVAs for the difference between  and ;  raises a  exception if the substring is not found, while  returns  instead
p28497
as(dp28498
g16
V100297
p28499
stp28500
a((dp28501
g2
(lp28502
VYou are looking at HTML entities; use the  library to decode these:
p28503
aVTo read a full  response, just use :
p28504
as(dp28505
g16
V100297
p28506
stp28507
a((dp28508
g2
(lp28509
VYou have a JSON string, just use the  module to decode it to a Python structure:
p28510
as(dp28511
g16
V100297
p28512
stp28513
a((dp28514
g2
(lp28515
VNo, the  method is specific to Django
p28516
aVIt is not a general Python convention
p28517
aVIt is only used on  classes, to provide custom model validation or on  and various  classes for forms for the same sort of tasks
p28518
aVThe Django framework calls these methods when handling form input
p28519
aVSee Form and field validation for more information on when  is called
p28520
aVSee the  method documentation to see how this applies to model validation
p28521
as(dp28522
g16
V100297
p28523
stp28524
a((dp28525
g2
(lp28526
VThis is not a good idea, but you can use:
p28527
aVto add all names defined in the  module to your local namespace
p28528
aVThis is almost the same as
p28529
aVTo emulate  exactly, without using  itself, you'd have to use:
p28530
aVYou normally just would use  or
p28531
aVIf you are using  you don't have to do any of this
p28532
aVJust add the path to the archive to your :
p28533
as(dp28534
g16
V100297
p28535
stp28536
a((dp28537
g2
(lp28538
VJust use  to read all data into a list
p28539
as(dp28540
g16
V100297
p28541
stp28542
a((dp28543
g2
(lp28544
VYou should always use , the commenter is quite correct
p28545
aVNot all types implement , for example, yet  will work correctly if the type allows the attribute to be set
p28546
aVDouble-underscore methods are hooks, there to enable your custom classes to implement custom behaviour
p28547
aVThe Python APIs will use these hooks if present, to fall back to the default behaviour if the hook is missing
p28548
aVBy bypassing the API, you are burdening yourself with having to implement the fallback in your own code
p28549
aVYou only ever need to call  directly when implementing a subclass, and then only through the  call:
p28550
as(dp28551
g16
V100297
p28552
stp28553
a((dp28554
g2
(lp28555
VThe code has changed
p28556
aVIn Python 2
p28557
aV7, the cache is a simple dictionary; if more than  items are stored in it, the whole the cache is cleared before storing a new item
p28558
aVA cache lookup only takes building a simple key and testing the dictionary, see the 2
p28559
aV7 implementation of
p28560
aVIn Python 3
p28561
aVx, the cache has been replaced by the  decorator
p28562
aVThis decorator does much more work and includes a thread-lock, adjusting the cache LRU queue and maintaining the cache statistics (accessible via )
p28563
aVSee the 3
p28564
aV3 implementation of  and of
p28565
aVOthers have noticed the same slowdown, and filed issue 16389 in the Python bugtracker
p28566
aVI'd expect 3
p28567
aV4 to be a lot faster again; either the  implementation is improved or the  module will move to a custom cache again
p28568
aVUpdate: With revision 4b4dddd670d0 the cache change has been reverted back to the simple version found in 3
p28569
ag1124
aVPython versions 3
p28570
ag5740
aV4 and 3
p28571
ag35
aV1 include that revision
p28572
as(dp28573
g16
V100297
p28574
stp28575
a((dp28576
g2
(lp28577
VYou are creating a list with  copies of the same object:
p28578
aVThe above code does not call  8 times, it call it once then puts 8 references in the list
p28579
aVIt's as if you ran:
p28580
aVUse a list comprehension instead:
p28581
aVwhich would evaluate the  expression for each run through the loop
p28582
as(dp28583
g16
V100297
p28584
stp28585
a((dp28586
g2
(lp28587
VYou are looping over the result of , which retrieves just one row
p28588
aVRemove that line and just loop directly over the cursor:
p28589
aVYou do not need to test for  either, nor do you need to test if the  column is equal to
p28590
aVSimplify the loop to:
p28591
aVYou can just ask the database for rows that match your  column, and where the 3rd column is set to
p28592
aVYou didn't show us your schema so it is hard to recommend how you can update your query for that
p28593
aVYour  query is incorrect, you probably meant:
p28594
aVinstead
p28595
aVYour SQL query and update look suspect though; without knowing the full schema it does look as if you are mixing your seat number and customer number in places
p28596
as(dp28597
g16
V100297
p28598
stp28599
a((dp28600
g2
(lp28601
VJoining byte strings using  works just fine; the error you see would only appear if you mixed  and  objects:
p28602
as(dp28603
g16
V100297
p28604
stp28605
a((dp28606
g2
(lp28607
VYou don't clean the  dictionary between runs giving the version without nesting an unfair advantage
p28608
aVThe first time  runs  it'll fill the  dict and then subsequent runs re-use it
p28609
aVThe nested function sets up a new, empty  each time
p28610
as(dp28611
g16
V100297
p28612
stp28613
a((dp28614
g2
(lp28615
VUnfortunately,  can only handle the timezone configured by your OS, and then only as a time offset, really
p28616
aVFrom the documentation:
p28617
aVSupport for the  directive is based on the values contained in  and whether  is true
p28618
aVBecause of this, it is platform-specific except for recognizing UTC and GMT which are always known (and are considered to be non-daylight savings timezones)
p28619
aVdoesn't officially support
p28620
aVYou are stuck with  to support timezone parsing, I am afraid
p28621
as(dp28622
g16
V100297
p28623
stp28624
a((dp28625
g2
(lp28626
VYou do not need to import an object defined in the same module:
p28627
aVThe  statement is intended for objects defined in other files only; you import the names defined in another python file into the current module
p28628
as(dp28629
g16
V100297
p28630
stp28631
a((dp28632
g2
(lp28633
VSet  outside of your  loop; you are resetting it to 0 each time otherwise:
p28634
as(dp28635
g16
V100297
p28636
stp28637
a((dp28638
g2
(lp28639
VFlask throws this exception because your  view didn't return anything
p28640
aVReturn a response from your  view:
p28641
aVTo return the MySQL results, perhaps join the rows together into one string:
p28642
aVor define a template and return the rendered template
p28643
aVNote that you really do not want to use string interpolation for your  parameter, especially in a web application
p28644
aVUse SQL parameters instead:
p28645
aVNow the database client will do the quoting for you and prevent SQL injection attacks
p28646
aVIf you use string interpolation, this will happen
p28647
aV(If this was a decent database (e
p28648
ag1298
aVnot MySQL) the database could take the now-generic SQL statement and create a query plan for it, then reuse the plan again and again as you execute that query multiple times; using string interpolation you'd prevent that
p28649
as(dp28650
g16
V100297
p28651
stp28652
a((dp28653
g2
(lp28654
VIf you expect the  line to affect a global name defined outside of the function, you need to declare it a global inside of your  function:
p28655
aVAssignment to a variable in a function makes that variable name local to the function only
p28656
aVIt appears you assigned an integer value to the global  elsewhere, so  sees that when you call
p28657
aVYou should really avoid globals though
p28658
as(dp28659
g16
V100297
p28660
stp28661
a((dp28662
g2
(lp28663
VYou need to add  to the  file of your  package
p28664
aVAlternatively, you could use  in the same location
p28665
aVNested packages are not automatically made available as attributes of the parent package, this only works after importing the nested package explicitly
p28666
aVIf you first to , then  works
p28667
aVOr you explicitly import the  nested package in the  file to ensure that  always works for users of your  package
p28668
aVThe same applies to the  module in the  package; you need to make it available by importing it in the  package ; add a , or use an absolute import like
p28669
as(dp28670
g16
V100297
p28671
stp28672
a((dp28673
g2
(lp28674
VThe arguments to a program are always strings, you need to convert your  to integers:
p28675
aVThis could throw a ValueError exception if any of the input is not a valid number, you may want to catch that:
p28676
as(dp28677
g16
V100297
p28678
stp28679
a((dp28680
g2
(lp28681
VYour JSON data is enclosed in extra quotes making it a JSON string, and the data contained within that string is not JSON
p28682
aVPrint  instead, you'll get:
p28683
aVand the JSON library is correctly interpreting that as one string with the literal contents
p28684
aVIf you stripped the outer quotes, the contained characters are not valid JSON, because JSON strings must always be enclosed in double quotes
p28685
aVFor all the  module is concerned,  could just as well have contained  and  would have been set to
p28686
aVFix whatever is producing this string, your view is fine, it's the input that is broken
p28687
as(dp28688
g16
V100297
p28689
stp28690
a((dp28691
g2
(lp28692
VYou are matching 0 or more quotes followed by a quote
p28693
aVUse a negative character class instead:
p28694
aVYou may want to put a capturing group around the negative character class:
p28695
aVand now  returns everything within quotes, not including the quotes themselves:
p28696
aVThe  negative character class notation means: match any character that is not included in the set of characters named here
p28697
aVthus matches any character that is not a quote, neatly limiting the matched characters to everything that is within quotes
p28698
as(dp28699
g16
V100297
p28700
stp28701
a((dp28702
g2
(lp28703
VTo convert  data to  you need to specify an encoding
p28704
aVUse , etc
p28705
aVYou may want to read up on Python and Unicode:
p28706
aVThe Python Unicode HOWTO
p28707
aVPragmatic Unicode by Ned Batchelder
p28708
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p28709
aVby Joel Spolsky
p28710
as(dp28711
g16
V100297
p28712
stp28713
a((dp28714
g2
(lp28715
VYou don't
p28716
aVYou assign to the attributes later on, or set them to
p28717
aVAn attribute without a value is not an attribute
p28718
aVBeing dynamic, it's perfectly fine to assign the attribute later on without having to declare it in the class
p28719
as(dp28720
g16
V100297
p28721
stp28722
a((dp28723
g2
(lp28724
VAnything that can be packaged can be published; the PyPI is there to share your Python code with the community
p28725
aVJust follow the PyPI tutorial and make sure your package follows the guidelines
p28726
as(dp28727
g16
V100297
p28728
stp28729
a((dp28730
g2
(lp28731
VProvided  does not clear it's own references to the arguments passed in, or create more references to the arguments, until  completes, the two approaches are exactly the same
p28732
aVThe latter will use less memory once  completes, because by then the local variables of the function are cleaned up
p28733
aVIn the first option, because  and  still hold references, the ref count does not drop to 0
p28734
aVCPython uses reference counting to clean up any objects that are no longer used; once the reference count drops to 0 objects are automatically cleaned up
p28735
aVIf memory and readability are a concern, you can delete references explicitly:
p28736
aVbut remember that local variables inside a function are cleaned up automatically, so the following would also result in the  and  references being removed:
p28737
as(dp28738
g16
V100297
p28739
stp28740
a((dp28741
g2
(lp28742
VSimply include the double-dash:
p28743
aVArguments are either positional or optional; arguments starting with  are always optional
p28744
aVYou cannot create positional arguments with a  prefix and you really should not
p28745
aVThe  prefix is a user interface convention you really do not want to break
p28746
as(dp28747
g16
V100297
p28748
stp28749
a((dp28750
g2
(lp28751
VYou can assign a custom function to the  handler
p28752
aVThe function is called whenever there is a unhandled exception (so one that exits the interpreter)
p28753
aVThis version uses the  library to convert the traceback text into one formatted with ANSI coloring, before writing it to
p28754
as(dp28755
g16
V100297
p28756
stp28757
a((dp28758
g2
(lp28759
VSplit on :
p28760
aVis the character class matching the digits 0 through to 9, and we want to match at least 1 of them
p28761
aVBy putting a capturing group around the ,  will include the match in the output:
p28762
aVIf capturing parentheses are used in pattern, then the text of all groups in the pattern are also returned as part of the resulting list
p28763
aVDemo:
p28764
as(dp28765
g16
V100297
p28766
stp28767
a((dp28768
g2
(lp28769
VThe ZCatalog does not return dictionaries
p28770
aVIt returns a sequence of result objects (called Catalog Brains, because you can give them smarts
p28771
aVLong historical story)
p28772
aVSo you loop over them, and each object has attributes for each metadata column you defined in the catalog:
p28773
aVIf you need to dynamically loop over the available attributes, use  for the keys:
p28774
as(dp28775
g16
V100297
p28776
stp28777
a((dp28778
g2
(lp28779
VThis is what context managers are for, to rely on them to close the file for you
p28780
aVContext managers are called even if there was an exception
p28781
aVThe alternative is to use an  block instead:
p28782
aVbut because the block inside of the  might be long, by the time you get to the  statement you have forgotten what you were setting this up for
p28783
aVContext managers are more powerful still
p28784
aVBecause the  method is informed of any exceptions, they can act as exception handlers as well (ignore the exception, raise another, etc
p28785
as(dp28786
g16
V100297
p28787
stp28788
a((dp28789
g2
(lp28790
VNo, you can add attributes to object types that allow it
p28791
aV, , ,  et
p28792
aVal
p28793
aVdo not, because they are immutable
p28794
as(dp28795
g16
V100297
p28796
stp28797
a((dp28798
g2
(lp28799
VYour problem is that your  list is attached to the class; it is a class attribute and shared between instances
p28800
aVCreate a new list for each player in the  method:
p28801
as(dp28802
g16
V100297
p28803
stp28804
a((dp28805
g2
(lp28806
VYou need to configure Psycopg2's client encoding
p28807
aVSee the SQLAlchemy documentation:
p28808
aVBy default, the psycopg2 driver uses the  extension, such that the DBAPI receives and returns all strings as Python Unicode objects directly - SQLAlchemy passes these values through without change
p28809
aVPsycopg2 here will encode/decode string values based on the current \u201cclient encoding\u201d setting; by default this is the value in the  file, which often defaults to
p28810
aVTypically, this can be changed to , as a more useful default:
p28811
aVA second way to affect the client encoding is to set it within Psycopg2 locally
p28812
aVSQLAlchemy will call psycopg2\u2019s  method (see: http://initd
p28813
aVorg/psycopg/docs/connection
p28814
aVhtml#connection
p28815
aVset_client_encoding) on all new connections based on the value passed to  using the  parameter:
p28816
aVThis overrides the encoding specified in the Postgresql client configuration
p28817
aVThe  parameter can be specified as a query string in the engine URL:
p28818
as(dp28819
g16
V100297
p28820
stp28821
a((dp28822
g2
(lp28823
VYou are mixing tabs and spaces anyway; run your script with:
p28824
aVto detect where the error lies
p28825
aVThen configure your editor to only use spaces for indentation, and re-indent your file
p28826
aVSee How do I configure Notepad++ to use spaces instead of tabs
p28827
as(dp28828
g16
V100297
p28829
stp28830
a((dp28831
g2
(lp28832
VI think you are confused about what  does
p28833
aVGiven your input,  does this:
p28834
aVso it compares a boolean  or  with another counter
p28835
aVCounters are never equal to a boolean value
p28836
aVruns the operation on the first two elements, then takes the result of that operation and uses it as the input for the next loop, together with the next element of the list
p28837
aVBecause the Python  type is a subclass of , it happens to work for  ( is  in python)
p28838
aVDo the same with all  values and it'll fail:
p28839
aVIf you want to test if all counters are the same, use  instead:
p28840
as(dp28841
g16
V100297
p28842
stp28843
a((dp28844
g2
(lp28845
VA decorator is called immediately, it is not treated as a method of  but rather is seen as a local function instead
p28846
aVThe  syntax effectively means:
p28847
aVand is executed immediately
p28848
aVIt is not a bound method, so the  parameter is not included
p28849
aVThere is no point in making  a method
p28850
aVMove it out and remove the  argument altogether
p28851
aVYou need to adjust your decorator to return a callable to replace :
p28852
aVso that  is called every time  is called
p28853
aVIf you have to make  part of , you can use a  decorator but you have to jump through an extra hoop just to be able to use it for other method declarations; you have to treat it as the descriptor it has become and call  on it:
p28854
aVI call  with an arbitrary type ( in this case) because  ignores that argument anyway; we can't use  here because that class has not yet been finalized while inside the code that is part of it's definition
p28855
aVNote that for  to work at all you need to inherit from  in Python 2
p28856
as(dp28857
g16
V100297
p28858
stp28859
a((dp28860
g2
(lp28861
VUse the  module to filter out specific warnings in your code:
p28862
as(dp28863
g16
V100297
p28864
stp28865
a((dp28866
g2
(lp28867
VSee the  documentation
p28868
aVThe  and  strings are data type descriptors; the first means the array holds strings of length 1, the second of length 2
p28869
aVThe  pipe symbol is the byteorder flag; in this case there is no byte order flag needed, so it's set to , meaning not applicable
p28870
as(dp28871
g16
V100297
p28872
stp28873
a((dp28874
g2
(lp28875
VThe fact that your exceptions always happen when you try to access the pickled data seem to indicate that you are hitting a bug in the  library instead
p28876
aVWhat can happen is that a C library forgets to handle an exception
p28877
aVThe exception info is stored, not handled, and is sitting there in the interpreter until another exception happens or another piece of C code does check for an exception
p28878
aVAt this point the old, unhandled exception is thrown instead
p28879
aVYour error is clearly  related, it is very unhappy about the data you feed it, but the exception itself is thrown in unrelated locations
p28880
aVThis could be threading related, it could be a regular non-threading-related bug
p28881
aVYou need to see if you can load the data in a test setting
p28882
aVWrite  to a file for later testing
p28883
aVLoad that file in a interpreter shell session, load it with  and see what happens
p28884
aVDo the same with the  module
p28885
aVIf you do run into similar problems in this test session, and you can reproduce it (weird exceptions being thrown at a later point in the session) you need to file a bug with the Python project to have this looked at
p28886
as(dp28887
g16
V100297
p28888
stp28889
a((dp28890
g2
(lp28891
VCheck the  attribute; it'll indicate the number of affected rows
p28892
aVIf an  was not successful the  will be 0:
p28893
aVOf course, if you try to update a table or column that doesn't exist, an exception is thrown instead:
p28894
aVI used the  library included with Python to demo this;  was added to Python under that name in Python 2
p28895
ag2176
aVThe difference is merely the import:
p28896
as(dp28897
g16
V100297
p28898
stp28899
a((dp28900
g2
(lp28901
VYour  variable was a class variable; one shared by all instances of the class
p28902
aVThis means that for every call to  the  call would add data to the digest, across instances, globally to the application
p28903
aVSince you only want to calculate the digest for one string only, (the  string) and not for all strings cumulatively, you must create a new  object for each new digest you want to calculate
p28904
aVNote the documentation for the
p28905
aVupdate()` method:
p28906
aVUpdate the hash object with the string arg
p28907
aVRepeated calls are equivalent to a single call with the concatenation of all the arguments:  is equivalent to
p28908
as(dp28909
g16
V100297
p28910
stp28911
a((dp28912
g2
(lp28913
V already gives you the directory name in each loop; just make that absolute and add to the  list
p28914
aVThen move to the next directory (one match is enough):
p28915
aVreturns  as soon as it finds the first element in the contained iterable that is ; so the first file that ends with  will result in  returning True and the current directory is added to the list of matches
p28916
as(dp28917
g16
V100297
p28918
stp28919
a((dp28920
g2
(lp28921
V only ever takes username and password arguments
p28922
aVThere is no 3rd argument, full-stop
p28923
aVHTTP Basic Authentication adds an extra header to the request; this information is kept separate from the GET or POST parameters
p28924
aVWhen you use this form of authentication, you do not need to pass any  and  parameters to the API methods either
p28925
aVTo add a bookmark, pass in the  parameter as a POST or GET data parameter:
p28926
aVEither  or  will do
p28927
as(dp28928
g16
V100297
p28929
stp28930
a((dp28931
g2
(lp28932
VYou need to explicitly close it as soon as  is raised
p28933
aVIn this case, simply call  when you raise  yourself
p28934
aVSince no other code in your  method could trigger a  this suffices
p28935
aVIf you did use  on another iterator inside your own  you'd have to catch  with an  handler and reraise the exception
p28936
aVThis only handles the  case
p28937
aVIf you want to handle other situations (not exhausting the iterator) you'll need to handle that situation separately
p28938
aVMaking your class a Context Manager as well could help with that
p28939
aVUsers of your iterator would then use the object in a  statement before iterating over it, and when the  suite is exited the file could be closed regardless
p28940
aVYou may want to mark your iterator as 'done' as well in that case:
p28941
as(dp28942
g16
V100297
p28943
stp28944
a((dp28945
g2
(lp28946
VCurrent versions of  cannot list files in subdirectories recursively (an update that will be included in python 3
p28947
aV5 when released adds a  option for arbitrary nested directory traversal)
p28948
aVI'd use  combined with  instead:
p28949
aVThis'll walk your directories recursively and return all absolute pathnames to matching  files
p28950
aVIn this specific case the  may be overkill, you could also use a  test:
p28951
as(dp28952
g16
V100297
p28953
stp28954
a((dp28955
g2
(lp28956
VAlthough in Python, the right-hand side is evaluated first when doing multiple assignments, the left-hand assigment targets, if they have expressions in them, are evaluated one by one when assigning
p28957
aVIf instead, they'd be evaluated as assignment targets first as you appear to expect, this would of course work
p28958
aVThis is documented in the assignment statements section:
p28959
aVAn assignment statement evaluates the expression list (remember that this can be a single expression or a comma-separated list, the latter yielding a tuple) and assigns the single resulting object to each of the target lists, from left to right
p28960
aVand
p28961
aVIf the target list is a comma-separated list of targets: The object must be an iterable with the same number of items as there are targets in the target list, and the items are assigned, from left to right, to the corresponding targets
p28962
aVEmphasis mine
p28963
aVThe left-to-right is crucial here
p28964
aVis assigned to before the  is assigned to
p28965
aVThe documentation then describes in detail what happens to a subscription target such as  and :
p28966
aVIf the target is a subscription: The primary expression in the reference is evaluated
p28967
aVIt should yield either a mutable sequence object (such as a list) or a mapping object (such as a dictionary)
p28968
aVNext, the subscript expression is evaluated
p28969
aVAgain, emphasis mine; the subscript expression is evaluated separately, and since the target list is evaluated from left-to-right, that evaluation takes place after the previous assignment to
p28970
aVYou can see this by disassembling the python code:
p28971
aVThe storing operation first stores , so the next call to  returns  and the  is thus stored right back in position
p28972
aVThe following does work:
p28973
aVbecause now the  lookup is done first
p28974
aVHowever, it's best to store the result of an  call in a temporary variable as not calling  twice is going to be more efficient in any case
p28975
as(dp28976
g16
V100297
p28977
stp28978
a((dp28979
g2
(lp28980
VNo, that is not possible to determine with server-side code only
p28981
aVBrowsers do not share that information when making HTTP requests to the server
p28982
aVYou'll have to do this with JavaScript
p28983
as(dp28984
g16
V100297
p28985
stp28986
a((dp28987
g2
(lp28988
VSure it's possible
p28989
aVAll the  syntax does is define the function that follows, then call the decorator, passing in the function that followed and replacing the reference to that function with whatever was returned
p28990
aVSo the following:
p28991
aVis translated to:
p28992
aVThis means that your  method must expect one argument, the to-be-decorated function, and return something callable:
p28993
aVwould be the minimal decorator that returns a wrapper function, and prints the name of the wrapped function when called
p28994
aVIt doesn't matter what the argument is called; I used  here but it can be any legal python identifier
p28995
aVThe  is the standard part of the method signature
p28996
aVBecause you are referencing  on an instance , Python automatically takes care of the  parameter for you as it does with all methods
p28997
aVAnything after  is just an expression
p28998
aVSo if you use the syntax:
p28999
aVthen  should instead return a decorator function
p29000
aVOne extra level of scope nesting should do that:
p29001
aVDeconstructing this:
p29002
aVThe part after the ,  returns the nested function :
p29003
aVwhich python then turns into:
p29004
aVand  returns
p29005
aVCalling  then results in a call to  which calls the original  with  and  passed in as positional and keyword arguments
p29006
aVThe class decorator pattern you see in the linked questions works in a similar way; the expression after the  returns something that is called; instead of a nested function a class instance is being created instead
p29007
aVIt's just two different approaches to storing state for the decorator to use
p29008
aVThe nested functions is a little more compact to write, while using a class gives you more introspection options than a nested scope
p29009
as(dp29010
g16
V100297
p29011
stp29012
a((dp29013
g2
(lp29014
VTo always produce a list (possibly empty):
p29015
aVor use :
p29016
aVbut in Python 3 that requires an explicit call to :
p29017
aVbecause  returns an iterator instead
p29018
aVor use a helper function:
p29019
aVor, with the map version:
p29020
aVThe split-and-strip operation could probably be merged into one function with the  call, but that depends on what else you might use the  functionality for
p29021
as(dp29022
g16
V100297
p29023
stp29024
a((dp29025
g2
(lp29026
VWhen you use a function to filter for matching elements, you pass in a reference to just the function, not it's result
p29027
aVIn other words, you are not supposed to call it before passing it to
p29028
aVThe function is called with only one argument, the element itself
p29029
aVMoreover, the  attribute has been split into a list
p29030
aVSo to match your specific elements, you need to difen your match function as:
p29031
aVThis function returns  for a  tag with the  class, or a  tag with all three classes present
p29032
aVPass this to  without calling it:
p29033
as(dp29034
g16
V100297
p29035
stp29036
a((dp29037
g2
(lp29038
VCommands without a path are always only looked up on the
p29039
aVYou cannot cd to a directory and have  (or your shell for that matter) find a command located in that  directory without specifying at least a relative path
p29040
aVThis is standard command lookup behaviour
p29041
aVIf you want to run a command in the current working directory, you must specify a path of  to make it explicit the  search semantics are not to be used
p29042
aVRelative paths in the  environment variable are also not supported everywhere; adding  to PATH is considered a security risk and some systems explicitly filter out  from the PATH
p29043
aVYou must have migrated away from a system that allowed this, to a system that does disallow  in the
p29044
as(dp29045
g16
V100297
p29046
stp29047
a((dp29048
g2
(lp29049
VYou could try and update your samples as you read the coordinates
p29050
aVThis at least saves you from having to store everything in memory before running your sample
p29051
aVThis is not guaranteed to make things faster
p29052
aVThe following is based off of BlkKnght's excellent answer to build a random sample from file input without retaining all the lines
p29053
aVThis just expanded it to keep multiple samples instead
p29054
aVThe above function takes  and your boundary coordinates, as well as the sample size , and returns grouped samples that have at most  items in each group, picked uniformly
p29055
aVBecause all you use the  for is as a group key, I reduced it to only calculating the  tuple, there is no need to make it a string
p29056
aVYou can write these out to a file with:
p29057
as(dp29058
g16
V100297
p29059
stp29060
a((dp29061
g2
(lp29062
VYour problem is with how you display the data when you read it from the database
p29063
aVYou are looking at UTF-8 data mis-interpreted as Latin 1
p29064
aVThe above encoded a  string to UTF-8, then misinterprets it as Latin 1 (ISO 8859-1), and the  and  codepoints, which were encoded to two UTF-8 bytes each, are re-interpreted as two latin-1 code points each
p29065
aVSince you are running Python 2, you shouldn't need to  already encoded data
p29066
aVIt'd be better if you inserted  objects instead; so you want to decode instead:
p29067
aVBy calling  on the encoded data, you are asking Python to first decode the data (using the default encoding) so that it then can encode for you
p29068
aVIf the default on your python has been changed to  you would see the same effect; UTF-8 data interpreted as Latin 1 before being re-encoded to Latin-1
p29069
aVYou may want to read up on Python and Unicode:
p29070
aVThe Python Unicode HOWTO
p29071
aVPragmatic Unicode by Ned Batchelder
p29072
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p29073
aVby Joel Spolsky
p29074
as(dp29075
g16
V100297
p29076
stp29077
a((dp29078
g2
(lp29079
VThe  command wants to add a  entry for your project so that it can be imported as an egg
p29080
aVSee the Development mode documentation, as well as the  command docs
p29081
aVThe default is to put that entry in site-packages
p29082
aVSet a different library path with the  switch
p29083
as(dp29084
g16
V100297
p29085
stp29086
a((dp29087
g2
(lp29088
VFor a simple server such as one based on  you could use a signal handler:
p29089
aVThe  call causes the OS to send a periodic  signal to our process
p29090
aVThis isn't too precise; the  call is set for 30 second intervals
p29091
aVAny incoming request resets a global timestamp and the  being called every 30 seconds compares checks if 5 minutes have passed since the last time the timestamp has been set
p29092
aVThe  signal will interrupt a running request as well, so whatever you do in that handler needs to finish quickly
p29093
aVWhen the function returns the normal python code flow resumes, just like a thread
p29094
aVNote that this requires at least Python 2
p29095
ag4892
aV4 for this to work; see issue 7978, and 2
p29096
ag4892
aV4 is not yet released
p29097
aVYou can either download the  file that will be included in Python 2
p29098
ag4892
aV4, or you could apply the following backport to add the  handling introduced in that version:
p29099
as(dp29100
g16
V100297
p29101
stp29102
a((dp29103
g2
(lp29104
VYou want to assign the return value of  back to the local  variable, it's not passed by reference:
p29105
aVYou'll also need to set  before you go into the loop
p29106
aVLocal variables in functions are not available in other functions
p29107
aVAs a result, you don't need to pass  to  at all:
p29108
aVand the loop becomes:
p29109
aVIt doesn't much matter what you set  to in the  function to start with, as long as it'll never be equal to  before the user has made a guess
p29110
as(dp29111
g16
V100297
p29112
stp29113
a((dp29114
g2
(lp29115
VNo, variables in Python are not pointers
p29116
aVThey refer to objects on a heap instead, and assigning to a variable doesn't change the referenced object, but the variable
p29117
aVVariables and objects are like labels tied to balloons; assignment reties the label to a different balloon instead
p29118
aVSee this previous answer of mine to explore that idea of balloons and labels a bit more
p29119
aVThat said, some object types implement specific in-place addition behaviour
p29120
aVIf the object is mutable (the balloon itself can change), then an in-place add could be interpreted as a mutation instead of an assignment
p29121
aVSo, for integers,  is really the same as  because integers are immutable
p29122
aVYou have to create a new integer object and tie the  label to that new object
p29123
aVLists on the other hand, are mutable and  is implemented as a  and that changes the  balloon itself
p29124
aVAn assignment still takes place, but it is a reassigment of the same object, as the  method simply returns  instead of a new object
p29125
aVWe end up re-tying the label to the same balloon
p29126
aVThe loop simply gives you a reference to the next item in the list on each iteration
p29127
aVIt does not let you change the original list itself (that's just another set of balloon labels); instead it gives you a new label to each of the items contained
p29128
as(dp29129
g16
V100297
p29130
stp29131
a((dp29132
g2
(lp29133
VLoop comprehensions do not necessarily speed up a loop
p29134
aVThey only speed up a loop if the end result should be a list
p29135
aVList comprehensions are faster than creating an empty list and appending to it one by one
p29136
aVIn your case, you want to write items to a file, and not create a new list
p29137
aVThe list creation cost is then wasted
p29138
aVYou don't need the  call though, just loop over
p29139
aVYou don't need  either, as you ignore the keys
p29140
aVUse  instead:
p29141
aVI used  as a loop variable;  is easily confused for  in many fonts
p29142
as(dp29143
g16
V100297
p29144
stp29145
a((dp29146
g2
(lp29147
VIf you want to access each column in the file separately, it'd be most efficient to loop over the  once collecting the column data:
p29148
aVNow  is a dictionary with a list per column:
p29149
as(dp29150
g16
V100297
p29151
stp29152
a((dp29153
g2
(lp29154
VYou are doing just fine; I use a slightly more readable version of the same code:
p29155
aVand I sorted the keys (dictionaries do not have a fixed order)
p29156
aVPython PostgreSQL database adapters follow the DBAPI v2
p29157
aV0 specification, which supports using SQL parameters and give the database a chance to prepare the statement for you
p29158
aVHowever, these use a different syntax, usually one or two of the variants named in the specification
p29159
as(dp29160
g16
V100297
p29161
stp29162
a((dp29163
g2
(lp29164
VYou want to insert a JavaScript array, not a Python list
p29165
aVThe easiest way to convert between Python and JavaScript formats is to use the  module
p29166
aVJSON is a JavaScript subset for data after all:
p29167
aVthen pass  to your template instead
p29168
aVIn the template, interpolate this without escaping:
p29169
as(dp29170
g16
V100297
p29171
stp29172
a((dp29173
g2
(lp29174
VYou'll have to use  instead:
p29175
aVIf you start with a  object instead (equivalent to the python 2
p29176
aV7 unicode) you'll need to encode to bytes first, then decode with
p29177
aVIf you need bytes as end result, you'll have to encode again to a suitable encoding ( for example, if you need to preserve literal byte values; the first 255 unicode code points map 1-on-1)
p29178
aVYour example is actually UTF-16 data with escapes
p29179
aVDecode from , back to  to preserve the bytes, then from  (UTF 16 little endian without BOM):
p29180
as(dp29181
g16
V100297
p29182
stp29183
a((dp29184
g2
(lp29185
VYou are looking for the  function:
p29186
aVIt returns a list; if you need only one node, use indexing:
p29187
aVYou really want to use the ElementTree API instead, it's easier to use
p29188
aVEven the  documentation makes this recommendation:
p29189
aVUsers who are not already proficient with the DOM should consider using the  module for their XML processing instead
p29190
aVThe ElementTree API has a  function that let's you find the first matching descendant:
p29191
as(dp29192
g16
V100297
p29193
stp29194
a((dp29195
g2
(lp29196
VYou are not erasing the character with a ; you are only backing up one position
p29197
aVSo the characters are overwritten by the next printed character instead
p29198
aVAdd a space and it works:
p29199
as(dp29200
g16
V100297
p29201
stp29202
a((dp29203
g2
(lp29204
VYour only option is to not use  to parse the data
p29205
aVThat's a feature of the  library, it fixes HTML that is lacking, such as adding back in missing required elements
p29206
as(dp29207
g16
V100297
p29208
stp29209
a((dp29210
g2
(lp29211
VYour  value must be a  or  object
p29212
aVThe assertion you see is only raised if that is not the case
p29213
aVYou'll need to tripple-check that your  value is not a list, a tuple, a bytesarray or any other type that is not  or
p29214
as(dp29215
g16
V100297
p29216
stp29217
a((dp29218
g2
(lp29219
VYou want to use , which does exactly that (get the most precise timer for the current platform)
p29220
aVTo subtract 5 seconds, just subtract 5:
p29221
aVThe time given is a float value representing seconds
p29222
as(dp29223
g16
V100297
p29224
stp29225
a((dp29226
g2
(lp29227
VYou can't have it both ways; you can serve the subfolder as part of your site, but for certain things you have to have access the site root
p29228
aVSet up a separate, private domain to access the root folder like a normal site, and access the control panel from there
p29229
aVControl panel views are normally tied to the Plone portal root object, with good reason
p29230
as(dp29231
g16
V100297
p29232
stp29233
a((dp29234
g2
(lp29235
VWhy would the server need to work asynchronously
p29236
aVDjango is a WSGI application; the concurrency model depends on the server you run it in, and that can be threading, multiprocessing, asynchronous (select loop driven) or a combo of those
p29237
aVA Django request itself is completely synchronous
p29238
aVQuerying the database blocks the request until the result is returned
p29239
as(dp29240
g16
V100297
p29241
stp29242
a((dp29243
g2
(lp29244
VWhat is the expected output
p29245
aVThe behaviour is perfectly normal for a ; you are replacing the values for each key with a new value
p29246
aVIf you wanted the values to be lists of the values for each matching row, it's easier to use a  with a  factory:
p29247
aVThis outputs:
p29248
aVA  is a subclass of ,so  will print
p29249
aVWhen you use  you effectively do this:
p29250
ag7233
ag1298
aVset each key in  to the value found in the row being processed
p29251
aVWhen the last row is being processed, it's values overwrite the values of previous rows
p29252
aVIf you want to filter out just the rows that match a certain  criteria, then adding them to a list is just perfectly fine
p29253
aVYou then loop over the matched results to process them:
p29254
aVor you can build a generator filter that you wrap around your  to do the filtering for you, so you don't need to build the list in memory:
p29255
as(dp29256
g16
V100297
p29257
stp29258
a((dp29259
g2
(lp29260
VYou are writing data correctly
p29261
aVThe problem lies in whatever is reading the data; it is interpreting the UTF-8 data as Latin 1 instead:
p29262
aVThe U+00E9 codepoint (, LATIN SMALL LETTER E WITH ACUTE) is encoded to two bytes in UTF-8, C3 and A9 in hex
p29263
aVIf you treat those two bytes as Latin1 instead, where each character is always only one byte, you get  and  instead
p29264
aVThere is no standard for how to treat CSV files and encoding, you'll need to adjust your encoding to the intended target application to read this information
p29265
aVMicrosoft Excel reads CSV files according to the current codepage, for example
p29266
aVIf your CSV reader is expecting Latin 1, by all means, encode to Latin 1 instead
p29267
as(dp29268
g16
V100297
p29269
stp29270
a((dp29271
g2
(lp29272
VUse the  method:
p29273
aVThe  method follows symlinks; if that is not desirable, use the  method instead
p29274
aVSee the  class information for what attributes are available
p29275
aVis the size in bytes
p29276
as(dp29277
g16
V100297
p29278
stp29279
a((dp29280
g2
(lp29281
VYou want to retrieve the actual object from the module; use the  function for that:
p29282
aVdoes not interpret the contents of the objects you pass to it; a string that happens to contain a value that corresponds to the name of a function in a module is not dereferenced for you
p29283
as(dp29284
g16
V100297
p29285
stp29286
a((dp29287
g2
(lp29288
VThere is no difference between the first two spellings
p29289
aVIn python 2
p29290
aV7, there is a huge difference between the latter two
p29291
aVInheriting from  makes it a new-style class, changing the inheritance semantics and adding support for descriptors (, , etc
p29292
aVIt's the default in Python 3
p29293
aVNew-style classes were introduced in Python 2
p29294
aV2 to unify types (such as  and ), and classes, and because several things change in backwards-incompatible ways, you need to 'opt in', explicitly inherit from  to enable the changes
p29295
aVIn Python 3, inheriting from  is no longer needed, classes are new-style, always
p29296
as(dp29297
g16
V100297
p29298
stp29299
a((dp29300
g2
(lp29301
VThe default return value is
p29302
aVFrom the documentation on Calls:
p29303
aVA call always returns some value, possibly , unless it raises an exception
p29304
aVHow this value is computed depends on the type of the callable object
p29305
as(dp29306
g16
V100297
p29307
stp29308
a((dp29309
g2
(lp29310
VThat is the standard way to swap two variables, yes
p29311
as(dp29312
g16
V100297
p29313
stp29314
a((dp29315
g2
(lp29316
VBecause you are defining this as a nested set of classes, you are needlessly complicating things
p29317
aVThe explanation is now going to involve words like "class suite" and why you'd need  in one place and  in another
p29318
aVYou are also trying to concatenate lists and a string, which won't work
p29319
aVJust keep things simple, create a module named , then you can do  and create an instance of
p29320
as(dp29321
g16
V100297
p29322
stp29323
a((dp29324
g2
(lp29325
VGlobals are per module, and functions look up globals in the module they are defined in
p29326
aVSo a class  defined in a module named , that needs access to a function named  will look up that function in it's own namespace, so in module
p29327
aVIf functions were to look up globals in the module they were imported into, you'd have to repeatedly import all the dependencies of any function you ever wanted to use
p29328
aVThis would not be practical
p29329
as(dp29330
g16
V100297
p29331
stp29332
a((dp29333
g2
(lp29334
VIt's the operating system
p29335
aVModern OSes use disk caches to speed up repeated reads
p29336
as(dp29337
g16
V100297
p29338
stp29339
a((dp29340
g2
(lp29341
VThe portlets included in Plone Software Center are 'classic portlets'; they predate the current portlet system and are purely skin templates, really
p29342
aVTo include these, add a 'Classic portlet' to the Software Project type (in the site setup -> Types -> select 'Software Project' in the dropdown box -> Manage portlets assigned to this content type)
p29343
aVThe Classic Portlet type takes two parameters, a template and a macro
p29344
aVThe PSC portlets you are looking for use the  and  templates, in both the macro is called
p29345
as(dp29346
g16
V100297
p29347
stp29348
a((dp29349
g2
(lp29350
VThere are unicode literals in the string
p29351
aVNo, there are not
p29352
aVThere are bytes in the string
p29353
aVPython simply goes with the bytes your editor saved to disk when you created the file
p29354
aVWhen you prefixed the string with a , you signalled to python that you are creating a  object instead
p29355
aVPython now pays attention to the encoding you specified at the top of your source file, and it decodes the bytes in the source file to a  object based on the encoding you specified
p29356
aVIn both cases, your editor saved a series of bytes to a file, for the  character, the UTF-8 encoding is three bytes, represented in hexadecimal as E282AC
p29357
aVThe last byte in the bytestring is thus AC, or 172 in decimal
p29358
aVOnce you decode the last 3 bytes as UTF-8, they together become the Unicode codepoint U+20AC, which is 8364 in decimal
p29359
aVYou really should read up on Python and Unicode:
p29360
aVThe Python Unicode HOWTO
p29361
aVPragmatic Unicode by Ned Batchelder
p29362
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p29363
aVby Joel Spolsky
p29364
as(dp29365
g16
V100297
p29366
stp29367
a((dp29368
g2
(lp29369
VThe  object already has a  parameter
p29370
aVOr you can use the  header:
p29371
aVIf you need to redirect within the application,  is the attribute to look at, as it'll include the full path for the WSGI application, even when rooted at a deeper path (e
p29372
ag1298
aVstarting at )
p29373
aVIt probably is better still to use  to have Flask generate a URL for you; it'll take  into account
p29374
aVSee the URL Building documentation
p29375
as(dp29376
g16
V100297
p29377
stp29378
a((dp29379
g2
(lp29380
V files only apply to skin objects
p29381
aVFor browser views, you need to specify permissions in the ZCML configuration of the views:
p29382
aVYou specify permissions; the context defines what roles have what permissions
p29383
as(dp29384
g16
V100297
p29385
stp29386
a((dp29387
g2
(lp29388
VYour mistake is assuming that all items in the feed will have an  tag
p29389
aVFor your first feed, that is indeed the case, but at the time of this post, the second feed URL has two items that do not have a enclosure URL included
p29390
aVSimply skip these items:
p29391
as(dp29392
g16
V100297
p29393
stp29394
a((dp29395
g2
(lp29396
VLists are mutable; multiple references to the same list will see all the changes you make to it
p29397
aVmeans: replace every index in this list with an empty list
p29398
aVBecause you reference the same list in different places (including in the dictionary values), you see the change reflected everywhere
p29399
aVInstead, just point  to a new empty list instead:
p29400
aVThe empty slice assignment syntax you used should only be used if you want to clear the contents of a list, not when you simply want to create a new empty list
p29401
as(dp29402
g16
V100297
p29403
stp29404
a((dp29405
g2
(lp29406
VYou have a flaw in your  file; you never store the instance
p29407
aVStore it in a variable:
p29408
aVYou cannot just call the constructor and let it dangle
p29409
aVLooping over the attributes of  looking for something named  is not going to get what you want, you'll find the class reference, not the instance
p29410
aVPerhaps you should be looking for objects of the  type instead:
p29411
aVIf you want to avoid having to import the  class, you'd have to test for the type name instead, which is more fragile:
p29412
aVIf you want to really postpone construction, instead construct it later with a set of pre-set values, use :
p29413
aVIf you now import  and call it, the partial will apply the arguments already passed in and create the instance:
p29414
as(dp29415
g16
V100297
p29416
stp29417
a((dp29418
g2
(lp29419
VPython long integers have no upper limit, they are only limited to what you can fit in RAM:
p29420
aVThe  value tells you where python will start to use the  type instead of  to represent integers; the transition is automatic
p29421
aVYou are not likely to hit that memory limit when calculating fibonacci sequences
p29422
as(dp29423
g16
V100297
p29424
stp29425
a((dp29426
g2
(lp29427
VSeeking within a file will move the read pointer by bytes, not by characters
p29428
aVThe  call expects to be able to read whole characters instead
p29429
aVBecause UTF-8 uses multiple bytes for any unicode codepoint beyond the ASCII character set, you cannot just seek into the middle of a multi-byte UTF-8 codepoint and expect  to work
p29430
aVThe U+00a4 codepoint (the glyph ) is encoded to two bytes, C3 and A4
p29431
aVIn the file, this means there are now 5 bytes, representing , , the hex bytes C3 and A4, then
p29432
aVBy seeking to position 3, you moved the file header to the A4 byte, and calling  then fails because without the preceding C3 byte, there is not enough context to decode the character
p29433
aVThis raises the ; the A4 byte is unexpected, as it is not a valid UTF-8 sequence
p29434
aVSeek to position 4 instead:
p29435
aVBetter still, don't seek around in UTF-8 data, or open the file in binary mode and decode manually
p29436
as(dp29437
g16
V100297
p29438
stp29439
a((dp29440
g2
(lp29441
VThe  library uses child processes; these each run in their own Python interpreter
p29442
aVThe OS can and will schedule these process across multiple processes and cores, yes
p29443
aVBecause each child process is a separate Python interpreter process, the GIL does not interfere
p29444
as(dp29445
g16
V100297
p29446
stp29447
a((dp29448
g2
(lp29449
VElementTree is not too smart about namespaces
p29450
aVYou need to give the ,  and  methods an explicit namespace dictionary
p29451
aVThis is not documented very well:
p29452
aVPrefixes are only looked up in the  parameter you pass in
p29453
aVThis means you can use any namespace prefix you like; the API splits off the  part, looks up the corresponding namespace URL in the  dictionary, then changes the search to look for the XPath expression  instead
p29454
aVYou can use the same syntax yourself too of course:
p29455
aVIf you can switch to the  library things are better; that library supports the same ElementTree API, but collects namespaces for you in a  attribute on elements
p29456
as(dp29457
g16
V100297
p29458
stp29459
a((dp29460
g2
(lp29461
VUse the standard-library  module instead, and set the  keyword parameter to False when encoding:
p29462
aVNote that you still need to explicitly encode the result to UTF8 because the  function returns a  object in that case
p29463
as(dp29464
g16
V100297
p29465
stp29466
a((dp29467
g2
(lp29468
VYou don't need to import the  module; sets are built in now
p29469
aVJust use the built-in  type instead:
p29470
aVYou can use the  set literal syntax too:
p29471
aVIf you want to use the slower  module anyway, the object is called  with a capital :
p29472
aVbut note that the module has been deprecated; using it does not add anything over the built-in types
p29473
aVThe module has been removed altogether in Python 3
p29474
as(dp29475
g16
V100297
p29476
stp29477
a((dp29478
g2
(lp29479
VA regular expression to match those would be:
p29480
aVwith some extra whitespace tolerance thrown in
p29481
aVResults:
p29482
as(dp29483
g16
V100297
p29484
stp29485
a((dp29486
g2
(lp29487
VUse a proper  install script instead, which lists your dependencies
p29488
aVSee the Hitchhikers Guide to Packaging and the Distribute documentation
p29489
aVTools such as ,  or  will also install your dependencies as needed
p29490
as(dp29491
g16
V100297
p29492
stp29493
a((dp29494
g2
(lp29495
VTweepy gives you richer objects; it parsed the JSON for you
p29496
aVThe  objects have the same attributes as the JSON structures that Twitter sent; just look up the Tweet documentation to see what is available:
p29497
as(dp29498
g16
V100297
p29499
stp29500
a((dp29501
g2
(lp29502
V only accepts one argument, you are passing it 3
p29503
aVYou need to use string formatting or concatenation to make it one argument:
p29504
aVYou were confusing this with the  function, which does indeed take more than one argument and will concatenate the values into one string for you
p29505
as(dp29506
g16
V100297
p29507
stp29508
a((dp29509
g2
(lp29510
VYou are not actually writing your data, only converting to JSON
p29511
aVCall  on the open file:
p29512
aVOnly open  once; every time you open it for writing with the  mode it'll be wiped first
p29513
aVAlternatively, get a reference to the serializer and tell it to write to the open file directly:
p29514
aVwhich is more efficient
p29515
as(dp29516
g16
V100297
p29517
stp29518
a((dp29519
g2
(lp29520
VIf you are using SQL parameters for the insertion statement, this is efficient enough; the bottleneck will be in the network communication with Oracle
p29521
aVBy using SQL parameters, Oracle is given a chance to prepare a query plan, then reuse it on each and every insert
p29522
aVIf you plan to roll back the transaction when an insertion fails, however, you may as well use
p29523
as(dp29524
g16
V100297
p29525
stp29526
a((dp29527
g2
(lp29528
VYou are looking for slicing:
p29529
aVPython strings are sequences, to select the first  characters, simply use a slice to select those, and for the second half select everything starting at  until the end
p29530
aVThis is covered in the Python tutorial as well
p29531
as(dp29532
g16
V100297
p29533
stp29534
a((dp29535
g2
(lp29536
VFor CGI, I would not use
p29537
aVwrites to  and  has been opened with a specific encoding and how that is determined is platform dependent and can differ based on how the script is run
p29538
aVRunning your script as a CGI script means you pretty much do not know what encoding will be used
p29539
aVInstead, write directly to , after explicitly encoding to UTF-8
p29540
aVMake a helper function to make this easier:
p29541
as(dp29542
g16
V100297
p29543
stp29544
a((dp29545
g2
(lp29546
VYou could seek to the end of the file, then call :
p29547
aVThe above example uses the  constants to set how to interpret the seek offset (the first argument to )
p29548
aVor you can use the  function to retrieve the size of your open file:
p29549
aVThe latter information can be more easily cached by the OS so will often be faster
p29550
as(dp29551
g16
V100297
p29552
stp29553
a((dp29554
g2
(lp29555
VSplit on the  pipe, then skip everything until the first ; the next element is the ID:
p29556
aVDemonstration:
p29557
aVIn other words, there is no need for a regular expression
p29558
aVMaking this into a generator method to get all ids:
p29559
aVThis gives:
p29560
aVor you can use it in a simple loop:
p29561
as(dp29562
g16
V100297
p29563
stp29564
a((dp29565
g2
(lp29566
VThe standard  function already, by default, returns a buffered file (if available on your platform)
p29567
aVFor file objects that is usually fully buffered
p29568
aVUsually here means that Python leaves this to the C stdlib implementation; it uses a  call ( on Windows to support UTF-16 filenames), which means that the default buffering for a file is chosen; on Linux I believe that would be 8kb
p29569
aVFor a pure-read operation like XML parsing this type of buffering is exactly what you want
p29570
aVThe XML parsing done by  reads the file in chunks of 16384 bytes (16kb)
p29571
aVIf you want to control the buffersize, use the  keyword argument:
p29572
aVwhich will override the default buffer size (which I'd expect to match the file block size or a multiple thereof)
p29573
aVAccording to this article increasing the read buffer should help, and using a size at least 4 times the expected read block size plus 8 bytes is going to improve read performance
p29574
aVIn the above example I've set it to 8 times the ElementTree read size
p29575
aVThe  function represents the new Python 3 I/O structure of objects, where I/O has been split up into a new hierarchy of class types to give you more flexibility
p29576
aVThe price is more indirection, more layers for the data to have to travel through, and the Python C code does more work itself instead of leaving that to the OS
p29577
aVYou could try and see if  is going to perform any better
p29578
aVOpening in  mode will give you a  instance
p29579
aVYou do not want to use ; the underlying expat parser wants raw data as it'll decode your XML file encoding itself
p29580
aVIt would only add extra overhead; you get this type if you open in  (textmode) instead
p29581
aVUsing  may give you more flexibility and a richer API, but the underlying C file object is opened using  instead of , and all buffering is handled by the Python  implementation
p29582
aVYour problem will be processing this beast, not the file reads, I think
p29583
aVThe disk cache will be pretty much shot anyway when reading a 800GB file
p29584
as(dp29585
g16
V100297
p29586
stp29587
a((dp29588
g2
(lp29589
VYou need to remove the following line:
p29590
aValready calls
p29591
aVis a file object; writing that to  again makes no sense
p29592
as(dp29593
g16
V100297
p29594
stp29595
a((dp29596
g2
(lp29597
VYes, at the very least for ; traceback objects hold a reference to the current frame, and that makes this a circular reference
p29598
aVBy deleting the local reference you break that circle, so you don't have to hope and trust that the garbage collector will be able to
p29599
aVFrom the  function docs:
p29600
aVWarning: Assigning the traceback return value to a local variable in a function that is handling an exception will cause a circular reference
p29601
aVThis will prevent anything referenced by a local variable in the same function or by the traceback from being garbage collected
p29602
aVSince most functions don\u2019t need access to the traceback, the best solution is to use something like  to extract only the exception type and value
p29603
aVIf you do need the traceback, make sure to delete it after use (best done with a
p29604
aVstatement) or to call  in a function that does not itself handle an exception
p29605
as(dp29606
g16
V100297
p29607
stp29608
a((dp29609
g2
(lp29610
VYour  is a string, not an integer, and as a SQL parameter it is thus given quotes
p29611
aVTry this:
p29612
as(dp29613
g16
V100297
p29614
stp29615
a((dp29616
g2
(lp29617
VYou need to include the full namespace in your XPath query:
p29618
aVAlternatively, you can use an explicit namespace mapping, one that maps a prefix (you choose) to namespace URI:
p29619
aVThe  prefix is looked up in whatever you pass in as , then transformed to the same XPath query given in the first example
p29620
aVYou can expand on the  xpath qualifier to find more complex matches:
p29621
aVshould return the  element that has the attribute  whose parent is a  element with a  attribute, for example
p29622
as(dp29623
g16
V100297
p29624
stp29625
a((dp29626
g2
(lp29627
V is not an index into , it is a value from
p29628
aVIf you need an index into it, use  to add that index to your loop
p29629
aVBecause you are looking at the next item in  as well, only loop over all but the last value:
p29630
aVIn this case, you can even have  start at 1 for an easy offset:
p29631
as(dp29632
g16
V100297
p29633
stp29634
a((dp29635
g2
(lp29636
VIt's a bug in , see issue 1189
p29637
aVThe current proposed fix is to simply delete line 163 of :
p29638
as(dp29639
g16
V100297
p29640
stp29641
a((dp29642
g2
(lp29643
VDefine  yourself:
p29644
aVThe Pygame tutorial I think you are following does exactly that
p29645
aVIn other words, the  library has no constants for this value, it's just an integer
p29646
as(dp29647
g16
V100297
p29648
stp29649
a((dp29650
g2
(lp29651
VI cannot imagine CherryPy mangling data like that
p29652
aVYour test to write out the newline count shows that it is much more probably that  is not sending the data with newlines intact, and by the time your request handler has it all newlines have been stripped (so  just returns  resulting in one line being written)
p29653
aVMake sure you POST with the  switch;  defaults to ASCII and could very well be altering the newlines for you:
p29654
aVis the same as
p29655
aVTo post data purely binary, you should instead use the  option
p29656
as(dp29657
g16
V100297
p29658
stp29659
a((dp29660
g2
(lp29661
VThe  library utilizes a buffer when reading your file, so the file pointer jumps in larger blocks
p29662
aVIt does not read your file line-by-line
p29663
aVIt reads the data in larger chunks to make parsing easier, and because newlines could be embedded in quotes, reading CSV data line-by-line would not work
p29664
aVIf you have to give a progress report, then you need to pre-count the number of lines
p29665
aVThe following will only work if your input CSV file does not embed newlines in column values:
p29666
aVThere are other methods to count the number of lines (see How to get line count cheaply in Python
p29667
aVbut since you'll be reading the file anyway to process it as a CSV, you may as well make use of the open file you have for that
p29668
aVI'm not certain that opening the file as a memory map, then read it as a normal file again is going to perform any better
p29669
as(dp29670
g16
V100297
p29671
stp29672
a((dp29673
g2
(lp29674
VIt takes a copy of the tuple, instead of a reference to the tuple itself
p29675
aVThe  syntax is a slice with the default start and end values (0 and the length of the list), returning a new tuple with those indices, so effectively an exact copy of the contents
p29676
aVFor tuples, this doesn't make much sense, because tuples are immutable
p29677
aVYou can safely pass around references to a tuple without changing what it's indices refer to
p29678
aVIt works the same for lists, though
p29679
aVYou often need to create a copy of a list to be able to modify the contents, and using the default 'all elements' slice is a nice, concise and fast method of doing just that
p29680
as(dp29681
g16
V100297
p29682
stp29683
a((dp29684
g2
(lp29685
VSimply remove the  call, and just use the rows from your cursor directly:
p29686
as(dp29687
g16
V100297
p29688
stp29689
a((dp29690
g2
(lp29691
V is a function, not a list
p29692
aVwould work a lot better, but then you are just reading the file 5 times (four times reading an empty result)
p29693
aVUse  to read one line in a file, and a list comprehension to get the lines into a list easily:
p29694
as(dp29695
g16
V100297
p29696
stp29697
a((dp29698
g2
(lp29699
VJust replace the tuples in the list; you can alter a list while looping over it, as long as you avoid adding or removing elements:
p29700
aVor, if you can summarize the changes to  into a function as I did above, use a list comprehension:
p29701
as(dp29702
g16
V100297
p29703
stp29704
a((dp29705
g2
(lp29706
VYou need to transform the second list into something you can actually use with any decent performance:
p29707
aVThis presumes that for each  value in  there is a matching  in the second
p29708
aVThis gives:
p29709
as(dp29710
g16
V100297
p29711
stp29712
a((dp29713
g2
(lp29714
VIt's easy enough with a dict comprehension:
p29715
aVfor Python 2
p29716
ag4892
aVFor Python 3, use  instead
p29717
aVFor Python 2
p29718
aV6 and earlier, where there is no dict comprehension syntax yet, use:
p29719
aVis a quick and concise method to remove any  characters from the start of a key
p29720
as(dp29721
g16
V100297
p29722
stp29723
a((dp29724
g2
(lp29725
VYou assigned a string to a variable named
p29726
aVUse a different name instead, it is masking your  module import
p29727
as(dp29728
g16
V100297
p29729
stp29730
a((dp29731
g2
(lp29732
VThe line is nonsense
p29733
aVLet's take a look at the options we have:
p29734
aVis falsy (so , an empty list, an empty string, etc
p29735
aVPython will return the value of  because there is no point in looking at the rest of the expression as the  operator evaluates to  whatever the right-hand side evaluates to
p29736
aVIt then tests  and returns
p29737
aVis not falsy
p29738
aVPython evaluates , resolves that to the value of , then tests , and because  is truthy, returns
p29739
aVAfter all,  will now always resolve to  and there is no point in looking at
p29740
aVThis basically comes down to , the  is a no-op
p29741
as(dp29742
g16
V100297
p29743
stp29744
a((dp29745
g2
(lp29746
VThat's a CRUD (create-read-update-delete) pattern
p29747
aVThe  package has specific support for just such forms
p29748
aVDefine a schema for a types group:
p29749
aVthen use a CRUD form:
p29750
aVGroups need to have an id, items are shown in the order that  returns them
p29751
as(dp29752
g16
V100297
p29753
stp29754
a((dp29755
g2
(lp29756
VYou want to use the response  method instead:
p29757
aVwhich takes care of proper escaping, etc
p29758
as(dp29759
g16
V100297
p29760
stp29761
a((dp29762
g2
(lp29763
VYour function  takes one parameter, a list of matrices
p29764
aVcalls it with two parameters instead, each a matrix
p29765
aVChange your  method to accept an arbitrary number of arguments instead:
p29766
aVinstead of , then call it as
p29767
as(dp29768
g16
V100297
p29769
stp29770
a((dp29771
g2
(lp29772
VThey are indeed equivalent, but the conditional expression variation is preferred
p29773
aVYour expression narrowly avoids the typical  pitfall where the middle expression evaluates to a falsy value ( and  will result in )
p29774
as(dp29775
g16
V100297
p29776
stp29777
a((dp29778
g2
(lp29779
VThere is a great sliding window generator in an old version of the Python docs with  examples:
p29780
aVUsing that your moving averages is trivial:
p29781
aVRunning this against your input (mapping the strings to integers) gives:
p29782
aVTo return  the first  iterations for 'incomplete' sets, just expand the  function a little:
p29783
as(dp29784
g16
V100297
p29785
stp29786
a((dp29787
g2
(lp29788
VDon't use ;  is definitely the way to go
p29789
aVYour problem though is that you expect Python to understand that you want to interpolate  into a string
p29790
aVAs great as Python is, it is not able to read your mind like that
p29791
aVUse string formatting instead:
p29792
aVIf you want to pass a filename to another command, you should not use the  type option
p29793
aVYou want a filename, not an open file object:
p29794
aVBut do use  instead of :
p29795
aVIf  implements command line parsing properly, the  is optional and you can use the following call instead, avoiding string concatenation altogether:
p29796
as(dp29797
g16
V100297
p29798
stp29799
a((dp29800
g2
(lp29801
VAccording to this announcement the purpose of chunked upload is to make it possible to deal with spotty connections by letting you upload a large file in chunks instead
p29802
aVIt's not about deduplication
p29803
aVIf you take a look through the Core API documentation (not that much to read, really), there is no mention anywhere of de-duplication being offered through the API
p29804
aVWether you use Python or any other language or library, without the published API supporting de-duplication, there is no way you can access this functionality
p29805
as(dp29806
g16
V100297
p29807
stp29808
a((dp29809
g2
(lp29810
VYou are mixing tabs and spaces, run python with  to check:
p29811
aVConfigure your editor to only use spaces for indentation
p29812
aVUsually, there is a menu option to convert all tabs to spaces as well
p29813
aVClearly, when you pasted the code into the Stack Overflow window, you can already see that your  line is using only spaces, but the other lines are using tabs:
p29814
aVbecause Stack Overflow renders tabs to 4 spaces
p29815
as(dp29816
g16
V100297
p29817
stp29818
a((dp29819
g2
(lp29820
VFor a  POST, simply access :
p29821
as(dp29822
g16
V100297
p29823
stp29824
a((dp29825
g2
(lp29826
VSeveral reasons:
p29827
aVNot all packages are pure-python packages
p29828
aVIt's easy to include C-extensions in your package and have  automate the compilation process
p29829
aVAutomated dependency management; dependencies are declared and installed for you by the installer tools (, , )
p29830
aVDependencies can be declared dynamically too (try to import , if that fails, declare a dependency on , etc
p29831
aVCustom resource installation setups
p29832
aVThe installation process is highly configurable and dynamic
p29833
aVThe same goes for dependency detection; the  has to jump through quite some hoops to make installation straightforward with all the various platforms and quirks of the Oracle library distribution options it needs to support, for example
p29834
aVWhy would you still want to do this for CLI scripts
p29835
aVThat depends on how crucial the CLI is to you; will you be maintaining this over the coming years
p29836
aVThen I'd still use a , because it documents what the dependencies are, including minimal version needs
p29837
aVYou can add tests (), and deploy to new locations or upgrade dependencies with ease
p29838
as(dp29839
g16
V100297
p29840
stp29841
a((dp29842
g2
(lp29843
VThe  is the 'start of string' anchor, the expression only matches at the start
p29844
aVThe  block is a character class, the contained characters are treated as a set
p29845
aVOne of these at the start of the line is enough to constitute a match
p29846
aVThe dashes in the class constitute a range, running from  through to  and from  through to ; the end of the first range overlaps the start of the second, so  is enough
p29847
aVBetween the  and  lie all printable ASCII characters, apart from the space character
p29848
aVThe  slash lies just before the digits; it looks as if someone forgot to merge the two sets after some refactoring
p29849
aVSo any of the following lines would match:
p29850
as(dp29851
g16
V100297
p29852
stp29853
a((dp29854
g2
(lp29855
VPython does not use  escape codes for printable bytes
p29856
aVThe  byte, for example, is shown as the printable  character instead:
p29857
aVThe same goes for every other byte in your value that can be displayed as a ASCII character instead;  is printed as ,  is shown as , etc
p29858
aVThis is normal behaviour, the value is still the same:
p29859
as(dp29860
g16
V100297
p29861
stp29862
a((dp29863
g2
(lp29864
VI expect the  call to be faster
p29865
aVIt compiles to only one instruction:
p29866
aVIn both cases the ref count for your large object is lowered by 1, and if it reaches 0 it'll be removed from memory
p29867
aVThe speed difference is absolutely minimal though:
p29868
aVThis is not something you need to worry about
p29869
as(dp29870
g16
V100297
p29871
stp29872
a((dp29873
g2
(lp29874
VIn cPython, objects are automatically destroyed when their reference count drops to 0
p29875
aVIf you delete a entry from your list, the reference count for the object in question is decremented
p29876
aVYou do not need to do anything special to have it destroyed, nor should you try to
p29877
aVIf any other reference to the object still exists, then destroying the object would break the other reference
p29878
aVIf you want to hold references to an object that do not stop the object from being garbage collected, use a  reference instead
p29879
as(dp29880
g16
V100297
p29881
stp29882
a((dp29883
g2
(lp29884
VThe point of using the double-underscore name convention is to prevent subclasses from (accidentally) overriding the method
p29885
aVIf you have to override it anyway, someone made a serious class design error
p29886
aVYou can do it still, by naming your object just so:
p29887
aVwhere you prefix the method name with one more underscore and the defining classname (so in this case prefixed with )
p29888
aVThe process of renaming methods and atributes with a double underscore is called private name mangling
p29889
aVIf you want to define a 'private' method that is still overridable in a subclass, you generally stick to names with one underscore instead ()
p29890
aVDue to it's dynamic nature, almost nothing in Python is truly private; with a little introspection almost anything can be reached
p29891
as(dp29892
g16
V100297
p29893
stp29894
a((dp29895
g2
(lp29896
VI think you wanted to assign to :
p29897
aVYou are using ; a comparison, instead
p29898
aVYou do this in several places;  evaluates to a boolean value (when the two items are considered equal), while  assigns to a variable
p29899
aVIn python, you can swap variables directly without a temporary:
p29900
as(dp29901
g16
V100297
p29902
stp29903
a((dp29904
g2
(lp29905
VWhen you pass SQLite a non-existing path, it'll happily open a new database for you, instead of telling you that the file did not exist before
p29906
aVWhen you do that, it'll be empty and you'll instead get a "No such table" error
p29907
aVYou are using a relative path to the database, meaning it'll try to open the database in the current directory, and that is probably not where you think it is
p29908
aVThe remedy is to use a absolute path instead:
p29909
aVYou need to loop over the cursor to see results:
p29910
aVor call :
p29911
as(dp29912
g16
V100297
p29913
stp29914
a((dp29915
g2
(lp29916
VYou have several options to create your 'namespace'
p29917
aVThe easiest two are:
p29918
aVCreate a quick custom class:
p29919
aVCall with ; this takes an arbitrary number of keyword arguments
p29920
aVUse a  class:
p29921
aVCall with ; this only takes a fixed number of arguments, but your  function could provide defaults
p29922
aVWhat you call 'dot notation' is really just attribute access
p29923
as(dp29924
g16
V100297
p29925
stp29926
a((dp29927
g2
(lp29928
VThe line that gives you a syntax error is called a dict comprehension; these were added to the language in Python 2
p29929
aV7 and 3
p29930
aVThis module is not Python 3 ready; it uses the  module for example, which has been renamed  in Python 3
p29931
aVYou'll have to stick with Python 2
p29932
ag4892
aVIf that is a showstopper for you, you'll have to raise an issue with the developer, asking for Python 2
p29933
aV6 compatibility (not that hard to achieve)
p29934
as(dp29935
g16
V100297
p29936
stp29937
a((dp29938
g2
(lp29939
VWe always download the KGS URLs to local files and use that as an extends instead:
p29940
aVwhere our  reads:
p29941
aVWe add a header to the file to name the original source, and comment out the URL extends in the files:
p29942
as(dp29943
g16
V100297
p29944
stp29945
a((dp29946
g2
(lp29947
VSQLite recommends using the  syntax, and full FOREIGN KEY support requires an extra pragma switch
p29948
aVHistorically, SQLite did not support FOREIGN KEY constraints at all, and when they were added it was with an explicit per-connection switch to turn this on to retain backwards compatibility
p29949
aVFor Django, using  suffices, does not limit Django to the more recent versions and saves having to enable the FOREIGN KEY support or detecting that the feature has been compiled in
p29950
as(dp29951
g16
V100297
p29952
stp29953
a((dp29954
g2
(lp29955
VYou are reassigning  to various variables
p29956
aVThey will not automatically update their value, you need to call  again
p29957
aVYou really want to move at least one call to  outside of your loop:
p29958
as(dp29959
g16
V100297
p29960
stp29961
a((dp29962
g2
(lp29963
V only contains a value if there is text directly in the element
p29964
aVNested elements are not included
p29965
aVIf you are using BeautifulSoup 4, use  instead:
p29966
aVFor BeautifulSoup 3, you'll need to search for all text elements:
p29967
aVIf you want to combine  and  elements into a dictionary, you'd have loop over all  elements, then use  to locate the corresponding  element, and combine that with the above  trick to build yourself a dictionary:
p29968
as(dp29969
g16
V100297
p29970
stp29971
a((dp29972
g2
(lp29973
VUse  to capture the output of another process:
p29974
aVonly returns the exit status of another process
p29975
aVThe above example presumes that  is not going to prompt for a password
p29976
as(dp29977
g16
V100297
p29978
stp29979
a((dp29980
g2
(lp29981
VYou need to split the  text by :
p29982
aVNow  is a list of values instead, use indexes to access various items:
p29983
aVAlternatively, add  to your query string and receive a JSON response from that API:
p29984
as(dp29985
g16
V100297
p29986
stp29987
a((dp29988
g2
(lp29989
VBash doesn't interpret  the way python does, it sees that as two characters
p29990
aVYou can interpret a literal  (so two characters) as a newline in python by 'decoding' from :
p29991
aVDemonstration:
p29992
aVDo note that other python string escape sequences will also be interpreted
p29993
as(dp29994
g16
V100297
p29995
stp29996
a((dp29997
g2
(lp29998
VThe return value of  is always a string
p29999
aVYou'll need to convert it to an integer if you want to use the  operator on it:
p30000
aVInstead of  you can use exception handling instead:
p30001
aVbecause  will raise  if the input is not a valid integer
p30002
as(dp30003
g16
V100297
p30004
stp30005
a((dp30006
g2
(lp30007
VUse a  raw string literal to prevent Python from interpreting  as a newline:
p30008
aVor use double backslashes:
p30009
aVor forward slashes instead:
p30010
aVAll three versions are valid on Windows
p30011
as(dp30012
g16
V100297
p30013
stp30014
a((dp30015
g2
(lp30016
V is a name defined in the function  only; when you call  the name is not visible and you get your error
p30017
aVYou have the same problem with  and
p30018
aVYou need to decide what the values for ,  and  should be before you call
p30019
aVPerhaps you wanted to set those names to the result of other functions
p30020
aVThose functions then need to use  to make those values available to the caller
p30021
aVFor example, change the  function to return the new  value:
p30022
aVthen store the result of that function in a new name:
p30023
aVand do the same for the other names and functions
p30024
aVYou really want to read through the Python tutorial on functions again
p30025
as(dp30026
g16
V100297
p30027
stp30028
a((dp30029
g2
(lp30030
VIt is indeed extremely repetitive
p30031
aVYou can use  to take most of that repetition out:
p30032
as(dp30033
g16
V100297
p30034
stp30035
a((dp30036
g2
(lp30037
VYou need to find the last node without a  pointer and add the node there:
p30038
aVBecause this has to traverse the whole list, most linked-list implementations also keep a reference to the last element:
p30039
aVBecause Python assigns to multiple targets from left to right,  is set to  before
p30040
aVSome style notes on your code:
p30041
aVUse  and  to test if an identifier points to  (it's a singleton)
p30042
aVThere is no need for accessors in Python; just refer to the attributes directly
p30043
aVUnless this is Python 3, use new-style classes by inheriting from :
p30044
as(dp30045
g16
V100297
p30046
stp30047
a((dp30048
g2
(lp30049
VThe  object needs to be saved again; write it to another  object:
p30050
aVthen get the written data with the  method:
p30051
aVThe PIL-for-python-3 landscape is rather muddled at the moment
p30052
aVThe Pillow fork looks to be the best, maintained version out there at the moment
p30053
aVIt includes fixes that make saving to a  object work
p30054
aVIf you run into a  exception using the above code, you have a version that was not yet fixed, in which case you'll have to resort to using a temporary file instead
p30055
as(dp30056
g16
V100297
p30057
stp30058
a((dp30059
g2
(lp30060
VI'd go a different direction:
p30061
aVBan Notepad
p30062
aVReally, broken software is broken software, you can only go so far to fix it's shortcomings
p30063
aVSave UTF-8 files with the BOM; U+FEFF means "ZERO WIDTH NO-BREAK SPACE", 'normal' software will mostly ignore it
p30064
as(dp30065
g16
V100297
p30066
stp30067
a((dp30068
g2
(lp30069
VPython is merely keeping your string value printable in ASCII, by showing you the escape code for the  character,
p30070
aVSome notes on your linked source code:
p30071
aVyou should not turn the response you want to parse into unicode
p30072
aVParse the raw bytes instead
p30073
aVParsers expect to decode the contents themselves
p30074
aVIn fact, the ElementTree parser will encode the data again just to be able to parse it
p30075
aVWhen you have XML in a bytestring, I'd use the  function instead; yes, underneath it uses  like you do, but  is the documented API
p30076
aVOtherwise, your example input is working exactly as it should do
p30077
aVIf I create a XML document from your example with non-ASCII characters in the filepath, I get the following:
p30078
aVAs you can see, the  results from  contains a  character (Unicode codepoint U+00E9, LATIN SMALL LETTER E WITH ACUTE)
p30079
aVWhen printed as a Python literal, Python makes sure it'll be printable in a ASCII context by giving me the Python escape code for that codepoint,
p30080
aVThis is normal, nothing is broken
p30081
as(dp30082
g16
V100297
p30083
stp30084
a((dp30085
g2
(lp30086
VBecause SQLAlchemy uses metaclasses, the code that creates the back reference on the other class won't run until you have created at least one instance of the  class
p30087
aVThe remedy is simple: create a  instance, and discard it again:
p30088
aVor use the  utility function:
p30089
aVto scan your models for such references and initialize them
p30090
aVCreating any one instance calls this method under the hood, actually
p30091
as(dp30092
g16
V100297
p30093
stp30094
a((dp30095
g2
(lp30096
VUse the rewriterule witch to generate Apache rewrite rule configuration
p30097
aVSet up your Apache server to use such a rewrite rule to point to your back-end Plone server
p30098
aVSee the Plone and Zope behind Apache knowledge base article on Plone
p30099
aVorg for the nitty-gritty details
p30100
as(dp30101
g16
V100297
p30102
stp30103
a((dp30104
g2
(lp30105
VYou need to follow the bottle installation instructions
p30106
aVThe latest version is published to PyPI, you have an old version of the code there still, one that is not compatible with Python 3
p30107
as(dp30108
g16
V100297
p30109
stp30110
a((dp30111
g2
(lp30112
VNo, you cannot
p30113
aVPython looks up undefined names in the same module a function is defined in
p30114
aVYou'll have to pass in a function reference instead:
p30115
aVthen in main:
p30116
as(dp30117
g16
V100297
p30118
stp30119
a((dp30120
g2
(lp30121
VThe package changelog has non-ascii characters in the file, breaking the package installation
p30122
aVI've filed a bug report about this
p30123
aVYou'll have to take that up with the developers, or switch to Python 2 or a different template engine instead
p30124
as(dp30125
g16
V100297
p30126
stp30127
a((dp30128
g2
(lp30129
VYou do not need to test for those characters at all
p30130
aVIn the code before it you make sure that  is never going to be either  or , if you just assign a different letter to  there:
p30131
aVIf you still need to make such a test, use the  operator:
p30132
aVreturns  if the left-hand operand is not present in the sequence on the right
p30133
aVI used a string with two characters in my example, which counts as a sequence:
p30134
as(dp30135
g16
V100297
p30136
stp30137
a((dp30138
g2
(lp30139
VDo not use BeautifulSoup to try and such a large parse XML file
p30140
aVUse the ElementTree API instead
p30141
aVSpecifically, use the  function to parse your file as a stream, handle information as you are notified of elements, then delete the elements again:
p30142
aVBy using a event-driven approach, you never need to hold the whole XML document in memory, you only extract what you need and discard the rest
p30143
aVSee the  tutorial and documentation
p30144
aVAlternatively, you can also use the lxml library; it offers the same API in a faster and more featurefull package
p30145
as(dp30146
g16
V100297
p30147
stp30148
a((dp30149
g2
(lp30150
VYou can set that information on the response directly, as documented in the Vary Attributes of Rendered Responses section of the Pyramid manual:
p30151
as(dp30152
g16
V100297
p30153
stp30154
a((dp30155
g2
(lp30156
VYou are registering the meta class, not the plugin itself;
p30157
aVI think you meant to store the plugin itself:
p30158
aVThe  attribute is the  class instead;  objects are classes, not instances
p30159
as(dp30160
g16
V100297
p30161
stp30162
a((dp30163
g2
(lp30164
VThere are two approaches, one only slightly inaccurate, one inaccurate in a different way:
p30165
aVAdd a  of 365
p30166
aV25 / 2 days (average year length divided by two):
p30167
aVThis method will give you a datetime stamp 6 months into the future, where we define 6 monhs as exactly half a year (on average)
p30168
aVUse the external  library, it has a excellent  class that will add 6 months based on calendar calculations to your current date:
p30169
aVThis method will give you a datetime stamp 6 months into the future, where the month component of the date has been forwarded by 6, and it'll take into account month boundaries, making sure not to cross them
p30170
aVAugust 30th plus 6 months becomes February 28th or 29th (leap years permitting), for example
p30171
aVA demonstration could be helpful
p30172
aVIn my timezone, at the time of posting, this translates to:
p30173
aVSo there is a 1 day and 15 hour difference between the two methods
p30174
aVThe same methods work fine with  objects too:
p30175
aVThe half-year timedelta becomes a teensy less accurate when applied to dates only (the 5/8th day component of the delta is ignored now)
p30176
as(dp30177
g16
V100297
p30178
stp30179
a((dp30180
g2
(lp30181
VAs it turns out, the  directory in the  package should be ignored
p30182
aVIt is broken code as far as the package is concerned
p30183
aVSee these issues for examples of other people discovering this:
p30184
aVhttps://github
p30185
aVcom/simplegeo/python-oauth2/issues/33
p30186
aVhttps://github
p30187
aVcom/simplegeo/python-oauth2/issues/12
p30188
aVhttps://github
p30189
aVcom/simplegeo/python-oauth2/pull/64
p30190
aVThe last one is a pull request that includes new examples to use instead
p30191
as(dp30192
g16
V100297
p30193
stp30194
a((dp30195
g2
(lp30196
VYou'll need to manually register these
p30197
aVYou can, however, use the PyPI web interface to do this
p30198
aVThe central PyPI server has a  link in the left-hand menu bar, leading to , presumably your local installation has the same
p30199
aVYour s are either directories, or zip files
p30200
aVIf it is not a directory, you need to unzip the file to look inside (create a copy that you rename to have a  extension if that'll make it easier for your tools to recognize it as a zip file)
p30201
aVYou'll find a  subdirectory inside the egg, and inside of that you'll find a  file
p30202
aVYou can upload this file to the package submission form to replace the  command
p30203
aVOnce registered, the web UI lets you navigate to the package, from there to the  section of a specific package and upload the egg file
p30204
as(dp30205
g16
V100297
p30206
stp30207
a((dp30208
g2
(lp30209
VTo do this on one line without multiple calls to split you need to reverse and slice the  result, and nest your string joins:
p30210
aVSo each entry in the list is:
p30211
aVSplit on whitespace
p30212
aVSliced to only give the name and age entries
p30213
aVReversed so age comes before name using  to reverse in-place
p30214
aVJoined with  to give the  pairs
p30215
aVWe use a list comprehension () because that's faster with
p30216
aVInternally,  calculates the final string length before joining and will cast a generator to a list anyway
p30217
aVThe comprehension then wins on speed
p30218
aVThen the whole list is joined with  to give a nice comma-separated list
p30219
aVBecause we only split once this will run
p30220
aVThis gives:
p30221
as(dp30222
g16
V100297
p30223
stp30224
a((dp30225
g2
(lp30226
VPrint the matched group instead, using the  method:
p30227
as(dp30228
g16
V100297
p30229
stp30230
a((dp30231
g2
(lp30232
VPython dictionaries do not maintain an order
p30233
aVYou cannot add anything 'after' another key
p30234
aVJust add the keys you are missing:
p30235
aVwhich is a compact way of saying:
p30236
aVHowever, it looks more like you need a list instead:
p30237
aVwhere  returns  just like your
p30238
aVThe  at the start makes it easier to treat this whit 1-based indexing instead of 0-based, you could adjust your code for that otherwise
p30239
as(dp30240
g16
V100297
p30241
stp30242
a((dp30243
g2
(lp30244
VThe library uses the Python  module to emit a warning when you 'clobber' an existing file
p30245
aVYou can use that same module to suppress the warning:
p30246
aVUsing the  context manager suppresses all warnings that  might raise
p30247
aVYou can also configure filters for specific messages to be ignored:
p30248
aVwould ignore messages that start with  raised by modules that start with  for example
p30249
as(dp30250
g16
V100297
p30251
stp30252
a((dp30253
g2
(lp30254
VTo read the information you'll need to have the original classes available for import; the pickles can only be loaded into the original class structures
p30255
aVI am not sure that will work all that well; there are a lot of assumptions and dependencies that may clash with the Pyramid framework, or cannot be satisfied without the Zope framework being available
p30256
aVAn alternative would be to create new classes that you make available through the original import locations that let you at least just read the contained data, but that could amount to a major effort
p30257
aVIf you need read-only access you may want to look into a different approach though; use some means to export the data to, say, a SQL server
p30258
aVThat will be easier to handle in the long run
p30259
as(dp30260
g16
V100297
p30261
stp30262
a((dp30263
g2
(lp30264
VYou need to use a function instead of a replace pattern instead:
p30265
aVThen run:
p30266
aVand it'll print the original text and it's replacement
p30267
aVThis then gives:
p30268
aVInstead of printing you could also store that information elsewhere, of course
p30269
aVThe  function just returns a new function, , which is what  will use whenever it finds a match
p30270
aVInstead of directly replacing the matched text, it asks the function what to use as a replacement text
p30271
aVThe reason we use  here as a nested function, is so we can store the fixed replacement text somewhere and re-use the same replacement function over and over again without having to hardcode the replacement text
p30272
as(dp30273
g16
V100297
p30274
stp30275
a((dp30276
g2
(lp30277
Vwhich would accomodate arbitrary sizes for array_2
p30278
aVHere  combines elements from both lists into pairs, and the  utility will re-use the second list over and over again to provide something to pair with
p30279
aVIf you don't need a list as output, only need to iterate over the result, you could use  and  too:
p30280
aVFor large input lists, this saves you having to store the intermediary results in yet another list
p30281
as(dp30282
g16
V100297
p30283
stp30284
a((dp30285
g2
(lp30286
VYou could use :
p30287
aVor you could use a  (an anonymous, in-line function):
p30288
aVor you could define an explicit new function:
p30289
aVIf you are after sheer speed, the  approach wins that hands-down; it is implemented in C code and avoids an extra Python stack push:
p30290
as(dp30291
g16
V100297
p30292
stp30293
a((dp30294
g2
(lp30295
Vis how I'd do it in Python 2
p30296
aV6 or below (see further on how to do this in later versions)
p30297
aVNext to another mapping,  can also take an iterable of  tuples, which we generate based on the set intersection of the two dictionaries (so all keys they have in common)
p30298
aVDemo:
p30299
aVIn python 2
p30300
aV7 you can use the new Dict views to achieve the same without casting to sets:
p30301
aVIn Python 3, dict views are the default, so you can instead spell this as:
p30302
as(dp30303
g16
V100297
p30304
stp30305
a((dp30306
g2
(lp30307
VIf the file is otherwise stable, use  to remember your position in the file, then next time use  to return to that same position in the file
p30308
aVThis only works if you do not use the fileobject as an iterator (no  or ) as that uses a read-ahead buffer that will obscure the exact position
p30309
aVInstead, use:
p30310
aVto still use  in an iteration context
p30311
as(dp30312
g16
V100297
p30313
stp30314
a((dp30315
g2
(lp30316
VThe wrapped function will be available as a function closure cell
p30317
aVWhich cell exactly depends on how many closure variables there are
p30318
aVFor a simple wrapper where the only closure variable is the function-to-wrap, it'll be the first one:
p30319
aVbut you may have to inspect all  values
p30320
aVDemo using the  example decorator:
p30321
aVLooking at the source code for  you don't have to worry about this though; the wrapped function will be stored in the first closure slot, guaranteed
p30322
aVIf this was Python 3 instead, the wrapped function can be accessed with the  attribute instead:
p30323
aVAnd if you had access to the decorator code itself, you can easily add that same reference in Python 2 code too:
p30324
aVmaking introspection just that little bit easier
p30325
as(dp30326
g16
V100297
p30327
stp30328
a((dp30329
g2
(lp30330
VYou are running the wrong command; you are using  instead of  directly, and your single quotes contained in the command are not balanced (you have 3 of them)
p30331
aVIt'll be easier to use the  module instead:
p30332
aVBecause  takes a list of process arguments, you don't have to worry (much) about quoting
p30333
as(dp30334
g16
V100297
p30335
stp30336
a((dp30337
g2
(lp30338
VFor Dexterity UUID values, the  package is used
p30339
aVsimply stores the value in a attribute
p30340
aVThe following suffices to set a predetermined UUID on an existing Dexterity object :
p30341
as(dp30342
g16
V100297
p30343
stp30344
a((dp30345
g2
(lp30346
VThe default  module does not handle timezones very well; beyond your current machine timezone and UTC, they are basically not supported
p30347
aVYou'll have to use an external library for that or handle the timezone offset manually
p30348
aVExternal library options:
p30349
aVUse  can handle just about any date and or time format you care to throw at it:
p30350
aVThe  library handles only ISO 8601 formats, which include timezone offsets of the same form:
p30351
aVDemonstration of each approach:
p30352
as(dp30353
g16
V100297
p30354
stp30355
a((dp30356
g2
(lp30357
VAnything that inherits from  is seen as a set of tests
p30358
aVYou could instead have your base class not inherit from , moving that base class to your concrete test classes instead:
p30359
as(dp30360
g16
V100297
p30361
stp30362
a((dp30363
g2
(lp30364
VNormally Python detects the output encoding from the terminal settings; you can see what Python detected by running:
p30365
aVYou really want to configure your terminal to specify the correct encoding if that doesn't work for you; set the  environment variable on POSIX systems for example
p30366
aVYou can also force Python to use an encoding by setting the  environment variable:
p30367
as(dp30368
g16
V100297
p30369
stp30370
a((dp30371
g2
(lp30372
VThe function you are looking for is called
p30373
aVwill group an iterable by a key you give it, provided the input is already sorted into such groups
p30374
aVwhere  is a function that returns the level of any point returned by
p30375
aVWhat  does is give you the current return value of the  function, and a new iterable that is guaranteed to return all elements for which the  function return value does not change
p30376
as(dp30377
g16
V100297
p30378
stp30379
a((dp30380
g2
(lp30381
VSimply move the increment down one line and start counting at 1:
p30382
aVIn your code  is incremented after testing it against  but before printing the square
p30383
aVSo even if  is smaller than ,  does not have to be
p30384
aVBy moving the increment down a line, you are properly printing , the value you just tested against
p30385
as(dp30386
g16
V100297
p30387
stp30388
a((dp30389
g2
(lp30390
VYou want to encode the string with the  codec:
p30391
aVor you can use the  function, which will turn a string into it's python literal representation including the quotes:
p30392
aVDemonstration:
p30393
aVIn Python 3, you'd be looking for the  codec instead:
p30394
aVwhich will print a bytes value
p30395
aVTo turn that back into a unicode value, just decode from ASCII:
p30396
as(dp30397
g16
V100297
p30398
stp30399
a((dp30400
g2
(lp30401
VYou forgot an  assignment statement and quotes:
p30402
aVIt's best practice to open a file as a context manager (the  statement) so that it is closed automatically:
p30403
aVis a file object, so you can use methods like , , etc
p30404
aVto read from it
p30405
aVOr you can loop over the object (iterate) to get single lines each time:
p30406
aVI'd use a absolute path to the file instead of a relative path to avoid surprises:
p30407
aVor you can use the  library to construct an absolute path:
p30408
aVopens a file named  in the current user home directory, for example
p30409
as(dp30410
g16
V100297
p30411
stp30412
a((dp30413
g2
(lp30414
VOn python 3,  expects an object that implements the buffer protocol, such as a  value, not a unicode :
p30415
aVIf you are reading this data from a file, open the file in binary mode instead of text mode to get bytes
p30416
as(dp30417
g16
V100297
p30418
stp30419
a((dp30420
g2
(lp30421
VUse a  expression adding the  part:
p30422
aVNote that you probably want to use the  (for objects) or the  (for catalog results) methods instead to generate full absolute URLs for your items:
p30423
as(dp30424
g16
V100297
p30425
stp30426
a((dp30427
g2
(lp30428
VTo create one byte of a given value, you can use the  function:
p30429
aVor you could use a  with the right number of integers:
p30430
aVor use an  with the same:
p30431
aVor use the  function to pack your integers into bytes:
p30432
aVThere may be more ways
p30433
aV:-)
p30434
as(dp30435
g16
V100297
p30436
stp30437
a((dp30438
g2
(lp30439
VYou cannot with the string alone go back to the same object, because Python does not give you a method to look up objects by memory address
p30440
aVYou can go back to another instance of , provided it's constructor doesn't take any arguments, and look up the method again, but it will not have the same memory address
p30441
aVYou'd have to parse the string for it's components (module, classname, and method name), then use  on the various components, instantiating the class as part of the process
p30442
aVI doubt this is what you wanted though
p30443
as(dp30444
g16
V100297
p30445
stp30446
a((dp30447
g2
(lp30448
VYou really want to run this with a virtualenv setup; on a package-based OS (such as Debian, Ubuntu, RedHat, etc) you easily run into conflicts between system-installed versions of distribute, easy_install and other 3rd-party packages, and what a buildout requires (see http://workaround
p30449
aVorg/easy-install-debian for an explanation as to why)
p30450
as(dp30451
g16
V100297
p30452
stp30453
a((dp30454
g2
(lp30455
VIf you have a fork of the package in your github account, then using  is an excellent way to make local changes
p30456
aVJust use normal git tools
p30457
aVThe repository is indeed located in the  directory, just cd to it and use a normal git workflow
p30458
aVThen use GitHub to issue a pull request to the original package for your changes
p30459
aVAll  does is make it easier to switch buildout to use the development egg stored in  and to make the workflow of working with 1 or more repositories for eggs-under-development
p30460
aVIt doesn't require you to do anything special with a version-control managed package
p30461
as(dp30462
g16
V100297
p30463
stp30464
a((dp30465
g2
(lp30466
VI think you are looking for the  function instead, or even
p30467
aVBut if you need to match multiple extensions, it's much easier to use :
p30468
aVUsing  you can then use any string or tuple of extensions:
p30469
aVthen use:
p30470
aVI'm not sure why you are using a dict comprehension here; each iteration of the loop,  will be constant
p30471
aVYou may as well do:
p30472
aVor use
p30473
aVIf you wanted to create a dictionary of all files in a nested directory structure, you'll need to move the dict comprehension out and integrate the  call in the dict comprehension instead:
p30474
aVI removed all the  lines; the default is  anyway (note: python booleans are  and , not strings
p30475
aVIt happened to work because  as a string is 'truthy', it's considered True in a boolean context because it is non-empty)
p30476
as(dp30477
g16
V100297
p30478
stp30479
a((dp30480
g2
(lp30481
VYou are mixing tabs and spaces
p30482
aVFind the exact location with:
p30483
aVand replace all tabs with spaces
p30484
aVYou really want to configure your text editor to only insert spaces for tabs as well
p30485
as(dp30486
g16
V100297
p30487
stp30488
a((dp30489
g2
(lp30490
VYou are looking for  instead:
p30491
aVQuoting the documentation:
p30492
aVMake the  special character match any character at all, including a newline; without this flag,  will match anything except a newline
p30493
aValters where  and  match, not what the  dot pattern matches
p30494
as(dp30495
g16
V100297
p30496
stp30497
a((dp30498
g2
(lp30499
VSplit on , then each group on :
p30500
aVThis outputs:
p30501
aVThat's one extra  entry extra at the end there, compared to your example, but I assume that was an oversight
p30502
aVIt's easy enough to remove that again
p30503
as(dp30504
g16
V100297
p30505
stp30506
a((dp30507
g2
(lp30508
VPresumably it's going to be similar to how you post a photo, in which case the library wants a file(like) object
p30509
aVA  response can act as a file-like object just fine:
p30510
aVwhere  gives you a file-like object that, when read, yields the video data read from
p30511
as(dp30512
g16
V100297
p30513
stp30514
a((dp30515
g2
(lp30516
VYour expression is working just fine; Python is just showing you a string literal instead, where you'd have to escape quotes to be able to re-use it as a python string
p30517
aVIf you print the value, no such escaping takes place:
p30518
aVYou can use  to make ,  and  qualifiers non-greedy; matching the minimum instead of the maximum
p30519
aVYou can also match anything that is not a quote instead:
p30520
aVwhich constrains that part of the regular expression much better;  matches any character that is not a double quote
p30521
aVWhen specifying a regular expression pattern, it is generally a good idea to use a python raw string literal () instead, saves a lot of headaches as to what needs escaping and what does not
p30522
aVUsing a raw string literal, your substitution pattern can be simplified to:
p30523
aVfor a final line of:
p30524
as(dp30525
g16
V100297
p30526
stp30527
a((dp30528
g2
(lp30529
VPython can only give Zope the timezone as a three-letter abbreviation
p30530
aVFor Asia/Jerusalem that is
p30531
aVUnfortunately, that same abbreviation is also used for India Standard Time, which is exactly 3 and a half hours ahead of Asia/Jerusalem
p30532
aVThe solution is to add a  environment variable to your Zope buildout configuration, that disambiguates the timezone:
p30533
aVHere  is the Jerusalem IST versus other IST meanings, where current time is -2 UTC, and summertime moves to -3 UTC, on the last Friday in March at 2 o'clock, and moves to wintertime again on the 3rd Sunday in September, again at 2 o'clock
p30534
as(dp30535
g16
V100297
p30536
stp30537
a((dp30538
g2
(lp30539
VReference objects are documented in the Dexterity developer manual
p30540
aVYou are looking for the  attribute:
p30541
aVwhich would insert the URL of the linked object, or you could show the  instead:
p30542
as(dp30543
g16
V100297
p30544
stp30545
a((dp30546
g2
(lp30547
VBoth  and  are referred to by the global namespace that forms your module, keeping both in memory
p30548
aVIf you were to run ,  would still refer to the class (through it's  reference) keeping it alive
p30549
aVThe class refers to the two attributes that are part of it's definition, so they are kept alive as well
p30550
aVThis is all independent of the  function
p30551
aVCPython keeps objects in memory based on reference counts; if anything in Python starts refering to an object somethere, that object's reference count is increased by 1, and decreased again when the reference is removed
p30552
aVWhen the count drops to 0, the object is removed from memory, and a garbage collection process breaks up circular references as needed to facilitate this process
p30553
aVNote that because  is a global, the function code does not directly reference anything; globals are looked up at runtime
p30554
aVIf you were to delete  too, all references would be cleared up
p30555
aVBecause  in  is looked up in the global namespace, calling  would then result in a
p30556
aVIf you did have a closure (reference to a variable in a parent function scope), the same rules would apply, except that the closure reference counts as another reference to the instance, thus indirectly to the class and the contained attributes
p30557
aVSo, considering the following example, where we do create a closure:
p30558
aVIn the above example the  class remains in memory, because the  closure still refers to an instance of that class:
p30559
as(dp30560
g16
V100297
p30561
stp30562
a((dp30563
g2
(lp30564
VThere isn't any such functionality in Python
p30565
aVYou could abuse the  function to get access to the current code object though:
p30566
aVbut that will only print the name of the function as it was defined originally
p30567
aVIf you assign the  function to another identifier, the above code will continue to print :
p30568
as(dp30569
g16
V100297
p30570
stp30571
a((dp30572
g2
(lp30573
VAttach a reference to the function with a keyword parameter:
p30574
aVor bind it to a class attribute:
p30575
aVBy creating a local (enough) reference, Python will not look up  as a global, but with a local reference, which are stored with the instance or with the function itself, respectively
p30576
aVGlobals are looked up at runtime (which is why the  function in your other question fails if  has already been cleaned up), while a function local is cleared up together with the function object, or in case of a instance attribute, with the instance
p30577
as(dp30578
g16
V100297
p30579
stp30580
a((dp30581
g2
(lp30582
VSure, use a crontab schedule for your tasks
p30583
as(dp30584
g16
V100297
p30585
stp30586
a((dp30587
g2
(lp30588
VYou need to lose the , it'll move the loop to the next iteration instead
p30589
aVI think you were looking for  (when you find )
p30590
aVJust print , but do make  a function for Python 3
p30591
as(dp30592
g16
V100297
p30593
stp30594
a((dp30595
g2
(lp30596
VNo, it doesn't matter what you use for those names
p30597
aVYou can pick any name you wish for these identifiers, as long as they are valid python identifiers
p30598
aVName them , , , whatever
p30599
aVIt is a good idea to pick a name that is a little more descriptive of course, so  or  are great names in the context that they are used
p30600
aVIn any case, all of te following are equivalent:
p30601
as(dp30602
g16
V100297
p30603
stp30604
a((dp30605
g2
(lp30606
V is a python  type; it's just the same as a normal , python treats it the same and the distinction doesn't matter
p30607
aVTo get a specific item that matches your key, I would use the  function with a generator expression:
p30608
aVThis will find the first dictionary that has the key  matching your entryid, or set  to  if there was no such item
p30609
as(dp30610
g16
V100297
p30611
stp30612
a((dp30613
g2
(lp30614
VYou need to separate the  and the  stripping; that way you won't ever strip away the natural
p30615
aVAlternatively, use the  function, but that really comes down to the same thing:
p30616
aVSome tests:
p30617
as(dp30618
g16
V100297
p30619
stp30620
a((dp30621
g2
(lp30622
VSplit the string on the last  to get a module and function name, then use  and  to get the object:
p30623
aVSo if , then the above code splits that to  and , then calls ,  and  on the result, giving you a reference to the function, that then can be called
p30624
as(dp30625
g16
V100297
p30626
stp30627
a((dp30628
g2
(lp30629
VThe first takes a list of iterables, the second one takes the sequence from another iterable:
p30630
aVbut  can be any iterator that yields the iterables
p30631
aVUsing the second form is usually a case of convenience, but because it loops over the input iterables lazily, it is also the only way you can chain a infinite number of finite iterators:
p30632
aVThe above example will give you a iterable that yields a cyclic pattern of numbers that will never stop, but will never consume more memory than what a single  call requires
p30633
as(dp30634
g16
V100297
p30635
stp30636
a((dp30637
g2
(lp30638
VDon't use the XML parser to parse HTML
p30639
aVHTML is case-insensitive, but XML is not
p30640
aVYou can parse HTML with  just fine, just use the HTML modus:
p30641
aVif you insist on using the XML parser, you'll have to match the case of the input element:
p30642
aVIf you instead want to handle XML and do that case insensitive, stick to the ElementTree API provided by , and do not use BeautifulSoup at all
p30643
aVYou'd then have to use a regular expression XPath search:
p30644
aVwhich would find all elements with the name , case insensitively
p30645
as(dp30646
g16
V100297
p30647
stp30648
a((dp30649
g2
(lp30650
VThis has nothing to do with your SQLAlchemy setup; this is your template engine (Chameleon) compiling into Python code for speed and failing because there is a NUL character in your template
p30651
aVCheck your templates with a text editor and make sure there are no non-printable bytes in the files
p30652
as(dp30653
g16
V100297
p30654
stp30655
a((dp30656
g2
(lp30657
VThat's what the  flag is for in your schema
p30658
aVUse it to flag any field that does not need to be translated and it'll be copied over for you
p30659
aVBy setting the flag, you mark a field as only editable in the canonical copy, all translations are automatically updated whenever you modify such a field
p30660
as(dp30661
g16
V100297
p30662
stp30663
a((dp30664
g2
(lp30665
VYou can use  to remove newlines from the right-hand side of a string:
p30666
aVor you can tell it to remove all whitespace (including spaces, tabs and carriage returns):
p30667
aVIt is a more specific version of the  method which removes whitespace or specific characters from both sides of the string
p30668
aVFor your specific case, you could stick with a simple  but for the general case where you want to remove only the newline, I'd stick with `
p30669
aVrstrip('\u005cn')
p30670
aVI'd use a different method to write your strings though:
p30671
aVBy using  you avoid the last comma, and using the  method is easier on the eyes than a lot of string concatenation (not to mention faster)
p30672
as(dp30673
g16
V100297
p30674
stp30675
a((dp30676
g2
(lp30677
VCombine filtering with :
p30678
aVThe  removes all elements whose second element is falsey;  in a boolean context
p30679
aVThat includes  and
p30680
aVfinds the lowest value based on the key you give it; so the list with the lowest float value after filtering
p30681
aVselects the id entry from your list
p30682
aVA quick demo (with a syntactically correct input list):
p30683
as(dp30684
g16
V100297
p30685
stp30686
a((dp30687
g2
(lp30688
VYou cannot add special (hook) methods as class methods to classes, because they are always looked up on the type of the current object; for instances that is on the class, for classes, they are looked up on  instead
p30689
aVSee this previous answer for the motivations as to why that is
p30690
aVThat means you need to implement this on the metaclass instead; a metaclass acts as the class's type:
p30691
aVthen for Python 3:
p30692
aVor Python 2:
p30693
as(dp30694
g16
V100297
p30695
stp30696
a((dp30697
g2
(lp30698
VUse the  method instead:
p30699
aVThe  method returns the value for the requested key, or the default value if the key is missing
p30700
aVOr you can create a new dict with empty strings for each key and use  on it:
p30701
aVcreates a dictionary with all keys you request set to a given default value ( in the above example), then we use  to copy all keys and values from the  dictionary, replacing anything already there
p30702
as(dp30703
g16
V100297
p30704
stp30705
a((dp30706
g2
(lp30707
VYour  installation is incorrect; for some reason the python 2to3 translation has been run on it (which only should happend automatically when installing with Python 3)
p30708
aVThe  library is the Python 3 equivalent of the  library used in Python 2
p30709
aVYour best bet is to remove the mis-installed version (follow the uninstallation instructions) then run the  script instead
p30710
as(dp30711
g16
V100297
p30712
stp30713
a((dp30714
g2
(lp30715
VNot easily
p30716
aVYou could recurse through the  list, testing each and every object if it has the same  but that's not very practical
p30717
aVThe  function is not intended to be dereferenceable; the fact that it is based on the memory address is a CPython implementation detail, that other Python implementations do not follow
p30718
as(dp30719
g16
V100297
p30720
stp30721
a((dp30722
g2
(lp30723
VYou want to concatenate lists with lists, not a string with a list:
p30724
aVor perhaps you wanted to rejoin the elements into a string again:
p30725
as(dp30726
g16
V100297
p30727
stp30728
a((dp30729
g2
(lp30730
VUse  instead:
p30731
aVDemo:
p30732
aVThis method starts splitting from the right-hand-side of the string; by giving it a maximum, you get to split just the right-hand-most occurrences
p30733
as(dp30734
g16
V100297
p30735
stp30736
a((dp30737
g2
(lp30738
VYour browser will stream the video on a separate request, after it loaded the page (and the flash player referenced by the page)
p30739
aVThe video is not part of the page data itself
p30740
aVNeither are the styles, scripts, and images; they are all just references encoded in the HTML page for the browser to interpret
p30741
aVJust requesting the page in and of itself will not start the video being streamed, no
p30742
aVIn other words, all  will load is the basic HTML markup that your browser also loads
p30743
aVUnless you then interpret that HTML markup and start loading the resources referenced in the page, you will not automatically start loading anything else
p30744
as(dp30745
g16
V100297
p30746
stp30747
a((dp30748
g2
(lp30749
VUse exception handling
p30750
aVPython doesn't crash when someone gives you invalid input, it throws an exception instead
p30751
aVYou can catch such exceptions and handle them instead of letting python exit the program
p30752
aVIn this case, since you only want a floating point number you really should not be using ; that will take a lot of different inputs and will throw a lot of different exceptions
p30753
aVUse the  function instead, it will only throw a  if you give it incorrect input
p30754
aVThen catch that and display an error message:
p30755
as(dp30756
g16
V100297
p30757
stp30758
a((dp30759
g2
(lp30760
VYou named your function parameter , not
p30761
aVUse  instead, or rename the parameter to the function to
p30762
as(dp30763
g16
V100297
p30764
stp30765
a((dp30766
g2
(lp30767
VYou are mixing tabs and spaces, don't do that
p30768
aVRun your script with as:
p30769
aVto find where
p30770
aVReplace all tabs with spaces, configure your editor to only use spaces for indentation
p30771
as(dp30772
g16
V100297
p30773
stp30774
a((dp30775
g2
(lp30776
VYou really want to switch to using  here, because then you can use an XPath query:
p30777
aVWith that code you end up with a dictionary of lists; each key is a filename (without the extension), each value is a list of required fields
p30778
aVThe XPath query looks for  elements in the default namespace, that have a  element as sibling with the text  in them
p30779
aVIt then takes the contained text of each of those matching elements, which is a list we can store in the dictionary
p30780
as(dp30781
g16
V100297
p30782
stp30783
a((dp30784
g2
(lp30785
VThe Python variable (called an identifier or name, in Python) is a reference to a value
p30786
aVThe  function says something for that value, not the name
p30787
aVMany values are not mutable; integers, strings, floats all do not change in place
p30788
aVWhen you add  to another integer, you return a new integer that then replaces the reference to the old value
p30789
aVYou can look at Python names as labels, tied to values
p30790
aVIf you imagine values as balloons, you are retying the label a new balloon each time you assign to that name
p30791
aVIf there are no other labels attached to a balloon anymore, it simply drifts away in the wind, never to be seen again
p30792
aVThe  function gives you a unique number for that balloon
p30793
aVSee this previous answer of mine where I talk a little bit more about that idea of values-as-balloons
p30794
aVThis may seem inefficient
p30795
aVFor many often used and small values, Python actually uses a process called interning, where it will cache a stash of these values for re-use
p30796
aVis such a value, as are small integers and the empty tuple ()
p30797
aVYou can use the  function to do the same with strings you expect to use a lot
p30798
aVBut note that values are only cleaned up when their reference count (the number of 'labels') drops to 0
p30799
aVLoads of values are reused all over the place all the time, especially those interned integers and singletons
p30800
as(dp30801
g16
V100297
p30802
stp30803
a((dp30804
g2
(lp30805
VYou need to install  separately for your Python 3 installation
p30806
aVYou need to follow the installation instructions for installing from source, using  or  will be easiest (provided you have the  debian package installed)
p30807
aVYou cannot reuse the system-installed  because that'll only work on Python 2
p30808
as(dp30809
g16
V100297
p30810
stp30811
a((dp30812
g2
(lp30813
VYes, use the  module instead
p30814
aVThe  module has been deprecated in favour of that new and better module
p30815
aVThe  module generates a helptext based on the options you give it
p30816
aVIf you are using a python version before 2
p30817
aV7, you can install the library as a separate dependency from pypi
p30818
as(dp30819
g16
V100297
p30820
stp30821
a((dp30822
g2
(lp30823
VYou could use a callable class:
p30824
aVThe closure state of your function is then transferred to an instance attribute instead
p30825
as(dp30826
g16
V100297
p30827
stp30828
a((dp30829
g2
(lp30830
VIt creates a dictionary with one key, whose value is a nested list:
p30831
aVRemember that in python, lists use 0-based indexing, so the  references in the above example retrieve the first element of the list
p30832
aVOr to approach it from the other side:
p30833
aVis just a literal integer value
p30834
aVis a list definition, so  is a list with one element in it, the integer
p30835
aVis a dictionary definition, connecting a set of keys with corresponding values
p30836
aVcreates a dictionary with 1 key-value pair, a key of  pointing to a value of
p30837
aVLists and dictionaries can be nested; lists can be dictionary values, and you can also put lists inside other lists
p30838
aVis a list with 1 element, another, empty list
p30839
aVis a list with 1 element, another list, which has 1 element too, the integer value 1
p30840
aVis a dictionary with one key, the integer value 1, which is connected to a list with one element, another list that again has only 1 element, another integer value 1
p30841
as(dp30842
g16
V100297
p30843
stp30844
a((dp30845
g2
(lp30846
V returns the altered string
p30847
aVStore that return value:
p30848
aVYou could chain the replace calls:
p30849
aVStrings are immutable, they cannot be altered in-place
p30850
aVLast but not least: use  to count words instead, it offers many additional features to make working with frequency counts easier:
p30851
aVwhich creates your  structure with one line
p30852
aVNote that  will effectively strip extra whitespace and newlines for you
p30853
aVNote that if you are removing punctuation from the start or end of words, you should really use the  method instead:
p30854
aVwhere the  will remove any and all characters at the start or end that are listed in the argument
p30855
as(dp30856
g16
V100297
p30857
stp30858
a((dp30859
g2
(lp30860
VYou named your variable , and are trying to use it as the built-in function at the same time
p30861
aVRename the  identifier that is meant to be the total sum:
p30862
aVI've simplified your expression a little too; most of the parenthesis and lists were surplus
p30863
as(dp30864
g16
V100297
p30865
stp30866
a((dp30867
g2
(lp30868
VYou have a variable with the same name that is not the class
p30869
aVRename the class to use  instead:
p30870
aVthen call it as:
p30871
as(dp30872
g16
V100297
p30873
stp30874
a((dp30875
g2
(lp30876
VIf you are on Windows, then  is the file creation time
p30877
aVOn other platforms that information is not stored and that function returns the last change time instead
p30878
as(dp30879
g16
V100297
p30880
stp30881
a((dp30882
g2
(lp30883
VIn principle buildout can do anything you can code, as long as you create a recipe to do the thing for you
p30884
aVLuckily, someone already created a recipe to create the plone site for you, called :
p30885
aVThe recipe provides several hooks that let you control site creation, and execute system commands before or after the site is created or extra python code before or after GS profiles are run
p30886
aVIn the above example  runs a  script with the variables  and  set:
p30887
as(dp30888
g16
V100297
p30889
stp30890
a((dp30891
g2
(lp30892
VSure you can, just group the part you want returned:
p30893
aVso provide enough context to only match what you want returned, and use a capturing group
p30894
aVThen use the  method, which will only include the matched capturing groups:
p30895
as(dp30896
g16
V100297
p30897
stp30898
a((dp30899
g2
(lp30900
VA lookahead is an anchor pattern, just like  and  anchor matches to a specific location but are not themselves a match
p30901
aVYou want to match these suffixes, but at the end of a word, so use the word-edge anchor  instead:
p30902
aVthen use  to replace those:
p30903
aVwhich works just fine:
p30904
as(dp30905
g16
V100297
p30906
stp30907
a((dp30908
g2
(lp30909
VThat's your best option without using additional libraries
p30910
aVI certainly have advocated just that technique in the past, more than once in fact
p30911
aVYou could also switch to using SQLAlchemy, which generates SQL for you, but that requires you to climb it's learning curve and rewrite most of your application
p30912
as(dp30913
g16
V100297
p30914
stp30915
a((dp30916
g2
(lp30917
VPython shows you a literal string value, and uses escape codes to prevent your terminal from going haywire
p30918
aVAnything that is not a printable ASCII character is shown as a escape code instead
p30919
aVThe value itself is still fully binary
p30920
aVIn the above example, the null byte is displayed as a  escape code, but it is still only one byte (length 1)
p30921
aVA byte with hex value 65 is displayed as an  because it is a printable ASCII character
p30922
as(dp30923
g16
V100297
p30924
stp30925
a((dp30926
g2
(lp30927
VYou are using the global variable  to store the result of a  call, twice
p30928
aVBut you are also expecting to use it as the built-in  type:
p30929
aVDon't do that
p30930
aVDon't shadow built-ins with your own variable name, and don't use
p30931
aVUse the  function instead
p30932
as(dp30933
g16
V100297
p30934
stp30935
a((dp30936
g2
(lp30937
VYou defined  both as a function and a local variable in the  function:
p30938
aVDon't do that, use meaningful names that don't shadow your function names
p30939
as(dp30940
g16
V100297
p30941
stp30942
a((dp30943
g2
(lp30944
VYou want to capture the output of another command
p30945
aVUse the  module for this
p30946
aVIf your command requires interactive input, you have two options:
p30947
aVUse a  object, and set the  parameter to  and write the input to the stdin pipe available
p30948
aVFor one input parameter, that's often enough
p30949
aVStudy the documentation for the  module for details, but the basic interaction is:
p30950
aVUse the  library to drive a process
p30951
aVThis let's you create more complex interactions with a subprocess by looking for patterns is the output it generates:
p30952
as(dp30953
g16
V100297
p30954
stp30955
a((dp30956
g2
(lp30957
VAll you have to do is call the  method:
p30958
aVBy not calling the method, all you do is store a reference to the method, and Jinja2 then takes the  result of that method to include it in your template output:
p30959
as(dp30960
g16
V100297
p30961
stp30962
a((dp30963
g2
(lp30964
VYou need to start searching for the second character beyond :
p30965
aVbecause otherwise it'll find the same character at the same location again:
p30966
aVFor your regular expressions, the  character is interpreted as an anchor, not the literal character
p30967
aVEscape it to match the literal  (and look for things that are not  instead of not :
p30968
aVwhich gives:
p30969
aVThe regular expression  otherwise doesn't really match anything between the parenthesis even if you did escape the  characters
p30970
as(dp30971
g16
V100297
p30972
stp30973
a((dp30974
g2
(lp30975
VUse the  module to do that:
p30976
aVFor arbitrary floats as input, you really want to use the  method to limit your fractions to sane approximations of the floating point number:
p30977
as(dp30978
g16
V100297
p30979
stp30980
a((dp30981
g2
(lp30982
VYou need to use the  and  functions instead of poking into the  structure:
p30983
as(dp30984
g16
V100297
p30985
stp30986
a((dp30987
g2
(lp30988
VYou need to break the text into separate lines, then render this using a loop and  tags:
p30989
aVThis uses the  method to split the text on newlines, then the loop adds a  break tag after each line of the text
p30990
aVYou are quite right not doing this in the view, then forcing Chameleon to accept your inserted  tags by setting the  flag
p30991
aVLuckily there is absolutely no need for that anyway
p30992
as(dp30993
g16
V100297
p30994
stp30995
a((dp30996
g2
(lp30997
VYou don't need to pass in ; python provides that automatically to methods
p30998
aVYou really also don't want to use the  function if you can help it
p30999
aVJust do:
p31000
as(dp31001
g16
V100297
p31002
stp31003
a((dp31004
g2
(lp31005
VNope, there is no better solution
p31006
aVFunction argument definitions can be expressions, but they are evaluated only once (which sometimes surprises people, see "Least Astonishment" in Python: The Mutable Default Argument)
p31007
as(dp31008
g16
V100297
p31009
stp31010
a((dp31011
g2
(lp31012
VUse actual sets first:
p31013
aVor, in python 2
p31014
aV7 or 3:
p31015
aVthen use the  method:
p31016
aVor do an in-place subtraction:
p31017
aVThis mutates  in place
p31018
aVIf you only need to see the differences, just use subtraction:
p31019
as(dp31020
g16
V100297
p31021
stp31022
a((dp31023
g2
(lp31024
VNo, there isn't
p31025
aVDo the processing in your view instead, or use python code in your TALES expressions
p31026
as(dp31027
g16
V100297
p31028
stp31029
a((dp31030
g2
(lp31031
VI am not entirely sure what you are looking for here
p31032
aVTo get an index into a sequence you are looping over together with the actual value, use the  function:
p31033
aVYou really do not want to dynamically set global variables
p31034
aVUse a dictionary instead:
p31035
aVYou can create global variables dynamically, by accessing the  mapping, but doing this is generally a bad idea
p31036
aVYou'd do it like this if you are stubborn:
p31037
as(dp31038
g16
V100297
p31039
stp31040
a((dp31041
g2
(lp31042
VYou simply slice the the  list:
p31043
aVIn the above example I also add the title and link as a two-value tuple to the  list
p31044
aVFor your example feed that results in:
p31045
aVYou can simplify your  find too:
p31046
aVYou really want to look into the feedparser library instead though; it deals with multiple feed formats as well as handling things like caching and sanitizing correctly
p31047
as(dp31048
g16
V100297
p31049
stp31050
a((dp31051
g2
(lp31052
VA list comprehension combined with the  function will do the trick:
p31053
as(dp31054
g16
V100297
p31055
stp31056
a((dp31057
g2
(lp31058
VYou are dealing with encoded strings, not with unicode text
p31059
aVThe  method of byte strings can only deal with ASCII values
p31060
aVDecode your string to Unicode or use a  literal (), then lowercase:
p31061
as(dp31062
g16
V100297
p31063
stp31064
a((dp31065
g2
(lp31066
VSearching for  like that must match the whole text in a tag, and that's  in your case
p31067
aVMake it a regular expression instead:
p31068
aVThis will match all elements  elements that contain that name
p31069
as(dp31070
g16
V100297
p31071
stp31072
a((dp31073
g2
(lp31074
VYou need to create a new list for each row:
p31075
as(dp31076
g16
V100297
p31077
stp31078
a((dp31079
g2
(lp31080
VSimple:  is a statement, not an expression
p31081
aVStatements have to appear on their own line
p31082
aVis a statement too, it expects it's expression to evaluate to an exception to raise, but neither  nor the  statement fulfills that
p31083
aVAs it stands, the line is complete nonsense
p31084
aVIt is not valid Python
p31085
aVWhat happens instead, is that the Python parser will flag this code as invalid and raise a  exception for the whole file
p31086
aVNo code contained in the file will actually be run:
p31087
as(dp31088
g16
V100297
p31089
stp31090
a((dp31091
g2
(lp31092
VYou cannot do what you want with just
p31093
aVFrom the BeautifulSoup documentation on :
p31094
aVYou can\u2019t edit a string in place, but you can replace one string with another, using
p31095
aVThat's exactly what you need to do; take each match, then call  on the contained text and replace the original with that:
p31096
aVIf you want to use these comments further, you'll need to do a new find:
p31097
aVor, if you all you need is the resulting unicode text (so not connected  objects), just collect the  objects:
p31098
as(dp31099
g16
V100297
p31100
stp31101
a((dp31102
g2
(lp31103
VThe  syntax has a mirror calling equivalent:
p31104
aVThe elements of  will be used as arguments to
p31105
aVThat depends on what kind of API you want to present
p31106
aVIf you want to accept 0 or more arguments because that's how you expect your class to be called most conveniently, then you use that form
p31107
aVIn the Python API, the  and the  functions are well-known examples of callables that use an arbitrary-length parameter list
p31108
as(dp31109
g16
V100297
p31110
stp31111
a((dp31112
g2
(lp31113
VYour print is failing
p31114
aVYour Windows console doesn't support printing UTF-8, you need to change the codepage:
p31115
aVThis is a Windows command, not a python command
p31116
aVYou may need to switch fonts too, Lucida Sans Console is a Unicode font that can handle a lot more glyphs
p31117
as(dp31118
g16
V100297
p31119
stp31120
a((dp31121
g2
(lp31122
VJust call the  on the input string itself
p31123
aVIt'll return a location for a match or  if no match was found
p31124
aVIt also takes a start parameter, so you can look for the next match:
p31125
as(dp31126
g16
V100297
p31127
stp31128
a((dp31129
g2
(lp31130
VAdding a ZEO server does not magically make your website balance between the clients
p31131
aVYour ZEO setup is working just fine, as are your instances, but you need to configure another component: a load balancer
p31132
aVWhatever you have in front of your Plone site needs to be told to use the other client too, this does not happen automatically, and it is not the responsibility of the ZEO server
p31133
aVWhat you use as a load balancer is up to you
p31134
aVYou have a multitude of options:
p31135
aVIf you currently use Apache to rewrite URLs to your Plone site, you could configure  to load balance to do random load balancing
p31136
aVOr you could use  to implement a more sophisticated balancing setup and add health checking (stop using a backend if it is restarting)
p31137
aVVarnish can do both caching and load balancing as well
p31138
aVYou could install a dedicated load balancer
p31139
aVHAProxy would be an excellent choice, and can be fine-tuned to match almost any scenario
p31140
aVWe use this in large-scale deployments, balancing load across 30 Plone backends
p31141
aVYou'll need to pick one and configure it
p31142
aVIf you have trouble with specifics, you could see if http://ServerFault
p31143
aVstackexchange
p31144
aVcom can help out
p31145
as(dp31146
g16
V100297
p31147
stp31148
a((dp31149
g2
(lp31150
VThe  command is a little bit misnamed
p31151
aVIt sends signals to processes, and the default signal is , process termination
p31152
aVUsing  for sending  signals is perfectly correct
p31153
aVWhen you have questions about a UNIX command, your best bet is to type in  on the command line
p31154
aVwould have told you all this and more
p31155
aVTry running  for a list of supported signals
p31156
aVYou can specify signals by number, by symbolic name and by symbolic name prepended by
p31157
aVYou can use ,  or , all would send the same signal
p31158
aVSee the  manpage for more details
p31159
as(dp31160
g16
V100297
p31161
stp31162
a((dp31163
g2
(lp31164
VIf you store  in a module global, it will only be executed once, at server startup
p31165
aVThis is not a server problem, but a problem with your code
p31166
aVIf you need a result to show todays date, you need to call the  callable when you need todays date, not at startup
p31167
aVEven if you were to call  in a function, if that function itself is only called at module load time, it still is executed only once
p31168
aVThe URL patterns are generated only once
p31169
aVThe  keyword argument is not executed each time that URL is accessed, but only at module load time
p31170
aVYou'll need to move creating tha header to the view itself
p31171
as(dp31172
g16
V100297
p31173
stp31174
a((dp31175
g2
(lp31176
VYou'd translate that to a regular expression, then use that to match against email addresses
p31177
aVThat's not that hard to do:
p31178
aVThe function returns ready-compiled regular expressions:
p31179
aVDo note that because you match on  as any character, the following matches too:
p31180
aVbecause the  matches the  in
p31181
as(dp31182
g16
V100297
p31183
stp31184
a((dp31185
g2
(lp31186
VUse the latter
p31187
aVThe logging module will only interpolate the value when the message is processed
p31188
aVThis mean you save CPU cycles for debug messages, for example, if the log level excludes them
p31189
aVThis is documented in the  HOWTO, "Optimization" chapter:
p31190
aVFormatting of message arguments is deferred until it cannot be avoided
p31191
aVYou may want to follow the rest of the advice given in that chapter to avoid expensive calculations just for logging, as well
p31192
aVInternally, the  module uses the first form, so any value that cannot be converted to a string will fail
p31193
as(dp31194
g16
V100297
p31195
stp31196
a((dp31197
g2
(lp31198
VThe  class uses a unidirectional  for its communications
p31199
aVYou can get either end of that pipe through the connection's (private)  and  attributes, and (on POSIX at least), these have  methods:
p31200
aVLet me emphasise the 'private' moniker there; the  and  attributes are implementation details and thus can be changed future versions without breaking the published API
p31201
aVUse at your own risk
p31202
as(dp31203
g16
V100297
p31204
stp31205
a((dp31206
g2
(lp31207
VYou can specify additional places to install dependencies from using the  option:
p31208
aVThe  entry is used to find packages, and for SCM-stored packages the  fragment identifier lets tools know what package and what version will be found at that link
p31209
aVSee the "Dependencies that aren\u2019t in PyPI" chapter of the setuptools project documentation
p31210
as(dp31211
g16
V100297
p31212
stp31213
a((dp31214
g2
(lp31215
VInstead of casting your elements back to string, just grab the attributes through the  mapping of each element:
p31216
as(dp31217
g16
V100297
p31218
stp31219
a((dp31220
g2
(lp31221
VYou can calculate a new absolute path based on a module filename instead:
p31222
aVis the filename of the current module, so for  that would be ;  makes sure it is a absolute path, and  removes the  filename to leave you with an absolute path to the 'current' directory
p31223
as(dp31224
g16
V100297
p31225
stp31226
a((dp31227
g2
(lp31228
VYou need to refer to methods on the instance with the  parameter
p31229
aVIn addition, your  method needs to return the  variable it generates, you cannot refer to method local variables as attributes on methods:
p31230
aVThat is what  is for, as a reference point to find instance attributes and other methods on the same object
p31231
aVYou may want to rename  to something that does not shadow the built-in type
p31232
as(dp31233
g16
V100297
p31234
stp31235
a((dp31236
g2
(lp31237
VSimply test if any of your words are a subset of the vowels set:
p31238
aVworks on any sequence (including strings):
p31239
as(dp31240
g16
V100297
p31241
stp31242
a((dp31243
g2
(lp31244
VUse a  to collect all the types, then test if it is length 1:
p31245
aVThis has to scan all elements
p31246
aVYou could also compare against the first element, at which point you only need to test enough to find one that doesn't match:
p31247
aVFor smaller inputs the  approach is faster, but for larger inputs the second form can beat out the  approach if the likelihood of there being a second type in the input is large enough
p31248
as(dp31249
g16
V100297
p31250
stp31251
a((dp31252
g2
(lp31253
VYou'll need to define a  value, so the socket permissions are set correctly:
p31254
aVThe default is ; remove writing from the group and other permissions
p31255
aVSwitching that to  only removes write for other, leaving it in place for the  group
p31256
as(dp31257
g16
V100297
p31258
stp31259
a((dp31260
g2
(lp31261
VYou probably have empty lines in your input
p31262
aVSkip these:
p31263
aVbut you probably want to use the  module instead:
p31264
as(dp31265
g16
V100297
p31266
stp31267
a((dp31268
g2
(lp31269
VYour input contains  text, not  text
p31270
aVThe  indicates a  literal
p31271
aVThis is probably normal, and depends entirely on where you got your  list from
p31272
aVThings are otherwise working
p31273
aVThe CodeAcademy exercise you link to is actually broken
p31274
aVIt shows you Python  input and but it's output uses
p31275
aVYou need to report that as a bug
p31276
aVYou can work around that bug by mapping everything to a :
p31277
aVor by mapping the output of  to :
p31278
aVwhich works for this case because the input only uses ASCII characters
p31279
aVNormally you'd encode  to  explicitly by specifying an encoding instead, see the Python Unicode HOWTO
p31280
as(dp31281
g16
V100297
p31282
stp31283
a((dp31284
g2
(lp31285
VJust use string formatting or the  function:
p31286
aVsupports the same format specifications as floats do, so you can use exponent, fixed point, general, number or percentage formatting as needed
p31287
aVThis is the official and pythonic method of formatting decimals; the  class implements the  method to handle such formatting efficiently
p31288
as(dp31289
g16
V100297
p31290
stp31291
a((dp31292
g2
(lp31293
VWhen  fails,  is not set at all
p31294
aVThere is no point in rolling back at that point
p31295
aVStart by setting it to , then test for that in the  handler:
p31296
aVI also made the exception handler more specific; blanket  handlers are rarely a good idea
p31297
as(dp31298
g16
V100297
p31299
stp31300
a((dp31301
g2
(lp31302
VYou can subclass , but because it is immutable you need to provide a  constructor hook:
p31303
aVYou do need to call the base  constructor to get your subclass properly created
p31304
aVIn Python 3, you can omit the arguments to  altogether:
p31305
aVOf course, this assumes you wanted to manipulate  before passing in to  or manipulate  some more before returning; otherwise you may as well remove the whole  method and just implement this as
p31306
as(dp31307
g16
V100297
p31308
stp31309
a((dp31310
g2
(lp31311
VThere is a big difference between  in Python 2 and  in Python 3
p31312
aVYou are treating  as a function, but it really is a statement in Python 2
p31313
aVBecause of this difference, you cannot change local variables in function scope
p31314
aVNot even previously declared variables
p31315
aVonly reflects local variables in one direction
p31316
aVThe following never worked in either 2 or 3:
p31317
aVIn Python 2, using the  statement meant the compiler knew to switch off the local scope optimizations (switching from  to  for example, to look up variables in both the local and global scopes)
p31318
aVWith  being a function, that option is no longer available and function scopes are now always optimized
p31319
aVMoreover, in Python 2, the  statement explicitly copies all variables found in  back to the function locals using , but only if no globals and locals parameters were supplied
p31320
as(dp31321
g16
V100297
p31322
stp31323
a((dp31324
g2
(lp31325
VPython is a highly dynamic language, and supports many different levels of introspection
p31326
aVBecause of that, obfuscating Python bytecode is a mountainous task
p31327
aVMoreover, your embedded python interpreter will still need to be able to execute the bytecode you ship with your product
p31328
aVAnd if the interpreter needs to be able to access the bytecode, then everyone else can too
p31329
aVEncryption won't help, because you still need to decrypt the bytecode yourself and then everyone else can read the bytecode from memory
p31330
aVObfuscation only makes default tools harder, not impossible to use
p31331
aVWith that said, here is what you'd have to do to make it really bloody hard to read your application's Python bytecode:
p31332
aVRe-assign all python opcode values a new value
p31333
aVRewire the whole interpreter to use different byte values for different opcodes
p31334
aVRemove all as many introspection features as you can get away with
p31335
aVYour functions need to have closures, and codeobjects need constants still, but to hell with the locals list in the code object, for example
p31336
aVNeuter the  function, slash traceback information
p31337
aVBoth these steps require in-depth knowledge of how the Python interpreter works, and how the Python object model fits together
p31338
aVYou will most certainly introduce bugs that will be hard to solve
p31339
aVIn the end, you have to ask yourself if this is worth it
p31340
aVA determined hacker can still analyze your bytecode, do a some frequency analysis to reconstruct the opcode table, and / or feed your program different opcodes to see what happens, and decipher all the obfuscation
p31341
aVOnce a translation table is created, decompiling your bytecode is a snap, and reconstructing your code is not far away
p31342
aVIf all you want to do is prevent bytecode files from being altered, embed checksums for your  files, and check those on startup
p31343
aVRefuse to load if they don't match
p31344
aVSomeone will patch your binary to remove the checksum check or replace the checksums, but you won't have to put in nearly as much effort to provide at least some token protection from tampering
p31345
as(dp31346
g16
V100297
p31347
stp31348
a((dp31349
g2
(lp31350
VThe  modifier is greedy, it'll match the maximum it can match if you let it
p31351
aVIf there is more than one occurrence of  in your input text, the  will match everything up to the last occurrence
p31352
aVUse  instead to switch off greedy matching;  will match the minimum number of characters instead:
p31353
as(dp31354
g16
V100297
p31355
stp31356
a((dp31357
g2
(lp31358
VYou don't need to encode data that is already encoded
p31359
aVWhen you try to do that, Python will first try to decode it to  before it can encode it back to UTF-8
p31360
aVThat is what is failing here:
p31361
aVJust write your data directly to the file, there is no need to encode already-encoded data
p31362
aVIf you instead build up  values instead, you would indeed have to encode those to be writable to a file
p31363
aVYou'd want to use  instead, which returns a file object that will encode unicode values to UTF-8 for you
p31364
aVYou also really don't want to write out the UTF-8 BOM, unless you have to support Microsoft tools that cannot read UTF-8 otherwise (such as MS Notepad)
p31365
aVFor your MySQL insert problem, you need to do two things:
p31366
aVAdd  to your  call
p31367
aVUse  objects, not  objects when querying or inserting, but use sql parameters so the MySQL connector can do the right thing for you:
p31368
aVIt may actually work better if you used  to decode the contents automatically instead:
p31369
aVYou may want to brush up on Unicode and UTF-8 and encodings
p31370
aVI can recommend the following articles:
p31371
aVThe Python Unicode HOWTO
p31372
aVPragmatic Unicode by Ned Batchelder
p31373
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p31374
aVby Joel Spolsky
p31375
as(dp31376
g16
V100297
p31377
stp31378
a((dp31379
g2
(lp31380
VJust copy the file, or symlink it
p31381
aVIt is a stand-alone script, it does not depend on anything else in  directory, so it can live anywhere
p31382
aVSymlinking or copying it into a directory that is on your  would enable you to run it without any path prefix (provided the executable bit is set, )
p31383
as(dp31384
g16
V100297
p31385
stp31386
a((dp31387
g2
(lp31388
VUse a string as a template:
p31389
aVthen you can use the  method of strings to fill in the slots:
p31390
aVYou'll have to expand this to using a loop, where you iterate over something that then provides the category and the UID, but you get the idea
p31391
aVPerhaps a mapping would work:
p31392
aVwhere the  format applies a dictionary as a set of keyword arguments; using  essentially translates to
p31393
as(dp31394
g16
V100297
p31395
stp31396
a((dp31397
g2
(lp31398
VThere is no need to generate all possible votes
p31399
aVYou can test your actual votes without having to generate the  list, because you can easily calculate if an existing vote is possible or not
p31400
aVYou also only really count the 'stay' votes
p31401
aVIt doesn't matter that you look for matching 'stay go' votes, because any 'stay go' vote for which  is true,  is also true
p31402
aVSo you may as well drop that first count, and only look at the second
p31403
aVNow you are just finding the maximum count for the  votes
p31404
aVUsing a  makes counting things easier:
p31405
aVThis calculates the same number your code calculated, but now we only have to loop over the votes just once, and only count 'stay' votes
p31406
aVContrast this with your loop, where you first loop  times, then loop  times
p31407
aVThat a factor of  larger
p31408
aVIf you have to validate votes first, you can use:
p31409
aVYou could also start using the go votes:
p31410
aVNow you can simply subtract the go votes from the stay vote tally (any tally falling to 0 is removed):
p31411
aVOf course, you could also do the calculation in one go:
p31412
aVbut keeping the vote tallies separate might be interesting for later analysis
p31413
as(dp31414
g16
V100297
p31415
stp31416
a((dp31417
g2
(lp31418
V has been renamed in Python 3, use  instead (and the old Python 2  was removed)
p31419
aVSee PEP 3111
p31420
aVSee What's new in Python 3
p31421
aV0 for an exhaustive overview
p31422
aVThere is also the Dive into Python 3 overview
p31423
as(dp31424
g16
V100297
p31425
stp31426
a((dp31427
g2
(lp31428
VYou hooked into the  for the schema of your content type
p31429
aVThe schema is used as the basis for the fields populating your content, but it's not the content type class itself
p31430
aVIf you want to hook into content type creation, you register event subscribers instead:
p31431
aVIf you really have to customize the content item initialization in an  method, you'd have to create your own custom content class instead
p31432
as(dp31433
g16
V100297
p31434
stp31435
a((dp31436
g2
(lp31437
VYou are using string keys in your  mapping, but are looking up a integer instead
p31438
aVIn this case, you should use a list instead:
p31439
aVwith  between 0 and 6, mapping directly to the names of the week at those positions in the  list
p31440
aVAlternatively, you could use integers as keys instead:
p31441
aVbut since your keys are sequential, you may as well save the space
p31442
as(dp31443
g16
V100297
p31444
stp31445
a((dp31446
g2
(lp31447
VCPython closes a file object automatically when the object is deleted; it is deleted when it's reference count drops to zero (no more variables refer to it)
p31448
aVSo if you use  in a function, as soon as the function is done, the local variables are cleaned up and the file is closed
p31449
aVIf you use  the reference count drops to 0 the moment  returns, and on CPython that means the file is closed there and then
p31450
aVOn other implementations such as Jython or IronPython, where object lifetime is managed differently, the moment an object is actually deleted could be much later
p31451
aVThe best way to use a file though, is as a context manager:
p31452
aVwhich calls  on  automatically
p31453
aVSee the  documentation and the documentation for the  statement
p31454
as(dp31455
g16
V100297
p31456
stp31457
a((dp31458
g2
(lp31459
VUse  instead, then convert to  (catching the  if that conversion fails)
p31460
aVYou can even include a range test, and explicitly raise  if the given choice is outside of the range of permissible values:
p31461
as(dp31462
g16
V100297
p31463
stp31464
a((dp31465
g2
(lp31466
VThe zlib compression algorithm is not always efficient:
p31467
aVbecause it needs to add metadata (headers, symbol tables, backreferences) that could amount to more data than what you tried to compress
p31468
aVUse it on longer, not-so-random data and it'll compress things just fine:
p31469
as(dp31470
g16
V100297
p31471
stp31472
a((dp31473
g2
(lp31474
VYou partition the input string regardless, never checking if the operator is even there
p31475
aVreturns empty strings if the partition character is not present in the input:
p31476
aVSo you'll call  but never check if there is any such operator present, resulting in unconditional calls to
p31477
aVYou'll always call  regardless of wether  is present in  or not
p31478
aVThe solution is to either test for the operator first or to check the return value of
p31479
aVThe latter is probably easiest:
p31480
aVNote that I reversed the operator order; yes, multiplication and division need to be applied before addition and subtraction, but you are working in reverse here; splitting up the expression into smaller parts, and the operations are then applied when the sub-expression has been processed
p31481
aVYou could use assignment unpacking to assign the 3 return values of  to easier names:
p31482
aVNext you can simplify all this by using the  module, which has functions that perform the same operations as your arithmetic operations
p31483
aVA map should do:
p31484
as(dp31485
g16
V100297
p31486
stp31487
a((dp31488
g2
(lp31489
VGenerators operate on two principles: they produce a value each time a  statement is encountered, and unless it is iterated over, their code is paused
p31490
aVIt doesn't matter how many  statements are used in a generator, the code is still run in normal python ordering
p31491
aVIn this case, there is no loop, just a series of  statements, so each time the generator is advanced, python executes the next line, which is another  statement
p31492
aVWhat happens with the  generator is this:
p31493
aVGenerators always start paused, so calling  returns a generator that hasn't done anything yet
p31494
aVWhen it is advanced ( is called on it), the code is run until the first  statement
p31495
aVFirst  is executed, then  is calculated and yielded
p31496
aVThe code pauses again
p31497
aVWhen advanced again, the code runs until the next  statement is encountered
p31498
aVIt yields
p31499
aVetc
p31500
aVuntil the function completes
p31501
aVThe  line does:
p31502
aVproduces an iterator for each and every position in the  sequence
p31503
aVIt simply loops over board, calls  on each value, and returns a new sequence of the results
p31504
aVEach  function returns a generator
p31505
aVThe  syntax expands the  sequence into a list of parameters, as if the function was called with each element in  as a separate positional parameter instead
p31506
aVwould translate to
p31507
aVtakes each and every generator produced by the map, and applies that as a series of positional parameters to
p31508
aVLooping over the output of chain means that each and every generator for each and every board position is iterated over once, in order
p31509
aVAll the generated positions are added to a set, essentially removing duplicates
p31510
aVYou could expand the code to:
p31511
aVIn python 3, that line could be expressed a little more efficiently still by using  instead, because  in Python 3 is a generator too;  doesn't force the  to be expanded and will instead loop over the  results one by one as needed
p31512
as(dp31513
g16
V100297
p31514
stp31515
a((dp31516
g2
(lp31517
VYou misunderstand how boolean expressions work; they don't work like an English sentence and guess that you are talking about the same comparison for all names here
p31518
aVYou are looking for:
p31519
aVand  are otherwise evaluated on their own ( if ,  otherwise)
p31520
aVYou can shorten that to:
p31521
aVor better still:
p31522
aVusing a  to take advantage of the constant-cost membership test ( takes a fixed amount of time whatever the left-hand operand is)
p31523
aVWhen you use , python sees each side of the operator as separate expressions
p31524
aVThe expression  is treated as first a boolean test for , then if that is False, the expression  is tested
p31525
aVThis is due to operator precedence
p31526
aVThe  operator has a lower precedence than the  test, so the latter is evaluated first
p31527
aVHowever, even if this were not the case, and the expression  was actually interpreted as  instead, this would still not do what you expect it to do
p31528
aVwould evaluate to the first argument that is 'truthy', e
p31529
ag1298
aVnot , numeric 0 or empty (see boolean expressions for details on what Python considers false in a boolean context)
p31530
aVSo for the values ,  would resolve to , because that is the first true-like value in the arguments
p31531
aVThen  would be , even though  would be
p31532
as(dp31533
g16
V100297
p31534
stp31535
a((dp31536
g2
(lp31537
VThere is a huge difference
p31538
aVThe  method is a hook method
p31539
aVThe  function will use the  method if present to query your object for it's length
p31540
aVThe normal API people expect to use is the  method, using a  attribute instead would deviate from that norm
p31541
aVIf the length of  is not expected to change, you can always cache the length in an attribute and have  return that attribute
p31542
as(dp31543
g16
V100297
p31544
stp31545
a((dp31546
g2
(lp31547
VYou need to include the protocol scheme:
p31548
aVWithout the  part,  has no idea how to connect to the remote server
p31549
as(dp31550
g16
V100297
p31551
stp31552
a((dp31553
g2
(lp31554
VUse a list comprehension instead:
p31555
aVThis looks at deletion as a filtering job; keep everything that should not be deleted by creating a new list instead
p31556
as(dp31557
g16
V100297
p31558
stp31559
a((dp31560
g2
(lp31561
VYou are trying to quote Unicode data, so you need to decide how to turn that into URL-safe bytes
p31562
aVEncode the string to bytes first
p31563
aVUTF-8 is often used:
p31564
aVHowever, the encoding depends on what the server will accept
p31565
aVIt's best to stick to the encoding the original form was sent with
p31566
as(dp31567
g16
V100297
p31568
stp31569
a((dp31570
g2
(lp31571
VUse the  module:
p31572
aVUsing a heap queue is more efficient than a full sort provided you are looking for a relatively smaller number of  elements
p31573
aVIf  is larger,  is more efficient
p31574
aVThe  implementation does test for these conditions and will switch to using  if it can determine  is equal to or larger than
p31575
aVNote that the  module will modify the list in-place ( is called on the list)
p31576
as(dp31577
g16
V100297
p31578
stp31579
a((dp31580
g2
(lp31581
VThe  class uses a  attribute to save memory
p31582
aVAs a result, to be pickleable, it must define a  method as well (see Why am I getting an error about my class defining __slots__ when trying to pickle an object
p31583
aVIf you need to add your own additional attributes, you'll have to override that  method
p31584
aVDeclaring your additional attributes in a  attribute of your own is probably a good idea too:
p31585
aVThis new  is required because the  method assumes that there will only be one  attribute, while each class in the MRO may have one instead
p31586
aVThis is really a limitation of the  library; I've submitted a pull request that addresses this and would remove the need to override the  method in a subclass
p31587
as(dp31588
g16
V100297
p31589
stp31590
a((dp31591
g2
(lp31592
VA generator function can be less efficient than building a list directly
p31593
aVYou can just build the list in the  function and return that:
p31594
aVbut do measure the differences, using the  module
p31595
aVIf you have some typical input, you'd test that with:
p31596
aVThe lower value is the faster method for your test data
p31597
as(dp31598
g16
V100297
p31599
stp31600
a((dp31601
g2
(lp31602
VYes, use the  method instead, and pass in a level constant:
p31603
aVYou could encapsulate the level selection into a utility function:
p31604
aVLog levels are really integers, and the , , etc
p31605
aVvalues are merely constants
p31606
aVThere are any number of ways you can turn one value (e
p31607
ag1298
aV) into a matching log level with a few simple rules, in a more readable manner than a large number of  /  branches
p31608
as(dp31609
g16
V100297
p31610
stp31611
a((dp31612
g2
(lp31613
VYou can, just add a  attribute to the module:
p31614
as(dp31615
g16
V100297
p31616
stp31617
a((dp31618
g2
(lp31619
VMove the function definition to before the lines that use it
p31620
aVFunctions are stored in identifiers (variables), just like your  value
p31621
aVIf you don't define it first, how is Python to know it'll be defined later
p31622
as(dp31623
g16
V100297
p31624
stp31625
a((dp31626
g2
(lp31627
VThe inner loop generates boolean values ( and ) based on the two nested loops
p31628
aVIN Python, booleans are a subclass of  and when summed act as  and  for  and , respectively
p31629
aVSo, you could rewrite this as:
p31630
as(dp31631
g16
V100297
p31632
stp31633
a((dp31634
g2
(lp31635
VThe time complexity for python  is O(1)
p31636
aVSee the Time Complexity list on the Python Wiki
p31637
aVInternally, python lists are vectors of pointers:
p31638
aVThe  vector is resized as needed with overallocation to give an amortized O(1) cost for appends:
p31639
aVThis makes Python lists dynamic arrays
p31640
as(dp31641
g16
V100297
p31642
stp31643
a((dp31644
g2
(lp31645
VThe one-but-last line tells you which module is affected:
p31646
aVSo the  module has no  attribute
p31647
as(dp31648
g16
V100297
p31649
stp31650
a((dp31651
g2
(lp31652
VDo not use SQL parameters for table names
p31653
aVSQL parameters are escaped by the database adapter to not be interpreted as anything but literal values
p31654
aVYou'll have to interpolate those yourself instead, but be absolutely certain that your table name does not hold untrusted data (prevent SQL injection attacks):
p31655
aV(where the  character in the grant has been escaped by doubling it to )
p31656
as(dp31657
g16
V100297
p31658
stp31659
a((dp31660
g2
(lp31661
VYou can set  to suppress the context printing in Python 3
p31662
aV3:
p31663
aVIn Python 3
p31664
aV3, when you use  what really happens is:
p31665
aVand setting  in turn implicitly sets
p31666
aVSee PEP 415, which details how  is handled
p31667
aVWhen you set  in Python 3
p31668
aV2, nothing changes:
p31669
aVBut in Python 3
p31670
aV3, the context is suppressed instead:
p31671
aVjust as if you had used :
p31672
as(dp31673
g16
V100297
p31674
stp31675
a((dp31676
g2
(lp31677
VUse a negative priority instead, no need to subtract from
p31678
aVAn item with priority -10 will be returned before items with priority -5, for example
p31679
as(dp31680
g16
V100297
p31681
stp31682
a((dp31683
g2
(lp31684
VIn the end, you have:
p31685
aVbut  will be looked up at runtime, not when you constructed the lambda
p31686
aVDo this instead:
p31687
aVThis does not return , though
p31688
aVIt returns  instead:
p31689
aVbecause now  is still looked up from the context (and by now the loop has finished so it's )
p31690
aVSolution
p31691
aVMove  to a keyword argument too:
p31692
aVNow this works:
p31693
aVMoral of the story
p31694
aVBind your context properly to the scope of the lambda
p31695
as(dp31696
g16
V100297
p31697
stp31698
a((dp31699
g2
(lp31700
VNo,  can never result in a  being thrown
p31701
aVYou are running that without quotes instead:
p31702
aVA  exception is Python telling you the global name  is not defined in your code, not that the command  has not been found on your machine
p31703
as(dp31704
g16
V100297
p31705
stp31706
a((dp31707
g2
(lp31708
VFrom the Zen of Python: Explicit is better than implicit
p31709
aVWhen you make an error like trying to create an invalid date, you need to explicitly handle that situation
p31710
aVHow you handle that exception is entirely up to your application
p31711
aVYou could inform the end user of the error, or you could try and shift the days into the next month, or cap the day to the last legal day in the current month
p31712
aVAll would be valid options, depending on your use cases
p31713
aVThe following code would shift the 'surplus' days into a next month
p31714
aVSo 2013-02-30 would become 2013-03-02 instead
p31715
as(dp31716
g16
V100297
p31717
stp31718
a((dp31719
g2
(lp31720
VNo, no such information is retained
p31721
aVThe  call simply returns a new cursor with reversed positions:
p31722
aV(Source re-indented to a 4-space indent for readability)
p31723
as(dp31724
g16
V100297
p31725
stp31726
a((dp31727
g2
(lp31728
VIf you want to update the  , you need to construct a new string value for it
p31729
aVis an immutable sequence type, and unlike  cannot be modified in-place
p31730
aVIn this case, perhaps you meant to use string concatenation
p31731
aVThe following code will set  to , where  is the previous contents of , effectively prepending :
p31732
as(dp31733
g16
V100297
p31734
stp31735
a((dp31736
g2
(lp31737
VWhen the line  expression throws an exception, the variable  is never set
p31738
aVYou could set it to  before the  statement, then test if it is still  afterwards:
p31739
as(dp31740
g16
V100297
p31741
stp31742
a((dp31743
g2
(lp31744
VYou want to set a constraint function:
p31745
aVthen set that function as the  of your  field:
p31746
aVSee the Dexterity manual on validation for more information, as well as the  interface definitions
p31747
as(dp31748
g16
V100297
p31749
stp31750
a((dp31751
g2
(lp31752
VThere is no need to create a new object
p31753
aVSimply serialize the dictionary directly:
p31754
aVHowever, your code should have worked otherwise
p31755
aVYou probably have data contained in  and  that is not serializable
p31756
as(dp31757
g16
V100297
p31758
stp31759
a((dp31760
g2
(lp31761
VYou could use a  to handle classification instead:
p31762
aVThis sets up a getter and a setter for a  attribute; accessing the  attribute translates into the first method being called
p31763
aVSetting the  attribute translates in the setter, the second method, being called instead:
p31764
aVI picked the  attribute as the property here, but you could make  a property instead as well
p31765
aVWhich one you make into a property depends on usage patterns and intent
p31766
aVIf  is rarely changed, making it the property would be more efficient
p31767
as(dp31768
g16
V100297
p31769
stp31770
a((dp31771
g2
(lp31772
VLeave the index at , and catch exceptions instead:
p31773
aVWhen you use  with a negative index, the item is inserted relative to the length of the list
p31774
aVOut-of-bounds indices are brought back to bounds; inserting beyond the length is the same as appending, insertion before the 0 index inserts at 0 instead
p31775
as(dp31776
g16
V100297
p31777
stp31778
a((dp31779
g2
(lp31780
VSee Entities in the documentation, BeautifulSoup 4 produces proper Unicode for all entities:
p31781
aVAn incoming HTML or XML entity is always converted into the corresponding Unicode character
p31782
aVYes,  is turned to a non-breaking space character, and if you really want those to be space characters instead, you'll have to do a unicode replace instead
p31783
as(dp31784
g16
V100297
p31785
stp31786
a((dp31787
g2
(lp31788
VYes, the  of an object is only consulted after data descriptors have been consulted
p31789
aVattributes are implemented as data descriptors
p31790
aVSee Invoking descriptors:
p31791
aVFor instance bindings, the precedence of descriptor invocation depends on the which descriptor methods are defined
p31792
aVA descriptor can define any combination of ,  and
p31793
aVIf it does not define , then accessing the attribute will return the descriptor object itself unless there is a value in the object\u2019s instance dictionary
p31794
aVIf the descriptor defines  and/or , it is a data descriptor; if it defines neither, it is a non-data descriptor
p31795
aVNormally, data descriptors define both  and , while non-data descriptors have just the  method
p31796
aVData descriptors with  and  defined always override a redefinition in an instance dictionary
p31797
aVIn contrast, non-data descriptors can be overridden by instances
p31798
aVand from the same page, section on slots:
p31799
aVare implemented at the class level by creating descriptors (Implementing Descriptors) for each variable name
p31800
aVAs a result, class attributes cannot be used to set default values for instance variables defined by ; otherwise, the class attribute would overwrite the descriptor assignment
p31801
as(dp31802
g16
V100297
p31803
stp31804
a((dp31805
g2
(lp31806
VJust pass in  or  as the first positional argument, there is no need to pass them is as keyword arguments:
p31807
as(dp31808
g16
V100297
p31809
stp31810
a((dp31811
g2
(lp31812
V returns a string, not a number
p31813
aVYou'll have to convert that:
p31814
aVor
p31815
aVdepending on what you want your calculator to support, otherwise you are indeed performing maths operations with strings
p31816
as(dp31817
g16
V100297
p31818
stp31819
a((dp31820
g2
(lp31821
VYou build a SQL query with the  call, and this query is not executed until you call  on it
p31822
aVYou can store the intermediary results and add more filters or other clauses as needed:
p31823
aVThe value you pass to  can be created ahead of time:
p31824
aVthen used like:
p31825
aVOnce your query is complete, get the results by calling :
p31826
as(dp31827
g16
V100297
p31828
stp31829
a((dp31830
g2
(lp31831
VYou forgot a closing parenthesis:
p31832
aVWhen in doubt, look to the previous line for unbalanced closing parens or brackets
p31833
as(dp31834
g16
V100297
p31835
stp31836
a((dp31837
g2
(lp31838
VThis is entirely correct
p31839
aVPillow is a fork, alternative re-packaging of PIL
p31840
aVFrom the PyPI page for Pillow:
p31841
aVThe fork author's goal is to foster packaging improvements via:
p31842
aVPublicized development and solicitation of community support
p31843
aVExploration of packaging problems within the fork, most noticably via adding setuptools support but also via clean up & refactoring of packaging code
p31844
aVInside the package this is still the PIL project and will still emit messages under that name when compiling
p31845
aVUnfortunately, Pillow does not claim to satisfy the PIL requirement, so anything that depends on PIL instead will still pull PIL in
p31846
as(dp31847
g16
V100297
p31848
stp31849
a((dp31850
g2
(lp31851
VPIL is not correctly packaged; there are some forks around that fix that
p31852
aVFrom The problem with installing PIL using virtualenv or buildout, your best bet currently is to install Pillow instead; it's a drop-in replacement for PIL
p31853
aVFor Windows, use a precompiled installer from Christoph Gohlke instead
p31854
as(dp31855
g16
V100297
p31856
stp31857
a((dp31858
g2
(lp31859
VYou are comparing a string and a floating point value
p31860
aVYou have two options:
p31861
aVformat  as a string as well; this will automatically round the floating point value to a required number of digits:
p31862
aVcompare  value with a floating point literal instead, but with a tolerance (since floating point is not precise):
p31863
as(dp31864
g16
V100297
p31865
stp31866
a((dp31867
g2
(lp31868
VThe following class decorator would do that:
p31869
aVbut you could just as well create a property factory:
p31870
aVthen set that in the class with:
p31871
aVThe class decorator would make more sense if you needed to create multiple properties (perhaps with interdependencies) instead
p31872
as(dp31873
g16
V100297
p31874
stp31875
a((dp31876
g2
(lp31877
VThe  is the standard string for custom objects that do not implement their own  hook
p31878
aVYou can customize it by implementing that method:
p31879
as(dp31880
g16
V100297
p31881
stp31882
a((dp31883
g2
(lp31884
VYou could use :
p31885
aVor you could just test in the loop:
p31886
as(dp31887
g16
V100297
p31888
stp31889
a((dp31890
g2
(lp31891
VYou are trying to open the file in the current working directory, because you didn't specify a path
p31892
aVYou need to use an absolute path instead:
p31893
aVbecause the current working directory is rarely the same as the module directory
p31894
aVNote that I used  instead of ; the former is the recommended method
p31895
as(dp31896
g16
V100297
p31897
stp31898
a((dp31899
g2
(lp31900
VCreate a list with a single element instead:
p31901
as(dp31902
g16
V100297
p31903
stp31904
a((dp31905
g2
(lp31906
VI see three problems:
p31907
aVYou call  repeatedly
p31908
aVThat is a relatively expensive operation, cache the result in a local variable instead:
p31909
aVYou called  with one argument, not a list:
p31910
aVYou don't change the  role:
p31911
aVThere is a  product that takes care of all these details for you
p31912
as(dp31913
g16
V100297
p31914
stp31915
a((dp31916
g2
(lp31917
VMatching XML with regular expressions get too complicated, too fast
p31918
aVYou really should not do that
p31919
aVUse a XML parser instead, Python has several to choose from:
p31920
aVElementTree is part of the standard library
p31921
aVlxml is a fast and feature-rich C-based library
p31922
aVElementTree example:
p31923
as(dp31924
g16
V100297
p31925
stp31926
a((dp31927
g2
(lp31928
VYou'd have to do some kind of count
p31929
aVUsing the  class would make that easy:
p31930
aVis a multi-set or bag; a mapping of entry to it's count in
p31931
aVThe above example preserves the ordering of
p31932
as(dp31933
g16
V100297
p31934
stp31935
a((dp31936
g2
(lp31937
VUse a decent linter, and test your code using automated testing (unit tests, etc
p31938
aVMost IDEs and text editors can be set up to run a linter automatically
p31939
aVI recommend using ; it combines the output of the  style checker, the  linter (which would catch the above error, it'll tell you  is assigned to but never used elsewhere) and will tell you if your code is getting too complex (using the McCabe Cyclomatic complexity metric)
p31940
as(dp31941
g16
V100297
p31942
stp31943
a((dp31944
g2
(lp31945
VYou cannot use a  in a check constraint; from the documentation: The expression of a CHECK constraint may not contain a subquery
p31946
aVThis means you cannot do what you want with a CHECK constraint, and you'll have to do this in (Python) code instead
p31947
as(dp31948
g16
V100297
p31949
stp31950
a((dp31951
g2
(lp31952
VYou need to iterate over :
p31953
aVor store the iterator first, then loop:
p31954
aVThe return value of the callable is a generator function, and only when you iterate over it (with a  loop or by calling  on the iterator) does it yield the 3-value tuples
p31955
as(dp31956
g16
V100297
p31957
stp31958
a((dp31959
g2
(lp31960
VYou cannot do this, special hook methods like  are always looked up on the type, not on the instance
p31961
aVIn other words,  calls , not
p31962
aVSee the Special method lookup documentation; I explained why this is in a previous answer
p31963
aVFor methods that are not special hooks (starting and ending with double underscores), you are free to assign methods to your instance, there is no technical reason preventing you from doing that
p31964
aVIf your goal is to provide a facade object then by all means, copy over methods
p31965
aVI see no obvious downsides to doing that
p31966
aVCalling the method directly on your instance instead of having to route through a wrapper method would perform slightly better (you save a stack push and pop for the wrapper method)
p31967
as(dp31968
g16
V100297
p31969
stp31970
a((dp31971
g2
(lp31972
VIf the items are all globals you can use the  call to get a mapping, then manipulate them:
p31973
aVbut you really want to just store all those items in a list or dictionary instead
p31974
as(dp31975
g16
V100297
p31976
stp31977
a((dp31978
g2
(lp31979
VBecause the second element in a slice is exclusive
p31980
aVThe indices run from 10 until 1, not until 0
p31981
aVTo reverse , just omit the start and end:
p31982
as(dp31983
g16
V100297
p31984
stp31985
a((dp31986
g2
(lp31987
VYou want to add the path to the directory your modules are located in to your  variable instead, or add the  module directly to a directory on the path (and not in a subdirectory)
p31988
aVBy adding  to a directory, you converted it into a python package instead, making it an importable
p31989
aVIf that was your intention, then you moved -the-module inside of a -the-package, and you can import that through that namespace:
p31990
as(dp31991
g16
V100297
p31992
stp31993
a((dp31994
g2
(lp31995
VYour console is configured to display codepage 1252 (Latin 1), which indeed cannot handle your codepoints
p31996
aVSwitch your console to a different codepage that can display the characters
p31997
aVYou could switch to 1256:
p31998
aVor switch to 65001 (the UTF-8 codepage), which should be able to handle any unicode codepoint
p31999
aVYou may have to switch the font used for your console though; Lucida Sans is reported to display most of Unicode
p32000
as(dp32001
g16
V100297
p32002
stp32003
a((dp32004
g2
(lp32005
VYou are matching uppercase  letters only, so the character sequences  and  and  cause the pattern not to match anything
p32006
aVAdding the  case-insensitive flag makes your pattern work:
p32007
aVor you could add  to the character classes instead:
p32008
as(dp32009
g16
V100297
p32010
stp32011
a((dp32012
g2
(lp32013
V123 is but one representation of the integer value
p32014
aVPython  values are not sequences or mappings, so  indexing has no meaning for them
p32015
aVBy turning the number into a string, you 'capture' the representation into a series of digit characters and you then can get the first one
p32016
aVAnother way to do it would be to divide by 10 until you have a number lower than 10:
p32017
aVNote that  then holds an  still, not a single-character string
p32018
as(dp32019
g16
V100297
p32020
stp32021
a((dp32022
g2
(lp32023
VFunctions in other modules are not automatically visible in your  module
p32024
aVYou need to explicitly import them:
p32025
aVor import the  module and use that as a namespace:
p32026
as(dp32027
g16
V100297
p32028
stp32029
a((dp32030
g2
(lp32031
VUse  instead:
p32032
aVUsing  will result in a random string that can have repeating characters:
p32033
aVNote the two  characters
p32034
aVIf you do not want characters to repeat, then uses  instead:
p32035
aVand the 6 random characters are guaranteed not to contain repeats
p32036
as(dp32037
g16
V100297
p32038
stp32039
a((dp32040
g2
(lp32041
VBefore the  H3 tag, there is another tag with  in the text:
p32042
aVYou need to be more specific in your search, search for  instead, and loop to find the correct one:
p32043
aVonly matches the full text, not a partial match
p32044
aVUse a regular expression if you need partial matches instead:
p32045
as(dp32046
g16
V100297
p32047
stp32048
a((dp32049
g2
(lp32050
VThe  API method returns a list of shows (each a mapping) that match your search
p32051
aVYou can simply loop over these and match the specific title:
p32052
aVor you could use a generator expression to get one matching show:
p32053
as(dp32054
g16
V100297
p32055
stp32056
a((dp32057
g2
(lp32058
VYou need to create a :
p32059
aVwhere  is the name (key) of the parameter as used in the SQL statement,  the text you want to appear on the left-hand side of the operator
p32060
as(dp32061
g16
V100297
p32062
stp32063
a((dp32064
g2
(lp32065
VYou need to specify the port as a number, not a string:
p32066
aVI used multiple lines to make the above example more readable; the error points out that the value for  must be an integer
p32067
as(dp32068
g16
V100297
p32069
stp32070
a((dp32071
g2
(lp32072
VSet the header value to :
p32073
aVwould output:
p32074
aVwhich is conform with the HTTP specification for message headers
p32075
as(dp32076
g16
V100297
p32077
stp32078
a((dp32079
g2
(lp32080
VYou are comparing an integer with a string
p32081
aVConvert the input value:
p32082
as(dp32083
g16
V100297
p32084
stp32085
a((dp32086
g2
(lp32087
VYou would have to mark  as a global:
p32088
aVNormally, any name defined in a function is local to the function only
p32089
aVYou'd still have to import the name from the module, or refer to it as an attribute of the module:
p32090
as(dp32091
g16
V100297
p32092
stp32093
a((dp32094
g2
(lp32095
VYou called  twice at least; the first time without a filename
p32096
aVClear the handlers and try again:
p32097
as(dp32098
g16
V100297
p32099
stp32100
a((dp32101
g2
(lp32102
VSure, use the  parameter to the  method:
p32103
aVUsing  makes this a little easier but is not required
p32104
aVSee the Sorting Howto on the Python wiki for more tips and tricks
p32105
as(dp32106
g16
V100297
p32107
stp32108
a((dp32109
g2
(lp32110
VImporting the module with a simple  statement does not copy the names from that module into your own global namespace
p32111
aVEither refer to the  name through attribute access:
p32112
aVor use the  syntax:
p32113
aVinstead
p32114
aVYou can learn more about how importing works in the Modules section of the Python tutorial
p32115
as(dp32116
g16
V100297
p32117
stp32118
a((dp32119
g2
(lp32120
VUse a generator expression to update your dictionary:
p32121
aVor, for Python 3:
p32122
aVor, for Python 2
p32123
aV6 and earlier:
p32124
aVThis loops over all key-value pairs in  then adds a corresponding uppercase key-value pair
p32125
as(dp32126
g16
V100297
p32127
stp32128
a((dp32129
g2
(lp32130
VYou can safely append items to the list, and the iteration will include those items:
p32131
aVHowever, if you prefer a diminishing list, then your  loop is perfectly suitable for your needs
p32132
as(dp32133
g16
V100297
p32134
stp32135
a((dp32136
g2
(lp32137
VNo need to use a dictionary at all, just match doubled letters:
p32138
aVThe  group is referred to by the  match so only doubled letters are matched
p32139
aVIt is a slightly more verbose way of using  that is more self-documenting
p32140
as(dp32141
g16
V100297
p32142
stp32143
a((dp32144
g2
(lp32145
VContent items are listed as candidate default pages if:
p32146
aVthe object is not a container type
p32147
aVor
p32148
aVthe object portal type is listed in the  of your  property sheet
p32149
aVFind that in the ZMI (site settings -> Zope Management Interface -> )
p32150
aVThe  property is a list of  ids; for Dexterity types that is usually a dotted name (the Dexterity manual uses  for example)
p32151
as(dp32152
g16
V100297
p32153
stp32154
a((dp32155
g2
(lp32156
VEither loop over the list, or use :
p32157
aVor
p32158
aVThe first print each element contained in the  slice separately, the second joins the lines into a new string with  newline characters between them before printing
p32159
as(dp32160
g16
V100297
p32161
stp32162
a((dp32163
g2
(lp32164
VInstead of , use ; it uses the most accurate option for your platform
p32165
aVFor Ubuntu, for example, this will use  instead
p32166
aVWhen using , create one setup function that you then can re-use for
p32167
aVYes, this looks like a bit of work but it ensures that you time what you really wanted to measure, and not include setup code in the time-critical measured section
p32168
as(dp32169
g16
V100297
p32170
stp32171
a((dp32172
g2
(lp32173
VYou want to look at ;  objects are multi-sets (also known as bags); they map keys to their counts
p32174
aVYou will have to turn your sublists into tuples to be usable as keys though:
p32175
aVwhich gives you a  sorted by counts (descending):
p32176
aVIf your occurrences are always consecutive, then you could also use :
p32177
aVI used a separate generator function here, you can inline the loop into the list comprehension though
p32178
aVThis gives:
p32179
aVand retains the original ordering
p32180
as(dp32181
g16
V100297
p32182
stp32183
a((dp32184
g2
(lp32185
VYour  instances do have a dictionary associated with them, access it with the  function:
p32186
aVThis works for all custom classes that do not use a  attribute
p32187
aVAlternatively, you can use the newer  string formatting method, which lets you access object attributes:
p32188
aVIt's this method of formatting that looks for a  method on your custom classes, see the  function documentation
p32189
aVLast but not least, any object with a  method can be used for string formatting as if it is a dictionary:
p32190
as(dp32191
g16
V100297
p32192
stp32193
a((dp32194
g2
(lp32195
VYou don't need to add  to your types; it is an index in the catalog, and Dexterity types already have the proper attribute for that index,
p32196
aVIf you do need to add attributes to content types, you can either use an event subscriber or create a custom subclass of :
p32197
aVsubscribers can listen for the  event:
p32198
aVcustom content classes need to be registered in your type XML:
p32199
aVthen in your Dexterity FTI XML file, add a  property:
p32200
as(dp32201
g16
V100297
p32202
stp32203
a((dp32204
g2
(lp32205
VYou could use Ghost
p32206
aVpy in Python:
p32207
aVThis runs a headless Webkit browser that you can control from Python
p32208
as(dp32209
g16
V100297
p32210
stp32211
a((dp32212
g2
(lp32213
VThe value is the number of miliseconds since the epoch
p32214
aVIn Python that could be handled with the  constructor:
p32215
as(dp32216
g16
V100297
p32217
stp32218
a((dp32219
g2
(lp32220
VYou need to use the same name that you used in the the Dexterity FTI registration
p32221
aVYou can verify what names are registered in the  tool:
p32222
aVor visit the  tool in the ZMI in your browser and look at the list of types there; they are listed as  in the tool
p32223
aVIf your type isn't listed there ensure that you properly registered your type first
p32224
aVNote that for this to work, you need the local component manager set up correctly
p32225
aVNormally, this happens automatically, but if you are using a  script or use , that doesn't happen
p32226
aVYou need to do that manually in that case:
p32227
aVYou may also want to set a current user:
p32228
as(dp32229
g16
V100297
p32230
stp32231
a((dp32232
g2
(lp32233
VThis is normal and valid JSON behaviour
p32234
aVThe  escape is also used by Python, so make sure you don't confuse python literal representations with the contents of the string
p32235
aVDemo in Python 3
p32236
aV3:
p32237
aVIn python 2
p32238
aV7:
p32239
aVWhen reading and writing from and to files, and when specifying just raw byte strings (and  is a raw byte string) then you are not dealing with Unicode data
p32240
aVYou need to learn about the differences between encoded and Unicode data first
p32241
aVI strongly recommend you read at least 2 of the following 3 articles:
p32242
aVThe Python Unicode HOWTO
p32243
aVPragmatic Unicode by Ned Batchelder
p32244
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p32245
aVby Joel Spolsky
p32246
aVYou were lucky with your  python raw byte string representation, Python managed to decode it automatically for you
p32247
aVThe value read back from the file is perfectly normal and correct:
p32248
as(dp32249
g16
V100297
p32250
stp32251
a((dp32252
g2
(lp32253
VA 'partial' insert means just the same as a full insert, but with values you don't specify left as
p32254
aVThe database can still replace the  values with a default specified in the schema for columns you omitted
p32255
aVIn SQLAlchemy, that just means you set those same columns to ; you don't even have to do that explicitly
p32256
aVNote that you do not need the  method on your  class
p32257
aVThis is probably making it harder for you to not specify some of the columns
p32258
aVThe SQLAlchemy declarative base provides you with a default  method that does what you want already but also preserves defaults
p32259
aVIf you don't want to remove  altogether, either alter that  method to default to  or explicitly specify  an column values like Burhan's answer does:
p32260
aVthen use  to insert a completely 'empty' row (which would also work if you removed your  altogether)
p32261
as(dp32262
g16
V100297
p32263
stp32264
a((dp32265
g2
(lp32266
VUse  instead in pdb
p32267
aVThe  exclamation mark ensures that pdb does not try to execute the line as a pdb command, passing it to the Python interpreter instead
p32268
as(dp32269
g16
V100297
p32270
stp32271
a((dp32272
g2
(lp32273
VDo not use identity testing ( or ) to test for numerical equality
p32274
aVUse  or  instead
p32275
aVtests for object identity (that both operators are the same python object), which is not the same thing as testing if the values are equivalent
p32276
aVSince  is also considered  in a boolean context, you can even omit the  in this case:
p32277
aVThe  module already has a  function that implements the greatest common divisor algorithm correctly:
p32278
aVIt uses the Euclidian algorithm, python style:
p32279
as(dp32280
g16
V100297
p32281
stp32282
a((dp32283
g2
(lp32284
VWhen using a compound statement in python (statements that need a suite, an indented block), and that block contains only simple statements, you can remove the newline, and separate the simple statements with semicolons
p32285
aVHowever, that does not support compound statements
p32286
aVSo:
p32287
aVworks, but
p32288
aVdoes not because both the  and the the  statements are compound
p32289
aVFor your specific example, you can replace the  part with a conditional expression, so by using an expression instead of a complex statement:
p32290
aVin general, or  specifically
p32291
aVFrom a style perspective, you generally want to leave that one line on it's own, though
p32292
as(dp32293
g16
V100297
p32294
stp32295
a((dp32296
g2
(lp32297
VYou'll have to loop over all keys of all nested dictionaries:
p32298
aVDemonstration:
p32299
aVIf you want to avoid looping over everything, you'll need to rethink your data structure, or build and maintain an index into the structure
p32300
aVIf you needed to manipulate the key-value pair, you need to have more information
p32301
aVYou can include the 'parent' dictionary in the loop:
p32302
aVand unpack that information when looping over the generator:
p32303
as(dp32304
g16
V100297
p32305
stp32306
a((dp32307
g2
(lp32308
V exactly the same thing as , for strings or any other type:
p32309
aVHowever,  is deprecated
p32310
aVIt has been removed from Python 3
p32311
aVAlways use  instead
p32312
as(dp32313
g16
V100297
p32314
stp32315
a((dp32316
g2
(lp32317
VUse the  function to test for a specific type:
p32318
aVtakes either a single type, or a tuple of types to test against:
p32319
aVwould test for a series of different numeric types for example
p32320
as(dp32321
g16
V100297
p32322
stp32323
a((dp32324
g2
(lp32325
VDo not use  to set a timezone, use  instead:
p32326
aVSee the  documentation:
p32327
aVThe first is to use the localize() method provided by the pytz library
p32328
aVThis is used to localize a naive datetime (datetime with no timezone information):
p32329
aVHowever, if your datetimes are UTC times, you should use the UTC timezone instead, then express the time in a different timezone for display:
p32330
as(dp32331
g16
V100297
p32332
stp32333
a((dp32334
g2
(lp32335
VUse a simple XPath expression to find the right model:
p32336
aVthen simply adjust the  attribute:
p32337
aVYou could also search for  elements with a  attribute:
p32338
aVthen filter further on those elements
p32339
aVIf you switch to using  (an alternative implementation of the ElementTree API) you can use more complex XPath expressions still, including matching only  elements with  and a  attribute
p32340
as(dp32341
g16
V100297
p32342
stp32343
a((dp32344
g2
(lp32345
V takes a 3rd argument, called count:
p32346
aVBy passing in  as the count only the first occurance of  is replaced:
p32347
as(dp32348
g16
V100297
p32349
stp32350
a((dp32351
g2
(lp32352
VBecause  are a lot like s but without the values:
p32353
aVBoth dictionaries and sets are not indexed, like lists are, so an  makes no sense here
p32354
aVBut like dictionaries, there is only ever one value of each 'key' in the set
p32355
as(dp32356
g16
V100297
p32357
stp32358
a((dp32359
g2
(lp32360
VYou want to use /:
p32361
aVMake sure that  is an integer; if it is a string instead, you'll need cast it:
p32362
as(dp32363
g16
V100297
p32364
stp32365
a((dp32366
g2
(lp32367
VThat is entirely correct
p32368
aVXML tag attributes are stored in the  structure
p32369
aVWhen you then output the ElementTree structure to XML, the  values will be used to generate XML attributes:
p32370
aVThe  syntax in function signatures capture additional keyword arguments to the function call; you can pass in a explicit dictionary or you can use keyword arguments to define the attributes
p32371
aVSee the function definitions documentation
p32372
aVThe following two forms are thus equivalent (for  calls):
p32373
as(dp32374
g16
V100297
p32375
stp32376
a((dp32377
g2
(lp32378
VJust split on whitespace:
p32379
aVwith no arguments will split on variable-width whitespace, and remove leading and trailing whitespace as needed
p32380
aVWhitespace is any tab, space, newline or carriage return:
p32381
as(dp32382
g16
V100297
p32383
stp32384
a((dp32385
g2
(lp32386
VYour input data contains octal escapes; those would be invalid indeed
p32387
aVReplace them with decoded bytes using a regular expression:
p32388
aVThis makes your input work:
p32389
as(dp32390
g16
V100297
p32391
stp32392
a((dp32393
g2
(lp32394
VGiven a file object, and a number of characters, you can use:
p32395
aVResult of a test:
p32396
as(dp32397
g16
V100297
p32398
stp32399
a((dp32400
g2
(lp32401
VWith some list comprehensions:
p32402
aVThis:
p32403
aVopens the file as a context manager () so it is automatically closed
p32404
aVloops over the file splitting each line (provided the line is not empty)
p32405
aVturns each 2-value entry in the file into a stripped string and a integer
p32406
aVsorts the file on the second value in each tuple (the score), reversing the result (highest score first)
p32407
aVprints each entry formatted (align each name to the left in a 20-character area, each score to the right in a 10-character field)
p32408
as(dp32409
g16
V100297
p32410
stp32411
a((dp32412
g2
(lp32413
VNope, that last row is data returned from the table
p32414
aVA select would never include the column headers in the row data
p32415
aVThat info is available, but as a  attribute on the cursor, never in the result of
p32416
aVIn other words, something else inserted that data into your table, and the  is merely returning that information
p32417
aVWhat the command line client does in format results for you, and it'll add the header info if so configured, but that is not behaviour that is part of the  statement in and of itself
p32418
as(dp32419
g16
V100297
p32420
stp32421
a((dp32422
g2
(lp32423
VRead the data in blocks delineated by empty lines and test for your status afterwards:
p32424
as(dp32425
g16
V100297
p32426
stp32427
a((dp32428
g2
(lp32429
VIf you don't mind that the original tree is changed, I'd use  on the  tags to simply remove them from the tree:
p32430
aVThis is a full working tree still:
p32431
aVBut you do not need to remove those tags at all to achieve what you want:
p32432
aVresults in:
p32433
aVregardless of wether or not we removed the  tags from the tree first
p32434
as(dp32435
g16
V100297
p32436
stp32437
a((dp32438
g2
(lp32439
VYou need to pass in the result of  instead:
p32440
aVThe  function returns the namespace of the Namespace instance (its  attribute) as a dictionary
p32441
aVInside , simply ignore the  key
p32442
as(dp32443
g16
V100297
p32444
stp32445
a((dp32446
g2
(lp32447
VYou'd have to split each string twice, but yes, it can be done:
p32448
aVResult:
p32449
aVTo avoid splitting twice, use a generator expression and the  constructor instead:
p32450
aVsince it takes a sequence of two-value tuples
p32451
as(dp32452
g16
V100297
p32453
stp32454
a((dp32455
g2
(lp32456
VAt most you can clean out everything that isn't a opening angle bracket from the front, and everything that isn't a closing angle bracket from the end:
p32457
aVbut this will fall over easily if there are any opening angle brackets at the start before the actual XML data, and any extra closing angle brackets at the end of the data
p32458
aVThis is not uncommon in shell environments
p32459
aVIt'll be much easier on you if you just reject any such inputs instead
p32460
as(dp32461
g16
V100297
p32462
stp32463
a((dp32464
g2
(lp32465
VYou return the first word that is 4 chars or longer, instead of all such words
p32466
aVAppend to  and return that instead:
p32467
aVYou can simplify that with a list comprehension:
p32468
aVYes, a regular expression could do this too, but for your case that may be overkill
p32469
as(dp32470
g16
V100297
p32471
stp32472
a((dp32473
g2
(lp32474
VYou don't ever return the return value of the recursive call:
p32475
aVWhen you omit the  statement there, your function ends without a return statement, thus falling back to the default  return value
p32476
aVWith the  there, it works:
p32477
as(dp32478
g16
V100297
p32479
stp32480
a((dp32481
g2
(lp32482
VI'd use:
p32483
aVThe  method takes any of your columns and returns a tuple (possibly with only one value) after removing the braces, removing everything before the first  and splitting on the embedded 'comma'
p32484
aVBy using  we turn the series of tuples generated from the columns into one list again for the csv writer
p32485
aVWhen handling the first line we generate one header row from the same columns, replacing the  and  headers with the 6 expanded headers
p32486
as(dp32487
g16
V100297
p32488
stp32489
a((dp32490
g2
(lp32491
V returns tuples:
p32492
aVMap them back to lists:
p32493
as(dp32494
g16
V100297
p32495
stp32496
a((dp32497
g2
(lp32498
VGenerally, I'd create a list of mappings with the information needed:
p32499
aVthen loop over the  list in your template instead
p32500
aVThis saves having to hassle with SQLAlchemy objects and makes sure your template is handed all the right data for display
p32501
as(dp32502
g16
V100297
p32503
stp32504
a((dp32505
g2
(lp32506
VTwo things are wrong:
p32507
aVYour  function returns an empty string if the URL you requested returned an empty response
p32508
aVThus, your  function won't call  either
p32509
aVChange  to test for  instead:
p32510
aVYou are checking for proxies in a thread, and each thread is calling  at the same time
p32511
aVThis is causing a race condition, the inserts are replacing one another
p32512
aVYou'll need to add a thread lock there
p32513
as(dp32514
g16
V100297
p32515
stp32516
a((dp32517
g2
(lp32518
VA chain is always passed the previous result as a first argument
p32519
aVFrom the chains documentation:
p32520
aVThe linked task will be applied with the result of its parent task as the first argument, which in the above case will result in  since the result is 4
p32521
aVYour  task doesn't accept this extra argument, and thus it fails
p32522
aVYou have a fine use case for chaining; the second task is guaranteed to be called after the first task is completed (otherwise the result could not be passed on anyway)
p32523
aVSimply add an argument for the result from the previous task:
p32524
aVYou could make some use of that result value; maybe make it the download method return the path of the downloaded file so the upload method knows what to upload
p32525
as(dp32526
g16
V100297
p32527
stp32528
a((dp32529
g2
(lp32530
VYou saved the literal representation of python objects, not JSON
p32531
aVYou can decode those with  but you may want to fix your JSON writing code instead
p32532
aVMake sure you use  on your structure when saving
p32533
aVUsing  (after closing all the braces):
p32534
as(dp32535
g16
V100297
p32536
stp32537
a((dp32538
g2
(lp32539
VYour  entry matches only digits and dots (IPv4 addresses), but the log entry example you posted is an IPv6 address
p32540
aVAdjust your pattern to allow for that format too (so either match digits and dots, or match hex characters and colons:
p32541
aVWith that adjustment, your example matches:
p32542
as(dp32543
g16
V100297
p32544
stp32545
a((dp32546
g2
(lp32547
VYou are nearly there:
p32548
aVwhich gives:
p32549
as(dp32550
g16
V100297
p32551
stp32552
a((dp32553
g2
(lp32554
VYou could use a  on the metaclass instead:
p32555
aVThis makes  an attribute on the class, so the expensive database call is postponed until you try to access
p32556
aVThe result of the database call is cached by storing it in , the call is only made once for the class
p32557
aVFor Python 3, use  instead of the  attribute in the class definition body
p32558
aVDemo:
p32559
aVThis works because a data descriptor like  is looked up on the parent type of an object; for classes that's , and  can be extended by using metaclasses
p32560
as(dp32561
g16
V100297
p32562
stp32563
a((dp32564
g2
(lp32565
VThe  method can only take text from the terminal
p32566
aVYou'll thus have to figure out a way to parse that text and turn it into a date
p32567
aVYou could go about that in two different ways:
p32568
aVAsk the user to enter the 3 parts of a date separately, so call  three times, turn the results into integers, and build a date:
p32569
aVAsk the user to enter the date in a specific format, then turn that format into the three numbers for year, month and day:
p32570
aVBoth these approaches are examples; no error handling has been included for example, you'll need to read up on Python exception handling to figure that out for yourself
p32571
aV:-)
p32572
as(dp32573
g16
V100297
p32574
stp32575
a((dp32576
g2
(lp32577
VYou can use :
p32578
aVHere we simply look up  as a global, then loop over the rest of the names to do a  for each one on the result so far
p32579
aVDemo:
p32580
as(dp32581
g16
V100297
p32582
stp32583
a((dp32584
g2
(lp32585
VYou forgot to call , so your query was not executed at all:
p32586
aVIf this query doesn't return anything,  will be
p32587
aVTo debug why the query doesn't return anything, you could print the generated SQL to help you understand what SQLAlchemy is sending to the database:
p32588
as(dp32589
g16
V100297
p32590
stp32591
a((dp32592
g2
(lp32593
VYour 'accepted' state occurs when you call your function from the  statement:
p32594
aVwhich then continues to print
p32595
aVThe previous iteration did the same, so you call it again from iteration 4, printing  as well
p32596
aVPerhaps you meant to call that function only once there and store the result before testing and returning
p32597
as(dp32598
g16
V100297
p32599
stp32600
a((dp32601
g2
(lp32602
VYou appear to have to have newlines in your data
p32603
aVStrip those before printing and writing to the file:
p32604
as(dp32605
g16
V100297
p32606
stp32607
a((dp32608
g2
(lp32609
VYou can use  to only remove newlines from the end of the string:
p32610
aVThis leaves all other whitespace intact
p32611
aVIf you don't care about whitespace at the start and end of your lines, then the big heavy hammer is called
p32612
as(dp32613
g16
V100297
p32614
stp32615
a((dp32616
g2
(lp32617
VThere is no need to loop over ; a simple  test would suffice:
p32618
aVThis would perform better if you made  a set:
p32619
aVEither way, this code prints:
p32620
aVfor your example data
p32621
as(dp32622
g16
V100297
p32623
stp32624
a((dp32625
g2
(lp32626
VYou are expected to have stored the username somewhere else
p32627
aVThe keyring only stores the password, keyed by the application name and username
p32628
as(dp32629
g16
V100297
p32630
stp32631
a((dp32632
g2
(lp32633
VNo, you'd have to generate Python code instead where those classes are 'baked' to python code instead
p32634
aVUse some form of string templating where you generate Python source code, save those to  files, then bytecompile those
p32635
aVHowever, the class generation happens only once on startup
p32636
aVIs it really that great a cost to generate these
p32637
as(dp32638
g16
V100297
p32639
stp32640
a((dp32641
g2
(lp32642
VNo, you'd have to either set the global default timout with , or subclass the  class to add a custom timeout:
p32643
as(dp32644
g16
V100297
p32645
stp32646
a((dp32647
g2
(lp32648
VYou need to rename the  attribute or the  method, and add a  parameter to the method, but otherwise your code will work:
p32649
aVWith those changes, your code works:
p32650
aVHowever, that is not to say that this is a good architecture design
p32651
aVI'd say you need to move the responsibility to select a page to the  class instead, an most of all avoid replacing the class  with a global instance
p32652
as(dp32653
g16
V100297
p32654
stp32655
a((dp32656
g2
(lp32657
VBy turning them into integers instead:
p32658
aVIn python 3, the  function returns a string
p32659
aVAlways
p32660
aVThis is a change from Python 2; the  function was renamed to
p32661
as(dp32662
g16
V100297
p32663
stp32664
a((dp32665
g2
(lp32666
VYou need to match at least 2 character-space combos, but preceded by a word boundary (to ensure your first character is not the end of a word):
p32667
aVThis matches  and not :
p32668
as(dp32669
g16
V100297
p32670
stp32671
a((dp32672
g2
(lp32673
VBy default,  only matches ascii characters, it translates to
p32674
aVAnd matching UTF-8 bytes using regular expressions is hard enough, let alone only matching word characters, you'd have to match byte ranges instead
p32675
aVYou'll need to decode from UTF-8 to  and use the  flag instead:
p32676
aVHowever, you should really be using a HTML parser to deal with HTML instead
p32677
aVUse BeautifulSoup, for example
p32678
aVIt'll handle encoding and Unicode correctly for you
p32679
as(dp32680
g16
V100297
p32681
stp32682
a((dp32683
g2
(lp32684
VYes, by registering a  function:
p32685
aVThis replaces the default hook, which prints out the traceback to
p32686
aVIt is called whenever an uncaught exception is raised, and the interpreter is about to exit
p32687
aVIf you want to reuse the original exception hook from your custom hook, call :
p32688
as(dp32689
g16
V100297
p32690
stp32691
a((dp32692
g2
(lp32693
VYou just need to join your strings together, no formatting required:
p32694
aVNo need to overcomplicate things here
p32695
aV:-)
p32696
aVNote that when using , use a list comprehension over a generator expression (so include the ) as  will cast to a list anyway making the list comprehension faster
p32697
aVResult (last 3 lines):
p32698
aVYou could also use a -based grouper to simplify your loop:
p32699
aVwhere I enhanced your  function by moving the mapping out of the function (no need to define it each and every time you call it), and adding a  key (the grouper pads the last group with  values)
p32700
as(dp32701
g16
V100297
p32702
stp32703
a((dp32704
g2
(lp32705
VYou are not using anything recursively here, you are merely nesting expressions (which is fine)
p32706
aVYour problem is that you left the first  operator outside of the  call
p32707
aVYou are applying it not to a string, but to a return value here, and  returns
p32708
aVMove it inside the parenthesis:
p32709
as(dp32710
g16
V100297
p32711
stp32712
a((dp32713
g2
(lp32714
VThe grammar allows for multiple if statements because you can mix them between the for loops:
p32715
aVThe comprehension components should be viewed as nested statements, the above translates to:
p32716
aVThis also means that you can use multiple  statements without  loops in between:
p32717
aVAlthough non-sensical (just combine those using  or with chained operators), it does translate to a legal nested set of statements still:
p32718
aVThe grammar and parser do not specifically disallow such usage, in the same way that Python doesn't disallow you to nest  statements
p32719
as(dp32720
g16
V100297
p32721
stp32722
a((dp32723
g2
(lp32724
VIf you are already hiding the object from the navigation tree, you can filter on the same property by testing for :
p32725
aVIt is harder to filter out things that don't match a criteria
p32726
aVUsing a test on the brain object like the above is a perfectly fine way to remove a small subset from your result set
p32727
aVIf you need handle a larger percentage of 'exceptions' you'll need to rethink your architecture, perhaps
p32728
as(dp32729
g16
V100297
p32730
stp32731
a((dp32732
g2
(lp32733
VYou should make your groups non-capturing:
p32734
aVchanges behaviour when there are capturing groups
p32735
aVWith groups, it'll only return the groups, without capturing groups, the whole matched text is returned instead
p32736
aVDemo:
p32737
as(dp32738
g16
V100297
p32739
stp32740
a((dp32741
g2
(lp32742
VYou'd be much better off picking out specific cells in the table
p32743
aVThe  cells with the  class contain data you are interested in, and the last one is always the currency exchange rate:
p32744
aVWith the data in separate variables, you can now turn the text to decimal numbers, store them in a database, whatever
p32745
as(dp32746
g16
V100297
p32747
stp32748
a((dp32749
g2
(lp32750
VThe label is not going to update itself, you need to do so explicitly:
p32751
as(dp32752
g16
V100297
p32753
stp32754
a((dp32755
g2
(lp32756
VYou got confused with the operators;  is the correct boolean test,  is a binary bitwise operator instead:
p32757
aVAs a numeric operator, the  operator has a higher precedence than comparison operators, while the boolean operators have a lower precedence
p32758
aVThe expression  is thus interpreted as  instead, which is probably not what you wanted
p32759
aVYou can simplify your code somewhat:
p32760
as(dp32761
g16
V100297
p32762
stp32763
a((dp32764
g2
(lp32765
VSplit the line on whitespace using  and test if the first element starts with a string using :
p32766
aVFor older python versions, use a  call directly:
p32767
as(dp32768
g16
V100297
p32769
stp32770
a((dp32771
g2
(lp32772
VThis is not a JSON problem; your  reference is not what you think it is
p32773
aVMake sure you have a  object there, and not the  module, for example:
p32774
aVIf you use the correct type to test against, things work fine:
p32775
aVNote that the documentation expects the handler to raise a  instead of returning ; that way unserializable objects are at least treated as errors:
p32776
aVwould be more Pythonic and correct
p32777
as(dp32778
g16
V100297
p32779
stp32780
a((dp32781
g2
(lp32782
VYou are looking for the  method:
p32783
aVand
p32784
aVWith those fixes in place, your code then prints:
p32785
aVetc
p32786
as(dp32787
g16
V100297
p32788
stp32789
a((dp32790
g2
(lp32791
VIf you can extract just the weather tags easily, you can use the  API which comes with Python
p32792
aVIf you want to extract it from the HTML document, then it depends on how well-formed the HTML is
p32793
aVIf it is a XHTML document, the ElementTree API can handle it fine
p32794
aVOtherwise, you'll need to switch to a HTML parser instead
p32795
aVYou could install the  library; that library supports the same ElementTree API but has a dedicated HTML parser included
p32796
aVYou could also use BeautifulSoup for an alternate HTML API
p32797
aVIn fact,  and  can work in concert giving you a choice of APIs for your tasks; use whichever is easier for you
p32798
aVBoth   and  are external libraries
p32799
as(dp32800
g16
V100297
p32801
stp32802
a((dp32803
g2
(lp32804
VUse the  and  functions to turn characters to numbers, and vice versa
p32805
aVThe numbers for letters and digets correspond to the ASCII standard
p32806
aVTo turn that to numbers between 1 and 26, subtract 64, or use  (also 64)
p32807
aVAnother option is to use the  variable, which let you find the 'index' of a letter, 0-based:
p32808
aVYou can use either technique to create a mapping from letter to number, perhaps:
p32809
as(dp32810
g16
V100297
p32811
stp32812
a((dp32813
g2
(lp32814
VYes,  traverses subdirectories
p32815
aVIf you need counts grouped by the first two letters, I'd use a  class for that:
p32816
aVThis would traverse the subdirectories, and collect counts grouped by the first two characters of each filename encountered, then print those counts ordered by most to least common
p32817
aVIf you do not want to traverse subdirectories, use  instead; it returns just the names in a given directory (including both filenames and directory names)
p32818
aVYou could then use  to filter out those names that are just filenames:
p32819
aVIf you are looking for files with as specific extension, look for that extension instead of the  test; presumably no subdirectory is going to use the same extension:
p32820
as(dp32821
g16
V100297
p32822
stp32823
a((dp32824
g2
(lp32825
VThe third parameter is an options mapping
p32826
aVThis can contain arbitrary keyword parameters that will be passed to the extractor method
p32827
aVIt depends entirely on the extractor method what keyword parameters it'll accept
p32828
aVThe extractor is passed these options as the last parameter when called, usually called  in the method signature
p32829
aVThe Mako Babel plugin supports  and  for example
p32830
aVThe former seems to be a legacy spelling of the latter parameter, it's only used if  is not specified
p32831
aVAs such, each and every Babel plugin needs to document the supported options separately, the Babel project does not set limitations nor will it know the specifics that each plugin supports
p32832
aVThe specifics for the Mako extractor are documented in the Common Framework Integrations section:
p32833
aVThe Mako extractor supports an optional  parameter specifying the encoding of the templates (identical to /\u2018s  parameter)
p32834
as(dp32835
g16
V100297
p32836
stp32837
a((dp32838
g2
(lp32839
VI think you are looking for the  method instead
p32840
aVonly returns text directly contained at the start of the element:
p32841
aVThe  iterator on the other hand let's you find all text contained in the element, including inside nested elements
p32842
aVIf, however, you only want text directly contained in an element, skipping the contained children, you want the combination of  and the  values of each of the children:
p32843
aVIf you need to capture everything contained, then you need to do a little more work; capture the , and cast each child to text with :
p32844
aVtakes the element tail into account
p32845
aVI use  because the  attribute can be  as well
p32846
aVYou can capture that last method in a function:
p32847
as(dp32848
g16
V100297
p32849
stp32850
a((dp32851
g2
(lp32852
VLook at the  attribute:
p32853
aVDemo:
p32854
aVIf you want  to raise an exception for error codes (4xx or 5xx), call :
p32855
as(dp32856
g16
V100297
p32857
stp32858
a((dp32859
g2
(lp32860
VNope, it does not
p32861
aVUnder the hood,  uses  and  to list files and directories separately
p32862
aVSee the source code of
p32863
aVSpecifically:
p32864
aVwhere  and  are module globals for the  and  functions
p32865
aVIt calls itself recursively for subdirs
p32866
as(dp32867
g16
V100297
p32868
stp32869
a((dp32870
g2
(lp32871
VYou need to add a comma:
p32872
aVto make that a tuple, otherwise it is just an expression
p32873
aV1-element tuples can only be distinguished from expressions by the presence of a comma:
p32874
aVIn fact, it's the comma that defines tuples, not the parenthesis:
p32875
aVThe parenthesis are only needed when you need to define an empty tuple:
p32876
as(dp32877
g16
V100297
p32878
stp32879
a((dp32880
g2
(lp32881
VYou need to use a stack approach to track nesting levels:
p32882
aVThis will generate groups, cast to a list if you need one:
p32883
aVIf the brackets / parenthesis do not balance, an exception is raised:
p32884
as(dp32885
g16
V100297
p32886
stp32887
a((dp32888
g2
(lp32889
VYou need to use the proper git URL:
p32890
aVor
p32891
as(dp32892
g16
V100297
p32893
stp32894
a((dp32895
g2
(lp32896
VYou need to use sentinel values, then replace those with the desired instance attributes
p32897
aVis a good option:
p32898
aVNote that the function signature is executed only once; you cannot use expressions for default values and expect those to change with each call to the function
p32899
aVIf you have to be able to set  or  to  then you need to use a different, unique singleton value as the default instead
p32900
aVUsing an instance of  is usually a great sentinel in that case:
p32901
aVand now you can call  too
p32902
as(dp32903
g16
V100297
p32904
stp32905
a((dp32906
g2
(lp32907
V does not accept multiple arguments; you are probably missing parenthesis:
p32908
aVOther than that, use absolute paths, not relative, as you can easily write the file in an unexpected place otherwise
p32909
as(dp32910
g16
V100297
p32911
stp32912
a((dp32913
g2
(lp32914
VThe  module is really ancient, and should be considered unmaintained, really
p32915
aVYes, the  function does not handle changing the , and adding in method handling the way you suggest would work
p32916
aVThe work-around would be to not use the  function but instead use the  class directly
p32917
aVFeel free to add the patch to the Zope issue tracker
p32918
as(dp32919
g16
V100297
p32920
stp32921
a((dp32922
g2
(lp32923
VUse  to pair two lists:
p32924
aVBut sets are unordered so there is no 'second value'
p32925
aVYou can sort on the minimum value perhaps:
p32926
aVIf you need to sort it on the values of , do so before creating your sets:
p32927
aVBut if these are really x, y coordinates, then just use  and  to give you a sequence of tuples:
p32928
aVA  contains only unique values:
p32929
aVA tuple is an ordered (immutable) sequence instead:
p32930
as(dp32931
g16
V100297
p32932
stp32933
a((dp32934
g2
(lp32935
VIt accepts integers just fine, but you are returning the original string value
p32936
aVYou should either return  or assign to  instead:
p32937
as(dp32938
g16
V100297
p32939
stp32940
a((dp32941
g2
(lp32942
VIf the file is empty, then you are never entering your  loop, as there is nothing for the loop to iterate over
p32943
aVJust add a  at the end of the function for that edge case
p32944
aVYou also do not want to return yet when a line does not match the query, simply loop to the next line instead:
p32945
aVNote that your  statements are redundant; the function is exited immediately when a return statement is executed, the next line with the  statement is never reached
p32946
as(dp32947
g16
V100297
p32948
stp32949
a((dp32950
g2
(lp32951
VUse separate connections per thread, and SQLite will maintain data integrity
p32952
aVChanges to the database in one connection are not going to be visible in other threads until you a) commit the changes and b) a new transaction is started in the connections that want to see that new data
p32953
aVYou do want to set the  parameter of the connection to
p32954
as(dp32955
g16
V100297
p32956
stp32957
a((dp32958
g2
(lp32959
VYou could use xpath expressions for that:
p32960
as(dp32961
g16
V100297
p32962
stp32963
a((dp32964
g2
(lp32965
VYou want to return the result of your functions, not the functions themselves
p32966
aVOr rather, since all your functions return either  or , you want to return  if the function returned :
p32967
aVThis can be combined into a loop:
p32968
aVor you can use  to test all functions:
p32969
as(dp32970
g16
V100297
p32971
stp32972
a((dp32973
g2
(lp32974
VYou could use  and :
p32975
aVDemo:
p32976
as(dp32977
g16
V100297
p32978
stp32979
a((dp32980
g2
(lp32981
VThe  constructor either raises a  or a , depending on what was passed in
p32982
aVNot passing in any of the , , , , or  options raises a , passing in a value that is invalid raises a :
p32983
aVetc
p32984
aVIt will not fail silently
p32985
aVIt'll certainly never return
p32986
aVEither  is set to a  instance, or an exception is raised
p32987
as(dp32988
g16
V100297
p32989
stp32990
a((dp32991
g2
(lp32992
VYes
p32993
aVRemove the imports and run a linter on the module
p32994
aVI recommend using , although it may also create a lot of noise about style errors
p32995
aVMerely removing the imports and trying to run the code is probably not going to be enough, as many name errors won't be raised until you run just the right line of code with just the right input
p32996
aVA linter will instead analyze the code by parsing and will detect potential s without having to run the code
p32997
aVThis all presumes that there are no reliable unit tests, or that the tests do not provide enough coverage
p32998
aVIn this case, where there are multiple  lines, it gets a little more painful in that you need to figure out for each and every missing name what module supplied that name
p32999
aVThat will require manual work, but you can simply import the module in a python interpreter and test if the missing name is defined on that module:
p33000
aVYou do need to take into account that in this specific case, that there is overlap between the  and  modules; for any name defined in both modules, the module imported last wins
p33001
aVNote that leaving any  line in place means the linter will not be able to detect what names might raise NameErrors
p33002
as(dp33003
g16
V100297
p33004
stp33005
a((dp33006
g2
(lp33007
VNo, it does not print out the exact same thing
p33008
aVThere are no commas, and no parenthesis if you use the  part
p33009
aVIt'll be clearer if you expand the formatter
p33010
aVI suggest you use:
p33011
aVinstead
p33012
aVThe formatter acts as a template, each  acting as a place holder for the values in the tuple on the right-hand side
p33013
as(dp33014
g16
V100297
p33015
stp33016
a((dp33017
g2
(lp33018
VYou reinitialize  inside the loop
p33019
aVDon't do that, move that outside of the loop instead:
p33020
aVotherwise you end up resetting the list for each and every digit
p33021
as(dp33022
g16
V100297
p33023
stp33024
a((dp33025
g2
(lp33026
VIf  rebuilds the instance, then it'll also remove and re-build the  directory
p33027
aVIt's that directory that holds a few items that make a  fail; the daemon process that manages the restart is itself no longer complete
p33028
aVYou need to use  to stop the instance and the daemonizing process, followed by a  (which creates a fresh new daemon process)
p33029
as(dp33030
g16
V100297
p33031
stp33032
a((dp33033
g2
(lp33034
VUse :
p33035
aVThe difference between using  and  is what  will be set to
p33036
aVWhen calling the class directly,  is set to , using ,  will refer to
p33037
aVCompare your code (adjusted to use  to illustrate the difference):
p33038
aVand using :
p33039
as(dp33040
g16
V100297
p33041
stp33042
a((dp33043
g2
(lp33044
VYou have invalid HTML, and BeautifulSoup tried to fix that as best it could
p33045
aVNote the  tags are escaped, because they are not valid HTML closing tags
p33046
aVInstead, proper  tags have been added
p33047
as(dp33048
g16
V100297
p33049
stp33050
a((dp33051
g2
(lp33052
VYou are appending to a list in-place
p33053
aVLike all in-place mutation functions,  returns , so your final line:
p33054
aVultimately evaluates to:
p33055
aVJust set a copy of the list on the class:
p33056
aVwhere the  creates a copy of  by slicing from 0 to  in a short-hand notation without needing to loop
p33057
aVIf all you want to do is create an object that provides the keys and values as attributes (much like a  would yet with attribute access instead of item access), you could also use:
p33058
aVthen run:
p33059
aVwhich removes the need to call  in a loop
p33060
as(dp33061
g16
V100297
p33062
stp33063
a((dp33064
g2
(lp33065
VA generic method to merge 'columns', letting you specify what columns to expect and what to merge up front:
p33066
aVwhich you call with:
p33067
aVpassing in:
p33068
aVthe list of mappings
p33069
aVeach columns that makes up the output ( in the above example)
p33070
aVany column in the output that is composed of a merged list of input columns ( in the example, so  in the output is formed by merging  and )
p33071
aVOutput:
p33072
aVor, slightly reformatted:
p33073
aVInstead of calling  on the  generator, you can also just loop over it's output if all you need to do is process each row separately:
p33074
as(dp33075
g16
V100297
p33076
stp33077
a((dp33078
g2
(lp33079
VThe following is not advisable, and you'll hit plenty of problems and cornercases implementing your idea, but on Python 3
p33080
aV1 and onwards, you can hook into the custom class creation process by overriding the  built-in hook:
p33081
aVThis is limited to custom classes only, but does give you an all-powerful hook
p33082
aVFor Python versions before 3
p33083
aV1, you can forget hooking class creation
p33084
aVThe C  function directly uses the C-type  value if no metaclass has been defined, it never looks it up from the  module, so you cannot override it
p33085
as(dp33086
g16
V100297
p33087
stp33088
a((dp33089
g2
(lp33090
VInclude a key that indicates if the first character is uppercase or not:
p33091
aVsorts before  so words with a lowercase initial will be sorted before words with a capital initial
p33092
aVWords are otherwise sorted lexicographically
p33093
as(dp33094
g16
V100297
p33095
stp33096
a((dp33097
g2
(lp33098
VUse  (no brackets) to match the literal slash + digits:
p33099
aVResult:
p33100
aVYou were using a character group () where none was needed
p33101
aVThe pattern  matches exactly one of ,  or a digit
p33102
as(dp33103
g16
V100297
p33104
stp33105
a((dp33106
g2
(lp33107
VThe  keyword must be a callable
p33108
aVIt is called for every entry in the input sequence
p33109
aVA  is an easy way to create such a callable:
p33110
aVI would be extremely wary of sorting the output of  with many, large files though
p33111
aVmust read all lines into memory to be able to sort them
p33112
aVIf your files are many and / or large, you'll use up all memory, eventually leading to a  exception
p33113
aVUse a different method to pre-sort your logs first
p33114
aVYou can use a the UNIX tool , or use a external sorting technique instead
p33115
aVIf your input files are already sorted, you can merge them using the same key:
p33116
aVthen pass in your open file objects:
p33117
aVbut you need to make certain that the  function returns values as they are ordered in the input log files
p33118
as(dp33119
g16
V100297
p33120
stp33121
a((dp33122
g2
(lp33123
VYour terminal encoding is set to UTF8
p33124
aVYou are counting the bytes in the encoded character:
p33125
aVUse unicode to count characters instead of bytes:
p33126
aVor decode from the terminal encoding:
p33127
aVIn Python 3, strings are  values, with the Python 2  type renamed to  (your input is essentially the same as  in Python 3)
p33128
aVYou may want to read up on Python and Unicode:
p33129
aVThe Python Unicode HOWTO
p33130
aVPragmatic Unicode by Ned Batchelder
p33131
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p33132
aVby Joel Spolsky
p33133
as(dp33134
g16
V100297
p33135
stp33136
a((dp33137
g2
(lp33138
VYour function already prints, it does not return anything
p33139
aVDon't try to 'catch' the printed output, simply change the function to return the hand, formatted to a string:
p33140
aVwhich gives:
p33141
aVIf you are not supposed to change the  function, then use the same trick using in the function and do not print a newline by adding a comma to the end of the print statement:
p33142
as(dp33143
g16
V100297
p33144
stp33145
a((dp33146
g2
(lp33147
VThe  module was never added to the Python standard library
p33148
aVIt was only ever part of the PyXML distribution, but that has not seen any updates in years and I doubt it'll still work on Python 2
p33149
ag5279
aVInstead, just call the minidom  method on your document to pretty print the output, then write that data out to the file:
p33150
as(dp33151
g16
V100297
p33152
stp33153
a((dp33154
g2
(lp33155
VYou must make sure that whatever creates  has closed the file handle
p33156
aVFile writing is buffered, and if you do not close the file, the buffer is not flushed
p33157
aVThe missing data at the end of a file is still sitting in that buffer
p33158
aVPreferably you ensure that the file is closed by using the file object as a context manager:
p33159
as(dp33160
g16
V100297
p33161
stp33162
a((dp33163
g2
(lp33164
V objects have no  method
p33165
aVDrop that call, and the  call works:
p33166
as(dp33167
g16
V100297
p33168
stp33169
a((dp33170
g2
(lp33171
VUse ; it removes `empty' (falsey) values by default:
p33172
aVDemo:
p33173
as(dp33174
g16
V100297
p33175
stp33176
a((dp33177
g2
(lp33178
VUse the  syntax to match the closing parenthesis only if the opening parethesis matched:
p33179
aVThe  part matches  if there is a group 1 (the  no pattern is optional)
p33180
aVDemo:
p33181
as(dp33182
g16
V100297
p33183
stp33184
a((dp33185
g2
(lp33186
VThe dynamic nature of python makes this a next to impossible task
p33187
aVFunctions can import too, for example
p33188
aVAre you going to run all code in all modules
p33189
aVAnd then there are backward-compatibility tests; import  if  is not present, use a backport module if  isn't present in the current version of Python, etc
p33190
aVThere are platform-specific modules ( is ,  (same code but renamed) or  depending on the current platform), and whole-sale imports into the main module (, , ,  and  all can be used by the  module depending on the platform to supply functions)
p33191
aVPackages that use  declare their dependencies and are discoverable through the  library
p33192
aVThat's the limit of what you can reasonably discover
p33193
as(dp33194
g16
V100297
p33195
stp33196
a((dp33197
g2
(lp33198
VSimply find the one tag that matches, then take the  attribute:
p33199
as(dp33200
g16
V100297
p33201
stp33202
a((dp33203
g2
(lp33204
VA generator would do that for you in a jiffy:
p33205
aVwhich gives:
p33206
aVYou could just loop over the generator without creating a full list of course:
p33207
as(dp33208
g16
V100297
p33209
stp33210
a((dp33211
g2
(lp33212
VIf you want to replace the text in a file with the 'fixed' version, you have to either re-open the file, or open it in  (read + write) mode and truncate before writing:
p33213
aVIf you do not truncate the file first, then you run the risk of writing out too few new bytes
p33214
aVYou read  and write out , then your file ends up as  as the old data is not removed and was longer
p33215
as(dp33216
g16
V100297
p33217
stp33218
a((dp33219
g2
(lp33220
VYou can match multiple aspects, including using a regular expression for the attribute value:
p33221
aVwhich matches (for your example):
p33222
aVso any  tag with a  attribute that has a value that starts with the string
p33223
aVYou can loop over the results and pick out just the  attribute:
p33224
aVTo match all relative paths instead, use a negative look-ahead assertion that tests if the value does not start with a schem (e
p33225
ag1298
aVor ), or a double slash (); any such value must be a relative path instead:
p33226
as(dp33227
g16
V100297
p33228
stp33229
a((dp33230
g2
(lp33231
VYou are going about this the wrong way
p33232
aVTreat this character by character:
p33233
aVwhich gives me:
p33234
aVThe code sums each and every character separately, turning it back into a string and only using the last character of the result; 9 + 9 is 18, but the result would be
p33235
aVYour code would sum the whole numbers, but that would result in:
p33236
aVwhich is not the correct result
p33237
aVNeither did you ever turn your sum back into a string again, so your code, attempting to treat the sum result as a string by slicing it, gave an exception:
p33238
as(dp33239
g16
V100297
p33240
stp33241
a((dp33242
g2
(lp33243
VPyramid inspects the view using the  module (specifically the  call in the  function:
p33244
aVThe rest of the code then adjusts the code path to omit the context if the view doesn't accept a context
p33245
as(dp33246
g16
V100297
p33247
stp33248
a((dp33249
g2
(lp33250
VThe  code follows a standard set my the  Apache module
p33251
aVIf you implement the same algorithm and configure it on your Twisted server to use the same secret as used by your Pyramid server, you can decode that cookie, yes
p33252
aVIn fact, Pyramid re-used the  code from the Paste project to accomplish this, licensed under the very permissive MIT license
p33253
aVYou could probably reuse it for your Twisted application too; find it at the Paste bitbucket repository
p33254
aVThe  function just needs the server-side secret, the cookie value, the ip address of the remote connection and optionally the hash algorithm used (MD5 is the default)
p33255
as(dp33256
g16
V100297
p33257
stp33258
a((dp33259
g2
(lp33260
VYou have a class  but never create an instance of that
p33261
aVCreate an instance instead:
p33262
as(dp33263
g16
V100297
p33264
stp33265
a((dp33266
g2
(lp33267
VYou are trying to concatenate the  exception to the string
p33268
aVJust use a comma instead:
p33269
aVwhich will include the word  already, so a simple:
p33270
aVshould suffice
p33271
aVYou probably are getting s because you are using relative filenames, but your source files are listed in a subdirectory;  lists only the base filenames, directories are not included
p33272
aVUse  to construct paths instead, string formatting for other strings:
p33273
as(dp33274
g16
V100297
p33275
stp33276
a((dp33277
g2
(lp33278
VNo need to use a regular expression:
p33279
aVwhich produces:
p33280
aVYou could do this with a generator too:
p33281
as(dp33282
g16
V100297
p33283
stp33284
a((dp33285
g2
(lp33286
VThis one is a little tricky
p33287
aVThe  module is implemented in a C module,
p33288
aVAt the end of that file there is a specific Python library structure that defines  as implemented by :
p33289
aVbut  itself is actually defined via the  macro, using the  wrapper function to call the C library  function with some error handling and type conversion:
p33290
aVHowever, the C function implementation itself is entirely platform dependent, and on modern hardware is usually taken care of in hardware
p33291
aVYou would have to turn to a software version of the function to find a starting point to implement this in Python
p33292
aVYou could use the  implementation as such a starting point, perhaps, here is a link to the  function implementation in C from that library:
p33293
aVhttp://www
p33294
aVnetlib
p33295
aVorg/fdlibm/e_exp
p33296
ag528
aVor you could refer to this implementation instead:
p33297
aVhttp://fossies
p33298
aVorg/dox/glibc-2
p33299
aV17/sysdeps_2ieee754_2ldbl-128ibm_2e__expl_8c_source
p33300
aVhtml#l00135
p33301
as(dp33302
g16
V100297
p33303
stp33304
a((dp33305
g2
(lp33306
VYou renamed , giving it a different value
p33307
aVDon't do that, you shadowed the built-in type
p33308
aVChange your code to use a different name instead:
p33309
aVand then  works just fine
p33310
as(dp33311
g16
V100297
p33312
stp33313
a((dp33314
g2
(lp33315
VUse the  module instead of the  module; the latter is for complex numbers only:
p33316
aVFor what it's worth, the  result is correct, if you expected a complex number
p33317
aVYou could take just the  component of the result, but since there is a regular floating point equivalent in the  module there is no point in having your computer do the extra work
p33318
as(dp33319
g16
V100297
p33320
stp33321
a((dp33322
g2
(lp33323
VUse regular expressions to find numbers that follow the literal text  plus optional whitespace:
p33324
aVThis works regardless of what follows the digits:
p33325
aVIf you need to find multiple matches, use  instead:
p33326
aVwhich gives you a list of all digit groups that follow the literal text :
p33327
as(dp33328
g16
V100297
p33329
stp33330
a((dp33331
g2
(lp33332
VYou could build a custom class, using  to limit the amount of memory used perhaps:
p33333
aVthen use those in your structure
p33334
aVThey can be used just like named tuples (allow access by index and by name) but they allow mutation
p33335
aVBy using  the memory footprint of each instance remains low:
p33336
aVYou of course give the slots meaningful names, and please do pick a better name for your class than what I used in my example
p33337
aV:-)
p33338
aVTo expand on the  pattern, here is a generic factory function:
p33339
as(dp33340
g16
V100297
p33341
stp33342
a((dp33343
g2
(lp33344
VYes, you probably want to go with regular expressions
p33345
aVYou may want to avoid reinventing the wheel though
p33346
aVThe MoinMoin python wiki platform already implements various format handlers, including a Media Wiki format handler that indeed uses regular expressions to parse the input text
p33347
aVTo borrow from that implementation, it uses the regular expression:
p33348
aVto match a line with 1 or more  characters, followed by text, followed by the same number of  characters
p33349
aVThis uses the verbose regex syntax with the  flag (where whitespace is ignored)
p33350
aVUsing that regular expression you can match headers and figure out their 'level' by counting the number of  characters:
p33351
aVA non-verbose version would be:
p33352
aVUse that as a starting point (read the  module documentation carefully until you understand what each part does), then expand from there
p33353
as(dp33354
g16
V100297
p33355
stp33356
a((dp33357
g2
(lp33358
VJust test if the tuple of the pair exists:
p33359
aVThere is no need to loop through all the keys in the dictionary; a python dictionary is much more efficient at finding matching keys if you just give it the key to look for, but it has to be the same type
p33360
aVYour dictionary keys are tuples, so look use a tuple key when searching
p33361
aVIn fact, in python dictionaries, lists are not allowed as keys because they are mutable; you would not be able to search for keys accurately if the keys themselves can be changed
p33362
as(dp33363
g16
V100297
p33364
stp33365
a((dp33366
g2
(lp33367
VThe  method returns a list of matches
p33368
aVIf you wanted one result, use the  method instead
p33369
aVAlternatively, pick out a specific element like the rest of the code does, or loop over the results:
p33370
aVor
p33371
aVor
p33372
as(dp33373
g16
V100297
p33374
stp33375
a((dp33376
g2
(lp33377
VYour approaches are more or less equivalent; option 2 does a little more work; it has to do an extra store and name lookup for the temporary variable
p33378
aVIn practice, the difference is minimal and you should be focusing on code readability more than premature optimization
p33379
aVFor your specific example you'd be much better off using a list comprehension:
p33380
aVThe list comprehension constructs the list in C code and does not have to look up the  method each loop iteration
p33381
as(dp33382
g16
V100297
p33383
stp33384
a((dp33385
g2
(lp33386
VYou need to append your next item to the list, if the list already exists
p33387
aVThe easiest way to have the list already be there even for the first time you find a word, is to use the  class to track your word-to-lines mapping:
p33388
aVI've simplified your code a little using best practices; opening the file as a context manager so it'll close automatically when done, and using  to create line numbers on the fly
p33389
aVYou could speed this up a little further still (and make it more accurate) if you turned your lines into a set of words ( perhaps, but that won't remove punctuation), as then you could use set intersection tests against  (also a set), which could be considerably faster to find matching words
p33390
as(dp33391
g16
V100297
p33392
stp33393
a((dp33394
g2
(lp33395
VFrom the traceback it is clear you are not using a Django version installed in a virtual env; it is using the version installed in  instead
p33396
aVThe configuration is for Django 1
p33397
aV4, but the Ubuntu installation you are using is running Django 1
p33398
aV3 or older instead
p33399
aVYou need to make sure you are using a virtualenv configured to run without site packages
p33400
as(dp33401
g16
V100297
p33402
stp33403
a((dp33404
g2
(lp33405
VYou are using commas where you shouldn't, creating tuples by accident:
p33406
aVGet rid of those commas and your code will work
p33407
aVA comma creates a tuple in Python:
p33408
as(dp33409
g16
V100297
p33410
stp33411
a((dp33412
g2
(lp33413
VYou could convert the set to a list, just for printing:
p33414
aVor you could use  to join the contents of the set with a comma:
p33415
as(dp33416
g16
V100297
p33417
stp33418
a((dp33419
g2
(lp33420
VUse a tuple for the parameters:
p33421
aVThe parameters are supposed to be a tuple or a list (a sequence); but a string is a sequence too (it has a length and you can address the individual characters), so you gave the  call a sequence of  characters instead of one parameter
p33422
aVApparenty the username is 3 characters long, hence the error message
p33423
as(dp33424
g16
V100297
p33425
stp33426
a((dp33427
g2
(lp33428
VYou probably have a tab-delimited file
p33429
aVUse the  module to read that:
p33430
as(dp33431
g16
V100297
p33432
stp33433
a((dp33434
g2
(lp33435
VSure it is possible
p33436
aVJust store the strings and call  on them later:
p33437
aVis just a method on a string, only when you call that method will the string be interpreted as a template
p33438
aVJust like  and , you can call that method on any string object at a time of your choosing
p33439
as(dp33440
g16
V100297
p33441
stp33442
a((dp33443
g2
(lp33444
VYou may need to synchronize access to a dictionary object when your keys are not unique per thread
p33445
aVAccess is not necessarily thread safe
p33446
aVYou can always use the  (disassembler) module to verify any python code; python thread context can switch between any opcode (opcodes themselves are executed atomically); access to a dict can be spread over several opcodes:
p33447
aVThere are 4 opcodes involved with the  line, loading the  reference, loading the  and  constants, and calling the store operation
p33448
aVThread contexts can be switched between any of these opcodes
p33449
aVThat said, if your keys are guaranteed to be unique per thread, you could get away with not locking the structure; like all opcodes, the  opcode is executed by the python interpreter under the GIL, so multiple threads storing in and reading information from their own key should be safe
p33450
aVThe Python standard library library does this in a few locations; using  as a dictionary key to store per-thread information in a dictionary
p33451
aVThe  module for example, keeps a  module-global dictionary keyed on thread identifiers
p33452
as(dp33453
g16
V100297
p33454
stp33455
a((dp33456
g2
(lp33457
VThis is due to comparison operator chaining
p33458
aVFrom the documentation:
p33459
aVComparisons can be chained arbitrarily, e
p33460
ag1298
aV,  is equivalent to , except that  is evaluated only once (but in both cases  is not evaluated at all when  is found to be false)
p33461
aVYou are assuming that the  expression is executed as  but that is not the case
p33462
aVInstead, python evaluates that as  instead, and the latter part is never True
p33463
aVYou really want to use the  operator, and avoid naming your variables :
p33464
as(dp33465
g16
V100297
p33466
stp33467
a((dp33468
g2
(lp33469
VYou can simply split these lines on the first space:
p33470
aVNow you can further process this information
p33471
aVIf you want to use this to query a database, I would not generate the SQL query text
p33472
aVInstead use SQL parameters:
p33473
aVThis has several advantages:
p33474
aVYou don't have to worry about how to properly escape the parameters
p33475
aVThis is important when preventing SQL injection attacks, but also when dealing with arbitrary data from a file where input data could potentially contain SQL-specific special characters
p33476
aVThe database is given the opportunity to prepare the statement, creating a query plan that can be reused for future queries
p33477
aVIf you are doing a lot of such queries, that makes a huge difference
p33478
as(dp33479
g16
V100297
p33480
stp33481
a((dp33482
g2
(lp33483
VUse separate metadata instances for different databases:
p33484
as(dp33485
g16
V100297
p33486
stp33487
a((dp33488
g2
(lp33489
VInstead of testing if your input string is in the line, test if your input string is in any of the columns
p33490
aVThe  function is ideally suited for that:
p33491
aVTo break this down a little: each line in your  iterable is itself a list of columns, you can loop over these
p33492
aVdoes just that
p33493
aVWe test if  is present in each column with , and  will execute the loop until it finds a column where  is , in which case it stops iterating over the loop and returns  itself
p33494
aVIf no match was found  is returned instead
p33495
as(dp33496
g16
V100297
p33497
stp33498
a((dp33499
g2
(lp33500
VYou could use a regular expression in this case, yes:
p33501
aVwould match any text starting with  followed by two 4-digit numbers
p33502
aVThe grouping allows you to extract that number:
p33503
aVI do notice that usually the CVE number is prefixed by the text ; a regular expression that would match both forms would be:
p33504
aVUsing a regular expression would allow you to pick out such URLs from a full body of text
p33505
aVIf you are using a proper HTML parser on the other hand, I'd recommend parsing the URLs for constituent parts instead
p33506
as(dp33507
g16
V100297
p33508
stp33509
a((dp33510
g2
(lp33511
VOn Python 2, you must inherit from  for properties to work:
p33512
aVto make it a new-style class
p33513
aVWith that change your code works:
p33514
as(dp33515
g16
V100297
p33516
stp33517
a((dp33518
g2
(lp33519
VFirst of all: You generally want to avoid using regular expressions to parse HTML
p33520
aVYou really want to use a HTML parser instead
p33521
aVBeautifulSoup lets you search for elements with a certain text contained (even using regular expressions for matching specific aspects found in the HTML)
p33522
aVYou can combine regular expressions using the  pipe, in a group:
p33523
as(dp33524
g16
V100297
p33525
stp33526
a((dp33527
g2
(lp33528
VYou can't use assignment in an expression, it is a statement
p33529
aVA  can only contain one expression, and statements are not included
p33530
aVYou can assign to the map though, by using the  function instead:
p33531
as(dp33532
g16
V100297
p33533
stp33534
a((dp33535
g2
(lp33536
VYou can't, because you do not have a reference to the function object
p33537
aVIt's the function object that has the  attribute, not the associated code object
p33538
aVYou'd have to use the filename and linenumber information to try and make an educated guess as to what the docstring might be, but due to the dynamic nature of Python that is not going to be guaranteed to be correct and current
p33539
as(dp33540
g16
V100297
p33541
stp33542
a((dp33543
g2
(lp33544
VYou have UTF-16 encoded data, albeit without a BOM (Byte Order Mark)
p33545
aVDecode to Unicode first before attempting to match the regex:
p33546
aVI had to remove the last byte to make that decode though, a null byte at the end was missing
p33547
aVIf you are missing data from the end, you are most likely also missing the data from the start, where the BOM would be located
p33548
aVThe BOM tells the decoder what variant of UTF-16 was used to encode (little or big endian), without it we need to explicitly tell Python to decode this as little endian
p33549
aVIf you decode the full data, including the BOM, you could just use  instead
p33550
aVIf you are reading this from a file, use  instead and have Python decode it to Unicode for you:
p33551
aVbecause otherwise things like  splits newlines at the byte level, which are encoded to two bytes just like everything else in UTF-16
p33552
as(dp33553
g16
V100297
p33554
stp33555
a((dp33556
g2
(lp33557
VYou could test with  and a generator expression:
p33558
aVThe  function loops over the included generator expression testing that it'll onl contain  values, but will stop if it comes across a  (where  is equal to )
p33559
aVThis saves having to loop through all of  to find out if  is already present
p33560
as(dp33561
g16
V100297
p33562
stp33563
a((dp33564
g2
(lp33565
VYou need to bind the value of  to the scope of the lambda you create
p33566
aVOr rather, you want to bind the  result to the lambda:
p33567
aVNow each lambda has a keyword parameter storing the then-current value of
p33568
aVBecause the  parameter is a keyword parameter with a default value, your lambdas still work when called with arguments
p33569
aVThe alternative would be to create a new function scope:
p33570
as(dp33571
g16
V100297
p33572
stp33573
a((dp33574
g2
(lp33575
VThe deletion has to take place in the outer scope:
p33576
aVThe compile-time restriction has been removed in Python 3:
p33577
aVInstead, a  is raised when you try to refer to :
p33578
aVI am tempted to file a documentation bug here
p33579
aVFor Python 2, the documentation is misleading; it is deleting a variable used in a nested scope that triggers the compile-time error, and the error is no longer raised at all in Python 3
p33580
as(dp33581
g16
V100297
p33582
stp33583
a((dp33584
g2
(lp33585
VYou are testing for the wrong thing, use:
p33586
aVor perhaps:
p33587
aVThe expression  is interpreted as:
p33588
aVand a non-empty string is always considered  in python
p33589
as(dp33590
g16
V100297
p33591
stp33592
a((dp33593
g2
(lp33594
VThe proper procedure is to raise the new exception inside of the  handler
p33595
aVYou should not raise the exception that was passed in though; to allow for context manager chaining, in that case you should just return a falsey value from the handler
p33596
aVRaising your own exceptions is however perfectly fine
p33597
aVNote that it is better to use the identity test  to verify the type of the passed-in exception:
p33598
as(dp33599
g16
V100297
p33600
stp33601
a((dp33602
g2
(lp33603
VYou can only add supported attributes to nodes and edges
p33604
aVThese attributes have specific meaning to GrpahViz
p33605
aVTo show extra information on edges or nodes, use the  attribute
p33606
as(dp33607
g16
V100297
p33608
stp33609
a((dp33610
g2
(lp33611
VIn python, boolean AND is spelled :
p33612
aVIn this case, you can use comparison operator chaining:
p33613
aVand forgo the boolean test altogether
p33614
aVThis is essentially the same as  except the expression in the middle is evaluated only once
p33615
as(dp33616
g16
V100297
p33617
stp33618
a((dp33619
g2
(lp33620
VDo not use  and concatenation, that is what  is for
p33621
aVDepending on the type of  pick one of:
p33622
aVdepending on the type of number you have
p33623
as(dp33624
g16
V100297
p33625
stp33626
a((dp33627
g2
(lp33628
VI'd use the  library:
p33629
as(dp33630
g16
V100297
p33631
stp33632
a((dp33633
g2
(lp33634
VYou didn't name your initializers correctly, it needs double underscores on either end:
p33635
aVYou need to correct that for all your classes
p33636
aVBecause you didn't name them correctly, they are not being run when you create an instance of your classes
p33637
aVNext problem you'll run into is your  initializer; you cannot address indexes in an empty list
p33638
aVCreate the whole list in one go instead:
p33639
as(dp33640
g16
V100297
p33641
stp33642
a((dp33643
g2
(lp33644
VDon't try to look up local variables from a string
p33645
aVJust store your doctors and supervisors in a nested dictionary:
p33646
aVwhich results in:
p33647
aVIn the rare case that you do need to refer to a local variable dynamically, you can do that with the  function, it returns a dictionary mapping local names to values
p33648
aVNote that within functions, changes to the  mapping are not reflected in the function local namespace
p33649
as(dp33650
g16
V100297
p33651
stp33652
a((dp33653
g2
(lp33654
VLooping over the dictionary is the only real choice you have, there is no more efficient method
p33655
aVOr you could use a different data structure; storing integers connected to values in a btree structure for example would make searching for keys greater than or lower than a given search value much more efficient
p33656
as(dp33657
g16
V100297
p33658
stp33659
a((dp33660
g2
(lp33661
VDon't use , just store the strings in a list and write the strings to your file:
p33662
as(dp33663
g16
V100297
p33664
stp33665
a((dp33666
g2
(lp33667
VYou want to specify the  keyword parameter instead:
p33668
aVYou probably meant to make  the run target, but  the argument when started:
p33669
aVThe first parameter to  is the  argument, and it currently only accepts  as the argument
p33670
aVFrom the  documentation:
p33671
aVThis constructor should always be called with keyword arguments
p33672
aVArguments are:
p33673
aVgroup should be ; reserved for future extension when a  class is implemented
p33674
aVtarget is the callable object to be invoked by the  method
p33675
aVDefaults to , meaning nothing is called
p33676
as(dp33677
g16
V100297
p33678
stp33679
a((dp33680
g2
(lp33681
VYou are grouping on both the date and the status line; most likely the status line differs between the two results
p33682
aVEither include that status line in your output, or remove it from the group and output columns altogether
p33683
aVIncluding the status line:
p33684
aVwould show what differs
p33685
aVRemoving the column from the group and columns list:
p33686
aVInstead of , you could also use ; it is usually implemented as a LIKE but you don't have to do the  concatenation yourself
p33687
as(dp33688
g16
V100297
p33689
stp33690
a((dp33691
g2
(lp33692
VYou can capture the filter on  separately first; I am assuming you have models for all the tables that match the table name, using camelcase
p33693
aVThe menu_id and keyword selects are also stored for reuse:
p33694
aVNow you can apply these selects for all your deletion queries:
p33695
aVThese examples are using the  method with the select statements, turning the latter into subselects, to produce queries like:
p33696
aVwith the  parameter set to
p33697
as(dp33698
g16
V100297
p33699
stp33700
a((dp33701
g2
(lp33702
VAliases are for tables; columns in a query are given a label instead
p33703
aVThis trips me up from time to time too
p33704
aVYou can go about this two ways
p33705
aVIt is sufficient to store the  result is a local variable first and reuse that:
p33706
aVThe SQL produced would still be the same as your own code would generate, but at least you don't have to type out the  call twice
p33707
aVTo give this column an explicit label, call the  method on it:
p33708
aVand you can then use that same label string in the  clause:
p33709
aVor you could use the  attribute:
p33710
as(dp33711
g16
V100297
p33712
stp33713
a((dp33714
g2
(lp33715
VBecause the default  cannot know what statements were used to create the class
p33716
aVThe documentation you quote starts with If at all possible
p33717
aVSince it is not possible to represent custom classes in a way that lets you recreate them, a different format is used, which follows the default for all things not easily recreated
p33718
aVIf  were to just return , that'd be meaningless
p33719
aVYou are not recreating , you'd just be referencing it then
p33720
aVwould be closer to reflecting the class constructor, but that'd be a) confusing for people not familiar with the fact python classes are instances of  and b) never able to reflect methods and attributes accurately
p33721
aVCompare the output to that of  or  instead, these follow the same pattern
p33722
as(dp33723
g16
V100297
p33724
stp33725
a((dp33726
g2
(lp33727
V in the request is the sequence of objects that where traversed over to get to the published object
p33728
aVYou cannot rely on that value if you need to index your objects, as they are not going to be published
p33729
aVInstead use their acquisition chain:
p33730
as(dp33731
g16
V100297
p33732
stp33733
a((dp33734
g2
(lp33735
VYou always want to open a file in binary mode when writing binary data:
p33736
aVEspecially on Windows, opening a file in text modus leads to newlines being translated into platform-native values on write, but that is not desirable behaviour for binary data
p33737
aVFrom the  function documentation:
p33738
aVThe default is to use text mode, which may convert  characters to a platform-specific representation on writing and back on reading
p33739
aVThus, when opening a binary file, you should append  to the mode value to open the file in binary mode, which will improve portability
p33740
aV(Appending  is useful even on systems that don\u2019t treat binary and text files differently, where it serves as documentation
p33741
as(dp33742
g16
V100297
p33743
stp33744
a((dp33745
g2
(lp33746
VFor , call:
p33747
aVto raise the threshold to infinity
p33748
aVSee the  documentation for more details
p33749
aVFor Python 3, use  instead:
p33750
as(dp33751
g16
V100297
p33752
stp33753
a((dp33754
g2
(lp33755
VYour data is unicode data
p33756
aVTo write that to a file, use :
p33757
aVbut that would remove anything that isn't ASCII
p33758
aVPerhaps you wanted to encode to a more suitable encoding, like UTF-8, instead
p33759
aVYou may want to read up on Python and Unicode:
p33760
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p33761
aVby Joel Spolsky
p33762
aVThe Python Unicode HOWTO
p33763
aVPragmatic Unicode by Ned Batchelder
p33764
as(dp33765
g16
V100297
p33766
stp33767
a((dp33768
g2
(lp33769
VYour XML file uses a default namespace
p33770
aVYou need to qualify your searches with the correct namespace:
p33771
aVfor ElementTree to match the correct elements
p33772
aVYou could also give the ,  and  methods an explicit namespace dictionary
p33773
aVThis is not documented very well:
p33774
aVPrefixes are only looked up in the  parameter you pass in
p33775
aVThis means you can use any namespace prefix you like; the API splits off the  part, looks up the corresponding namespace URL in the  dictionary, then changes the search to look for the XPath expression  instead
p33776
aVIf you can switch to the  library things are better; that library supports the same ElementTree API, but collects namespaces for you in a  attribute on elements
p33777
as(dp33778
g16
V100297
p33779
stp33780
a((dp33781
g2
(lp33782
VUse the  type you imported but otherwise ignore:
p33783
aVresults in:
p33784
aVis a subclass of  and behaves in the same way otherwise
p33785
as(dp33786
g16
V100297
p33787
stp33788
a((dp33789
g2
(lp33790
VNo, access to globals is not thread-safe
p33791
aVThreads do not get their own copy of globals, globals are shared among threads
p33792
aVThe code:
p33793
aVcompiles to several python bytecode statements:
p33794
aVA thread switch can occur after each and every bytecode execution, so another thread could alter  after you tested it
p33795
as(dp33796
g16
V100297
p33797
stp33798
a((dp33799
g2
(lp33800
VUse  as the sign modifier to include a space for the sign:
p33801
aVNote the space after the  colon
p33802
aVThis causes positive numbers to be padded with a space on the left, negative numbers display a  instead
p33803
as(dp33804
g16
V100297
p33805
stp33806
a((dp33807
g2
(lp33808
VIf it is per-request data, store it on the request object itself
p33809
aV:-)
p33810
aVSee Per-request cache in Django
p33811
aVfor some techniques to do so
p33812
as(dp33813
g16
V100297
p33814
stp33815
a((dp33816
g2
(lp33817
VYou need to call the  method:
p33818
as(dp33819
g16
V100297
p33820
stp33821
a((dp33822
g2
(lp33823
VUse the proper data type for the job
p33824
aVYour goal should be to have workable code, not that you use the same data type all over the place
p33825
aVIf your dictionary only contains one key and one value, you can get either with indexing:
p33826
aVor to get both:
p33827
aVThe  calls are needed because in Python 3, ,  and  return dict views, not lists
p33828
aVAnother option is to use sequence unpacking:
p33829
aVor for both at the same time:
p33830
as(dp33831
g16
V100297
p33832
stp33833
a((dp33834
g2
(lp33835
VYou could use a list comprehension:
p33836
aVor you could adjust your loop to create a new tuple:
p33837
as(dp33838
g16
V100297
p33839
stp33840
a((dp33841
g2
(lp33842
VPut them where you feel they can most easily be maintained
p33843
aVUsually that means in the module to which the constants logically belong
p33844
aVYou can always import the constants into the  file of your package to make it easier for someone to find them
p33845
aVIf you did decide on a  module, I'd add a  sequence to state what values are public, then in the  file do:
p33846
aVto make the same names available at the package level
p33847
as(dp33848
g16
V100297
p33849
stp33850
a((dp33851
g2
(lp33852
VIt'll be easier if you use a character group of , there is no need to group the two 'free' characters:
p33853
aVor you need to group the :
p33854
aVApplying the first form to your examples:
p33855
aVIn your attempt, the expression matches either an , or the expression  because the  symbol applies to everything that preceeds or follows it within the same group
p33856
aVAs it is not grouped, it applies to the whole expression instead:
p33857
aVIf you need to match a certain amount of characters in your whole match, you need to tailor those 3 character  groups to match a minimum number of times:
p33858
aVwould match  or  followed by 2 characters, followed by  with another 2 characters, then at least 7 times 3 characters (total 21), followed by a specific pattern of 3 more (,  or ) for a total of at least 33 characters from the first to the last character
p33859
aVThe extra  make up the pattern of 3 after  and matches your example from your comment:
p33860
aVas well as correctly handling the examples given in your question:
p33861
as(dp33862
g16
V100297
p33863
stp33864
a((dp33865
g2
(lp33866
VWhen you throw an exception, the code flow is always interrupted
p33867
aVYou cannot resume an interrupted generator once you throw an exception in it
p33868
aVFrom PEP 342 (Coroutines via Enhanced Generators):
p33869
aVAs with the  method, the  method returns the next value
p33870
aVyielded by the generator-iterator, or raises  if the
p33871
aVgenerator exits normally, or has already exited
p33872
aVIf the generator
p33873
aVraises an uncaught exception, it is propagated to 's caller
p33874
aVAs for the debugger jumping to the  line: you just threw an exception and the interpreter is testing if the exception is caught by that line or not
p33875
aVBecause it'll only catch a , the generator exits at that point
p33876
as(dp33877
g16
V100297
p33878
stp33879
a((dp33880
g2
(lp33881
VYou are misunderstanding the  expression
p33882
aVUse this instead:
p33883
aVor, if you must test against multiple options, use :
p33884
aVor, if you must use  then use it like this:
p33885
aVand expand this to your other  tests
p33886
aVis interpreted as , with the latter part always being True
p33887
aVEven if it was interpreted as  then the latter part would evaluate to  only (it being True as far as boolean tests go), so you'd be testing if  instead, and setting  to  would never make the test pass
p33888
as(dp33889
g16
V100297
p33890
stp33891
a((dp33892
g2
(lp33893
VYou wanted:
p33894
aVwhich would find the first  tag with the  class, then traverse to the first H1 tag inside of it:
p33895
as(dp33896
g16
V100297
p33897
stp33898
a((dp33899
g2
(lp33900
VPlease don't use  when  would do:
p33901
aVYou are testing the wrong variable; test  instead:
p33902
as(dp33903
g16
V100297
p33904
stp33905
a((dp33906
g2
(lp33907
VUse a  call with  as the filter (tests for truth, so non-emptyness):
p33908
aVor a list comprehension:
p33909
aVIf you need to explicitly allow other 'false' values and only want to filter out empty strings, use:
p33910
as(dp33911
g16
V100297
p33912
stp33913
a((dp33914
g2
(lp33915
VUse  to combine the names and the values
p33916
aVWith a list comprehension:
p33917
aVwhich gives:
p33918
as(dp33919
g16
V100297
p33920
stp33921
a((dp33922
g2
(lp33923
VTreat  as a set instead, so you can use dictionary views and an intersection:
p33924
aVOr you could use a simple dict comprehension with a  test against :
p33925
aVThis presumes that not all values in  are going to be in ; the  test can be dropped if they are always going to be present
p33926
aVFor your specific case, the second form is quite a lot faster:
p33927
as(dp33928
g16
V100297
p33929
stp33930
a((dp33931
g2
(lp33932
VLimit your link pattern to non-quote characters:
p33933
aVgiving:
p33934
aVBetter yet, use a proper HTML parser
p33935
aVUsing BeautifulSoup, finding that link would be as easy as:
p33936
aVfor an exact text match:
p33937
as(dp33938
g16
V100297
p33939
stp33940
a((dp33941
g2
(lp33942
VYou need to escape any special characters like a parenthesis:
p33943
aVotherwise they'll be interpreted as regular expression characters instead
p33944
as(dp33945
g16
V100297
p33946
stp33947
a((dp33948
g2
(lp33949
VNo, if you have to support both arbitrary attribute lookup on the class as well as the instance, then your only option is to implement a  hook method on both the metaclass and the class, one each to support lookups on the class and the instance
p33950
aVThis is because special hook methods are always looked up on the type, so
p33951
aVHence, for  the metaclass  is used
p33952
aVSee Special method lookup for new-style classes; I explained why this is in a previous answer
p33953
aVThe short reason is that in your case,  would translate into  and  is then an unbound method expecting two arguments ( and ), which would fail
p33954
as(dp33955
g16
V100297
p33956
stp33957
a((dp33958
g2
(lp33959
VCount the zipcodes per zone, then include that information in your mapping:
p33960
as(dp33961
g16
V100297
p33962
stp33963
a((dp33964
g2
(lp33965
VYou'll need to look for the  element by specifying the namespace:
p33966
aVYou have to pass in a  mapping on each search, so you could also just specify that up front and reuse:
p33967
aVFor your example document (with the namespaces restored), that gives:
p33968
aVYou could also use the namespace in an XPath expression:
p33969
aVwhich is what using a prefix and the  map does internally anyway
p33970
as(dp33971
g16
V100297
p33972
stp33973
a((dp33974
g2
(lp33975
VThe standard practice is to raise an exception, with the code instantiating your class catching and handling that exception:
p33976
aVthen:
p33977
as(dp33978
g16
V100297
p33979
stp33980
a((dp33981
g2
(lp33982
VIn your Python 3 example, you are interpolating into a Unicode string, not a byte string like you are doing in Python 2
p33983
aVIn Python 3,  do not support interpolation (string formatting or what-have-you)
p33984
aVEither concatenate, or use Unicode all through and only encode when you have interpolated:
p33985
aVor
p33986
aVor
p33987
as(dp33988
g16
V100297
p33989
stp33990
a((dp33991
g2
(lp33992
VYou could upgrade to BeautifulSoup version 4 and use :
p33993
aVIn BeautifulSoup 3, you need to search for all contained text instead:
p33994
as(dp33995
g16
V100297
p33996
stp33997
a((dp33998
g2
(lp33999
VYou are working with function-local names
p34000
aVSet attributes on the instance (via ) to share information between methods:
p34001
as(dp34002
g16
V100297
p34003
stp34004
a((dp34005
g2
(lp34006
VDo not try to concatenate  and :
p34007
aVor
p34008
aVor test if  is set to None explicitly:
p34009
as(dp34010
g16
V100297
p34011
stp34012
a((dp34013
g2
(lp34014
VPython is not looking in
p34015
aVInstead, Python is looking in the current directory
p34016
aVThe current directory is the first location in the  list of locations to look for an import
p34017
aVThe file  is in your local directory
p34018
aVNever run your python interpreter inside of your package (so make sure the current working directory is not in ), and otherwise never name a local module that has the same name as a standard library
p34019
as(dp34020
g16
V100297
p34021
stp34022
a((dp34023
g2
(lp34024
VThe  structure gives you access to the WSGI environment variable
p34025
aVIn WSGI apps, the content type header is named :
p34026
as(dp34027
g16
V100297
p34028
stp34029
a((dp34030
g2
(lp34031
VYou are registering the return value of the function instead of the function itself
p34032
aVInstead of calling it before registering, just pass in the function reference:
p34033
as(dp34034
g16
V100297
p34035
stp34036
a((dp34037
g2
(lp34038
VDon't
p34039
aVOpen the file in text mode and just let Python handle the newlines for you
p34040
aVWhen you use the  function you can set how Python should handle newlines with the  keyword parameter:
p34041
aVWhen writing output to the stream, if newline is , any  characters written are translated to the system default line separator,
p34042
aVIf newline is  or , no translation takes place
p34043
aVIf newline is any of the other legal values, any  characters written are translated to the given string
p34044
aVSo the default method is to write the correct line separator for your platform:
p34045
aVand does the right thing; on Windows  characters are saved instead of
p34046
aVIf you specifically want to write  only and not have Python translate these for you, use :
p34047
aVNote that  is exactly the same character as ;  is :
p34048
as(dp34049
g16
V100297
p34050
stp34051
a((dp34052
g2
(lp34053
VThe  statement returns values, not variables
p34054
aVAnd if nothing is done with the returned values, they are discarded
p34055
aVYou call  but do nothing with the values it returns
p34056
aVYou need to store the returned values in new names:
p34057
aVI used the same names as used in the  function itself, but I could just as well have given them different names:
p34058
aVand then used those names in the rest of the code:
p34059
as(dp34060
g16
V100297
p34061
stp34062
a((dp34063
g2
(lp34064
V takes a set of characters to remove
p34065
aVYou are removing all the , , , , ,  and  characters form the start and end
p34066
aVOnly  is then left
p34067
aVYou could split on  instead:
p34068
aVor you could explicitly remove the exact characters from the start and end with slicing:
p34069
as(dp34070
g16
V100297
p34071
stp34072
a((dp34073
g2
(lp34074
VYou forgot to close the parenthesis on the previous line:
p34075
aVCorrect that to:
p34076
aVWhen you get a syntax error, check the previous line too to make sure your parenthesis are balanced
p34077
as(dp34078
g16
V100297
p34079
stp34080
a((dp34081
g2
(lp34082
V loops through the list until it finds an element that is equal ( is True)
p34083
aVA dictionary lookup is much more efficient
p34084
aVIn CS terms,  is of O(n) complexity, dict lookups are O(1)
p34085
aVSee the Time Complexity overview on the Python Wiki
p34086
as(dp34087
g16
V100297
p34088
stp34089
a((dp34090
g2
(lp34091
VThe file contains one line, so there is no need to loop over the file, really
p34092
aVJust loop over the split list:
p34093
aVor just return the whole list; you've read it into memory already anyway:
p34094
aVIf you did have multiple lines with each line containing multiple names, you could nest loops:
p34095
as(dp34096
g16
V100297
p34097
stp34098
a((dp34099
g2
(lp34100
VBuildout will use packages already installed in your python  unless you tell it not to:
p34101
aVis set to  by default
p34102
aVYou can also whitelist what packages are allowed to be satisfied from your site-packages:
p34103
aVWhich would only allow the  and  packages to be taken from your site-packages but nothing else
p34104
aVsupports globs and is set to  by default
p34105
as(dp34106
g16
V100297
p34107
stp34108
a((dp34109
g2
(lp34110
VYou are using the binary  bitwise or operator where you should be using the  boolean operator instead:
p34111
aVshould be
p34112
aVor perhaps:
p34113
aVwhich is faster to boot
p34114
aVBecause the  operator has a different precedence than the  operator, the first statement was interpreted as  with  doing a bitwise logical operation, returning a result which is never going to be equal to both  and , so that always returns :
p34115
as(dp34116
g16
V100297
p34117
stp34118
a((dp34119
g2
(lp34120
VYou have a special type of dictionary, a
p34121
aVUsing the  method or  indexing will only ever get you the first value
p34122
aVYou need to use the  method instead:
p34123
as(dp34124
g16
V100297
p34125
stp34126
a((dp34127
g2
(lp34128
VLambdas can only hold expressions, so you are limited to ising a conditional expression:
p34129
aVbut that'll only return a 3-element tuple
p34130
aVThe  function can only ever take one element in the sequence into account
p34131
aVIf you always have a 2-element tuple following your 3-element tuples, you'd need to group them together, then determine the minimum from among those paired tuples (as unutbu's answer does)
p34132
as(dp34133
g16
V100297
p34134
stp34135
a((dp34136
g2
(lp34137
VYou want a dictionary for those lines, not local variables:
p34138
as(dp34139
g16
V100297
p34140
stp34141
a((dp34142
g2
(lp34143
VUse  to pair up the elements of each list:
p34144
aVgives:
p34145
aVYou could also first use  to remove all pairs where one or the other element is 0:
p34146
as(dp34147
g16
V100297
p34148
stp34149
a((dp34150
g2
(lp34151
VYou are trying to insert the function, not it's result
p34152
aVCall the function again:
p34153
aVIf  is a function as well, you'd need to call that too of course
p34154
as(dp34155
g16
V100297
p34156
stp34157
a((dp34158
g2
(lp34159
VYou are trying to index , but integers cannot be indexed; move the index syntax to index the result of the  index on :
p34160
aVWhat is happening is this:
p34161
as(dp34162
g16
V100297
p34163
stp34164
a((dp34165
g2
(lp34166
VDoes it really matter
p34167
aVThe effect is the same
p34168
aVNeither 10 nor 11 is included in the output of , and  is equivalent to
p34169
aVThe Python 2 range type (the result of ) stores the range length, not the end value, so to create the  output it calculates that end value for you
p34170
aVAnd because you used a step value, the calculation shows the result of the formula
p34171
aVFor the implementation, the length is the more important value, the  value can safely be discarded and recalculated as needed
p34172
aVSo, when you create , it calculates the range length and stores that instead of the end value:
p34173
aVThe Python 3 Range object stores the end value in addition to the length, so you can query the object for it and display it in the  output
p34174
as(dp34175
g16
V100297
p34176
stp34177
a((dp34178
g2
(lp34179
VUse a real list comprehension:
p34180
aVor just multiply the list as you did:
p34181
aVThe latter is safe in this case because tuples are not mutable
p34182
aVThe first option creates a new tuple for each iteration of the loop, the second option expands the list using  references to the same tuple
p34183
aVIf you used a mutable instead (say, a list or dict), then that could lead to unexpected results, but it does use less memory
p34184
as(dp34185
g16
V100297
p34186
stp34187
a((dp34188
g2
(lp34189
VIf you want  to be  then catch the exceptions raised by trying to access non-existing items:
p34190
as(dp34191
g16
V100297
p34192
stp34193
a((dp34194
g2
(lp34195
VNo, it is not
p34196
aVYou need to add a comma:
p34197
aVIt is the comma that makes this a tuple
p34198
aVThe parenthesis are really just optional here:
p34199
aVThe parenthesis are of course still a good idea, with parenthesis tuples are easier to spot visually, and the parenthesis distinguish the tuple in a function call from other parameters ( is different from )
p34200
as(dp34201
g16
V100297
p34202
stp34203
a((dp34204
g2
(lp34205
VIt is all working as designed
p34206
aVThe  string is the representation of your  class instances
p34207
aVYou can customize that representation by giving your class a  method:
p34208
aVAll the  function has to do is return a suitable string
p34209
aVWith the above example  function, your list would instead look like:
p34210
aVYou do need to make sure you actually append your new instance
p34211
aVInstead of:
p34212
aVdo this:
p34213
as(dp34214
g16
V100297
p34215
stp34216
a((dp34217
g2
(lp34218
VKeep a flag to track what you are looking for:
p34219
aVHere I used  as the flag; by adding the  line time to it it becomes non-empty and we start looking for the flags
p34220
aVI collected the individual event times into a  list, but you could also just print the event data whenever you have found the  line
p34221
aVOutput:
p34222
as(dp34223
g16
V100297
p34224
stp34225
a((dp34226
g2
(lp34227
VSafari appears to be broken for that link, I see the same error when I use that browser
p34228
aVEither use a different browser (both Chrome and Firefox handle the file just fine), or use  from the command line:
p34229
as(dp34230
g16
V100297
p34231
stp34232
a((dp34233
g2
(lp34234
VYou need to add the  path to the module search path in :
p34235
aVor move the  package to a directory already in your
p34236
aVThe directory of the script itself is also part of the , so you could also run:
p34237
as(dp34238
g16
V100297
p34239
stp34240
a((dp34241
g2
(lp34242
VYou are only getting the field itself, not the value
p34243
aVJust use the accessor:
p34244
as(dp34245
g16
V100297
p34246
stp34247
a((dp34248
g2
(lp34249
VIf your files all start with the same prefix and end with the same suffix, simply slice and pass to :
p34250
aVThis removes the first 7 characters (i
p34251
ag7233
aV) and the last 2 ()
p34252
aVThis works fine for your example filenames:
p34253
as(dp34254
g16
V100297
p34255
stp34256
a((dp34257
g2
(lp34258
VThe  returned by your  has no relation any more with your columns
p34259
aVYou'll need to return something that perhaps looks like a  but maps  calls back to your table columns:
p34260
aVthen return that instead of a regular :
p34261
as(dp34262
g16
V100297
p34263
stp34264
a((dp34265
g2
(lp34266
VFirst split on at least 2 newlines, then split on words:
p34267
aVYou now have a list of lists, one per paragraph; process these per paragraph, after which you can rejoin the whole thing into new text with double newlines inserted back in
p34268
aVI've used  to support paragraphs being delimited by more than 2 newlines; you could use a simple  if there are ever only going to be exactly 2 newlines between paragraphs
p34269
as(dp34270
g16
V100297
p34271
stp34272
a((dp34273
g2
(lp34274
VYou are writing byte data instead of unicode to your files, because you are encoding the data yourself
p34275
aVRemove the  calls altogether and let Python handle this for you; open the file with the UTF8 encoding and the rest takes care of itself:
p34276
aVThis is documented in the  module documentation:
p34277
aVSince  is used to open a CSV file for reading, the file will by default be decoded into unicode using the system default encoding (see )
p34278
aVTo decode a file using a different encoding, use the encoding argument of open:
p34279
aVThe same applies to writing in something other than the system default encoding: specify the encoding argument when opening the output file
p34280
as(dp34281
g16
V100297
p34282
stp34283
a((dp34284
g2
(lp34285
VYour code is out of sync with the bytecode
p34286
aVReload your code properly
p34287
aVWhen an exception occurs, the bytecode is inspected for a filename and a linenumber, and then the sourcefile is loaded to show the original source for that line
p34288
aVIf, however, you changed the source but did not yet restart your python process (or reloaded the code in ipython) then the wrong lines are being shown when an exception occurs
p34289
as(dp34290
g16
V100297
p34291
stp34292
a((dp34293
g2
(lp34294
VYour site, at some point, indexed unicode content into the Catalog indexes, effectively breaking them
p34295
aVThis may have been due to an old Plone bug, or something an add-on or custom code did wrong
p34296
aVYou can try to run a full reindex with the default Python encoding set to UTF-8 to work around this
p34297
aVThe following is not a recommended procedure for production sites; this is just a temporary 'plaster' for your problem
p34298
aVIn your Python  directory, add a file named  with the contents:
p34299
aVthen restart your plone site and attempt the rename or do a full catalog reindex first
p34300
aVDo remember to remove the  file again
p34301
aVSetting the default encoding in Python is only going to mask future problems
p34302
as(dp34303
g16
V100297
p34304
stp34305
a((dp34306
g2
(lp34307
VYou need to first read the current score from the label, add or subtract the 100 point, then set the label again:
p34308
aVNote that you need to call the  method as well, not just reference it
p34309
aVUse -= to subtract
p34310
as(dp34311
g16
V100297
p34312
stp34313
a((dp34314
g2
(lp34315
VYou'll need to use a separate function for that; the Python format mini language does not support truncating:
p34316
aVwhich outputs:
p34317
as(dp34318
g16
V100297
p34319
stp34320
a((dp34321
g2
(lp34322
VThe  anchor only matches the very start of your input string
p34323
aVIf you want it to match after each newline, you need to give it the  or  flag too:
p34324
aVI removed the  part; it is implicit, without a repetition indicator the character set only matches one character
p34325
aVThe replacement function is passed a  object, so you need to pull out the matched string by calling the  method
p34326
as(dp34327
g16
V100297
p34328
stp34329
a((dp34330
g2
(lp34331
VIt is the underlying  library that does the retrying
p34332
aVTo set a different maximum retry count, use alternative transport adapters:
p34333
aVOld answer, predating the release of requests 1
p34334
ag5740
aV1:
p34335
aVThe  library doesn't really make this configurable, nor does it intent to (see this pull request)
p34336
aVCurrently (requests 1
p34337
aV1), the retries count is set to 0
p34338
aVIf you really want to set it to a higher value, you'll have to set this globally:
p34339
aVThis constant is not documented; use it at your own peril as future releases could change how this is handled
p34340
aVUpdate: and this did change; in version 1
p34341
ag5740
aV1 the option to set the  parameter on the  class was added, so that now you have to use alternative transport adapters, see above
p34342
aVThe monkey-patch approach no longer works, unless you also patch the  defaults (very much not recommended)
p34343
as(dp34344
g16
V100297
p34345
stp34346
a((dp34347
g2
(lp34348
VSimple, use a negative character class in regex:
p34349
aVdenotes a character class
p34350
aVNormally, anything in the class matches
p34351
aVBy adding the  caret at the start you negate the class; anything not in the class matches
p34352
aVResult:
p34353
as(dp34354
g16
V100297
p34355
stp34356
a((dp34357
g2
(lp34358
VGenerally, you don't need to set the cookie on each and every response
p34359
aVThe browser already has the cookie and will continue sending it to the server as long as it is still valid
p34360
aVSpecifically, a Pyramid session cookie is set on every request because it contains a signed and timestamped secret that can expire separately from the normal cookie expiration mechanisms
p34361
aVBy setting a new cookie each time Pyramid gets to update the embedded timestamp to show the session is still fresh
p34362
aVIn other words, the cookie set is a different one each time
p34363
as(dp34364
g16
V100297
p34365
stp34366
a((dp34367
g2
(lp34368
VWithout the source code, you can only approximate the code
p34369
aVYou can disassemble the compiled bytecode with the  module, then reconstruct the source code as an approximation:
p34370
aVFrom the disassembly we can see there was 1 line, where a function named  is being called with one argument named
p34371
aVThe result is added to another name , and the result is stored in
p34372
aVThe unpyc and uncompyle2 projects do just that; decompile the python bytecode and reconstruct Python code from that
p34373
as(dp34374
g16
V100297
p34375
stp34376
a((dp34377
g2
(lp34378
VYou want the part directly preceding the last dot; just split on the dots and take the one-but last part:
p34379
aVFor your input, that gives:
p34380
as(dp34381
g16
V100297
p34382
stp34383
a((dp34384
g2
(lp34385
VYou need to call  on the filehandler
p34386
aVWhen your  class completes, call:
p34387
as(dp34388
g16
V100297
p34389
stp34390
a((dp34391
g2
(lp34392
VYou are assuming that the original  has already run;  should only be called after initialization has taken place:
p34393
as(dp34394
g16
V100297
p34395
stp34396
a((dp34397
g2
(lp34398
V returns an iterator, so you can simply call  to get the first item:
p34399
aVThis could raise a  exception if there are no items at all
p34400
aVYou could add a default to  to prevent that:
p34401
as(dp34402
g16
V100297
p34403
stp34404
a((dp34405
g2
(lp34406
VPython strings support escape codes; a backslash with certain characters is replaced by the code they represent
p34407
aVis interpreted as the ASCII line-feed character, for example,  is an ASCII BELL, and  is interpreted as the ascii codepoint 3 (in octal numbering)
p34408
aVSee the Python string literal documentation
p34409
aVTo disable escape codes being interpreted, use a raw python string by prefixing the string definition with a :
p34410
aVso your line reads:
p34411
aVAlternatively, double the backslashes to have them interpreted as a literal backslashes instead:
p34412
as(dp34413
g16
V100297
p34414
stp34415
a((dp34416
g2
(lp34417
VDocstrings are typically indented with their function, and start and end with triple quotes:
p34418
aVThat's 79 - 4 - 3 = 72 characters left
p34419
as(dp34420
g16
V100297
p34421
stp34422
a((dp34423
g2
(lp34424
VYou have 'empty' functions before each of those 4
p34425
aVAdd a  statement to those:
p34426
as(dp34427
g16
V100297
p34428
stp34429
a((dp34430
g2
(lp34431
VYour wrapper function replaces the wrapped function, and needs to match the number of arguments it takes
p34432
aVYour wrapped function takes two arguments , but your wrapper takes none at all
p34433
aVYou could add these two to your decorator wrapper too:
p34434
aVbut that ties your decorator to that specific function
p34435
aVThere is a trick you can use however:
p34436
aVThe  positional argument acts as a catch-all, all positional arguments to the function are now passed on to the wrapped function
p34437
aVThere is an equivalent for keyword arguments too:
p34438
as(dp34439
g16
V100297
p34440
stp34441
a((dp34442
g2
(lp34443
VYou specified an explicit  object with name
p34444
aVIf you were to omit that, then  would be added to the  primary key specification:
p34445
aVA  is only generated if the column is not a primary key
p34446
aVWhen inserting, SQLAlchemy will issue a  as needed to create a next value
p34447
aVSee the PostgreSQL documentation for details
p34448
as(dp34449
g16
V100297
p34450
stp34451
a((dp34452
g2
(lp34453
VYour test is incorrect, you want to test each string separately with :
p34454
aVdoes not group operands for the  test; each component is evaluated separately:
p34455
aVwhich leads to the result of  being returned; the other two values are certainly always True as they are non-empty strings
p34456
aVThe better approach is to use a set:
p34457
as(dp34458
g16
V100297
p34459
stp34460
a((dp34461
g2
(lp34462
VYou don't seem to have 4 rows
p34463
aVMake it generic and just join an arbitrary number of rows:
p34464
aVYou can simplify your database query, there is no need to 'poll' the query:
p34465
aVYou could also just loop directly over the cursor, the database will handle buffering as you fetch:
p34466
as(dp34467
g16
V100297
p34468
stp34469
a((dp34470
g2
(lp34471
VIf you have a CSV file, use the right tool to read it
p34472
aVUse the  module:
p34473
aVThis can be simplified down to:
p34474
as(dp34475
g16
V100297
p34476
stp34477
a((dp34478
g2
(lp34479
VOnly the  elements contain text:
p34480
aVThe  attribute holds the text of an element
p34481
aVFor your URL, that prints:
p34482
aVIt looks like the  tags have interesting titles too:
p34483
aVwhich then prints:
p34484
as(dp34485
g16
V100297
p34486
stp34487
a((dp34488
g2
(lp34489
VYou need to add some parenthesis:
p34490
aVI adjusted the lambda expression to work in both Python 2 and 3 (where you cannot use tuple unpacking in the parameter list)
p34491
aVRemember that the key is just a function that is supposed to return the value for which we want to know the minimum
p34492
aVIt is called for each element in the input sequence
p34493
aVIn this case that's a  tuple, and you wanted to find the minimum by the second element of the  return value
p34494
as(dp34495
g16
V100297
p34496
stp34497
a((dp34498
g2
(lp34499
VJust loop over the first list to build a dictionary with a dict comprehension:
p34500
aVNext loop over the other, with a helper function to pick one or the other based on the  values:
p34501
aVFor your first input that results in:
p34502
aVAll put together again in your merge function:
p34503
as(dp34504
g16
V100297
p34505
stp34506
a((dp34507
g2
(lp34508
VYou have two options, depending on the version of BeautifulSoup:
p34509
aVBeautifulSoup 4, use the  attribute to find all text elements that are not empty:
p34510
aVIn BeautifulSoup 3, you need to search for all contained text instead:
p34511
as(dp34512
g16
V100297
p34513
stp34514
a((dp34515
g2
(lp34516
VYou can get the first line with the  function:
p34517
aVThis works with any iterable
p34518
aVIf you have a list of lines, you can do , or first call  on the list
p34519
as(dp34520
g16
V100297
p34521
stp34522
a((dp34523
g2
(lp34524
VYou need to fix your indentation after the  statement (which you limited to one line only)
p34525
aVI moved the  to the next line, indented properly, illustrate:
p34526
aVNote that you had indented everything from the  line onwards one indent too many, including the  statement that belongs outside of the  loop
p34527
as(dp34528
g16
V100297
p34529
stp34530
a((dp34531
g2
(lp34532
VThe for loop ends at the line where the indentation drops back to the same level or lower as the  statement
p34533
aVIn your example, that is at the  statement
p34534
aVThe loop will also be terminated when the  statement becomes True and the  statement is executed; the function returns 'early' at that point and the rest of the loop is ignored
p34535
aVAs written, you cannot reduce the code to one line, as you cannot combine multiple compound statements (statement that take a indented block of code) on one line
p34536
aVYou can reduce this to two lines with an  function call with a generator expression, replacing the  statement, but I don't think it improves readability:
p34537
aVYou could then cram all that into one line with a conditional expression to ruin readability some more:
p34538
aVDon't do that
p34539
as(dp34540
g16
V100297
p34541
stp34542
a((dp34543
g2
(lp34544
VNo, you can't
p34545
aVThe items are just not equal, there is no error there
p34546
aVGenerally speaking, it is unpythonic to force your code to only accept specific types
p34547
aVWhat if you wanted to create a subclass of the , and have it work everywhere an  works
p34548
aVThe Python boolean type is a subclass of , for example ( == 1,  == 0)
p34549
aVIf you have to have an exception, you can do one of two things:
p34550
aVTest for equality on their types and raise an exception yourself:
p34551
aVThis example allows for either a or b to be a subclass of the other type, you'd need to narrow that down as needed ( to be super strict)
p34552
aVTry to order the types:
p34553
aVIn Python 3, this throws an exception when comparing numerical types with sequence types (such as strings)
p34554
aVThe comparisons succeed in Python 2
p34555
aVPython 3 demo:
p34556
as(dp34557
g16
V100297
p34558
stp34559
a((dp34560
g2
(lp34561
VThat tweet is not a retweet, it is merely a tweet with the text  at the start
p34562
aVYou can see this on the original tweet, there is no 'Retweeted by' text on it
p34563
aVIf I send a tweet with the text  you would see it too
p34564
aVJust because a tweet starts with  does not make it a proper retweet
p34565
aVYour query is working just fine
p34566
as(dp34567
g16
V100297
p34568
stp34569
a((dp34570
g2
(lp34571
V doesn't return anything, you need to configure a file-like object to capture the value
p34572
aVA  object would do, you can then call  on that after the call completes:
p34573
aVIf you are not married to , you might find  to be a lot easier:
p34574
aVEven the standard library  module will be easier than using :
p34575
as(dp34576
g16
V100297
p34577
stp34578
a((dp34579
g2
(lp34580
V will use the OS timezone info, but does carry it's own compressed timezone info file too
p34581
aVYou could list the available names from that file:
p34582
aVYou may need to sort and filter that list a little; there are both abbreviated (3 letter) timezone codes as well as "region/city" entries in this list
p34583
aVStoring those names in a database is just fine
p34584
as(dp34585
g16
V100297
p34586
stp34587
a((dp34588
g2
(lp34589
VYou are opening a XML file in a HTML parser
p34590
aVBeautifulSoup tries to repair the HTML structure it expected
p34591
aVInstead, use a XML parser, or use BeautifulSoup in XML mode:
p34592
aVFor this to work you must have  installed
p34593
aVis an excellent XML library in and of itself
p34594
aVYou could also use the ElementTree library included with Python;  is based on the same API but has more features
p34595
as(dp34596
g16
V100297
p34597
stp34598
a((dp34599
g2
(lp34600
VYou can add attributes to the edges when you create them:
p34601
aVor you can set them later with:
p34602
aVTo add textual information to edges, give them a  attribute instead:
p34603
aVAll attributes are internally stored as strings but GraphViz interprets these as specific types; see the attribute documentation
p34604
as(dp34605
g16
V100297
p34606
stp34607
a((dp34608
g2
(lp34609
VThis is somewhat non-trivial, as there is no simple rule to determine what makes a for a valid public suffix (site name + TLD)
p34610
aVInstead, what makes a public suffix is maintained as a list at PublicSuffix
p34611
aVorg
p34612
aVA python package exists that queries that list (stored locally); it's called :
p34613
as(dp34614
g16
V100297
p34615
stp34616
a((dp34617
g2
(lp34618
VDon't re-invent the wheel, use the  library instead:
p34619
aVYour own code does not handle the case where no space has been found and  returns -1
p34620
as(dp34621
g16
V100297
p34622
stp34623
a((dp34624
g2
(lp34625
VYou'll need to set those extra attributes after defining the class:
p34626
aVYou could use a class decorator to wrap the for loop into a function applied to the class:
p34627
aVI am somewhat worried that the Django metaclass handling wants to process these fields though, and you may need to add additional calls to make the  structure aware of the additional fields that you have added
p34628
as(dp34629
g16
V100297
p34630
stp34631
a((dp34632
g2
(lp34633
VYou also need to set  on , or use the local variable as the argument:
p34634
aVor:
p34635
aVThis prints:
p34636
aVNote that the  instance will only call  once, it doesn't repeatedly call the function
p34637
aVYou need to reset the timer every time  is called to do that:
p34638
aVwhich will create a loop
p34639
aVIf you need that loop to terminate at some point, you'll need to test for that condition separately, in :
p34640
as(dp34641
g16
V100297
p34642
stp34643
a((dp34644
g2
(lp34645
V is a local variable in the  function, it doesn't exist outside of
p34646
aVYou could return it from  then store the value in a new  in your code:
p34647
aVNote that I fixed several problems with your code in  as well
p34648
aVreturns a string, but you test if  is integer 1 or 2 instead
p34649
aVI changed the code to test for the strings  and  instead
p34650
aVDon't use , that does not mean what you think it means
p34651
aVIt tests if  is True, and if not, it tests if  is True
p34652
aVis always  because all non-zero numbers are considered True in a boolean context
p34653
aVI replaced that with a  test
p34654
aVThere is no need to test  inside the loop again and execute a ; the  loop will just exit on its own without that test
p34655
aVIt doesn't really matter what  is set to at the start of , as long as it is not  or
p34656
aVis a good choice to signal that it is 'empty'
p34657
as(dp34658
g16
V100297
p34659
stp34660
a((dp34661
g2
(lp34662
VFirst and foremost,  is built on top of the  library, the stdlib  or  libraries are not used at all
p34663
aVThere is little point in comparing  with  on performance
p34664
aVmay use C code for it's work but like all network programming, your execution speed depends largely on the network that separates your machine from the target server
p34665
aVMoreover, the target server could be slow to respond
p34666
aVIn the end,  has a far more friendly API to work with, and you'll find that you'll be more productive using that friendlier API
p34667
as(dp34668
g16
V100297
p34669
stp34670
a((dp34671
g2
(lp34672
VIf the items are grouped over three lines, I'd use:
p34673
aVThis uses the input file as an iterable, getting 3 lines at a time until  becomes equal to
p34674
as(dp34675
g16
V100297
p34676
stp34677
a((dp34678
g2
(lp34679
VYou are not assigning to  in the second version, you are assigning to an index contained in the list referred to by
p34680
aVPython names are references to values, not memory locations
p34681
aVSome of those values are mutable, such as a list
p34682
aVA list contains references to other values, so  is a list and  is a reference contained in the list
p34683
aVTo change the list in the first example, use the  from enumerate to alter that index in the list:
p34684
aVIf you did not want the nested lists in your second example to change, you should make a copy of them instead:
p34685
as(dp34686
g16
V100297
p34687
stp34688
a((dp34689
g2
(lp34690
VYou can apply formatting (with  or ) inside a list comprehension before joining:
p34691
aVDemo:
p34692
aVleft-aligns,  right-aligns and  centers the text in the given width (10 in the above example)
p34693
aVFor more detail on how formatting works, see the format specification documentation
p34694
aVDemo with right-adjustment to 4 spaces:
p34695
as(dp34696
g16
V100297
p34697
stp34698
a((dp34699
g2
(lp34700
V is a nested sub-package of , you'll have to import it first:
p34701
aVIt is not an attibute of  itself; that only works if the  file itself were to do
p34702
as(dp34703
g16
V100297
p34704
stp34705
a((dp34706
g2
(lp34707
VYou want to catch :
p34708
aVso you are forward compatible; your traceback is dealing with
p34709
as(dp34710
g16
V100297
p34711
stp34712
a((dp34713
g2
(lp34714
VPython 2 looks for modules as relative to the current package first
p34715
aVIf your library code has a lot of imports for a lot of top-level modules those are all looked up as relative first
p34716
aVSo, if package  import , then Python first looks for
p34717
aVThis miss is cached by Python itself too
p34718
aVIn Python 3, the default has moved to absolute imports instead; you can switch Python 2
p34719
aV5 and up to use absolute imports per module with:
p34720
aVAnother source of file lookup misses is loading  bytecode cache files; if those are missing for some reason (filesystem not writable for the current Python process) then Python will continue to look for those on every run
p34721
aVYou can create these caches with the  module:
p34722
aVprovided you run that with the correct write permissions
p34723
as(dp34724
g16
V100297
p34725
stp34726
a((dp34727
g2
(lp34728
VYou generally don't set  values as local variables
p34729
aVIt's a dictionary, just refer to the values contained:
p34730
as(dp34731
g16
V100297
p34732
stp34733
a((dp34734
g2
(lp34735
V is the path of the script, albeit often a relative path
p34736
aVUse:
p34737
aVto create an absolute path to the directory, then use  to open your file:
p34738
as(dp34739
g16
V100297
p34740
stp34741
a((dp34742
g2
(lp34743
VIt is easy enough to make the season group optional:
p34744
aVusing a non-capturing group () plus the 0 or 1 quantifier ()
p34745
aVI did have to make the first group non-greedy to prevent it from matching the  section of the name
p34746
aVI also made the  and  optional strings into non-capturing optional groups instead of character classes
p34747
aVResult:
p34748
as(dp34749
g16
V100297
p34750
stp34751
a((dp34752
g2
(lp34753
VYou put the  at the end:
p34754
aVList comprehensions are written in the same order as their nested full-specified counterparts, essentially the above statement translates to:
p34755
aVYour version tried to do this instead:
p34756
aVbut a list comprehension must start with at least one outer loop
p34757
as(dp34758
g16
V100297
p34759
stp34760
a((dp34761
g2
(lp34762
VYou only set the variable  under very specific conditions and never set it to
p34763
aVAdd an explicit  to the top of the  function
p34764
aVYou probably want to set  inside the  loop at some point, as it stands it'll never stop if  is reached
p34765
as(dp34766
g16
V100297
p34767
stp34768
a((dp34769
g2
(lp34770
VThe sax parser itself is supposed to provide your content handler with a locator
p34771
aVThe locator has to implement certain methods, but it can be any object as long as it has the right methods
p34772
aVThe  class is the interface a locator is expected to implement; if the parser provided a locator object to your handler then you can count on those 4 methods being present on the locator
p34773
aVThe parser is only encouraged to set a locator, it is not required to do so
p34774
aVThe expat XML parser does provide it
p34775
aVIf you subclass  then it'll provide a standard  method for you, and by the time  on the handler is called your content handler instance will have  set:
p34776
as(dp34777
g16
V100297
p34778
stp34779
a((dp34780
g2
(lp34781
VDon't interpolate values into SQL using string formatting
p34782
aVIn the case of a  object, the default string format happens to work for MySQL, but that is just serendipity and luck
p34783
aVIn this case, don't use raw SQL and have SQLAlchemy translate the datetime object to something the backend database understands for you:
p34784
aVEven when using raw SQL, I'd have sqlalchemy generate that SQL and use bind parameters:
p34785
aVThat filter expression is turned into properly escaped SQL for your database backend, whatever backend that may be
p34786
aVWhen no backend is set, the expression becomes:
p34787
aVand the  value will be passed in as a SQL parameter to the backend database cursor when executing
p34788
aVA last resort is to use the  type:
p34789
aVI'd otherwise avoid mixing raw SQL and the SQLAlchemy ORM altogether
p34790
aVUse raw SQL directly with the database connection only:
p34791
as(dp34792
g16
V100297
p34793
stp34794
a((dp34795
g2
(lp34796
VThe order is not arbitrary, but depends on the insertion and deletion history of the dictionary or set, as well as on the specific Python implementation
p34797
aVFor the remainder of this answer, for 'dictionary', you can also read 'set'; sets are implemented as dictionaries with just keys and no values
p34798
aVKeys are hashed, and hash values are assigned to slots in a dynamic table (it can grow or shrink based on needs)
p34799
aVAnd that mapping process can lead to collisions, meaning that a key will have to be slotted in a next slot based on what is already there
p34800
aVListing the contents loops over the slots, and so keys are listed in the order they currently reside in the table
p34801
aVTake the keys  and , for example, and lets assume the table size is 8 slots
p34802
aVIn Python 2
p34803
aV7,  is ,  is
p34804
aVModulo 8, that means these two keys are slotted in slots 3 and 4 then:
p34805
aVThis informs their listing order:
p34806
aVAll slots except 3 and 4 are empty, looping over the table first lists slot 3, then slot 4, so  is listed before
p34807
aVand , however, have hash values that are exactly 8 apart and thus map to the exact same slot, :
p34808
aVTheir order now depends on which key was slotted first; the second key will have to be moved to a next slot:
p34809
aVThe table order differs here, because one or the other key was slotted first
p34810
aVThe technical name for the underlying structure used by CPython (the most commonly used Python implemenation) is a hash table, one that uses open addressing
p34811
aVIf you are curious, and understand C well enough, take a look at the C implementation for all the (well documented) details
p34812
aVYou could also watch this Pycon 2010 presentation by Brandon Rhodes about how CPython  works, or pick up a copy of Beautiful Code, which includes a chapter on the implementation written by Andrew Kuchling
p34813
aVNote that as of Python 3
p34814
aV3, a random hash seed is used as well, making hash collisions unpredictable to prevent certain types of denial of service (where an attacker renders a Python server unresponsive by causing mass hash collisions)
p34815
aVThis means that the order of a given dictionary is then also dependent on the random hash seed for the current Python invocation
p34816
aVOther implementations are free to use a different structure for dictionaries, as long as they satisfy the documented Python interface for them, but I believe that all implementations so far use a variation of the hash table
p34817
aVPython 2
p34818
aV7 and newer also provides an  class, a subclass of  that adds an additional data structure to record key order
p34819
aVAt the price of some speed and extra memory, this class remembers in what order you inserted keys; listing keys, values or items will then do so in that order
p34820
aVIt uses a doubly-linked list stored in an additional dictionary to keep the order up-to-date efficiently
p34821
aVIf you wanted an ordered set, you can install the  package; it works on Python 2
p34822
aV5 and up
p34823
as(dp34824
g16
V100297
p34825
stp34826
a((dp34827
g2
(lp34828
VYour code seems to expect to be able to access  as a global, but this is a method
p34829
aVFunctions defined at the module level are indeed reachable by their name (as they are stored as a global), but a class method is only stored in the class object
p34830
aVYou need to find the function object either via the class on which you defined this, or via the  attribute, following that back to the class and then the function:
p34831
aVSince you already have a class method, you'd be better off storing the variable on the class instead:
p34832
aVor even make this a class method instead:
p34833
as(dp34834
g16
V100297
p34835
stp34836
a((dp34837
g2
(lp34838
VCase insensitive search for case 3 first:
p34839
aVBy lowercasing , you make that a lowercase search
p34840
aVAs for why case 2 is so much slower: using a pre-compiled regular expression is going to be faster, as you then avoid the cache lookup for the regular expression pattern for each and every line you read from the file
p34841
aVUnder the hood,  will also call  if no cached copy already exists and that extra function call and cache check is going to cost you
p34842
aVThat is doubly painful on Python 3
p34843
aV3, which switched to a new caching model using the  decorator, one that is actually slower than the previous implementation
p34844
aVSee Why are uncompiled, repeatedly used regexes so much slower in Python 3
p34845
aVA simple text search with  is faster for exact text matches
p34846
aVRegular expressions are great for complex matching, you are simply looking for an exact match, albeit case insensitive
p34847
as(dp34848
g16
V100297
p34849
stp34850
a((dp34851
g2
(lp34852
VYou should not set  in your script; Python already sets it and relies on the value for other purposes such as importing
p34853
aVThe  value of a python script or module can be changed but you need to know what you are doing and understand Python's internals before you should attempt to do so
p34854
aVDon't set double underscore variables in general even
p34855
aVThey are reserved for Python use only; only set them when they are documented as settable, such as  in a module
p34856
aVSee the Python data model documentation for an overview of what double-underscore names (dunder names) are currently in use
p34857
as(dp34858
g16
V100297
p34859
stp34860
a((dp34861
g2
(lp34862
VJust use :
p34863
aVwhich formats each integer value as a 2-digit lowercase hexadecimal value with a leading 0 if the value is lower than 16
p34864
as(dp34865
g16
V100297
p34866
stp34867
a((dp34868
g2
(lp34869
VYou'll have to catch the exception and assert that it is not a 400 response:
p34870
aVThis requires the exception to carry the error code as an attribute; you perhaps need to inspect what attributes are available on the exception
p34871
aVBy default  will be there (it is a tuple), but it is good practice for such exceptions to have an error code attribute too
p34872
as(dp34873
g16
V100297
p34874
stp34875
a((dp34876
g2
(lp34877
VThere are a series of problems with your expression and sample:
p34878
aVYour use of VERBOSE makes all spaces not match, so your spaces around the digits on the first line are ignored too
p34879
aVReplace spaces with  or  (the latter only matches a literal space, the former matches newlines and tabs too)
p34880
aVYour input sample has whitespace before the digit on each line but your example pattern requires that the digits are at the start of the line
p34881
aVEither allow for that whitespace or fix your sample input
p34882
aVThe biggest problem is that a capturing group inside a repeating group (so  inside of a larger group with  at the end) only captures the last match
p34883
aVYou'll get  and , not the previous two matched lines
p34884
aVTo overcome all that, you have to repeat that pattern for the three lines explicitly
p34885
aVYou could use Python to implement that repetition:
p34886
aVWhich, for your sample input, returns:
p34887
aVIf you really do not want to match spaces before the digits on the 3 extra lines, you can remove the first  pattern from
p34888
as(dp34889
g16
V100297
p34890
stp34891
a((dp34892
g2
(lp34893
VFor a list, you need to use :
p34894
aVYou can turn that into a list comprehension:
p34895
as(dp34896
g16
V100297
p34897
stp34898
a((dp34899
g2
(lp34900
VIt'll fail when your class uses
p34901
aVYou could use  instead:
p34902
aVprovided the arguments keyword arguments to  are all declared slots of course
p34903
aVOtherwise this should work on any Python implementation
p34904
aVYou may be interested in a previous discussion of the topic, which sparked a Python-ideas list thread
p34905
as(dp34906
g16
V100297
p34907
stp34908
a((dp34909
g2
(lp34910
VUse  instead:
p34911
aVThe documentation details the implementation if you want to pick it it apart
p34912
aVIt's easy enough to apply this to the list of objects you have:
p34913
as(dp34914
g16
V100297
p34915
stp34916
a((dp34917
g2
(lp34918
VYou want to install Pillow instead
p34919
aVIt comes in both 32 and 64 bit variants for Windows, and has fixed long-standing issues with the original PIL library
p34920
aVThe PIL library has long been broken when it comes to packaging
p34921
aVPillow was started as a fork to fix these issues once and for all, and version 2
p34922
ag2391
aV0 added Python 3 support (with a grant from the Python Software Foundation)
p34923
as(dp34924
g16
V100297
p34925
stp34926
a((dp34927
g2
(lp34928
VYou really do not want to use string formatting to include values
p34929
aVLeave that to the database API via SQL parameters
p34930
aVUsing parameters you:
p34931
aVgive the database a chance to prepare the statement and reuse the query plan for better performance
p34932
aVsave yourself the headache of escaping the value properly (including avoiding allowing SQL escapes and with those SQL injection attacks)
p34933
aVSince SQLLite supports named SQL parameters, I'd return both a statement and a dictionary with parameters:
p34934
aVthen pass both to :
p34935
aVSQL generation becomes complex fast, you may want to look at SQLAlchemy core to do the generation instead
p34936
aVFor your example, you can generate:
p34937
aVThe  object can have additional filters applied to it, ordered, grouped, used as a subselect to other queries, joined and finally sent to be executed at which point SQLAlchemy will turn this into SQL fit for the specific database you are connecting to
p34938
as(dp34939
g16
V100297
p34940
stp34941
a((dp34942
g2
(lp34943
VYou can do that with:
p34944
aVbut you really want to use a dictionary instead:
p34945
aVafter which matching becomes a simple lookup:
p34946
aVDemonstration:
p34947
aVWith the  mapping, lookups will be much, much faster when doing multiple lookups, especially when there are non-existing entries in the list
p34948
aVTo put this together with the rest of your code:
p34949
aVWhich for your  input would print:
p34950
as(dp34951
g16
V100297
p34952
stp34953
a((dp34954
g2
(lp34955
VCreate a new list to add your per-book lists to:
p34956
aVAlternatively, you could use a dictionary:
p34957
aVThe above example generates keys as , , etc
p34958
aVbut perhaps you had better names in mind
p34959
aVPrinting these then becomes:
p34960
aVor loop over the  or  sequences
p34961
as(dp34962
g16
V100297
p34963
stp34964
a((dp34965
g2
(lp34966
VThe better solution would be for you to add a  method onto the  class (with accompanying ):
p34967
aVNow the  class can always be pickled and unpickled without additional processing
p34968
aVI do see that the class has a  mapping; perhaps that should be excluded when pickling
p34969
aVIgnore it in  and call  in  if that is the case
p34970
as(dp34971
g16
V100297
p34972
stp34973
a((dp34974
g2
(lp34975
VYou are using Python 3; use  instead
p34976
aVThis is documented at the top of the  page:
p34977
aVNote: The  module has been split across several modules in Python 3 named  and
p34978
aVThe  tool will automatically adapt imports when converting your sources to Python 3
p34979
as(dp34980
g16
V100297
p34981
stp34982
a((dp34983
g2
(lp34984
VThe  operator translates to the  opcode in the bytecode, which the interpreter then translates to the C-API  call with the 3rd argument set to None
p34985
aVcalls the  slot on the operands (see )
p34986
aVIf both are integers, the  C function succeeds and its result used
p34987
aVIf however  is an integer and you use  as the power, the integer power function raises an error and  is tried next
p34988
aVIn that case, provided  is greater than 0, the C library  function is used on two float values, which on most architectures is then handled by the floating point support in the CPU
p34989
as(dp34990
g16
V100297
p34991
stp34992
a((dp34993
g2
(lp34994
VYou're missing a closing parenthesis on the preceding line:
p34995
aVWhen you get a Python syntax error and you cannot spot it, look at the previous line to see if your brackets, braces and parenthesis are balanced
p34996
as(dp34997
g16
V100297
p34998
stp34999
a((dp35000
g2
(lp35001
VYour regular expression seems to be expecting the quotes around the value to the right of the  equals sign only, but your input has the quotes around the whole expression
p35002
aVAdjusting is easy:
p35003
aVRunning that on your example input that gives:
p35004
as(dp35005
g16
V100297
p35006
stp35007
a((dp35008
g2
(lp35009
VYou can pass in either a , or a sequence of two-value tuples
p35010
aVAnd  is trivially converted to such a sequence:
p35011
aVHowever, because the  type is a subclass of , calling  is exactly what  does under the hood, so passing in an  instance directly Just Works too
p35012
aVAs such, something else is wrong
p35013
aVYou can verify what is being posted by posting to  instead:
p35014
aVUnfortunately,  does not preserve ordering
p35015
aVAlternatively, you can create a dedicated HTTP post bin at http://requestb
p35016
aVin/ as well; it'll tell you in more detail what goes on
p35017
aVUsing requestb
p35018
aVin, and by replacing  with an open file object, the POST from requests is logged as:
p35019
aVshowing that ordering is preserved correctly
p35020
aVNote that  does not support the Curl-specific  syntax; instead, pass in an open file object:
p35021
aVYou may also want to set the  field to use title case:
p35022
aVIf you still get a 500 response, check the  response text to see what Amazon thinks is wrong
p35023
as(dp35024
g16
V100297
p35025
stp35026
a((dp35027
g2
(lp35028
VRead and write the data with the  module, and keep track of when the 'next' group starts:
p35029
aVThis writes:
p35030
aVto  for your input
p35031
aVThis solution never keeps more than 3 rows of data in memory, so you should be able to throw any size of CSV file at it
p35032
as(dp35033
g16
V100297
p35034
stp35035
a((dp35036
g2
(lp35037
VYour input contains multiple digits, match those with:
p35038
aVResult:
p35039
as(dp35040
g16
V100297
p35041
stp35042
a((dp35043
g2
(lp35044
VYou read the first 5 bytes to check for the filetype, but never reset the file position to the beginning
p35045
aVAdd a call to :
p35046
aVYou can always seek relatively without a call to :
p35047
as(dp35048
g16
V100297
p35049
stp35050
a((dp35051
g2
(lp35052
VYou need to capture the filename as a group, you can then replace it in one go:
p35053
aVThis puts a capturing group () around the whole filename including the extension (itself now using a non-capturing  group instead), resulting in:
p35054
aVThis uses  as a replacement pattern, see the  documentation
p35055
aVThis  call will replace all matching  paths with the  syntax
p35056
as(dp35057
g16
V100297
p35058
stp35059
a((dp35060
g2
(lp35061
VThe parenthesis on the previous line are not balanced, adding one more at the end fixes that
p35062
aVbut the formula is a little bit of a mess to figure out where they really belong
p35063
aVYou really want to split up that formula into something fitting within an 80 character line and using temporary variables:
p35064
aVbut with better variable names
p35065
aVI already managed to cut out a repeated  from the formula just by factoring this out into smaller chunks
p35066
as(dp35067
g16
V100297
p35068
stp35069
a((dp35070
g2
(lp35071
VYou need to use a negative lookahead to match characters that are not followed by
p35072
aVReformatting your regular expression a little to show of the groupings:
p35073
aVwith the  replaced with a bold  quantifier, results in:
p35074
aVSo the (non-capturing) group  matches any digit, letter, underscore or dash that is not followed by the characters
p35075
as(dp35076
g16
V100297
p35077
stp35078
a((dp35079
g2
(lp35080
VAll statements in the 'top level' of a module are executed when imported
p35081
aVYou you don't want that to happen, you need to distinguish between the module being used as a script and a module
p35082
aVUse the following test for that:
p35083
aVApplying that to your module:
p35084
as(dp35085
g16
V100297
p35086
stp35087
a((dp35088
g2
(lp35089
VPython does not magically format strings, you need to do that explicitly:
p35090
aVSee Format string syntax for more information how the  method works
p35091
aVAlternatively, use any of:
p35092
as(dp35093
g16
V100297
p35094
stp35095
a((dp35096
g2
(lp35097
VDon't use ; use  instead when accepting string input
p35098
aV(on Python 2) tries to interpret the input string as Python,  does not try to interpret the text at all, including not trying to interpret  backslashes as escape sequences:
p35099
aVOn Python 3, use just  (which is Python 2's  renamed); unless you also use  it will not interpret escape codes:
p35100
as(dp35101
g16
V100297
p35102
stp35103
a((dp35104
g2
(lp35105
VYou are going about it the wrong way; you just convert the  to hours:
p35106
aVwhich gives:
p35107
aVbut you can just as well base that off of simple arithmetic:
p35108
as(dp35109
g16
V100297
p35110
stp35111
a((dp35112
g2
(lp35113
VYou can always bundle the bash script with the rest of your program (like I suspect you are already doing), and reconstruct the path to these scripts at runtime
p35114
aVIt is easy enough to get the location of any python module from within the module itself, then create path to the bash script from there:
p35115
aVand  would then be an absolute path to the file  sitting in the same directory as the current Python module
p35116
as(dp35117
g16
V100297
p35118
stp35119
a((dp35120
g2
(lp35121
VUse the  module, which has functions that perform the same operations as your arithmetic operations
p35122
as(dp35123
g16
V100297
p35124
stp35125
a((dp35126
g2
(lp35127
VYou can install directly from GitHub with , but you perhaps have to force the upgrade:
p35128
aVThis does require that you have  itself installed as well
p35129
aVAlternatively, you can install from the GitHub supplied archives:
p35130
aVor
p35131
as(dp35132
g16
V100297
p35133
stp35134
a((dp35135
g2
(lp35136
VUsing  with the default identity function ():
p35137
aValternatively, a list comprehension:
p35138
as(dp35139
g16
V100297
p35140
stp35141
a((dp35142
g2
(lp35143
VYou don't use string formatting for SQL; use SQL parameters instead
p35144
aVThat said, you can escape  by doubling it to :
p35145
aVObligatory XKCD reference as customary warning
p35146
as(dp35147
g16
V100297
p35148
stp35149
a((dp35150
g2
(lp35151
VIf  is expensive, use a generator function:
p35152
aVResist the temptation to nest generator expressions here; yes, it can be done but only serves to make your code undecipherable
p35153
as(dp35154
g16
V100297
p35155
stp35156
a((dp35157
g2
(lp35158
VYou'll have to stick with the  statement, but it can be simplified:
p35159
aVsince  is empty, the  loop never executes the loop portion, and an empty list is  in a boolean context
p35160
as(dp35161
g16
V100297
p35162
stp35163
a((dp35164
g2
(lp35165
VWith a dict comprehension and :
p35166
aVor, for python 2
p35167
aV6 and older, where you do not yet have dict comprehensions:
p35168
aVor a list comprehension for the value if you are on Python 3:
p35169
aVQuick demo:
p35170
as(dp35171
g16
V100297
p35172
stp35173
a((dp35174
g2
(lp35175
VUse a list comprehension:
p35176
aVto create separate sublists
p35177
aVWhen you multiply a list, the inner list is not copied, only the reference to the sublist is copied
p35178
aVYou essentially do this:
p35179
aVA list comprehension, on the other hand, executes the expression that creates the sublist for each loop iteration, so on each run-through a completely new list is created:
p35180
as(dp35181
g16
V100297
p35182
stp35183
a((dp35184
g2
(lp35185
VYou are constructing your boolean logic wrong; use:
p35186
aVinstead
p35187
aVThe expression  is interpreted as , which will always be True (non-empty strings are considered  in a boolean context):
p35188
aVYou also should use  equality tests instead of  identity tests
p35189
aVtests if the two operands are the same object, while  tests if the have the same value
p35190
aVFor small strings that sometimes happens to be both True, but that is a Python optimization, not something you can rely on to work for all strings
p35191
aVNext problem is that what happens when the user input is your over-use of
p35192
aVWhen  is , for example, it is not  or , so  matches, excluding all the other  branches
p35193
aVYou really want to simplify your logic:
p35194
aVNone of this has anything to do with  loops
p35195
as(dp35196
g16
V100297
p35197
stp35198
a((dp35199
g2
(lp35200
VUse the  module (introduced in Python 3
p35201
aV3):
p35202
aVwhich will accept IPv4 addresses of the form , e
p35203
ag1298
aVa dotted quad, and IPv6 addresses in both longhand form (8 groups of 4 hexadecimal characters separated by ) and shorthand forms
p35204
aVIf you only want to accept IPv4 addresses, use  instead
p35205
as(dp35206
g16
V100297
p35207
stp35208
a((dp35209
g2
(lp35210
VYou'll need to add the parent directory of  to :
p35211
aVis the filename of the  module (can be relative)
p35212
as(dp35213
g16
V100297
p35214
stp35215
a((dp35216
g2
(lp35217
VOnly the model column is taken from the file:
p35218
aVThis takes each line from your input (which the csv module turns into a sequence of columns)  and takes only the second column (python uses 0-based indexing)
p35219
aVIn other words, whomever wrote this code knew that each line in the input file contains four columns and is picking out just the second one
p35220
aVIf a different column contained the model, you'd have to adjust the  index
p35221
as(dp35222
g16
V100297
p35223
stp35224
a((dp35225
g2
(lp35226
VUse python sets to list the  differences:
p35227
aVResult:
p35228
aVIf order matters, then you still need to use sets:
p35229
aVResult:
p35230
as(dp35231
g16
V100297
p35232
stp35233
a((dp35234
g2
(lp35235
VYou need to install the XPDF package to convert PDF to text for Plone to be able to index the contents
p35236
aVDownload it from http://www
p35237
aVfoolabs
p35238
aVcom/xpdf/download
p35239
aVhtml, where you'll find a pre-compiled Windows binary
p35240
as(dp35241
g16
V100297
p35242
stp35243
a((dp35244
g2
(lp35245
VThe lines are whitespace separated, simply loop over the file, and use :
p35246
aVIf you need to pick one name at random from that, you could use:
p35247
aVwhich makes a selection without keeping more than one line at a time in memory
p35248
as(dp35249
g16
V100297
p35250
stp35251
a((dp35252
g2
(lp35253
VYou need to implement the  method as well as the  method
p35254
aVThe method should return an integer, and for any two objects where  returns ,  must return the same integer value
p35255
aVThe easiest way to accomplish this is to use the built-in  function on each and every attribute of your instance that makes it unique, and return the XORed result of those values
p35256
aVExample:
p35257
aVDemo:
p35258
as(dp35259
g16
V100297
p35260
stp35261
a((dp35262
g2
(lp35263
VYou have a 3rd option: make it both an attribute and a method, by using a property:
p35264
aVYou access  like an attribute:
p35265
aVIn order for the  descriptor to work correctly, in Python 2 you need to make sure your class inherits from ; in Python 3 the baseclass can be safely omitted
p35266
aVIn this case, the calculation of the volume is cheap enough, but a property lets you postpone having to calculate the volume until you actually need it
p35267
aVThe above example creates a read-only property; only a getter is defined:
p35268
aVYou could easily cache the result of the property calculation:
p35269
aVso that you only have to calculate it once per  instance
p35270
aVWhat you use depends on many factors; how easy does your API need to be to use, how often will the volume be calculated, how many Spheroid instances will be created, etc
p35271
aVIf you create a million of these in a loop but only ever need the volume for a handfull of them, it makes sense to use a property instead of setting the volume in the
p35272
aVIf, however, your class could adjust itself based on the volume; say, by adjusting one of the radii automatically, then a  makes more sense still:
p35273
aVNow you have a spheroid which naturally adjusts it's short attribute as you adjust the volume:
p35274
aVNote: technically, anything you access on an object with  notation is an attribute; methods included
p35275
aVFor the purpose of this answer, I used your  as any value that is not called (doesn't use  after the name)
p35276
as(dp35277
g16
V100297
p35278
stp35279
a((dp35280
g2
(lp35281
VFirst of all, step away from the minidom module
p35282
aVMinidom is great if you already know the DOM from other languages and really do not want to learn any other API
p35283
aVThere are easier alternatives available, right there in the standard library
p35284
aVI'd use the ElementTree API instead
p35285
aVYou generally just loop over matches, and skip over the ones that you want to exclude as you do so:
p35286
as(dp35287
g16
V100297
p35288
stp35289
a((dp35290
g2
(lp35291
V returns filenames, not paths
p35292
aVJoin them with the directory name to make absolute paths:
p35293
as(dp35294
g16
V100297
p35295
stp35296
a((dp35297
g2
(lp35298
VIt slices the string to omit the last character, in this case a newline character:
p35299
aVSince this works even on empty strings, it's a pretty safe way of removing that last character, if present:
p35300
aVThis works on any sequence, not just strings
p35301
as(dp35302
g16
V100297
p35303
stp35304
a((dp35305
g2
(lp35306
VNope, there is no abbreviation available
p35307
aVWere you thinking about  instead
p35308
aVAnd as a side note:  is called an conditional expression; it is a ternary operator, but so is the SQL  expression
p35309
as(dp35310
g16
V100297
p35311
stp35312
a((dp35313
g2
(lp35314
VYour date handling is way overcomplicated
p35315
aVThis should do fine on any platform:
p35316
aVwith the  call removing any extraneous whitespace (such as  lines from a windows-format  CRNL combo)
p35317
aVI'm not sure why you go through such great lengths to convert todays date to a string, to parse it to a  object, then to convert it to a string again
p35318
aVIn any case, the default string format for  objects follows ISO8601, matching the  format:
p35319
aVTo convert a  object to a  object, use the  method and add a  object in the mix:
p35320
aVBy calling  on a  instance you can get a  object again:
p35321
as(dp35322
g16
V100297
p35323
stp35324
a((dp35325
g2
(lp35326
VPython functions are objects too
p35327
aVYou can pass them around like any other object:
p35328
aVSimply pass a function as an extra parameter to your  function and use that as a local variable
p35329
as(dp35330
g16
V100297
p35331
stp35332
a((dp35333
g2
(lp35334
VUse a  for ease:
p35335
aVThis creates:
p35336
aVis a subclass of  so it'll still work just like any other
p35337
aVWithout  you'll have to test if the key is already present with :
p35338
aVresulting in:
p35339
aVThe real trick here is using  to combine your key and value lists instead of your double loops
p35340
as(dp35341
g16
V100297
p35342
stp35343
a((dp35344
g2
(lp35345
VUse  to replace elements
p35346
aVAdapting the documentation example to your example gives:
p35347
as(dp35348
g16
V100297
p35349
stp35350
a((dp35351
g2
(lp35352
VYou are defining a class, so there is no instance to point to outside methods
p35353
aVDrop the `self:
p35354
aVpoints to the instance, not the class
p35355
aVYou either need to create an instance and assign directly to attributes () or you need to be inside a method (when  can actually refer to an instance)
p35356
as(dp35357
g16
V100297
p35358
stp35359
a((dp35360
g2
(lp35361
VYou need to call the  function
p35362
aVThere is no real need to test for , simply test for  itself:
p35363
aVEmpty strings evaluate to  in a boolean context
p35364
as(dp35365
g16
V100297
p35366
stp35367
a((dp35368
g2
(lp35369
VThe difference is in the capturing group
p35370
aVWith a capturing froup,  returns only what was captured
p35371
aVWithout a capturing group, the whole match is returned
p35372
aVIn your first example, the group only captures the two characters, repeated or not
p35373
aVIn the second example, the whole match includes any repetitions
p35374
aVThe  documentation is quite clear on the difference:
p35375
aVReturn all non-overlapping matches of pattern in string, as a list of strings
p35376
aV[\u2026] If one or more groups are present in the pattern, return a list of groups; this will be a list of tuples if the pattern has more than one group
p35377
aVIf your  pattern is part of a larger pattern and you want  to only return the full repeated set of characters, use a non-capturing group for the two-letter options with a capturing group around the whole:
p35378
as(dp35379
g16
V100297
p35380
stp35381
a((dp35382
g2
(lp35383
VIn this specific case, there is no need to import  at all
p35384
aVAlter  to remove the import:
p35385
aVSQLAlchemy postpones resolving references given as strings until the last possible moment anyway, so it doesn't matter here that  is defined yet or not
p35386
aVYou are referring to it in the  relationship via a string
p35387
as(dp35388
g16
V100297
p35389
stp35390
a((dp35391
g2
(lp35392
VUse a  offset of the beginning of this month:
p35393
aVreturns a new date that is at the start of the current month, after which subtracting a day is going to guarantee that we end up in the month before
p35394
aVThen we pull the same trick again to get the first day of that month
p35395
aVDemo (on Python 2
p35396
aV4 to be sure):
p35397
as(dp35398
g16
V100297
p35399
stp35400
a((dp35401
g2
(lp35402
VUse  to test if all characters are digits:
p35403
aVYou may want to turn your  string into a sequence of integers to make all your tests easier:
p35404
aVthen
p35405
aVetc
p35406
aVYou could easily build a sequence of tests with indices, an operator and the expected outcome:
p35407
as(dp35408
g16
V100297
p35409
stp35410
a((dp35411
g2
(lp35412
VYou'll have to move your keyword arguments to a variable keyword capture too:
p35413
aVPython will fill the two keyword arguments first otherwise, as in Python 2 there is no way to specify that these keywords cannot be filled by positional arguments
p35414
aVPython 3 changed the interpretation of the positional catchall parameter to make this possible without forcing you to use the  keyword parameter catch-all
p35415
aVIf you cannot change the function definition yourself or upgrade to Python 3, then your only recourse is to specify the defaults again, or retrieve them from the function (using the  convenience function):
p35416
aVhere is a tuple of the keyword argument default values
p35417
aVDemonstration:
p35418
as(dp35419
g16
V100297
p35420
stp35421
a((dp35422
g2
(lp35423
VUse the  module instead:
p35424
aVSubtracting two  values returns a  object, which has a  attribute
p35425
aVYour strings do contain a timezone offset, and you hardcoded it to match; if the value varies you'll have to use a parser that can handle the offset
p35426
aVThe  package includes both an excellent parser and the timezone support to handle this:
p35427
aVNote that because this result includes the timezone, you now need to use timezone-aware  objects when using date arithmetic:
p35428
aVI created a  variable in the above example based of the UTC timezone before calculating how long ago the parsed date was
p35429
as(dp35430
g16
V100297
p35431
stp35432
a((dp35433
g2
(lp35434
VJust register multiple entries in your crontab:
p35435
aVCron can handle such granularity just fine
p35436
as(dp35437
g16
V100297
p35438
stp35439
a((dp35440
g2
(lp35441
VYou can only use a  statement in a function
p35442
aVYour code doesn't define a function at all
p35443
as(dp35444
g16
V100297
p35445
stp35446
a((dp35447
g2
(lp35448
VYou'll have to copy the object state
p35449
aVThe easiest way would be to use the  module:
p35450
aVThis is not guaranteed to work
p35451
aVAll the pickle module does for you in the general case is to pickle the instance attributes, and restore the instance a-new from the class reference and restore the attribute contents on that
p35452
aVSince this is a C extension object, if the instance state is not exposed to you, and pickling is not explicitly supported by the type, this won't work either
p35453
aVIn that case, you have no other options, I'm afraid
p35454
as(dp35455
g16
V100297
p35456
stp35457
a((dp35458
g2
(lp35459
VYou check for the length:
p35460
aVor you catch the  exception:
p35461
aVWhat you use depends on how often you can expect there to be a 4th value
p35462
aVIf it is usually there, use the exception handler (better to ask forgiveness); if you mostly do not have a 4th value, test for the length (look before you leap)
p35463
as(dp35464
g16
V100297
p35465
stp35466
a((dp35467
g2
(lp35468
VUse a list comprehension plus :
p35469
aVrearranges your list of lists to become a list of columns instead
p35470
aVobjects count how often anything appears in the input sequence, and  gives us the most popular element (plus it's count)
p35471
aVProvided your input is single character strings, that gives:
p35472
as(dp35473
g16
V100297
p35474
stp35475
a((dp35476
g2
(lp35477
VYou need to call :
p35478
aVWithout the  you are merely referencing the method, not invoking it
p35479
aVNext, your  function doesn't return anything:
p35480
as(dp35481
g16
V100297
p35482
stp35483
a((dp35484
g2
(lp35485
VYes, by using negative indices:
p35486
aVNegative indices in a slice are relative to the sequence length
p35487
as(dp35488
g16
V100297
p35489
stp35490
a((dp35491
g2
(lp35492
VYou still use  but then request just the  portion:
p35493
aVDemonstration:
p35494
as(dp35495
g16
V100297
p35496
stp35497
a((dp35498
g2
(lp35499
VYou are opening a new file in append + write mode
p35500
aVBecause there is no file to append to, you get one in read + write mode instead
p35501
aVThis is essentially the same thing
p35502
aVThere is no problem here, you can still both read from and write to the file
p35503
aVUnder the hood, the file is still open in append mode, but the  attribute gives a simpler view on the file; it merely will report what you can do with the file now, not what happened when you opened the file
p35504
aVIt shows only if you can read or write the file and if the file was opened for exclusive creating ( mode)
p35505
aVSee the C code for the  attribute
p35506
aVUpdate: Yes, this is confusing, and really a bug
p35507
aVThe path to fix this discrepancy has recently been merged into Python, and when new releases of Python 2
p35508
aV7, 3
p35509
aV3 and 3
p35510
aV4 come out file objects'  attribute will better reflect the original mode string used to open the file
p35511
as(dp35512
g16
V100297
p35513
stp35514
a((dp35515
g2
(lp35516
VFirst of all, some types are immutable
p35517
aVand  are immutable, for example, and so is a plain  instance
p35518
aVThe same limitation does not apply to subclasses; you can subclass  and give it mutable attributes, the same applies to
p35519
aVThe  attribute is added to custom classes by the class builder (); it is the namespace mapping for the class; attribute lookups on a class are translated to key lookups in that structure
p35520
aVon the other hand is a Python C type, and attributes and methods in C are handled differently
p35521
aVPython C types are expected to implement the C Type interface instead
p35522
aVFor some types  can be dereferenced but you'll find it is a read-only proxy object instead as C types cannot be altered dynamically the way custom types can
p35523
aVThe  attribute is available on  and :
p35524
aVbut because these are built-in types the attribute makes little sense really and is not listed in
p35525
aVThe  attribute is an implementation detail of the  module
p35526
aVTogether with the  attribute the  constructor sets this attribute on custom classes, if no  attribute has been set on the class
p35527
aVLike the  attribute you found another difference between custom classes and C-type objects
p35528
aVFor Python C types, different entries in the C type object structure fill the same role
p35529
as(dp35530
g16
V100297
p35531
stp35532
a((dp35533
g2
(lp35534
VIf a tag doesn't exist,  indeed returns
p35535
aVSimply test for that value:
p35536
aVYou already use  on event to test for the  the attribute; it returns  as well if the attribute does not exist
p35537
aVAttributes are stored in the  dictionary, so you can use standard Python techniques to test for the attribute explicitly too:
p35538
as(dp35539
g16
V100297
p35540
stp35541
a((dp35542
g2
(lp35543
VThe Python DBAPI was written well before context managers were added to the Python language
p35544
aVAs such, different database libraries made their own decisions on how to implement context manager support (if they implemented it at all)
p35545
aVUsually using the database as a context manager ties you to a transaction
p35546
aVThe transaction is started on , and committed or aborted on , depending on wether or not there was an exception
p35547
aVAs such, you are supposed to use the MySQL connection as a context manager after connecting seperately:
p35548
aVThe  context manager implementation is subtly different; it also manages transactions, but does not return a cursor from the  method:
p35549
aVTechnically, it just returns  on
p35550
as(dp35551
g16
V100297
p35552
stp35553
a((dp35554
g2
(lp35555
VThe  call did not return eleven elements
p35556
aVPerhaps it is empty
p35557
aVYou probably want to use the  module instead to parse these files
p35558
as(dp35559
g16
V100297
p35560
stp35561
a((dp35562
g2
(lp35563
VI don't think  supports this (very well); see the discussion in this requests ticket, specifically
p35564
aVand can close the socket early in a way that breaks httplib
p35565
aVThe author of that comment, Augie Fackler (durin42) also mentions his own  library
p35566
aVA quick glance at the source code shows promise that it does handle  correctly:
p35567
as(dp35568
g16
V100297
p35569
stp35570
a((dp35571
g2
(lp35572
VYou are looking for the next element in these cases:
p35573
aVGoing to the parent would work but then look for the  attribute instead:
p35574
aVDemonstration:
p35575
as(dp35576
g16
V100297
p35577
stp35578
a((dp35579
g2
(lp35580
VYou cannot
p35581
aVuses the Python iteration protocol, which for lists means it'll create a private iterator object
p35582
aVThat object keeps track of the position in the list
p35583
aVEven if you were to create the iterator explicitly with , the current position is not a public property on that object:
p35584
aVThe point of the iteration protocol is that it lets you treat any sequence, even one that continues without bounds, in exactly the same way
p35585
aVIt is trivial to create a sequence generator that does not have a position:
p35586
aVThat generator will toggle between  and  values as you iterate over it
p35587
aVThere is no position in a sequence there, so there is no point exposing a position either
p35588
aVJust stick to
p35589
aVAll that  has to do is keep a counter
p35590
aVIt doesn't keep position in the wrapped iterator at all
p35591
aVIncrementing that integer does not cost you much performance or memory
p35592
aVis basically this, implemented in C:
p35593
aVBecause it is implemented in C, it'll beat trying to read an attribute on the original iterator any day, which would require more bytecode operations in each iteration
p35594
as(dp35595
g16
V100297
p35596
stp35597
a((dp35598
g2
(lp35599
VFor completeness sake, here is how you'd generate that exact SQL with using :
p35600
aVwhich results in:
p35601
aVAlternatively you could use a  object to specify the interval instead:
p35602
as(dp35603
g16
V100297
p35604
stp35605
a((dp35606
g2
(lp35607
V takes each row a regular  would return and turns that into a dictionary based on the fieldnames you passed in or read from the first row
p35608
aVThis is by design
p35609
aVIf your input file contains just one row, return that by calling  on the reader:
p35610
aVDo note that the  call should be within the  block, otherwise the file will be closed before you could read from it
p35611
aVIf you need the rows merged into one dictionary, you need to state how you want to see the data merged
p35612
aVYou can easily merged the rows into lists per key:
p35613
aVWe don't need a  anymore at that point, as we are not building a dictionary per row here
p35614
as(dp35615
g16
V100297
p35616
stp35617
a((dp35618
g2
(lp35619
VCompact version with  and :
p35620
aVDemo:
p35621
aVBreaking this down:
p35622
aVpairs counts with values:
p35623
aVIt is a fairly standard Python trick to get pairs out of a input iterable
p35624
aVis a generator expression that takes the counts and values and produces lists with the value repeated count times:
p35625
aVtakes the various lists produced by the generator expression and lets you iterate over them as if they were one long list
p35626
aVturns it all back to a list
p35627
as(dp35628
g16
V100297
p35629
stp35630
a((dp35631
g2
(lp35632
VTurn the list into a tuple instead:
p35633
aVDemo:
p35634
aVAlternatively, use the  method instead to format your string:
p35635
aValso supports indexing into the list:
p35636
as(dp35637
g16
V100297
p35638
stp35639
a((dp35640
g2
(lp35641
VYou cannot do what you want with one regular expression
p35642
aVUnescaping  after splitting is a separate task altogether, not one that you can get the  module to do for you while splitting at the same time
p35643
aVJust keep the task separate; you could use a generator to do the unescaping for you:
p35644
aVbut that won't be faster than your list comprehension
p35645
as(dp35646
g16
V100297
p35647
stp35648
a((dp35649
g2
(lp35650
VYour nested  XML document uses a namespace
p35651
aVI'd use:
p35652
aVto match the  element with a shorter XPath expression (ignoring the namespace altogether)
p35653
aVThe alternative is to use a prefix-to-namespace mapping and use those on your tags:
p35654
as(dp35655
g16
V100297
p35656
stp35657
a((dp35658
g2
(lp35659
VYou want to use  in that case:
p35660
aVwould return both the columns and the whitespace so you can rejoin the line later with the same amount of whitespace included
p35661
aVExample:
p35662
aVYou probably do want to remove the newline from the end
p35663
as(dp35664
g16
V100297
p35665
stp35666
a((dp35667
g2
(lp35668
VIf you use nginx to sanitize the HTTP_HOST and SERVER_NAME fields, you are doing the right thing and do not need to worry about Host header poisining
p35669
aVLike Django, Pyramid considers a large part of this the task of the WSGI host environment
p35670
aVAnd nginx does an excellent, battle-hardened job of sanitizing the HTTP request information
p35671
as(dp35672
g16
V100297
p35673
stp35674
a((dp35675
g2
(lp35676
VIf you want all the data assigned to variables per column, start with a list:
p35677
aVAnd only then turn that into a list of columns:
p35678
aVThis is now a list of lists;  is the first column of data
p35679
aVYou really want to use the  module instead to read tabular data though
p35680
aVYour code, unfortunately, is not nearly close enough to working Python
p35681
aVYou assigned several variables the empty string, then tried to use them as lists
p35682
as(dp35683
g16
V100297
p35684
stp35685
a((dp35686
g2
(lp35687
V is already the right element:
p35688
aVPython  loops give you the element itself, not an index into the sequence
p35689
as(dp35690
g16
V100297
p35691
stp35692
a((dp35693
g2
(lp35694
VYou need to remove the element from its parent; you'll need to get a reference to the parent directly though, there is no path from child back up
p35695
aVIn this case you'll have to get a reference to the  element at the same time as finding the  element
p35696
aVTrying to remove the tag from the root fails because the tag is not a direct child of the root
p35697
as(dp35698
g16
V100297
p35699
stp35700
a((dp35701
g2
(lp35702
VYou can use the  power operator to square values:
p35703
aVwhere  exponentiation has a higher precedence than multiplication or division
p35704
aVSo for a series of  coordinates, that'd be:
p35705
as(dp35706
g16
V100297
p35707
stp35708
a((dp35709
g2
(lp35710
VYou use a shebang line at the start of your script:
p35711
aVmake the file executable:
p35712
aVand put it in a directory on your PATH (can be a symlink):
p35713
as(dp35714
g16
V100297
p35715
stp35716
a((dp35717
g2
(lp35718
VDo not use string interpolation when executing SQL code
p35719
aVUse SQL parameters instead:
p35720
aVThis applies to any database interaction involving parameters, not just SQLLite
p35721
as(dp35722
g16
V100297
p35723
stp35724
a((dp35725
g2
(lp35726
VYou call the function reference stored in  with  as a parameter
p35727
aVis the instance of your  class:
p35728
aVThe default representation for your custom  class is
p35729
aVSince you did so explicitly, that is not something to worry about
p35730
as(dp35731
g16
V100297
p35732
stp35733
a((dp35734
g2
(lp35735
VJust call  once in your template:
p35736
aVFor information you want to use perhaps in a request, I'd use a request property; if you set  to  then it'll only calculated once and only when used:
p35737
aVthen
p35738
as(dp35739
g16
V100297
p35740
stp35741
a((dp35742
g2
(lp35743
VYou can use nested dictionaries:
p35744
aVTo make this a little easier, you can use :
p35745
aVor even:
p35746
aVDemo of the latter structure:
p35747
as(dp35748
g16
V100297
p35749
stp35750
a((dp35751
g2
(lp35752
VYou want to JSON-ify the data in the template; JSON is already Javascript really (it's a subset:
p35753
aVNote that  is already JSON (thus JavaScript) data and can be inserted directly; no need to escape (there is no HTML here, it's JavaScript instead)
p35754
aVOr you could use this Django snippet and do it straight in the template (no need to call  in the  method):
p35755
as(dp35756
g16
V100297
p35757
stp35758
a((dp35759
g2
(lp35760
VThe first iteration, you are slicing as , which is just the same as slicing from
p35761
aVOnly the second iteration do you slice as , then
p35762
aVPerhaps you could use a range starting at a negative index:
p35763
as(dp35764
g16
V100297
p35765
stp35766
a((dp35767
g2
(lp35768
VYou can register a hook to be run after commit via the  package
p35769
aVRegister one in your view:
p35770
aVThis still runs your script in the context of the current request (e
p35771
ag1298
aVthe request does not complete until your script returns)
p35772
aVIf you need a full asynchronous setup, you'll need to move to a proper asynchronous solution such as Celery
p35773
aVYou would not use that with a transaction hook; just register a task to be run with Celery instead
p35774
as(dp35775
g16
V100297
p35776
stp35777
a((dp35778
g2
(lp35779
VYou need to put quotes around your URL:
p35780
aVThe  character is a shell meta character, it puts the command in the background
p35781
aVAs a result you are not passing the full URL to the server but put the command  in the background instead
p35782
aVThis is why the shell echos  to you; you put a fourth job so far into the jobs queue, it was given the PID 8822
p35783
aVThe remaining command is then:
p35784
aVwhich will not produce valid JSON indeed:
p35785
aVYou can see the job you put into the background complete on the next line:
p35786
aVWith the quotes the command produces:
p35787
aVPresumably for you it'll produce more useful information as clearly I don't have the right access token for my IP address
p35788
aV:-)
p35789
as(dp35790
g16
V100297
p35791
stp35792
a((dp35793
g2
(lp35794
VYou want to avoid using  in this case; write your input directly to the  pipe of the  object instead
p35795
aVDo make sure your environment is set to the correct locale so that  knows to parse the input as UTF-8:
p35796
as(dp35797
g16
V100297
p35798
stp35799
a((dp35800
g2
(lp35801
V is a tab character
p35802
aVUse a raw string instead:
p35803
aVor double the slashes:
p35804
aVor use forward slashes instead:
p35805
as(dp35806
g16
V100297
p35807
stp35808
a((dp35809
g2
(lp35810
VYou inspect the  attribute of those classes:
p35811
aVDemo:
p35812
as(dp35813
g16
V100297
p35814
stp35815
a((dp35816
g2
(lp35817
VYour name error does not occur in the method
p35818
aVIt occurs before the method is called
p35819
aVPython tries to resolve  before it can pass the value of  to the  method
p35820
aVThe method code is never executed
p35821
aVYou'd get the same error if you just typed  in your shell, you did not define it so Python doesn't know how to use it's value then either
p35822
as(dp35823
g16
V100297
p35824
stp35825
a((dp35826
g2
(lp35827
VPeewee is not Python 3 compatible; it only works with Python 2 at the moment
p35828
aVThe error you see is a result of that; the  class defines a metaclass using Python 2 techniques, which have changed for Python 3
p35829
aVUpdate: Version 2
p35830
aV1, released 2013-04-02, adds Python 3 compatibility
p35831
aVThe package now supports Python 2
p35832
aV6, 2
p35833
aV7, and 3
p35834
aV2 and up
p35835
as(dp35836
g16
V100297
p35837
stp35838
a((dp35839
g2
(lp35840
VYou need to actually add your new  object to the database first:
p35841
aVSee the Flask-SQLAlchemy documentation on insertion:
p35842
aVBefore you add the object to the session, SQLAlchemy basically does not plan on adding it to the transaction
p35843
aVThat is good because you can still discard the changes
p35844
aVFor example think about creating the post at a page but you only want to pass the post to the template for preview rendering instead of storing it in the database
p35845
aVThe  function call then adds the object
p35846
as(dp35847
g16
V100297
p35848
stp35849
a((dp35850
g2
(lp35851
VYou need to decode the returned value to a  object:
p35852
aVwould interpret the byte as a ASCII codepoint, for example
p35853
aVYou may need to use a different encoding depending on the keyboard layout and locale, but the  API specifically only deals with ASCII characters according to the documentation:
p35854
aVThe module implements both the normal and wide char variants of the console I/O api
p35855
aVThe normal API deals only with ASCII characters and is of limited use for internationalized applications
p35856
aVThe wide char API should be used where ever possible
p35857
aVYou probably want to use  instead to get Unicode values directly; the method supports more than just ASCII codepoints as well
p35858
as(dp35859
g16
V100297
p35860
stp35861
a((dp35862
g2
(lp35863
VLoop over the file to read lines:
p35864
aVFile objects are iterable and yield lines until EOF
p35865
aVUsing the file object as an iterable uses  a buffer to ensure performant reads
p35866
aVYou can do the same with the stdin (no need to use :
p35867
aVTo complete the picture, binary reads can be done with:
p35868
aVwhere  will contain up to 1024 bytes at a time from the file
p35869
as(dp35870
g16
V100297
p35871
stp35872
a((dp35873
g2
(lp35874
VFirst you need to determine the max value:
p35875
aVthen construct your  dictionary:
p35876
aVFor Python 3, substitute  and  with  and  respectively
p35877
aVIt is easier to find one key-value pair that is the maximum:
p35878
as(dp35879
g16
V100297
p35880
stp35881
a((dp35882
g2
(lp35883
VPython opens files in text mode by default
p35884
aVFiles open in text mode have platform-native newline conventions translated to  automatically
p35885
aVYou opened a file using the  newline convention, on Windows most probably
p35886
aVOpen the file in binary mode if you do not want this translation to take place
p35887
aVSee the documentation of the  function for more details:
p35888
aVThe default is to use text mode, which may convert  characters to a platform-specific representation on writing and back on reading
p35889
aVThus, when opening a binary file, you should append  to the mode value to open the file in binary mode, which will improve portability
p35890
as(dp35891
g16
V100297
p35892
stp35893
a((dp35894
g2
(lp35895
VUse a unicode path instead:
p35896
aVWindows paths are UTF-16 encoded, but Python knows how to handle unicode paths correctly and translates these to the correct filesystem encoding for your platform
p35897
as(dp35898
g16
V100297
p35899
stp35900
a((dp35901
g2
(lp35902
VThe Python  module does not provide access to that information
p35903
aVThe source code skips over it without ever storing it:
p35904
aVThe filename component is optional, not guaranteed to be present (the commandline  decompression option would use the original filename sans  in that case, I think)
p35905
aVThe uncompressed filesize is not stored in the header; you can find it in the last four bytes instead
p35906
aVTo read the filename from the header yourself, you'd need to recreate the file header reading code, and retain the filename bytes instead
p35907
aVThe following function returns that, plus the decompressed size:
p35908
aVUse the above function with an already-created  object:
p35909
as(dp35910
g16
V100297
p35911
stp35912
a((dp35913
g2
(lp35914
VDon't set it as a global in the function
p35915
aVInstead, just return the new instance from the function and set the global to that return value:
p35916
aVthen in :
p35917
aVwhere, if inside a function, you declare  a
p35918
aVThe  method only ever returns the globals of the module in which you call it
p35919
aVIt'll never return the globals of whatever is calling the function
p35920
aVIf you feel you need to have access to those globals, rethink your code, you rarely, if ever, need to alter the globals of whatever is calling your function
p35921
aVIf you are absolutely certain you need access to the caller globals, you need to start hacking with stack frames:
p35922
aVBut, as the documentation of  states:
p35923
aVCPython implementation detail: This function should be used for internal and specialized purposes only
p35924
aVIt is not guaranteed to exist in all implementations of Python
p35925
as(dp35926
g16
V100297
p35927
stp35928
a((dp35929
g2
(lp35930
VThe return value of  is uniformly distributed across the range [0
p35931
aV0, 1
p35932
aV0) (so from 0
p35933
aV0 inclusive to 1
p35934
aV0 exclusive), so it has a equal chance of hitting any value in that range
p35935
aVThat means that 87% of the time, values below
p35936
aV87 are chosen
p35937
aVIf you were to change this to a test for , that test would pass always, 100% of the time
p35938
aVIf you would change it to , it'd never pass, so 0% of the time
p35939
aVAnd since the distribution is uniform,  would be  half of the time, since the other half of the time values in the range [0
p35940
aV5, 1
p35941
aV0) would be picked instead
p35942
aVYou could look at it as a dice roll; 100% of the time, you'll roll a value < 7 with a standard 6-sided dice
p35943
aV0% of the time you'll roll a value < 1, 50% of the time you'll roll a value < 4 (1, 2 or 3), and 66
p35944
aV67% of the time you'd roll a value less than 5 (so 2/3rds of all your rolls)
p35945
aVThe  return value just has a much larger range than just 6 distinct values
p35946
as(dp35947
g16
V100297
p35948
stp35949
a((dp35950
g2
(lp35951
VPython 2 includes the same  library too
p35952
aVUse  to work the same across Python versions
p35953
aVYour API should then offer a  equivalent (called  or ) that uses the  class library to provide the same functionality
p35954
aVAll that you need to do is create a class that implements the  ABC, then use the other classes provided by the library to add buffering and text handling as needed:
p35955
aVThe above code is mostly adapted from the   function, but with the raw file object replaced by the  subclass of the  ABC
p35956
as(dp35957
g16
V100297
p35958
stp35959
a((dp35960
g2
(lp35961
VYou'll need to set the property on the class (since it is a descriptor), so using a  call in the initializer is not going to work
p35962
aVYou could use a class decorator to set the properties from a pattern:
p35963
aVThen use that as:
p35964
as(dp35965
g16
V100297
p35966
stp35967
a((dp35968
g2
(lp35969
VThis should do it:
p35970
aVThe generator expression lists all key 'paths' to the values first, then sorts those on the value, reversed
p35971
aVDemo:
p35972
as(dp35973
g16
V100297
p35974
stp35975
a((dp35976
g2
(lp35977
VYou need to bind  properly:
p35978
aVThe  variable then is made local to
p35979
aVAnother option is to use a new scope (separate function) generating your method:
p35980
as(dp35981
g16
V100297
p35982
stp35983
a((dp35984
g2
(lp35985
VRead in all rows (mapping all the values to floats), transform to columns using , only keep any that are have non-zero values using , transform back to rows using :
p35986
aVThe latter step as a demonstration:
p35987
as(dp35988
g16
V100297
p35989
stp35990
a((dp35991
g2
(lp35992
VFormat it to 6 decimal places:
p35993
aVDemo:
p35994
aVThe  function turns values to strings following the formatting instructions given
p35995
as(dp35996
g16
V100297
p35997
stp35998
a((dp35999
g2
(lp36000
VCreate new  objects for uploaded portraits:
p36001
aVwhere  is either an open file object or the image data as a string
p36002
as(dp36003
g16
V100297
p36004
stp36005
a((dp36006
g2
(lp36007
V returns a list, you want to swap your line:
p36008
aVwhich sorts the letters in , then turns the resulting sorted list into a tuple
p36009
as(dp36010
g16
V100297
p36011
stp36012
a((dp36013
g2
(lp36014
VUse  to combine the string and slice lists, then use a  plus  trick to pair the start and stop values:
p36015
aVNote that we have to add 1 to the stop index, as your appear to need it to be inclusive, while in Python the stop index is exclusive
p36016
aVThis gives:
p36017
as(dp36018
g16
V100297
p36019
stp36020
a((dp36021
g2
(lp36022
Vis a built-in type, you can use  or  or whatever instead
p36023
aVIt doesn't really matter here, it is just a local variable name
p36024
aVThere is no requirement for it to be named anything specific as it is a positional parameter
p36025
aVThe datamodel documentation uses
p36026
aVUsing  and  is more than fine there
p36027
aVIn fact, the  of a metaclass can be passed additional keyword arguments, so it is good practice to pass those on to the super  method
p36028
aVI'd use  and  when I don't care about the parameters
p36029
aVThat way you future-proof the method
p36030
aVNote that in Python 3, you no longer need to give  any arguments:
p36031
as(dp36032
g16
V100297
p36033
stp36034
a((dp36035
g2
(lp36036
VThe  and  operators short-circuit
p36037
aVThey return early when the outcome is a given
p36038
aVFor  that means that if the first expression is , then there is no point in looking at the second expression as it doesn't matter:
p36039
aVThe same goes for , but only when the first value evaluates to ; in that case the expression is always going to evaluate to  whatever the second expression is going to come to:
p36040
aVSee Boolean expressions:
p36041
aVThe expression  first evaluates ; if  is false, its value is returned; otherwise,  is evaluated and the resulting value is returned
p36042
aVThe expression  first evaluates ; if  is true, its value is returned; otherwise,  is evaluated and the resulting value is returned
p36043
as(dp36044
g16
V100297
p36045
stp36046
a((dp36047
g2
(lp36048
VYou are storing the whole wordlist
p36049
aVYou want to store just the matching words for each sorted tuple of letters:
p36050
aVThis creates a list for the given key (letter tuple) if the key is not there yet, otherwise just appends the word
p36051
aVYou can simplify this by using :
p36052
aVbecause then you don't need to explicitly test for the key each time
p36053
as(dp36054
g16
V100297
p36055
stp36056
a((dp36057
g2
(lp36058
VYou are using the decoded unicode value
p36059
aVUse  raw response data instead:
p36060
aVwhich will read the data from the response directly; do note the  option to
p36061
aVAlternatively, use the binary  attribute:
p36062
aVUse this when the response is gzip or deflate compressed; the raw socket returns data uncompressed
p36063
as(dp36064
g16
V100297
p36065
stp36066
a((dp36067
g2
(lp36068
VCreate a copy of :
p36069
aVor use:
p36070
aVboth of which copy the indices over to a new list
p36071
as(dp36072
g16
V100297
p36073
stp36074
a((dp36075
g2
(lp36076
VOne of them prints each value separately, in a loop, but tells the  function to print a space after each value instead of a newline
p36077
aVThe second version prints all values in one go, with spaces in between and a newline at the end
p36078
aVEach value in  is passed to the  function as separate arguments, as if you issued the expression  instead
p36079
aVThere is thus a difference
p36080
aVThe first version prints:
p36081
aVwhile the second version prints:
p36082
as(dp36083
g16
V100297
p36084
stp36085
a((dp36086
g2
(lp36087
VThe  returned by  has a  method; by default it returns the end position for which your whole regular expression matched
p36088
aVYou can also pass the method a group to find the end point of for that specific group, with the  group being the whole pattern
p36089
aVDemonstration:
p36090
as(dp36091
g16
V100297
p36092
stp36093
a((dp36094
g2
(lp36095
VRaise the exception in the except handler:
p36096
aVThe  suite is always going to be executed wether or not you re-raised the exception
p36097
aVFrom the documentation:
p36098
aVIf  is present, it specifies a \u2018cleanup\u2019 handler
p36099
aVThe  clause is executed, including any  and  clauses
p36100
aVIf an exception occurs in any of the clauses and is not handled, the exception is temporarily saved
p36101
aVThe  clause is executed
p36102
aVIf there is a saved exception it is re-raised at the end of the  clause
p36103
aVNote that if the  suite uses a  or  statement, the saved exception is discarded:
p36104
aVIf the  clause executes a return or break statement, the saved exception is discarded:
p36105
aVbut if you issue a ,  or  in the  suite, the  suite is executed still:
p36106
aVWhen a ,  or  statement is executed in the  suite of a
p36107
aVstatement, the  clause is also executed \u2018on the way out
p36108
aV\u2019
p36109
aVNote that before Python 2
p36110
aV5, you could not even combine  and  suites in the same  statement; see PEP 341: Unified try/except/finally
p36111
aVInstead, you were expected to nest  statements:
p36112
as(dp36113
g16
V100297
p36114
stp36115
a((dp36116
g2
(lp36117
V converts an integer number to a hex representation, a string
p36118
aVreturns a string value instead
p36119
aVYou want to just store the value the user entered directly:
p36120
aVYou could then verify that it is a hexadecimal number by trying to convert it to a decimal with :
p36121
as(dp36122
g16
V100297
p36123
stp36124
a((dp36125
g2
(lp36126
VYou can alter the sorting key by passing in  argument to  function:
p36127
aVThe  key given returns the row minus the initial column, effectively ignoring it when sorting
p36128
aVWe also ask for a reverse sort, so larger values first
p36129
aVThis results in:
p36130
as(dp36131
g16
V100297
p36132
stp36133
a((dp36134
g2
(lp36135
VYou want a , a python mapping instead, and read the file only once:
p36136
aVThe  call splits the line on whitespace, giving you a name and a timer string for each line
p36137
aVNow  returns a mapping containing all swimmer names as the keys, and their times as values
p36138
aVYou can simply look up each and every swimmer:
p36139
as(dp36140
g16
V100297
p36141
stp36142
a((dp36143
g2
(lp36144
VOnly execute one statement at a time with the  method
p36145
aVWithin a transaction, there is never a need to execute two statements in one call like that; the integrity error exception will already raise and abort the transaction:
p36146
as(dp36147
g16
V100297
p36148
stp36149
a((dp36150
g2
(lp36151
VYou got your indentation wrong:
p36152
aVIndentation is significant in Python; your version declared the  loop outside of the  function, so it was run immediately
p36153
aVSince  is a local variable to  only, it is not defined outside of the function and you get a
p36154
as(dp36155
g16
V100297
p36156
stp36157
a((dp36158
g2
(lp36159
VYou are missing component registrations, usually registered when loading the ZCML files in a site
p36160
aVYou want to end up with the possibility to run  instead, which leaves all the tedious site and ZCML loading to Zope
p36161
aVOnce you have that running reliably, you can then access the site in a script that sets up the local component manager and a security manager:
p36162
aVSave this script somewhere, and run it with:
p36163
as(dp36164
g16
V100297
p36165
stp36166
a((dp36167
g2
(lp36168
VThe  package is not Python 3 compatible, it'll only work on Python 2
p36169
aVSpecifically, the error is because the  module uses relative imports, a technique removed from Python 3
p36170
aVThe repository issue tracker does have a Python 3 compatibility patch you could try out
p36171
as(dp36172
g16
V100297
p36173
stp36174
a((dp36175
g2
(lp36176
VYou need to move the file to your package, and list it in your :
p36177
aVSee the  documentation for , which includes a utility function for automating adding data files
p36178
aVThe files will be added in your app root
p36179
aVFrom your main script, you can determine your app root by using:
p36180
as(dp36181
g16
V100297
p36182
stp36183
a((dp36184
g2
(lp36185
VMaking that a function is easy:
p36186
aVApplying that to your  isn't that hard either:
p36187
aVThis gives (with a repaired  input sample):
p36188
aVThis does assume you have 2 dates for each data point; you'd need to adjust the function to test for fewer dates if you only havetup 1
p36189
aVTo generate  in the first place:
p36190
aVwhich generates:
p36191
as(dp36192
g16
V100297
p36193
stp36194
a((dp36195
g2
(lp36196
VYou want to loop over , the decoded JSON structure, instead:
p36197
aVor, simplifying it to use  instead:
p36198
aVThis assumes that the data from the  call is a list though, I think you simply wanted to treat the result as a dictionary instead:
p36199
aVIt sounds (from the comments) as if some of the responses return a list instead
p36200
aVTry this to figure out what is going on:
p36201
aVYour code was looping over the JSON data string instead, character by character, so you were trying to apply  to a python string:
p36202
as(dp36203
g16
V100297
p36204
stp36205
a((dp36206
g2
(lp36207
VIt redirects the  statement output to an open file-like object
p36208
aVSee the  statement documentation:
p36209
aValso has an extended form, defined by the second portion of the syntax described above
p36210
aVThis form is sometimes referred to as \u201cprint chevron
p36211
aV\u201d In this form, the first expression after the  must evaluate to a \u201cfile-like\u201d object, specifically an object that has a  method as described above
p36212
aVWith this extended form, the subsequent expressions are printed to this file object
p36213
aVIf the first expression evaluates to , then  is used as the file for output
p36214
aVEssentially, the line is translated to print` adds a newline to it's output unless the expression ends with a comma
p36215
aVThe syntax is based on the bash append  syntax (which also influenced C++  and  I/O operators); see PEP 214 for a full motivation for why this was chosen
p36216
aVIn Python 3, where  is a function, you'd write:
p36217
aVinstead
p36218
as(dp36219
g16
V100297
p36220
stp36221
a((dp36222
g2
(lp36223
VYou could add  to it:
p36224
aVbut that only works for original values < , as beyond that the overflow will run into positive numbers, or worse, overflow again
p36225
as(dp36226
g16
V100297
p36227
stp36228
a((dp36229
g2
(lp36230
VYou need to tell  to use a space instead of a newline after each printed line:
p36231
aVwith an extra  at the end to print a final newline
p36232
aVAlternatively, pass a joined string to :
p36233
as(dp36234
g16
V100297
p36235
stp36236
a((dp36237
g2
(lp36238
VYour pattern should work just fine for your example, but correcting your pattern a little to actually match your intention:
p36239
aVThis matches 1 initial letter (lower or uppcase), followed by 0 or more letters, digits and underscores
p36240
aVYour version had a redundant , and included  in what was allowed for the first character, and  for the rest of the name
p36241
aVA demonstration to show this matches all your samples:
p36242
aVThe pattern does not match any , , ,  or  characters that might follow the variable name:
p36243
as(dp36244
g16
V100297
p36245
stp36246
a((dp36247
g2
(lp36248
VYour data is not UTF8 encoded; more likely it is using the Latin-1 encoding:
p36249
aVCalling  is enough, no need to also call
p36250
as(dp36251
g16
V100297
p36252
stp36253
a((dp36254
g2
(lp36255
VUse :
p36256
aVThe  argument is needed here to extract just the part of the value you wanted to group on; the first 3 characters
p36257
aVResult:
p36258
aVwill combine successive keys that are equal into 1 group
p36259
aVIf you have disjoint groups (so same value, but with other values in between) it'll create separate groups for those:
p36260
aVIf that is not what you want you will have to sort  first
p36261
as(dp36262
g16
V100297
p36263
stp36264
a((dp36265
g2
(lp36266
VYou can use the  function:
p36267
aVis a named tuple with 4 elements:
p36268
aVA list with the argument names
p36269
aVThe name of the catchall  parameter, if defined ( otherwise)
p36270
aVThe name of the catchall  parameter, if defined ( otherwise)
p36271
aVA tuple with default values for the keyword arguments; they go with the last elements of the arguments; match these by length of the default values tuple
p36272
aVDemo:
p36273
as(dp36274
g16
V100297
p36275
stp36276
a((dp36277
g2
(lp36278
VIndeed,  is not Python 3 compatible
p36279
aVThere is a issue on Python 3 in the issue tracker for the project, but there is next to no content in that issue
p36280
aVThere does not appear to be any effort towards a port yet
p36281
as(dp36282
g16
V100297
p36283
stp36284
a((dp36285
g2
(lp36286
VBy default, your objects are only stored in the  using weak references, meaning that you can simply delete your own references to the objects to clear them from memory
p36287
aVThat said, you are free to call  to remove any thing still held by the session
p36288
aVDon't call this if you have changes that need to be committed, issue a  first
p36289
aVYou can expunge individual  objects with the  method too
p36290
aVSee Using the Session for more details
p36291
as(dp36292
g16
V100297
p36293
stp36294
a((dp36295
g2
(lp36296
VYour  of s adds an extra layer
p36297
aVYou have 3 layers of items:
p36298
aVThe outer list of length 1 million, so 1 million pointers
p36299
aV1 million 2-slot tuples, so 2 million pointers
p36300
aV2 million references to 1 million integer values
p36301
aVwhile your  only holds:
p36302
aVThe dict (including 1 million cached hashes) with 2 million pointers + extra space to grow the table
p36303
aV2 million references to 1 million integer values
p36304
aVIt's those 1 million tuples plus the list to hold the references to them that take up more memory than the 1 million cached hashes
p36305
aVThere are some 50% more pointers involved here, easily accounting for the 50% more memory use you see
p36306
aVThere is another downside to your list of tuples: lookup time
p36307
aVTo find a matching key in the dict, there is a O(1) complexity cost
p36308
aVTo do the same in the list of tuples, you have to potentially scan the whole list for a O(n) cost
p36309
aVDon't use a list of tuples if you need to map keys to values
p36310
as(dp36311
g16
V100297
p36312
stp36313
a((dp36314
g2
(lp36315
V takes a naive datetime object and interprets it as if it is in that timezone
p36316
aVIt does not move the time to another timezone
p36317
aVA naive datetime object has no timezone information to be able to make that move possible
p36318
aVYou want to interpret  in your local timezone instead, then use  to interpret the datetime in another timezone:
p36319
as(dp36320
g16
V100297
p36321
stp36322
a((dp36323
g2
(lp36324
VClass matching in BeautifulSoup matches per class in the class attribute
p36325
aVTo filter out elements that match more than the stated class, you can use a generator expression:
p36326
aVThis returns the first element that matches the class exactly with no other classes allowed
p36327
as(dp36328
g16
V100297
p36329
stp36330
a((dp36331
g2
(lp36332
VUse a  function:
p36333
aVThe  callable is passed each and every element in  and that element is sorted according to the return value
p36334
aVIn this case we
p36335
aVsplit once on whitespace, starting on the right
p36336
aVtake the last element of the split
p36337
aVturn that into an integer
p36338
aVThe argument to  can be any callable, but a lambda is just more compact
p36339
aVYou can try it out in the command prompt:
p36340
aVIn effect, when sorting the values are augmented with the return value of that function, and what is sorted is:
p36341
aVinstead (with the second value, the index of the element, added to keep the original order in case of equal sort keys)
p36342
aVResult:
p36343
as(dp36344
g16
V100297
p36345
stp36346
a((dp36347
g2
(lp36348
VSubparsers support all the methods a normal parser supports, including :
p36349
as(dp36350
g16
V100297
p36351
stp36352
a((dp36353
g2
(lp36354
VFor  you really want to use  instead:
p36355
as(dp36356
g16
V100297
p36357
stp36358
a((dp36359
g2
(lp36360
VSQLAlchemy takes care of the bind parameters and ordering
p36361
aVThere is no need to worry about that
p36362
aVYou specified in your SQLAlchemy ORM metadata definition that you are handling a date column
p36363
aVSQLAlchemy then handles the translation to the correct form for the backend database
p36364
aVThe error comes from SQLAlchemy, not SQLLite; SA translates date objects for you
p36365
aVThis goes both ways; even when using SQLLite, you can put date objects in, and when you query, you get date objects out again
p36366
aVThe reply to the post you link to talks about the same things there; use a  column if you wanted to store dates as strings, use  or  instances instead if you declare the column to be of type
p36367
aVYour  key is a string; use a  object instead to avoid the error:
p36368
as(dp36369
g16
V100297
p36370
stp36371
a((dp36372
g2
(lp36373
VYou'll need to read in the documents separately; here is a generator function that'll yield complete XML documents from a given file object:
p36374
aVThen use  to load and parse these:
p36375
as(dp36376
g16
V100297
p36377
stp36378
a((dp36379
g2
(lp36380
VThe comma is redundant
p36381
aVIt's just creating a one-element list:
p36382
aVThe practice comes from creating tuples in Python; a one-element tuple requires a comma:
p36383
aVThe  statement creates a new list with the value of  as the first element
p36384
as(dp36385
g16
V100297
p36386
stp36387
a((dp36388
g2
(lp36389
VYou'd use:
p36390
aVinstead of calling  again (which, in BeautifulSoup, gives the same result but does the work again)
p36391
aVThere is no 'conditional yield'
p36392
aVYou could play tricks with  but I'd recommend against that
p36393
as(dp36394
g16
V100297
p36395
stp36396
a((dp36397
g2
(lp36398
VIt'll be easier to just test for the length of the match afterwards
p36399
aVWith the optional  part, plus both the  and  multipliers in your expression, altering it to match 11 characters is going to be
p36400
aVtricky
p36401
aVYou could use the   and  methods to quickly access the length of the match:
p36402
as(dp36403
g16
V100297
p36404
stp36405
a((dp36406
g2
(lp36407
VStore the information found in file A in memory first, in a set
p36408
aVThen, reopen file A in append mode, and loop over file B
p36409
aVAny name from B not found in the set, can then be added to file A:
p36410
aVThe combined  line requires Python 2
p36411
aV7 or newer
p36412
aVIn earlier Python versions, simply nest the two statements:
p36413
as(dp36414
g16
V100297
p36415
stp36416
a((dp36417
g2
(lp36418
VWhy not just loop over the lists themselves instead
p36419
aVYou do not have indices now, you have the actual values:
p36420
aVIf you have to have the indices too, just use :
p36421
as(dp36422
g16
V100297
p36423
stp36424
a((dp36425
g2
(lp36426
VYou can advance  (which is an iterable) by two lines by calling  on it twice:
p36427
aVHowever, if you are trying to parse HTML, consider using a HTML parser instead
p36428
aVUse BeautifulSoup, for example
p36429
as(dp36430
g16
V100297
p36431
stp36432
a((dp36433
g2
(lp36434
VI'd use the  module with :
p36435
aVcauses  to be redirected to the open file, so we can simply 'print' the lines
p36436
aVThe  call is used to skip the first line; giving it a default  suppresses the  exception for an empty file
p36437
aVThis makes rewriting a large file more efficient as you only need to keep the  readlines buffer in memory
p36438
aVI don't think a  is needed at all, even for your solution; just use  there too, then use  to catch the remaining lines:
p36439
aVbut this requires you to read all of the file in memory; don't do that with large files
p36440
as(dp36441
g16
V100297
p36442
stp36443
a((dp36444
g2
(lp36445
VA new feature was added to Python 2
p36446
ag4892
aV3 that allows for dynamically created classes to be pickled
p36447
aVSee issue 7689:
p36448
aVCurrently, it's impossible to use the usual pickle mechanisms to pickle a dynamically created class, even if the user requests a different pickling mechanism via copy_reg
p36449
aVThe attached patch makes this customization possible by simply transposing two blocks of code
p36450
aVand
p36451
aVThe copy_reg module exists to handle custom pickling of objects, which is exactly what's needed here
p36452
aVHowever, the code from #494904 that checks for instances of a metaclass does this *just before* it looks at the copy_reg dispatch table
p36453
aVThe patches just reorder these tests in pickle
p36454
aVpy and cPickle
p36455
aVc, so that one can register a custom pickler for instances of a metaclass
p36456
aVAnd from the 2
p36457
ag4892
aV3 changelog:
p36458
aVIssue #7689: Allow pickling of dynamically created classes when their metaclass is registered with copy_reg
p36459
aVPatch by Nicolas M
p36460
aVThiry and Craig Citro
p36461
aVThe only way around this for Python 2
p36462
aV6 is to port the  module over to that version
p36463
aVYou could try to just bundle the 2
p36464
ag4892
aV3  module with 2
p36465
aV6, as a pure Python implementation it should Just Work
p36466
aVAlternatively, monkey-patch the  method:
p36467
aVWith the above monkey patch, your example works on Python 2
p36468
ag5279
aV8:
p36469
as(dp36470
g16
V100297
p36471
stp36472
a((dp36473
g2
(lp36474
VYou need to do some processing to get that structure
p36475
aVI'd use  to get your rows grouped by family name, then a  to create the inner mapping you need
p36476
aVrequires that you sorted the data, so the query needs a  clause too:
p36477
aVThe  function groups the rows on the first element of each row (the  column), so looping over the  iterable will only yield rows where  has the same value
p36478
aVWe then feed the names (second column in each row) to the , which results in  keys with a count for each name as the value
p36479
as(dp36480
g16
V100297
p36481
stp36482
a((dp36483
g2
(lp36484
VUse the  function to format  or  types:
p36485
aVwhich results in:
p36486
aVThe  adds a comma as a thousands separator in the output
p36487
aVYou generally do not want to indiscriminately round down after floating point or   calculations
p36488
aVIf you feel you have to do that anyway, do so explicitly before formatting:
p36489
as(dp36490
g16
V100297
p36491
stp36492
a((dp36493
g2
(lp36494
VUse  with a time object,  represents  and would match the output of your date-string-datetime path:
p36495
aVDemo:
p36496
as(dp36497
g16
V100297
p36498
stp36499
a((dp36500
g2
(lp36501
VFor types that have a literal notation (, , , , etc
p36502
aVthe  returns a string that can be used to create the type again
p36503
aVThat is nice, but not a requirement
p36504
aVThe main purpose for  is to provide the developer with unambiguous information as to what object they have here, for debugging purposes
p36505
aVQuoting from the  documentation:
p36506
aVCalled by the  built-in function to compute the \u201cofficial\u201d string representation of an object
p36507
aVIf at all possible, this should look like a valid Python expression that could be used to recreate an object with the same value (given an appropriate environment)
p36508
aVIf this is not possible, a string of the form  should be returned
p36509
aVbut most of all:
p36510
aVThis is typically used for debugging, so it is important that the representation is information-rich and unambiguous
p36511
aVEmphasis mine
p36512
aVReturning a constant string from your custom type would not break anything technically, but would make your life as a developer harder
p36513
as(dp36514
g16
V100297
p36515
stp36516
a((dp36517
g2
(lp36518
V does not emit any events
p36519
aVThe code predates Zope 3 events
p36520
aVYou'd have to create a monkey-patch hook instead, or otherwise emit an event yourself whenever your own code calls that method
p36521
as(dp36522
g16
V100297
p36523
stp36524
a((dp36525
g2
(lp36526
VYou want to move the  into the optional day group and use :
p36527
aVDemo:
p36528
aVThe pattern anchors on the , then backtracks
p36529
aVThe  then matches the whole text preceding the time signature, which satisfies the pattern
p36530
aVBy moving the  part into the optional  group (made non-capturing in my version) you guarantee that it won't backtrack past the  literal text
p36531
as(dp36532
g16
V100297
p36533
stp36534
a((dp36535
g2
(lp36536
VYou want a negative look-ahead assertion:
p36537
aVWhich gives:
p36538
aVNote that the pattern excludes both  and :
p36539
as(dp36540
g16
V100297
p36541
stp36542
a((dp36543
g2
(lp36544
VUse  to read the first file, and a dictionary to store the file1 rows
p36545
aVThe second file is in FASTA format, so we only take the lines starting with :
p36546
aVThis produces:
p36547
aVfor your input example
p36548
as(dp36549
g16
V100297
p36550
stp36551
a((dp36552
g2
(lp36553
VThe error means that  is not indented beyond the level of the preceding  line
p36554
aVIf, in your editor, it looks like the  line is indented properly anyway, you are mixing tabs and spaces inconsistently
p36555
aVReplace all tabs with spaces to correct
p36556
aVYou can configure most editors to use spaces only for indentation; this is what the Python styleguide (PEP 8) recommends:
p36557
aVTabs or Spaces
p36558
aVNever mix tabs and spaces
p36559
aVThe most popular way of indenting Python is with spaces only
p36560
aVThe second-most popular way is with tabs only
p36561
aVCode indented with a mixture of tabs and spaces should be converted to using spaces exclusively
p36562
aVWhen invoking the Python command line interpreter with the -t option, it issues warnings about code that illegally mixes tabs and spaces
p36563
aVWhen using -tt these warnings become errors
p36564
aVThese options are highly recommended
p36565
aVFor new projects, spaces-only are strongly recommended over tabs
p36566
aVMost editors have features that make this easy to do
p36567
as(dp36568
g16
V100297
p36569
stp36570
a((dp36571
g2
(lp36572
VYou can split the string into two:
p36573
aVMultiple consecutive strings within the same expression are automatically concatenated into one, at compile time:
p36574
aVNote the  for line 3, the bytecode for the function contains one string, already concatenated
p36575
aVIf you were to add a  to the expression, two separate constants are created:
p36576
aVPython does fold binary operations on constants at compile time (so , ,  etc
p36577
aV, in the peephole optimizations for the byte compiler
p36578
aVSo for certain string concatenations the compiler may also replace  string concatenation of constants with the concatenated result
p36579
aVSee , for sequences (including strings) this optimization is only applied if the result is limited to 20 items (characters) or fewer
p36580
as(dp36581
g16
V100297
p36582
stp36583
a((dp36584
g2
(lp36585
VYou assign a  attribute in your :
p36586
aVThis shadows the  method on the class
p36587
aVRename the attribute or the method
p36588
aVAttributes on the instance trump those on the class (except for data descriptors; think s)
p36589
aVFrom the Class definitions documentation:
p36590
aVVariables defined in the class definition are class attributes; they are shared by instances
p36591
aVInstance attributes can be set in a method with
p36592
aVBoth class and instance attributes are accessible through the notation \u201c\u201d, and an instance attribute hides a class attribute with the same name when accessed in this way
p36593
aVYour methods also expect a parameter that you are not passing in in your example, but I'm figuring you'll solve that yourself next
p36594
as(dp36595
g16
V100297
p36596
stp36597
a((dp36598
g2
(lp36599
VYou'd need to use the  and  functions:
p36600
aVor you can use  and  operators:
p36601
aVSee Conjunctions and Common Filter Operations
p36602
as(dp36603
g16
V100297
p36604
stp36605
a((dp36606
g2
(lp36607
VYou are looking at URL-quoted data:
p36608
aVYou can split on the first  perhaps, then split on :
p36609
aVIf instead the data has multiple fields and you find a  in there too, you can perhaps better parse everything after the question mark as a URL query string instead using
p36610
as(dp36611
g16
V100297
p36612
stp36613
a((dp36614
g2
(lp36615
VThe RSS feed uses the effective (or publishing) date, falling back to the modified date, for the  tag
p36616
aVGive your content a correct effective date to correct the date in your RSS feed, see  ->  ->
p36617
as(dp36618
g16
V100297
p36619
stp36620
a((dp36621
g2
(lp36622
VIt is called operator precedence and evaluation order
p36623
aVWithin an expression, operator precedence applies, and per expression the evaluation order is used
p36624
aVThe  call comes before the  addition operator because it has a higher precedence
p36625
aVFor operators of equal priority, evaluation goes from left to right
p36626
aVIn a function call, each argument is a separate expression and these are thus evaluated from left to right
p36627
as(dp36628
g16
V100297
p36629
stp36630
a((dp36631
g2
(lp36632
VThat is an Atom feed; use feedparser to parse that file into individual articles
p36633
aVThis prints:
p36634
aVetc
p36635
aVYou can see what items each entry defines by looking at the result of the  method:
p36636
aVIf you want to convert your HTML content to text, there are a few options
p36637
aVMost are listed in:
p36638
aVExtracting text from HTML file using Python
p36639
as(dp36640
g16
V100297
p36641
stp36642
a((dp36643
g2
(lp36644
VYou generally wouldn't do this
p36645
aVYou normally would create a base class in  instead:
p36646
aVThen use that in other modules:
p36647
as(dp36648
g16
V100297
p36649
stp36650
a((dp36651
g2
(lp36652
V does not support parsing a  file
p36653
aVThe page you see is probably the Apache page for the server serving that  configuration file instead
p36654
aVfiles contain javascript code that present your browser with proxy rules
p36655
aVYou can try and open the file directly and see what proxy would be configured for the Python Challenge site instead
p36656
aVSee http://en
p36657
aVwikipedia
p36658
aVorg/wiki/Proxy_auto-config for more details on the file format
p36659
aVOnce you figured out what proxy server would be used, configure that as server in the  mapping instead
p36660
as(dp36661
g16
V100297
p36662
stp36663
a((dp36664
g2
(lp36665
VJust create a loop over :
p36666
as(dp36667
g16
V100297
p36668
stp36669
a((dp36670
g2
(lp36671
VThe  field is not part of the Dexterity schema, at all
p36672
aVYou'd have to create an additional behaviour that adds it
p36673
as(dp36674
g16
V100297
p36675
stp36676
a((dp36677
g2
(lp36678
VYou'll have to reference the XML DOM documentation and grit your teeth
p36679
aVTo get the first  element, then its :
p36680
as(dp36681
g16
V100297
p36682
stp36683
a((dp36684
g2
(lp36685
VYou want to loop over the  tags instead, but only those that have a  child:
p36686
aVIf you wanted to just print out the child elements of the  element as XML, I'd just loop over the element (looping over the child elements) and use  on each:
p36687
as(dp36688
g16
V100297
p36689
stp36690
a((dp36691
g2
(lp36692
VYou cannot create multiple connections to an in-memory database
p36693
aVInstead, a new connection to  creates a new database
p36694
aVFrom the SQLite documentation:
p36695
aVEvery :memory: database is distinct from every other
p36696
aVSo, opening two database connections each with the filename ":memory:" will create two independent in-memory databases
p36697
aVThis is different from an on-disk database, where creating multiple connections with the same connection string means you are connecting to one database
p36698
aVYou are creating a new connection for the thread, thus creating a new database that does not have the tables created
p36699
as(dp36700
g16
V100297
p36701
stp36702
a((dp36703
g2
(lp36704
VThe package contains an experimental C++ extension, and the setup file generates Python files, but with the extension disabled by default, you should be able to include the  result with your script just fine
p36705
aVNote that the Python package still needs the command-line tool to be installed
p36706
aVThe tool is used to generate some Python for you
p36707
aVOnce that is available, run:
p36708
aVand copy the  directory to your script distribution, it needs to be on your  to be importable
p36709
aVAlternatively, use  and add the path to the resulting zipfile (located in ) to your
p36710
aVRenaming it should be fine
p36711
aVDo note that the package uses a namespace, and thus the  module needs to be available as well
p36712
aVIt is only used to declare the  namespace in
p36713
as(dp36714
g16
V100297
p36715
stp36716
a((dp36717
g2
(lp36718
VIt's just a string, you can split it on the :
p36719
aVFrom there on out it is trivial to construct a new list that you pass back to a  to write to a new file
p36720
as(dp36721
g16
V100297
p36722
stp36723
a((dp36724
g2
(lp36725
VUse the  function to generate the index along with the elements of the sequence you are looping over:
p36726
as(dp36727
g16
V100297
p36728
stp36729
a((dp36730
g2
(lp36731
VYou'd read the lines into memory, into a list and then index into that list:
p36732
as(dp36733
g16
V100297
p36734
stp36735
a((dp36736
g2
(lp36737
VThe python  module can reuse the  module interface for letting classes customize copy behaviour
p36738
aVThe default for instances of custom classes is to create a new, empty class, swap out the  attribute, then for shallow copies, just update the  on the copy with the values from the original
p36739
aVA deep copy recurses over the  instead
p36740
aVOtherwise, you specify a  method to return internal state
p36741
aVThis can be any structure that your class  can accept again
p36742
aVYou can also specify the  and/or  methods to control just copy behaviour
p36743
aVThese methods are expected to do all the copying themselves, the  method is passed a memo mapping to pass on to recursive  calls
p36744
aVAn example could be:
p36745
aVThis example defines custom copy hooks to prevent  being copied too, as a new instance will calculate it anew
p36746
as(dp36747
g16
V100297
p36748
stp36749
a((dp36750
g2
(lp36751
VFor HTML, use the right tool
p36752
aVUse an HTML parser instead, like BeautifulSoup:
p36753
aVDo not use a regular expression, matching HTML with such expressions gets too complicated, too fast
p36754
aVDon't do that
p36755
as(dp36756
g16
V100297
p36757
stp36758
a((dp36759
g2
(lp36760
VYou are subclassing
p36761
aVIt'll never call  because it already is unicode
p36762
aVWhat happens here instead is that the object is encoded to the  encoding:
p36763
aVexcept that it'll use direct C calls instead of the  method
p36764
aVThis is the default behaviour for  for unicode objects
p36765
aVThe  statement calls , which in turn calls  when handling a  object
p36766
aVThe latter then defers to an encoding function for the current encoding, and these use the Unicode C macros to access the data structures directly
p36767
aVYou cannot intercept this from Python
p36768
aVWhat you are looking for is an  hook, I guess
p36769
aVSince this is already a  subclass,  needs only to encode, not to convert it to  again, nor can it convert it to string without encoding it explicitly
p36770
aVYou'd have to take this up with the Python core developers, to see if an  makes sense
p36771
as(dp36772
g16
V100297
p36773
stp36774
a((dp36775
g2
(lp36776
VThe date class is a immutable object, so you need to override the  static method instead:
p36777
aVNote that you need to set the month and day to 1 at least, 0 is not a permissible value for the  and  arguments
p36778
aVUsing  works:
p36779
as(dp36780
g16
V100297
p36781
stp36782
a((dp36783
g2
(lp36784
VUse the  method instead:
p36785
aVHowever,  must be a sequence of tuples here
p36786
aVIf it is not, a generator expression will do to create these tuples:
p36787
aVDemonstration (with insertions):
p36788
aVNote that for an  statement, you have to have a  statement to identify what row to update
p36789
aVAn  without a  filter will update all rows
p36790
aVMake sure your data has a row identifier to go with it; in this case it may be easier to use named parameters instead:
p36791
as(dp36792
g16
V100297
p36793
stp36794
a((dp36795
g2
(lp36796
VThe parameter argument must be a sequence, so use a tuple here:
p36797
aVThis has nothing to do with the pipe symbol, btw, but everything with the fact that strings are sequences too
p36798
aVA string of 3 characters is a sequence of 3 elements
p36799
as(dp36800
g16
V100297
p36801
stp36802
a((dp36803
g2
(lp36804
VYou cannot import the module you are in
p36805
aVYou'll have to move the  instantiation to  after the class definition:
p36806
aVYou can always add more attributes to a class definition, but to create an instance of a class you first need to have defined it
p36807
aVThe  dance is needed, because you otherwise have a catch-22 here; you cannot create an instance of  without setting  first
p36808
aVWhich you cannot do, because you haven't created the default yet
p36809
as(dp36810
g16
V100297
p36811
stp36812
a((dp36813
g2
(lp36814
VUse sets
p36815
aVRead the two CSV files first and collect just the fruits from the rows
p36816
aVThen use set intersections to find all fruit that the two files have in common, add these to the fruit from the  file, sort, and write all fruit back to the file
p36817
as(dp36818
g16
V100297
p36819
stp36820
a((dp36821
g2
(lp36822
VArgparse is a command line parser, and errors always end up calling , which in turn calls  with an error code
p36823
aVThis is by design
p36824
aVFor a unit test, you'd have to monkeypatch (using mocking perhaps) the  or the  methods of the parser
p36825
aVis called with an error message and prints the usage message, then calls  with an exit code and the error message
p36826
aVTheir current implementations:
p36827
as(dp36828
g16
V100297
p36829
stp36830
a((dp36831
g2
(lp36832
VYou use the field from the Archetypes schema to retrieve values, preferably the raw values in this case
p36833
aVYou pass in the object then calling either  or :
p36834
aVThe object returned by the  call is basically a  instance
p36835
aVYou can call  on it to get the raw image data
p36836
aVTo set the image object, you really want to get the image field from the schema and use it's  attribute as a factory:
p36837
aVThe content type here is optional; the  and  types sniff out the content type automatically too
p36838
as(dp36839
g16
V100297
p36840
stp36841
a((dp36842
g2
(lp36843
VThis sounds to me like you want a ' for lists'
p36844
aVYou can use  with a while loop:
p36845
aVThis alters the list in place
p36846
aVTo create a copy, you'd have to first find a slice end-point, then slice up to that point for a quick copy:
p36847
as(dp36848
g16
V100297
p36849
stp36850
a((dp36851
g2
(lp36852
VWrite the barcode straight out to the :
p36853
as(dp36854
g16
V100297
p36855
stp36856
a((dp36857
g2
(lp36858
VAll you need to do is use
p36859
aVThis returns a list of matched groups, so numbers
p36860
aVI've moved the  call out of the function, there is no need to re-compile the expression every time
p36861
aVYou are looping over each and every character of , then you loop over a list with one match, then you test if  is True-ish (which it is if it is not empty)
p36862
aVThis means that for every character in the input you add an empty match (the expression will never match anything in a single character string)
p36863
as(dp36864
g16
V100297
p36865
stp36866
a((dp36867
g2
(lp36868
VSQLAlchemy uses the various special method hooks to overload operator behaviour
p36869
aVFor , the  method returns special objects that signify a SQL expression when compiled
p36870
aVTo quote the documentation on the 'rich comparison' hooks:
p36871
aVBy convention,  and  are returned for a successful comparison
p36872
aVHowever, these methods can return any value, so if the comparison operator is used in a Boolean context (e
p36873
ag1298
aV, in the condition of an  statement), Python will call  on the value to determine if the result is true or false
p36874
aVSee the  class in the SQLAlchemy source for the specific hooks implemented
p36875
as(dp36876
g16
V100297
p36877
stp36878
a((dp36879
g2
(lp36880
VUse :
p36881
aVThe same module has  too, to mirror the operation
p36882
aVDemo:
p36883
aVThe  operation produces lowercase hex, but that is easily fixed with a  call
p36884
as(dp36885
g16
V100297
p36886
stp36887
a((dp36888
g2
(lp36889
VYou are looking for a negative lookahead:
p36890
aVThe  syntax means:
p36891
aVMatches if  doesn\u2019t match next
p36892
aVThis is a negative lookahead assertion
p36893
aVFor example,  will match  only if it\u2019s not followed by
p36894
aVso the expression matches if the path starts with  but is not followed by
p36895
aVDemo:
p36896
as(dp36897
g16
V100297
p36898
stp36899
a((dp36900
g2
(lp36901
VA  loop has a  clause
p36902
aVIt is executed when you did not end the loop early:
p36903
aVNote the ; by breaking out of the  loop, the  suite is not executed
p36904
aVThis'll of course stop at the first match
p36905
aVIf you need to find multiple matches, your only option is to use some form of a flag variable:
p36906
as(dp36907
g16
V100297
p36908
stp36909
a((dp36910
g2
(lp36911
VYou should not use string formatting, use SQL parameters instead:
p36912
aVSQL parameters make sure your values are escaped correctly, prevent SQL injection attacks and handle different types properly
p36913
as(dp36914
g16
V100297
p36915
stp36916
a((dp36917
g2
(lp36918
VIf you need to special-case these types, use the name of the class instead:
p36919
aVBoth  and  are  subclasses, just with a maximum length pre-set and a dedicated validator
p36920
as(dp36921
g16
V100297
p36922
stp36923
a((dp36924
g2
(lp36925
VYou replace the  argument with an empty list at the top of your function:
p36926
aVRemove that line
p36927
aVAlso, your function should not return anything; you need to remove the  line too to pass the assignment test, which expected  from the function (which is the default)
p36928
aVNote that by returning early, you never call  on the file either
p36929
as(dp36930
g16
V100297
p36931
stp36932
a((dp36933
g2
(lp36934
VUse  to convert  and  to multi-sets, then subtract to see if all of 's letters can be found in :
p36935
aVSubtracting multi-sets removes characters when their count falls to 0
p36936
aVIf this results in an empty multi-set, it becomes  in a boolean context, like all 'empty' python types
p36937
aVturns that into  if that is the case
p36938
aVDemo:
p36939
as(dp36940
g16
V100297
p36941
stp36942
a((dp36943
g2
(lp36944
VYou want to use  with a dash of  and :
p36945
aVThe  call groups the input list into chunks where the first item is the same ( is the grouping key)
p36946
aVThe  call turns the groups into iterables where the first element will be skipped
p36947
aVThe  call takes each  result and chains them together into a new iterable, which  turns back into a list
p36948
aVDemo:
p36949
as(dp36950
g16
V100297
p36951
stp36952
a((dp36953
g2
(lp36954
VInstead of using the new value after adding your period as the starting point for the next loop, create an ever-increasing delta instead:
p36955
aVThis results in:
p36956
aVThis works for any variable period lengths including quarters and years
p36957
aVFor periods measured in exact weeks or days you can use a  object too, but this is a generic solution
p36958
aVYou cannot 'divide' time periods when using variable-width periods such as months and quarters
p36959
aVFor time periods measured in whole days you can simply convert the difference between two dates to days (from the timedelta) and then get the modulus:
p36960
aVwhich gives:
p36961
as(dp36962
g16
V100297
p36963
stp36964
a((dp36965
g2
(lp36966
V applies argument unpacking to the function call
p36967
aVIt takes the  part, which has to resolve to a sequence, and makes each element in that sequence a separate parameter to the function
p36968
aVSo,  returns a sequence, and each element in that sequence is made an argument to the outer  function
p36969
aVFor  it is perhaps a little clearer; there are several elements here:
p36970
aV(should be  in python 3) creates a list with 4 tuples,
p36971
aVThe  part then takes each of those 4 tuples and passes those as arguments to the  function
p36972
aVtakes each tuple and pairs their elements; two elements per tuple means the result is 2 lists of 4 values each
p36973
aVBecause the  function return two sequences, they can be assigned to the two variables
p36974
aVI would have found the following a far more readable version of the same expression:
p36975
as(dp36976
g16
V100297
p36977
stp36978
a((dp36979
g2
(lp36980
VIn Python we generally avoid getters and setters
p36981
aVJust have a  attribute:
p36982
aVSee Python is not Java for motivations and more pitfalls to avoid:
p36983
aVIn Java, you have to use getters and setters because using public fields gives you no opportunity to go back and change your mind later to using getters and setters
p36984
aVSo in Java, you might as well get the chore out of the way up front
p36985
aVIn Python, this is silly, because you can start with a normal attribute and change your mind at any time, without affecting any clients of the class
p36986
aVSo, don't write getters and setters
p36987
aVUse  when you have a genuine need to execute code when getting, setting or deleting an attribute
p36988
aVValidation, caching, side effects, etc
p36989
aVall are fair use-cases for properties
p36990
aVJust don't use them until necessary
p36991
as(dp36992
g16
V100297
p36993
stp36994
a((dp36995
g2
(lp36996
VDefine a  method on your class
p36997
aVIt'll be called when printing your custom class instances:
p36998
aVDemo:
p36999
aVIn addition, you could implement a  method too, to provide a debugger-friendly representation of your instances
p37000
as(dp37001
g16
V100297
p37002
stp37003
a((dp37004
g2
(lp37005
VUse  to split lines into lists, and use  to turn the rows into columns
p37006
aVThe values in the rows are still string values, but you could now map them to :
p37007
aVThis skips the first column, with the names
p37008
as(dp37009
g16
V100297
p37010
stp37011
a((dp37012
g2
(lp37013
VYou need to loop over the nested structure to apply the filters only to the inner values
p37014
aVDict comprehensions work fine for that:
p37015
aVDemo:
p37016
as(dp37017
g16
V100297
p37018
stp37019
a((dp37020
g2
(lp37021
VYou cannot use both statements; the  module contains a  type
p37022
aVThe local name  in your own module can only refer to one or the other
p37023
aVUse only , then make sure that you always use  to refer to the contained type:
p37024
aVNow  is the module, and you refer to the contained types via that
p37025
aVAlternatively, import all types you need from the module:
p37026
aVHere  is the type from the module
p37027
aVis another type, from the same module
p37028
as(dp37029
g16
V100297
p37030
stp37031
a((dp37032
g2
(lp37033
VThe variable  is only ever assigned in one  branch
p37034
aVIf the other branch is selected instead, the variable is never defined
p37035
aVGive it an empty value first:
p37036
as(dp37037
g16
V100297
p37038
stp37039
a((dp37040
g2
(lp37041
VYou should be looking at the  field instead, see New and changed  keywords
p37042
aVis deemed too vague a field to rely on for dependency installation
p37043
aVIn addition, there are  and  fields for dependencies required for  and for running tests
p37044
aVCertainly, the dependency graph has been analyzed before; from this blog article by Olivier Girardot comes this fantastic image:
p37045
aVThe image is linked to the interactive version of the graph
p37046
as(dp37047
g16
V100297
p37048
stp37049
a((dp37050
g2
(lp37051
VPython functions are first-class objects
p37052
aVJust like other objects, they can be assigned to variables and passed around
p37053
aVIn the above example session I play around with the  function object, assigning it to , then invoking it via that other variable
p37054
aVAll that the code you quoted from Think Python does is pass  as a parameter to the function , which calls it's parameter  twice
p37055
as(dp37056
g16
V100297
p37057
stp37058
a((dp37059
g2
(lp37060
VYou already read the value on the line before
p37061
aVRead it just once:
p37062
as(dp37063
g16
V100297
p37064
stp37065
a((dp37066
g2
(lp37067
VGet the portal root:
p37068
as(dp37069
g16
V100297
p37070
stp37071
a((dp37072
g2
(lp37073
VYou are creating a dictionary first, then passing that dictionary to an
p37074
aVBy the time you do that, the ordering is no longer going to be correct
p37075
aVis inherently not ordered
p37076
aVPass in a list of tuples instead:
p37077
aVWhat you see when you print the  is it's representation, and it is entirely correct
p37078
aVjust shows you, in a reproducable representation, what the contents are of the
p37079
as(dp37080
g16
V100297
p37081
stp37082
a((dp37083
g2
(lp37084
VThe node name is what lets GraphViz track individual nodes, so they have to be named uniquely
p37085
aVYou are, however, free to use duplicate labels
p37086
aVThe labels is what will be shown in the end result, and labels for nodes are by default set to the node name
p37087
aVSet the label together with the node name when creating:
p37088
aVNote that internally, everything is converted to strings here
p37089
aVThis results in:
p37090
aVYou'll need to refactor your code to generate unique ids for your unique nodes, then use those ids to create your edges
p37091
aVHere I just traverse your tree with a stack with parent ids:
p37092
aVwhich gives:
p37093
aVTo straighten out the edges between nodes with equal values you need to experiment with adding weights to the edges:
p37094
aVwhich results in:
p37095
aVYou can tweak the exact weights
p37096
as(dp37097
g16
V100297
p37098
stp37099
a((dp37100
g2
(lp37101
VYou use tuple unpacking:
p37102
aVPython can unpack nested sequences into separate variables, as long as you create the same nesting structure on the left-hand-side
p37103
aVThe looping will not work because you are trying to unpack 2-value tuples per loop iteration, where the iteration would only yield only 1 value
p37104
aVThis works across python versions
p37105
aVDemonstration:
p37106
as(dp37107
g16
V100297
p37108
stp37109
a((dp37110
g2
(lp37111
VYou store a new string based on the  variable in the  ; the label doesn't keep a reference to the  variable for you
p37112
aVSimply set the label value each time you call your  function:
p37113
as(dp37114
g16
V100297
p37115
stp37116
a((dp37117
g2
(lp37118
VYou'd need to process this recursively:
p37119
as(dp37120
g16
V100297
p37121
stp37122
a((dp37123
g2
(lp37124
VYou have  objects
p37125
aVThese have ,  and  attributes, all 3 integers
p37126
aVThe  string representation represents those as  as needed to fit all values present
p37127
aVYou can use simple arithmetic on these objects
p37128
aVSumming and division work as expected, for example:
p37129
aVUnfortunately, you cannot multiply two timedeltas and calculating a standard deviation thus becomes tricky (no squaring of offsets)
p37130
aVInstead, I'd use the  method, to give you a floating point value that is calculated from the days, seconds and microseconds values, then use those values to calculate a standard deviation
p37131
as(dp37132
g16
V100297
p37133
stp37134
a((dp37135
g2
(lp37136
VPython applies line buffering when connected to a TTY, otherwise a larger buffer is needed
p37137
aVRedirecting your Python program to a pipe means there is no TTY connected to the stream, and you'll have to use  even when sending newlines
p37138
aVYou can run Python with  to turn off buffering of
p37139
as(dp37140
g16
V100297
p37141
stp37142
a((dp37143
g2
(lp37144
VSimply use string formatting:
p37145
aVThe version of your program is not going to change during it's (short, showing commandline help only) lifetime, so you only need to interpolate this once
p37146
as(dp37147
g16
V100297
p37148
stp37149
a((dp37150
g2
(lp37151
VYou want to import the  modules in the package  files to make them available as attributes
p37152
aVSo in both  and  add:
p37153
aVThis makes the module an attribute of the package and you can now refer to it as such
p37154
aVAlternatively, you'd have to import the modules themselves in full:
p37155
aVso refer to them with their full names
p37156
aVAnother option is to rename the imported name with :
p37157
as(dp37158
g16
V100297
p37159
stp37160
a((dp37161
g2
(lp37162
VNo, they cannot ever access the same in-memory database
p37163
aVInstead, a new connection to  always creates a new database
p37164
aVFrom the SQLite documentation:
p37165
aVEvery :memory: database is distinct from every other
p37166
aVSo, opening two database connections each with the filename ":memory:" will create two independent in-memory databases
p37167
aVThis is different from an on-disk database, where creating multiple connections with the same connection string means you are connecting to one database
p37168
as(dp37169
g16
V100297
p37170
stp37171
a((dp37172
g2
(lp37173
VYou only have 4 items past the empty line of the  entry, so the  test never becomes True
p37174
aVSimply append  one more time if there are items in it:
p37175
as(dp37176
g16
V100297
p37177
stp37178
a((dp37179
g2
(lp37180
VUse a generator expression to sum per tag:
p37181
aVYou could sort on the tags then use  to create per-tag groups and sums:
p37182
aVThis would produce a dictionary mapping tags to per-tag sum:
p37183
as(dp37184
g16
V100297
p37185
stp37186
a((dp37187
g2
(lp37188
VUse :
p37189
aVin your case is just a script name, no directory, so  returns an empty string
p37190
aVturns that into a proper absolute path with directory name
p37191
as(dp37192
g16
V100297
p37193
stp37194
a((dp37195
g2
(lp37196
VYou need to use a  loop instead in this case:
p37197
aVA  loop creates an iterator for your list, once
p37198
aVAnd once created that iterator does not know that you altered the list in the loop
p37199
aVThe  variant shown here recalculates the length each time instead
p37200
as(dp37201
g16
V100297
p37202
stp37203
a((dp37204
g2
(lp37205
VUse  if your indices are long numbers:
p37206
aVPython 3's  can handle python longs as well
p37207
aVSimplified to your case:
p37208
as(dp37209
g16
V100297
p37210
stp37211
a((dp37212
g2
(lp37213
VPython scripts inside Zope / Plone run in a restricted environment
p37214
aVThe error is thrown because you cannot open files from the filesystem there
p37215
aVUse an External Method  instead to point to a file-system stored script if you want to execute Python code that is not restricted
p37216
aVThe  action only uses the  as a context
p37217
aVYour script is free to ignore that context
p37218
as(dp37219
g16
V100297
p37220
stp37221
a((dp37222
g2
(lp37223
V does not return a string, it returns a response as a file-like object
p37224
aVYou need to read that response:
p37225
aVOnly then is  a string you can write to a file
p37226
as(dp37227
g16
V100297
p37228
stp37229
a((dp37230
g2
(lp37231
VYou were almost there; your format should be:
p37232
aVYou had a few too many zeros and a redundant
p37233
aVYou also need to remember that the stop value in a range is not included, so to get the numbers 1 - 5 you need to add 1 to the stop parameter:
p37234
as(dp37235
g16
V100297
p37236
stp37237
a((dp37238
g2
(lp37239
VSplit the string on the word  then, with the trailing space:
p37240
aVThis takes everything following that word
p37241
aVDemo:
p37242
as(dp37243
g16
V100297
p37244
stp37245
a((dp37246
g2
(lp37247
VYou could use  instead:
p37248
aVThis imports the file as the  module, executing it
p37249
aVNote that it takes an actual file object when the type is set to , so you'd need to create a temporary file for this to work if your source code comes from somewhere other than a file
p37250
aVOtherwise, can always set  manually:
p37251
as(dp37252
g16
V100297
p37253
stp37254
a((dp37255
g2
(lp37256
VThe information is URL encoded, so use  to decode that
p37257
as(dp37258
g16
V100297
p37259
stp37260
a((dp37261
g2
(lp37262
VYou need to use the  SQL function generator to create a  function:
p37263
as(dp37264
g16
V100297
p37265
stp37266
a((dp37267
g2
(lp37268
VWith the ElementTree API you simply look for the  XPath to find  elements at any level:
p37269
aVXPath expressions can find you the tag on more specific levels too, by specifying the applicable parents:
p37270
as(dp37271
g16
V100297
p37272
stp37273
a((dp37274
g2
(lp37275
VYou can simply call  from the  function, where you now call
p37276
aVFunctions defined at the top of a module are global in the module, so other functions can simply refer to those by name and call them
p37277
aVAny value that your function needs does need to be passed in as an argument:
p37278
as(dp37279
g16
V100297
p37280
stp37281
a((dp37282
g2
(lp37283
VYou'll have to create the MIME encoding yourself
p37284
aVYou can do so with the  package:
p37285
aVI presumed the XML file uses UTF-8, you probably want to set a character set for the  entry as well
p37286
aVonly knows how to create  post bodies; the   is not commonly used
p37287
as(dp37288
g16
V100297
p37289
stp37290
a((dp37291
g2
(lp37292
VUsing  for ease:
p37293
aVbut you can do it with a bog-standard  too:
p37294
aVIn Python 3, use  instead
p37295
as(dp37296
g16
V100297
p37297
stp37298
a((dp37299
g2
(lp37300
VJust read the file in one, adding the lows and highs to two separate lists:
p37301
aVWe only look at lines that have 3 integer values, the rest would throw a , either because there are not 3 values on the line or because there are non-integer values
p37302
aVThese lines are ignored
p37303
as(dp37304
g16
V100297
p37305
stp37306
a((dp37307
g2
(lp37308
VThe Title field is a plain-text field, so any text is escaped when the page renders
p37309
aVThis is by design
p37310
aVIf you explicitly want to allow HTML to be entered, you'll need to customize the title display for your type and add  to the  element:
p37311
aVThe  TALES keyword disables HTML escaping
p37312
aVThis allows the editor to insert arbitrary HTML
p37313
aVYou may want to switch to using a  field instead of the default , so you can apply the automatic safe-HTML transformations on it
p37314
aVSee the Rich text, markup and transformations chapter in the Dexterity developer manual
p37315
as(dp37316
g16
V100297
p37317
stp37318
a((dp37319
g2
(lp37320
VI think you misunderstand recursion
p37321
aVThe outer list has two items, one a list, and one the number 4
p37322
aVThe  function calls  again to print the inner list, then calls  for the second element
p37323
aVSo, this is what happens:
p37324
aV-> loop over 2 items
p37325
aV-> loop over 3 items
p37326
as(dp37327
g16
V100297
p37328
stp37329
a((dp37330
g2
(lp37331
VYou are replacing the decorated class with a function, and thus the class definition fails
p37332
aVSpecifically, the  now passes in a function to :
p37333
aVClass decorators usually alter the class, add, remove or alter it's attributes, then return the class object again
p37334
aVYou should not replace  with a new class, because your  refers to itself by name
p37335
aVReplacing that name with another class is going to lead to pain (such as infinite recursion)
p37336
aVAn example class decorator that does work:
p37337
as(dp37338
g16
V100297
p37339
stp37340
a((dp37341
g2
(lp37342
VYou need to use the  method on your  instance instead:
p37343
aVThe  method treats  as a sequence of filenames instead, and as none of the lines could ever be interpreted as a filename, the configuration ends up empty
p37344
aVAlternatively, pass in the filename and encoding to  without opening the file yourself:
p37345
aVIf your input file contains a UTF-8 BOM () either create the file using a tool that doesn't add that character (e
p37346
ag1298
aVnot Notepad), or skip it explicitly:
p37347
as(dp37348
g16
V100297
p37349
stp37350
a((dp37351
g2
(lp37352
VDon't use  here; you don't even use the return value
p37353
aVTo write all matching terms, use:
p37354
aVbut it'd be better to just use a regular loop; readability counts
p37355
aVUse  only if you want to know about the boolean result of the test;  stops iterating when it finds the first  value
p37356
aVIn your case  returns , so it'll never even encounter  and always return
p37357
as(dp37358
g16
V100297
p37359
stp37360
a((dp37361
g2
(lp37362
VYou need to create the request object yourself, pass that to the hook, then call  on it:
p37363
aVthen send:
p37364
as(dp37365
g16
V100297
p37366
stp37367
a((dp37368
g2
(lp37369
VYou are using threads, and  is not yet set by the time you call
p37370
aVThe fix would be to either not use threads, or to at least set  to  then poll if it is set to something different in  before attempting to pass the value to
p37371
as(dp37372
g16
V100297
p37373
stp37374
a((dp37375
g2
(lp37376
VUse a  list instead, simply  new  instances:
p37377
aVor even:
p37378
aVThere is no need to create individual variables for each row result
p37379
as(dp37380
g16
V100297
p37381
stp37382
a((dp37383
g2
(lp37384
VI used this in the past:
p37385
aVThis would list items from the given iterables in sorted order, provided the input iterables are themselves already sorted
p37386
aVThe above generator would iterate over your two generators in the same order as your psuedo-code would
p37387
as(dp37388
g16
V100297
p37389
stp37390
a((dp37391
g2
(lp37392
VYou can also call
p37393
aVThe  method on objects is the initializer
p37394
aVIt is called to initialize a newly created object, and usually the method assumes that the object is still fresh and empty when  is executed
p37395
aVIf you call it again at a later time, if it'll work depends on the class
p37396
aVFor  it apparently works
p37397
aVI would not count on this working across versions, the behaviour of the  method you observed is not specified in the documentation
p37398
aVIt just so happens that in CPython,  is implemented as a  (albeit in C)
p37399
aVThe biggest drawback is that it will confuse anyone trying to understand your code
p37400
aVWhy call  when  is so much clearer
p37401
as(dp37402
g16
V100297
p37403
stp37404
a((dp37405
g2
(lp37406
VYou need to give  a list:
p37407
aVexpects a sequence, something ordered
p37408
aVLists are sequences, but so are strings; strings can be indexed, iterated over, etc
p37409
aVBy passing in just  you give  a sequence of individual characters, each written as a separate column
p37410
as(dp37411
g16
V100297
p37412
stp37413
a((dp37414
g2
(lp37415
VThe class body is executed as a function would, and the local namespace entries become the class attributes
p37416
aVSo, during execution of the class body, you can treat the other names as local variables:
p37417
aVYou already discovered this since you called  successfully
p37418
as(dp37419
g16
V100297
p37420
stp37421
a((dp37422
g2
(lp37423
VNothing wrong with the default dict literal syntax:
p37424
aVor you could use the  constructor, provided your keys are also valid python identifiers:
p37425
as(dp37426
g16
V100297
p37427
stp37428
a((dp37429
g2
(lp37430
VFunctions always have a return value,  by default
p37431
aVYou are printing the return value of the  method, which is the default :
p37432
aVYou can just call  without the  statement
p37433
aVThe method does it's own printing
p37434
as(dp37435
g16
V100297
p37436
stp37437
a((dp37438
g2
(lp37439
VTry different parsers, the page parses fine with the  parser:
p37440
aVNot all parsers can treat broken HTML the same
p37441
as(dp37442
g16
V100297
p37443
stp37444
a((dp37445
g2
(lp37446
VThere can be several factors
p37447
aVTwo I can think off of right now:
p37448
aVInitial byte compilation
p37449
aVPython caches the compiled bytecode in  files, on a first run that file needs to be created, subsequent runs only need to verify the timestamp on the byte code cache
p37450
aVDisk caching
p37451
aVThe Python interpreter, the 3 libraries you refer to directly, anything those libraries use, all need to be loaded from disk, quite apart from the script and it's bytecode cache
p37452
aVThe OS caches such files for faster access
p37453
aVIf you ran other things on the same system, those files will be flushed from the cache and need to be loaded again
p37454
aVThe same applies to directory listings; the checks for where to find the modules in the module search path and tests for bytecode caches all are sped up by cached directory information
p37455
aVIf such startup times affect your application, consider creating a daemon that services these tasks as a service
p37456
aVRPC calls (using sockets or localhost network connections) will almost always beat those startup costs
p37457
aVA message queue could provide you with the architecture for such a daemon
p37458
as(dp37459
g16
V100297
p37460
stp37461
a((dp37462
g2
(lp37463
VYou have a nested structure, so you need to format the nested dictionary too:
p37464
aVThis prints:
p37465
as(dp37466
g16
V100297
p37467
stp37468
a((dp37469
g2
(lp37470
VUse just the  decorator of the original property:
p37471
aVNote that you have to use the full name to reach the original property descriptor on the parent class
p37472
aVDemonstration:
p37473
aVThe  descriptor object is just one object, even though it can have multiple methods associated with it (the getter, setter and deleter)
p37474
aVThe ,  and  decorator functions provided by an existing  descriptor return a copy of the descriptor itself, with that one specific method replaced
p37475
aVSo in your  base class what happens is that you first create the descriptor with the  decorator, then replace that descriptor with one that has both a getter and a setter with the  syntax
p37476
aVThat works because python decorators replace the original decorated function with the same name, it basically executes
p37477
aVIn your subclass you simply use that trick to create a new copy of the descriptor with just the getter replaced
p37478
as(dp37479
g16
V100297
p37480
stp37481
a((dp37482
g2
(lp37483
VUse a  and a , both from the  module:
p37484
aVThis gives you slightly different structure:
p37485
aVbut can be massaged to something closer to what you are looking for with:
p37486
aVwhich gives:
p37487
as(dp37488
g16
V100297
p37489
stp37490
a((dp37491
g2
(lp37492
VYou call  recursively but never ignore it's return value when you do
p37493
aVAdd a  statement to pass on the return value::
p37494
aVNow, when  is , you actually pass on the return value of the recursive call
p37495
as(dp37496
g16
V100297
p37497
stp37498
a((dp37499
g2
(lp37500
VMap the  string to functions with a dictionary:
p37501
aVPython functions are first-class objects, so you can just store them as values in a dictionary
p37502
as(dp37503
g16
V100297
p37504
stp37505
a((dp37506
g2
(lp37507
VJust access the sides and angles directly in the two lists you have:
p37508
aVGiven your example as  and , the area then is:
p37509
as(dp37510
g16
V100297
p37511
stp37512
a((dp37513
g2
(lp37514
VUse  to list the contents of a directory; you can then add a simple filename filter as needed:
p37515
as(dp37516
g16
V100297
p37517
stp37518
a((dp37519
g2
(lp37520
VYou are looping over  and modifying it at the same time
p37521
aVThis means that certain items are going to be skipped
p37522
aVCreate a copy of  instead to disconnect the loop iterator from  so you can modify the latter without affecting the loop:
p37523
aVYour biggest problem, however, is that you set  to  at the start of the loop, effectively changing
p37524
aVPerhaps you meant to use  instead
p37525
as(dp37526
g16
V100297
p37527
stp37528
a((dp37529
g2
(lp37530
VNesting loops in list comprehensions work the same way as nesting regular for loops, one inside the other:
p37531
aVbut in this case, just selecting  would be easier and give you the same result; a copy of the middle row
p37532
aVIf you need to apply an expression to each column in that row, then just loop over  directly:
p37533
as(dp37534
g16
V100297
p37535
stp37536
a((dp37537
g2
(lp37538
VSimply select just the columns you need; you are not required to use all columns
p37539
aVUse the  module to read the file, then just pick out the 2 values from each row:
p37540
as(dp37541
g16
V100297
p37542
stp37543
a((dp37544
g2
(lp37545
VUse  on a slice:
p37546
aVThis will remove elements 0 - 318 (so a total of 319 elements) in one go
p37547
as(dp37548
g16
V100297
p37549
stp37550
a((dp37551
g2
(lp37552
VPython strings store Unicode codepoints
p37553
aVCodepoints are not the same thing as bytes
p37554
aVBytes are a computer representation of numbers (most commonly between 0 and 255), and those numbers can be translated to codepoints through the process of decoding, and in the other direction with encoding
p37555
aVPython 3 strings contain codepoints, one for each character in the text
p37556
aVPython source code can define string literals using a series of bytes, that the interpreter decodes to unicode using the UTF-8 codec by default, but you can set other codecs at the top of the file
p37557
aVOn disk, the letter  in UTF-8 encoding is indeed just one byte, that is the nature of the UTF-8 standard
p37558
aVIf you read a file in text mode, Python applies the decoding process for you automatically, but when you open it in binary mode, no decoding is done and you get a  object instead
p37559
aVThe contents of that object should reflect the contents of the file exactly
p37560
aVNote that it is not of type , it is not unicode, it is not even a Python string
p37561
aVTo turn bytes into a string you'd need to explicitly decode with the  method
p37562
aVA  is trivially created from a  value, just call  on it
p37563
as(dp37564
g16
V100297
p37565
stp37566
a((dp37567
g2
(lp37568
VNo, you do not need to set  to anything beforehand
p37569
aVIn python you do not need to pre-declare variables
p37570
aVThe  loop simply assigns the next value from the  to  in each iteration of the loop
p37571
aVWhere in C you needed a  loop to generate indices into an array, in python you normally just loop over the sequence directly:
p37572
aVrather than
p37573
as(dp37574
g16
V100297
p37575
stp37576
a((dp37577
g2
(lp37578
VIt is importing things correctly, you just need to refer to
p37579
aVAlternatively, import  directly into your own globals:
p37580
as(dp37581
g16
V100297
p37582
stp37583
a((dp37584
g2
(lp37585
VNo need to use :
p37586
aVThe expression  is interpreted as ; a list is never equal to boolean  and thus you end up testing , guaranteed to be  instead
p37587
aVThis is called comparison chaining, making expressions like  possible
p37588
aVYou can simplify your  call to just :
p37589
aVand there is no need to repeat the  call:
p37590
as(dp37591
g16
V100297
p37592
stp37593
a((dp37594
g2
(lp37595
VYou don't need to set the  attribute again, if all you want to do is decode JSON:
p37596
aVIf you have a burning need to fix the response body, set  instead; read it from the  property first:
p37597
as(dp37598
g16
V100297
p37599
stp37600
a((dp37601
g2
(lp37602
V reads from  then closes it
p37603
aVThis causes  to fail, internally it writes to , now closed
p37604
aVYou can simply catch the  and exit silently:
p37605
as(dp37606
g16
V100297
p37607
stp37608
a((dp37609
g2
(lp37610
VYou are setting the attribute in the inner (wrapper) function
p37611
aVYou don't need a wrapper function at all:
p37612
aVYour decorator needs to return something that'll replace the original function
p37613
aVThe original function itself (with the attribute added) will do fine for that, because all you wanted to do is add an attribute to it
p37614
aVIf you still need a wrapper, then set the attribute on the wrapper function instead:
p37615
aVAfter all, you are replacing the wrapped function with the wrapper returned by the decorator, so that's the object you'll be looking for the attribute on
p37616
as(dp37617
g16
V100297
p37618
stp37619
a((dp37620
g2
(lp37621
VYou should call methods on , not by passing the functions around:
p37622
aVand call it with:
p37623
aVThis goes for  as well:
p37624
aVYou use a lot of getters and setters; there is no need for these in Python; you don't need to make the attributes private, just access them directly instead:
p37625
aVthen run:
p37626
aVResult:
p37627
as(dp37628
g16
V100297
p37629
stp37630
a((dp37631
g2
(lp37632
VYou are probably missing a closing parenthesis on the line before the , in the section you omitted:
p37633
aVCheck the last line of  and make sure that your parenthesis, brackets and curly braces are all balanced
p37634
as(dp37635
g16
V100297
p37636
stp37637
a((dp37638
g2
(lp37639
VYou are printing different things
p37640
aVIn the first example you print the datetime directly, so  converts it to
p37641
aVIn the second example you print a tuple, and tuples always are printed with the contents as  instead:
p37642
aVIn both cases you are still printing a  object
p37643
as(dp37644
g16
V100297
p37645
stp37646
a((dp37647
g2
(lp37648
VUse a list comprehension to keep everything not matching the condition:
p37649
aVSo, any row that is either the last one, or one where the first and last element do not match the same columns in the next row is allowed
p37650
aVResult:
p37651
as(dp37652
g16
V100297
p37653
stp37654
a((dp37655
g2
(lp37656
VYou can split on lines:
p37657
aVor even:
p37658
aVor call  on the response to discard the first line:
p37659
as(dp37660
g16
V100297
p37661
stp37662
a((dp37663
g2
(lp37664
VYou cannot use  with a value to exit a generator
p37665
aVYou need to use  plus a  without an expression:
p37666
aVIn the loop itself, use  again:
p37667
aVAlternatives are to raise an exception or to use tornado callbacks instead
p37668
as(dp37669
g16
V100297
p37670
stp37671
a((dp37672
g2
(lp37673
VIf you want to generate these methods per class, use a class decorator:
p37674
aVthen use it like:
p37675
aVDemonstration:
p37676
as(dp37677
g16
V100297
p37678
stp37679
a((dp37680
g2
(lp37681
VYou need to look for the name as a string; and I'd use  here to test for that name:
p37682
aVThis works if  exists, but not if you run this code inside
p37683
aVIf  is contained in the current module, you would need to use  to test for it:
p37684
as(dp37685
g16
V100297
p37686
stp37687
a((dp37688
g2
(lp37689
VYou want to use dictionaries instead:
p37690
aVor:
p37691
aVthen pick a random character:
p37692
aVYou really do not want to use separate local identifiers to represent a group of characters, that only complicates matters
p37693
as(dp37694
g16
V100297
p37695
stp37696
a((dp37697
g2
(lp37698
VYou can use  to automate setting up virtual environments and running your tests across Python versions:
p37699
aVTox supports Python versions 2
p37700
aV4 and up, as well as Jython and PyPy
p37701
aVIf you want to look at a real-world project that uses , take a look at the   configuration
p37702
aVThe package includes excellent documentation on how to run the  tests
p37703
aVThese tests are automatically run by the Zope nightly test builders
p37704
aVConfiguring tox to run under Jenkins is trivial and fully documented
p37705
as(dp37706
g16
V100297
p37707
stp37708
a((dp37709
g2
(lp37710
VIt'll return  if  is itself empty:
p37711
aVIt is horrific though
p37712
aVJust use  instead, or use  and do away with the  statement altogether:
p37713
aVwhich works because  short-circuits, returning  if it is not the empty string, otherwise  is returned
p37714
as(dp37715
g16
V100297
p37716
stp37717
a((dp37718
g2
(lp37719
VStart with splitting out the names:
p37720
aVThen rejoin based on the length:
p37721
aVThis works for entries with just one author too; we just reassign the name to
p37722
aVCombined into a function:
p37723
aVwith a demo:
p37724
as(dp37725
g16
V100297
p37726
stp37727
a((dp37728
g2
(lp37729
VRemove the calls to
p37730
aVThese try to convert the unicode data you have to bytecode, using the default ASCII encoding
p37731
aVYou probably want to use the  module here and save yourself the grief of having to write all those commas, but if you cannot, at least use loops properly:
p37732
aVwhich, for your partial example, would write:
p37733
as(dp37734
g16
V100297
p37735
stp37736
a((dp37737
g2
(lp37738
VYou want to find all  elements following your headers, then list the links under those to get the cards:
p37739
aVwhich prints:
p37740
aVetc
p37741
as(dp37742
g16
V100297
p37743
stp37744
a((dp37745
g2
(lp37746
VYou are looking for:
p37747
aVwhich matches a  if there are digits or a dot) before, and digits after
p37748
aVDemo:
p37749
aVTo handle both  and  (negative and positive exponents), you could use:
p37750
aVwhich would allow for and replace an optional , leaving the  or  in place when replacing:
p37751
aVThis does allow for the  to also precede the , so  would be valid too, but it simplifies the replacement handling
p37752
as(dp37753
g16
V100297
p37754
stp37755
a((dp37756
g2
(lp37757
VYou have an atom feed there, so I'd use  to handle that:
p37758
aVThis prints:
p37759
aVFeedparser is an external library, but easily installed
p37760
aVIf you have to use only the standard library, you could use the  API, but to parse the Atom feed you need to include HTML entities in the parser, and you'll have to deal with namespaces (not 's strong point):
p37761
aVThe  dictionary lets  translate the  prefix to the correct namespace for those elements
p37762
as(dp37763
g16
V100297
p37764
stp37765
a((dp37766
g2
(lp37767
VYou are testing the wrong variable; you wanted to check , not :
p37768
aVI'd instead use Python's own  test instead to just test the first character of :
p37769
aVNext, just create the two lists with list comprehensions, because using a conditional expression for its side effects is pretty horrible:
p37770
as(dp37771
g16
V100297
p37772
stp37773
a((dp37774
g2
(lp37775
VYou are reading binary data, not , so you need to decode the output first:
p37776
aVYou were trying to split a  value using a  argument:
p37777
aVBy decoding you avoid that problem, and your  call will not have to prepend the output with  either
p37778
aVHowever, you probably just want to use the  module instead to get filesystem information:
p37779
as(dp37780
g16
V100297
p37781
stp37782
a((dp37783
g2
(lp37784
VYou need to use double underscores:
p37785
aVThe method  has no special meaning to Python and won't be called when instantiating
p37786
as(dp37787
g16
V100297
p37788
stp37789
a((dp37790
g2
(lp37791
VIterating over a  object yields just one element at a time, but your loop is expecting two values
p37792
aVYou are confusing  with  here
p37793
aVYou really just need :
p37794
aVor , which does the same (loop over all elements in the tree):
p37795
aVIf you really wanted to use the event-driver  you'd need to provide a file object:
p37796
aVAll snippets print:
p37797
as(dp37798
g16
V100297
p37799
stp37800
a((dp37801
g2
(lp37802
VYou are almost there; you need to move  out of the outer  loop, and you should not assign the result of  to , as that'll set the variable to
p37803
aVYou really overcomplicated your code though, it can be simplified to:
p37804
aVor even:
p37805
aVI suspect that your input file is a CSV file, in which case you may want to use the  module instead:
p37806
as(dp37807
g16
V100297
p37808
stp37809
a((dp37810
g2
(lp37811
VYou are looking for regular expressions here, using the  module:
p37812
aVThe pattern matches a literal quote, followed by 1 or more characters that are not quotes, followed by another quote and a full stop
p37813
aVDemo:
p37814
as(dp37815
g16
V100297
p37816
stp37817
a((dp37818
g2
(lp37819
VYou can do it with an stream-oriented iterative JSON parser, but you'll need to install it separately
p37820
aVTry out , it'll emit events for each JSON structure encountered:
p37821
as(dp37822
g16
V100297
p37823
stp37824
a((dp37825
g2
(lp37826
VYou'll need to loop over :
p37827
aVis still itself a dictionary with only two keys,  and
p37828
aVLooping over the  dictionary iterates over the keys, so in your code  is set to , then  (or vice versa)
p37829
aV, on the other hand, is a list of dictionaries, so looping over that list lets you access each individual item
p37830
as(dp37831
g16
V100297
p37832
stp37833
a((dp37834
g2
(lp37835
VYou'll need to customize the search view to set new sorting options, and to alter the default sort when no sort has been set
p37836
aVIf you still need to be able to sort by relevance, use a non-empty value that you then change in the  method:
p37837
aVThen register this view to your site; if you use a theme layer that'd be easiest:
p37838
aVYou'll need to copy over the  and  templates from the  package
p37839
as(dp37840
g16
V100297
p37841
stp37842
a((dp37843
g2
(lp37844
VFirst, the code generates 1200  coordinates, so each is a Python :
p37845
aVEach  and  coordinate consist of a random value within the constraints of the screen
p37846
aVNext, each of these coordinates are drawn:
p37847
aVThis passes the  coordinate list to the function
p37848
aVThis sets a white pixel at the given coordinates ( is ,  is the  coordinate):
p37849
aVThe code then subtracts 1 from the x coordinate (one step left)
p37850
aVThis changes the original list, because mutable lists are used:
p37851
aVIf this changed the coordinates beyond the edge of the screen, the star coordinates are replaced with new coordinates on the right-hand side of the screen, at a random height:
p37852
aVIf you were to repeat the  loop now with a screen blanking in between, you'd be animating the stars as moving from right to left, with new stars appearing on the right at random heights as stars drop off the left-hand side of the screen
p37853
aVThe core idea here is that the  function handles mutable lists and changes the values contained in them, effectively changing the contents of the global  list for the next loop of the animation
p37854
as(dp37855
g16
V100297
p37856
stp37857
a((dp37858
g2
(lp37859
VThe twitter server only serves you the 302 redirect once; after that it'll assume your browser has cached the redirect
p37860
aVThe body of the page does contain a pointer though, so even if you were not redirected you can see that there is still the link there:
p37861
aVLook for that exact text
p37862
as(dp37863
g16
V100297
p37864
stp37865
a((dp37866
g2
(lp37867
VSplit the text first, then convert to int:
p37868
aVFor Python 3, where  returns an generator, not a list, you can nest the list comprehension:
p37869
aVwhich would work equally well under Python 2
p37870
aVQuick demo:
p37871
aVYou can remove the nesting by moving the  loop to the outer list comprehension, to the end:
p37872
aVwhich gives:
p37873
as(dp37874
g16
V100297
p37875
stp37876
a((dp37877
g2
(lp37878
VWindows paths are encoding in UTF-16
p37879
aVPython can handle this for you, simply pass a unicode path to  and you'll get Unicode results instead:
p37880
as(dp37881
g16
V100297
p37882
stp37883
a((dp37884
g2
(lp37885
VYou need to specify  instead, see New and changed  keywords
p37886
aVThe  field was too vague and imprecise, so the  folk (so , from which  evolved) added more specific fields
p37887
aVIn addition, there are  and  fields for dependencies required for  and for running tests
p37888
as(dp37889
g16
V100297
p37890
stp37891
a((dp37892
g2
(lp37893
VList comprehensions to the rescue
p37894
aVThere is no shorter notation, I am afraid
p37895
aVIn Python 2 you use  instead of  to avoid materializing a useless list
p37896
aVThe alternative,  creates a list of length  with only one dictionary, referenced  times
p37897
aVThis leads to nasty surprises when adding keys to the dictionary
p37898
as(dp37899
g16
V100297
p37900
stp37901
a((dp37902
g2
(lp37903
VSQLAlchemy and SQLite know how to cache and do batch-inserts just fine
p37904
aVThere is no benefit in using an in-memory SQLite database here, because that database uses pages just like the on-disk version would, and the only difference is that eventually those pages get written to disk for disk-based database
p37905
aVThe difference in performance is only 1
p37906
aV5 times, see SQLite Performance Benchmark -- why is :memory: so slow
p37907
aVonly 1
p37908
aV5X as fast as disk
p37909
aVThere is also no way to move the in-memory database to a disk-based database at a later time, short of running queries on the in-memory database and executing batch inserts into the disk-based database on two separate connections
p37910
as(dp37911
g16
V100297
p37912
stp37913
a((dp37914
g2
(lp37915
VThe return value of  is -1 if the text is not found:
p37916
aVReturn the lowest index in the string where substring sub is found, such that sub is contained in the slice
p37917
aVOptional arguments start and end are interpreted as in slice notation
p37918
aVReturn -1 if sub is not found
p37919
aVThe  loop effectively makes the code go into an endless loop if  is not  and is useless unless there is more code following the snippet you shared with us
p37920
aVPresumably there is something like  as a next line, in which case using  instead of the  statement would have been far more readable
p37921
aVIt could be that  is set again further down, of course
p37922
as(dp37923
g16
V100297
p37924
stp37925
a((dp37926
g2
(lp37927
VThe  function returns a list of matches
p37928
aVSimply use the first:
p37929
as(dp37930
g16
V100297
p37931
stp37932
a((dp37933
g2
(lp37934
VActually, using a base class would work out better here:
p37935
as(dp37936
g16
V100297
p37937
stp37938
a((dp37939
g2
(lp37940
VIn Python 3, you specify the metaclass differently:
p37941
as(dp37942
g16
V100297
p37943
stp37944
a((dp37945
g2
(lp37946
VYour code discards the return values of recursive calls in the  branches
p37947
aVYou need more  statements:
p37948
aVIn Python, the expression  creates a tuple, and that is the canonical way to return multiple values from functions
p37949
aVThat is how multiple value returns work, by returning a tuple
p37950
aVSimply unpack the returned value:
p37951
aVor use indexing:
p37952
as(dp37953
g16
V100297
p37954
stp37955
a((dp37956
g2
(lp37957
VYou can set the  attribute:
p37958
aVor call  directly on the old instance:
p37959
aVHowever, the traceback is already automatically attached, there is no need to re-attach it, really
p37960
aVSee the  statement documentation:
p37961
aVA traceback object is normally created automatically when an exception is raised and attached to it as the  attribute, which is writable
p37962
aVIn this specific case, perhaps you wanted a different exception instead, with context
p37963
aVThis would create a chained exception, where both exceptions would be printed if uncaught, and the original exception is available as
p37964
as(dp37965
g16
V100297
p37966
stp37967
a((dp37968
g2
(lp37969
VIn this specific case, you can re-join the last 2 lines:
p37970
as(dp37971
g16
V100297
p37972
stp37973
a((dp37974
g2
(lp37975
VYou are masking your method  with a instance attribute
p37976
aVRename one or the other
p37977
aVYou could rename the instance attribute by pre-pending it with an underscore for example:
p37978
aVAttributes on the instance trump those on the class (except for data descriptors; think s)
p37979
aVFrom the Class definitions documentation:
p37980
aVVariables defined in the class definition are class attributes; they are shared by instances
p37981
aVInstance attributes can be set in a method with
p37982
aVBoth class and instance attributes are accessible through the notation \u201c\u201d, and an instance attribute hides a class attribute with the same name when accessed in this way
p37983
as(dp37984
g16
V100297
p37985
stp37986
a((dp37987
g2
(lp37988
VYou add them up:
p37989
aVSo the return value of  is added to the total sum so far, which was started at 0
p37990
aVYou do need to pass in the  and  values, not the indices themselves
p37991
as(dp37992
g16
V100297
p37993
stp37994
a((dp37995
g2
(lp37996
VYou could define a set of chains, applied with
p37997
aVThe  call effectively does  if  contained 3 functions
p37998
aVI assumed here that you wanted to apply  per textfile in path after the chain of functions has been applied
p37999
aVEach iteration of the  loop represents one of your  loop bodies in your original example, but we only loop through  once
p38000
aVYou can also swap the loops; adjusting to your example:
p38001
as(dp38002
g16
V100297
p38003
stp38004
a((dp38005
g2
(lp38006
VYou really want to drop the  anchor; I doubt the  will ever be at the start of a line
p38007
aVYou don't need the  part, those should be replaced by  flag constants
p38008
aVYou have Perl regular expression syntax there, Python doesn't have the specialized  syntax
p38009
aVAs such there are too many escapes and no actual Python string
p38010
aVAnd you don't actually include the  part
p38011
aVUse this instead:
p38012
aVI dropped the multiline flag since we are no longer matching on the start of a string having dropped the
p38013
aVI added a group () around the path so that  returns those and not the whole match
p38014
aVThe  part matches any character than is not a quote or slash to capture the filename part but not another directory name
p38015
aVShort demo:
p38016
as(dp38017
g16
V100297
p38018
stp38019
a((dp38020
g2
(lp38021
VYou are looking for , with a limit:
p38022
aVsearches for the splitting string from the end of input string, and the second argument limits how many times it'll split to just once
p38023
aVAnother option is to use , which will only ever split just once:
p38024
aVFor splitting just once,  is the faster method as well; if you need to split more than once you can only use
p38025
aVDemo:
p38026
aVand the same with
p38027
as(dp38028
g16
V100297
p38029
stp38030
a((dp38031
g2
(lp38032
VBoth are in-place assignments; they effectively give you  in the space of just
p38033
aVSo for your example, you could read that as:
p38034
aVThat is oversimplifying it a little, because with dedicated hooks for these operations the left-hand-side object can choose to do something special;  is really  for example, not
p38035
aVAn in-place operator gives a mutable object the chance to apply the change to  instead of creating a new object
p38036
aVFor your example, however, where I presume  is an int, you have immutable values and the in-place operation has to return a new value
p38037
as(dp38038
g16
V100297
p38039
stp38040
a((dp38041
g2
(lp38042
VYou are parsing XML, and the library already knows how to handle decoding for you
p38043
aVThe API returns  objects, but you are trying to treat them as byte strings instead
p38044
aVWhere you call , you are using a python bytestring instead of a  object, so Python has to encode the Unicode values to fit in a bytestring
p38045
aVTo do so it can only use a default, which is ASCII
p38046
aVThe simple solution is to use a unicode string there instead, note the  string literal:
p38047
aVPython will still have to encode this when printing, but at least now Python can do some auto-detection of your terminal and determine what encoding it needs to use
p38048
aVYou may want to read up on Python and Unicode:
p38049
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p38050
aVby Joel Spolsky
p38051
aVThe Python Unicode HOWTO
p38052
aVPragmatic Unicode by Ned Batchelder
p38053
as(dp38054
g16
V100297
p38055
stp38056
a((dp38057
g2
(lp38058
VIf you have the key to the nested , you can use a simple  test:
p38059
aVbut you could use a  instead:
p38060
aVLike a , a  provides a default value for missing keys, defaulting to
p38061
aVCounters have other benefits; instead of looping over a set of strings and manually increasing the counter for those one by one, pass the whole sequence to the  method for the appropriate counter:
p38062
aVand the  will count them all for you
p38063
aVThe  class is what other languages might call a Multi-Set or Bag type
p38064
aVThey support interesting comparison and arithmetic operations too, do make sure you read the documentation for the type
p38065
as(dp38066
g16
V100297
p38067
stp38068
a((dp38069
g2
(lp38070
VYou could use actual Python syntax, such as a conditional expression:
p38071
aVThis is based on a interpreting your  syntax as the Javascript conditional expression syntax
p38072
aVThis of course assumes there is a separate  variable defined somewhere:
p38073
as(dp38074
g16
V100297
p38075
stp38076
a((dp38077
g2
(lp38078
VNo, you'll need to remove them manually
p38079
aVUsing  makes that a little easier perhaps:
p38080
aVDemonstration:
p38081
aVBy using  you only need to test the keys for which the count is 15 or over; after that it'll forgo testing and just pass through everything
p38082
aVThat works great with the sorted  list
p38083
aVIf there are a lot of values below 15, that saves execution time for all those tests
p38084
as(dp38085
g16
V100297
p38086
stp38087
a((dp38088
g2
(lp38089
VYes, the stat structure  does contain that information
p38090
aVUse the  module to determine if it is a directory:
p38091
as(dp38092
g16
V100297
p38093
stp38094
a((dp38095
g2
(lp38096
VYou could create yourself a parser, instead of using :
p38097
aVFor Blogger
p38098
aVcom Atom feed exports, this works to print the text content of the  entry
p38099
as(dp38100
g16
V100297
p38101
stp38102
a((dp38103
g2
(lp38104
VYour regular expression matches just one character after the  part
p38105
aVYou need to specify that you want 1 or more by adding the  multiplier:
p38106
aVNow your expression matches anything that has at least 1 character, not just 1 and nothing more
p38107
as(dp38108
g16
V100297
p38109
stp38110
a((dp38111
g2
(lp38112
VYou really do not want to use string interpolation, use SQL parameters instead
p38113
aVNext, you are fetching two rows; all you really need to do is test if there are any rows:
p38114
aVThis can be simplified further; you could use  as a context manager to commit automatically or roll back if it fails:
p38115
as(dp38116
g16
V100297
p38117
stp38118
a((dp38119
g2
(lp38120
VYou just need to call
p38121
aVSince the return value of  itself is None, your version just replaced the old value (a list) with  after you successfully added the item to the list
p38122
aVA quick demo:
p38123
aVIn Python, in-place operations such as appending to the list, return :
p38124
aVbut as you can see, the list itself was changed
p38125
as(dp38126
g16
V100297
p38127
stp38128
a((dp38129
g2
(lp38130
VJust use the expression with the  module:
p38131
aVYou could also just use a ; simply pass it your expression and your message, then use that instead of the above function
p38132
as(dp38133
g16
V100297
p38134
stp38135
a((dp38136
g2
(lp38137
VYou could use a generator to return an uppercased keys dictionary for each row:
p38138
aVthen use this as:
p38139
as(dp38140
g16
V100297
p38141
stp38142
a((dp38143
g2
(lp38144
VJust cast the key to  and :
p38145
aVor use formatting if you need to prepend the keys with a string:
p38146
aVThe key and value expressions in a dict comprehension are just that, python expressions
p38147
as(dp38148
g16
V100297
p38149
stp38150
a((dp38151
g2
(lp38152
VThe  module uses per-OS-specific packages, most of which use standard C calls, the same calls the command-line tools would have to use
p38153
aVYou want to study the   module source first, then platform-specific modules
p38154
aVhandles OS calls for UNIX, OS/2 and Windows
p38155
aVFor example, the  function uses ,  and  calls on POSIX systems
p38156
as(dp38157
g16
V100297
p38158
stp38159
a((dp38160
g2
(lp38161
VYou need to set  for the shell to interpret the command, and most of all the pipe:
p38162
as(dp38163
g16
V100297
p38164
stp38165
a((dp38166
g2
(lp38167
VYou have stored some of your model instances in a session cookie, which uses  to serialize and deserialize that data
p38168
aVBecause you moved the model to another module, pickle can no longer load the session data
p38169
aVYou can do two things:
p38170
aVIf you don't care about the session data, simply delete your session cookie
p38171
aVUse your browser tools to delete the cookie manually, perhaps delete all cookies for your site
p38172
aVCreate an alias for the model in the old location
p38173
aVCreate a  module that simply imports the models that used to be there
p38174
aVThis module does not need to be imported by anything else,  will load it for you when needed
p38175
aVAny future sessions will be created with the new location of your models, this affects only old session data
p38176
as(dp38177
g16
V100297
p38178
stp38179
a((dp38180
g2
(lp38181
VNot out of the box
p38182
aVYou'd need to add asynch support to your environment
p38183
aVTake a look at ; you'll need a ZEO environment and at least one extra instance
p38184
aVThe latter will run async jobs you push into the queue from your site
p38185
aVYou can then define methods to be executed asynchronously and push tasks into the queue to execute such a method asynchronously
p38186
aVExample code, push a task into the queue:
p38187
aVand the task itself:
p38188
aVwhere  is a persistent object in your ZODB
p38189
aVThe  takes at least a function and a context object, but you can add as many further arguments as you need to execute your task
p38190
aVThe arguments must be pickleable
p38191
aVThe task will then be executed by an async worker instance when it can, outside of the context of the current request
p38192
as(dp38193
g16
V100297
p38194
stp38195
a((dp38196
g2
(lp38197
V takes 1 positional argument and two optional arguments, and interprets these arguments differently depending on how many arguments you passed in
p38198
aVIf only one argument was passed in, it is assumed to be the  argument, otherwise that first argument is interpreted as the start instead
p38199
aVIn reality, , coded in C, takes a variable number of arguments
p38200
aVYou could emulate that like this:
p38201
aVbut you could also just swap arguments:
p38202
as(dp38203
g16
V100297
p38204
stp38205
a((dp38206
g2
(lp38207
VYou can give  a  function; it is called for any data type that JSON doesn't know how to handle:
p38208
as(dp38209
g16
V100297
p38210
stp38211
a((dp38212
g2
(lp38213
V in python 3 does not return a list, but a iterable  object
p38214
aVCall  on it to get the first filtered item:
p38215
aVThere is no need to convert it to a list, as you only use the first value
p38216
as(dp38217
g16
V100297
p38218
stp38219
a((dp38220
g2
(lp38221
VYou can combine them with :
p38222
aVor you can generate the numbers together to start with:
p38223
as(dp38224
g16
V100297
p38225
stp38226
a((dp38227
g2
(lp38228
VThe example uses space separated data; the string literals have newlines between them, but Python joins those together
p38229
aVIn any case, you can use  to join your coordinates in the same manner as that example
p38230
as(dp38231
g16
V100297
p38232
stp38233
a((dp38234
g2
(lp38235
VYou need to use   instead:
p38236
aVSee Handling Exceptions in the Python tutorial
p38237
aVWhat really happens is that you were redirected for that URL and you got the image page instead
p38238
aVIf you are using  to fetch the JSON, look at the response history instead:
p38239
aVor you could even disallow redirections:
p38240
as(dp38241
g16
V100297
p38242
stp38243
a((dp38244
g2
(lp38245
VIt is set to the absolute name of the module as imported
p38246
aVIf you imported it as , then  is set to
p38247
aVThe name is determined in the  module, but because that module handles various different types of imports (including zip imports, bytecode-only imports and extension modules) there are several code paths to trace through
p38248
aVNormally,  statements are translated to a call to , which is by default implemented as a call to
p38249
aVSee the  documentation to get a feel for what the arguments mean
p38250
aVWithin  relative names are resolved, so you can chase down the  variables there if you want to
p38251
aVThe rest of the module handles the actual imports, with  creating the actual namespace object and setting the  key, but you can trace that  value back to
p38252
aVBy creating a module object, it's  value is set in the  object constructor
p38253
as(dp38254
g16
V100297
p38255
stp38256
a((dp38257
g2
(lp38258
V is not a method, you do not need to call it
p38259
aVOnly  is a method
p38260
aVThis works just fine:
p38261
aVFrom the  documentation:
p38262
aVInstance attributes (read-only):
p38263
aVBetween  and  inclusive
p38264
aVBetween 1 and 12 inclusive
p38265
aVBetween 1 and the number of days in the given month of the given year
p38266
aVIt is implemented as a data descriptor (like a ) to make it read-only, hence the  error you saw
p38267
as(dp38268
g16
V100297
p38269
stp38270
a((dp38271
g2
(lp38272
VYou need to use slice assignment to replace all list elements instead of the list itself:
p38273
aVThe  part turns this into slice assignment; instead of replacing the reference  points to, you replace all elements contained in  with the new list
p38274
aVDemo:
p38275
as(dp38276
g16
V100297
p38277
stp38278
a((dp38279
g2
(lp38280
VGrouped  statements require Python 2
p38281
aV7 or up
p38282
aVFor earlier versions, nest the statements:
p38283
aVThe exact error message you get is strong evidence that you are running the code on Python 2
p38284
aV6, not 2
p38285
aV7:
p38286
aVYou cannot group  statements with  handlers in any Python versions, you need to use a   around the  statement(s) instead:
p38287
aVI would not use a blanket except myself; the blanket except catches name, memory and keyboard interrupt exceptions too, for which you usually want to exit your program instead
p38288
as(dp38289
g16
V100297
p38290
stp38291
a((dp38292
g2
(lp38293
VCount per table:
p38294
aVYou do need to do something with each count, of course
p38295
aVStore them in a dictionary, print them, add them to a list, etc
p38296
aVStoring them in a per-club dictionary example:
p38297
as(dp38298
g16
V100297
p38299
stp38300
a((dp38301
g2
(lp38302
VThe  method by default splits on arbitrary-width whitespace:
p38303
aVPicking out just the middle number then becomes a simple select:
p38304
aVQuoting the documentation:
p38305
aVIf sep is not specified or is , a different splitting algorithm is applied: runs of consecutive whitespace are regarded as a single separator, and the result will contain no empty strings at the start or end if the string has leading or trailing whitespace
p38306
aVConsequently, splitting an empty string or a string consisting of just whitespace with a  separator returns
p38307
as(dp38308
g16
V100297
p38309
stp38310
a((dp38311
g2
(lp38312
VYou'd need to create your own subclass of the  class, and override the  method:
p38313
aVWe let the base class do most of the work and only format the  explicitly; it has a custom  which means that the original  implementation just uses that instead of recursing over it
p38314
aVThen use this class instead of direct calls to :
p38315
aVThis produces:
p38316
as(dp38317
g16
V100297
p38318
stp38319
a((dp38320
g2
(lp38321
V is for GET-style URL parameters,  is for POST-style body information
p38322
aVIt is perfectly legal to provide both types of information in a request, and your request does so too, but you encoded the URL parameters into the URL already
p38323
aVYour raw post contains JSON data though, you better use the  module to properly encode that:
p38324
aVYou could split out the URL parameters too:
p38325
aVThen post this with:
p38326
as(dp38327
g16
V100297
p38328
stp38329
a((dp38330
g2
(lp38331
VSelect the  tags instead of their text content; by using  we only select  tags that have a  element as a direct child:
p38332
as(dp38333
g16
V100297
p38334
stp38335
a((dp38336
g2
(lp38337
VYou need to do some text processing:
p38338
aVThe  call selects the first line that contains
p38339
aVWe then split that line once on , take the rest of the line, remove whitespace and the semicolon, then interpret that as JSON
p38340
aVThis gives me:
p38341
aVIf your value definition spans multiple lines, we can use the  method to make parsing that information out a little easier:
p38342
aVThe  call parses JSON even if there is trailing data, so it'll try and find a full JSON object starting right past the  following the  text
p38343
as(dp38344
g16
V100297
p38345
stp38346
a((dp38347
g2
(lp38348
VA quick regular expression that pulls out all ip-address-like text:
p38349
aVFor your example text, the  call returns:
p38350
as(dp38351
g16
V100297
p38352
stp38353
a((dp38354
g2
(lp38355
VYou are using the  function, while passing in an open file
p38356
aVUse  instead (note, no )
p38357
aVYou do need to re-open the file every time you call your  function, better just store the filename globally:
p38358
aVLast but not least, you should use a absolute path to the filename, and not rely on the current working directory being correct
p38359
as(dp38360
g16
V100297
p38361
stp38362
a((dp38363
g2
(lp38364
VYou do not need to pass in  when calling the inherited  method with :
p38365
aVLooking at the example listed in the documentation, the attribute should be called , not :
p38366
as(dp38367
g16
V100297
p38368
stp38369
a((dp38370
g2
(lp38371
VUse :
p38372
as(dp38373
g16
V100297
p38374
stp38375
a((dp38376
g2
(lp38377
VYou use python exception handling:
p38378
as(dp38379
g16
V100297
p38380
stp38381
a((dp38382
g2
(lp38383
VYou are looking for  instead
p38384
aVis needed to alter the behaviour of the  and  start-of-line and end-of-line anchors,  makes  match newlines too
p38385
aVWhen specified, the pattern character  matches at
p38386
aVthe beginning of the string and at the beginning of each line
p38387
aV(immediately following each newline); and the pattern character
p38388
aVmatches at the end of the string and at the end of each line
p38389
aV(immediately preceding each newline)
p38390
aVBy default,  matches only at
p38391
aVthe beginning of the string, and  only at the end of the string and
p38392
aVimmediately before the newline (if any) at the end of the string
p38393
aVMake the  special character match any character at all, including a newline; without this flag,  will match anything except a newline
p38394
aVWith , I get:
p38395
aVIf you have multiple such messages, you need to use a non-greedy  match:
p38396
aVNote the question mark; it instructs the multiplier to match the smallest number of characters that satisfy the pattern, rather than the most
p38397
aVUsing  we then find 3 matches rather than 1 in your updated example:
p38398
as(dp38399
g16
V100297
p38400
stp38401
a((dp38402
g2
(lp38403
VIn Python, values that are considered 'empty', such as numeric 0, are considered False in a boolean context, and otherwise are True
p38404
aVThus,  is True if  has length, otherwise it is empty
p38405
aVIf  is a standard Python sequence type then the code can be simplified to:
p38406
aVbecause the same applies to sequences; empty is False, having a non-zero length means it's True
p38407
aVSee Truth Value Testing in the Python documentation for all the important details
p38408
aVNote that  has been deprecated; you should really use  instead
p38409
as(dp38410
g16
V100297
p38411
stp38412
a((dp38413
g2
(lp38414
VThis uses slice assignment and slice step sizes to swap every pair in the list around, in-place:
p38415
aVOtherwise you could use some  tricks:
p38416
aVwhich gives:
p38417
aVwith the  call optional; if you only need to loop over the result the generator is enough:
p38418
aVwhere  can take arbitrary iterators too
p38419
as(dp38420
g16
V100297
p38421
stp38422
a((dp38423
g2
(lp38424
VAll you need to do is call  without arguments:
p38425
aVYou already told  what your headers are
p38426
as(dp38427
g16
V100297
p38428
stp38429
a((dp38430
g2
(lp38431
VNewlines are whitespace too as far as the  character class is concerned
p38432
aVIf you want to match spaces only you need to match  instead:
p38433
as(dp38434
g16
V100297
p38435
stp38436
a((dp38437
g2
(lp38438
VYou have lists inside of your dictionary, so the  part of the expression returns a list
p38439
aVJust keep adding  indexings:
p38440
aVYou could break it down with intermediary variables if that is easier:
p38441
as(dp38442
g16
V100297
p38443
stp38444
a((dp38445
g2
(lp38446
VYou are using  as a loop variable, but refer to  instead in the loop
p38447
aVIf you had  defined before it'll probably produce confusing results
p38448
aVworks for me:
p38449
aVetc
p38450
as(dp38451
g16
V100297
p38452
stp38453
a((dp38454
g2
(lp38455
VYou need to not only match the word characters, but also the word boundary:
p38456
aVThe  anchor matches at the start or end of a word, limiting the word to exactly 7 characters
p38457
aVIt'd be more efficient if you were to loop through the file line-by-line instead of reading it all into memory in one go:
p38458
aVUsing  gives us a list of all matches on the line
p38459
aVTo check if the matches have at least one of the required characters in it, I personally would just use a set intersection test:
p38460
as(dp38461
g16
V100297
p38462
stp38463
a((dp38464
g2
(lp38465
VYou need to create a new connection per thread
p38466
aVThe ZODB provides each connection with a consistent per-transaction view (MVCC, multi-view concurrency control), so even for reading you want a separate connection
p38467
aVThe connection can be re-used for sequential requests in one thread
p38468
aVSo for the connection, I'd use the per-thread pool supplied by , perhaps caching the connection per request (as pyramid_zodbconn does)
p38469
aVWithin your request handlers, you can use the transaction manager as a context manager:
p38470
aVUsing the  object as a context manager ensures that the transaction is started on enter, and committed on exit without exception, aborted on exit with an exception
p38471
aVYou could create a context manager to handle the ZODB connection as well:
p38472
aVthen use that as a context manager together with the transaction manager:
p38473
aVThis context manager takes the database object, and returns the root object, closing the connection automatically when the context is exited again
p38474
as(dp38475
g16
V100297
p38476
stp38477
a((dp38478
g2
(lp38479
VThe server is rather b0rken
p38480
aVIt responds with a 500 error in the browser as well
p38481
aVYou can catch the exception and still read the response:
p38482
as(dp38483
g16
V100297
p38484
stp38485
a((dp38486
g2
(lp38487
V  is not a legal expression
p38488
aVUse:
p38489
aVThis makes use of chained comparison operators; it roughly means the same as:
p38490
aVbut  is evaluated only once, and we made it clearer that the number is outside the range 1 - 3
p38491
aVYou probably wanted to use a  loop instead, to keep asking for a correct number:
p38492
as(dp38493
g16
V100297
p38494
stp38495
a((dp38496
g2
(lp38497
VYou need to call  on your  instance, and you do not need to pass in :
p38498
aVNote that you need to receive the return value of the  method
p38499
aVThe same applies to the  method further on:
p38500
aVYou probably need to fix the return values in the  and  methods; instead of  and , return  or  perhaps
p38501
aVThe  parameter is taken care of for you by Python, and will refer to the specific  instance
p38502
aVNot that you really need classes here, your  class currently has no per-instance state, for example
p38503
aVYou don't use  in any of the methods, because there is nothing on the instance to refer to
p38504
as(dp38505
g16
V100297
p38506
stp38507
a((dp38508
g2
(lp38509
VThe pool size is only a 'guideline'; the warning is logged when you exceed that size; if you were to use double the number of connections an  log message would be registed instead
p38510
aVThese are there to indicate you may be using too many connections in your application
p38511
aVThe pool will try to reduce the number of retained connections to the pool size as you close connections
p38512
aVYou need to set it to the maximum number of threads in your application
p38513
aVFor Tornado, which I believe uses asynchronous events instead of threading almost exclusively, that might be harder to determine; if there is a maximum number of concurrent connections configurable in Tornado, then the pool size needs to be set to that number
p38514
aVI am not sure how the ZODB will perform when your application scales to hundreds or thousands of concurrent connections, though
p38515
aVI've so far only used it with at most 100 or so concurrent connections spread across several processes and even machines (using ZEO or RelStorage to serve the ZODB across those processes)
p38516
aVI'd say that if most of these connections only read, you should be fine; it's writing on the same object concurrently that is ZODB's weak point as far as scalability is concerned
p38517
as(dp38518
g16
V100297
p38519
stp38520
a((dp38521
g2
(lp38522
V is an attribute of the tag
p38523
aVOnce you have the tag, access the attributes as you would dictionary keys; you only found the  tag so you need to navigate to the contained  tag too:
p38524
aVYour code used  which returns a tag object; looping over that gives you the children, so  was the  object
p38525
aVI changed this to be a bit more direct and clearer
p38526
aVis now the , and we navigate directly to the first  and contained  tag
p38527
as(dp38528
g16
V100297
p38529
stp38530
a((dp38531
g2
(lp38532
VYou were looking for date output formatting and :
p38533
aVFrom the linked documentation:
p38534
aV- Minutes
p38535
aV-  to
p38536
as(dp38537
g16
V100297
p38538
stp38539
a((dp38540
g2
(lp38541
VGenerally, you just try to import the dependency, and handle the  exception gracefully:
p38542
aVYou can list such dependencies in the  entry of your setuptools-based  script
p38543
aV,  and  all can handle installing such extras
p38544
aVSee Declaring \u201cExtras\u201d (optional features with their own dependencies)
p38545
aVYou can use the  entry to list minimal version requirements if you have those
p38546
aVYes, there is a possibility that the user already has an older version of the dependency installed; I'd just document the requirements clearly
p38547
aVReally, test for features, not versions
p38548
aVIf you need a newer version because a certain API method has been added
p38549
aVTest for that method rather than for the version
p38550
aVHowever, it sounds as if you may want to package the plugins as separate packages instead, then list those in
p38551
aVI'd use entry points to register and enumerate such plugins
p38552
aVThat way you do not need to test for imports or for packages, you just enumerate over registered entry points instead
p38553
aVEach plugin lists their own dependencies and has it's own unit tests
p38554
as(dp38555
g16
V100297
p38556
stp38557
a((dp38558
g2
(lp38559
VYou need to do 2 things:
p38560
aVmerge your lists
p38561
aVproduce the product of the two lists
p38562
aVUse  for the latter,  for the former
p38563
aVwhich produces:
p38564
aVThe loop can be collapsed into a list comprehension:
p38565
aVto produce a list:
p38566
as(dp38567
g16
V100297
p38568
stp38569
a((dp38570
g2
(lp38571
VEach row consists of a python list of columns, with only one column in this case
p38572
aVSince there are no comma-separated columns, just one item per line, you don't need to use the  module here
p38573
aVJust read from the file directly:
p38574
as(dp38575
g16
V100297
p38576
stp38577
a((dp38578
g2
(lp38579
VYou installed a package that uses Python 3 syntax, in Python 2
p38580
aVThe package in question supports Python 2
p38581
aV6 and newer, so there is an installation error here
p38582
aVThe package install script uses the  code translation tool to rewrite code as needed, and it appears that that tool was run while not needed, as the original  class uses Python 2 syntax
p38583
aVRemove the package and re-install it with the correct Python version
p38584
as(dp38585
g16
V100297
p38586
stp38587
a((dp38588
g2
(lp38589
VYou'd read the file line by line, then keep track of the maxima and output those when the next section begins:
p38590
aVThe output uses 3 tabs, just like your input
p38591
aVFor your example input, this writes:
p38592
as(dp38593
g16
V100297
p38594
stp38595
a((dp38596
g2
(lp38597
VYour data is already encoded to UTF-8
p38598
aVJust open the file without  and write the data directly:
p38599
aVUnicode encoding / decoding errors usually occur because you are mixing byte strings and unicode strings; concatenation, comparisons, using  when you needed to use  instead, etc
p38600
aVYou may want to read up on Python and Unicode:
p38601
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p38602
aVby Joel Spolsky
p38603
aVThe Python Unicode HOWTO
p38604
aVPragmatic Unicode by Ned Batchelder
p38605
as(dp38606
g16
V100297
p38607
stp38608
a((dp38609
g2
(lp38610
VI guess you want to key things to to the  digit:
p38611
aVI used a quick set difference to print the differences, this may require refining
p38612
aVFor your sample data, this prints:
p38613
as(dp38614
g16
V100297
p38615
stp38616
a((dp38617
g2
(lp38618
VDon't use globals for this
p38619
aVThere is no need to 'deepcopy' the function either; the  global is not part of the function state at all
p38620
aVUse a function factory that provides a scoped value instead, or use a  to provide a default argument to your function
p38621
aVFunction factory:
p38622
aVNow  is a scoped value for ,  returns a new  every time it is called, and  is stored as a cell variable for
p38623
aVDemo:
p38624
aVUsing :
p38625
aVHere  produces a new callable that will call  whenever called, appending any extra arguments passed in
p38626
aVDemo:
p38627
as(dp38628
g16
V100297
p38629
stp38630
a((dp38631
g2
(lp38632
VYou put your numbers in a nested list, a list in a list
p38633
aVNo need to do that:
p38634
as(dp38635
g16
V100297
p38636
stp38637
a((dp38638
g2
(lp38639
VStore the name of the two functions, then use  to retrieve the bound method in :
p38640
aVAlternatively, just proxy the method:
p38641
aVThe  property just returns the correct bound method for the current mode
p38642
aVUsing a property simplifies call signature handling, and gives users the actual method to introspect if they so wish
p38643
aVEither method has the same end-result:
p38644
aVThe difference lies in what is stored in the instance, the first method stores bound methods:
p38645
aVversus the method in the other:
p38646
aVThat may not seem much of a difference, but the latter method creates instances that can be pickled and deep-copied without problems
p38647
as(dp38648
g16
V100297
p38649
stp38650
a((dp38651
g2
(lp38652
VYou need to declare the global in the method, not in the class scope:
p38653
as(dp38654
g16
V100297
p38655
stp38656
a((dp38657
g2
(lp38658
VYou'll need to track all amino acid residues when building , then when you loop again to create lists, replace the set with the list of all possible amino acid residues if the length is not 1:
p38659
aVThis prints:
p38660
as(dp38661
g16
V100297
p38662
stp38663
a((dp38664
g2
(lp38665
VSome modules use some C code to implement parts that need the speed
p38666
aVThe main module still uses Python glue, and the  version contains the C extension
p38667
aVSee for example the  module; it imports from the  C library for most of the functionality, with only the , ,  and  classes implemented in pure Python
p38668
aVThe  plus  convention is just that, a convention
p38669
aVNot all C extensions follow this pattern
p38670
as(dp38671
g16
V100297
p38672
stp38673
a((dp38674
g2
(lp38675
VYou are testing for identity, not equality
p38676
aVUse  instead
p38677
aVYou are confusing identity with equality
p38678
aVTwo 1 dollar banknotes have the same value, so they are equal when it comes to buying a donut
p38679
aVBut they each have a separate identity
p38680
aVTo help performance, sometimes Python uses the same object when you tell Python to store the same literal value
p38681
aVThis is called interning, and when that happens, you get a reference to an  or a  value that just happens to be the same object too
p38682
aVtests for identity; it is basically implemented as , two references are identical if the identity of their values is equal
p38683
aVThe are referring to the same object, not just the same value
p38684
as(dp38685
g16
V100297
p38686
stp38687
a((dp38688
g2
(lp38689
VYou need to escape the key using :
p38690
aVotherwise the contents will be interpreted as a regular expression
p38691
aVYou are not using regular expressions at all here, so you may as well just use:
p38692
aVIf you wanted to replace only whole words (so with whitespace or punctuation markes around them, at the start or end of the input string), you need to some kind of boundary anchors, at which point it makes sense to use regular expressions
p38693
aVIf all you have are alphanumeric words (plus underscores),  would work:
p38694
aVThis puts  before and after the string you wanted to replace, so that  in  is changed, but  is not
p38695
aVFor input that involves non-alphanumeric 'words', you'd need to match whitespace-or-start and whitespace-or-end anchors with look-aheads and look-behinds:
p38696
aVHere the pattern  uses two anchors, the start-of-string anchor and a look-behind assertion, to match the places where there is either the start of the string or a space immediately to the left
p38697
aVSimilarly  does the same for the other end, matching the end of the string or a position followed by a space
p38698
as(dp38699
g16
V100297
p38700
stp38701
a((dp38702
g2
(lp38703
VYou are probably mixing tabs and spaces
p38704
aVDon't do that
p38705
aVTo fix your file, run Python in mixed tabs-and-spaces error mode:
p38706
aVthen configure your editor to use only spaces for indentation, and replace any tabs with spaces
p38707
aVUsing only spaces for identation is recommended by the Python styleguide
p38708
as(dp38709
g16
V100297
p38710
stp38711
a((dp38712
g2
(lp38713
VYou need to just loop over the query without calling , and call  to set a batch size:
p38714
aVindeed turns the whole result set into a list first, causing a delay if the resultset is large
p38715
aVIterating over the query directly after setting  instead fetches results as needed, provided the database API supports it
p38716
aVIf you wanted to know up-front how many rows will be returned, call  first:
p38717
aVasks the database to gives us an item count for us first
p38718
aVYour database could still be pre-caching the result rows, leading to a start-up delay, even when using
p38719
aVIn that case you'll need to use a windowed query to break up your query into blocks based on the range of values in one of the columns
p38720
aVWether or not this will work depends on your exact table layout
p38721
as(dp38722
g16
V100297
p38723
stp38724
a((dp38725
g2
(lp38726
VRemove the  statement, just call  without printing it's return value:
p38727
aVAll python functions return some value
p38728
aVIf you don't return anything explicitly, the default is value is
p38729
aVCalling  prints the default  returned by
p38730
as(dp38731
g16
V100297
p38732
stp38733
a((dp38734
g2
(lp38735
VShell wildcard patterns don't work in Python
p38736
aVUse the  or  modules to interpret the wildcards instead
p38737
aVinterprets wildcards and lets you match strings against them,  uses  internally, together with  to give you a list of matching filenames
p38738
aVIn this case, I'd use :
p38739
aVIf your structure contains only one level of subdirectories, you could also use a  pattern that expresses that; the  in the path of expression is expanded to match all subdirectories:
p38740
as(dp38741
g16
V100297
p38742
stp38743
a((dp38744
g2
(lp38745
VYou'll need to traverse your whole ZODB manually, I'm afraid
p38746
aVIf these objects are content objects, you should be able to use the standard OFS methods:
p38747
aVThis assumes you already included the work-around you linked to; there is little point in trying to do the above with  objects
p38748
aVThe above script acts as a  script, run it as such:
p38749
aVYou are going to process everything in the site, a fairly hefty process that will involve a lot of cache churn and possibly a large commit with potential conflicts
p38750
aVYou do not want to run this as a through-the-web script, really
p38751
as(dp38752
g16
V100297
p38753
stp38754
a((dp38755
g2
(lp38756
VYou never create a new  dictionary, you just keep updating the one you created before the loop
p38757
aVCreate a new one for each :
p38758
aVYou can simplify your code by using  and :
p38759
as(dp38760
g16
V100297
p38761
stp38762
a((dp38763
g2
(lp38764
VWhen your  doesn't return any results,  is never set (nor are the other variables in that loop)
p38765
aVPython names do not exist until assigned to, so if  is an empty list, the names inside the  loop never get assigned to and thus do not exist by the time you loop over  later on
p38766
aVYou could set default values for those names as a work-around:
p38767
aVto at least ensure that they are defined
p38768
as(dp38769
g16
V100297
p38770
stp38771
a((dp38772
g2
(lp38773
VYou could join on the punctuation first:
p38774
aVThe  generator yields strings with any following punctuation already joined on:
p38775
as(dp38776
g16
V100297
p38777
stp38778
a((dp38779
g2
(lp38780
VThe Sentry handler adds that info in your screenshot when capturing the message for an exception, and takes that information from the traceback, not the exception itself
p38781
aVYou can add extra fields by passing extra keyword arguments to ; the Django client does so for you if you pass in the  object, for example
p38782
aVCurrently, no other data is taken from exceptions
p38783
aVYou'd have to expand the exception handling yourself to add such a facility
p38784
as(dp38785
g16
V100297
p38786
stp38787
a((dp38788
g2
(lp38789
V returns a result list, you'd need to loop over those or pick one to get to another contained element with it's own  method:
p38790
aVor pick one row:
p38791
aVNote that  is deprecated, you should use  instead
p38792
as(dp38793
g16
V100297
p38794
stp38795
a((dp38796
g2
(lp38797
VLoop over the  result
p38798
aVReplace  with  if you are using Python 3
p38799
aVDemo:
p38800
aVNote that this approach requires you to keep your target list in sorted key order, rather a strange limitation for something that should be straightforward and simple
p38801
aVThis is far more verbose than your version
p38802
aVThere is nothing wrong with it, really
p38803
as(dp38804
g16
V100297
p38805
stp38806
a((dp38807
g2
(lp38808
VThe  failed to find a URL route
p38809
aVPerhaps you registered a  route instead
p38810
aVYou need to check the name of the route and the provided arguments to match an existing route you registered
p38811
aVFor more details see the Reverse resolution of URLs documentation
p38812
as(dp38813
g16
V100297
p38814
stp38815
a((dp38816
g2
(lp38817
VUse a look-ahead to match everything up to the next section header, or the end of the string:
p38818
aVNote that this needs a non-greedy  as well, otherwise it'll still match all the way to the end first
p38819
aVDemo:
p38820
as(dp38821
g16
V100297
p38822
stp38823
a((dp38824
g2
(lp38825
VYou are overcomplicating things
p38826
aVJust use a list or dictionary:
p38827
aVthen refer to , etc
p38828
aVas needed, or loop over the structure to process each in turn
p38829
as(dp38830
g16
V100297
p38831
stp38832
a((dp38833
g2
(lp38834
VPython does not look up scripts on some sort of path
p38835
aVYou have 2 options:
p38836
aVUse the full path:
p38837
aVPlace the script in a directory that is on your , make it executable () and give it a Shebang line:
p38838
aVThe second option is probably preferable
p38839
aVOn Windows, you can install  to support shebang lines; if you use Python 3
p38840
aV3 or newer, it is already included with your Python installation
p38841
as(dp38842
g16
V100297
p38843
stp38844
a((dp38845
g2
(lp38846
VSimply split the attribute values and convert them to integers, per element
p38847
aVWith ElementTree:
p38848
aVFor your example document, this prints out:
p38849
as(dp38850
g16
V100297
p38851
stp38852
a((dp38853
g2
(lp38854
VAnchor it to the start and end, and match one or more characters:
p38855
aVHere  anchors to the start of the string,  to the end, and  makes sure you match 1 or more characters
p38856
aVYou'd be better off just using  instead though
p38857
aVNo need to reach for the hefty regular expression hammer here:
p38858
as(dp38859
g16
V100297
p38860
stp38861
a((dp38862
g2
(lp38863
VYour logic is flawed;  does not do what you think it does
p38864
aVYou want:
p38865
aVinstead
p38866
aVSimilarly:
p38867
aVshould be:
p38868
aVThe expression  instead can is interpreted as , because any non-empty string is considered  in a boolean context, so the  returns just  as the  operator returns the second string, which is then tested against the  operator:
p38869
aVI do suspect that your code will not work even with these fixes; you test one line at a time, and your input example has the  strings on separate lines
p38870
as(dp38871
g16
V100297
p38872
stp38873
a((dp38874
g2
(lp38875
VCatching the recursion exception is the better approach, but you could also add a decorator on the functions you wanted to 'protect':
p38876
aVthen apply that decorator to the macro render function
p38877
aVA simple demo:
p38878
as(dp38879
g16
V100297
p38880
stp38881
a((dp38882
g2
(lp38883
VYou forgot a few commas:
p38884
aVand more again on the next lines:
p38885
aVI'd be better if you used formatting:
p38886
aVThis uses the  method, combined with  a triple-qouted string to format the text in one go, formatting the float values with two decimals after the decimal point
p38887
aVSample output:
p38888
as(dp38889
g16
V100297
p38890
stp38891
a((dp38892
g2
(lp38893
V is part of the WebOb project, see it's MultiDict documenation
p38894
aVA  acts mostly just like a python dictionary, except that you can explicitly ask for one value or for a list of values with the  and  methods
p38895
aVreturns a dictionary with single and list values as needed to represent each key
p38896
as(dp38897
g16
V100297
p38898
stp38899
a((dp38900
g2
(lp38901
VUse  with :
p38902
aVThe  method specifically is helpful here; it returns the top counts for a given set of counts, here collected per time bin
p38903
aVThe output format almost matches your example:
p38904
aVbecause  returns a list of tuples, not dictionaries
p38905
as(dp38906
g16
V100297
p38907
stp38908
a((dp38909
g2
(lp38910
VUse either  or the  module to write your data
p38911
aVUsing  creates a comma-separated string to write to the file, but since this is really CSV data, the  module is perhaps better suited
p38912
aVwhere  is then a list containing other lists or tuples; for example:
p38913
as(dp38914
g16
V100297
p38915
stp38916
a((dp38917
g2
(lp38918
VDecorators are nothing more that callables applied automatically
p38919
aVTo apply it manually, replace the class with the return value of the decorator:
p38920
aVThis replaces the  name with the return value of , which we passed the original  class
p38921
as(dp38922
g16
V100297
p38923
stp38924
a((dp38925
g2
(lp38926
VCollections are built on top of the Plone ZCatalog indexing tool
p38927
aVThey basically represent canned queries
p38928
aVAs such, they are also limited by what the catalog can do
p38929
aVThe Plone catalog only can do  searches
p38930
aVIt's Title index is already a full-text search index, with stemming and case-insensitive matching, but there is no index type that supports regular expression searches
p38931
aVThere is an  add-on that at least supports  queries too, but you'd have to create a custom sub-class of Collections to be able to use that tool
p38932
as(dp38933
g16
V100297
p38934
stp38935
a((dp38936
g2
(lp38937
VThere are two problems with your  method:
p38938
aVYou swapped the  and  arguments when you call it recursively
p38939
aVThis causes your code to try to look up  on the integer value instead of the node
p38940
aVYou forgot to return the recursive call results
p38941
aVCorrected methods:
p38942
aVYour next problem is your  method; you try to call a global  function in it; that should probably be  instead
p38943
aVHowever, that method has no return value, so you end up setting  or  to
p38944
aVYou want to just hand over the search for the insertion point to a recursive call, no need to use a return value:
p38945
aVWith these changes, your simple test prints:
p38946
as(dp38947
g16
V100297
p38948
stp38949
a((dp38950
g2
(lp38951
VStick to BeautitfulSoup alone; regular expressions are not the tool for HTML parsing:
p38952
as(dp38953
g16
V100297
p38954
stp38955
a((dp38956
g2
(lp38957
VYou format each float value in the tuple:
p38958
aVI used the  function here to achieve the same formatting for individual floating point values
p38959
aVOutput:
p38960
aVAdjust the join string as needed
p38961
as(dp38962
g16
V100297
p38963
stp38964
a((dp38965
g2
(lp38966
V is the C-extension that implements most of the  module functionality
p38967
aVC-extensions usually do not have a  attribute
p38968
aVAs such you are looking for the  source file instead
p38969
as(dp38970
g16
V100297
p38971
stp38972
a((dp38973
g2
(lp38974
VFirst of all, there is no need for all the list comprehensions; yours do nothing but copy the results, you can safely do without them
p38975
aVThere is no next sibling in your column (there is only one  tag), so it returns
p38976
aVYou wanted to get the  attribute from the title (the  tag) instead:
p38977
aVwhich prints:
p38978
aVfor your example
p38979
as(dp38980
g16
V100297
p38981
stp38982
a((dp38983
g2
(lp38984
VSave it as JSON perhaps:
p38985
aVI set the  indentation to make the file reasonably readable
p38986
aVLoad with:
p38987
aVWith  set to , your structure would be written out as:
p38988
as(dp38989
g16
V100297
p38990
stp38991
a((dp38992
g2
(lp38993
VAt a guess, your OS is limiting per-process memory size
p38994
aVIn a bash shell, check  to see if a virtual memory limit is set
p38995
aVSee  for the full list of options for that command
p38996
aVSee Limit memory usage for a single Linux process for more information on how to use
p38997
as(dp38998
g16
V100297
p38999
stp39000
a((dp39001
g2
(lp39002
VFrom the SQLAlchemy 0
p39003
aV7 What's New document:
p39004
aVSQLite - the SQLite dialect now uses  for file-based databases
p39005
aVThis change is 99
p39006
aV999% backwards compatible, unless you are using temporary tables across connection pool connections
p39007
aVA file-based SQLite connection is blazingly fast, and using  means that each call to  creates a new pysqlite connection
p39008
aVPreviously, the  was used, which meant that all connections to a certain engine in a thread would be the same connection
p39009
aVIt\u2019s intended that the new approach is more intuitive, particularly when multiple connections are used
p39010
aVis still the default engine when a  database is used
p39011
aVNote that this change breaks temporary tables used across Session commits, due to the way SQLite handles temp tables
p39012
aVSee the note at http://www
p39013
aVsqlalchemy
p39014
aVorg/docs/dialects/sqlite
p39015
aVhtml#using-temporary-tables-with-sqlite if temporary tables beyond the scope of one pool connection are desired
p39016
aV#1921
p39017
aVMajor SQLAlchemy releases (so between 0
p39018
aV5 and 0
p39019
aV6 or 0
p39020
aV6 to 0
p39021
aV7) so far have always included backwards incompatible changes as major ideas are being worked out
p39022
ag2391
aV7 is no exception, see the Backwards Incompatible API Changes section
p39023
aVYou can still provide a different pool class if you have to, by passing a  keyword in with the  call:
p39024
aVPassing in an explicit pool class also works on 0
p39025
ag5279
aVPersonally, I'd use exception handling here:
p39026
as(dp39027
g16
V100297
p39028
stp39029
a((dp39030
g2
(lp39031
VYou are not capturing the changed  variable after calling
p39032
aVreturns the new string; strings are immutable so  cannot change  in-place
p39033
aVNext, you are using raw strings to define double slashes, but you wanted to replace single slashes
p39034
aVRemove the  from  and ; you cannot use a single slash as the last character in a raw string literal anyway
p39035
aVI think you wanted to do this instead:
p39036
as(dp39037
g16
V100297
p39038
stp39039
a((dp39040
g2
(lp39041
VZip the items, and use  to default the values to s:
p39042
aVI used  to make looping over both sets of key-value pairs easier; this works in both Python 2 and 3
p39043
aVIf this is Python 2 only code, you could use  to concatenate the two lists
p39044
aVOutput with  and converting back to a regular  to make printing easier:
p39045
aVThis does not create empty lists for the second set; if you have to have empty lists, you are limited to building two separate dictionaries then merging those:
p39046
aVfor Python 2, for Python 3 use  instead of , to produce:
p39047
aVSpecifically, for your code, you confused  (the index into ) with :
p39048
aVFor ,  is , but  does not exist
p39049
aVYour code also tried to append the lists from  and , which would not result in the correct output
p39050
aVAltering your version a little to work, using a separate loop for the / lists:
p39051
as(dp39052
g16
V100297
p39053
stp39054
a((dp39055
g2
(lp39056
VI'll assume that when a line starts with a number, we have an investment, otherwise a name
p39057
aVEach time you find a name, write out the previous name and the highest investment identifier:
p39058
aVFor your example input, this writes:
p39059
as(dp39060
g16
V100297
p39061
stp39062
a((dp39063
g2
(lp39064
VThe  method has a  keyword that lets you specify a method to convert unknown items to JSON
p39065
aVMake use of that:
p39066
aVthen use that for creating JSON:
p39067
aVResult:
p39068
as(dp39069
g16
V100297
p39070
stp39071
a((dp39072
g2
(lp39073
VPython 2 does attempt to provide an ordering (it does so for all types), first based on length (shorted dicts first), if the lengths are equale then by keys (a smaller key goes first), then if all keys are equal then on values (smaller values go first); see the  and  functions in the  source code
p39074
aVShort demo:
p39075
aVIn Python 3, it doesn't sort them at all; sorting dicts really makes no sense:
p39076
aVSee the Ordering Comparisons section of the What's New in Python 3 document
p39077
as(dp39078
g16
V100297
p39079
stp39080
a((dp39081
g2
(lp39082
VYou named your script , located at
p39083
aVThis is being imported instead of the standard library module, because the directory of the main script is the first place Python looks for imports
p39084
aVYou cannot give your scripts the same name as a module you are trying to import
p39085
aVRename your script
p39086
aVMake sure you also delete the bytecode cache at
p39087
as(dp39088
g16
V100297
p39089
stp39090
a((dp39091
g2
(lp39092
VYou forgot to pass in  to :
p39093
aVYou should really use  throughout your overrides:
p39094
as(dp39095
g16
V100297
p39096
stp39097
a((dp39098
g2
(lp39099
VUse iterators, and chaining:
p39100
aVOutput:
p39101
aVThis works with empty lists too, since  will simply skip over those
p39102
as(dp39103
g16
V100297
p39104
stp39105
a((dp39106
g2
(lp39107
VConcatenate them:
p39108
aVInsertion in front of the list would alter the list itself, and requires looping over the whole list twice (once for insertion, moving the rest of the list up 1 step, once for creating the tuple)
p39109
as(dp39110
g16
V100297
p39111
stp39112
a((dp39113
g2
(lp39114
VYou have CSV data, use the  module to read them
p39115
aVRead  into memory first, into a dictionary keyed on the first two columns:
p39116
as(dp39117
g16
V100297
p39118
stp39119
a((dp39120
g2
(lp39121
VSimple, the  method uses C float libraries, while the  power operator uses integer maths
p39122
aVThe two methods have different limitations
p39123
aVPython  size is only limited by how much memory your OS will let Python have, float numbers are limited by your computer architecture, see
p39124
as(dp39125
g16
V100297
p39126
stp39127
a((dp39128
g2
(lp39129
VCall  on the dictionary
p39130
aVIn Python 3, that'll return a dict view, so call  on that
p39131
aVPython 2:
p39132
aVPython 3:
p39133
as(dp39134
g16
V100297
p39135
stp39136
a((dp39137
g2
(lp39138
VMethod objects are created each time you access them
p39139
aVFunctions act as descriptors, returning a method object when their  method is called:
p39140
aVUse  equality testing instead
p39141
aVTwo methods are equal if their  and  attributes are identical
p39142
aVIf you need to test that the methods represent the same underlying function, test their  attributes:
p39143
as(dp39144
g16
V100297
p39145
stp39146
a((dp39147
g2
(lp39148
VYou need to truncate your file before writing to it again:
p39149
as(dp39150
g16
V100297
p39151
stp39152
a((dp39153
g2
(lp39154
VIt is the same data
p39155
aVPython lets you specify a literal string using different methods, one of which is to use escape codes to represent bytes
p39156
aVAs such,  is the same character value as
p39157
aVPython just chooses to show printable ASCII characters as printable ASCII characters instead of the escape code, just because that makes working with bytestrings that much easier
p39158
aVIf you need the literal slash,  character and the two digit  and  characters (so a string of length 4), you need to double the slash or use raw strings
p39159
aVTo illustrate:
p39160
as(dp39161
g16
V100297
p39162
stp39163
a((dp39164
g2
(lp39165
VYou are looping over elements that are not direct children of the root
p39166
aVYou'll need to get a reference to the direct parent instead
p39167
aVWith ElementTree that is not that easy, there are no parent pointers on the elements
p39168
aVYou'll need to loop over  first, then over :
p39169
aVI added an extra loop that finds all  elements that have at least one  element contained in them
p39170
aVIf you were to use  instead, then you could just use
p39171
as(dp39172
g16
V100297
p39173
stp39174
a((dp39175
g2
(lp39176
VSure, decorators are just callables
p39177
aVDecorator notation is just syntactic sugar, your example translates to:
p39178
aVso your  callable needs to return something that can be called; that 'something' will be passed in
p39179
aVWhatever you do in  and in the 'something' it returned is up to you
p39180
aVSomething like the following would work:
p39181
aVThis just adds  to the registry for a given eventname and returns the function unchanged
p39182
aVLater on, when you then need to handle the event, you just look up the event handlers for that event with:
p39183
as(dp39184
g16
V100297
p39185
stp39186
a((dp39187
g2
(lp39188
VYes, use :
p39189
aVHowever, I'd just have the method assume it is passed an iterable, it's the responsibility of the caller to ensure the correct type is passed in
p39190
aVThe  module is new in Python 3
p39191
aV3; its contents formerly lived in the  module instead, albeit that the names are still available in the old location even in Python 3
p39192
aV3 and up
p39193
as(dp39194
g16
V100297
p39195
stp39196
a((dp39197
g2
(lp39198
V doesn't just magically appear; Python functions are wrapped in methods when accessed via an instance (through invoking the function as a descriptor), and  is then passed in to the function as a first argument
p39199
aVFor your lambdas, you'll need to pass  in explicitly:
p39200
as(dp39201
g16
V100297
p39202
stp39203
a((dp39204
g2
(lp39205
VYou cannot
p39206
aVInstances only inherit the parent class methods and attributes, not instance attributes
p39207
aVYou should not confuse the two
p39208
aVis an instance attribute of a  instance
p39209
aVThe  instances would have their own copies of the  attribute
p39210
aVYou normally would code the  constructor to take two arguments:
p39211
aVAn alternative approach would be for  to hold a reference to a  instance:
p39212
aVwhere  no longer inherits from
p39213
aVUse it like:
p39214
as(dp39215
g16
V100297
p39216
stp39217
a((dp39218
g2
(lp39219
VJust put them in a list:
p39220
aVN-dimensional lists in Python are simply nested lists
p39221
aVResult:
p39222
aVYou then access items by row and column with two indexing operations:
p39223
as(dp39224
g16
V100297
p39225
stp39226
a((dp39227
g2
(lp39228
VUse  and it's  method:
p39229
aVIf you have to implement the  code yourself, at least reference the  source, which uses
p39230
aVTo get the most common values, you can build on top of this:
p39231
aVFor your example:
p39232
as(dp39233
g16
V100297
p39234
stp39235
a((dp39236
g2
(lp39237
VA string is a sequence, so just turn it into a list:
p39238
aVDemo:
p39239
as(dp39240
g16
V100297
p39241
stp39242
a((dp39243
g2
(lp39244
VYou have too many parenthesis on the preceding line, you probably wanted one on the end too:
p39245
aVI had to break the line across multiple lines to illustrate the problem, you may want to do the same to keep your code readable at least
p39246
aVBecause Python allows you to break the expression across multiple lines when using parenthesis, Python cannot detect when you forgot a closing parenthesis until the next line of code
p39247
aVThe same applies to square brackets (), and curly braces ()
p39248
aVThe rule of thumb therefor is to look at the preceding line too, when you encounter a syntax error
p39249
as(dp39250
g16
V100297
p39251
stp39252
a((dp39253
g2
(lp39254
V has to encode the unicode value to produce a Pyton byte string, it'll do so with the default encoding ()
p39255
aVYou must have set the latter to  explicitly, because by default that is set to
p39256
aVWhat you see is the UTF-8 encoding for the Unicode value your model returned
p39257
aVIf you want your test to pass, you'd have to decode that value to match the Unicode value you are comparing it with, or encode the other value:
p39258
aVor
p39259
aVShort demo:
p39260
aVYou may want to read up on Python and Unicode:
p39261
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p39262
aVby Joel Spolsky
p39263
aVThe Python Unicode HOWTO
p39264
aVPragmatic Unicode by Ned Batchelder
p39265
as(dp39266
g16
V100297
p39267
stp39268
a((dp39269
g2
(lp39270
VList comprehensions are much easier here:
p39271
aVNote that we can pass the string to  directly
p39272
aVA lambda is nothing more than a function with a single expression, which can be defined as an expression itself; here I assign the lambda result to a variable first:
p39273
as(dp39274
g16
V100297
p39275
stp39276
a((dp39277
g2
(lp39278
V is only used when you use the file as an iterator:
p39279
aVIt is a separate buffer from the normal buffer argument, which is handled by the  C API calls
p39280
aVBoth are used when iterating
p39281
aVFrom :
p39282
aVIn order to make a  loop the most efficient way of looping over the lines of a file (a very common operation), the  method uses a hidden read-ahead buffer
p39283
aVAs a consequence of using a read-ahead buffer, combining  with other file methods (like ) does not work right
p39284
aVHowever, using  to reposition the file to an absolute position will flush the read-ahead buffer
p39285
aVThe OS buffer size is not changed, the  is done when the file is opened and not touched by the file iteration code
p39286
aVInstead, calls to  (which uses ) are used to fill the read-ahead buffer, creating a second buffer internal to Python
p39287
aVPython otherwise leaves the regular buffering up to the C API calls ( calls are buffered; the userspace buffer is consulted by  to satisfy the request, Python doesn't have to do anything about that)
p39288
aVthen serves lines (newline terminated) from this buffer
p39289
aVIf the buffer no longer contains newlines, it'll refill the buffer by recursing over itself with a buffer size 1
p39290
aV25 times the previous value
p39291
aVThis means that file iteration can read the whole rest of the file into the memory buffer if there are no more newline characters in the whole file
p39292
aVTo see how much the buffer reads, print the file position (using ) while looping:
p39293
aVetc
p39294
aVWhat bytes are actually read from the disk (provided  is an actual physical file on your disk) depend not only on the interplay between the  buffer and the internal read-ahead buffer; but also if the OS itself is using buffering
p39295
aVIt could well be that even if the file buffer is exhausted, the OS serves the system call to read from the file from it's own cache instead of going to the physical disk
p39296
as(dp39297
g16
V100297
p39298
stp39299
a((dp39300
g2
(lp39301
VSimply delete the attribute from the  mapping; assuming you have a reference to the  tag in a local variable :
p39302
aVDemo:
p39303
as(dp39304
g16
V100297
p39305
stp39306
a((dp39307
g2
(lp39308
VYou only set a new value for  if  is equal to 0 or larger than 9
p39309
aVIf  is equal to 1-9, then  remains the old value, and you reprint that
p39310
aVChange your  test:
p39311
as(dp39312
g16
V100297
p39313
stp39314
a((dp39315
g2
(lp39316
VFor just 2 waypoints, just use  statements:
p39317
as(dp39318
g16
V100297
p39319
stp39320
a((dp39321
g2
(lp39322
VYou need to import modules where they are used
p39323
aVIf your  module uses the  module, you need to import it there, not in your handler module
p39324
aVImporting things creates a reference to that 'thing' in your module namespace, so that the code there can find it when using it
p39325
aVis the local name by which you get to use the object defined in
p39326
aVIf your handler uses the same object, it needs to import that still
p39327
aVIf by importing  all names used by  suddenly where available in your handler module too, you'd end up with name conflicts and hard-to-debug errors all over the place
p39328
aVVice versa, if only importing  in your handler module and not in your  module were to work, you'd need to import all the dependencies of given module together with the module itself
p39329
aVThis quickly becomes unworkable, as you'd need to document all the things your  module requires just to be able to use it
p39330
as(dp39331
g16
V100297
p39332
stp39333
a((dp39334
g2
(lp39335
VSQLAlchemy has an excellent declarative layer itself
p39336
aVElixir has been obsoleted for some time now
p39337
aVAs a result, Elixir has not seen any development for over 2 years, the project has been abandoned
p39338
aVThe point to abandon Elixir is Right Now
p39339
as(dp39340
g16
V100297
p39341
stp39342
a((dp39343
g2
(lp39344
VYou are using , which is not a function provided by the  module
p39345
aVPerhaps you wanted to use  or  instead
p39346
aVOr you could just use  and get an actual floating point value for the  and  columns:
p39347
as(dp39348
g16
V100297
p39349
stp39350
a((dp39351
g2
(lp39352
VYou'd need a regular expression to get numbers out of text like that:
p39353
aVThe pattern matches a digit followed by 0 or more further digits or spaces
p39354
aVDemo:
p39355
aVIf you need all such numbers in the input text, use  and a generator:
p39356
aVDemo:
p39357
as(dp39358
g16
V100297
p39359
stp39360
a((dp39361
g2
(lp39362
VYou want to use  to test for matches anywhere in the input string
p39363
aVTo match (recent) years a little more precisely, you could use:
p39364
aVwhich would match anything from 1000 through to 2999
p39365
as(dp39366
g16
V100297
p39367
stp39368
a((dp39369
g2
(lp39370
VYour triple-quoted string has one  quote too many:
p39371
as(dp39372
g16
V100297
p39373
stp39374
a((dp39375
g2
(lp39376
VYou have two problems with your code:
p39377
aVYou never call the  method, you only refer to it
p39378
aVAdd :
p39379
aVYour  function doesn't take  as an argument
p39380
aVIf  is meant to be a global, then it won't be visible to the  module (globals are only visible in the current module)
p39381
aVAdd  as a parameter and pass it in when calling
p39382
aVIn :
p39383
aVand in :
p39384
as(dp39385
g16
V100297
p39386
stp39387
a((dp39388
g2
(lp39389
VYou cannot
p39390
aVis a local variable of the  function, and an such not available outside of that function
p39391
aVThe variable is not used at all even; it could be removed from the function and nothing would change
p39392
aVThe  method is intended to set attributes on the newly created instance, but your  class seems to want to find the attributes on the  class instead
p39393
aVYou cannot do that either, as those attributes you want to access are only set in
p39394
aVYou can only find  on instances of , not on the  class itself
p39395
aVPerhaps you wanted to initialize the parent class first, and actually store  on :
p39396
aVNow  has the  and  attributes defined and your  function can access those there
p39397
as(dp39398
g16
V100297
p39399
stp39400
a((dp39401
g2
(lp39402
Vsplit the string using :
p39403
aVstill split the string using :
p39404
aVAlternatively, you could use the  method:
p39405
aVPartition always only splits once, but returns the character you split on as well
p39406
aVIf you need to read a specific line in a file, skip lines first by iterating over the file object
p39407
aVThe  function is the most compact way to return that line; don't worry too much if you don't understand how that all works
p39408
aVIf the file doesn't have that many lines, an empty string is returned instead:
p39409
aVTo read the 3rd line from a file:
p39410
aVIf instead you need to know what the line number is of a given piece of text, you'd need to use the  to keep track of the line count so far:
p39411
aVwhich would return the line number (starting to count from 0), or -1 if the line was not found in the file
p39412
as(dp39413
g16
V100297
p39414
stp39415
a((dp39416
g2
(lp39417
VYou need to import  using an absolute import
p39418
aVEither use:
p39419
aVor use:
p39420
aVPython 3 only supports absolute imports; the statement  only imports a top level module
p39421
as(dp39422
g16
V100297
p39423
stp39424
a((dp39425
g2
(lp39426
VIf you want to filter items by the contents of a variable, you need to use that variable directly:
p39427
aVYou were instead trying to filter by the string
p39428
aVYou made the same mistake when creating the  entry; you probably wanted to store result of the  expression, not the string :
p39429
aVNote that calling  retrieves all matching entries from the database, but you are only using it in a  test
p39430
aVIt would be more efficient (potentially much more so) to use  instead of  to let the database tell us how many items match:
p39431
as(dp39432
g16
V100297
p39433
stp39434
a((dp39435
g2
(lp39436
VYou can use  intersections:
p39437
aVIn Python 3, that'd be:
p39438
aVbecause  returns a dict view by default
p39439
aVDictionary view objects such as returned by  (and  in Python 3) act as sets and intersection testing is very efficient
p39440
aVDemo in Python 2
p39441
aV7:
p39442
aVNote that this tests True only if both keys are missing
p39443
aVIf you need your test to pass if either is missing, use:
p39444
aVwhich is False only if both keys are present:
p39445
aVFor a strict comparison (allowing only the two keys, no more, no less), just use a list:
p39446
as(dp39447
g16
V100297
p39448
stp39449
a((dp39450
g2
(lp39451
VYour  version is too old
p39452
aVThe  module was not introduced until version 0
p39453
ag5279
aVYou have version 0
p39454
aV3 instead, where it is still called
p39455
aVFrom the ChangeLog:
p39456
aVVersion 0
p39457
aV6:
p39458
ag15438
aVThe  module is renamed to , i
p39459
ag7233
aV,
p39460
aVshould now read
p39461
aVThe old name "" is still available as a synonym for , implying
p39462
aVthat old programs will work
p39463
aV(The "" name is misleading as only
p39464
aVa small portion of  is actually imported
p39465
aVYou may want to upgrade your  installation to 0
p39466
aV9, the most recent release
p39467
as(dp39468
g16
V100297
p39469
stp39470
a((dp39471
g2
(lp39472
VIn Python 3 you could do:
p39473
aVbut in Python 2 you need to split to one variable first, then assign to  and :
p39474
aVIf these need to be integers instead of strings, you need to map the values to  first:
p39475
aVor, Python 2 again:
p39476
aVPython 3 demo:
p39477
aVPython 2:
p39478
as(dp39479
g16
V100297
p39480
stp39481
a((dp39482
g2
(lp39483
V sets the  header, you'd need parse that header:
p39484
aVSee RFC 2617 (HTTP Authentication: Basic and Digest Access Authentication) for details on how a user agent interacts with a server through that header
p39485
as(dp39486
g16
V100297
p39487
stp39488
a((dp39489
g2
(lp39490
VYou could use  on :
p39491
aVThis still creates 3 lists, but is more compact
p39492
aVYou want to avoid creating loops for the individual  parameters, you'd end up with 4 loops instead
p39493
aVDemo for your  sample:
p39494
aVNote that the order of the values in ,  and  is not a given, because dictionaries do not preserve order
p39495
as(dp39496
g16
V100297
p39497
stp39498
a((dp39499
g2
(lp39500
VYou were looking for :
p39501
aVBut that won't work, because  returns a string
p39502
aVYou perhaps need exception handling instead:
p39503
aVFor your specific mistake,  might have worked as well, but that is not very pythonic
p39504
aVreturns the type of the  type, which is :
p39505
as(dp39506
g16
V100297
p39507
stp39508
a((dp39509
g2
(lp39510
VSince it is a mapping, there can be no identically named modules in
p39511
aVThat is the point
p39512
aVIf use the statement  and  exists, that module is returned
p39513
aVNo file access is needed, no top-level code for that module needs to be run
p39514
aVIf  is not present, then the  determines where  is going to be found first
p39515
aVThat value is a list, so it has order, and the search for the  module is conducted according to that ordering
p39516
as(dp39517
g16
V100297
p39518
stp39519
a((dp39520
g2
(lp39521
V is meant to run retrieval of several URLs in parallel, and will indeed wait for these tasks to complete () is called)
p39522
aVUse  instead to spawn jobs, using a  instance:
p39523
aVWithout the pool the  call will block still, but only for the  call it executes
p39524
as(dp39525
g16
V100297
p39526
stp39527
a((dp39528
g2
(lp39529
VPython doesn't support wildcards directly in filenames to the  call
p39530
aVYou'll need to use the  module instead to load files from a single level of subdirectories, or use  to walk an arbitrary directory structure
p39531
aVOpening all text files in all subdirectories, one level deep:
p39532
aVOpening all text files in an arbitrary nesting of directories:
p39533
as(dp39534
g16
V100297
p39535
stp39536
a((dp39537
g2
(lp39538
VYour code is already working; a  object is returned
p39539
aVTo get the total number of seconds instead, you need to call the  method on the resulting :
p39540
aVreturns a  value, including microseconds
p39541
aVNote that you need to use a timezone aware  object, since the Django  handles timezone aware  objects as well
p39542
aVSee Django Timezones documentation
p39543
aVDemonstration of  (with naive  objects, but the principles are the same):
p39544
aVBecause both objects are timezone aware (have a  attribute that is not ), calculations between them take care of timezones and subtracting one from the other will do the right thing when it comes to taking into account the timezones of either object
p39545
as(dp39546
g16
V100297
p39547
stp39548
a((dp39549
g2
(lp39550
VUse :
p39551
aVDemo:
p39552
as(dp39553
g16
V100297
p39554
stp39555
a((dp39556
g2
(lp39557
VAnywhere you are allowed to use the  term, you do not need to use parenthesis
p39558
aVThe  statement requires an , and does not support an
p39559
aVExamples of syntax that does allow :
p39560
aVThe  statement
p39561
aVexpressions
p39562
aVassignment
p39563
aV(including augmented assignment)
p39564
aVThe  statement
p39565
aVGrepping the Expressions, Simple and Compound statements documentation for  will tell you all locations that  is used in the Python grammar
p39566
as(dp39567
g16
V100297
p39568
stp39569
a((dp39570
g2
(lp39571
VYou'd be much better off using a decent HTML Parser
p39572
aVUse BeautifulSoup for example:
p39573
aVwhich finds all  elements with an  attribute
p39574
as(dp39575
g16
V100297
p39576
stp39577
a((dp39578
g2
(lp39579
VIn regular expression patterns, a backslash has meaning too, and needs to be explicitly escaped
p39580
aVAs such,  means: match one literal  character
p39581
aVIf you want to pass literal text to , you need to first escape any possible meta characters using  first
p39582
as(dp39583
g16
V100297
p39584
stp39585
a((dp39586
g2
(lp39587
VYou cannot do that with setuptools, installing inside another package is not supported
p39588
aVInstead, you want to use entry points instead
p39589
aVYour  should look for anything registered as an entry point for a specific key, and your  module should register itself for that key
p39590
aVYour extension registers an extension point:
p39591
aVwhich your  then can discover by asking :
p39592
aVTake a look at the Babel project as an example
p39593
aVBabel can extract translatable text from files; it knows how to do this for Python source code, but it also supports extensions that can extract such text from other formats
p39594
aVSuch extraction methods can be registered as extension points
p39595
aVBabel documents this in the  Writing Extraction Methods section
p39596
aVThe message extraction code then loads those entry points when extracting text:
p39597
aVThe Mako templating language supplies such a plugin; it registers the entry point, which points to the actual implementation:
p39598
as(dp39599
g16
V100297
p39600
stp39601
a((dp39602
g2
(lp39603
VNo, you should not attempt to write to the file you are currently reading from
p39604
aVYou can do it if you keep ing back after reading a row but it is not advisable, especially if you are writing back more data than you read
p39605
aVThe canonical method is to write to a new, temporary file and move that into place over the old file you read from
p39606
aVI've made use of the  and  libraries here to make the task easier
p39607
as(dp39608
g16
V100297
p39609
stp39610
a((dp39611
g2
(lp39612
VYour logic is flawed, use:
p39613
aVand:
p39614
aVThe expression  does not mean what you think it does; it is interpreted as  instead
p39615
aVIf  is indeed , then that expression evaluates to , but if  is  that becomes , returning , which is considered  in a boolean context
p39616
aVMoreover, you have strings in , but you were testing against  values instead
p39617
as(dp39618
g16
V100297
p39619
stp39620
a((dp39621
g2
(lp39622
VUse the file as an iterator, then use  to get every second line:
p39623
aVskips the first line (), then iterates over all lines () returning every second line ()
p39624
aVThis'll work with whatever filesize you throw at it; it won't need any more memory than required by the internal iterator buffer
p39625
aVOutput for your test file:
p39626
as(dp39627
g16
V100297
p39628
stp39629
a((dp39630
g2
(lp39631
VUse a list comprehension:
p39632
as(dp39633
g16
V100297
p39634
stp39635
a((dp39636
g2
(lp39637
VLeave out the  parameter and use a custom  instead:
p39638
aVDemo:
p39639
as(dp39640
g16
V100297
p39641
stp39642
a((dp39643
g2
(lp39644
VI'd use the following statement to count each nested dictionary's values:
p39645
aVThis builds a new dictionary from the same keys as  with each value being the number of seats available
p39646
aVThe  with generator trick efficiently counts all values of the contained per-row dictionary where the value equals
p39647
aVResult:
p39648
aVTo show available seats for a specific row you filter and just use :
p39649
aVFor  this prints:
p39650
aVbut it adjusts to form coherent sentences for more or fewer seats too
p39651
as(dp39652
g16
V100297
p39653
stp39654
a((dp39655
g2
(lp39656
VYou need to explicitly return :
p39657
aVThe  variable is not implicitly read
p39658
aVSee Print Statement Support in the Basic Scripting chapter of the Zope 2 book
p39659
as(dp39660
g16
V100297
p39661
stp39662
a((dp39663
g2
(lp39664
VYou want to create a capturing group for the punctuation, then refer to that group in the replacement expression:
p39665
aVYou don't need brackets around the ; it is already a character class
p39666
aVDemonstration:
p39667
as(dp39668
g16
V100297
p39669
stp39670
a((dp39671
g2
(lp39672
V returns strings and those would be concatenated instead of summed unless you convert them to numbers first (and would throw a  when trying to substract, multiply or divide them):
p39673
aVYou need to create integers from your values using :
p39674
aVThis will throw a  if either  or  does not contain anything that can be interpreted as an integer, so you may want to catch that:
p39675
as(dp39676
g16
V100297
p39677
stp39678
a((dp39679
g2
(lp39680
VYou need to provide custom ,  and  hooks
p39681
aVThere are passed a slice object when slicing the list; these have ,  and  attributes (which could be ):
p39682
aVor, for your case:
p39683
aVbecause a  can take the  object directly
p39684
aVIn Python 2,  is called for slices without a stride (so only start and stop indices) if implemented, and the built-in  type implements it so you'd have to override that too; a simple delegation to your  method should do fine:
p39685
as(dp39686
g16
V100297
p39687
stp39688
a((dp39689
g2
(lp39690
VNo, no size information is available in Python 2
p39691
aV5 or earlier
p39692
aVYou'd have to backport the (C code) patch from issue 2898
p39693
as(dp39694
g16
V100297
p39695
stp39696
a((dp39697
g2
(lp39698
VPage templates have to be valid XML, so you cannot just arbitrarily include tags willy nilly
p39699
aVTree structures are best handled recursively (perhaps with macro snippets):
p39700
aVThe Plone navigation portlet, for example, also uses a separate macro template for each level, calling into itself to render children ( is the same template)
p39701
aVFor your specific method using a  or  script, you need to mark the content value as  to prevent the automatic HTML escaping from taking place:
p39702
as(dp39703
g16
V100297
p39704
stp39705
a((dp39706
g2
(lp39707
VYou'd be much better off using a decent HTML Parser
p39708
aVUse BeautifulSoup which has extensive documentation - for example:
p39709
aVThis finds all  elements with the class , then prints their URL and link text
p39710
aVRegular expressions are usually not the tool for parsing HTML
p39711
as(dp39712
g16
V100297
p39713
stp39714
a((dp39715
g2
(lp39716
VUse  to list all files in a directory
p39717
aVThe function returns just the filenames, not the full path
p39718
aVThe  module gives you the tools to construct filenames as needed:
p39719
as(dp39720
g16
V100297
p39721
stp39722
a((dp39723
g2
(lp39724
VYou define the structure at a later time, in this case in the  method to ensure you have bound methods:
p39725
aVAlternatively, look up the methods by name:
p39726
aVYou can always alter the class after the class definition has completed:
p39727
aVbut that stores unbound methods forcing you to pass in  explicitly
p39728
aVLastly, you could move the definition of  to where the  and  functions have been defined:
p39729
aVThe class body is executed like a function would, with the local namespace turned into the class attributes
p39730
aVNow the  values are functions, with the same problem as unbound methods; you need to pass in  explicitly
p39731
aV(In Python 3 there are no unbound methods anymore and this solution and the previous are equivalent)
p39732
aVYou may want to avoid using  as the attribute name, as it can cause confusion with the built-in  type
p39733
as(dp39734
g16
V100297
p39735
stp39736
a((dp39737
g2
(lp39738
VYes, use a list comprehension:
p39739
aVFor scientific computing with Python, you may also want to look into NumPy and SciPy, specifically the NumPy for Matlab users documentation
p39740
as(dp39741
g16
V100297
p39742
stp39743
a((dp39744
g2
(lp39745
VIt is meant to go into a separate file, but you need to import the  module first:
p39746
aVbefore the module is available to your code
p39747
as(dp39748
g16
V100297
p39749
stp39750
a((dp39751
g2
(lp39752
VThe  call returned a  object, so the  method takes 3 arguments:
p39753
aVInserts the given  in the buffer at the specified
p39754
aVReturns the number of characters inserted: this may be different if tabs are being translated into spaces in the current buffer
p39755
aVSee the  API reference
p39756
aVThe  parameter is meant to be a  object; you need to call  to create one, then call  to demarque a undoable edit:
p39757
aVThe  object is a token to group edits into something that can be undone in one step
p39758
as(dp39759
g16
V100297
p39760
stp39761
a((dp39762
g2
(lp39763
V returns a tuple with one element
p39764
aVBy adding the comma to the assignment target list, you ask Python to unpack the return value and assign it to each variable named to the left in turn
p39765
aVMost often, you see this being applied for functions with more than one return value:
p39766
aVThe left-hand side can, however, contain any number of elements, and provided it is a tuple of variables the unpacking will take place
p39767
aVIn Python, it's the comma that makes something a tuple:
p39768
aVThe parenthesis are optional in most locations
p39769
aVYou could read the original code with parenthesis without changing the meaning:
p39770
aVOr, you could recast it to lines that do not use tuple unpacking:
p39771
aVor
p39772
aVFor the full details on how assignments work with respect to unpacking, see the Assignment Statements documentation
p39773
as(dp39774
g16
V100297
p39775
stp39776
a((dp39777
g2
(lp39778
VUnfortunately, the  and  methods (rightly) only support codecs that also convert between types;  must always return a  object, while  must return ; see the original issue that introduced these codecs:
p39779
aVCodecs can work with arbitrary types, it's just that the helper methods on unicode and bytes objects only support one combination of types in Python 3
p39780
ag1205
aVSo the specific error you see is caused by the fact that the  method always expects to return a value of type
p39781
aVSimilarly, the  method balks at codecs that do not return  as a return value:
p39782
aVAs such, for bytes-to-bytes and str-to-str codecs, you need to use the  module directly:
p39783
as(dp39784
g16
V100297
p39785
stp39786
a((dp39787
g2
(lp39788
VYou'd have to handle that in a custom view
p39789
aVThere is no pre-existing code to handle that
p39790
aVFor simple cases, just read the uploaded file with the  module and use the rows to create items in the  container:
p39791
aVFor more complex operations, you could build a  pipeline with the  to convert CSV-data to dexterity objects, but that is probably overkill here
p39792
as(dp39793
g16
V100297
p39794
stp39795
a((dp39796
g2
(lp39797
VYou are getting close, but you need to apply the  function to each tuple in the output of the  grouper sequence:
p39798
aVSince you now have a sequence of  results, I used  to merge the output of each of those into a final sequence
p39799
aVThis produces the desired output:
p39800
as(dp39801
g16
V100297
p39802
stp39803
a((dp39804
g2
(lp39805
VYou'd have to collect per-name, per-field lists
p39806
aVUsing  with a factory to create nested lists:
p39807
aVDumping your example input data into one timechunk gives me:
p39808
aVPerhaps you should consider using a different data structure instead of all these lists, or use something like pandas to help you analyze the data more efficiently
p39809
as(dp39810
g16
V100297
p39811
stp39812
a((dp39813
g2
(lp39814
VThe  syntax was only fully enabled in Python 2
p39815
ag5279
aVYou must be using Python 2
p39816
aV5 or earlier:
p39817
aVUse  in Python 2
p39818
aV5 to enable the syntax there:
p39819
aVFrom the  statement specification:
p39820
aVNew in version 2
p39821
ag2176
ag15438
aVNote: In Python 2
p39822
aV5, the  statement is only allowed when the  feature has been enabled
p39823
aVIt is always enabled in Python 2
p39824
ag5279
aVThe point of using a file as a context manager is that it'll be closed automatically, so your  call is redundant
p39825
aVFor Python 2
p39826
aV4 or earlier you are out of luck, I'm afraid
p39827
aVYou'd have to use a -  statements instead:
p39828
as(dp39829
g16
V100297
p39830
stp39831
a((dp39832
g2
(lp39833
VYour diagnosis is incorrect
p39834
aVThe last statement will match if  is equal to either  or :
p39835
aVHowever, if  is greater than  your first  matches, but your comparison to  is flawed:
p39836
aVand nothing is ever printed
p39837
aVYou need to clean up the logic for that case
p39838
aVSince you only have 3 different outcomes; winning, losing and hitting the post, you can really simplify the whole thing down to:
p39839
aVNote that I used chained comparisons to simplify the first  expression some more
p39840
aVYou also made sure that  is lower than , so testing for  is always going to be
p39841
aVAnother note:  should be transitive, so  is redundant
p39842
aVYou can simplify that to just
p39843
aVSimplifying your whole program:
p39844
as(dp39845
g16
V100297
p39846
stp39847
a((dp39848
g2
(lp39849
VPut everything in a dict:
p39850
aVResult:
p39851
aVNote that both JSON object and Python dicts do not have a specific ordering
p39852
as(dp39853
g16
V100297
p39854
stp39855
a((dp39856
g2
(lp39857
VNope, I don't see why that would be bad form
p39858
aVCalculating those values only once when the instance is created can be a great idea, in fact
p39859
aVYou could also postpone the calculations until needed by using caching s:
p39860
aVNow, accessing  will trigger calculation of  as needed, as well as cache the result of it's own calculation
p39861
aVIn this specific case, you may want to make  a property as well; one with a setter that clears the cached values:
p39862
aVBecause -based caching does add some complexity overhead, you need to consider if it is really worth your while; for your specific, simple example, it probably is not
p39863
aVThe calculation cost for your attributes is very low indeed, and unless you plan to create large quantities of these classes, the overhead of calculating the properties ahead of time is negligible, compared to the mental cost of having to maintain on-demand caching properties
p39864
as(dp39865
g16
V100297
p39866
stp39867
a((dp39868
g2
(lp39869
VYou need to find the minimum value per row, and only then can you determine what the coordinates are for the row with the minimum column:
p39870
aVThis code uses  to annotate each value with the column index, finds the minimum per row, annotates each row minimum with the row number (again with ) and finds the minimum row
p39871
aVThe result is a nested tuple with , which we unpack to return the row and column indices
p39872
aVDemo:
p39873
aVSo position  is a minimum value in the matrix
p39874
aVIf you wanted to include the exact value of that position as well, return:
p39875
as(dp39876
g16
V100297
p39877
stp39878
a((dp39879
g2
(lp39880
VUse the  function, it's easier (no need for the template placeholder parts, only the formatter string is needed):
p39881
aVbut you ran into a simplification in Python 2
p39882
aV7, where you don't have to specify the positional parameter
p39883
aVThe 2
p39884
aV6 equivalent is:
p39885
as(dp39886
g16
V100297
p39887
stp39888
a((dp39889
g2
(lp39890
VYour problem is that you want all text that follows a given tag in your
p39891
aVYou want to use  in a loop here:
p39892
aVis a generator that simply produces the chain of  attributes, including  elements
p39893
aVresults in:
p39894
aVHow you handle whitespace here can be a little tricky; stripping afterwards works best for this specific example, but for others, using  and  may work as well
p39895
as(dp39896
g16
V100297
p39897
stp39898
a((dp39899
g2
(lp39900
VIn Python 2, where the module is still available as a Python-only, the  module has a semi-private list:
p39901
aVwhich holds all registered exit handlers
p39902
aVIn Python 3, the module has been re-coded in C and the list is no longer accesible, so for Python 3 you are flat out of luck, I am afraid
p39903
aVYou'd have to port the Python 2 pure-python version to Python 3, and ensure that it is used instead of the C version to make the list accessible again
p39904
as(dp39905
g16
V100297
p39906
stp39907
a((dp39908
g2
(lp39909
VAssignment is never chained
p39910
aVAssignment first evaluates the right-hand expression, then assigns the result to the left-hand targets, one by one, from left to right
p39911
aVSee the assigment statement documentation:
p39912
aVAn assignment statement evaluates the expression list (remember that this can be a single expression or a comma-separated list, the latter yielding a tuple) and assigns the single resulting object to each of the target lists, from left to right
p39913
aVSo your code:
p39914
aVeffectively means:
p39915
aVYou could use this instead, simply reversing the assignment order:
p39916
aVwhich assigns in the correct order:
p39917
aVThis results in the correct behaviour for a linked list:
p39918
as(dp39919
g16
V100297
p39920
stp39921
a((dp39922
g2
(lp39923
VYou are missing the code required to reconstruct the pickled objects
p39924
aVPickles store the location where the class can be imported from, together with the instance attributes
p39925
aVThe original module is still required to recreate the module
p39926
aVFrom the documentation:
p39927
aVNote that functions (built-in and user-defined) are pickled by \u201cfully qualified\u201d name reference, not by value
p39928
aVThis means that only the function name is pickled, along with the name of the module the function is defined in
p39929
aVNeither the function\u2019s code, nor any of its function attributes are pickled
p39930
aVThus the defining module must be importable in the unpickling environment, and the module must contain the named object, otherwise an exception will be raised
p39931
aV[4]
p39932
aVSimilarly, classes are pickled by named reference, so the same restrictions in the unpickling environment apply
p39933
aVNote that none of the class\u2019s code or data is pickled, so in the following example the class attribute  is not restored in the unpickling environment:
p39934
aVThese restrictions are why picklable functions and classes must be defined in the top level of a module
p39935
aVIn other words, the original data used to create the pickle includes at least one instance of a custom class that originates in a module named
p39936
aVDo be careful reading arbitrary pickles, even from friends
p39937
aVA pickle is just a stack language that recreates arbitrary Python structures
p39938
aVYou can construct a pickle that spawns a secret back-door server on your computer, with enough determination and skill
p39939
aVThe  documention warns you explicitly:
p39940
aVWarning: The  module is not intended to be secure against erroneous or maliciously constructed data
p39941
aVNever unpickle data received from an untrusted or unauthenticated source
p39942
aVThis has been a problem in the past, even for experienced developers
p39943
as(dp39944
g16
V100297
p39945
stp39946
a((dp39947
g2
(lp39948
V includes a Sphinx directive for a  directive; see their sample doc for Sphinx and the documenting  chapter
p39949
as(dp39950
g16
V100297
p39951
stp39952
a((dp39953
g2
(lp39954
VUse the  function:
p39955
aVDemo:
p39956
as(dp39957
g16
V100297
p39958
stp39959
a((dp39960
g2
(lp39961
VYou'd need to use regular expressions, and add  word boundary anchors around each word when matching:
p39962
aVThe  boundary anchor matches at string start and end points, and anywhere there is a transition between word and non-word characters (so between a space and a letter or digit, or between punctuation and a letter or digit)
p39963
aVThe  function ensures that all regular expression metacharacters are escaped and we match on the literal contents of  and not accidentally interpret anything in there as an expression
p39964
aVDemo:
p39965
aVBy using a regular expression, you now can match case-insensitively as well:
p39966
aVIn this demo both  and  qualify even though the case in the sentence differs:
p39967
as(dp39968
g16
V100297
p39969
stp39970
a((dp39971
g2
(lp39972
VYou need to have a  instance for that to work
p39973
aVUse  to parse your string into such an object:
p39974
as(dp39975
g16
V100297
p39976
stp39977
a((dp39978
g2
(lp39979
V is simply a python script
p39980
aVYou can create dynamic dependencies in that script:
p39981
as(dp39982
g16
V100297
p39983
stp39984
a((dp39985
g2
(lp39986
VThe  call returns  for some cases
p39987
aVInside  you have the following code:
p39988
aVIf  returns an empty list or if none of the  values matches your  statement the function returns  and you'll see your exception
p39989
as(dp39990
g16
V100297
p39991
stp39992
a((dp39993
g2
(lp39994
VThe  type is defined in C, and its  slot deliberately does not include the  flag
p39995
aVC types need to mark themselves explicitly as subclassable
p39996
aVTo do this for custom Python classes, use a metaclass:
p39997
aVgives:
p39998
as(dp39999
g16
V100297
p40000
stp40001
a((dp40002
g2
(lp40003
VYou do not need to call ; use the file object directly:
p40004
aVYou are trying to read the output of  as a CSV file instead, and that's a string of the form:
p40005
aVYou can see that from your error output; it is spelling out , , etc
p40006
aVall the way through to the memory address digits and the closing
p40007
aVNote that the  codec can handle a UTF-8-encoded BOM to be present at the start of the file, but unless that BOM is expected to be there, the normal  codec will do just fine
p40008
as(dp40009
g16
V100297
p40010
stp40011
a((dp40012
g2
(lp40013
VTo calculate the average for multiple keys, you'd need to collect all values first, then calculate the averages afterwards
p40014
aVUse  to make collecting values easy:
p40015
aVFirst  is a dictionary mapping keys to lists of values
p40016
aVThe dict comprehension then replaces that with a dictionary mapping keys to the averages
p40017
as(dp40018
g16
V100297
p40019
stp40020
a((dp40021
g2
(lp40022
VThose are Unicode codepoints already
p40023
aVThey represent Chinese characters, but using escape codes that are easier on the developer:
p40024
aVYou do not have to do anything to convert those; the  escape form is simply another way to express the same codepoint
p40025
aVSee String Literals:
p40026
aVCharacter with 16-bit hex value xxxx (Unicode only)
p40027
aVCharacter with 32-bit hex value xxxxxxxx (Unicode only)
p40028
aVPython interprets those escape codes when reading the source code to construct the unicode value
p40029
aVIf the source of the data is not from Python source code but from the web, you have JSON data instead, which uses the same escape format:
p40030
aVNote that the value then needs to be part of a larger string, one that at least includes quotes to mark this a string
p40031
as(dp40032
g16
V100297
p40033
stp40034
a((dp40035
g2
(lp40036
VReally, an XML parser is the way to go for such a small task
p40037
aVUse the ElementTree API:
p40038
aVThere, that wasn't so bad, was it
p40039
as(dp40040
g16
V100297
p40041
stp40042
a((dp40043
g2
(lp40044
VThe  special method was only introduced in Python 3
p40045
aVThere is no support for the special method in Python 2
p40046
aVYou'll have to use a dedicated method instead of the function:
p40047
aVor you'd have to provide your own  function:
p40048
aVYou could even monkey-patch this into the  namespace:
p40049
as(dp40050
g16
V100297
p40051
stp40052
a((dp40053
g2
(lp40054
VSet a  or  environment key with , optionally with  too:
p40055
aVOn Windows the  key in the  registry is consulted as well, you probably have  registered as exception
p40056
aVCheck your proxy settings to verify this
p40057
as(dp40058
g16
V100297
p40059
stp40060
a((dp40061
g2
(lp40062
VYou are trying to set a new attribute on your  instance:
p40063
aVSince there is no  attribute yet, that triggers a , which tries to access the non-existent  attribute, so  is consulted
p40064
aVWhich tries to access
p40065
aVThe solution is to set  directly in :
p40066
aVAlternatively, use the original baseclass  just for the  attribute:
p40067
as(dp40068
g16
V100297
p40069
stp40070
a((dp40071
g2
(lp40072
VYou are trying to slice a string here:
p40073
aVand  refers to a string value
p40074
aVPerhaps you forgot a comma
p40075
as(dp40076
g16
V100297
p40077
stp40078
a((dp40079
g2
(lp40080
VYou need to create a nested function; the  function should return the actual decorator function:
p40081
aVThe  syntax is nothing more than syntactic sugar, the following setup:
p40082
aVis translated to:
p40083
aVinstead
p40084
aVBut the  part can itself be an expression too; that is how you are trying to use it
p40085
aVSo when you use  as a decorator, you really do this:
p40086
aVNote the double function call there
p40087
aVThis is why my version of  returns a nested function
p40088
aVThis is what happens when you apply it:
p40089
aVis executed
p40090
aVdecorator()` function
p40091
aVThis returned function is called and passed in the  function from step 1
p40092
aVThe scoped  function adds the  attribute to the function, with the scoped  value passed into  in step 2
p40093
aVThe function is returned
p40094
aVPython assigns the return value of step 4 to the name
p40095
as(dp40096
g16
V100297
p40097
stp40098
a((dp40099
g2
(lp40100
VThe documentation you refer to, is for version 1
p40101
aV4 but the current released versions are 1
p40102
aV13 and 2
p40103
aV0; I'd expect the latter especially to no longer match that documentation
p40104
aVHowever, the Tweepy API directly reflects the Twitter API
p40105
aVFor trends for example, there are several separate methods:
p40106
aVAs such,  should work just fine; replace path separators by underscores
p40107
as(dp40108
g16
V100297
p40109
stp40110
a((dp40111
g2
(lp40112
VIn Python, the way names are looked up is highly optimized inside functions
p40113
aVOne of the side effects is that the mapping returned by  gives you a copy of the local names inside a function, and altering that mapping does not actually influence the function:
p40114
aVInternally, Python uses the  opcode to look up the  name in the current frame by index, instead of the slower , which would look for a local name (by name), then in the  mapping if not found in the first
p40115
aVThe python compiler can only emit  opcodes for local names that are known at compile time; but if you allow the  to directly influence a functions' locals then you cannot know all the local names ahead of time
p40116
aVNested functions using scoped names (free variables) complicates matters some more
p40117
aVIn Python 2, you can force the compiler to switch off the optimizations and use  always by using an  statement in the function:
p40118
aVIn Python 3,  has been replaced by  and the work-around is gone
p40119
aVIn Python 3 all functions are optimized
p40120
aVAnd if you didn't follow all this, that's fine too, but that is why the documentation glosses over this a little
p40121
aVIt is all due to an implementation detail of the CPython compiler and interpreter that most Python users do not need to understand; all you need to know that using  to change local names in a function does not work, usually
p40122
as(dp40123
g16
V100297
p40124
stp40125
a((dp40126
g2
(lp40127
VYou first need to save the image again in JPEG format; using the  method would otherwise return raw image data that no browser would recognize:
p40128
aVThis you can then encode to base64:
p40129
aVHere is one I made with this method:
p40130
aVUnfortunately the Markdown parser doesn't let me use this as an actual image, but you can see it in action in a jsfiddle pastie instead
p40131
as(dp40132
g16
V100297
p40133
stp40134
a((dp40135
g2
(lp40136
VWhen  tests for containment, it'll check for equality against your custom type
p40137
aVIn other words,  can be seen as:
p40138
aVTwo custom classes  and  test as equal if:
p40139
aVThey are identical,  is True
p40140
aVThey are the same object
p40141
aVIf  has an  method, then  is tested
p40142
aVIf  has no such method, but  does exist then  is tried
p40143
aVYou can also define the  and / or  methods to make things a little more complicated, but you generally want to avoid toying with this too much in custom types
p40144
as(dp40145
g16
V100297
p40146
stp40147
a((dp40148
g2
(lp40149
VThe bottle template syntax uses , not  to mark python(ish) blocks:
p40150
as(dp40151
g16
V100297
p40152
stp40153
a((dp40154
g2
(lp40155
VYou really have a CSV-style file, so use the  module:
p40156
aVYou could augment this as needed; append the second and third columns to separate lists, converting them to s and s, for example:
p40157
aVIf this were not a CSV-style file, you'd still use a loop; you'd loop directly over the file object:
p40158
as(dp40159
g16
V100297
p40160
stp40161
a((dp40162
g2
(lp40163
VThe  and  short circuit, see the Boolean operations documentation:
p40164
aVThe expression  first evaluates ; if  is false, its value is returned; otherwise,  is evaluated and the resulting value is returned
p40165
aVThe expression  first evaluates ; if  is true, its value is returned; otherwise,  is evaluated and the resulting value is returned
p40166
aVNote how, for ,  is only evaluated if  evaluates to a True value
p40167
aVInversely, for ,  is only evaluated if  evaluated to a False value
p40168
aVFor the first expression , this means that  is never evaluated, since the first part is already
p40169
aVFurthermore, your custom  class is considered True:
p40170
aVIn the context of Boolean operations, and also when expressions are used by control flow statements, the following values are interpreted as false: , , numeric zero of all types, and empty strings and containers (including strings, tuples, lists, dictionaries, sets and frozensets)
p40171
aVAll other values are interpreted as true
p40172
aV(See the  special method for a way to change this
p40173
aVSince your class does not implement a  method (nor a  method), it is considered  as far as boolean expressions are concerned
p40174
aVIn the expression ,  is thus true, and  is never evaluated
p40175
aVThis feature is used quite regularly and effectively by experienced developers, most often to specify defaults:
p40176
aVDo be wary of chaining these and use a conditional expression instead where applicable
p40177
as(dp40178
g16
V100297
p40179
stp40180
a((dp40181
g2
(lp40182
VIf you want a greyscale image, simply convert it to the  (Luminance) mode:
p40183
aVApplying that to my ninja:
p40184
aVIf you need intermediary steps, you need to convert the RGB value to HLS or HSV, adjust the saturation, then convert it back to RGB again
p40185
aVYou could use colorsys for that, or adapt this  solution; I would expect the latter to perform better
p40186
as(dp40187
g16
V100297
p40188
stp40189
a((dp40190
g2
(lp40191
VYou need to commit your transaction for the database to make your insert permanent, and you need to use SQL parameters to prevent SQL injection attacks and general quoting bugs:
p40192
aVUntil you commit, the data you inserted will only be visible to your python program; if you do not commit at all, then the changes will be discarded again by the database
p40193
aVAlternatively, you could switch on auto-commit mode:
p40194
aVAfter switching on auto-commit, your insertions will be committed instantly
p40195
aVBe careful with this as this could lead to inconsistent data if you need to insert data into multiple rows and  / or tables that is interdependent
p40196
as(dp40197
g16
V100297
p40198
stp40199
a((dp40200
g2
(lp40201
VYou want to create a copy of the  instance to assign to the  attribute; use either  or :
p40202
aVYou'll need  if there are any attributes of  that are mutable; a , ,  or another custom class instance are all mutable, but things like integers and strings are not
p40203
as(dp40204
g16
V100297
p40205
stp40206
a((dp40207
g2
(lp40208
VIf you want to avoid backslashes, you can alias the long names:
p40209
aVor you could nest the statements:
p40210
aVYou do not want to use ; there are several problems with it that directly led to it's deprecation
p40211
aVEarlier context managers are not covered for problems with later context managers in the nesting, for example
p40212
as(dp40213
g16
V100297
p40214
stp40215
a((dp40216
g2
(lp40217
VOn CPython: None; the files will be closed when their reference count drops to 0, which is immediately when the  and  calls return
p40218
aVOn other Python implementations that do not use reference counting, the file will remain open until garbage collected
p40219
as(dp40220
g16
V100297
p40221
stp40222
a((dp40223
g2
(lp40224
VThe new Python 3  class was added as a replacement for  (see issue 13585)
p40225
aVIt is coded in such a way you can use it in Python 2 directly:
p40226
aVUse this as your context manager, then add nested context managers at will:
p40227
aVFor your example context manager, this prints:
p40228
as(dp40229
g16
V100297
p40230
stp40231
a((dp40232
g2
(lp40233
VYou could use :
p40234
aVThis outputs:
p40235
aVThis sorts the input  according to the indices taken from the  list; the  function is called for each element in the input sequence in order, once, before sorting
p40236
aVThis does not compare that favorably with your version though; you have a O(n) algorithm, this takes O(n lg n)
p40237
as(dp40238
g16
V100297
p40239
stp40240
a((dp40241
g2
(lp40242
VYes, add this at the top of your file:
p40243
aVPython 2 uses integer division (floor division) when using integer inputs by default; Python 3 switched to floating point division even when using integer inputs
p40244
aVSee the PEP 238, which documents the change:
p40245
aVThe current division (/) operator has an ambiguous meaning for
p40246
aVnumerical arguments: it returns the floor of the mathematical
p40247
aVresult of division if the arguments are ints or longs, but it
p40248
aVreturns a reasonable approximation of the division result if the
p40249
aVarguments are floats or complex
p40250
aVThis makes expressions expecting
p40251
aVfloat or complex results error-prone when integers are not
p40252
aVexpected but possible as inputs
p40253
as(dp40254
g16
V100297
p40255
stp40256
a((dp40257
g2
(lp40258
VYou have a syntax error because you didn't close a parenthesis:
p40259
aVYou are missing another a few lines further on too:
p40260
as(dp40261
g16
V100297
p40262
stp40263
a((dp40264
g2
(lp40265
VRegular expression  results include indices of the match
p40266
aVWhat remains is to match repeating characters:
p40267
aVwould match only if a given letter character (-) is repeated at least once:
p40268
aVThe  and  methods on the match result give you the exact positions in the input string
p40269
aVDashes are included in the matches, but not non-repeating characters:
p40270
aVIf you want the  part to be a match, simply replace the  with a  multiplier:
p40271
as(dp40272
g16
V100297
p40273
stp40274
a((dp40275
g2
(lp40276
VThe code you posted cannot under any circumstances raise , so you have something mixed up in your ipython session there
p40277
aVI'd use this instead:
p40278
as(dp40279
g16
V100297
p40280
stp40281
a((dp40282
g2
(lp40283
VYou need to use  instead;  anchors to the start of the string
p40284
aVYour pattern is otherwise fine:
p40285
as(dp40286
g16
V100297
p40287
stp40288
a((dp40289
g2
(lp40290
VIf you use a list, there is no need to generate names:
p40291
aVYou can simplify that by using a list comprehension:
p40292
aVNow you can access each frame by index:
p40293
aVor loop through them:
p40294
as(dp40295
g16
V100297
p40296
stp40297
a((dp40298
g2
(lp40299
VIt looks like you are trying to produce JSON; if so, use the  module:
p40300
as(dp40301
g16
V100297
p40302
stp40303
a((dp40304
g2
(lp40305
VUse curly braces around the pattern:
p40306
aVResult:
p40307
as(dp40308
g16
V100297
p40309
stp40310
a((dp40311
g2
(lp40312
VYou named your scraper the same as the  you imported:
p40313
aVThe  thus is using your  subclass, not whatever you defined in
p40314
aVPerhaps you want to rename the class:
p40315
as(dp40316
g16
V100297
p40317
stp40318
a((dp40319
g2
(lp40320
VThe empty string does not count as a , but as a 0-length string
p40321
aVUse  instead if you expect a SQL  to be inserted:
p40322
aVSee the SQLite and Python types section of the  documentation
p40323
aVIf you need to know if rows were inserted successfully, insert one by one with  and check  afterwards; the  reflects the number of affected rows, for your  call with  values the rowcount is , with no information as to what rows succeeded and what rows failed
p40324
as(dp40325
g16
V100297
p40326
stp40327
a((dp40328
g2
(lp40329
VIn the second call you are passing in , which is a mapping (a ), so you are looping over the keys, which are strings
p40330
aVIn the first call on the other hand, you are passing in the  itself
p40331
aVThe second call is thus not the same; the following call would be:
p40332
aVThe question here is if that is what you actually meant to do
p40333
as(dp40334
g16
V100297
p40335
stp40336
a((dp40337
g2
(lp40338
VYou want to extend :
p40339
aVbecause  is itself a list
p40340
aVYou currently append the list of matched websites, so at some point you'll pass that list as  from the  lop to  which then tries to treat it as a  object, since it is certainly not a string, the other valid option
p40341
as(dp40342
g16
V100297
p40343
stp40344
a((dp40345
g2
(lp40346
VThose are class attributes, not instance attributes
p40347
aVClass attributes are shared between instances
p40348
aVThis is also how instances inherit the methods of their class
p40349
aVInstance attributes with the same name shadow class attributes, so you can set  on the instance to give the instance it's own copy
p40350
aVYou can use  on an instance to list a combined view of instance and class attribute names:
p40351
aVYou can use  to filter on the type of attribute
p40352
aVAnother option is to list the class attributes with :
p40353
aVFrom the Class definitions documentation:
p40354
aVVariables defined in the class definition are class attributes; they are shared by instances
p40355
aVInstance attributes can be set in a method with
p40356
aVBoth class and instance attributes are accessible through the notation \u201c\u201d, and an instance attribute hides a class attribute with the same name when accessed in this way
p40357
as(dp40358
g16
V100297
p40359
stp40360
a((dp40361
g2
(lp40362
VYou really want to use the  argument instead; sorting on the 4th column with :
p40363
aVor you could use a :
p40364
aVor you could use :
p40365
aVAll 3 options create a new callable that is passed each item in
p40366
aVThe  argument to  has been removed in Python 3
p40367
as(dp40368
g16
V100297
p40369
stp40370
a((dp40371
g2
(lp40372
VYou need to remove the  call you have in your loop:
p40373
aVYou also may want to use  to properly quote the URLs you get from the option dropdown; this removes the need to manually replace spaces with
p40374
aVUse  to construct the final URL:
p40375
as(dp40376
g16
V100297
p40377
stp40378
a((dp40379
g2
(lp40380
VPillow 2
p40381
aV0 supports Python 3, including 3
p40382
aV3:
p40383
aVNote: Pillow >= 2
p40384
ag2391
aV0 supports Python versions: 2
p40385
aV6, 2
p40386
aV7, 3
p40387
aV2, 3
p40388
aV3; Pillow < 2
p40389
ag2391
aV0 supports Python versions: 2
p40390
aV4, 2
p40391
aV5, 2
p40392
aV6, 2
p40393
ag4892
aVPillow is a fork of PIL that adds (much) better packaging and patches and improvements to make PIL work on Python 3
p40394
aVWindows installers and eggs are included
p40395
as(dp40396
g16
V100297
p40397
stp40398
a((dp40399
g2
(lp40400
VThe  argument tells  what to determine the minimum by
p40401
aVWithout the  argument,  compares any given whole tuple with the other tuples, and then the first element within the tuple is compared first
p40402
aVThe  function is called for each element in the input sequence and the minimum element is determined solely by the return value of that key
p40403
aVreturns the second element in the tuple
p40404
aVCompare the following two outcomes:
p40405
aVIn the first example, no  function is supplied and  compares each tuple as-is, in the second example,  only looks at what the  function returns and thus picks a different element as the minimum
p40406
aVYou can go really overboard with that key function:
p40407
aVUsing  is not really needed, and the whole expression is overly verbose; you can simplify it down to:
p40408
aVor using :
p40409
aVTo compare neighboring pairs, you'd need a  helper function:
p40410
aVIt's easier to then move the 'last element is 1' criteria to a filter, using :
p40411
aVNow we can do the real work; for each pair of neighbouring lists, find the pair whose second element sum is the lowest, then from that pair find the lowest by second element:
p40412
aVTo put that all together, with the responsibility of filtering left to the caller of the function:
p40413
aVFor your sample input that gives:
p40414
aVYou can even move the criteria for the minimum to a separate key argument:
p40415
as(dp40416
g16
V100297
p40417
stp40418
a((dp40419
g2
(lp40420
VYou should really use , not  when working with  here
p40421
aVgives you unicode,  gives you raw bytes
p40422
aVNext, there is no need to use ,  will work just fine
p40423
aVBetter yet, pass in the raw response to :
p40424
aVand have the parser read the response directly
p40425
aVIf you stil get an  exception, then your XPath expression did not match anything in the page
p40426
aVYou'll have to save the HTML instead and analyze it manually to see what is different about that page
p40427
as(dp40428
g16
V100297
p40429
stp40430
a((dp40431
g2
(lp40432
VYou are URL encoding, not HTML
p40433
aVUse :
p40434
aVbut make sure you encode to  first:
p40435
aVThis will quote the  explicitly; if you meant that to be a space character, you need to mark that as safe:
p40436
aVThe latter form gives:
p40437
as(dp40438
g16
V100297
p40439
stp40440
a((dp40441
g2
(lp40442
VYou need to look in the  package; the  function accepts the  command line parameters and takes it from there
p40443
aVWhen you enter  on the command line,  is set to
p40444
aVThese are handed off to a  instance, which has a  method to do the actual parsing
p40445
aVThe whole  package is modular; the  sub package contains the various standard commands for the  tool
p40446
aVhandles the  subcommand, for example
p40447
as(dp40448
g16
V100297
p40449
stp40450
a((dp40451
g2
(lp40452
VYou need to count the number of rows:
p40453
aVUsing  with a generator expression makes for an efficient counter, avoiding storing the whole file in memory
p40454
aVIf you already read 2 rows to start with, then you need to add those 2 rows to your total; rows that have already been read are not being counted
p40455
as(dp40456
g16
V100297
p40457
stp40458
a((dp40459
g2
(lp40460
VUse a  instead:
p40461
aVThis uses a hash table under the hood, so searches are O(1)
p40462
as(dp40463
g16
V100297
p40464
stp40465
a((dp40466
g2
(lp40467
VDon't replace any characters, just insert with a SQL parameter:
p40468
aVSQL parameters take care of correct quoting for you
p40469
as(dp40470
g16
V100297
p40471
stp40472
a((dp40473
g2
(lp40474
VSet the  of :
p40475
aVand it'll show up
p40476
aVfilters out everything that is not part of the module, as per the  attribute
p40477
aVThe rest is assumed to be external imports
p40478
as(dp40479
g16
V100297
p40480
stp40481
a((dp40482
g2
(lp40483
V6 million rows can either be held in memory or in a SQLite database
p40484
aVPut it there and make use of the lookup optimizations that offers:
p40485
aVNow  is a mapping offering O(1) lookups; this saves you having to loop over the whole 6 million rows for each and every combination you generate
p40486
aVThat is a lot of loops saved
p40487
aVUsing a  is easier when reading the  list:
p40488
aVThere is no need to find a  value here, simply list the keys and pass these to the  and  functions to generate combinations
p40489
aVThe following code replicates what yours does in more compact form, with fewer lists, and with O(1) dictionary lookups so fewer loops:
p40490
aVFor your input samples, it spits out, in a fraction of a second:
p40491
as(dp40492
g16
V100297
p40493
stp40494
a((dp40495
g2
(lp40496
VThe  paramater only matches on the whole text content
p40497
aVYou need to use a regular expression instead:
p40498
aVThe  word boundary anchors make sure you only match the whole word, not a partial word
p40499
aVDo mind the  raw string literal used here,  means something different when interpreted as a normal string; you'd have to double the backslashes if you don't use a raw string literal here
p40500
aVDemo:
p40501
as(dp40502
g16
V100297
p40503
stp40504
a((dp40505
g2
(lp40506
VFirst of all, do not reencode the content
p40507
aVThere is no need to do so, XML parsers are perfectly capable of handling encoded content
p40508
aVNext, I'd use the ElementTree API for a task like this:
p40509
aVThis only consideres  elements that have a direct  child element
p40510
as(dp40511
g16
V100297
p40512
stp40513
a((dp40514
g2
(lp40515
VYou are using the implied  method when you call the element directly, which returns a result set (a list-like object)
p40516
aVUsing  does not change what is returned, only how many are returned
p40517
aVIf you want to get the first element of that set, use slicing:
p40518
aVor be explicit about it and use  instead:
p40519
aVTo get the text of all matches you'll need to loop over the result set
p40520
aVA list comprehension would be easiest:
p40521
as(dp40522
g16
V100297
p40523
stp40524
a((dp40525
g2
(lp40526
VYou forgot a colon:
p40527
aVThe parenthesis around the condition are not needed here
p40528
aVIf you are using Python 2, then the parenthesis around the string when printing are not needed either:
p40529
aVIn Python 3, where  is a function, you do need to use them
p40530
as(dp40531
g16
V100297
p40532
stp40533
a((dp40534
g2
(lp40535
VYou are going about it just about right for for listing just the base names without the extensions
p40536
aVWhat you are missing is detecting what is missing
p40537
aVIf you can easily reconstruct the filenames in directory 1; because they have all the same extension, for example; then I'd use sets here; sets make listing the difference between the two directories easy:
p40538
as(dp40539
g16
V100297
p40540
stp40541
a((dp40542
g2
(lp40543
VWhen you specify a  peewee expects to use a column ending in  based on their own name
p40544
aVYour  field thus results in an column named
p40545
aVYou can override this by setting  for that field:
p40546
as(dp40547
g16
V100297
p40548
stp40549
a((dp40550
g2
(lp40551
VUse the  classmethod:
p40552
aVIf all you need to do is iterate over the chained lists, then don't materialize it to a , just loop:
p40553
aVYou can also use parameter unpacking, directly on :
p40554
aVBut do this only with a smaller list
p40555
as(dp40556
g16
V100297
p40557
stp40558
a((dp40559
g2
(lp40560
VYou have a custom ASCII-table-like format with fixed-with columns:
p40561
aVIf we assume that none of the actual data fields contain asterisks themselves, the easiest way to read each row is to use a regular expression to split out the lines
p40562
aVTo output, I'd still use the  module, because that would make future processing that much easier:
p40563
aVThis skips empty rows, and writes only every 7th column (counting from number nine) and skips the rest
p40564
aVThe first row thus is:
p40565
as(dp40566
g16
V100297
p40567
stp40568
a((dp40569
g2
(lp40570
VI cannot locate the exact  module you are using, but it appears that  includes the  instance in the sprite list
p40571
aVYou can ignore it by testing against :
p40572
aVIf that doesn't work then more than just the current paddle is listed in that list; you'd need to share the relevant  module code for me to determine that in more detail
p40573
as(dp40574
g16
V100297
p40575
stp40576
a((dp40577
g2
(lp40578
VUnlimited recursion would require infinite resources; every function call requires a stack entry, and there is only a finite amount of memory to hold those
p40579
aVSo, no, you cannot have unlimited recursion depth
p40580
aVYou can raise the limit, by calling
p40581
as(dp40582
g16
V100297
p40583
stp40584
a((dp40585
g2
(lp40586
VSplit from the end with the  method and a limit:
p40587
aVDemo:
p40588
aVThe error you get because you were trying to pass a list to , not a string; you wanted this instead:
p40589
aVYou were slicing the list, not selecting one element
p40590
aVSlicing results in a list, always:
p40591
as(dp40592
g16
V100297
p40593
stp40594
a((dp40595
g2
(lp40596
VYou have a full stop outside of the string:
p40597
aVThat is not legal Python:
p40598
aVRemove that or move it into the string:
p40599
as(dp40600
g16
V100297
p40601
stp40602
a((dp40603
g2
(lp40604
VThese are command line options
p40605
aVYou can use the stdlib  module for that
p40606
as(dp40607
g16
V100297
p40608
stp40609
a((dp40610
g2
(lp40611
VYou get a list of one element
p40612
aVYour next line will loop over an empty slice:
p40613
as(dp40614
g16
V100297
p40615
stp40616
a((dp40617
g2
(lp40618
VYou use the  module instead
p40619
aVYou have a CSV format, and that module knows how to handle quoted values properly
p40620
aVQuick demo for your example line:
p40621
aVNote that the quotes have been removed but the comma is still there as part of the value
p40622
as(dp40623
g16
V100297
p40624
stp40625
a((dp40626
g2
(lp40627
VYour input is UTF-8:
p40628
aVBut you are using a unicode regular expression
p40629
aVThe expression is matched directly against
p40630
aVthe raw bytes of your UTF-8 input
p40631
aVOf all those bytes, only the spaces, the full stop and the  byte (as the  character), are not removed
p40632
aVThe rest of the individual bytes are deleted, because they do not fall in your negative character class
p40633
aVUsing Unicode properly (by decoding  to unicode first) works:
p40634
aVThe alternative would be to use a raw byte string for the regular expression, and matching byte combinations
p40635
aVWorking out what UTF-8 bytes and ranges are valid is very, very tricky
p40636
aVYou'll need to fully understand how UTF-8 encodes characters to multiple bytes, then translate your negative character class to a set of positive matches that allow through the same byte combinations
p40637
aVThis is not for the faint of heart
p40638
as(dp40639
g16
V100297
p40640
stp40641
a((dp40642
g2
(lp40643
V decodes the file for you
p40644
aVYou are already receiving Unicode data
p40645
aVFor  you need to open the file in binary mode, and let the XML parser deal with encoding
p40646
aVDo not do this yourself
p40647
aVXML files include a header to indicate what encoding they use, and the parser adjusts to that
p40648
aVIf the header is missing, the parser can safely assume UTF-8
p40649
as(dp40650
g16
V100297
p40651
stp40652
a((dp40653
g2
(lp40654
V is the appropriate exception
p40655
aVWhen possible, use Python exceptions, especially for APIs suitable for 3rd parties
p40656
aVThis saves on imports and learning curves
p40657
aVYou can simplify your code:
p40658
aVor simply access all the keys:
p40659
aVor just not test and let the code that does use the key raise the exception
p40660
as(dp40661
g16
V100297
p40662
stp40663
a((dp40664
g2
(lp40665
VThe module is meant to be used when  and  are not available on your platform
p40666
aVThe functions you pass to it are called synchronously, and you called  immediately
p40667
aVThe first function acquires the semphore, prints, then the second function is called and blocks
p40668
aVIt is run synchronously and never returns
p40669
aVFrom the  documentation:
p40670
aVBe careful to not use this module where deadlock might occur from a thread being created that blocks waiting for another thread to be created
p40671
aVThis often occurs with blocking I/O
p40672
aVand from an EFF-bot post (otherwise short and missing a working link):
p40673
aVHelpers to make it easier to write code that use threads where supported, but still runs on Python versions without thread support
p40674
aVThe dummy modules simply run the threads sequentially
p40675
aVNote the making it easier part; without actual threads, you cannot expect code run under  to not deadlock in the manner that it does in your example
p40676
as(dp40677
g16
V100297
p40678
stp40679
a((dp40680
g2
(lp40681
VIt's the comment and doctype that throws the parser here, and subsequently, BeautifulSoup
p40682
aVEven the HTML tag seems 'gone':
p40683
aVYet it is there in the  iterable still
p40684
aVYou can find things again with:
p40685
aVDemo:
p40686
as(dp40687
g16
V100297
p40688
stp40689
a((dp40690
g2
(lp40691
VYou first need to get the character at the given index, then return the count:
p40692
aVDemo:
p40693
aVPython indexes start at zero, so position 3 is the letter  in your input example
p40694
as(dp40695
g16
V100297
p40696
stp40697
a((dp40698
g2
(lp40699
VJust loop through the list with a list comprehension:
p40700
aVDemo:
p40701
aVIf you have this data in files, first build the mapping in memory:
p40702
aVthen build your output file from the input file:
p40703
as(dp40704
g16
V100297
p40705
stp40706
a((dp40707
g2
(lp40708
VYou could use string formatting:
p40709
aVThis uses the modern  method, but you could use classic string operations as well
p40710
as(dp40711
g16
V100297
p40712
stp40713
a((dp40714
g2
(lp40715
VYou'd need to use the proper type; the match object type is not explicitly importable, but you can use  on an existing instance to store it:
p40716
aVthen use that in  tests:
p40717
aVThere is nothing about C-defined Python types that prevents using  otherwise
p40718
as(dp40719
g16
V100297
p40720
stp40721
a((dp40722
g2
(lp40723
VYou are parsing XML that doesn't have child nodes for that specific  element
p40724
aVYou probably want to skip that one
p40725
aVYou are not using Python loops to their full potential
p40726
aVThere is no need to loop over indices when you can loop directly over the list itself:
p40727
as(dp40728
g16
V100297
p40729
stp40730
a((dp40731
g2
(lp40732
VYou have your logic inverted; you are returning  if the first elements of the pair are unequal
p40733
aVInvert the condition:
p40734
aVBut, do note that the summed pairs are likely to be greater in value than any single value is going to be
p40735
aVFor your example, your logic would return , which is definitely lower than any other neighbour sum you generate for your example input:
p40736
aVThe above sample shows you what values the lambda generates, and  would win as the minimum, hands down
p40737
aVTo ignore pairs where the first element is the same, you should instead return :
p40738
aV(positive infinity) is always going to be higher than any summed pair, so  will not consider that specific pair
p40739
aVNow the output is:
p40740
aVand the pair totalling  will be picked
p40741
as(dp40742
g16
V100297
p40743
stp40744
a((dp40745
g2
(lp40746
VYou can use the  codec; this produces a  instance:
p40747
aVexpliticly produces valid python string literals:
p40748
aVProduce a string that is suitable as Unicode literal in Python source code
p40749
aVTo go back to Unicode, simply decode from ASCII:
p40750
aVAlternatively, use :
p40751
aVReturn a string containing a printable representation of an object
p40752
aVFor many types, this function makes an attempt to return a string that would yield an object with the same value when passed to , otherwise the representation is a string enclosed in angle brackets that contains the name of the type of the object together with additional information often including the name and address of the object
p40753
aVThe output of  of a string can be pasted straight back into a Python interpreter without additional formatting
p40754
aVNote that  and  only escape quotes when absolutely necessary
p40755
aVOnly when both styles of quoting, single and double, are present does one of these get escaped:
p40756
as(dp40757
g16
V100297
p40758
stp40759
a((dp40760
g2
(lp40761
VPython module names and the classes they contain are separate
p40762
aVYou need use the full path:
p40763
aVYour  package has a module named , and inside that module is your  class
p40764
aVNote that Python, unlike Java, lets you define methods outside classes too, no need to make this a static method
p40765
aVNor do you need to use a separate file per class
p40766
as(dp40767
g16
V100297
p40768
stp40769
a((dp40770
g2
(lp40771
VYou do not need to use  here, simply stream the object directly
p40772
aVYou do need to set the Content-Type header explicitly;  does this when using  but  doesn't:
p40773
aVI've used the open file object as a context manager so that it is also auto-closed for you when the block exits (e
p40774
ag1298
aVan exception occurs or  successfully returns)
p40775
as(dp40776
g16
V100297
p40777
stp40778
a((dp40779
g2
(lp40780
VYou have HTML entities, simply use the  module to unescape those:
p40781
aVThese HTML entities use decimal numbers, not hexadecimal
p40782
aVis  in hexadecimal, etc
p40783
aVThey encode unicode codepoints, no UTF-8 or ISO-8859-1 used
p40784
aVISO-8859-1, or Latin-1, is not even capable of encoding these specific codepoints (Vietnamese for 'Language Support', according to Google Translate)
p40785
as(dp40786
g16
V100297
p40787
stp40788
a((dp40789
g2
(lp40790
VYou could parse that as a Python literal, if you remove the  part from it, and only take everything between the parenthesis:
p40791
aVWe remove the  argument because it is not a valid python string literal and you don't want to have it anyway
p40792
aVDemo:
p40793
aVNow you have a Python tuple and can pick out any value you like
p40794
aVYou want the values at indices 1, 2 and 4, for example:
p40795
as(dp40796
g16
V100297
p40797
stp40798
a((dp40799
g2
(lp40800
VYou can ask the database to tell you if the id is there:
p40801
aVI am assuming that you are using MySQLdb here; different database adapters use slightly different query parameter styles
p40802
aVOthers might use  instead of
p40803
as(dp40804
g16
V100297
p40805
stp40806
a((dp40807
g2
(lp40808
VReplace  with an empty list:
p40809
aVor filter the lists:
p40810
aVThe  call removes  from the list altogether, while the first option gives you  values to your function call
p40811
aVI removed the lambda, it is redundant here
p40812
aVWith the  option, the 4th argument is :
p40813
aVFiltering results in 3 arguments to :
p40814
aVYou could use  as well, but that gets a little verbose:
p40815
as(dp40816
g16
V100297
p40817
stp40818
a((dp40819
g2
(lp40820
VSupply a  function, a  is easiest, and sort reversed:
p40821
aVThe key function tells  what to sort by; the 4th item in the value for the given key
p40822
aVDemo:
p40823
as(dp40824
g16
V100297
p40825
stp40826
a((dp40827
g2
(lp40828
VI'd create a list of dates, then find the 'bucket' to put each item into from that list
p40829
aVYou can create new dates relative from a starting point using  objects:
p40830
aVNow you have 12 dates to compare everything else against, so you know what bucket to put each subsequent value in:
p40831
aVWe can then use the  module to find the matching bucket:
p40832
aVWe create such buckets per user so we need to keep track of the buckets in a separate mapping
p40833
aVWe'll actually create buckets on the fly as needed to fit the current transaction date
p40834
aVNext, we use a  instance to track per-key tallies (key  in your input):
p40835
aVThis creates a list for your buckets to hold, and a empty counts dictionary for the deposits and withdrawals
p40836
aVI used a dictionary here because that is much easier to work with than having to manipulate (immutable) tuples later on
p40837
aVI also did not include the month number (1 - 12); no point, you already have an index for each bucket (0 - 11), and you can have a variable number of buckets
p40838
aVWe need to create buckets and counters as needed to fit the current date in; instead of scanning throuh the data to find the max transaction date per user we just expand our buckets and counts list as needed:
p40839
aVNow we can start counting:
p40840
aVThe  call makes picking the right bucket easy and fast
p40841
aVThe result for your example input is:
p40842
as(dp40843
g16
V100297
p40844
stp40845
a((dp40846
g2
(lp40847
VBecause you used  first, the  file has filled a linebuffer; the subsequent call to  returns only the buffered lines
p40848
aVIf you call  again, the rest of the lines are returned:
p40849
aVThe work-around is to not mix  and :
p40850
aVThis behaviour is really a bug; the Python devs are aware of it, see issue 8260
p40851
aVThe other option is to use  instead of ; the  library is what Python 3 uses to implement the built-in  function and is a lot more robust and versatile than the  module
p40852
as(dp40853
g16
V100297
p40854
stp40855
a((dp40856
g2
(lp40857
VYou haven't defined  until much later in the file
p40858
aVMove the  definition to below the  line
p40859
aVPut it just before the  line:
p40860
as(dp40861
g16
V100297
p40862
stp40863
a((dp40864
g2
(lp40865
V creates a copy of the list
p40866
aVThe slice takes all elements and returns a new list
p40867
aVIf you loop over the list itself, and keep adding elements to it, you end up with an endless loop
p40868
aVBut if you loop over a copy instead, then the  loop won't see the original list being extended; the copy used for the loop doesn't see the extra element being added
p40869
as(dp40870
g16
V100297
p40871
stp40872
a((dp40873
g2
(lp40874
VYou need to turn the  int value into a string:
p40875
aVAlternatively, use string formatting:
p40876
aVOr perhaps you wanted to turn  into an  first, then the result into a string:
p40877
as(dp40878
g16
V100297
p40879
stp40880
a((dp40881
g2
(lp40882
VRead the file in 23 byte chunks:
p40883
aVHere we use the  function with a sentinel to loop over a function until that function returns , the empty string
p40884
aVThe function we loop over is using  to call  with the argument 23 each and every time
p40885
aVYou could use a lambda () instead, but  is a faster
p40886
as(dp40887
g16
V100297
p40888
stp40889
a((dp40890
g2
(lp40891
VHere is how I'd do it:
p40892
aVuse the GitHub API to enumerate the repositories (see the JSON for Plone for an example)
p40893
aVLoop over the JSON result and with each:
p40894
aVCheck out the repository (the  URL) with ; only the git info, no working copy
p40895
aVThis creates a  directory, say  if you cloned
p40896
aVCount the revisions with ; outputs the count to stdout, so  should do the job just fine
p40897
aVRemove the  directory again
p40898
aVThat only requires 2 API calls, so you avoid being rate limited; paging through all the commits with the API would require too many requests to count all the repository commits, checking out a bare repository copy would be faster anyway
p40899
as(dp40900
g16
V100297
p40901
stp40902
a((dp40903
g2
(lp40904
VThe  object is just that, an object, so you can assign it to another variable, use a loop, etc:
p40905
aVNow both sub parsers have the same arguments added
p40906
as(dp40907
g16
V100297
p40908
stp40909
a((dp40910
g2
(lp40911
VOn most platforms, Python floats are what C would call a , but you wrote your data out as  instead, which has half the precision
p40912
aVIf you were to use , you'd have less precision loss:
p40913
aVThe  struct format offers only single precision (24 bits for the significant precision)
p40914
as(dp40915
g16
V100297
p40916
stp40917
a((dp40918
g2
(lp40919
VYou can detect if something is a property, by looking at the same attribute on the class:
p40920
aVYou can also test  and  to test if the property has a getter and a deleter, respectively
p40921
aVHowever, you can always catch the  exception to deal with the setter missing:
p40922
as(dp40923
g16
V100297
p40924
stp40925
a((dp40926
g2
(lp40927
VYou can use the  function:
p40928
aVNote the ; in Python 2, dividing integers gives you floor division (rounding down) by default
p40929
aVAlternatively, add  at the top of your python code to enable floating point division instead
p40930
aVNote that I named the method ; use double-underscore names ("dunder") only for special method names
p40931
as(dp40932
g16
V100297
p40933
stp40934
a((dp40935
g2
(lp40936
VYou want to get the classmethod , then take the  attribute from the resulting timedelta:
p40937
aVSo you have the  module, which has a  class, which in turn has a  method on it
p40938
aVI also added calls to  to extract just the date portion (result is a  instance); this makes dealing with timestamps that differ slightly less than a multiple of 24 hours easier
p40939
aVDemo:
p40940
as(dp40941
g16
V100297
p40942
stp40943
a((dp40944
g2
(lp40945
VYou need to process the  list further; rather than write the whole list to the CSV file, write just the  tags to the CSV file:
p40946
as(dp40947
g16
V100297
p40948
stp40949
a((dp40950
g2
(lp40951
VUse the  environment variable:
p40952
as(dp40953
g16
V100297
p40954
stp40955
a((dp40956
g2
(lp40957
VThere is quite some indirection here
p40958
aVFollow me carefully
p40959
aVThe  module is implemented on top of the  module
p40960
aVThis module acts as a facade for 4 different specific DBM implementations, and it will pick the first module available when creating a new database, in the following order:
p40961
aV(deprecated but still the first  choice)
p40962
aVThis is a proxy for the  module,  is really
p40963
aV, Python module for the GNU DBM library, offering more functionality than the  module can offer when used with this same lbrary
p40964
aV, a proxy module using either the , BSD DB and GNU DBM libraries (choosen when Python is compiled)
p40965
aV, a pure-python implementation
p40966
aVIt is this range of choices that makes  files appear to grow extra extensions on different platforms
p40967
aVThe  module is the one that adds the ,  and  extensions:
p40968
aVOpen a dumbdbm database and return a dumbdbm object
p40969
aVThe filename argument is the basename of the database file (without any specific extensions)
p40970
aVWhen a dumbdbm database is created, files with  and  extensions are created
p40971
aVThe  file is moved to  as new index dicts are committed for changes made to the data structures
p40972
aVIt means that the other three options for  are not available on your platform
p40973
aVThe other formats may give you other extensions
p40974
aVThe  module may use ,  or , depending on what library was used for that module
p40975
as(dp40976
g16
V100297
p40977
stp40978
a((dp40979
g2
(lp40980
VA dict comprehension will do the trick:
p40981
aVFor Python 3, replace  with just , for Python 2
p40982
aV6 and before, use a generator expression to generate (key, value) tuples:
p40983
aVFor your second dictionary  and  are then set to  and  respectively
p40984
aVDemo:
p40985
as(dp40986
g16
V100297
p40987
stp40988
a((dp40989
g2
(lp40990
VYou can still use a  but you need to turn each list into a tuple; here we use a sorted tuple of the keys and values to find duplicates accurately:
p40991
aVTo keep the list in order and keep your dictionaries intact, you could use:
p40992
aVDemo for the latter:
p40993
as(dp40994
g16
V100297
p40995
stp40996
a((dp40997
g2
(lp40998
VA  is a subclass of the standard  class; you can loop over the items in the dictionary with  (python 2) or just  (python 3):
p40999
aVThis writes four columns, with 2 separate columns for the latitude and longitude
p41000
aVIf you want to combine those into one column, say, as  a string with a slash between the two coordinates, just use string formatting:
p41001
as(dp41002
g16
V100297
p41003
stp41004
a((dp41005
g2
(lp41006
VFactorials get large real fast:
p41007
aVNote the ; the factorial of 170 is still convertable to a float:
p41008
aVbut the next factorial is too large:
p41009
aVYou could use the  module; calculations will be slower, but the  class can handle factorials this size:
p41010
aVYou'll have to use  values throughout:
p41011
as(dp41012
g16
V100297
p41013
stp41014
a((dp41015
g2
(lp41016
VApart from being better off using the  module, what you did wrong was that you overcomplicated things
p41017
aVYou already have a list of keys to write, so just loop directly over those keys:
p41018
as(dp41019
g16
V100297
p41020
stp41021
a((dp41022
g2
(lp41023
VNo, you can only specify the metaclass per class or per module
p41024
aVYou cannot set it for the whole package
p41025
aVIn Python 3
p41026
aV1 and onwards, you can intercept the  hook and insert a metaclass programatically, see Overriding the default type() metaclass before Python runs
p41027
as(dp41028
g16
V100297
p41029
stp41030
a((dp41031
g2
(lp41032
VYou can 'monkey patch' any python class; import the class directly and add a property:
p41033
aVYou'd need to enumerate what fields you wanted to access this way:
p41034
as(dp41035
g16
V100297
p41036
stp41037
a((dp41038
g2
(lp41039
VYou included both the  (two characters) and a newline in the string:
p41040
aVReduce it to just the  part (with a newline after the second slash:
p41041
aVThere are 4 characters there
p41042
aVA backslash (doubled in the representation to make it a valid Python string), an , another backslash, and a newline
p41043
aVYou can break it down further; the backslash before the literal newline in the source creates a string with both a backslash and a newline:
p41044
aVThe raw literal  on the other hand creates a backslash and the literal character :
p41045
as(dp41046
g16
V100297
p41047
stp41048
a((dp41049
g2
(lp41050
VUse a list comprehension with ; the following presumes that a  has been predefined to enumerate what attributes you wanted to test:
p41051
aVAlternatively, if your input list is large, and you only need to access the matching elements one by one, use a generator expression:
p41052
aVor you can use the  function:
p41053
aVInstead of using a pre-defined , you could test all the attributes with the  function; this presumes that all instance attributes need to be tested:
p41054
as(dp41055
g16
V100297
p41056
stp41057
a((dp41058
g2
(lp41059
VUse  to write double precision floats:
p41060
aVis single precision only
p41061
aVSee the Format characters section of the  module documentation:
p41062
aVFor the  and  conversion codes, the packed representation uses the IEEE 754 binary32 (for ) or binary64 (for ) format, regardless of the floating-point format used by the platform
p41063
as(dp41064
g16
V100297
p41065
stp41066
a((dp41067
g2
(lp41068
VEnsure that your process has access to the TEMP directory
p41069
aVFrom the SQLite's Use Of Temporary Disk Files documentation:
p41070
aVSQLite may make use of transient indices to implement SQL language
p41071
aVfeatures such as:
p41072
aVAn ORDER BY or GROUP BY clause
p41073
aVThe DISTINCT keyword in an aggregate query
p41074
aVCompound SELECT statements joined by UNION, EXCEPT, or INTERSECT
p41075
aVEach transient index is stored in its own temporary file
p41076
aVThe
p41077
aVtemporary file for a transient index is automatically deleted at the
p41078
aVend of the statement that uses it
p41079
aVYou probably can verify if temporary storage is the problem by setting the  pragma to :
p41080
aVto tell SQLite to keep the transient index for the  clause in memory
p41081
aVAlternatively, create an explicit index on the column you are grouping by to prevent the transient index from being created
p41082
as(dp41083
g16
V100297
p41084
stp41085
a((dp41086
g2
(lp41087
VThe Plone search field only uses the  index
p41088
aVThis is a full text index that most types fill with the concatenated result (a string) of all fields that should be included in the results
p41089
aVThere is a  package that makes filling the  index for dexterity types easier
p41090
aVAdd the behaviour from that package to your type:
p41091
aVthen mark your  field as part of the index:
p41092
as(dp41093
g16
V100297
p41094
stp41095
a((dp41096
g2
(lp41097
VIf you have a list of words, you'd use the  method:
p41098
aVYou can pass in a generator expression too:
p41099
aVwould split the string  into separate words on whitespace, then lowercase each word and count these
p41100
aVtakes a parameter, the maximum number of items to return:
p41101
aVDemo with a smaller set of words, limiting it to the top 3 most common words:
p41102
as(dp41103
g16
V100297
p41104
stp41105
a((dp41106
g2
(lp41107
VYou want to call  on the results, and store the whole thing in a dictionary instead of a list of lists
p41108
aVWe can also optimize the line search and record handling; I am assuming here that when we find a  entry a new record has started:
p41109
aVNow you have a list of records of the form:
p41110
aVThese can be inserted into a database with MySQLdb using  in one go:
p41111
aVThis inserts all collected records straight into the database
p41112
as(dp41113
g16
V100297
p41114
stp41115
a((dp41116
g2
(lp41117
VDon't use the  API if you can help it
p41118
aVUse the ElementTree API instead; the  documentation explicitly states that:
p41119
aVUsers who are not already proficient with the DOM should consider using the  module for their XML processing instead
p41120
aVHere is a short sample that uses the  API to access your elements:
p41121
aVThis uses an XPath expression to list all  elements that are contained inside a  element, regardless of their position in the overall XML document
p41122
aVIf all you need is the first  element, use :
p41123
aVWith the  API,  could easily be a  node instead of an  node; you always need to loop over the  sequence to find the first  match:
p41124
aVbut for your case, perhaps using  suffices:
p41125
as(dp41126
g16
V100297
p41127
stp41128
a((dp41129
g2
(lp41130
VFrom string to timestamp, use , passing the resulting  tuple to ; your timestamp uses milliseconds, not the UNIX seconds-as-floating-point value, so you need to multiply by 1000:
p41131
aVIn the other direction, use , passing in a  tuple created by , dividing the timestamp by 1000 first:
p41132
aVDemo:
p41133
as(dp41134
g16
V100297
p41135
stp41136
a((dp41137
g2
(lp41138
VThere are 2 things going on here:
p41139
aVSmall Python integers (from -5 to 256 inclusive) are interned; a literal integer is translated into the exact same object for the same number
p41140
aVFor these integers their   is going to be constant
p41141
aVThe  is only unique for the lifetime of the object; it can be reused later on for another object if the first object has been cleared again
p41142
aVYou don't store your literals anywhere, so the memory address can be reused again:
p41143
aVHere  and  are two distinct objects, but their lifetimes do not overlap
p41144
aVThe first is created, passed to the  function, then destroyed again
p41145
aVThen the second string is created, passed to  and destroyed in turn
p41146
as(dp41147
g16
V100297
p41148
stp41149
a((dp41150
g2
(lp41151
VLoop over your values and collect the Z coordinates per X, Y pair; using  makes this a little easier, setting the default to an empty  for each key:
p41152
aVNow  is a dictionary mapping  coordinates to a set of unique  values
p41153
aVFor your example input, that results in:
p41154
aVYou can now get a sorted list of levels per  pair:
p41155
aVThe  call above already printed the sets in sorted order; that is because  sorts the output of python sequences by default
p41156
as(dp41157
g16
V100297
p41158
stp41159
a((dp41160
g2
(lp41161
VUse a HTML parser
p41162
aVBeautifulSoup makes this a breaze:
p41163
aVDemo:
p41164
as(dp41165
g16
V100297
p41166
stp41167
a((dp41168
g2
(lp41169
VTwo options:
p41170
aVCreate a new list with a list comprehension:
p41171
aVThis will be all the faster if  was a :
p41172
aVbecause membership testing in a set is O(1) vs
p41173
aVO(n) in a list
p41174
aVRemove the indices in reverse-sorted order from the list in-place:
p41175
aVIf you don't remove items in reverse sorted order, items with higher indices are moved up as items with lower indices are removed and the rest of your  no longer match the items you needed to remove
p41176
as(dp41177
g16
V100297
p41178
stp41179
a((dp41180
g2
(lp41181
VSubmodules are not automatically attributes of a package until imported
p41182
aVYou need to import  first before  works
p41183
aVYou can do this in the  file:
p41184
as(dp41185
g16
V100297
p41186
stp41187
a((dp41188
g2
(lp41189
VYou need to reference the exception correctly
p41190
aVEither import the exception directly into your module, or use the full reference:
p41191
aVor
p41192
as(dp41193
g16
V100297
p41194
stp41195
a((dp41196
g2
(lp41197
VYou are looking for a sliding window generator instead:
p41198
aVwhich gives:
p41199
aVYou are not creating python s here, you need to be careful with your terminology
p41200
aVSpecifically, you are not testing when the second index reaches the end of the list:
p41201
aVwhich works:
p41202
as(dp41203
g16
V100297
p41204
stp41205
a((dp41206
g2
(lp41207
VUse a list comprehension with a nested generator expression to pick the first non- element, together with :
p41208
aVDemo:
p41209
aVThe  call expression will pick the first element that is not equal to , falling back to  if no such element exists
p41210
as(dp41211
g16
V100297
p41212
stp41213
a((dp41214
g2
(lp41215
VYou are looping over the keys of a dictionary, you should not try to pass in a key in the loop statement:
p41216
aVIt is unclear what you are trying to do with that loop
p41217
aVYou are then accessing  without doing anything with the return value, then you are replacing the value with  (which doesn't exist on , that is still the library), then you return something completely different as the  result
p41218
aVI think you want to create a list of your library books here:
p41219
aVNow you return a comma-separated list of all titles and authors in your collection
p41220
aVThere are 3 things going on there:
p41221
aVUsing a generator expression, we loop over the dictionary  method; this generates  pairs for everything in the dictionary
p41222
aVEach key and value is passed to the  method, using the string as a template to put a  dash between the title and author pairs stored in your  dictionary
p41223
aVThe whole loop is passed to the  method; this method takes all the strings from the sequence given to it and concatenates them together with  commas between them
p41224
aVNext, you are creating an empty library, then print the output of the  method; there is no need to call that explicitly,  does that for you
p41225
aVDo not create a new library, just print the one you already have:
p41226
as(dp41227
g16
V100297
p41228
stp41229
a((dp41230
g2
(lp41231
VYou are trying to assign to a global variable  without declaring it as such:
p41232
aVTry to avoid using globals, or at least encapsulate the variable as a class attribute:
p41233
aVHowever, your class instances have no state anymore, so there is no point in creating a class here
p41234
aVIt only serves to confuse your purpose
p41235
aVEither store state in instances, or use global functions (so don't use a class at all); the former is preferable to the latter
p41236
aVTransforming your setup to a class whose instances hold state, using proper PEP-8 styleguide naming and string formatting:
p41237
aVYou are then free to create one instance and use that as a global if needs be:
p41238
aVOther code just uses , but the state is encapsulated in one instance
p41239
as(dp41240
g16
V100297
p41241
stp41242
a((dp41243
g2
(lp41244
VYou don't need ; you want to use  to collect series of  pairs keyed by label:
p41245
aVNow  is a dictionary with labels as keys, and a list of  pairs as values; I've stripped off whitespace (your input sample has a lot of extra whitespace) and turned the  column into floats
p41246
aVFor your (limited) input sample that results in:
p41247
as(dp41248
g16
V100297
p41249
stp41250
a((dp41251
g2
(lp41252
VYou are creating new  instances in  but never return these
p41253
aVThe  variable in  then is assigned  because   never returns anything
p41254
aVReturn  from  when done:
p41255
as(dp41256
g16
V100297
p41257
stp41258
a((dp41259
g2
(lp41260
VYou want to use  (note the ), or pass in the file object instead of the result of :
p41261
aVtakes an open file object, but you were passing it a string;  takes a string
p41262
as(dp41263
g16
V100297
p41264
stp41265
a((dp41266
g2
(lp41267
VJust treat the values as integers, and use  to range over the two values
p41268
aVUse  to display it as hex:
p41269
aVIf your start and end values were entered as hexadecimal strings, use  to turn those into integers first:
p41270
as(dp41271
g16
V100297
p41272
stp41273
a((dp41274
g2
(lp41275
VJust read the whole file into a list, then use slicing to divide them into two lists:
p41276
aVYou could pair them up instead, straight from the file, with a little  magic:
p41277
aVor just turn it straight into a dictionary:
p41278
aVbut you probably need to remove newlines first:
p41279
as(dp41280
g16
V100297
p41281
stp41282
a((dp41283
g2
(lp41284
VUse a dictionary; store accounts in a  dictionary with the acount number as the key:
p41285
aVNow you can list all accounts a user has, for example:
p41286
aVetc
p41287
aVUsing local variables for a variable number of items that are all the same is never a good idea
p41288
aVIn that case use lists or dictionaries instead
p41289
as(dp41290
g16
V100297
p41291
stp41292
a((dp41293
g2
(lp41294
VUse a list comprehension:
p41295
aVThis uses slicing to remove the last element of each contained sublist
p41296
aVThe above creates a , not a ; the following would create a tuple again:
p41297
aVSlicing the sublist takes fewer opcodes than unpacking and re-packing a tuple, getting the result to you faster
p41298
aVDemo using tuples:
p41299
aVDemo using a list:
p41300
aVAnd last but not least, bytecode disassemblies for the inner loops of the list comprehensions to show that slicing uses fewer opcodes than unpacking and re-packing:
p41301
aV11 versus 14 opcodes
p41302
aVThat's one extra  and two more  opcodes, and a  opcode versus
p41303
aVThese differences make unpacking and packing quite a bit slower:
p41304
as(dp41305
g16
V100297
p41306
stp41307
a((dp41308
g2
(lp41309
VYou could use  to combine the names:
p41310
aVThis joins the names with commas between them
p41311
as(dp41312
g16
V100297
p41313
stp41314
a((dp41315
g2
(lp41316
VInstead of searching through the links one-by-one, have BeautifulSoup search for you, using a regular expression:
p41317
aVThis would find the first  link in the table of contents with the 3 characters  in the text somewhere
p41318
aVThen just print the link and text:
p41319
aVShort demo based on your sample:
p41320
aVIn BeautifulSoup version 3, the above  call returns the contained  object instead
p41321
aVTo get back to the parent  element, use the  attribute:
p41322
as(dp41323
g16
V100297
p41324
stp41325
a((dp41326
g2
(lp41327
VYou need to use a unicode value
p41328
aVUse a unicode literal with  for example:
p41329
aVThis results in:
p41330
aVYou are instead passing in cp1250-encoded bytes, which have to be decoded to Unicode, and that happens automatically with the default codec, ASCII
p41331
aVAnd that doesn't work, because your bytestring contains the byte with hex value  ( in the cp1250 encoding) and that's not a valid ASCII value
p41332
aVYou may want to read up on Python and Unicode:
p41333
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p41334
aVby Joel Spolsky
p41335
aVThe Python Unicode HOWTO
p41336
aVPragmatic Unicode by Ned Batchelder
p41337
as(dp41338
g16
V100297
p41339
stp41340
a((dp41341
g2
(lp41342
VUse a inverted character class:
p41343
aVDemo:
p41344
aVThe ,  and  classes are too wide
p41345
aVfor example matches most of what  matches, removing anything that falls in  removes too much
p41346
aVAnything that is not a digit is to be removed, but you wanted to keep letters and punctiation
p41347
aVI replaced  with a literal space and a tab, because you want to remove newlines (also whitespace), and I added  and  so that those are kept too
p41348
aVis also not needed,  is a superset of
p41349
as(dp41350
g16
V100297
p41351
stp41352
a((dp41353
g2
(lp41354
VYou can use the  constructor:
p41355
aVThis uses a generator expression that constructs  tuples, which the  constructor is happy to turn into a dictionary for you
p41356
aVDemo:
p41357
aVThe syntax you used (a dict comprehension) was not introduced until Python 2
p41358
aV7 and Python 3, see PEP 274
p41359
as(dp41360
g16
V100297
p41361
stp41362
a((dp41363
g2
(lp41364
VYou need to pass in a sequence of parameters, make it a tuple with one element:
p41365
aVPython strings are sequences too, so if  is a 5-character string, python sees a sequence of length 5
p41366
aVThe database always returns rows of columns, even for results with only one column
p41367
aVA row is essentially a Python tuple, a sequence
p41368
aVIt's the same problem as your  parameter, but in reverse
p41369
aVTake the one column out of the result row by indexing:
p41370
aVA quick demo with your sample database:
p41371
as(dp41372
g16
V100297
p41373
stp41374
a((dp41375
g2
(lp41376
VYou replaced your  attribute with the return value of , which is a
p41377
aVPresumably, before that time, it was a label, and you wanted to call  on it instead:
p41378
as(dp41379
g16
V100297
p41380
stp41381
a((dp41382
g2
(lp41383
VYou are trying to find all occurrences, but you won't find a next occurrence past the last:
p41384
aVYou'd need to set a flag to indicate that you found at least one match, because the exception is going to be thrown for any number of matches:
p41385
aVbut if you are going to scan the whole  list anyway, just use a filter:
p41386
aVIf you only need to find one match, the first, you don't need to use a loop at all:
p41387
aVas there is no need to loop over the starting position then
p41388
as(dp41389
g16
V100297
p41390
stp41391
a((dp41392
g2
(lp41393
VThe  function wasn't added until Python 2
p41394
ag5279
aVThere is a workaround, however
p41395
aVYou can call  on Python 2 iterables:
p41396
aVthrows a  and you cannot specify a default, so you need to catch  explicitly
p41397
aVYou can wrap that in your own function:
p41398
aVThis works just like the Python 2
p41399
aV6 version:
p41400
as(dp41401
g16
V100297
p41402
stp41403
a((dp41404
g2
(lp41405
VJust use the  of :
p41406
aVThe  tells  to call  on , instead of calling  on the value, see Format String syntax:
p41407
aVDemo:
p41408
as(dp41409
g16
V100297
p41410
stp41411
a((dp41412
g2
(lp41413
VThe documentation states you must define one of , , , or , but only should supply an  method
p41414
aVIn other words, the  method is optional
p41415
aVThe  implementation does not require you to specify an  method; it only tests for the , , , or  methods
p41416
aVIt supplies up to 3 missing special methods based of one of those 4
p41417
aVThe  method is optional because the base  object defines one for you; two instances are considered equal only if they are the same object;  only if  is
p41418
aVSee the  function in ; remember that the  operator in the code there is comparing pointers
p41419
as(dp41420
g16
V100297
p41421
stp41422
a((dp41423
g2
(lp41424
VYou only have 2-value tuples, so you can compare the first value against the second
p41425
aVThe list comprehension is the best option:
p41426
aVFor the general case, provided your values are all hashable, you already have the best option
p41427
aVIf you have non-hashable types you'd need to special-case the 'unique' handling already, so that is outside the scope here
p41428
as(dp41429
g16
V100297
p41430
stp41431
a((dp41432
g2
(lp41433
V gives you binary files, but the  module wants to have text-mode files instead
p41434
aVYou need to wrap the file in a  instance, and you need to figure out the encoding:
p41435
aVIt'd probably be better if you took the  parameter from the  header if provided; that is what the client tells you the character set is
p41436
aVYou cannot work around needing to know the correct encoding for the file data; you can force interpretation as ASCII, for example, by providing a  keyword as well (setting it to 'replace' or 'ignore'), but that does lead to data loss:
p41437
as(dp41438
g16
V100297
p41439
stp41440
a((dp41441
g2
(lp41442
V and  are the same list
p41443
aVCreate separate lists for each:
p41444
aVThe line  creates only one list, then assigns it to both  and :
p41445
as(dp41446
g16
V100297
p41447
stp41448
a((dp41449
g2
(lp41450
VFirst of all,  returns a  instance, not an integer
p41451
aVThe expression
p41452
aVwill always be True
p41453
aVJust use :
p41454
aVand:
p41455
aVYou need to remove the  from the print statement; the  operator acts on the string on the left hand side, but that does mean there should not be a comma in between:
p41456
aVIt looks as if you are trying to parse command line arguments
p41457
aVYou could use the  module instead for that
p41458
as(dp41459
g16
V100297
p41460
stp41461
a((dp41462
g2
(lp41463
VMake  optional:
p41464
aVThe base  class defines a  method to make the extension (C-based) type picklable and that method only expects one argument (which is ); see the  function in the C source
p41465
aVThe easiest work-around is making extra arguments optional
p41466
aVThe  method also includes any additional object attributes beyond  and  and your instances are recreated properly:
p41467
as(dp41468
g16
V100297
p41469
stp41470
a((dp41471
g2
(lp41472
VYou are wiping your changes; instead of writing out your file, you read it anew and the result is used to replace your  dictionary
p41473
aVYour  worked just fine before that, even if you can't really use  here ( does not support , only standard python literal dict notation)
p41474
aVYou can simplify your code by using the  module here:
p41475
aVYou don't need  here at all; you are only creating new dictionary for every player name anyway
p41476
as(dp41477
g16
V100297
p41478
stp41479
a((dp41480
g2
(lp41481
V already returns bytes, so you just write that directly to the file, but you have to open that file in binary mode (note the  mode used below):
p41482
aVThere is no need to call ; the  statement already takes care of that
p41483
aVTo save only the text, open the file in text mode () and specify the encoding to use on save:
p41484
aVNow Python will automatically encode the unicode text to latin-1 for you
p41485
aVWhen you see something like  instead of , then you are interpreting UTF-8 bytes as Latin-1
p41486
aVYou may want to read up on Python and Unicode:
p41487
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p41488
aVby Joel Spolsky
p41489
aVThe Python Unicode HOWTO
p41490
aVPragmatic Unicode by Ned Batchelder
p41491
as(dp41492
g16
V100297
p41493
stp41494
a((dp41495
g2
(lp41496
VUse  to generate permutations:
p41497
aVThis uses numbers from 0 to 4 as that comes more natural to Python, but the principle is the same; if you want you can use  instead to generate permutations of integers 1 through to 5, inclusive
p41498
aVNow nest your permutation loops
p41499
aVThe outer loop is for the colour choices; each number representing the colour for that house
p41500
aVTest the constraints, eliminate all that don't fit (any combo that has orange not next to green doesn't fit)
p41501
aVWhere the constraints fit, loop over permutations for the owner, eliminate those that don't fit, loop over window counts for those that do, etc
p41502
aVUse one function to test constraints, allowing for missing aspects, to keep testing simple
p41503
aVYou'll find that you can eliminate most combos very quickly very early
p41504
as(dp41505
g16
V100297
p41506
stp41507
a((dp41508
g2
(lp41509
VBeautifulSoup gives you unicode, so to write this to the file you need to encode the data:
p41510
aVDo this before passing the data to the   method
p41511
aVThere is no need to add  here because UTF-8 can encode all of Unicode
p41512
aVYour full line could be:
p41513
aVusing a list comprehension to encode each element in turn
p41514
aVIf you need to manipulate the strings first, turn the  objects to  objects first:
p41515
aVAlternatively, instead of encoding each column value, use the  class included in the  module examples section to have your data encoded automatically
p41516
aVHTML can often use characters like em-dashes or non-breaking spaces that are not encodable to ASCII, and you won't pick those out with a quick visual scan of the page
p41517
as(dp41518
g16
V100297
p41519
stp41520
a((dp41521
g2
(lp41522
VUse the  module to read and write, then just filter:
p41523
as(dp41524
g16
V100297
p41525
stp41526
a((dp41527
g2
(lp41528
VPython comes in two Unicode flavours; narrow and wide, or UCS2 and UCS4, with wide builds allowing for more Unicode character support
p41529
aVYour compiled C extension is compiled with a wide Python but you are now using a narrow Python
p41530
aVYour best bet is to remove the ZODB3 egg and have buildout recreate it
p41531
aVDelete the /home/plone/Plone/buildout-cache/eggs/ZODB3-3
p41532
aV10
p41533
aV5-py2
p41534
aV7-linux-x86_64
p41535
aVegg directory altogether
p41536
aVYou probably have to do this for more eggs that have extensions
p41537
as(dp41538
g16
V100297
p41539
stp41540
a((dp41541
g2
(lp41542
VSounds like an indentation error
p41543
aVRun  on your script to verify you didn't mix tabs and spaces
p41544
aVBest practice is to only uses spaces or tabs, not mix the two
p41545
aVMost projects and certainly the Python Style Guide PEP-8 recommend you use spaces only
p41546
as(dp41547
g16
V100297
p41548
stp41549
a((dp41550
g2
(lp41551
VDon't use  to read data, use  instead:
p41552
aVThis will read lines from the  file handle until closed, without throwing EOF exceptions
p41553
aVThe loop body won't execute at all if  starts closed
p41554
as(dp41555
g16
V100297
p41556
stp41557
a((dp41558
g2
(lp41559
VThe following line gives you what you want in as efficient a manner as possible, albeit a little verbose:
p41560
aVYou could break it down to:
p41561
aVwith a  filter removes false-y values such as  and  from the iterable
p41562
aVthe outer filter is not needed for your specific input but would remove  and  if used as keys as well
p41563
aVDuplicate values are removed
p41564
aVOrdering in Python dictionaries is arbitrary so ordering doesn't match your sample but all expected values are there
p41565
aVDemo:
p41566
as(dp41567
g16
V100297
p41568
stp41569
a((dp41570
g2
(lp41571
VJust create an empty  object:
p41572
aVand start adding elements:
p41573
aVFor XML you could start out with a XML header by using the  tree builder:
p41574
aVThis requires lxml to be installed first
p41575
aVThis sets the  flag on the  object (which can also be set manually)
p41576
as(dp41577
g16
V100297
p41578
stp41579
a((dp41580
g2
(lp41581
VYou need to look up the call stack by using :
p41582
aVor even:
p41583
as(dp41584
g16
V100297
p41585
stp41586
a((dp41587
g2
(lp41588
VYou are grouping based on sets, so use a set to detect new groups:
p41589
aVThis gives:
p41590
aVor you could cast it to a list again:
p41591
aVThis assumes that the groups are contiguous
p41592
aVIf you have disjoint groups, you need to process the whole list and loop over all groups constructed so far for each item:
p41593
as(dp41594
g16
V100297
p41595
stp41596
a((dp41597
g2
(lp41598
VI'd write it as:
p41599
aVThis writes the names as separate columns
p41600
aVIf you need them to be in one column, join them separately first, and the  will quote them to indicate they are one column:
p41601
aVUse  to manage file lifetimes; they will be closed automatically this way, whatever else happens in the code
p41602
aVUse  to write the output too, it's CSV data still
p41603
aVYou are only writing out the node ids and category names, so that is all you need to collect from the input
p41604
as(dp41605
g16
V100297
p41606
stp41607
a((dp41608
g2
(lp41609
VYou'd need to split the text into lines to print
p41610
aVIf you already have newlines in the text, split with :
p41611
aVsplits text on line separators, which can vary depending on platform
p41612
aVOtherwise you'll need to find the points where to split the text into sentences
p41613
aVUsing a regular expression would give you the most bang for the buck:
p41614
aVThis uses a look-behind assertion to make sure that the text is split on whitespace that is preceded by end-of-sentence punctuation (,  or )
p41615
aVSplitting on sentences otherwise ignores newlines:
p41616
as(dp41617
g16
V100297
p41618
stp41619
a((dp41620
g2
(lp41621
VUsually Python is installed with both the version number in the executable and a default ; just use the versioned name:
p41622
aVOnly the major and minor versions are part of the version name, not the micro version
p41623
as(dp41624
g16
V100297
p41625
stp41626
a((dp41627
g2
(lp41628
VThe headers are just another row of CSV data
p41629
aVJust write them as a new row to the output followed by the rest of the data from the input file
p41630
aVFor Python 3, use:
p41631
aVand you may have to specify an encoding for your data
p41632
as(dp41633
g16
V100297
p41634
stp41635
a((dp41636
g2
(lp41637
VUse  instead of  to generate lowercase charaters:
p41638
aVAlso writing to  directly appears to be faster, encoding yourself in python is not faster than having it all handled in the C code
p41639
aVI also use a list comprehension;  needs to scan through the input sequence twice, once to determine the length of the output, once to actually copy the input elements to output  string
p41640
aVA list comprehension then beats out the slower generator-to-list code
p41641
aVJust using  over your method of generating each character from an integer is over twice as fast:
p41642
aVYou could try and avoid the  overhead by writing individual characters directly to :
p41643
aVNext to try is to write raw bytes:
p41644
aVbut these are no improvements over  in my tests
p41645
aVNext we move to encoding the ASCII characters to bytes once, then using :
p41646
aVis a list of lowercase ASCII characters encoded to bytes, from which we random pick 1 million items, join them to into a large byte string then write that in one go to the binary stdout buffer
p41647
aVThe bytes join is just as 'slow' as the string version:
p41648
aVbut we encode 26 characters, not 1 million so the write stage is faster
p41649
as(dp41650
g16
V100297
p41651
stp41652
a((dp41653
g2
(lp41654
VYou are comparing strings and integers; turn  into an integer first before comparing:
p41655
aVIt doesn't matter that you set  to an integer for output as the  will turn it back to a string again for you
p41656
as(dp41657
g16
V100297
p41658
stp41659
a((dp41660
g2
(lp41661
VUse :
p41662
aVDemo:
p41663
aVHowever, Haidro's  solution is faster for your shorter sample:
p41664
aVbut  wins if the input gets larger:
p41665
as(dp41666
g16
V100297
p41667
stp41668
a((dp41669
g2
(lp41670
VThe input HTML is not quite conformant, so you'll have to use a different parser here
p41671
aVThe  parser handles this page correctly:
p41672
as(dp41673
g16
V100297
p41674
stp41675
a((dp41676
g2
(lp41677
VI'd use a mapping to track ids and their scores:
p41678
aVUse  instead if you are using Python 3
p41679
aVResult (ordering changed because a  has no fixed ordering):
p41680
aVThis rebuilds the dictionaries
p41681
aVIf there are other keys involved, you need to store the whole dictionary for each , not just the score:
p41682
as(dp41683
g16
V100297
p41684
stp41685
a((dp41686
g2
(lp41687
VI'd use a  to map between the two sets; the characters map one-to-one:
p41688
as(dp41689
g16
V100297
p41690
stp41691
a((dp41692
g2
(lp41693
VYou can use the  method to generate events for elements, then print out the structure yourself:
p41694
aVThis uses two-space indents to convey structure, but you can adjust that easily
p41695
aVExample output:
p41696
as(dp41697
g16
V100297
p41698
stp41699
a((dp41700
g2
(lp41701
VThe context manager is passed the exception, and can handle that exception like an  block in a   combo can
p41702
aVAdding a  suite to the  block would confuse matters; the responsibility would then be split between the context manager and that block
p41703
as(dp41704
g16
V100297
p41705
stp41706
a((dp41707
g2
(lp41708
VMethods are attributes too
p41709
aVThey are just callable attributes
p41710
aVYou can test if something is callable using the builtin  function:
p41711
as(dp41712
g16
V100297
p41713
stp41714
a((dp41715
g2
(lp41716
V does nothing more than:
p41717
aVwhere  and  default to  and  respectively
p41718
aVIf you have an object already, you can get the same effect with:
p41719
aVor
p41720
as(dp41721
g16
V100297
p41722
stp41723
a((dp41724
g2
(lp41725
VUse two list comprehensions to build new tuples from the old:
p41726
aVDemo:
p41727
as(dp41728
g16
V100297
p41729
stp41730
a((dp41731
g2
(lp41732
VYou cannot mix statements (like  in Python 2) with a list comprehension
p41733
aVHowever, you can make  a function by adding:
p41734
aVat the top of your file
p41735
aVThis turns  into a function for the whole module
p41736
aVHowever, you are using the statement  and that will never evaluate 'something' because Python boolean expressions short-circuit
p41737
aVYou want to turn that around:
p41738
aVThere is no point in evaluating the right-hand side of a  expression if the left-hand side already evaluated to ; nothing the right-hand side can come up with will make the whole expression , ever
p41739
aVYou really want to avoid such side effects in a list comprehension though
p41740
aVUse a proper loop and keep such surprises out of your code, using  is really a hack that will confuse future maintainers of your code (including you)
p41741
as(dp41742
g16
V100297
p41743
stp41744
a((dp41745
g2
(lp41746
VThe code you link to is not Python 3 compatible
p41747
aVYou are trying to send Unicode strings to a socket, which expects  instead
p41748
aVThe code also uses  which was renamed to  in Python 3
p41749
aVUse Python 2 to run that code instead
p41750
as(dp41751
g16
V100297
p41752
stp41753
a((dp41754
g2
(lp41755
VYou are making things too complicated for yourself
p41756
aVZip the  and  lists, then use :
p41757
aVpairs up each  string with each  string, then we use each pair to create a full timestamp string, to be parsed by the  method
p41758
as(dp41759
g16
V100297
p41760
stp41761
a((dp41762
g2
(lp41763
VJust add a literal string to your row:
p41764
as(dp41765
g16
V100297
p41766
stp41767
a((dp41768
g2
(lp41769
VYou can use a  to 'group' rows by a key:
p41770
aVNow  is a dictionary with the first column as key, and the values are lists of rows that all have the same first column
p41771
aVYou could do the summing in-place:
p41772
aVwhere  can be any expression
p41773
aVNow  maps species named in the first column to the sum calculated for that species
p41774
as(dp41775
g16
V100297
p41776
stp41777
a((dp41778
g2
(lp41779
VInstead of using , open the file directly yourself:
p41780
as(dp41781
g16
V100297
p41782
stp41783
a((dp41784
g2
(lp41785
VYou use  instead of :
p41786
aVThis tells the database to update the  and  columns with new values, for all rows where  matches your specified value
p41787
aVAlternatively, use the  syntax; if a uniqueness constraint (such as the primary key not being unique) is violated, an  is issued instead, but if  is not yet present a new row will be inserted:
p41788
as(dp41789
g16
V100297
p41790
stp41791
a((dp41792
g2
(lp41793
VUse the  factory to add new elements, it's much easier to use:
p41794
aVwhere I assume that the columns 1 - 3 are the drug id, dose and unit, adjust as required for your CSV file
p41795
aVCalling  creates the element, adds it to the parent and returns the newly created element for further processing
p41796
as(dp41797
g16
V100297
p41798
stp41799
a((dp41800
g2
(lp41801
VDifferent HTML parsers deal differently with broken HTML
p41802
aVThat page serves broken HTML, and the  parser is not dealing very well with it:
p41803
aVThe standard library  has less trouble with this specific page:
p41804
aVTranslating that to your specific code sample using , you would specify the parser thus:
p41805
as(dp41806
g16
V100297
p41807
stp41808
a((dp41809
g2
(lp41810
VUse a translation table:
p41811
aVThe  method takes a mapping from codepoint (a number) to replacement character
p41812
aVThe  function gives us a codepoint for a given character, making it easy to build your map
p41813
aVDemo:
p41814
as(dp41815
g16
V100297
p41816
stp41817
a((dp41818
g2
(lp41819
VUse  instead of nested loops if both  and  are lists:
p41820
as(dp41821
g16
V100297
p41822
stp41823
a((dp41824
g2
(lp41825
VC extensions cannot be loaded from  libraries
p41826
aVThis is a limitation outside of Python's control
p41827
aVThis already applied to  support:
p41828
aVAny files may be present in the ZIP archive, but only files
p41829
aVpy and
p41830
aVpy[co] are available for import
p41831
aVZIP import of dynamic modules (
p41832
aVpyd,
p41833
aVso) is disallowed
p41834
as(dp41835
g16
V100297
p41836
stp41837
a((dp41838
g2
(lp41839
VYour  class only matches one character, not the 8 that are there; add a quantifier:
p41840
aVThis presumes that you have each time entry on a separate line; add the  flag if your log text comprises of multiple lines at a time
p41841
aVA demo using the  flag with  on your input example:
p41842
as(dp41843
g16
V100297
p41844
stp41845
a((dp41846
g2
(lp41847
VWhen parsing just a time (no date), you need to re-combine the resulting object with today's date:
p41848
aVIf you do not do that, you end up with the date  on the object, but recombining it makes it easier to compare the time to the current time
p41849
aVJust use  to compare that with:
p41850
aVnow you have a  object
p41851
aVCompare it with another :
p41852
as(dp41853
g16
V100297
p41854
stp41855
a((dp41856
g2
(lp41857
VYou are removing items from a list while iterating, if you remove the first item then the second item's index changes
p41858
aVUse a list comprehension instead:
p41859
as(dp41860
g16
V100297
p41861
stp41862
a((dp41863
g2
(lp41864
VThere is no difference between  and  apart from a little indirection (the lambda adds an extra layer)
p41865
aVcreates numbers, then takes the  of those
p41866
aVand  take the  of the list, but  tells  how to determine relative values for each item in the list
p41867
aVThe  function augments the items in the list
p41868
aVSee it as creating tuples; you take the max from  then unwrap the tuples again, as if you did
p41869
aVFor your  version, you instead replace the elements
p41870
as(dp41871
g16
V100297
p41872
stp41873
a((dp41874
g2
(lp41875
VInstead of requiring a specific inheritance order, provide a  that uses the right order instead:
p41876
aVYou can verify base classes with a metaclass, but that is overkill when a simple base class will do
p41877
aVA metaclass on  would be called for subclasses of  as well, then you simply test the  parameter for the right orderings
p41878
as(dp41879
g16
V100297
p41880
stp41881
a((dp41882
g2
(lp41883
VThe underlying  library logs all new connections and URLs with the  module, but not  bodies
p41884
aVFor  requests this should be enough:
p41885
aVwhich gives you the most verbose logging option; see the logging HOWTO for more details on how to configure logging levels and destinations
p41886
aVShort demo:
p41887
aVThe following messages are logged:
p41888
aV: New connections (HTTP or HTTPS)
p41889
aV: Dropped connections
p41890
aV: Redirects
p41891
aV: Connection pool full (if this happens often increase the connection pool size)
p41892
aV: Retrying the connection
p41893
aV: Connection details: method, path, HTTP version, status code and response length
p41894
as(dp41895
g16
V100297
p41896
stp41897
a((dp41898
g2
(lp41899
VUnescape before inserting:
p41900
aVThe escaping takes place when writing and cannot be disabled, nor should it be
p41901
aVSometimes you want to include literal  text in your XML, and that should be escaped properly for you if you do
p41902
aVIf your input is XML escaped, simply unescape it before inserting
p41903
as(dp41904
g16
V100297
p41905
stp41906
a((dp41907
g2
(lp41908
VYou can hack into the  hooks system instead, then use that to track responses and their requests:
p41909
aVThe  function is called for each and every request created, and by injecting your own  event hook you get to see each and every response received
p41910
aVResponses have a  attribute, which is a  instance, on which you'll find the  and  attributes for your inspection
p41911
as(dp41912
g16
V100297
p41913
stp41914
a((dp41915
g2
(lp41916
VYour error indicates you have an error in the string template, you are missing a :
p41917
aVshould be
p41918
aVHovever, now you are trying to compare a  value with a string:
p41919
aVThat will throw a :
p41920
aVDon't do that
p41921
aVCompare floats to floats, use  to create rounded values:
p41922
as(dp41923
g16
V100297
p41924
stp41925
a((dp41926
g2
(lp41927
VYou want to slice the list (to ignore the first row), then use a list comprehension to pick out just the first element of each nested list:
p41928
as(dp41929
g16
V100297
p41930
stp41931
a((dp41932
g2
(lp41933
VThe body of a class is executed when the class is defined
p41934
aVThus, the following always prints  when python loads the file:
p41935
aVPython has to create a class definition named , and to do that it executes the body of the class as if it were a function
p41936
aVThe local names from that function then form the class body
p41937
aVThis happens regardless of you then replacing the name with another function
p41938
aVIt is also run only once; if a module has been imported before the top-level code is not executed again
p41939
as(dp41940
g16
V100297
p41941
stp41942
a((dp41943
g2
(lp41944
VYou are looking for the  function instead:
p41945
as(dp41946
g16
V100297
p41947
stp41948
a((dp41949
g2
(lp41950
VYou need to restrict editing to the  role if you only want to have users edit their own content
p41951
as(dp41952
g16
V100297
p41953
stp41954
a((dp41955
g2
(lp41956
VThe python random number generator generates pseudo-random numbers using a deterministic algorithm, based of of the seed
p41957
aVThis means that if you set the seed to a fixed value, you can predict what numbers the module will generate:
p41958
aVNote how the 3 'random' numbers are repeated after I reset the seed back to
p41959
aVThus, if you set the seed in your doctest, you can predict exactly what random numbers will be used for your module-under-test
p41960
as(dp41961
g16
V100297
p41962
stp41963
a((dp41964
g2
(lp41965
VList comprehensions are more compact and faster than an explicit  loop building a list:
p41966
aVThis is because calling  on a  causes the list object to grow (in chunks) to make space for new elements individually, while the list comprehension gathers all elements first before creating the  to fit the elements in one go:
p41967
as(dp41968
g16
V100297
p41969
stp41970
a((dp41971
g2
(lp41972
VYou are using float division, which cannot handle large numbers with as much precision, after which you are flooring the result by casting it back to an
p41973
aVDon't do that, that causes data loss
p41974
aVUse integer (floor) division with  instead:
p41975
aVThis still can lead to rounding errors of course, if the input value is not divisible by 2 without flooring:
p41976
aVbut floating point values are limited in precision based on your exact CPU support; see  to see what exact limitations your platform imposes on float numbers
p41977
aVOn my Mac,  tells me my platform supports 15 digits of precision, but you are dividing a 46-digit integer number
p41978
aVThis means that you throw away the bottom 30 digits from your large integer when using float division:
p41979
aVThat is a lot of precision loss there
p41980
aV:-)
p41981
as(dp41982
g16
V100297
p41983
stp41984
a((dp41985
g2
(lp41986
VYou are listing subscribers
p41987
aVSubscribers are notified of all things that implement the interface(s) they are interested in
p41988
aVis a subclass of , so the  subscriber is interested, and will be notified
p41989
aVThe fact that  implements a little more is of no concern to the  subscriber, as the object will implement at least the  interface
p41990
aVSubscribers are generic, they just want objects that implement their interface or subclasses thereof
p41991
aVAdapters are more specific:
p41992
aVenumerates all registered adapters, together with their names:
p41993
as(dp41994
g16
V100297
p41995
stp41996
a((dp41997
g2
(lp41998
VUse  instead, specifying a size:
p41999
aVNow  contains 3 randomized lists, picked from , with 3, 20 and 100 elements respectively
p42000
aVIf you need a number of shuffled lists with the same length and elements as , use  still:
p42001
aVNow  consists of 3 lists of 100 elements, each a shuffled copy of
p42002
aVFrom the  documentation:
p42003
aVReturns a new list containing elements from the population while leaving the original population unchanged
p42004
aVThe resulting list is in selection order so that all sub-slices will also be valid random samples
p42005
as(dp42006
g16
V100297
p42007
stp42008
a((dp42009
g2
(lp42010
VUse  to store functions with their arguments:
p42011
aVCalling  results in  being called
p42012
as(dp42013
g16
V100297
p42014
stp42015
a((dp42016
g2
(lp42017
VUse tuple slicing:
p42018
aVThere is no need to build a completely new tuple from individual elements here
p42019
as(dp42020
g16
V100297
p42021
stp42022
a((dp42023
g2
(lp42024
VYou called  with a value of :
p42025
aVand  must have been defined already and set to
p42026
aVHad you run this code in a new interpreter, or executed  first, Python would have raised a  exception instead:
p42027
aVThe  part is executed before the  method is executed
p42028
aVThe  name used in the generator expression inside the  method has nothing to do with the  name used in the  call
p42029
aVIn Python 2
p42030
aV7 and earlier, list comprehension variables 'leak' to the parent scope:
p42031
aVAs such,  was set in your previous loop, and the last value assigned to it is
p42032
aVIf you wanted to 'invert' a dictionary by collecting a list of keys for each value, use:
p42033
aVIf you must insist on a one-liner, use  and sorting:
p42034
aVThis is going to be slower, as you need to sort the dictionary items first (cost O(n log n)) before looping over the sorted results (itself O(n), so a total of O(n) + O(n log n)), as opposed to a simple O(n) complexity of using  and a  loop
p42035
as(dp42036
g16
V100297
p42037
stp42038
a((dp42039
g2
(lp42040
VYou test for the surname on every row, then print  for every row that doesn't match
p42041
aVBreak out of the loop when you find the name, and use the  suite for the  loop instead:
p42042
aVon a  loop only is executed if you exhausted the iterable, so when you did not break out of the loop early
p42043
aVYour surnames are the first value on the line, so you would be better off testing if the line starts with the surname:
p42044
aVPro tip: when reading CSV files, use the  module:
p42045
as(dp42046
g16
V100297
p42047
stp42048
a((dp42049
g2
(lp42050
VUse  if you expect a string:
p42051
aVinterprets the input as if it is Python code; enter  and it'll return an integer, enter  (with quotes) and it'll return a string
p42052
aVon the other hand returns the entered input uninterpreted
p42053
as(dp42054
g16
V100297
p42055
stp42056
a((dp42057
g2
(lp42058
VUse  if you want letters to repeat:
p42059
aVand  are not the correct tools for your job
p42060
as(dp42061
g16
V100297
p42062
stp42063
a((dp42064
g2
(lp42065
VBeautifulSoup's  method returns a  object, which is a specialized kind of list
p42066
aVYou have 0 or more matches, and you need to either loop over that result set or use indexing to get at individual elements contained in the result set:
p42067
as(dp42068
g16
V100297
p42069
stp42070
a((dp42071
g2
(lp42072
VOnly imported modules get a byte-code cache, a  file
p42073
aVFor the main script file, the one you run first, no byte cache file is created
p42074
aVBytecode cache files are only created if Python has write access to the file system
p42075
aVFor Python 3
p42076
aV2 newer, these bytecode files have been moved to a subdirectory called , see PEP 3147
p42077
aVIf you do not see a  file for your python code, check that you:
p42078
aVyou are dealing with a module, not the main script
p42079
aVPython has write access to the filesystem
p42080
aVfor Python 3
p42081
aV2 or newer, that you didn't miss out on the  directory
p42082
aVthat you didn't run Python with the  command line switch disabling bytecode cache writing
p42083
as(dp42084
g16
V100297
p42085
stp42086
a((dp42087
g2
(lp42088
VWhen the interpreter exits, the  reference is removed before the  instance is reaped
p42089
aVAs a result,  is now `None
p42090
aVOne workaround would be to use  instead of a direct reference to the class name, but that would make the count per class, so  would have it's own counter:
p42091
aVThe other alternative is to check if  still exists when  is invoked; simply catch the exception:
p42092
as(dp42093
g16
V100297
p42094
stp42095
a((dp42096
g2
(lp42097
VTo make that fit in a  you'd have to make it one expression
p42098
aVA list comprehension can do that:
p42099
aVCall this with :
p42100
as(dp42101
g16
V100297
p42102
stp42103
a((dp42104
g2
(lp42105
VTo use ODP data, you'd download the RDF data dump
p42106
aVRDF is a XML format; you'd index that dump to map urls to descriptions; I'd use a SQL database for this
p42107
aVNote that URLs can be present in multiple locations in the dump
p42108
aVStack Overflow is listed at twice, for example
p42109
aVGoogle uses the text from this entry as the site description, Bing uses this one instead
p42110
aVThe data dump is of course rather large
p42111
aVUse sensible tools such as the ElementTree  method to parse the data set iteratively as you add entries to your database
p42112
aVYou really only need to look for the  elements, taking the  and  entries underneath
p42113
aVUsing  (a faster and more complete ElementTree implementation) that'd look like:
p42114
as(dp42115
g16
V100297
p42116
stp42117
a((dp42118
g2
(lp42119
VYou need to double the outer braces; otherwise Python thinks  is a reference too:
p42120
aVResult:
p42121
aVIf, indicentally, you are producing JSON output, you'd be better off using the  module:
p42122
aVNote the lowercase  in the output, as required by the JSON standard
p42123
as(dp42124
g16
V100297
p42125
stp42126
a((dp42127
g2
(lp42128
VYou created a recursive reference; you replaced the item at index  with a reference to whole list
p42129
aVTo display that list now, Python does not recurse into the nested reference and instead displays
p42130
aVReferencing  is the same thing as referencing , and you can do so ad infinitum:
p42131
as(dp42132
g16
V100297
p42133
stp42134
a((dp42135
g2
(lp42136
VFunctions can be defined anywhere
p42137
aVThey do not need to be defined inside classes, they can be defined inside other functions too; the are commonly referred to as nested functions in that case
p42138
aVYou cannot access the nested functions from outside the  function; they are local variables
p42139
aVThat limitation applies to all local variables in a function
p42140
aVFor example, the  name defined inside  is also not accessible outside of the function
p42141
aVThey exist only for the duration of the function local scope
p42142
aVThe function could make them available by returning the function
p42143
aVPython functions are first class objects, so you can pass them around like other values, you can assign them other names, or you can just return them
p42144
aVYou could call them helper functions if you want to; in Python you normally nested functions if you want to make use of the nested scope, referring to variables defined in a parent scope
p42145
aVDecorators often make use of this (defining configuration for a wrapper function), as do event handlers
p42146
as(dp42147
g16
V100297
p42148
stp42149
a((dp42150
g2
(lp42151
VYou are now passing in a  object, something MySQL knows nothing about
p42152
aVYou'll need to format the timestamp to a format MySQL understands
p42153
aVUnfortunately the  library doesn't do this for you
p42154
aVIt'll be easiest using the  module, but you can do this with the  module too:
p42155
aVThe  method call on the  object formats the information in such a way that MySQL will accept
p42156
aVDoing the same task with just the  module:
p42157
as(dp42158
g16
V100297
p42159
stp42160
a((dp42161
g2
(lp42162
VJust process the list of values as Python:
p42163
aVThis replaces each last element in the  nested lists with their integer equivalent
p42164
aVNext, use the  module to turn this into valid JavaScript:
p42165
aVJSON is a subset of JavaScript after all
p42166
aVQuick demo:
p42167
as(dp42168
g16
V100297
p42169
stp42170
a((dp42171
g2
(lp42172
VYou are altering a mutable value, so you need to make an explicit copy:
p42173
aVor
p42174
aVWhen assigning to a name in Python, all you do is store a reference to the value
p42175
aVWithout creating a copy of the list, both  and  referred to the same list
p42176
aVFor non-mutable values this is not a problem; you replace a reference to, say, a string to point to a different value instead
p42177
aVBut lists (and  and  and instances of most classes) are mutable
p42178
aVYou didn't change , you changed the value  refers to
p42179
aVYou did , which Python sees as:
p42180
aVFind the value  refers to
p42181
aVFind the attribute  on that value
p42182
aVThis returns a method on a list instance
p42183
aVCall the method, passing in the value
p42184
aVThis alters the list
p42185
aVPython names themselves are nothing more than labels, pointing to actual values
p42186
aVYou could see the values as balloons, the names as little paper tags, and assignment is the act of tying the labels to the balloons
p42187
aVcreated a second paper tag, that was tied to the exact same balloon
p42188
aVSee this older answer of mine where I push the balloon metaphor around some more
p42189
as(dp42190
g16
V100297
p42191
stp42192
a((dp42193
g2
(lp42194
VThe  method returns a special object that acts as a surrogate key:
p42195
aVWhen sorting, each key will get compared to most other keys in the sequence
p42196
aVIs this element at position 0 lower than or greater than that other object
p42197
aVWhenever that happens, the special method hooks are invoked, so  or  is called, which the surrogate key turns into a call to the  method instead
p42198
aVSo the list  is sorted as , and if, say,  is compared with  to see if  is lower, then  is called, which is translated to
p42199
aVThis is how the old  method was working anyway; return -1, 0 or 1 depending on wether the first argument is lower than, equal to or greater than the second argument
p42200
aVThe surrogate key translates those numbers back to boolean values for the comparison operators
p42201
aVAt no point does the surrogate key need to know anything about absolute positions
p42202
aVIt only needs to know about one other object it is being compared with, and the special method hooks provide that other object
p42203
as(dp42204
g16
V100297
p42205
stp42206
a((dp42207
g2
(lp42208
VThis class uses  to implement a singleton pattern
p42209
aVproduces the new instances for a class, but in this case it'll return an existing instance instead if the same name was used before
p42210
aVYou cannot do this with , because that is called after the instance has been created
p42211
aVNote that when  is ,  is called to create a new instance of the class, which is then initialized and returned
p42212
aVWhy the class checks for existing paths in the  directory is not clear, that is an application-specific check that without further context cannot readily be exposed any further
p42213
aVThe  decorator replaces a function with a python descriptor
p42214
aVWhen looking up an attribute from a class, Python will call it's  method if the attribute has one
p42215
aVThe Python expression  is translated into  by Python
p42216
aVA  object calls the wrapped function and returns the result when it's  is called
p42217
as(dp42218
g16
V100297
p42219
stp42220
a((dp42221
g2
(lp42222
VYou cannot and should not import your own module
p42223
aVYou defined  in the current namespace, just use that directly
p42224
aVYou can put the function in a separate file, then import that:
p42225
aVFile :
p42226
aVFile :
p42227
aVand run  as a script
p42228
aVIf you try to import your own module, it'll import itself again, and when you do that you import an incomplete module
p42229
aVIt won't have it's attributes set yet, so  doesn't yet exist, and that breaks
p42230
as(dp42231
g16
V100297
p42232
stp42233
a((dp42234
g2
(lp42235
VYou are using ; this returns an , not a  object
p42236
aVAbsolute paths are only supported on the latter type
p42237
aVYou have two options:
p42238
aVUse  (note, not the result of ); this returns a proper tree object
p42239
aVUse a relative XPath expression
p42240
aVSimply replace  with ; the top level element is after all the  tag, the rest is relative to that element:
p42241
as(dp42242
g16
V100297
p42243
stp42244
a((dp42245
g2
(lp42246
VYou are using a character class:
p42247
aVThese act as sets; any of the characters you name in them will match
p42248
aVYour character class will match any ,  or  character, the 3 unique characters you named in the class
p42249
aVYou didn't specify a multiplier after the  character class, so it'll match just one character:
p42250
aVRemove the class if you want to match exact characters:
p42251
aVwhich matches either the literal characters  or :
p42252
aVor, if you still want to use a character class:
p42253
aVNow the parenthesis are no longer required to group the  or operator, so you can drop those to simplify things down to:
p42254
aVDemo:
p42255
as(dp42256
g16
V100297
p42257
stp42258
a((dp42259
g2
(lp42260
VConvert the integer to a string, then the individual characters back to integers:
p42261
aVThis uses  together with a generator expression to turn all the digits back to integers, square them, and sum the results together again
p42262
aVDemo:
p42263
as(dp42264
g16
V100297
p42265
stp42266
a((dp42267
g2
(lp42268
VUse  to check for a specific type:
p42269
aVUse  to test if all elements are of a certain type:
p42270
aVshort-circuits; if any of the tests returns , the loop is terminated and  is returned
p42271
aVOnly if all but one element returns  does  need to examine every element of the iterable
p42272
as(dp42273
g16
V100297
p42274
stp42275
a((dp42276
g2
(lp42277
VYou are using ; the  method returns either the found element or  if nothing is found
p42278
aVIf you expect to find a sequence of elements, use
p42279
aVThat method always returns an iterable (possibly empty):
p42280
as(dp42281
g16
V100297
p42282
stp42283
a((dp42284
g2
(lp42285
VNo, not without creating your own custom sub-class of the  class
p42286
aVThis would require replacing internal, private methods of that class
p42287
aVThe current implementation uses this method:
p42288
aVNote the ; you'd have to provide your own version of the above method with the space replaced with an  equals sign
p42289
aVThe problem with doing this is that a future version of the  library would be perfectly within it's rights to use a different method name, breaking your custom class
p42290
as(dp42291
g16
V100297
p42292
stp42293
a((dp42294
g2
(lp42295
VA metaclass won't help here; although special methods are looked up on the type of the current object (so the class for instances),  or  are not consulted when doing so (probably because they are themselves special methods)
p42296
aVSo to catch all dunder methods, you are forced to create them all
p42297
aVYou can get a pretty decent list of all operator special methods (, , etc
p42298
aVby enumerating the  module:
p42299
aVArmed with that list a class decorator could be:
p42300
aVThen apply that to your class:
p42301
aVDemo:
p42302
aVSo, even though our class doesn't define  explicitly, we still hooked into it
p42303
as(dp42304
g16
V100297
p42305
stp42306
a((dp42307
g2
(lp42308
VYou did get unicode characters
p42309
aVHowever, Python is showing you unicode literal escapes, to make debugging easier
p42310
aVThose  values are still one-character unicoe strings though
p42311
aVTry printing the individual values in your list:
p42312
aVThe unicode escape representation is used for any codepoint outside of the printable ASCII range:
p42313
as(dp42314
g16
V100297
p42315
stp42316
a((dp42317
g2
(lp42318
VFrom the  method documentation:
p42319
aVAn empty string is returned when EOF is encountered immediately
p42320
aVYou have hit the end of the file object, there is no more data to read
p42321
aVFiles maintain a 'current position', a pointer into the file data, that starts at 0 and is incremented as you read dada
p42322
aVSee the  method to read out that position, and the  method to change it
p42323
as(dp42324
g16
V100297
p42325
stp42326
a((dp42327
g2
(lp42328
VUse  to decode the  response:
p42329
aVNow  is passed the exact same interface that it would get when opening a regular file on the filesystem in text mode
p42330
aVWith this change your example URL works for me on Python 3
p42331
ag35
aV1:
p42332
aVThe last lines appear to yield empty tuples; the original indeed has lines with nothing more than a comma on them
p42333
as(dp42334
g16
V100297
p42335
stp42336
a((dp42337
g2
(lp42338
VZODB offers full ACID compliance, it fits the reliability requirements
p42339
aVAny object that does inherit from  becomes it's own separate record (changes recorded as a unit), but you don't have to
p42340
aVUsing  is not required, but it is recommended
p42341
aVThe ZODB heavily relies on the  module, so  hooks can be used for schema upgrades
p42342
aVUse the ZODB if your data structure fits the inherent tree structure that ZODB data naturally builds
p42343
aVIndexing is an add-on operation, one that you need to handle yourself
p42344
aVZope / Plone uses events and a dedicated catalog to index interesting information from objects, then lets you efficiently find those objects again in a large hierarchy
p42345
aVIf your data is more table-like in nature (piles of different information with complex inter-relations), stick with a SQL solution
p42346
aVText / CSV / JSON / shelve / plain pickle is not going to be reliable enough
p42347
aVSQLAlchemy is easy enough to use if you know your SQL; it is an excellent ORM
p42348
aVElixir is no longer maintained, SQLAlchemy itself now offers all the functionality that project offered, natively
p42349
aVTo manage schema migrations you could look into sqlalchemy-migrate
p42350
aVFor simple projects using SQLite directly is easy enough, but migrating schema is a little more cumbersome
p42351
aVI've used the  pragma before to detect when a schema migration was needed
p42352
as(dp42353
g16
V100297
p42354
stp42355
a((dp42356
g2
(lp42357
VCreate the named tuple outside of the function:
p42358
aVNow  can find it; it is a module global now
p42359
aVWhen unpickling, all the  module has to do is locate  again
p42360
aVIn your version,  is a local, to the  function, and that is not introspectable or importable
p42361
aVIt is important to remember that  is a class factory; you give it parameters and it returns a class object for you to create instances from
p42362
aVonly stores the data contained in the instances, plus a string reference to the original class to reconstruct the instances again
p42363
as(dp42364
g16
V100297
p42365
stp42366
a((dp42367
g2
(lp42368
VIt'll be easier to get the title from the  tag:
p42369
as(dp42370
g16
V100297
p42371
stp42372
a((dp42373
g2
(lp42374
VThe problem is that  is not attached to anything normally
p42375
aVBut,  does work if you start SublimeText2 from a console:
p42376
aVOn Mac, start the application by locating the executable in the resource bundle by entering the full path in the Terminal:
p42377
aVOn Windows, start the application from the Windows Console:
p42378
aVprovisional, I have no Windows Sublime Text 2 install so this command line is based on a quick Google
p42379
aVNow the application has a console; but  is still redirected to the built-in SublimeText 2 console
p42380
aVYou want to start your debugger with the correct , the one still connected to your console
p42381
aVInstead of , use:
p42382
aVThe original console  is saved in  and by passing that to  you get a fully functional  session
p42383
as(dp42384
g16
V100297
p42385
stp42386
a((dp42387
g2
(lp42388
VYour intuition about  is correct; the  operator means in-place addition and for immutable value types such as  is exactly the same thing as
p42389
aVThe outer  loop is run through 5 times; so  is in the end set to 5 times the length of
p42390
aVYou can remove the  loop altogether
p42391
aVIt starts a loop that iterates just once; the  ends that loop during the first iteration
p42392
aVNowhere in this code is anything iterating over the full length of the  value
p42393
aVOnly it's length (12) is queried and added to , so the end value is 5 times 12 equals 60
p42394
as(dp42395
g16
V100297
p42396
stp42397
a((dp42398
g2
(lp42399
VYou cannot, at least not in Python 2
p42400
aVYou can only use ASCII letters, digits and underscores in Python names (with digits only allowed as long as they are not the first character)
p42401
aVSee the Identifiers and keywords section of the documentation:
p42402
aVPython 3 has expanded what is permissible
p42403
aVAnything that is considered a Unicode letter or digit is allowed, plus underscores (and numbers not at the start)
p42404
as(dp42405
g16
V100297
p42406
stp42407
a((dp42408
g2
(lp42409
VYou are converting values to floats correctly
p42410
aVHowever, you have at least one line where the is more than just a tab character on the line or the second value is not a float
p42411
aVTry changing your code to:
p42412
aVThis splits the line on just the last  tab character instead of on any whitespace
p42413
aVThis leaves lines that may have multiple tabs on one line intact and assumes that only the last value is a float
p42414
aVIf this still fails, the code prints out the problem line to show us what else we may need to fix
p42415
as(dp42416
g16
V100297
p42417
stp42418
a((dp42419
g2
(lp42420
VWould the following work for you:
p42421
aVThis transposes , zips the two matrices per row, then multiplies the rows per-column and sums the multiplied values, making one list of values
p42422
as(dp42423
g16
V100297
p42424
stp42425
a((dp42426
g2
(lp42427
V is defined in , not
p42428
aVYou need to import  as well
p42429
aVPerhaps use:
p42430
as(dp42431
g16
V100297
p42432
stp42433
a((dp42434
g2
(lp42435
VTwo options:
p42436
aVChoose to interpret it as JSON; that format uses the same escape codes
p42437
aVThe input does need to have quotes around it to be seen as a string
p42438
aVEncode to latin 1 (to preserve bytes), then decode with the  codec:
p42439
aVThis interprets  escape codes just like it Python would do when reading string literals in Python source code
p42440
as(dp42441
g16
V100297
p42442
stp42443
a((dp42444
g2
(lp42445
VNo, the second format is quite different
p42446
aVThe  loop calls  on the to-loop-over sequence, and uses  calls on the result
p42447
aVConsider it the equivalent of:
p42448
aVThe result of calling  on a list is a list iterator object:
p42449
aVThis object keeps a reference to the original list and keeps track of the index it is at
p42450
aVThat index starts at 0 and increments until it the list has been iterated over fully
p42451
aVDifferent objects can return different iterators with different behaviours
p42452
aVWith threading mixed in, you could end up replacing  with something else, but the iterator would still reference the old sequence
p42453
as(dp42454
g16
V100297
p42455
stp42456
a((dp42457
g2
(lp42458
VIndeed,  does not handle zip files; but it should be easy enough to replicate the behavior
p42459
aVSee the  source code; the code simply attempts to call  on the path to then discover  files:
p42460
aVwhere  is just
p42461
aVYou can replace the above  listing with a listing of  files inside of your zipfile
p42462
aVYou'll have to replicate the  behaviour as well, that function expects to be able to read the  file
p42463
aVSimplified, that function does:
p42464
aVwith exception handling mixed in
p42465
aVis , and  ensures that any path found is only added once
p42466
aVSo, in essence, all items named by  are added to your  but anything starting with  is executed there and then, giving the  file a hook into the  loading stage
p42467
aVThe  hook is used by -based packages to build the namespaced packages; here is one from a package in the  namespace:
p42468
aVIt creates an empty module object in  using the  local variable from the  function
p42469
aVNote the  call; for zipped eggs this will fail (not add the empty module object), so you may need to detect namespaced packages and come up with your own version for these
p42470
aVAny package in the  namespace just ensures there is a  object for the parent namespaces it cares about, with a  attribute pointing to
p42471
aVThe other alternative is to merge the namespaced packages into one directory structure instead
p42472
as(dp42473
g16
V100297
p42474
stp42475
a((dp42476
g2
(lp42477
VYou are looping over individual lines and it is the  statement that is adding newlines
p42478
aVThe following would work:
p42479
aVWith the trailing comma,  doesn't add a newline, and the  call removes just the trailing newline from the line
p42480
aVAlternatively, you need to pass all read and stripped lines to , not each line itself
p42481
aVStrings in python are sequences to, so the string contained in line is interpreted as separate characters when passed on it's own to
p42482
aVThe following code uses two new tricks; context managers and a list comprehension:
p42483
aVThe  statement uses the file object as a context manager, meaning the file will be automatically closed when we are done with the block indented below the  statement
p42484
aVThe  syntax generates a list from the  object where we turn each line into a version without a newline at the end
p42485
as(dp42486
g16
V100297
p42487
stp42488
a((dp42489
g2
(lp42490
VTo quote directly from the PyPI page for the package:
p42491
aVIt works using monkey-patching onto the existing API (specifically, the  and  classes)
p42492
aVIn simple terms, what the patching does is to replace the TAL interpreter class and make sure that the so-called "cooking" routine uses the Chameleon parser and compiler instead of the  reference implementation
p42493
aVSo, when you load the  package, the regular page templates code is patched to use Chameleon templates instead when templates are cooked (compiled)
p42494
aVThat really precludes enabling Chameleon and disabling Chameleon on a package-by-package basis
p42495
aVOnce any packages uses the  directive, the   file is loaded and the patch is applied
p42496
aVThat said, theoretically it should be possible to add per-package enabling or disabling back into the patch; the  and  methods of the   utility would have to be taught how to detect what package the template applies to and make a decision on what  class and page template object to use
p42497
as(dp42498
g16
V100297
p42499
stp42500
a((dp42501
g2
(lp42502
VUse the  method on strings, together with the  function:
p42503
aVreturns  for any string that consists only of digits
p42504
aVThis includes any Unicode character that is marked as a numeric digit or numeric decimal
p42505
aVloops over the sequence you pass in and returns  as soon as it finds the first element that is , and  if all elements are
p42506
aVDemo:
p42507
as(dp42508
g16
V100297
p42509
stp42510
a((dp42511
g2
(lp42512
VIf your  /  content is multilingual content managed by LinguaPlone, you can use the  add-on to create one action that'll switch between translations as needed
p42513
aVhas it's own configuration file, like  it is a Generic Setup file:
p42514
aVThe above configuration designates a content object at  as a  action item
p42515
aVIt'll be listed in that action category, taking the title and description of one of the translations of the content object matching the current language
p42516
aVYou do not list the action in  anymore; the  tool is itself a action provider
p42517
aVDisclaimer: I am the original author of
p42518
as(dp42519
g16
V100297
p42520
stp42521
a((dp42522
g2
(lp42523
VYou'd need to create a wrapper function; this is easy enough:
p42524
aVNote that  doesn't just read a file character by character until a newline is encountered; the file is read in blocks (a buffer) to improve performance
p42525
aVThe above method reads the file by lines but yields the result split on whitespace
p42526
aVUse it like:
p42527
aVBecause  is a generator, you either need to loop directly over the function result, or use the  function to get tokens one by one:
p42528
as(dp42529
g16
V100297
p42530
stp42531
a((dp42532
g2
(lp42533
VYou have defined a function that takes no parameters:
p42534
aVyet you are passing it one:
p42535
aVYou need to tell Python that the function takes one parameter here, and name it:
p42536
aVThe name used does not have to match the name that you pass in for the function call, but it does have to match what you use inside the function
p42537
aVThe following function would also work; all I did was rename the parameter:
p42538
aVThis works because the parameter  becomes a local name, local to the function
p42539
aVIt only exists inside of the function, and is gone again once the function completes
p42540
aVNote that your function creates an infinite loop; the length of  will either always be 0, or always be longer than 0
p42541
aVThe length does not change in the body of the loop
p42542
aVThe following would work better:
p42543
aVbecause then we replace  with a shorter version of itself each time
p42544
aVYour next problem is that the function doesn't return anything; Python then takes a default return value of
p42545
aVPrinting is something else entirely,  writes the data to your console or IDE, but the caller of the function does not get to read that information
p42546
aVIn this case, you really want a generator function, and use
p42547
aVGenerator functions return information in chunks; you can ask a generator for the next chunk one by one, and that  is exactly what  would do
p42548
aVChange the function to:
p42549
aVor even:
p42550
aVbecause an empty string is 'false-y' when it comes to boolean tests as used by  and
p42551
aVAs your  stands, if  yields anything that is not present as a key in , a  is produced (the default value for  if the key is not there), and  won't like that
p42552
aVThe latter method can only handle strings
p42553
aVOne option would be to return a string default instead:
p42554
aVNow , the empty string, is returned for chunks that are not present in
p42555
aVThis makes the whole script work for whatever string input you have:
p42556
as(dp42557
g16
V100297
p42558
stp42559
a((dp42560
g2
(lp42561
VNo, there isn't
p42562
aVThe pickle format does not store that information
p42563
aVIf you need that type of metadata, you need to add it to the file yourself when writing:
p42564
aVNow the first record tells you how many more are to follow
p42565
as(dp42566
g16
V100297
p42567
stp42568
a((dp42569
g2
(lp42570
VTo run arbitrary commands from a buildout script, use :
p42571
aVThe  part will now run the console script on every run ( when installing,  to signal an update on each subsequent run)
p42572
aVThis is not necessarily run all the way at the end of the buildout
p42573
aVIt is run after all the dependencies of the  section have run, but other sections can still be run after
p42574
aVIf you absolutely must run your command at the end of the buildout run, you need to create a buildout extension instead
p42575
aVExtensions can define entry points to be loaded at the start () and the end () of a buildout run
p42576
aVEither entry point is passed the  object as an argument
p42577
aVIt should be trivial to write an extension that runs your command at the very end that way
p42578
as(dp42579
g16
V100297
p42580
stp42581
a((dp42582
g2
(lp42583
VRemove the backslashes
p42584
aVThe correct syntax for keyword parameter expansions is double asterisks:
p42585
aVThis looks like a bug in the CherryPy documentation rendering
p42586
aVThe  backslash (outside string literals) is used to signal a line continuation and is only allowed at the end of a line to tell Python to ignore the newline:
p42587
aVThe syntax is not recommended (you should use parenthesis instead), but that is what Python was expecting to see here instead of a asterisk
p42588
aVQuick demo showing the exception is indeed caused by the backslashes:
p42589
as(dp42590
g16
V100297
p42591
stp42592
a((dp42593
g2
(lp42594
VYou should not encode the strings you use for attributes
p42595
aVThe  library handles those for you when writing
p42596
aVYour error is caused by mixing bytestrings with unicode data, and your encoded bytestrings are not decodable as ASCII
p42597
aVIf some of your data is encoded, and some of it is in , try to avoid that situation in the first place
p42598
aVIf you cannot avoid having to handle mixed data, do this instead:
p42599
aVNote that you don't need to use ; you can instruct  to indent your XML for you as well:
p42600
as(dp42601
g16
V100297
p42602
stp42603
a((dp42604
g2
(lp42605
VNo,  is bitwise AND, not boolean AND
p42606
aVBitwise AND works on the binary level, for each individual bit of the operand values
p42607
aVThus, with values 1 and 0 you get:
p42608
aVBut with integer values that, in binary, would comprise of multiple bits, the operator works on each bit pair instead:
p42609
aVThe expression  tests if the 5th bit is set:
p42610
aVbecause  (hexadecimal), or 16 decimal, is  in binary
p42611
aVis the 6th bit,  is the 7th, and  is the left-most or 8th bit
p42612
aVThe code is a little more verbose than needed; when testing against just one bit, the operator will either return  or the bit tested against and the  part can be dispensed with:
p42613
aVSee the Bitwise operations article on Wikipedia for the nitty-gritty details on how bitwise operations work
p42614
aVPython defines several bitwise operators:
p42615
aV: AND
p42616
aV: OR
p42617
aV: XOR
p42618
aV: left-shift
p42619
aV: right-shift
p42620
as(dp42621
g16
V100297
p42622
stp42623
a((dp42624
g2
(lp42625
VTo get all text on a line after a underscore character, split on the first  character and take the last element of the result:
p42626
aVThis will also work for lines that do not have an underscore character on the line
p42627
aVDemo:
p42628
aVTranslating this to your code:
p42629
as(dp42630
g16
V100297
p42631
stp42632
a((dp42633
g2
(lp42634
VYou are using integer (or floor) division
p42635
aVUse float division instead:
p42636
aVor
p42637
aVPython 2, when dividing two integer values, results in an integer result
p42638
aVOnly 0 times 100 fits in 50, so the result is integer , which you then cast to a float
p42639
aVIn Python 3, or when using , the  operator always uses floating point division, and a new operator  has been added that gives you floor division instead
p42640
as(dp42641
g16
V100297
p42642
stp42643
a((dp42644
g2
(lp42645
V only provides DOM interfaces, it is not a DOM implementation
p42646
aVOnly  provides an implementation;  provides a on-demand tree builder
p42647
aVNote that the ElementTree API offers a far more Pythonic API to process XML documents; unless you are married to the DOM API, you'll find the ElementTree API to be easier to use for most use cases
p42648
as(dp42649
g16
V100297
p42650
stp42651
a((dp42652
g2
(lp42653
VUse a  instance, together with some chaining:
p42654
aVThis ensures that dictionaries with more than one key in your input list are counted correctly
p42655
aVDemo:
p42656
aVor with multiple keys in the input dictionaries:
p42657
aVA  has additional, helpful functionality, such as the  method that lists elements and their counts in reverse sorted order:
p42658
as(dp42659
g16
V100297
p42660
stp42661
a((dp42662
g2
(lp42663
VUse a list, then join the individual characters together again:
p42664
aVMy version only changes characters with byte values between 97 () and 122 ()
p42665
aVturns a list of strings back into one string, with an optional delimiter text (here left empty)
p42666
aVYou can collapse this down into a list comprehension that does the same thing:
p42667
aVbut that might be less easily understood if you are just beginning with Python
p42668
aVThe  statement of the first version has been replaced with a conditional expression; the form  first evaluates , then based on the outcome returns  or
p42669
aVEither version results in:
p42670
as(dp42671
g16
V100297
p42672
stp42673
a((dp42674
g2
(lp42675
VJust use the seconds part, then update the datetime object with the microseconds part, using the  method:
p42676
aVDemo:
p42677
aVIf you did ever have to convert your  tuple to a float timestamp, just use floating-point division instead:
p42678
as(dp42679
g16
V100297
p42680
stp42681
a((dp42682
g2
(lp42683
VThe first argument to the  class method must be a string, not a cass:
p42684
aVbut you'll need to register a proxy for sets as well:
p42685
as(dp42686
g16
V100297
p42687
stp42688
a((dp42689
g2
(lp42690
VYour code is creating separate lists for each row of level of nodes, but you never need more than the previous row plus what you are generating now
p42691
aVThere is no need to keep that much information in memory, discard what you no longer need to use:
p42692
aVThis probably still won't fit in memory as you are creating items exponentially; you are creating up to 1000 * 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10 * 10 == 1000^9 == 1 trillion leaf nodes here
p42693
aVIf you can fit 1
p42694
aV1 trillion nodes in memory, the above solution should work for you, but each node takes roughly 180 bytes of memory, plus the 1
p42695
aV1 trillion bytes for the list indices to hold the references, makes for a footprint of 48 terrabytes of information
p42696
aVBefore we solve that problem, I first want to point out that I've changed a few more things:
p42697
aVThe  class is now responsible for generating new ids, a class attribute  is used instead of a global
p42698
aVI used a  class attribute to save memory overhead
p42699
aVThe  and  functions return the new set of nodes they generated instead of changing a mutable empty list you pass in
p42700
aVThe  module is used; you are writing a CSV file, using this module makes that task vastly simpler
p42701
aVThe  instance is passed to the functions as a parameter instead of the functions using the file object as a global
p42702
aVI used  instead to avoid generating 0 children at a level
p42703
aVIf you want a random depth, alter the outer loop () instead
p42704
aVIf you are not fussed about the order nodes are written to the CSV file, you can switch to using generators instead
p42705
aVThe following version writes nodes in depth first order as opposed to breath first in the first version, but uses vastly less memory:
p42706
aVThis solution only needs to keep up to 10 nodes at a time in memory, no more
p42707
aVA test run with lower  limits created half a million nodes in a fraction of a second
p42708
aVWhen the random number of children picked is closer to 10 for each depth, the generators take a little longer, but you can generate a full tree in an hour or so still
p42709
aVYour next problem will be one of disk space
p42710
aVA CSV file containing some 8 billion nodes (an average case) should take a mere 250GB of storage for example
p42711
aVBut, potentially, you can generate up to 1
p42712
aV111 trillion nodes, resulting in a 62TB CSV file
p42713
as(dp42714
g16
V100297
p42715
stp42716
a((dp42717
g2
(lp42718
VUse the  function to access arbitrary attributes from an instance
p42719
aVUse the  function to list all (inherited) attributes on a class
p42720
aVCombining these makes:
p42721
aVI used the  function here to make sure that the attribute is indeed a method
p42722
aVQuick demonstration:
p42723
as(dp42724
g16
V100297
p42725
stp42726
a((dp42727
g2
(lp42728
VUse  to do the fingerprinting
p42729
aVThe library can determine file type from bytes data only:
p42730
aVThe library provides access to the  file type identification library, which also drives the UNIX  command
p42731
as(dp42732
g16
V100297
p42733
stp42734
a((dp42735
g2
(lp42736
VYou cannot avoid a loop; a dict comprehension is the best practice for creating a dictionary from a sequence of keys with a mutable value:
p42737
aVFor Python 2
p42738
aV6 and earlier, use a generator expression and the  constructor:
p42739
aVFor completion's sake, for a default value that is not mutable,  is the better and faster alternative
p42740
as(dp42741
g16
V100297
p42742
stp42743
a((dp42744
g2
(lp42745
VYou should not encode the data by hand
p42746
aVUse the  module instead, and leave the data as Unicode:
p42747
aVThe  module will handle the encoding for you
p42748
aVYou are printing a python dictionary, not a JSON mapping, and Python uses string literal representations for the bytes in the string
p42749
aVThis representation uses  escapes to represent any non-printable character
p42750
aVSince you are printing UTF-8 data directly, the data contains many bytes that are not printable, but the data is still there:
p42751
aVIf I take your example value and use the  module on the other hand produces valid JSON output:
p42752
aVJSON allows for  escape codes, and the module uses those to represent non-ASCII and non-printable characters
p42753
aVThis is normal, a compliant JSON decoder will read this just fine
p42754
as(dp42755
g16
V100297
p42756
stp42757
a((dp42758
g2
(lp42759
VYou are using a PDB-based debugger instead of a interactive Python prompt
p42760
aVis a command in PDB
p42761
aVUse  to prevent PDB from trying to interpret the line as a command:
p42762
aVrequires that you pass it a fully qualified URL; your URL is lacking a scheme:
p42763
aVYour URL does not appear to use any international characters in the domain name, so you do not need to use IDNA encoding
p42764
aVYou may want to look into the 3rd-party  library; it makes interacting with HTTP servers that much easier and straightforward:
p42765
as(dp42766
g16
V100297
p42767
stp42768
a((dp42769
g2
(lp42770
VUse  to find multiple patterns; in this case for anything that is preceded by , consisting of word characters:
p42771
aVThe  construct is a positive lookbehind assertion; it only matches if the current position is preceded by a  character
p42772
aVSo the above pattern matches 1 or more word characters (the  character class) only if those characters were preceded by an  symbol
p42773
aVDemo:
p42774
aVIf you plan on reusing the pattern, do compile the expression first, then use the  method on the compiled regular expression object:
p42775
aVThis saves you a cache lookup every time you call
p42776
as(dp42777
g16
V100297
p42778
stp42779
a((dp42780
g2
(lp42781
VA dict comprehension can be used if both key and value have a direct one-on-one relationship with the items in the sequence
p42782
aVHowever, your output values are based on multiple entries in the input sequence
p42783
aVUnless you can group the items into a sequence per second value in the tuple key, you have to use a  setup
p42784
aVGrouping is certainly possible with  but that would require sorting, making that less performant compared to a  plus loop solution
p42785
aVUsing :
p42786
aVOutput demo:
p42787
aVThis is a O(n log n) solution, versus the O(n) complexity of a  solution:
p42788
as(dp42789
g16
V100297
p42790
stp42791
a((dp42792
g2
(lp42793
VYou can loop over the a  or  object only once; then the file pointer is at the end of the file
p42794
aVYou should probably just read all lines from the first file (the smaller one) into a list kept in memory:
p42795
aVNow you can loop over that list as many times as you need to:
p42796
aVThe alternative would be to re-open  each time inside the loop:
p42797
aVIf however you need to show matches between the two files, read the first file into a dictionary instead:
p42798
aVNow  is a dictionary mapping  keys to the row that lists that value
p42799
aVThis assumes that each row has a unique  value
p42800
aVThis will make it easy to match rows against information from the second CSV file:
p42801
as(dp42802
g16
V100297
p42803
stp42804
a((dp42805
g2
(lp42806
VYou need to name the getter too:
p42807
aVor simply
p42808
aVSee the  documentation
p42809
aVThe  decorator syntax is simply syntactic sugar; the following form:
p42810
aVis executed as:
p42811
aVNote how the  part is treated as a callable with the function being passed in as the first argument
p42812
aVA  is no different in that respect
p42813
aVAfter the first property is defined for , you have a new object  in your class namespace, the  object
p42814
aVThat object has a  method, which just returns the property with the setter replaced by the new function passed in
p42815
aVThus, the syntax  results in the  method on the existing  instance being called, and that method returns a property with it's setter being replaced
p42816
aVSo, you could also spell your explicit property creator thus:
p42817
aVYour version simply replaced the  property (defined with a getter) with one defining only a setter, the two having no relation otherwise
p42818
as(dp42819
g16
V100297
p42820
stp42821
a((dp42822
g2
(lp42823
VYou replaced your  module with the results of the  function:
p42824
aVDon't do that
p42825
aVUse a different name to store your data
p42826
aVUse  perhaps:
p42827
aVNote that the  module also has a  function (no  at the end) that takes a file-like object
p42828
aVYour  is such an object, so you can use  instead and have that read the response:
p42829
aVNote that I pass in just the handle, we don't call  anymore
p42830
as(dp42831
g16
V100297
p42832
stp42833
a((dp42834
g2
(lp42835
VYou need to make  a separate parameter, not part of the query string:
p42836
aVThat last parameter needs to be a tuple with one element, and to create one of those you need to have that one comma there too
p42837
as(dp42838
g16
V100297
p42839
stp42840
a((dp42841
g2
(lp42842
VMySQLdb overloads the Python string formatting syntax, and the  part of  is seen as a string formatting expression
p42843
aVTo prevent this you need to double the character to :
p42844
as(dp42845
g16
V100297
p42846
stp42847
a((dp42848
g2
(lp42849
VThe  handler sets the permission on the view class itself
p42850
aVThere is no central component that keeps track
p42851
aVIn Zope 2, that is delegated to the  function, which is the equivalent of adding a  object to your view class:
p42852
aVor, if making the view public () or private (), the  or  calls are used instead
p42853
aVThe class security info is translated into a  and  attributes on the class that the publisher inspects when checking permissions
p42854
aVSee the Security chapter of the Zope Secrets book for details on how those work
p42855
as(dp42856
g16
V100297
p42857
stp42858
a((dp42859
g2
(lp42860
VYou are missing a library dependency for the  module
p42861
aVOn Ubuntu, you need to install the  and  packages, then recompile () the  dependencies
p42862
as(dp42863
g16
V100297
p42864
stp42865
a((dp42866
g2
(lp42867
VThe combobox callback is handed a  object, not a unicode string
p42868
aVYour dictionary on the other hand should use  keys (which is the right thing to do)
p42869
aVConvert the  object to a unicode value first:
p42870
aVThis works because the  object already holds unicode data and provides Python with the right hooks to make this conversion without needing to re-encode the data with an explicit codec
p42871
aVOnce the  value is a unicode key, you can use it to compare it against your dictionary
p42872
aVNote that you can just define the dictionary without  calls:
p42873
aVThe  keyword has no meaning where you are using it; that keyword only makes sense inside functions, and is redundant here
p42874
as(dp42875
g16
V100297
p42876
stp42877
a((dp42878
g2
(lp42879
VSure, pass in the name of the attribute, then use the  function to get it from the individual instances:
p42880
aVCalling this with  will print the  attribute on all items listed in
p42881
aVFrom the function documentation:
p42882
aVReturn the value of the named attribute of object
p42883
aVname must be a string
p42884
aVIf the string is the name of one of the object\u2019s attributes, the result is the value of that attribute
p42885
aVFor example,  is equivalent to
p42886
as(dp42887
g16
V100297
p42888
stp42889
a((dp42890
g2
(lp42891
VYou are assigning to three different variables using unpacking
p42892
aVUnpacking has to iterate over the right-hand sequence in order to do so
p42893
aVThe  is indeed throwing the exception, because your generator expression only yields two values, the strings  and , but your left-hand side names list has 3 names
p42894
aVThis is not a problem with generators
p42895
aVThis is a restriction for tuple assignments, explicitly documented:
p42896
aVIf the target list is a comma-separated list of targets: The object must be an iterable with the same number of items as there are targets in the target list, and the items are assigned, from left to right, to the corresponding targets
p42897
aVThe same error would be thrown when using a list:
p42898
aVthrows the same exception, unless  is length 3, e
p42899
ag1298
aVYou are free to assign the generator expression to one variable:
p42900
aVIf you expected  to remain set to  because the generator doesn't provide enough values, then that is not how tuple assignment works
p42901
aVYou could use a helper function with defaults for that:
p42902
aVDemo:
p42903
aVThe helper function uses default values for all parameters, and the  call syntax uses the generator to treat these as positional parameters
p42904
as(dp42905
g16
V100297
p42906
stp42907
a((dp42908
g2
(lp42909
VPickle wants to store all the instance attributes, and  instances store a reference to the  callable
p42910
aVPickle recurses over each instance attribute
p42911
aVPickle cannot handle lambdas; pickle only ever handles data, not code, and lambdas contain code
p42912
aVFunctions can be pickled, but just like class definitions only if the function can be imported
p42913
aVA function defined at the module level can be imported
p42914
aVPickle just stores a string in that case, the full 'path' of the function to be imported and referenced when unpickling again
p42915
as(dp42916
g16
V100297
p42917
stp42918
a((dp42919
g2
(lp42920
VYour  reference in the  is a free variable, meaning it'll be resolved when  is called, not when the method is defined
p42921
aVBy the time you call that method, the name  will refer to the last class you created
p42922
aVYou either need to provide a scope that has only one unambiguous value for , or otherwise bind the reference at definition time
p42923
aVThe latter can be done by using a function parameter default:
p42924
aVYou can also use a function scope to bind the reference to a local variable in that scope:
p42925
aVHere, when  refers to , it'll be looked up in the local namespace of the  function, and there is only ever going to be one value bound to that name
p42926
as(dp42927
g16
V100297
p42928
stp42929
a((dp42930
g2
(lp42931
VThis works fine for me in Python 2
p42932
aV7, provided  is a  value:
p42933
aVYou do not have to use  here if you compare the character directly with unicode values:
p42934
aVData from an incoming request will not yet have been decoded to unicode, you'll need to do that first
p42935
aVExplicitly set the  attribute on your form tag to ensure that the browser uses the correct encoding:
p42936
aVthen decode the data on the server side:
p42937
as(dp42938
g16
V100297
p42939
stp42940
a((dp42941
g2
(lp42942
VYou need to import contained packages in the  files
p42943
aVYou can import the packages inside the  for example:
p42944
aVor you can import just each directly contained package, so in :
p42945
aVand in :
p42946
aVJust importing the top-level package does not automatically make the contained packages available
p42947
aVYou need to explicitly import the full path once, somewhere, before that works
p42948
aVThe  package imports the nested packages in the top-level
p42949
as(dp42950
g16
V100297
p42951
stp42952
a((dp42953
g2
(lp42954
VYou named the method
p42955
aVRemove the double underscores:
p42956
aVYou should really only use  "dunder" (double underscore) method names for the Special method names to avoid confusion and future name clashes
p42957
aVHowever, you are passing in a  instance, so just access the attributes directly:
p42958
aVor, further simplified, using the underscore_name style most often used in Python for methods:
p42959
aVYou can then remove the  and  methods, those look like attempts at making the  method work
p42960
aVThe full class then becomes:
p42961
aVusing a little more Python idiom for the class (inheriting from ) and the  method (using string formatting)
p42962
aVNow the class behaves as expected:
p42963
aVClass instances are not strings, and although they can be converted to strings (when printed for example), you don't need to treat them as strings
p42964
aVJust access their attributes directly
p42965
as(dp42966
g16
V100297
p42967
stp42968
a((dp42969
g2
(lp42970
VYou could just use one regular expression to split out the key=value pairs:
p42971
aVThis expression uses named groups, but you could do without those if you find it easier to read:
p42972
aVThe  group is a non-capturing group; it is only used here to demark what the  or symbol applies to
p42973
aVThe pattern matches uppercase characters before the  symbol, and anything that is not whitespace, a  or  character, provided that there is a  or the end of the string right after the value
p42974
aVThis splits out keys and values for each line:
p42975
aVThis can easily then be turned into a dictionary:
p42976
aVYou can then write these with, for example, using :
p42977
aVDemo based on your real data sample:
p42978
as(dp42979
g16
V100297
p42980
stp42981
a((dp42982
g2
(lp42983
V only gives you the names of the attributes; use the  function to retrieve the actual attribute:
p42984
aVYou might also be interested in the  module; the  function lists names plus attributes for you:
p42985
aVIn addition,  lets you filter on attribute type as well:
p42986
aVwould only show you bound methods on
p42987
as(dp42988
g16
V100297
p42989
stp42990
a((dp42991
g2
(lp42992
VThere is a carriage return character  at the end of the filename
p42993
aVThat is not a valid character for a Windows filename, so I doubt the filename will work
p42994
aVUse  to remove it:
p42995
aVremoves characters from the end of a string, and only those in the set that you name
p42996
aVSince this is a filename, any whitespace around the filename is probably incorrect, so a straight-up  would work too:
p42997
aVThis would remove tabs, newlines, carriage returns and spaces from both the start and end of the string
p42998
as(dp42999
g16
V100297
p43000
stp43001
a((dp43002
g2
(lp43003
VYou are misunderstanding how  works
p43004
aVUse:
p43005
aVinstead
p43006
aVThe expression  is interpreted as  instead, and an non-empty string is always considered
p43007
aVThus, you were in essence testing for , and then it doesn't matter anymore what  is, really
p43008
aVYou don't really need to use a  flag variable here; use  to end the loop instead:
p43009
as(dp43010
g16
V100297
p43011
stp43012
a((dp43013
g2
(lp43014
VYou could use the  module anyway to read the CSV files into memory, then transpose the rows using  or :
p43015
aVThis creates a  dictionary with the headers as keys and the columns as values
p43016
aVYou can delete the  'terms' column from the dictionary if needed
p43017
aVFor your input example, the  dictionary looks like this after executing the above code:
p43018
as(dp43019
g16
V100297
p43020
stp43021
a((dp43022
g2
(lp43023
VWhen python opens  and , it detects what encoding to use and uses text I/O to give you unicode strings
p43024
aVBut  does not (and can not) detect the encoding of the subprocess you start, so it'll return bytes
p43025
aVYou can use a  instance to wrap the  pipe to provide unicode data:
p43026
as(dp43027
g16
V100297
p43028
stp43029
a((dp43030
g2
(lp43031
VThe type is defined in the  file
p43032
aVYou can locate Python types like these by first looking for the function name in ; in this case the following line defines the  function:
p43033
aVthen grep for the  definition in the  subdirectory
p43034
as(dp43035
g16
V100297
p43036
stp43037
a((dp43038
g2
(lp43039
VIt is an issue with the fact you installed Python from source
p43040
aVYou need to install the  package to provide the headers to Python to be able to compile in zlib support:
p43041
aVYou may be missing other dependencies; here is a list of packages I'd install if I were to compile Python on an Ubuntu machine:
p43042
as(dp43043
g16
V100297
p43044
stp43045
a((dp43046
g2
(lp43047
VDon't match on whitespace, match on a word boundary instead using :
p43048
aVYou may want to restrict your characters to word characters only instead of the  wildcard, and match at least one character:
p43049
aVYou don't appear to be using the capturing group either, so you could just omit that:
p43050
as(dp43051
g16
V100297
p43052
stp43053
a((dp43054
g2
(lp43055
VUse a capturing group:
p43056
aVreturns the contents of a capturing group instead of the whole match, if there is one present in the expression
p43057
aVDemo:
p43058
aVFrom the  documentation:
p43059
aVIf one or more groups are present in the pattern, return a list of groups; this will be a list of tuples if the pattern has more than one group
p43060
aVAlternatively, you can also use a look-ahead assertion:
p43061
aVThe  positive lookahead assertion acts as an anchor; the pattern matches only if punctiation follows the matched text
p43062
aVLookaheads can give you faster results as  doesn't then have to exctract the matched groups
p43063
aVThe output of either alternative is otherwise the same
p43064
as(dp43065
g16
V100297
p43066
stp43067
a((dp43068
g2
(lp43069
VAs far as I can tell, there is no  (plural) API path, at all
p43070
aVYou use the API per shop, the  parameter gives you access to a specific shop and then you cannot access other shops nor do you need to use
p43071
aVThe Python library uses a generic base class for all resource types, and that is where the  method comes from, but that method has no meaning for shops
p43072
aVThe  returns the one shop resource that you need to care about
p43073
aVIt has an  attribute that holds all the data returned by the Shopify API; keys in that mapping also work as attributes on the main resource object:
p43074
as(dp43075
g16
V100297
p43076
stp43077
a((dp43078
g2
(lp43079
V and  change the list in place and return  See the mutable sequence documentation:
p43080
aVThe  and  methods modify the list in place for economy of space when sorting or reversing a large list
p43081
aVTo remind you that they operate by side effect, they don\u2019t return the sorted or reversed list
p43082
aVDo this instead:
p43083
aVor use the  and  functions
p43084
aVThese methods return a new list and leave the original input list untouched
p43085
aVDemo, in-place sorting and reversing:
p43086
aVAnd creating new sorted and reversed lists:
p43087
as(dp43088
g16
V100297
p43089
stp43090
a((dp43091
g2
(lp43092
VWhen using a  in a declarative table configuration, you need to specify it using the  attribute (note the underscores on both sides of the name:
p43093
aVThe attribute must be either a tuple or a dictionary
p43094
aVCreating these two tables now results in:
p43095
as(dp43096
g16
V100297
p43097
stp43098
a((dp43099
g2
(lp43100
VThe call returned the None object in that case, and not NULL, indicating that there is no exception as far as that call is concerned
p43101
aVIf whatever you called used a / handler, then the exception has already been caught and cleared; that is the purpose of such a handler
p43102
aVIf you need the exception to propagate further up the stack, re-raise it:
p43103
as(dp43104
g16
V100297
p43105
stp43106
a((dp43107
g2
(lp43108
VDon't use a regular expression
p43109
aVUse a HTML parser
p43110
aVBeautifulSoup makes the task easy:
p43111
aVIf you then need to limit the result to just Lao characters, you can further process the  variable
p43112
aVHowever, the Python  module isn't that strong (yet) when it comes to Unicode
p43113
aVYour options are to use a regular expression to just grab code points in the range 0E80\u20130EFF, use the  module and filter on the unicode codepoint name, or use the  library to only match Lao characters
p43114
aVUsing a regular expression:
p43115
aVDemo:
p43116
aVUsing the  module:
p43117
aVDemo:
p43118
aVUsing the  module:
p43119
aVDemo:
p43120
as(dp43121
g16
V100297
p43122
stp43123
a((dp43124
g2
(lp43125
VIf you want to insert values into a row, you need to pass those values along as SQL parameters to the  call:
p43126
aVThe  characters are parameters, and they are filled, in order, by values takes from the second argument to , a tuple
p43127
aVThe above code will insert the numbers 0 through to 4 as pairs into the database
p43128
aVNames in the SQL code have no correlation to names you define in Python, values can only be passed in explicitly
p43129
as(dp43130
g16
V100297
p43131
stp43132
a((dp43133
g2
(lp43134
VYou are looking at the wrong entry in the  structure
p43135
aVYou want to use the  value instead:
p43136
aVFrom the  documentation:
p43137
aV- time of most recent access,
p43138
aVNote that not all systems update the  timestamp, see Criticism of atime
p43139
aVAs of 2
p43140
ag5279
aV30, Linux kernels by default use the  setting, where  values are only updated if over 24 hours old
p43141
aVYou can alter this by setting the  option in
p43142
aVWindows Vista also disabled updates to , but you can re-enable them
p43143
as(dp43144
g16
V100297
p43145
stp43146
a((dp43147
g2
(lp43148
V returns an iterator
p43149
aVIt doesn't actually reverse anything until you loop over it
p43150
aVFrom the documentation:
p43151
aVReturn a reverse iterator
p43152
aVYou need to compare the time it takes to turn the result of  into a list again:
p43153
aVCreating just the iterator (which is nothing but a reference to the original list and a item pointer that is initialized to the length of the list) does't take any time at all
p43154
aVHaving to turn  back into a list makes it a lot slower:
p43155
as(dp43156
g16
V100297
p43157
stp43158
a((dp43159
g2
(lp43160
VIf you are caching JSON strings, you need to first decode them to python structures; there is no way for  to distinguish between normal strings and strings that are really JSON-encoded structures:
p43161
aVUnfortunately, there is no option to include already-converted JSON data in this; the  function is expected to return Python values
p43162
aVYou extract data from whatever object that is passed in and return a value that can be converted to JSON, not a value that is already JSON itself
p43163
aVThe only other approach I can see is to insert "template" values, then use string replacement techniques to manipulate the JSON output to replace the templates with your actual cached data:
p43164
aVA third option is to cache  and  in non-serialized form, as a Python structure instead of a JSON string
p43165
as(dp43166
g16
V100297
p43167
stp43168
a((dp43169
g2
(lp43170
V gives you the path to the directory as the first value in the loop, just use  to create full filename:
p43171
aVI renamed  in the loop to  to not conflict with the  variable you already were passing to
p43172
aVNote that you do not need to test if the result of ;  already does that for you, the  part is entirely redundant
p43173
aVYou can use  and a generator expression to make the above code a little more compact:
p43174
aVor even as one list comprehension:
p43175
as(dp43176
g16
V100297
p43177
stp43178
a((dp43179
g2
(lp43180
VYou are using some odd syntax here:
p43181
aVYou need to reverse the  statement there, and put these on separate lines; you have to combine the loops, which lets you simplify the  statements too:
p43182
aVYou cannot really loop over an input file twice (your second loop wouldn't do anything as the file has already been read in full)
p43183
aVNext, you want to use the open file objects context managers (using ) to make sure they are closed properly, whatever happens
p43184
aVYou can drop the  from the file modes, you are not using the files in mixed mode, and the backup copy is probably best done first before opening anything for reading and writing just yet
p43185
aVThere is no need to use a regular expression here; you are testing for the presence of a straightforward simple string,  will do, or perhaps  to make sure the line starts with
p43186
aVUse the  module to create a temporary file with a name that won't conflict:
p43187
aVYou can simplify this even further by using the  module, which lets you replace a file contents by simply printing; it supports creating a backup file natively:
p43188
aVThat's 6 lines of code (not counting imports) versus your 12
p43189
aVWe can squash this down to just 4 by using a conditional expression, but I am not sure if that makes things more readable:
p43190
as(dp43191
g16
V100297
p43192
stp43193
a((dp43194
g2
(lp43195
VThe  module offers a  function, you want to normalize to the NFC form:
p43196
aVNFC, or 'Normal Form Composed' returns composed characters, NFD, 'Normal Form Decomposed' gives you decomposed, combined characters
p43197
aVThe additional NFKC and NFKD forms deal with compatibility codepoints; e
p43198
ag1298
aVU+2160 (ROMAN NUMERAL ONE) is really just the same thing as U+0049 (LATIN CAPITAL LETTER I) but present in the Unicode standard to remain compatible with encodings that treat them separately
p43199
aVUsing either NFKC or NFKD form, in addition to composing or decomposing characters, will also replace all 'compatibility' characters with their canonical form:
p43200
aVNote that there is no guarantee that composed and decomposed forms are communicative; normalizing a combined character to NFC form, then converting the result back to NFD form does not always result in the same character sequence
p43201
aVThe Unicode standard maintains a list of exceptions; characters on this list are composable, but not decomposable back to their combined form, for various reasons
p43202
aVAlso see the documentation on the Composition Exclusion Table
p43203
as(dp43204
g16
V100297
p43205
stp43206
a((dp43207
g2
(lp43208
VUse  and a  to end the loop when a valid name has been entered:
p43209
aVThis is much easier than first initializing  to something that is invalid then using the  expression in the  test
p43210
as(dp43211
g16
V100297
p43212
stp43213
a((dp43214
g2
(lp43215
VYou are using integer literals with leading  digits, which are not allowed in Python 3
p43216
aVIn Python 2, these were interpreted as octal values:
p43217
aVbut the syntax is ambiguous and confusing to those not coming from a C background, and only the  syntax with leading  is now supported
p43218
aVThe old syntax was made a syntax error to prevent people that do know the C octal syntax from creating subtle bugs
p43219
aVBoth versions try to use the  method without an instance
p43220
aVYou want to use just  instead:
p43221
as(dp43222
g16
V100297
p43223
stp43224
a((dp43225
g2
(lp43226
VYou have indented the  function definition too far, it is part of the  function body
p43227
aVUn-indent it to match the other functions in the class body
p43228
as(dp43229
g16
V100297
p43230
stp43231
a((dp43232
g2
(lp43233
V contains the parts that are specific to Plone package development;  is generic and can be used independently of Plone
p43234
aVbuilds on top of
p43235
aVBoth packages are the new generation of test support libraries
p43236
aVis the older generation
p43237
aVIn particular, the layers support is much improved in
p43238
as(dp43239
g16
V100297
p43240
stp43241
a((dp43242
g2
(lp43243
VYou need to use  to combine the two lists:
p43244
aVcreates a new list made by combining each nth element from each input sequence:
p43245
aVYou can use  to short-circuit testing;  returns  as soon as possible
p43246
aVWe use  here instead to avoid creating a whole new list where perhaps only the first few pairs might be tested:
p43247
as(dp43248
g16
V100297
p43249
stp43250
a((dp43251
g2
(lp43252
VPip also can be configured using environment variables, which  lets you set in the configuration:
p43253
aVAlternatively, you can specify a series of index servers to use:
p43254
aVis the default index server used, but other names can be used to fetch dependencies in the  list from specific servers:
p43255
as(dp43256
g16
V100297
p43257
stp43258
a((dp43259
g2
(lp43260
VYou must be looping over the wrong data set; just loop directly over the JSON-loaded dictionary, there is no need to call  first:
p43261
aVYou may want to use  to avoid implicit conversions between Unicode and byte strings:
p43262
aVBoth versions work fine:
p43263
aVNote that in your first example,  is not a UTF-8 string; it is unicode data, the  library has already decoded it for you
p43264
aVA UTF-8 string on the other hand, is a sequence encoded bytes
p43265
aVYou may want to read up on Unicode and Python to understand the difference:
p43266
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p43267
aVby Joel Spolsky
p43268
aVThe Python Unicode HOWTO
p43269
aVPragmatic Unicode by Ned Batchelder
p43270
aVOn Python 2, your expectation that your test returns  would be correct, you are doing something else wrong:
p43271
aVThere is no need to encode the strings to UTF-8 to make comparisons; use unicode literals instead:
p43272
as(dp43273
g16
V100297
p43274
stp43275
a((dp43276
g2
(lp43277
VUse the  parameter to the  function to pick out a lowest key:
p43278
aVThe  parameter must be a callable that maps items in the input list to a value by which you want to pick the minimum item
p43279
aVIn your example,  is the lowest item because  maps it to , while  is mapped to
p43280
aVDemo:
p43281
aVIf there is any value in  that is not listed in ,  will raise a :
p43282
aVYou could also use  to get the same effect without scary direct use of dunder (double-underscore) special methods
p43283
aVIf you want to ignore non-existent keys, use:
p43284
aVis guaranteed to always be larger than any other number, so in the above example  will not be considered a minimum because it doesn't exist in
p43285
as(dp43286
g16
V100297
p43287
stp43288
a((dp43289
g2
(lp43290
VYou are setting  but never reset , so once you skipped a filename, the rest is skipped too
p43291
aVMoreover, a simple  would have sufficed, there was no need to do an explicit loop
p43292
aVHowever, you want to use a  here for fast membership testing, and you can simplify your logic in any case:
p43293
aVNext, we can get rid of the  option here, using  is going to be simpler and faster:
p43294
aVThe  can take a tuple of strings to look for; in this case your sequence of extensions
p43295
aVIf you want to only consider filenames without the extension, remove the extension before testing against :
p43296
as(dp43297
g16
V100297
p43298
stp43299
a((dp43300
g2
(lp43301
VDid you know that  can do justifying for you
p43302
aVAdding  as a formatting string tells  to left-adjust your text with spaces to fit in 6 characters:
p43303
aVYou can do the same with the rest of your table 'columns', including using variable width formatting
p43304
aVMoreover you can use descriptive naming in your format, plus use some sequence indexing to form a whole row:
p43305
aVto create a four-column formatting with the column width given as parameter
p43306
aVI made the label width variable as well, so you can later on tinker with the labels (add more, use verbose labels, etc
p43307
aVwithout breaking your layout
p43308
aVNext, group your data in dictionaries per label for easier processing:
p43309
aVNow we have the table data in a list as dictionary entries; it's easier to group them that way
p43310
aVNext we use the   recipe:
p43311
aVThis then outputs (with reconstructed  and  input):
p43312
aVThe  default makes sure that if you have one row with fewer than 4 entries in your table, the last column(s) are filled with empty strings:
p43313
as(dp43314
g16
V100297
p43315
stp43316
a((dp43317
g2
(lp43318
VUse  to unpack a list into arguments:
p43319
aVNote that this will result in string arguments;  command line entries are always strings
p43320
aVYou may want to look into the  module to handle command line arguments for you, including automatic conversion:
p43321
aVThen use:
p43322
aVThe added advantage here is that you get proper help feedback, and you follow standard command-line conventions:
p43323
as(dp43324
g16
V100297
p43325
stp43326
a((dp43327
g2
(lp43328
VUse the  module to read homogenous binary-representation numbers:
p43329
aVThe  type otherwise behaves just like a list, only the type of values it can hold is constricted (in this case to )
p43330
aVDepending on the input data, you may need to add a  call after reading to switch between little and big-endian
p43331
aVUse  to see what byteorder was used to read the data
p43332
aVIf your data was written on a platform using little-endianess, swap if your platform uses the other form, and vice-versa:
p43333
as(dp43334
g16
V100297
p43335
stp43336
a((dp43337
g2
(lp43338
VThere is little magic about how Python does this
p43339
aVSimply put, if you use more than one target name on the left-hand side, the right-hand expression must return a sequence of matching length
p43340
aVFunctions that return more than one value really just return one tuple
p43341
aVThat is a standard Python structure, a sequence of a certain length
p43342
aVYou can measure that length:
p43343
aVAssignment unpacking is determined at compile time, you cannot dynamically add more arguments on the left-hand side to suit the function you are calling
p43344
aVPython 3 lets you use a splat syntax, a wildcard, for capturing the remainder of a unpacked assignment:
p43345
aVwill now be a list with any remaining values beyond the first 2:
p43346
as(dp43347
g16
V100297
p43348
stp43349
a((dp43350
g2
(lp43351
VYou'd need to generate the sequence of halved numbers:
p43352
aVThen use turn that into a list:
p43353
aVor just directly sum it:
p43354
aVYou'd have to use  to turn that into a -suitable value:
p43355
as(dp43356
g16
V100297
p43357
stp43358
a((dp43359
g2
(lp43360
VYou are testing the length of the wrong thing
p43361
aVTest  instead:
p43362
aVis always going to be , the number of characters in the value :
p43363
as(dp43364
g16
V100297
p43365
stp43366
a((dp43367
g2
(lp43368
VUsing  turns a function into a generator
p43369
aVA generator is a specialized type of iterator
p43370
aValways loops over iterables, taking each element in turn and assigning it to the name(s) you listed
p43371
aVreturns a generator, the code inside  doesn't actually run until you start iterating over the generator
p43372
aVIterating over a generator means the code in the function is executed until it comes across a  statement, at which point the result of the expression there is returned as the next value and execution is paused again
p43373
aVThe  loop does just that, it'll call the equivalent of  on the generator, until the generator signals it is done by raising  (which happens when the function returns)
p43374
aVEach return value of  is assigned, in turn, to
p43375
aVYou can see this by creating the generator on in the Python prompt:
p43376
aVThis specific generator never returns, so  is never raised and the  loop will go on forever unless you kill the script
p43377
as(dp43378
g16
V100297
p43379
stp43380
a((dp43381
g2
(lp43382
VYou want to transform your tagnames list into a dictionary:
p43383
aVNow you can find matching tagnames much faster; your code already just made in-place changes, so I'll simplify it to:
p43384
aVThe  method returns a dictionary view object which acts like a set
p43385
aVWe intersect that set against your list of tags, resulting in a sequence of tags that are all listed in
p43386
aVBy doing this we don't have to worry about any tags that are missing from the map
p43387
aVIf you are using Python 3, then you just use  directly; in Python 3 the ,  and  methods have been changed to always return dictionary view objects
p43388
aVIf you wanted to make a copy instead, do so using :
p43389
aVcreates a shallow copy; mutable values are not copied, the new dict will just reference the same values
p43390
aVAs you are not altering values here that is fine
p43391
aVRunning this against your sample input gives:
p43392
as(dp43393
g16
V100297
p43394
stp43395
a((dp43396
g2
(lp43397
VYour  function returns early:
p43398
aVThe rest of your function is not executed
p43399
aVNext, you use functions that want to call other functions, but you never pass in the arguments
p43400
aVis not given any reference to the  function
p43401
aVInstead, you call , which returns , then pass that to , which cannot call
p43402
aVYou'll need inner wrappers to make this work the way you want to:
p43403
aVNow functions  through  each return a wrapper function to be passed into the next function, effectively making them decorators
p43404
aVWe start with  (as a function reference, not by calling it then call the result of the nested wrappers
p43405
aVThe definition of  could now also use  syntax:
p43406
as(dp43407
g16
V100297
p43408
stp43409
a((dp43410
g2
(lp43411
VI'd use a helper function:
p43412
aVThis function extracts the keys by prefix:
p43413
aVUse that function to create new dictionaries or transform the existing dictionaries in-place:
p43414
aVThis transforms your  sample input into:
p43415
as(dp43416
g16
V100297
p43417
stp43418
a((dp43419
g2
(lp43420
VYou can use the TAL repeat variable that each  loop creates:
p43421
aVor using a path expression:
p43422
aVDepending on how Chameleon was configured you can omit either the  or the  prefix; whichever one is the default expression type
p43423
aVPagetemplates default to  expressions, Chameleon to  but normally the Plone integration switches that to  to keep compatibility
p43424
aVThe  mapping contains a special object for each loop variable; your loop uses the name  so there is a  object that contains things like the loop index, the parity of the iteration (odd or even) and even roman numeral versions of the loop counter
p43425
as(dp43426
g16
V100297
p43427
stp43428
a((dp43429
g2
(lp43430
VUsing a regular expression here is overkill
p43431
aVreturns the line unchanged if the replacement text is not present at all, so there is no need to test even
p43432
aVTo replace data in a file, in place, it is easier to use the  module:
p43433
as(dp43434
g16
V100297
p43435
stp43436
a((dp43437
g2
(lp43438
VYou are missing a , registering your adapter override:
p43439
as(dp43440
g16
V100297
p43441
stp43442
a((dp43443
g2
(lp43444
VYou can reverse the sort of one of the columns if either of the columns is numeric, or can be expressed as numbers as well
p43445
aVYou can then simply negate the numeric column to reverse the sort for that column
p43446
aVIf the  column is numeric, use:
p43447
aV(using different names for the input list and the  argument reduces confusion)
p43448
aVIf that column is not numeric but the other one is, you can still use the same trick, but need to reverse the whole sort:
p43449
aVSingle-character columns can be made numeric by using the  function; using  will result in the same sorting order, but since it is numeric you can now reverse it:
p43450
as(dp43451
g16
V100297
p43452
stp43453
a((dp43454
g2
(lp43455
VIn my opinion you have two options:
p43456
aVJust try to convert it to an , but catch the exception:
p43457
aVThis is the Ask Forgiveness approach
p43458
aVExplicitly test if there are only digits in the string:
p43459
aVreturns  only if all characters in the string are digits (-)
p43460
aVThe  / Python 3  type equivalent is  / ; only Unicode decimals can be converted to integers, as not all digits have an actual integer value (U+00B2 SUPERSCRIPT 2 is a digit, but not a decimal, for example)
p43461
aVThis is often called the Ask Permission approach, or Look Before You Leap
p43462
aVThe latter will not detect all valid  values, as whitespace and  and  are also allowed in  values
p43463
aVThe first form will happily accept  as a number, the latter won't
p43464
aVIf your expect that the user normally will input an integer, use the first form
p43465
aVIt is easier (and faster) to ask for forgiveness rather than for permission in that case
p43466
as(dp43467
g16
V100297
p43468
stp43469
a((dp43470
g2
(lp43471
VThe  structure is really just a Python
p43472
aVYou can remove modules from it, and you can also put them back in
p43473
aVStore the original module object in a local variable, using  to both remove the module and return it:
p43474
aVthen, when it comes to restoring it, just put that object back into :
p43475
as(dp43476
g16
V100297
p43477
stp43478
a((dp43479
g2
(lp43480
VUse the  module, it was designed for a task like this:
p43481
aVThe above code also uses the file as a context manager (with the  statement); as soon as the  block has completed, the file is closed for you, automatically
p43482
aVIn your version, you tried to close the file manually, but only managed to reference the  method, not actually call it
p43483
aVWe also don't read all values into a list, not when you can instead just sum the values and keep a count of how many values you summed
p43484
aVThis uses much less memory and makes processing even huge CSV files fast and efficient
p43485
aVFor your sample data, the above code outputs:
p43486
aVThe average of the values is 3261
p43487
ag5740
as(dp43488
g16
V100297
p43489
stp43490
a((dp43491
g2
(lp43492
VYou cannot, without reading lines, know how many there are in the file
p43493
aVNote that the  attribute reflects the number of lines read so far, not the number of lines present in the file:
p43494
aVThe number of lines read from the source iterator
p43495
aVThis is not the same as the number of records returned, as records can span multiple lines
p43496
aVJust read your file; if there is only one row in the file, you'll end up returning early anyway
p43497
aVIf you only return  if there were no rows read, you could use:
p43498
aVIf there are no rows beyond the first header row in the file, this returns early, as the for loop immediately terminates
p43499
as(dp43500
g16
V100297
p43501
stp43502
a((dp43503
g2
(lp43504
VNothing is being converted; the Python boolean logic operators instead short circuit
p43505
aVSee the boolean operators documentation:
p43506
aVThe expression  first evaluates ; if  is false, its value is returned; otherwise,  is evaluated and the resulting value is returned
p43507
aVThe expression  first evaluates ; if  is true, its value is returned; otherwise,  is evaluated and the resulting value is returned
p43508
aVMoreover, numbers that are equal to  are considered falsey, as are empty strings and containers
p43509
aVQuoting from the same document:
p43510
aVIn the context of Boolean operations, and also when expressions are used by control flow statements, the following values are interpreted as false: , , numeric zero of all types, and empty strings and containers (including strings, tuples, lists, dictionaries, sets and frozensets)
p43511
aVCombining these two behaviours means that for , the  is considered false and returned before evaluating the  expression
p43512
aVFor the expression ,  is evaluated and found to be a true value, so  is returned
p43513
aVAs far as  and  and other boolean operators are concerned, that result,  is considered false as well
p43514
aVYou can use this to provide a default value for example:
p43515
aVTo really convert a non-boolean value into a boolean, use the  type; it uses the same rules as boolean expressions to determine the boolean value of the input:
p43516
aVTo complete the picture, values that are not considered false in a boolean context are instead considered true, including any custom classes
p43517
aVYou can change that by implementing a  special method on your class
p43518
aVIf no such method is defined,  is consulted as well
p43519
aVWith either of these methods you can signal that your type is either numeric and should be considered  if non-zero, or it is a container and should be considered  if not empty (has a length over 0)
p43520
as(dp43521
g16
V100297
p43522
stp43523
a((dp43524
g2
(lp43525
VUse a list comprehension to select just the first value; using a slice to create new tuples of length 1:
p43526
aVQuick demo to show the result of the list comprehension:
p43527
aVYou can also use a generator expression, which creates the tuple slices on the fly:
p43528
aVIt could be that not all database APIs support an iterable and instead expect to be handed something that has a length though
p43529
as(dp43530
g16
V100297
p43531
stp43532
a((dp43533
g2
(lp43534
VYou are indeed discouraged from using the  syntax inside functions, because that makes it impossible for Python to determine what the local names are for that function, breaking scoping rules
p43535
aVIn order for Python to make things work anyway, certain optimizations have to be disabled and name lookup is a lot slower as a result
p43536
aVI cannot reproduce your problem otherwise
p43537
aVImporting just  makes sure that everything defined in that module is executed so that the  class has a registry of all declarations
p43538
aVThere is no reason for that path to fail while the  declarations for  do work
p43539
aVFor the purposes of SQLAlchemy and declarative table metadata, there is no difference between the  and the  syntax; only their effect on the local namespace differs
p43540
aVIn both cases, the  top-level code is run, classes are defined, etc
p43541
aVbut in the latter case then the top-level names from the module are added to the local namespace as direct references, as opposed to just a reference to the module object being added
p43542
as(dp43543
g16
V100297
p43544
stp43545
a((dp43546
g2
(lp43547
VThe most efficient way to find what elements in the list are in a dictionary, is to use dictionary views:
p43548
aVA dictionary view such as returned by  is essentially a set, and by using  we take the intersection of that set and the list
p43549
aVThe  syntax, using in-place OR, updates the set to add any elements found in the right-hand side not yet in the set
p43550
aVAlternatively, you could use the  method
p43551
aVThe  method takes one element at a time instead, but you wanted to add all elements in the list to the set, not the list itself
p43552
aVDemo:
p43553
as(dp43554
g16
V100297
p43555
stp43556
a((dp43557
g2
(lp43558
V removes the  tag as well; basically, whenever you do not have a HTML document (with a  top-level element and/or a doctype),  falls back to  and that method removes both the  and the  tags, always
p43559
aVThe work-around is to tell  to give you a  parent tag:
p43560
aVThis does not preserve any attributes on the original  tag
p43561
aVAnother work-around is to use the  method, which will wrap your document in a  tag, which you then can remove again:
p43562
aVThis does preserve attributes on the :
p43563
aVUsing the  function on your first example gives:
p43564
aVIf you only want to do this if there is no HTML tag, do what  does and test for a full document:
p43565
as(dp43566
g16
V100297
p43567
stp43568
a((dp43569
g2
(lp43570
VSimply print the message, then use  to end the program
p43571
aVThe  module uses a utility function (adjusted to be more or less stand-alone):
p43572
aVwhere  writes the message to the designated file object, here ; basically just using
p43573
as(dp43574
g16
V100297
p43575
stp43576
a((dp43577
g2
(lp43578
VJust add the function object to the list:
p43579
aVor use :
p43580
aVPython functions are first-class objects
p43581
aVThey are values, just like classes and strings and integers
p43582
aVIf you want to automate this for a whole module, you can use the  function to quickly list all functions defined in the module so far, with a little help from the  predicate:
p43583
aVThe  test ensures we only list functions from the current module, not anything we imported
p43584
aVHowever, explicit is still better than implicit
p43585
aVEither add  below each function, or use a decorator:
p43586
aVEach function you 'mark' with the  decorator is added to the  list
p43587
as(dp43588
g16
V100297
p43589
stp43590
a((dp43591
g2
(lp43592
VYes, it is safe from SQL injection; that is what the SQL parameter is for, to escape and quote  properly
p43593
aVIf you were to use string formatting ( or , then you'd be opening a SQL injection vector, as you wouldn't be escaping meta characters in
p43594
as(dp43595
g16
V100297
p43596
stp43597
a((dp43598
g2
(lp43599
VYou'll have to parse the strings to dates first (using the  class method, then combine with :
p43600
aVwhere  is a boolean that tells you what format to pick
p43601
aVNote the  call;  will fill in  for the time when that information is not being parsed;  gives us just the date portion
p43602
as(dp43603
g16
V100297
p43604
stp43605
a((dp43606
g2
(lp43607
VYou need to pass the SQL statement and the parameters as separate arguments:
p43608
aVor use the variable argument syntax (a splat, ):
p43609
aVYour version tries to pass in a tuple containing the SQL statement and bind parameters as the only argument, where the  function expects to find just the SQL statement string
p43610
aVIt's more usual to keep the two separate and perhaps store just the SQL statement in a variable:
p43611
as(dp43612
g16
V100297
p43613
stp43614
a((dp43615
g2
(lp43616
VYou are ignoring the  parameter and using  for all calls to :
p43617
aVThis opens the first named database twice, as both  and
p43618
aVUse  instead:
p43619
as(dp43620
g16
V100297
p43621
stp43622
a((dp43623
g2
(lp43624
VJust use :
p43625
aVThe default form of  splits on arbitrary-width whitespace, ignoring leading and trailing whitespace
p43626
aVIn the above example, the  at the end of the line is ignored
p43627
aVIf your text contains whitespace too, use  with a limit:
p43628
aVtells  (or ) to split on variable-width whitespace, and  is the maximum number of splits to make
p43629
as(dp43630
g16
V100297
p43631
stp43632
a((dp43633
g2
(lp43634
VYou are not quoting the message value here, you are generating text like
p43635
aVYou'll need to apply quoting, but to do so sanely I recommend you use JSON; that format is a subset of JavaScript and produces valid JavaScript literals
p43636
aVYou'll need to do so in your view (using ), or you could use this Django snippet and do it straight in the template (no need to call serializers
p43637
aVserialize in the annotate method):
p43638
as(dp43639
g16
V100297
p43640
stp43641
a((dp43642
g2
(lp43643
VYou have a list of dictionaries, so you'd loop over them:
p43644
aVor access individual items:
p43645
aVor use a list comprehension to extract just the hostnames:
p43646
as(dp43647
g16
V100297
p43648
stp43649
a((dp43650
g2
(lp43651
VUse the right clock for your platform; use
p43652
aVuses the same C API used by , which on Windows doesn't offer as much granularity as  offers
p43653
aVpoints to the right version for your platform to offer the best choice
p43654
as(dp43655
g16
V100297
p43656
stp43657
a((dp43658
g2
(lp43659
VThe  keyword is used by the python compiler to mark a name in the function scope as global
p43660
aVAs soon as you use it anywhere in the function, that name is no longer a local name
p43661
aVNote that  does not introduce a new scope, only functions and modules do (with classes, list, dict and set comprehensions being a special cases of function scopes)
p43662
aVA (hard to read and non-pythonic) work-around would be to use the  function:
p43663
as(dp43664
g16
V100297
p43665
stp43666
a((dp43667
g2
(lp43668
VOnce you have read a file, the file pointer has been moved to the end and no more lines will be 'found' beyond that point
p43669
aVRe-open the file or seek back to the start:
p43670
aVYour file is not closed; a closed file raises an exception when you attempt to access it:
p43671
as(dp43672
g16
V100297
p43673
stp43674
a((dp43675
g2
(lp43676
VIt is called a class attribute
p43677
aVPython doesn't distinguish between public and private; privacy is only indicated by convention, and is not enforced
p43678
aVIt is technically good practice if you need to share data among instances
p43679
aVRemember, methods are class attributes too
p43680
as(dp43681
g16
V100297
p43682
stp43683
a((dp43684
g2
(lp43685
VUse dictionary views and sets:
p43686
aVSets, like dictionaries, make membership testing cheap and fast, and set operations make it easy to test if items are present or not
p43687
aVYou really want to make  and  be sets to starts with
p43688
aVFor example, subtraction on sets calculates the difference, so  is set to the difference between the  list and what keys are in the dictionary
p43689
aVUsing the  operator on sets (normally binary AND) gives you the intersection, so  gives you what keys in the dictionary are also in the  sequence (doesn't have to be a set in this case, but using a set there would make sense)
p43690
aVFor testing individual keys you can still use , but using set operations avoids excessive looping
p43691
aVNote that  is  specific to Python (added in Python 2
p43692
aV7); in Python 3, the dictionary enumeration methods ,  and  return dictionary views by default and the  methods are gone
p43693
as(dp43694
g16
V100297
p43695
stp43696
a((dp43697
g2
(lp43698
VMake  a set and use dictionary views, and a list comprehension:
p43699
aVIn Python 3, use  and  instead
p43700
aVThis tests if there is a set intersection between the dictionary keys and the set of keys you are looking for (an efficient operation)
p43701
aVDemo:
p43702
aVNote that dictionary ordering is arbitrary (depending on the keys used and dictionary insertion and deletion history), so the output list order may differ
p43703
aVTechnically speaking, you can use your list directly too ( works) but making it a set states your intention more clearly
p43704
as(dp43705
g16
V100297
p43706
stp43707
a((dp43708
g2
(lp43709
VYour string is encoded using the Quoted-printable format for MIME headers
p43710
aVThe  module handles this for you:
p43711
aVThe subject (which is just one string with newlines and leading whitespace) spans multiple lines to fit the strict line length limitations set by the MIME standard
p43712
as(dp43713
g16
V100297
p43714
stp43715
a((dp43716
g2
(lp43717
VYou either use multiple finds, or use a regular expression and :
p43718
aVyields match objects, and we use the  method here to just pick out the start index of matches found
p43719
aVI used  to prevent regular expression meta characters in  to be interpreted to make sure the behaviour is the same as multiple  calls
p43720
aVDemo:
p43721
as(dp43722
g16
V100297
p43723
stp43724
a((dp43725
g2
(lp43726
VSimply match anything that is either followed by a word boundary, or by :
p43727
aVThis specifically only matches uppercase characters, you can expand the character class () as needed to match more as needed
p43728
aVDemo:
p43729
as(dp43730
g16
V100297
p43731
stp43732
a((dp43733
g2
(lp43734
VUse :
p43735
aVThe string on which you call this is used as the delimiter between the strings in :
p43736
aVUsing  is much faster than concatenating your elements one by one, as that has to create a new string object for every concatenation
p43737
aVonly has to create one new string object
p43738
aVNote that  will loop over the input sequence twice
p43739
aVOnce to calculate how big the output string needs to be, and once again to build it
p43740
aVAs a side-effect, that means that using a list comprehension instead of a generator expression is faster:
p43741
as(dp43742
g16
V100297
p43743
stp43744
a((dp43745
g2
(lp43746
VI think what you want, reading between the lines, is:
p43747
aVThis picks all  in  (each a list), only if there are any values in that list () where  is not 0 and  is not equal to
p43748
aVThis test could be simplified to:
p43749
as(dp43750
g16
V100297
p43751
stp43752
a((dp43753
g2
(lp43754
VUse , or simply delete  again ()
p43755
aVNo imports needed:
p43756
aVThe presence of  is a CPython implementation detail; Jython, IronPython and PyPy may opt to not make this available
p43757
aVUse the  module for those platforms, or for Python 3 compatible implementations, the  module
p43758
as(dp43759
g16
V100297
p43760
stp43761
a((dp43762
g2
(lp43763
VYou can use a  instance:
p43764
aVpairs up your two input lists
p43765
aVIt's that last call that makes the  useful here, the  call uses  internally for just one item, but for an argument greater than 1  is used, and with no argument or asking for ,  is used
p43766
as(dp43767
g16
V100297
p43768
stp43769
a((dp43770
g2
(lp43771
VYou'll need to loop over both input files first, combining the rows, writing out to a temporary file
p43772
aVThen move the temporary file back to your intended output file
p43773
aVYou don't actually have CSV data, but rather data that uses an arbitrary number of spaces as delimiters
p43774
aVYou need to handle that manually, but we'll write out using the csv module:
p43775
aVThe above code opens  for both reading and writing (mode ) to easy the copying back of the temporary file contents
p43776
aVI'm assuming that the  and  have the same number of rows; if they don't, any extra rows in either file will be ignored
p43777
aVYou can use , but you'll have to come up with a strategy deciding what to fill in for the missing rows in that case
p43778
aVYou also need to avoid using  escape sequences in your filenames
p43779
aVUse forward slashes, raw strings or double the backslashes:
p43780
aVor
p43781
aVor
p43782
aVwill all work as they avoid the backslashes being interpreted as escape sequences
p43783
as(dp43784
g16
V100297
p43785
stp43786
a((dp43787
g2
(lp43788
VYour two cases are quite different; in the first you have a callable () in the second you built a complete string
p43789
aVYou'd need to create a callable for the second option too; in this case a lambda would work:
p43790
aVThis is now a list with one callable, a  that accepts one argument , and returns the result of the full expression where  is passed to  then formatted using  then passed to
p43791
aVDemo:
p43792
as(dp43793
g16
V100297
p43794
stp43795
a((dp43796
g2
(lp43797
VYou could try to match a regular expression:
p43798
aVwould work if the line starts with 3 2-digit pairs with colons in between; depending on what else you might find in  this could easily be enough
p43799
aVAnother option would be to try and parse it:
p43800
aVThis is a lot stricter; a  is thrown whenever a line does not start with a timestamp that can actually represent a valid time value, so the hour must be in the range 0-23, minutes in the range 0-59 and seconds in the range 0-60
p43801
as(dp43802
g16
V100297
p43803
stp43804
a((dp43805
g2
(lp43806
VYou write the exact number of characters == bytes, after -ing back to your  position
p43807
aVThese then overwrite the data that was there before
p43808
aVYou can split that up into multiple writes, even writes of one character (byte) at a time if needed
p43809
as(dp43810
g16
V100297
p43811
stp43812
a((dp43813
g2
(lp43814
VThe most flexible parser is part of the  package; it eats your input for breakfast:
p43815
as(dp43816
g16
V100297
p43817
stp43818
a((dp43819
g2
(lp43820
V files are controller page templates,  files are regular page templates
p43821
aVThe former are handled by the Formcontroller tool, the latter are just normal page templates
p43822
aVThe CMFFormController framework has largely been deprecated, and is in the process of being removed from Plone
p43823
aVThe best documentation about how these work that I can still find is this 2004 Plone conference presentation (PDF)
p43824
as(dp43825
g16
V100297
p43826
stp43827
a((dp43828
g2
(lp43829
VUsing a regular expression would work:
p43830
aVDemo:
p43831
aVFor your shorter input example, the  and  list comprehension is still faster though:
p43832
aVIt improves little with longer inputs:
p43833
as(dp43834
g16
V100297
p43835
stp43836
a((dp43837
g2
(lp43838
VYou escape the  but then use the string as a formatter first:
p43839
aVthat returns a new string with the  escaped percentages replaced by single  characters
p43840
aVThe MySQL database adapter (ab)uses string formatting with  too, so it'll take that output and expect to be able to fill  slots with escaped SQL literals
p43841
aVIt is there that your  part of the SQL statement is being interpreted again as a string format and the error is thrown
p43842
aVThe solution is to either double the doubling:
p43843
aVor use  instead and avoid having to doubly-escape:
p43844
aVHere  is replaced by the table name and the  escapes are left untouched; the database adapter will use the  slot to fill in the  parameter and return a SQL statement with the  escapes turned into single  characters
p43845
as(dp43846
g16
V100297
p43847
stp43848
a((dp43849
g2
(lp43850
VNo, you cannot
p43851
aVYou can only put immutable values into a set
p43852
aVThis restriction has to do with more than just being able to compare values; you need to test both for equality and be able to obtain a hash value, and most of all the value has to remain stable
p43853
aVMutable values fail that last requirement
p43854
aVA dictionary can be made immutable by turning it into a series of key-value tuples; provided the values are immutable too, the following works:
p43855
aVThis makes it possible to test for the presence of the same dictionary by testing for  at least
p43856
aVTurning the values back into a  is a question of calling  on it:
p43857
aVDemo:
p43858
as(dp43859
g16
V100297
p43860
stp43861
a((dp43862
g2
(lp43863
VPIL does work on Python 3
p43864
aV2; install Pillow, the friendly PIL fork
p43865
aVPillow 2
p43866
ag2391
aV0 adds Python 3 support and includes many bug fixes from around the internet
p43867
as(dp43868
g16
V100297
p43869
stp43870
a((dp43871
g2
(lp43872
VJust use the standard logging module; it'll log your exceptions with the exception message out of the box
p43873
aVWhen your application catches an exception, use the  function to log it; the exception is automatically added to the log entry:
p43874
aVExceptions have a  tuple argument by default, and the first value in that tuple is your message
p43875
aVSome style feedback on your code:
p43876
aVDon't test for
p43877
aVRather, use :
p43878
aVRaise instances of your exception:
p43879
aVrather than the  style, to make it easier to move to Python 3
p43880
as(dp43881
g16
V100297
p43882
stp43883
a((dp43884
g2
(lp43885
VAre you certain that  is available when you see that error
p43886
aVCelery uses pickle by default, and that module indeed stores the the name of the module and class (together with the data contained in the class), and when loading the data again, the module and class are looked up dynamically
p43887
aVThis stage fails because the  cannot be imported
p43888
aVI must note that you are trying to send SQLAlchemy objects here, and that is very rarely a good idea
p43889
aVThe objects are tied to a specific session, and when you unpickle the objects that session will no longer be there
p43890
aVMoveover, the objects represent database state, and the database state could easily have changed by the time you load the objects again
p43891
aVYou should, instead, send object identifiers, and query for the objects again on the other side
p43892
aVInstead of a list of  objects, send the primary keys instead:
p43893
aVOn the other side, you'd then use those identifiers to load your  objects again from the database
p43894
as(dp43895
g16
V100297
p43896
stp43897
a((dp43898
g2
(lp43899
VYour query returned 0 results, so there is no first row to fetch
p43900
aVreturns an empty list in that case, and there is no item at index
p43901
aVIf you are only interested in the first result of a query, you should really use  instead:
p43902
aVeither returns the row, or  if there were no matching results
p43903
aVYou are using redundant parenthesis in your query; this is not the cause of your problem, but you can safely remove them:
p43904
aVor use a tuple:
p43905
aVYou do that in several places, you can cut out a lot of the  in your code without any effect other than improved readability
p43906
aVAdding in a test if there are results from the  call your code could be:
p43907
as(dp43908
g16
V100297
p43909
stp43910
a((dp43911
g2
(lp43912
VUse the  function to create unicode characters from a codepoint:
p43913
as(dp43914
g16
V100297
p43915
stp43916
a((dp43917
g2
(lp43918
VBuildout only takes newlines as separators when merging  and  options
p43919
aVYou'll have to insert those newlines
p43920
aVBash lets you insert newlines on the command line within quoted strings:
p43921
aVYou simply press  after  and you can insert newlines, until you enter a closing  quote
p43922
as(dp43923
g16
V100297
p43924
stp43925
a((dp43926
g2
(lp43927
VPickle is not safe when transfered by a untrusted 3rd party
p43928
aVLocal files are just fine, and if something can replace files on your filesystem then you have a different problem
p43929
aVThat said, if your dictionary contains nothing but string keys and the values are nothing but Python lists, numbers, strings or other dictionaries, then use JSON, via  the  module
p43930
as(dp43931
g16
V100297
p43932
stp43933
a((dp43934
g2
(lp43935
VYou are looping over , which means that each element is iterated over separately
p43936
aVJust assign directly to your variables:
p43937
aVBecause you were looping over the individual values, you were trying to unpack  value into your 10 names:
p43938
aVPython then treats that string value,  as a sequence of 5 characters, finding that those 5 don't fit into 10 names, throwing the exception you saw
p43939
as(dp43940
g16
V100297
p43941
stp43942
a((dp43943
g2
(lp43944
VFirst of all, only add  if there is a text entry:
p43945
aVThat'll not add  entries ( returns  if the  key is not present in the dictionary)
p43946
aVI'm assuming here that you want to further process the  list you are building here
p43947
aVIf not, you can dispense with the  loops below and stick to one loop with  statements
p43948
aVis the same value as  in the  loops
p43949
aVNext, you are looping over python  values, so use the methods provided on those objects to filter out what you don't want:
p43950
aVYou can use a list comprehension here; the following would print all entries too, in one go:
p43951
aVIn this case that doesn't really buy you much, as you are building one big string just to print it; you may as well just print the individual strings and avoid the string building cost
p43952
aVNote that all your data is Unicode data
p43953
aVWhat you perhaps wanted is to filter out text that uses codepoints beyond ASCII points perhaps
p43954
aVYou could use regular expressions to detect that there are codepoints beyond ASCII in your text
p43955
aVShort demo of the non-ASCII expression:
p43956
as(dp43957
g16
V100297
p43958
stp43959
a((dp43960
g2
(lp43961
VFirst of all, don't use an index but loop directly over the lists; that way you can give them meaningful names
p43962
aVThe top-level is a list of entries, each entry is a dictionary with a  key, and each  is a list of dictionaries, with, among others, a  key:
p43963
aVThis prints:
p43964
aVThis makes it easier to add information at each level too:
p43965
as(dp43966
g16
V100297
p43967
stp43968
a((dp43969
g2
(lp43970
VReworking your script to use best practices:
p43971
aVRunning this with Python 3 means that  is a Unicode object and that the regular expression is interpreted with the  set
p43972
aVIn Python 2, you'd use:
p43973
aV(note the leading  prefix on the string) and
p43974
aVYour AFINN file would be read as CSV still, but decoding the  from UTF8 after the fact, with:
p43975
as(dp43976
g16
V100297
p43977
stp43978
a((dp43979
g2
(lp43980
VPython 3 does not expect ASCII from
p43981
aVIt'll open  in text mode and make an educated guess as to what encoding is used
p43982
aVThat guess may come down to , but that is not a given
p43983
aVSee the  documentation on how the codec is selected
p43984
aVLike other file objects opened in text mode, the  object derives from the  base class; it has a  attribute pointing to the underlying buffered IO instance (which in turn has a  attribute)
p43985
aVWrap the  attribute in a new  instance to specify a different encoding:
p43986
aVAlternatively, set the  environment variable to the desired codec when running python
p43987
as(dp43988
g16
V100297
p43989
stp43990
a((dp43991
g2
(lp43992
VAs the argument is an attribute of the function object, it normally has the same lifetime as the function
p43993
aVUsually, functions exist from the moment their module is loaded, until the interpreter exits
p43994
aVHowever, Python functions are first-class objects and you can delete all references (dynamically) to the function early
p43995
aVThe garbage collector may then reap the function and subsequently the default argument:
p43996
aVNote that you can directly reach the  attribute ( in python 3), which is writable, so you can clear the default by reassigning to that attribute
p43997
as(dp43998
g16
V100297
p43999
stp44000
a((dp44001
g2
(lp44002
VYou want to use the  function:
p44003
aVpairs up the elements of the input lists, letting you process them together
p44004
aVIf your inputs are large or are iterators, use , or, if you don't care about forward compatibility with Python 3, use  instead; these yield pairs on demand instead of creating a whole output list in one go:
p44005
aVYour generators fall in this scenario
p44006
aVLast but not least, if your input lists have different lengths,  stops when the shortest list is exhausted
p44007
aVIf you want to continue with the longest list instead, use ; it'll use a fill value when the shorter input sequence(s) are exhausted:
p44008
aVThe default for  is
p44009
aVYour attempt:
p44010
aVis really interpreted as:
p44011
aVwhere the latter part is interpreted as a tuple with two values, one a list, the other a boolean; after testing , is either  or
p44012
aVYou had  defined as  from a previous loop experiment and thus  is
p44013
as(dp44014
g16
V100297
p44015
stp44016
a((dp44017
g2
(lp44018
VUse , paired with either  or :
p44019
aVAs you can see the format is rather close to Ruby's
p44020
aVThe  and  methods return namespaces as a dictionary, and the  keyword argument splash syntax make it possible for the  call to access all names in the given namespace
p44021
aVDemo:
p44022
aVNote however that explicit is better than implicit and you should really pass in  and  as arguments:
p44023
aVor use positional arguments:
p44024
as(dp44025
g16
V100297
p44026
stp44027
a((dp44028
g2
(lp44029
VYou need to work with Unicode values, not with byte strings
p44030
aVUTF-8 encoded  is two bytes, and a regular expression matching  only matches ascii letters, digits and underscores when operating in the default non-Unicode-aware mode
p44031
aVFrom the  module documentation on :
p44032
aVWhen the  and  flags are not specified, matches any alphanumeric character and the underscore; this is equivalent to the set
p44033
aVWith , it will match the set  plus whatever characters are defined as alphanumeric for the current locale
p44034
aVIf  is set, this will match the characters  plus whatever is classified as alphanumeric in the Unicode character properties database
p44035
aVUnfortunately, even when you switch to properly using Unicode values (using a unicode  literal or by decoding your source data to unicode values), using a Unicode regular expression () and using the  flag to switch  to match Unicode alphanumeric characters, the Python  module has limited support for Unicode matching still:
p44036
aVbecause  is not being recognized as alphanumeric:
p44037
aVThe solution is to use the external  library which is a version of the  library that adds proper full Unicode support:
p44038
aVThat module can do more than just recognize more alphanumeric characters in Unicode values, see the linked package page for more details
p44039
as(dp44040
g16
V100297
p44041
stp44042
a((dp44043
g2
(lp44044
VUse dictionary views to achieve this; the  result acts like a set and let you do intersections and symmetrical differences:
p44045
aVIn Python 3, the  method has been renamed to , replacing the old  functionality (which in Python 2 returs a list)
p44046
aVThe above  method is the generic solution which works for any given
p44047
aVDemo:
p44048
as(dp44049
g16
V100297
p44050
stp44051
a((dp44052
g2
(lp44053
V will be set to 0
p44054
aVIf, however, you are running a statement that would never return a result set (such as  or ), then you do not need to call ; there won't be a result set ever for such statements
p44055
aVCalling  is enough to run the statement
p44056
as(dp44057
g16
V100297
p44058
stp44059
a((dp44060
g2
(lp44061
VUse  to achieve what you want in one go
p44062
aVBut to process words in a sentence, use a loop instead of a series of local variables; here is a version that does the same what you are doing for an arbitrary number of words:
p44063
aVI used string slicing as well to select just the first character, and all but the first character of a word
p44064
aVNote the use of  to give us a counter which wich we can replace words in the  list directly
p44065
as(dp44066
g16
V100297
p44067
stp44068
a((dp44069
g2
(lp44070
VYou need to set  on the instance:
p44071
aVWithout the ,  is just a local name in your  method, and is discarded when that method completes
p44072
aVYou probably want to do the same thing with
p44073
as(dp44074
g16
V100297
p44075
stp44076
a((dp44077
g2
(lp44078
VYou can use  to split your white-space-separated lines into a row:
p44079
aVthen use  to create your new file
p44080
aVwith no arguments, or  as the first argument, splits on arbitrary-width whitespace and ignores leading and trailing whitespace on the line:
p44081
aVAs a complete script:
p44082
as(dp44083
g16
V100297
p44084
stp44085
a((dp44086
g2
(lp44087
VBecause you already read the whole file
p44088
aVOnce you have read a file, the file pointer has been moved to the end and no more data will be 'found' beyond that point
p44089
aVRe-open the file or seek back to the start:
p44090
aVNote that your first line is ; this exhausted the file iterator (moved the file pointer to the end of te file)
p44091
aVYour next statement is then , which tries to read from  again
p44092
aVThe file pointer is still at the end of the file, no data is returned when reading and an empty list is created
p44093
as(dp44094
g16
V100297
p44095
stp44096
a((dp44097
g2
(lp44098
VFirst, build a set of all your values inside of the  structure:
p44099
aVNow membership testing is efficient, and you can use a list comprehension:
p44100
aVDemo:
p44101
as(dp44102
g16
V100297
p44103
stp44104
a((dp44105
g2
(lp44106
VYou are using Python 3 specific syntax in Python 2
p44107
aVThe  syntax for extended iterable unpacking in assignments is not available in Python 2
p44108
aVSee Python 3
p44109
aV0, new syntax and PEP 3132
p44110
aVUse a function with  splat argument unpacking to simulate the same behaviour in Python 2:
p44111
aVor use list slicing
p44112
as(dp44113
g16
V100297
p44114
stp44115
a((dp44116
g2
(lp44117
VYou can use a metaclass to prevent subclassing:
p44118
aVgives:
p44119
aVThe  line makes the  class 'sealed'
p44120
aVNote that you'd use a sealed class in
p44121
aVNET as a performance measure; since there won't be any subclassing methods can be addressed directly
p44122
aVPython method lookups work very differently, and there is no advantage or disadvantage, when it comes to method lookups, to using a metaclass like the above example
p44123
as(dp44124
g16
V100297
p44125
stp44126
a((dp44127
g2
(lp44128
VYou are uppercasing (part of) the replacement pattern, not the actual replacement result
p44129
aVThe  expression results in the value  before passing it to
p44130
aVTo dynamically process match groups, you'll need to apply your changes in a function passed to  instead of a replacement pattern:
p44131
aVDemo:
p44132
aVAlternatively, don't use regular expressions at all:
p44133
as(dp44134
g16
V100297
p44135
stp44136
a((dp44137
g2
(lp44138
VYou are parsing a namespaced document, and there is no  tag present, because that only applies to tags without a namespace
p44139
aVYou are instead looking for the  element, which contains a  element
p44140
aVMany  methods do let you specify a namespace map to make matching easier, but the  method is not one of them, unfortunately
p44141
aVThe following  call certainly processes the right  tags:
p44142
aVbut you'll need to use  to get the  and  tags on the page element, or use  calls to get the text directly:
p44143
aVwhich, for your input example, prints:
p44144
as(dp44145
g16
V100297
p44146
stp44147
a((dp44148
g2
(lp44149
VYou named the local variable  too; you cannot do that, it masks the global  function
p44150
aVRename the local variable, or the function:
p44151
aVor
p44152
as(dp44153
g16
V100297
p44154
stp44155
a((dp44156
g2
(lp44157
VThe data is UTF-8 encoded bytes escaped with URL quoting, so you want to decode:
p44158
aVDemo:
p44159
as(dp44160
g16
V100297
p44161
stp44162
a((dp44163
g2
(lp44164
VYou are encoding ASCII codepoints only
p44165
aVUTF-8 is a superset of ASCII, any ASCII codepoints are encoded to the same bytes as ASCII would use
p44166
aVWhat you are printing is correct, that is UTF-8
p44167
aVUse some non-ASCII codepoints to see the difference:
p44168
aVPython will just use the characters themselves when it shows you a  value with printable ASCII bytes in it
p44169
aVAny byte value that is not printable is shown as a  escape code, or a single-character escape sequence if there is one ( for newline)
p44170
aVFrom your example output, on the other hand, you seem to be expecting to output Python unicode literal escape codes:
p44171
aVSince U+0123 is printable, Python 3 just shows it; the non-printable U+0015 () is a codepoint in the - range and is shown using the shorter  escape notation
p44172
aVTo show only unicode escape sequences for your text, you need to process it character by character:
p44173
aVIt is important to stress that this is not UTF-8, however
p44174
as(dp44175
g16
V100297
p44176
stp44177
a((dp44178
g2
(lp44179
VNo,  (carriage return, or ) is only correct for old Mac OS, so up to release 9
p44180
aVOS X is a complete rewrite, and now a UNIX-based OS
p44181
aVIt uses  (line feed, or )
p44182
aVFrom Wikipedia on the subject of Newline:
p44183
aV:    Multics, Unix and Unix-like systems (GNU/Linux, Mac OS X, FreeBSD, AIX, Xenix, etc
p44184
aV, BeOS, Amiga, RISC OS and others
p44185
ag15438
aV:    Commodore 8-bit machines, Acorn BBC, ZX Spectrum, TRS-80, Apple II family, Mac OS up to version 9 and OS-9
p44186
aVSee Historical reason behind different line ending at different platforms for some history behind this
p44187
aVInstead, it's Scintilla that is in the wrong here
p44188
aVThe Line endings documenation suggests it defaults to  when on Mac:
p44189
aVScintilla can interpret any of the Macintosh (), Unix () and Windows () line ends
p44190
aVYou can use the  function to alter that behaviour, whatever the Python binding equivalent is should be passed the  value to make Scintilla use the correct line separator for your platform
p44191
aVI see that there is a  method and a  enum to accomplish that; I guess you'll need to map python line ending variants to the enum and pass the right enum value to the  method
p44192
as(dp44193
g16
V100297
p44194
stp44195
a((dp44196
g2
(lp44197
V does most of the work for you:
p44198
aVThe tricky bit here is tracking the  key; presumably it's the  in the key that defines the hierarchy
p44199
aVIt's best to split that out to a generator:
p44200
aVThe rest is easy:
p44201
aVDemo with your example input:
p44202
as(dp44203
g16
V100297
p44204
stp44205
a((dp44206
g2
(lp44207
VYou forgot an operator here:
p44208
aVPython interprets that as a call expression;  must be a callable, passing in  as the single argument
p44209
aVSince  is an integer instead, which is not callable, you get an exception
p44210
aVPerhaps you meant:
p44211
as(dp44212
g16
V100297
p44213
stp44214
a((dp44215
g2
(lp44216
VNo, there isn't
p44217
aVValues in Python do not track where they originated from, nor are they 'bound' to one another
p44218
aVContainers can refer to other values, but since any value can be referenced from multiple locations there is no point in tracking back-references
p44219
aVFrom s point of view, there is absolutely no difference between the following two invocations:
p44220
aVIn both cases,  in the function is bound to a python string value,
p44221
aVIf you need more context in a function, you need to pass it in explicitly:
p44222
aVNow you have the dictionary itself too
p44223
as(dp44224
g16
V100297
p44225
stp44226
a((dp44227
g2
(lp44228
VFind the maximum first; since your data is sorted, that'll be the last value; then simply divide the rest by that value:
p44229
aVDemo:
p44230
aVThe  import ensures we use floating point division, not integer division
p44231
aVThe alternative is to use
p44232
as(dp44233
g16
V100297
p44234
stp44235
a((dp44236
g2
(lp44237
VYou appended a tuple to your list:
p44238
aVBecause you split  into individual words, there will never be a tuple with three words in  for which  is
p44239
aVAs such your claim that your count goes up to 70
p44240
aV000 can not be true, the code, as shown, would only ever give you an empty  dictionary
p44241
aVJust define the list directly:
p44242
aVor better still, use a  for fast membership testing:
p44243
aVYour code will be much easier to read if you used  instead:
p44244
aVUpdate for your changed question with real code:
p44245
aVYou are updating a list  with new tagged words, by appending them without clearing the list
p44246
aVWith each  you process,  grows, but you then process  from the start for each iteration in your loop
p44247
aVYour 70
p44248
aV000 is a factorial number; first you process 400 tokens, then you process another 300 tags for a total of 700, then you process 100 additional words, so now you loop over  800 times, etc
p44249
aVClear,  to avoid this problem (e
p44250
ag1298
aVinside the loop), or better still, loop directly over  and do not append at all:
p44251
aVDo make sure that  is really a set, otherwise the  test has to loop over the  elements for each and every tag
p44252
as(dp44253
g16
V100297
p44254
stp44255
a((dp44256
g2
(lp44257
VUse :
p44258
aVDemo:
p44259
aVNote that because your sample dictionary is smaller than the top  you want, you could just as well have used :
p44260
aVbut for any top  where  is smaller than   is the better choice
p44261
aVAlternatively, use a  object, it has a  method that gives you exactly that; the highest  scoring elements in the counter:
p44262
as(dp44263
g16
V100297
p44264
stp44265
a((dp44266
g2
(lp44267
VTo summarize the conversation in the comments:
p44268
aVThere is no need to use  library, the same library is included with Python as the  module
p44269
aVThere is no need to decode a response from UTF8 to unicode, the  /   method can handle UTF8 encoded data natively
p44270
aVhas a very archaic API
p44271
aVUnless you have a specific requirement for using it, there are better choices
p44272
aVoffers the most friendly API, including JSON support
p44273
aVIf you can, replace your call with:
p44274
as(dp44275
g16
V100297
p44276
stp44277
a((dp44278
g2
(lp44279
VYou want to use the declarative extension instead:
p44280
aVYou can define your own  as needed, as well other methods, then create instances of these to insert new rows
p44281
aVSee the SQLAlchemy's own ORM tutorial
p44282
as(dp44283
g16
V100297
p44284
stp44285
a((dp44286
g2
(lp44287
V returns a helper function that in turn returns a  instance, that uses your generator as a way to manage the context
p44288
aVIt is not intended to be used as anything you can send to,  is called in
p44289
aVYou could try and access the underlying generator with the  attribute:
p44290
aVbut you'd have to include an extra yield statement to prevent the method from exiting prematurely
p44291
aVNote that  will call  once more to conclude the generator
p44292
aVworks, in that it has a second  to pause the generator again until the context manager is ready to call  one last time
p44293
as(dp44294
g16
V100297
p44295
stp44296
a((dp44297
g2
(lp44298
VYou didn't name your  properly, you forgot an
p44299
aVWithout an  method, the arguments are sent to the parent  method, which doesn't take any arguments
p44300
aVDemo on Python 3
p44301
aV3 (slightly updated error message):
p44302
as(dp44303
g16
V100297
p44304
stp44305
a((dp44306
g2
(lp44307
VUse the  module for easier and more efficient processing, and a dict comprehension:
p44308
aVYour code only created a dictionary per line and only printed the dictionary
p44309
aVYou probably wanted to return the dictionary instead
p44310
aVUsing a dict comprehension not only makes the function more compact, it is also more efficient
p44311
aVThe dictionary is created in one go, in C code, instead of in a Python loop adding keys and values one by one
p44312
as(dp44313
g16
V100297
p44314
stp44315
a((dp44316
g2
(lp44317
VYou want to read one file into memory first, storing it in a set
p44318
aVMembership testing in a set is very efficient, much more so than looping over the lines of the second file for every line in the first file
p44319
aVThen you only need to read the second file, and line by line process it and test if lines match
p44320
aVWhat file you keep in memory depends on the size of
p44321
aVIf it is < 1000 lines or so, just keep that in memory and compare it to the other files
p44322
aVIf  is really large, re-open it for every  you process, and read only the first 18 lines of  into memory and match those against every line in , line by line
p44323
aVTo read just 18 lines of a file, use ; files are iterables and  is the easiest way to pick a subset of lines to read
p44324
aVReading  into memory first:
p44325
aVIf  is large, store those 18 lines of each file in a set first, then re-open  and process it line by line:
p44326
aVNote that you do not have to change directories in ;  is already passed the directory name
p44327
aVThe  module also has a  method, use that to loop over  instead of using  on each file individually:
p44328
as(dp44329
g16
V100297
p44330
stp44331
a((dp44332
g2
(lp44333
VYour  is already the index where the two conditions are met
p44334
aVUsing , possibly combined with  would be the more pythonic method:
p44335
aVor, using a list comprehension:
p44336
as(dp44337
g16
V100297
p44338
stp44339
a((dp44340
g2
(lp44341
VYou turned the list into a string
p44342
aVLooping over  gives you individual characters instead:
p44343
aVThere is no need to turn  into a string
p44344
aVYou also need to test the elements of the list, not :
p44345
as(dp44346
g16
V100297
p44347
stp44348
a((dp44349
g2
(lp44350
VReturn first matching key:
p44351
aVReturn all matching keys as a set:
p44352
aVValues in a dictionary are not necessarily unique
p44353
aVThe first option returns  if there is no match, the second returns an empty set for that case
p44354
aVSince the order of dictionaries is arbitrary (dependent on what keys were used and the insertion and deletion history), what is considered the 'first' key is arbitrary too
p44355
aVDemo:
p44356
aVNote that we need to loop over the values each time we need to search for matching keys
p44357
aVThis is not the most efficient way to go about this, especially if you need to match values to keys often
p44358
aVIn that case, create a reverse index:
p44359
aVNow you can ask for the set of keys directly in O(1) (constant) time:
p44360
aVThis uses sets; the dictionary has no ordering so either, sets make a little more sense here
p44361
as(dp44362
g16
V100297
p44363
stp44364
a((dp44365
g2
(lp44366
VYou can only find tags with , not attributes
p44367
aVYou'll need to access those through the  method instead:
p44368
aVIf you are still learning about parsing XML, you really want to stay away from the DOM
p44369
aVThe DOM API is overly verbose to fit many different programming languages
p44370
aVThe ElementTree API would be easier to use:
p44371
as(dp44372
g16
V100297
p44373
stp44374
a((dp44375
g2
(lp44376
VNo, because the shell removes those spaces, not optparse
p44377
aVPython is handed a list of already-parsed command-line parameters
p44378
aVUse quoting to preserve spaces:
p44379
aVTo demonstrate, I created the following script:
p44380
aVto show you what optparse sees:
p44381
aVNote how the whitespace is all removed and three values are passed to the script
p44382
aVBut with quoting:
p44383
aVthe whitespace is preserved, and I joined two strings together into one as well
p44384
as(dp44385
g16
V100297
p44386
stp44387
a((dp44388
g2
(lp44389
VYou are always looking at a function context; the method context is already gone by the time the function executes
p44390
aVTechnically speaking, functions act as descriptors when accessed as attributes on an instance (), which return a method object
p44391
aVThe method object then, when called, in turn calls the original function with the instance as the first argument
p44392
aVBecause this all happens in C code, no trace of the original method object remains on the Python stack
p44393
aVThe stack only needs to keep track of namespaces and the code to be executed for the local namespace
p44394
aVThe original function object is no longer needed for these functions, only the attached code object still retains the name of the original function definition for traceback purposes
p44395
aVIf you know the function to be a method, you could search for a  local name
p44396
aVIf present,  is the class of the instance, which is not necessarily the class the method was defined on
p44397
aVYou would then have to search the class and it's bases (looping over the  attribute) to try and locate what class defined that method
p44398
aVThere are a few more snags you need to take into account:
p44399
aVNaming the first argument of a method  is only a convention
p44400
aVIf someone picked a different name, you won't be able to figure that out without parsing the Python source yourself, or by going up another step in the stack and trying to deduce from that line how the function was called, then retrieve the method and it's  attribute
p44401
aVYou only are given the original name of the function, under which it was defined
p44402
aVThat is not necessarily the name under which it was invoked
p44403
aVFunctions are first-class objects and can be added to classes under different names
p44404
aVAlthough a function was passed in  and was defined as part of a class definition, it could have been invoked by manually passing in a value for  instead of the usual route of the method (being the result of the function acting as a descriptor) passing in the  reference for the caller
p44405
aVIn Python 3
p44406
aV3 and up, the situation is marginally better; function objects have a new  attribute, which would include the class name
p44407
aVThe problem is then that you still need to locate the function object from the parent stack frame
p44408
as(dp44409
g16
V100297
p44410
stp44411
a((dp44412
g2
(lp44413
VFrom the Lexical Analysis documentation on whitespace between tokens:
p44414
aVExcept at the beginning of a logical line or in string literals, the whitespace characters space, tab and formfeed can be used interchangeably to separate tokens
p44415
aVWhitespace is needed between two tokens only if their concatenation could otherwise be interpreted as a different token (e
p44416
ag1298
aV, ab is one token, but a b is two tokens)
p44417
aVInverting the last sentence, whitespace is allowed between any two tokens as long as they should not instead be interpreted as one token without the whitespace
p44418
aVThere is no limit on how much whitespace is used
p44419
aVEarlier sections define what comprises a logical line, the above only applies to within a logical line
p44420
aVThe following is legal too:
p44421
aVbecause the logical line is extended across newlines by parenthesis
p44422
aVThe call expression is a separate series of tokens from what precedes;  is just a name to look up in the global namespace, you could have looked up the object from a dictionary, it could have been returned from another call, etc
p44423
aVAs such, the  part is two separate tokens and any amount of whitespace in and around these is allowed
p44424
as(dp44425
g16
V100297
p44426
stp44427
a((dp44428
g2
(lp44429
VList comprehensions generate one element at a time
p44430
aVYour options are, instead, to change your loop to only generate one value at a time:
p44431
aVor to produce tuples then flatten the list using :
p44432
aVOutput:
p44433
as(dp44434
g16
V100297
p44435
stp44436
a((dp44437
g2
(lp44438
VDon't use concatenation when you can use ; the logging module postpones interpolation until actually formatting the string when logging
p44439
aVIf the  log level has been disabled, no interpolation takes place
p44440
aVYou can also test the logging level to avoid gathering expensive logging information unless needed:
p44441
aVSee the optimization section of the Logging HOWTO
p44442
as(dp44443
g16
V100297
p44444
stp44445
a((dp44446
g2
(lp44447
VYou have both a nested list comprehensions, one inside the other, plus another one to create a list of split elements first
p44448
aVYou can reduce this to just two loops instead:
p44449
aVThis simplifies back down to a list comprehension of the form:
p44450
as(dp44451
g16
V100297
p44452
stp44453
a((dp44454
g2
(lp44455
VIterables can only be iterated over once, after which they are exhausted
p44456
aVWhen looping over a given iterable a second time in a for loop, no more elements are returned
p44457
aVLoop over  first instead, then over your list of tuples to generate ouput:
p44458
aVThis produces:
p44459
as(dp44460
g16
V100297
p44461
stp44462
a((dp44463
g2
(lp44464
V and  are tuples; you want to insert just the first elements
p44465
aVIt's easiest just to concatenate these:
p44466
aVor use indexing:
p44467
as(dp44468
g16
V100297
p44469
stp44470
a((dp44471
g2
(lp44472
VYou limit  to be smaller than , but the last index of a list is at  (0 based indexing)
p44473
aVThis means in the last iteration of your loop  will be equal to  and out of bounds
p44474
aVThis works:
p44475
aVYour code can also be simplified to:
p44476
aVThis list comprehension:
p44477
aVLoops over all elements in
p44478
aVUses  to generate an index for each element, giving us both the index  and the element
p44479
aVCalculates the difference between the current element and the previous element in  (using the index - 1), except when the index is , effectively skipping the one element for which there is no preceding element in
p44480
aVDemo:
p44481
as(dp44482
g16
V100297
p44483
stp44484
a((dp44485
g2
(lp44486
VYou are creating tuples by using a comma:
p44487
aVThe comma is what makes  a tuple:
p44488
as(dp44489
g16
V100297
p44490
stp44491
a((dp44492
g2
(lp44493
VFirst, use the  class factory to create a tuple-like object to replace your lists; store your operator codes in a tuple within that object:
p44494
aVNow you can address these with , , etc
p44495
aVThis would already be far more readable
p44496
aVYou can use the names to define your entries if you find that easier to read:
p44497
aVYou could get away with omitting the  argument, and just use
p44498
aVNext, you could use constants to denote the various options you have
p44499
aVFor  you could use:
p44500
aVfor example, then use those names throughout:
p44501
aVBecause we use a separate tuple for the opcodes, you just loop over those:
p44502
as(dp44503
g16
V100297
p44504
stp44505
a((dp44506
g2
(lp44507
VUse  to model time durations:
p44508
aVYou can then turn a  object back to a minutes + seconds representation:
p44509
aVDemo:
p44510
aVAlternatively, the  result of a  is formatted as :
p44511
aVand may suit your needs too
p44512
aVNote that for deltas that present more than one hour, there is a difference between  and ; the former shows you hours, minutes and seconds, the latter just shows minutes, where the minutes value can be over 60
p44513
aVDeltas representing more than 24 hours gain an extra prefix for the number of days:
p44514
as(dp44515
g16
V100297
p44516
stp44517
a((dp44518
g2
(lp44519
VUse  to test for equality
p44520
aVtests for identity, the two sides being the same object
p44521
aVAlso, your inputs  and  are not functions, so you cannot call them
p44522
aVJust compare  and  directly:
p44523
aVNote that the function ends when you call
p44524
aVThe  statement on the next line is ignored, and the  loop ends as well
p44525
aVLast but not least, you are only zipping the first elements of  and
p44526
aVI suspect you wanted to call this with  and , at which point you probably wanted to pair up first  and , then  and , etc
p44527
aVIf so, just pass the lists without indexing:
p44528
aVI doubt that you'll achieve what you want though; none of the value pairs from  and  will ever be equal
p44529
aVPerhaps you wanted to look at the  method
p44530
aVAlso, the  library has functions you want to be familiar with if you are manipulating and testing filenames and paths
p44531
aVThe ,  and  functions should be of particular interest to what I think you are trying to do here
p44532
aVNote that your  variable also needs adjusting
p44533
aVUse a raw string, forward slashes or double the slashes:
p44534
aVas  is the escape code for a backspace
p44535
as(dp44536
g16
V100297
p44537
stp44538
a((dp44539
g2
(lp44540
VBecause in Python 2, the list variable 'leaks' to the surrounding scope
p44541
aVThis was a mistake in the way list comprehensions were built
p44542
aVThis has been corrected for dict and set comprehensions, generator expressions and in Python 3 for list comprehensions as well
p44543
aVIt is not a memory leak
p44544
aVIt's just an error in the scope of the variable
p44545
as(dp44546
g16
V100297
p44547
stp44548
a((dp44549
g2
(lp44550
VEncode back to bytes before passing it to , using ASCII:
p44551
aVThis does the same thing as  but with an explicit encoding
p44552
aVYes, this is safe, the URL encoding uses ASCII codepoints only
p44553
aVwas handed a Unicode value, so it returned you a unicode value too; it is not it's job to decode bytes
p44554
as(dp44555
g16
V100297
p44556
stp44557
a((dp44558
g2
(lp44559
VYou capture the ,  and  inputs as one catch-all argument, but then try to refer to those names again in the  function
p44560
aVJust make them separate parameters:
p44561
aVUse  syntax when you need to allow for a variable number of arguments, not for catching a fixed number of arguments that you then otherwise not use
p44562
aVI stored the 3 arguments as a tuple onto your instance anyway, in case you are using  elsewhere
p44563
aVYou need to store  on the instance:
p44564
aVand in  refer to that instance attribute:
p44565
aVThe latter  statements can also be replaced with a slice:
p44566
as(dp44567
g16
V100297
p44568
stp44569
a((dp44570
g2
(lp44571
VYou are using Python 2, and are executing this somewhere with  closed:
p44572
aVOn Python 2, use  instead, and run this in a terminal or Windows console, or from within IDLE
p44573
as(dp44574
g16
V100297
p44575
stp44576
a((dp44577
g2
(lp44578
V always returns a list with at least one element, just select the first element of the result to ignore the rest:
p44579
aVYou may want to limit the split count, since you are discarding everything but the first part anyway:
p44580
as(dp44581
g16
V100297
p44582
stp44583
a((dp44584
g2
(lp44585
VOn POSIX platforms (and on Windows and OS/2) the  module imports from a C module, defined in
p44586
aVThis module defines a  function that wraps the  C call on POSIX platforms,  on Windows
p44587
aVThe module registers this function, together with others, in the module  structure
p44588
aVWhen the module is imported, Python calls the  function, which uses that structure to create an approriate module object with the  structure and adds a series of constants (such as the  flag constants) to the module
p44589
aVSee the Extending Python with C or C++ tutorial on how C extensions work
p44590
as(dp44591
g16
V100297
p44592
stp44593
a((dp44594
g2
(lp44595
VYou have a model class whose  method is returning
p44596
aVMake sure it actually has a  statement that returns a Unicode value instead
p44597
as(dp44598
g16
V100297
p44599
stp44600
a((dp44601
g2
(lp44602
VUse the  module as a base:
p44603
aVDemo:
p44604
as(dp44605
g16
V100297
p44606
stp44607
a((dp44608
g2
(lp44609
VSQLite creates temporary files as needed to store data not yet committed to a database
p44610
aVIt will do so even for in-memory databases
p44611
aVAs such, 2GB of data will not eat up all your memory when stored in a SQLite database
p44612
as(dp44613
g16
V100297
p44614
stp44615
a((dp44616
g2
(lp44617
VYou are using  instead of :
p44618
aVexpects to be given the XML data in a bytestring, not a filename
p44619
aVIf the document is really large (many megabytes or more) then you should use the  function instead and clear elements you have processed:
p44620
as(dp44621
g16
V100297
p44622
stp44623
a((dp44624
g2
(lp44625
VUse a  loop and  values to process from the set:
p44626
aVNote that I replaced your inner  loop with a set comprehension to make it a little faster and more compact
p44627
aVThese were introduced in Python 2
p44628
aV7 and Python 3, in earlier versions of python you can use a generator expression instead:
p44629
aVYour original mistake was to replace  rather than update it:
p44630
aVThis did not alter the original set you were using in the  loop
p44631
aVRather, you are creating a new set and point the  reference to that
p44632
aVHowever, you cannot modify a  while iterating over it, so even an in-place difference would not have worked; you would have to use  or  but that would lead to exceptions instead:
p44633
aVThe corrected code gives:
p44634
aVAlternatively, loop over  instead, and keep a set of values you've already processed:
p44635
as(dp44636
g16
V100297
p44637
stp44638
a((dp44639
g2
(lp44640
VYou'll have to store a reference back to the parent; python values do not track where they are stored (there can be multiple places that refer to your  instances):
p44641
as(dp44642
g16
V100297
p44643
stp44644
a((dp44645
g2
(lp44646
VYou'll have to use an actual function instead, one that is importable (not nested inside another function):
p44647
as(dp44648
g16
V100297
p44649
stp44650
a((dp44651
g2
(lp44652
VYou are creating partials on the function, not the method
p44653
aVobjects are not descriptors, they will not themselves add the  argument and cannot act as methods themselves
p44654
aVYou can only wrap bound methods or functions, they don't work at all with unbound methods
p44655
aVThis is documented:
p44656
aVobjects are like  objects in that they are callable, weak referencable, and can have attributes
p44657
aVThere are some important differences
p44658
aVFor instance, the  and  attributes are not created automatically
p44659
aVAlso,  objects defined in classes behave like static methods and do not transform into bound methods during instance attribute look-up
p44660
aVUse s instead; these are descriptors:
p44661
as(dp44662
g16
V100297
p44663
stp44664
a((dp44665
g2
(lp44666
VThe result of  is itself not tracked; it would create a circular reference otherwise:
p44667
aVYou do not see  listed because that references one of the low-integer singletons
p44668
aVPython re-uses the same set of  objects for values between -5 and 256
p44669
aVAs such,  does not create a new object to be tracked
p44670
aVNor will you see any other primitive types
p44671
aVCPython garbage collection only needs to track container types, types that can reference other value because the only thing that GC needs to do is break circular references
p44672
aVNote that by the time any Python script starts, already some automatic code has been run
p44673
aVsets up your Python path for example, which involves lists, mappings, etc
p44674
aVThen there are the memoized  values mentioned above, CPython also caches  objects for re-use, etc
p44675
aVAs a result, on start-up, easily 5k+ objects are already alive before one line of your code has started
p44676
as(dp44677
g16
V100297
p44678
stp44679
a((dp44680
g2
(lp44681
VYou should use  or  instead, which does this efficiently and correctly using a buffer
p44682
aVNot that it is particularly hard,  is implemented as:
p44683
aVThis makes sure that your memory isn't filled up by a big file, by reading the file in chunks instead
p44684
aVAlso,  is not guaranteed to return all of the data of the file, you could end up not copying all of the data if you don't loop until  returns an empty string
p44685
as(dp44686
g16
V100297
p44687
stp44688
a((dp44689
g2
(lp44690
VYou see the special characters because you are encoding to UTF-8 or Latin-1:
p44691
aVWhen printing a bytes literal, Python shows the  representation of the value, which replaces any byte that does not represent a printable ASCII codepoint with the  escape sequence; some are replaced with the shorter two-character escapes, such as  and
p44692
aVThis makes the representation both re-usable as a Python bytes literal and more easily logged to files and terminals not set up for international character sets
p44693
aVhandles encoding for you
p44694
aVJust print the  output directly
p44695
aVIf printing Unicode to your terminal or console does not work, and instead raises a , your terminal or console is not configured to handle Unicode text properly
p44696
aVConsult the PrintFail Python Wiki page to troubleshoot
p44697
as(dp44698
g16
V100297
p44699
stp44700
a((dp44701
g2
(lp44702
VEach  is an iterable, and turning that into a list exhausts it
p44703
aVYou cannot turn an iterable into a list twice
p44704
aVStore the list as a new variable:
p44705
aVNow you consume the iterable only once:
p44706
as(dp44707
g16
V100297
p44708
stp44709
a((dp44710
g2
(lp44711
VThe documentation on  is flawed and doesn't handle the edgecase for  properly
p44712
aVIt is exactly that edgecase that  uses
p44713
aVFor , exactly  elements are consumed from  but nothing is ever yielded
p44714
aVInstead,  is raised after those  elements have been consumed
p44715
aVThe Python version you used to test with on the other hand raises  immediately without ever consuming anything from
p44716
aVThis makes any timings against this pure-python version incorrect and way too fast
p44717
aVThis is because the  iterator immediately raises :
p44718
as(dp44719
g16
V100297
p44720
stp44721
a((dp44722
g2
(lp44723
VWhy not use a nested list instead
p44724
aVLoop over a structure like:
p44725
aVThe zip() function can combine the 3 colX_values lists if need be:
p44726
aVNow you have per-row lists to loop over:
p44727
as(dp44728
g16
V100297
p44729
stp44730
a((dp44731
g2
(lp44732
VThe  callable doesn't take any arguments
p44733
aVIf you want to pass the  list into , just omit the argument, the lambda doesn't need it:
p44734
aVNow  inside the lambda refers to the global
p44735
aVIf all you wanted to do was to call  with a pre-defined argument, you could use the  function; you pass it the function to be called plus any arguments that need to be passed in, and when it's return value is called, it'll do exactly that; call the function with the arguments you specified:
p44736
as(dp44737
g16
V100297
p44738
stp44739
a((dp44740
g2
(lp44741
VFrom your last print you can see that you have a  object; the documentation for  says there should be a  method, as well as a  method to get at individual layers
p44742
aVIt also states that you can iterate over the object (there is a  method), so you can use  to get at individual  objects
p44743
aVThe same information is available for the  object, it too has an  method to loop over the 2 entities defined
p44744
aVThe documentation then list the entity types that you could encounter, with further documentation on how to access their information
p44745
aVUnfortunately, there is at least one bug in the library; the  method doesn't return the correct type of object
p44746
aVA quick glance at the source code shows that other  methods do return correct items
p44747
aVYou can use
p44748
aVinstead for now, or call the  method directly:
p44749
aVI've filed a pull request to fix the issue
p44750
as(dp44751
g16
V100297
p44752
stp44753
a((dp44754
g2
(lp44755
VYou are testing if the user input is  or
p44756
aVAdd a :
p44757
aVEver so slightly faster and closer to your intent, use a set:
p44758
aVWhat you used is , which is  if  is either equal to  or
p44759
aVNext, use a boolean to set :
p44760
aVBecause you already verified that  is either  or , there is no need to test for  or  again to set your flag variable
p44761
as(dp44762
g16
V100297
p44763
stp44764
a((dp44765
g2
(lp44766
V is called with 2 arguments always, so your  argument is set to the second value in , a tuple
p44767
aVThe default is ignored
p44768
aVYou really shouldn't use  here
p44769
aVyou need when you want to use the next element in the iterator for each loop iteration to calculate one aggregate value
p44770
aVYou are mapping instead:
p44771
aVor use a list comprehension:
p44772
as(dp44773
g16
V100297
p44774
stp44775
a((dp44776
g2
(lp44777
VThe script stops running because the  call raises an exception
p44778
aVYou can catch that exception with a ,  handler:
p44779
as(dp44780
g16
V100297
p44781
stp44782
a((dp44783
g2
(lp44784
VYou are shadowing the  library with another  file, probably in the same location as
p44785
aVPrint out the file path of the offending module:
p44786
aVThis will you show you where the 'rogue' module is located
p44787
aVOnce you find it, rename it to something else
p44788
as(dp44789
g16
V100297
p44790
stp44791
a((dp44792
g2
(lp44793
VYou are importing the  module again, and Python runs all code in that module
p44794
aVYour top-level module code includes a call to , that is what is being called
p44795
aVYou may want to move the code that creates the pickle out of the module, or move it to a  guarded section:
p44796
aVOnly when running a python file as the main script is  set to ; when imported as a module  is set to the module name instead and the  branch will not run
p44797
as(dp44798
g16
V100297
p44799
stp44800
a((dp44801
g2
(lp44802
VIterables can only be iterated over once
p44803
aVYou create a new iterable in your loop instead
p44804
aVCycle cannot do that, it has to work with whatever you passed in
p44805
aVcannot simply recreate the iterable
p44806
aVIt thus is forced to store all the elements the original iterator produces
p44807
aVIf you were to pass in the following generator instead, your  fails:
p44808
aVNow your  produces:
p44809
aVYour code would only work for sequences, for which using  would be overkill; you don't need the storage burden of  in that case
p44810
aVSimplify it down to:
p44811
as(dp44812
g16
V100297
p44813
stp44814
a((dp44815
g2
(lp44816
VYou are looking for a  tag instead:
p44817
aVIf you want to only find  tags with that class inside of  tags with the  class you'll need to loop:
p44818
as(dp44819
g16
V100297
p44820
stp44821
a((dp44822
g2
(lp44823
VIt is a ElementTree  object
p44824
aVYou can also look at the lxml API documentation, which has an  page
p44825
aVThat page tells you about every single attribute and method on that class you could ever want to know about
p44826
aVI'd start with reading the  tutorial, however
p44827
aVIf the element cannot be indexed, however, it is an empty tag, and there are no child nodes to retrieve
p44828
aVTo find all lines by , an XPath expression is needed, with a namespace map
p44829
aVIt doesn't matter what prefix you use, as long as it is a non-empty string  will map it to the correct namespace URL:
p44830
aVThis extracts all text in  elements that are contained in  tags
p44831
aVNote the  prefixes on the tag names, the  dictionary tells  what namespace to use
p44832
aVI printed these without the surrounding extra whitespace
p44833
aVFor your sample document, that gives:
p44834
as(dp44835
g16
V100297
p44836
stp44837
a((dp44838
g2
(lp44839
VYou want to use a list here, and you want to perhaps use  objects to make the summing that much easier:
p44840
aVResult:
p44841
aVobjects are subclasses of , so they otherwise behave as dictionaries
p44842
aVIf you have to have  values afterwards, add the following line:
p44843
aVTaking inspiration from Eric, you can transform the above into a one-liner:
p44844
aVThis version differs slightly from the loop above in that keys that are 0 are dropped from the counter when summing
p44845
aVIf you want to keep  in the last counter, use:
p44846
aVThis uses  again
p44847
as(dp44848
g16
V100297
p44849
stp44850
a((dp44851
g2
(lp44852
VYou can chain the  statements:
p44853
aVYou do need that last  statement though
p44854
aVPython sees this basically as:
p44855
aVwith each nested conditional expression filling the  clause of the parent expression
p44856
aVDemo:
p44857
aVAnother, more readable option is to use a mapping:
p44858
aVDemo:
p44859
as(dp44860
g16
V100297
p44861
stp44862
a((dp44863
g2
(lp44864
V expects a list of lists
p44865
aVInstead, you are handing it a list of strings, and these are treated as sequences of characters
p44866
aVPut each string in a tuple or list:
p44867
aVNote that you could do this all a little more efficiently:
p44868
as(dp44869
g16
V100297
p44870
stp44871
a((dp44872
g2
(lp44873
VYou are not using  other than to print it
p44874
aVYou then replace the value in  with whatever  returns
p44875
aVFrom some context it looks like  creates a turtle object for you
p44876
aVyou can then use  to do something for that name, but you need to use  inside the loop body
p44877
aVAlternatively, create a dictionary to connect names to turtles:
p44878
aVNow you have a mapping from names to turtle objects
p44879
as(dp44880
g16
V100297
p44881
stp44882
a((dp44883
g2
(lp44884
VPython strings are sequences, so you can just loop over them like you can with lists
p44885
aVAdd  and you have yourself an index as well:
p44886
aVDemo:
p44887
aVI used  instead of  here because you then don't have to deal with the  at the start and you can more easily include leading
p44888
as(dp44889
g16
V100297
p44890
stp44891
a((dp44892
g2
(lp44893
V is clearly empty when this happens
p44894
aVis then , causing the , but it's the other exception,  that you must worry about
p44895
aVYour code removes the word immediately in the same function, not at a later time, so every time  is called you remove a random element from
p44896
aVDemo showing the exception with an empty list:
p44897
aVYou'll have to find out with debug statements why your list is emptied faster than you think it should be
p44898
aVNote that you are manipulating a global list, so removing choices from that list will not restore them when you finish your game
p44899
aVYour list will continue to shrink as words are removed, until empty
p44900
aVPerhaps you want to track what words you used instead
p44901
aVStore cards you used in a set:
p44902
aVNow  is left untouched, and each new  will have a new empty  set to fill up
p44903
aVAlternatively, you can reset  (set it to a new, fresh, empty set with ) whenever you want to restart the game
p44904
as(dp44905
g16
V100297
p44906
stp44907
a((dp44908
g2
(lp44909
VA call is an expression; it is listed in the Expressions reference documentation
p44910
aVIf it was a statement, you could not use it as part of an expression; statements can contain expressions, but not the other way around
p44911
aVAs an example,  is a statement; it uses expressions to determine it's behaviour; the result of the expression is what the current function returns
p44912
aVYou can use a call as part of that expression:
p44913
aVYou cannot, however, use  as part of a call:
p44914
aVThat would be a syntax error
p44915
aVIt is the  that 'does something'; it ends the function and returns the result of the expression
p44916
aVIt's not the expression itself that makes the function return
p44917
aVIf a python call was not an expression, you'd never be able to mix calls and other expression atoms into more complex expressions
p44918
as(dp44919
g16
V100297
p44920
stp44921
a((dp44922
g2
(lp44923
VNo, for , the  operator checks for equality, and strings are only equal to one another when they use the same case
p44924
aVYou could use a set here, and store all  values in it
p44925
aVSets are (a lot) faster for membership testing as lists as well:
p44926
aVThe  variable is easily derived later on:
p44927
aVYou also want to look into the functions provided by os
p44928
aVpath some more, in particular the ,  and  functions
p44929
aVYour file handling in the loop can be simplified a lot; a:
p44930
aVNote that I use just  here; your  and  dance plus delimiters, etc
p44931
aVwas needlessly complicated
p44932
aVNow, reading between the lines, it seems that you only want to consider extensions to be equal whatever the case of just that part
p44933
aVIn that case, build yourself a new filename from the result of :
p44934
aVNow  is the filename with the extension lowered, so you can use that value in the sets as needed
p44935
as(dp44936
g16
V100297
p44937
stp44938
a((dp44939
g2
(lp44940
V needs , , etc
p44941
aVto be defined
p44942
aVIt incorporates their values into a new global
p44943
aVThis has otherwise nothing to do with ; your  list cannot be defined as it currently stands without  and  being defined as well
p44944
aVIf you want , ,  and  used as parameters from another module, you need to make this a function:
p44945
aVNow you can call  with different parameters
p44946
as(dp44947
g16
V100297
p44948
stp44949
a((dp44950
g2
(lp44951
VPlease put down that hammer; HTML is not a regular-expression shaped nail
p44952
aVRegular expressions to parse HTML get complicated fast, and are very fragile, easily broken when the HTML changes subtly
p44953
aVUse a proper HTML parser instead
p44954
aVBeautifulSoup would make your task trivial:
p44955
as(dp44956
g16
V100297
p44957
stp44958
a((dp44959
g2
(lp44960
VYou'll have to use the  locale-aware number format instead, and set your locale to one that uses a space as a thousands separator
p44961
aVYes, this is painful
p44962
aV- Number
p44963
aVThis is the same as , except that it uses the current locale setting to insert the appropriate number separator characters
p44964
as(dp44965
g16
V100297
p44966
stp44967
a((dp44968
g2
(lp44969
VYou need to pass only byte strings to
p44970
aVThis applies to the headers, the url and the body
p44971
aVIf any of those three inputs contain Unicode values, automatic conversions between Unicode and strings will take place when concatenating, which will invariably lead to grief
p44972
as(dp44973
g16
V100297
p44974
stp44975
a((dp44976
g2
(lp44977
VYou are using  instead of ; this interprets the input as a Python expression
p44978
aVIt is easy to make that throw a SyntaxError exception:
p44979
aVUse  throughout instead:
p44980
aVYou probably want to turn these two questions around:
p44981
aVPython will ask for the value first
p44982
aVIf you need to ask for the key first, store it in a separate variable first:
p44983
as(dp44984
g16
V100297
p44985
stp44986
a((dp44987
g2
(lp44988
VUse  or  with a limit, then select the first element:
p44989
aVwill split on the last underscore,  on the first
p44990
aVPick the one that fits your usecase best
p44991
aVThis gives you everything before the first or last underscore for that filename
p44992
aVUsing this in a set comprehension, with  returning a list from that set:
p44993
aVFor Python 2
p44994
aV6 and earlier, where you don't yet have a set comprehension syntax, the following generator expression with  would work too:
p44995
as(dp44996
g16
V100297
p44997
stp44998
a((dp44999
g2
(lp45000
VYou misspelled the class name:
p45001
aVworks fine
p45002
aVThat's , not
p45003
aVThat's still misspelled, but slightly less so
p45004
as(dp45005
g16
V100297
p45006
stp45007
a((dp45008
g2
(lp45009
VFlatten the list, then join
p45010
aVdoes the flattening:
p45011
aVThis would put a  between all the items in all the sublists, writing them out as one long string
p45012
aVDemo:
p45013
aVIf you need the sublist each to be written to a new line, just loop over :
p45014
aVor use a nested list comprehension:
p45015
as(dp45016
g16
V100297
p45017
stp45018
a((dp45019
g2
(lp45020
VTest for boolean truth instead, and reverse your test so that you are certain that  will work in the first place,  would throw an exception:
p45021
aVThe empty string is 'false-y', there is no need to test it against anything
p45022
aVYou could even just test for:
p45023
aVfor the same end result
p45024
aVFrom comments, it appears you have newlines cluttering up your data
p45025
aVStrip those away when testing:
p45026
aVNote that you can simply alter  inside the loop; this avoids having to call  multiple times
p45027
as(dp45028
g16
V100297
p45029
stp45030
a((dp45031
g2
(lp45032
V is an attribute of  instances; not of  instances
p45033
aVYour  method is passed in a  instance as
p45034
aVI am not certain if  is set by the line , but if it is not, do add  in
p45035
aVYou can then refer to  on  instances, and the following should work:
p45036
aVI am not sure why you are setting the current class as an instance attribute:
p45037
aVand
p45038
aVInstead of  you can just call , the reference to the class is not needed
p45039
as(dp45040
g16
V100297
p45041
stp45042
a((dp45043
g2
(lp45044
VDo not use string interpolation
p45045
aVLeave the SQL parameter to the database adapter:
p45046
aVHere, we pass the parameter  in to the  call as a separate parameter (in a tuple, to make it a sequence), and the database adapter will take care of proper quoting, filling in the  placeholder
p45047
as(dp45048
g16
V100297
p45049
stp45050
a((dp45051
g2
(lp45052
V will open the file as unicode text
p45053
aVEither use plain , or use binary mode:
p45054
aVYou are sending the file contents straight out over the network, so you need to send bytes, not unicode, and as you found out, mixing Unicode and bytes leads to painful errors as python tries to automatically encode back to bytes using the ASCII codec when concatenating the two different types
p45055
aVThere is no need to decode to Unicode at all here
p45056
as(dp45057
g16
V100297
p45058
stp45059
a((dp45060
g2
(lp45061
VYou are using  which will only find the first occurrence of your value in the list
p45062
aVSo if you have a value 1
p45063
aV0 at index 2, and at index 9, then  will always return , no matter how many times  occurs in the list
p45064
aVUse  to add indices to your loop instead:
p45065
aVYou can collapse this into a list comprehension:
p45066
as(dp45067
g16
V100297
p45068
stp45069
a((dp45070
g2
(lp45071
VIn Python 2, a number starting with  is interpreted as an octal number, often leading to confusion for those not familiar with C integer literal notations
p45072
aVIn Python 3, you cannot start a number with  at all
p45073
aVRemove the leading 0s:
p45074
aVThe error is caused by  not being a valid octal number:
p45075
as(dp45076
g16
V100297
p45077
stp45078
a((dp45079
g2
(lp45080
VReturn early, that way you need far fewer  branches:
p45081
aVI've also removed the need to test for  being  in the  loop, removing another branch
p45082
as(dp45083
g16
V100297
p45084
stp45085
a((dp45086
g2
(lp45087
VYou need to add the newline:
p45088
aVor use :
p45089
aVWriting to a file does not automatically add newlines; only  does that
p45090
as(dp45091
g16
V100297
p45092
stp45093
a((dp45094
g2
(lp45095
VSure you can:
p45096
aVUsing explicit keyword parameters does not prevent you from passing in a dictionary as well
p45097
aVDemo:
p45098
as(dp45099
g16
V100297
p45100
stp45101
a((dp45102
g2
(lp45103
VYou want to use the  module here, together with a (short) list of binary numeric operator names, without the underscores for compactness:
p45104
aVNow just decorate your class:
p45105
aVThe decorator takes the name you wanted to delegate the call to to make this a little more generic
p45106
aVDemo:
p45107
as(dp45108
g16
V100297
p45109
stp45110
a((dp45111
g2
(lp45112
VThe MongoDB result includes the whole matched string, or group 0, as well as groups 1 and 2
p45113
aVThe Python  method only returns captured groups
p45114
aVThe  method would, without an argument, return group 0 too:
p45115
aVThis is documented in the  module documentation:
p45116
aVReturn a tuple containing all the subgroups of the match, from 1 up to however many groups are in the pattern
p45117
aVand for the  method:
p45118
aVReturns one or more subgroups of the match
p45119
aVIf there is a single argument, the result is a single string; if there are multiple arguments, the result is a tuple with one item per argument
p45120
aVWithout arguments, group1 defaults to zero (the whole match is returned)
p45121
aVNote that there are no back-references in your expression
p45122
aVA back-reference would look like this instead:
p45123
aVwhere the  refers to the capturing group just before it
p45124
aVThe back-reference will only match the exact same characters that the referenced group matched
p45125
aVDemo:
p45126
aVNote how only  is matched, not
p45127
aVYou can use named groups too:
p45128
aVwhere  is the group name
p45129
as(dp45130
g16
V100297
p45131
stp45132
a((dp45133
g2
(lp45134
VYou are looking for the  attribute of an element:
p45135
as(dp45136
g16
V100297
p45137
stp45138
a((dp45139
g2
(lp45140
VYou'll have to replace the file (so write to a temporary file)
p45141
aVHowever, the  module makes this easy for you:
p45142
aVThis example simply increments the  value by 1, you can adjust the code to do whatever you want with the  integer
p45143
aVBy specifying , the  module will move the original file to a backup, capture anything you write to , and write it to original file location instead
p45144
as(dp45145
g16
V100297
p45146
stp45147
a((dp45148
g2
(lp45149
VList slicing never throws an out-of-bounds error:
p45150
aVis legal, as is
p45151
aVNote that when slicing, the upper bound is not included in the slice:
p45152
aVso the slice  contains exactly the same elements as  without slicing, but does return a new list
p45153
aVSome other remarks:
p45154
aVIf you omit the start value, it defaults to , and the end value, if omitted, defaults to the length of the list
p45155
aVThus,  can be written as
p45156
aVnegative values count from the end
p45157
aVcan be written as
p45158
as(dp45159
g16
V100297
p45160
stp45161
a((dp45162
g2
(lp45163
VYou want to split on the whitespace between the  and  characters
p45164
aVFor that you need a regular expression split with look-behind and look-ahead assertions:
p45165
aVThis splits on any whitespace () that is preceded by a  and followed by a  character
p45166
aVThe  expression is a look-behind assertion; it matches a location in the input text, namely anywhere the pattern inside the assertion precedes the location
p45167
aVIn the above it matches anywhere there is a  character just before the current location
p45168
aVThe  expression works just like the look-behind assertion, but instead looks for matching characters after the current location
p45169
aVIt is known as a look-ahead assertion
p45170
aVmeans it'll match to any location that is followed by the  character
p45171
aVTogether these form two anchors, an the  in between will only match whitespace that sits between a  and a , but not those two characters themselves
p45172
aVThe split breaks up the input string by removing the matched text, and only the spaces are matched, leaving the  and  characters attached to the text being split
p45173
aVDemo:
p45174
as(dp45175
g16
V100297
p45176
stp45177
a((dp45178
g2
(lp45179
VYou want to do straight loops over the dict and handle each list directly:
p45180
aVThis uses  to loop through the columns of
p45181
aVWe then normalize each row against the maximum per column, and pick out the best row at the same time
p45182
aVNote that  just uses  instead, as that'd be the more efficient approach
p45183
aVTimings, measured with the  module, against the original sample:
p45184
aVand with one randomized set:
p45185
aVand with a randomized set each time (note, much lower repeat count):
p45186
aVBut it sounds like you are processing matrices here
p45187
aVYou need to look into  for a far more efficient library to process matrices like these
p45188
as(dp45189
g16
V100297
p45190
stp45191
a((dp45192
g2
(lp45193
V returns a boolean, so  will always be
p45194
aVJust omit the  part:
p45195
aVNext, it can never be both all upper and lower, or all upper and numbers or all lower and all numbers, so the second condition (medium) is impossible
p45196
aVPerhaps you should look for the presence of some uppercase, lowercase and digits instead
p45197
aVHowever, first another problem to address
p45198
aVYou are testing if the password is alphanumeric, consisting of just characters and/or numbers
p45199
aVIf you want to test for just numbers, use
p45200
aVYou may want to familiarize yourself with the string methods
p45201
aVThere are handy  and  methods available that you might want to try out, for example:
p45202
aVThese are faster and less verbose that using , the following will test the same:
p45203
aVNext trick you want to learn is to loop over a string, so you can test individual characters:
p45204
aVIf you combine that with the  function, you can test if there are some characters that are numbers:
p45205
aVI think you'll find those tricks handy when testing for password strengths
p45206
as(dp45207
g16
V100297
p45208
stp45209
a((dp45210
g2
(lp45211
VThe instance merely references it's class
p45212
aVNo extra memory is required to hold those two methods beyond the class definition
p45213
aVFrom a memory perspective, the class definition itself is little more that a tuple of refences to the base classes, a reference to it's metatype ( by default) and a dictionary for the attributes (which includes all the methods)
p45214
aVInstances are just a reference to the class, plus either a dictionary of attributes or a fixed set of attributes when using  (the latter is more memory efficient but disallows arbitrary extra attributes to be set)
p45215
as(dp45216
g16
V100297
p45217
stp45218
a((dp45219
g2
(lp45220
V explicitly only finds direct children of a tag
p45221
aVThe expression to find all descendants is  (double slash)
p45222
aVA simplified version of your loop against the sample given, then results in:
p45223
aVor using  to show string literals instead:
p45224
as(dp45225
g16
V100297
p45226
stp45227
a((dp45228
g2
(lp45229
VYour generator doesn't loop over any sublists; all it does is yield items from the outer list
p45230
aVThe  loop doesn't loop over the items the generator yields, it loops over the generator itself
p45231
aVYou need to add the extra level:
p45232
aVYou can see this when you assign your generator to a variable then use  on that:
p45233
as(dp45234
g16
V100297
p45235
stp45236
a((dp45237
g2
(lp45238
VYou need to create new random digits each loop:
p45239
as(dp45240
g16
V100297
p45241
stp45242
a((dp45243
g2
(lp45244
VYou are using split the wrong way around; split the line, not the  space:
p45245
aVBy splitting the space character by  delimiters, you invariably are going to end up with , not an empty string:
p45246
aV(the exceptions being an empty delimiter, not allowed, and splitting on , which gives you two empty strings instead)
p45247
aVAnd the one and only element in the result, , is a non-empty string, so True in a boolean context
p45248
aVAs for the error message,  ignores leading and trailing whitespace
p45249
aVWhat is left is an empty string:
p45250
aVYou probably want to even omit the  argument wen splitting and just split on variable-width whitespace:
p45251
aVleaving the first argument set to the default,
p45252
aVUsing  also ignores any leading and trailing whitespace, always handy when reading lines from a file, those would include a newline:
p45253
aVFrom the documentation:
p45254
aVIf sep is not specified or is , a different splitting algorithm is applied: runs of consecutive whitespace are regarded as a single separator, and the result will contain no empty strings at the start or end if the string has leading or trailing whitespace
p45255
aVConsequently, splitting an empty string or a string consisting of just whitespace with a  separator returns
p45256
as(dp45257
g16
V100297
p45258
stp45259
a((dp45260
g2
(lp45261
VYou forgot to call  and stored the method instead:
p45262
aVNote the first version, I only reference the method without calling it, resulting in a reference to the function
p45263
aVThe second line shows that if you call  the stripped text is returned
p45264
as(dp45265
g16
V100297
p45266
stp45267
a((dp45268
g2
(lp45269
VYou are trying to use the file object, not the filename
p45270
aVEither use  or use
p45271
aVYou also want to switch to using files as context managers (with the  statement) so that they are closed automatically, and perhaps the  module is of interest to you as well
p45272
aVUsing :
p45273
aV(note the omission of  here
p45274
aVUsing ; the  is automatically cleaned up on close:
p45275
aVYou also want to minimize what you put in a  block, only catch the  when actually reading image data, not before
p45276
as(dp45277
g16
V100297
p45278
stp45279
a((dp45280
g2
(lp45281
VBecause the core of Mac OS X is the Darwin OS
p45282
aVQuoting from the linked WikiPedia page:
p45283
aVDarwin forms the core set of components upon which Mac OS X and iOS are based
p45284
aVEven the OS X platform itself reports itself as "Darwin" when you ask it:
p45285
aVPython merely uses that same platform identifier
p45286
as(dp45287
g16
V100297
p45288
stp45289
a((dp45290
g2
(lp45291
VDon't use ; it treats its argument as a set of characters, not a specific sequence
p45292
aVAs such, you are removing all characters in the set  and that removes far more than you think it does:
p45293
aVUse string slicing instead:
p45294
aVor use :
p45295
aVDemos:
p45296
as(dp45297
g16
V100297
p45298
stp45299
a((dp45300
g2
(lp45301
VUse the  module to wrap lines to a maximum width
p45302
aVYou can specify  as indentation to prefix your lines properly:
p45303
aVThe module is very flexible, do read the documentation to see what knobs you want to twiddle for the perfect result
p45304
as(dp45305
g16
V100297
p45306
stp45307
a((dp45308
g2
(lp45309
VYou want to use ; it'll do the counting for you:
p45310
aVI used a  for the vowels, as that makes for faster membership () testing
p45311
aVNote that you cannot name your function and your list the same;  replaced the list
p45312
aVName the function something different
p45313
aVDemo:
p45314
as(dp45315
g16
V100297
p45316
stp45317
a((dp45318
g2
(lp45319
V only applies to primary keys
p45320
aVSo for a given table, you can use  to determine what column is the primary key:
p45321
aVSo the last column in the row is the  row, and for  that is set to
p45322
aVTo determine if the primary key is autoincrementing at all you can do one of two things:
p45323
aVQuery the  table and check if  is mentioned in the schema:
p45324
aVIf you have inserted data, the table name will appear in the  table:
p45325
as(dp45326
g16
V100297
p45327
stp45328
a((dp45329
g2
(lp45330
VIf you are using the  library, ou can just sum everything, then take the  portion of the fraction:
p45331
aVThe  class implements  for you, you can just sum up integers and  objects and it all works as it should
p45332
aVDemo using constants:
p45333
aVOne little-known but handy factoid is that Python the  type has both  and  attributes, that the  class makes use of
p45334
aVIf you are not using the  library, you can make use of that yourself:
p45335
as(dp45336
g16
V100297
p45337
stp45338
a((dp45339
g2
(lp45340
VThe default configuration set by  logs messages to , and cron interprets any output to the  filehandle as email-worthy; you are, after all, not redirecting it
p45341
aVSee the  documentation:
p45342
aVDoes basic configuration for the logging system by creating a  with a default  and adding it to the root logger,
p45343
aVand the  docs:
p45344
aVIf stream is specified, the instance will use it for logging output; otherwise,  will be used
p45345
aVThe work-around is to not set up a stream handler, or pick a different stream, or to pick a filename to log to:
p45346
aVor
p45347
aVBy logging to  you write logging information to the same output stream as  does
p45348
aVAnother work-around is to redirect  to :
p45349
as(dp45350
g16
V100297
p45351
stp45352
a((dp45353
g2
(lp45354
VReturn a new instance of  instead:
p45355
aVor, to make it more sub-class-friendly, of :
p45356
aVNow your code prints:
p45357
aVbut you could print the old result of  explicitly:
p45358
aVYou could make that your  method:
p45359
aVafter which your  statements would be:
p45360
as(dp45361
g16
V100297
p45362
stp45363
a((dp45364
g2
(lp45365
VYou can append simply by using :
p45366
aVwhich can be combined with an in-place addition assignment:
p45367
aVbut this is not nearly as efficient as joining the whole sequence with :
p45368
aVThe latter is of course, rather pointless, as we just took all individual characters of , and rejoined them into a new, otherwise equal, string
p45369
aVBut it is far more efficient than calling  in a loop, as  only has to create a new string once, while a loop with  creates new strings for each concatenation
p45370
aVIt gets more interesting when you use a delimiter:
p45371
aVThe thing to note here is that you call  on the delimiter string, not on the sequence you are about to join
p45372
as(dp45373
g16
V100297
p45374
stp45375
a((dp45376
g2
(lp45377
VEncoding produces byte values, but you are using string values to try to replace things
p45378
aVUse Byte literals instead:
p45379
as(dp45380
g16
V100297
p45381
stp45382
a((dp45383
g2
(lp45384
VFirst of all, there are better ways to convert a textual date-time format into a UNIX timestamp
p45385
aVDirect use of the  module simplifies your code to:
p45386
aVbut even the  object you created has  and  methods that would be miles more reliable at producing a  tuple than parsing the string format of the  object back to a tuple of integers
p45387
aVYou may as well do that directly on  as the output of  is the same format as what you started with
p45388
aVNext, write out a new file and replace the old one with it once done:
p45389
as(dp45390
g16
V100297
p45391
stp45392
a((dp45393
g2
(lp45394
VUse the  function:
p45395
aVThis formats the input value as a 2 digit hexadecimal string with leading zeros to make up the length, and  includes the 'standard prefix',  in this case
p45396
aVNote that the width of 4 includes that prefix
p45397
aVproduces lower-case hex strings; use  if you need uppercase
p45398
aVDemo:
p45399
as(dp45400
g16
V100297
p45401
stp45402
a((dp45403
g2
(lp45404
VIf your addresses are always on the end of a line, then anchor on that:
p45405
aVThis regular expression only matches dotted quads (4 sets of digits with dots in between) at the end of a line
p45406
aVDemo:
p45407
as(dp45408
g16
V100297
p45409
stp45410
a((dp45411
g2
(lp45412
VThe inputs are  and , as bytes
p45413
aVThe input is taken as ASCII characters, the values are thus 52 and 51
p45414
aVThe first input is decremented by 8, 6 times, so 52 - 48 = 4
p45415
aVThe second input is added to the first input, so 4 plus 51 = 55
p45416
aV55 is written to the output, and that is ASCII
p45417
aVThe program sums up two ASCII digits
p45418
aVThe JavaScript interpreter is entirely correct
p45419
aVYou were looking at the first register, which holds the byte value of , but the output box shows , the ASCII character
p45420
as(dp45421
g16
V100297
p45422
stp45423
a((dp45424
g2
(lp45425
VYou cannot read from a file, or a  object twice without reopening or rewinding to the start
p45426
aVFiles are like a tape; as you read the file positions advances until it reaches the end
p45427
aVAfter that more attempts to read from them only results in no data being returned
p45428
aVTo rewind a file, use the  method:
p45429
aVNote that your code seems to do an awful lot of extra work that is entirely not needed
p45430
aVmerely loops over the input sequence building a copy of the sequence, where no actual copies are needed
p45431
aVIn fact, you don't need to read anything twice, the code can be simplified to:
p45432
aVNote how the code addends to the  list; there is absolutely no need for you to build 6 separately named lists from separate  files and then later combine them into one list here
p45433
aVI didn't see how you used the sorted  and  lists, I included them in the code but didn't append them anywhere
p45434
aVUse them in a similar vein, or completely remove the lines with  if you do not need these lists anywhere
p45435
as(dp45436
g16
V100297
p45437
stp45438
a((dp45439
g2
(lp45440
VIf you are opening the input file using  then you have unicode data, not encoded data
p45441
aVYou would want to just decode , not encode it again to UTF-8:
p45442
aVNote that we print unicode as well; normally  will ensure that Unicode values are encoded again for your current codepage
p45443
aVThis can still fail as Windows console printing is notoriously difficult, see http://wiki
p45444
aVpython
p45445
aVorg/moin/PrintFails
p45446
aVUnfortunately,  on Windows can apparently end up garbled, as Python uses a non-unicode aware system call
p45447
aVSee Read Unicode characters from command-line arguments in Python 2
p45448
aVx on Windows for a unicode-aware alternative
p45449
aVI see no reason for  to have any problems with Unicode input, but if it does, you can always take the unicode output from  and encode it to UTF-8 before passing it to
p45450
as(dp45451
g16
V100297
p45452
stp45453
a((dp45454
g2
(lp45455
VBoth Python and C let you define integers using hex literals
p45456
aVThey are interpreted as base-16, but their value is still an integer
p45457
aVIt is nothing more than an alternate notation for the same values:
p45458
aVYou can also use octal (, or, in python 2 only, ) or binary () notation to specify the same integer value
p45459
aVThe signature specifies it wants an , so pass in an integer value
p45460
aVSpecify that integer value as a hex literal in your Python source code if you want, but the C code just expects an integer value, and doesn't care wether or not you used hexadecimal notation to create that value
p45461
aVIf the function call is not working with the correct constants, then something else is wrong
p45462
as(dp45463
g16
V100297
p45464
stp45465
a((dp45466
g2
(lp45467
VGroup the items on the first column into a dictionary; a  makes that a little easier:
p45468
aVsimply calls the passed-in factory to produce a default value if a key isn't present  ( in this case, producing a ):
p45469
aVDemo:
p45470
aVThen printing the sums is as simple as:
p45471
aVIf your input list is sorted, use :
p45472
aVDemo:
p45473
aVIn fact, with a sorted list and  you can switch straight to printing:
p45474
aVWithout external modules I'd just go for a dictionary; this is going to be slower than either of the above options:
p45475
aVor, for the sorted variant:
p45476
as(dp45477
g16
V100297
p45478
stp45479
a((dp45480
g2
(lp45481
VYou are getting confused by the Python string representation
p45482
aVWhen you print a python list, the contents are shown in special representation to make debugging easier; each value is shown is the result of calling the  function on that value
p45483
aVFor unicode values, that means the result is a unicode string representation, and that is not the same thing as what you see when the string is printed directly
p45484
aVUnicode and byte strings, when shown like that, are presented as string literals; quoted values that you can copy and paste straight back into Python code without having to worry about encoding; anything that is not a printable ASCII character is shown in quoted form
p45485
aVUnicode code points beyond the latin-1 plane are shown as  escape sequences
p45486
aVCharacters in the latin-1 range use the  escape sequence
p45487
aVMany control characters are shown in their 1-letter escape form, such as  and
p45488
aVThe python interactive prompt does the same thing; when you echo a value on the prompt without using , the value in 'represented', shown in the  form:
p45489
aVThis entirly normal behaviour
p45490
aVIn other words, your code works, nothing is broken
p45491
aVTo come back to your code, if you want to extract just the  key from the tweet JSON structures, filter while reading the file, don't bother with looping twice:
p45492
as(dp45493
g16
V100297
p45494
stp45495
a((dp45496
g2
(lp45497
VProperties only work on instances of a class
p45498
aVYou are accessing the property object itself, directly, on the class:
p45499
aVHere  is a class,  is an instance of that class
p45500
aVUse properties only when you need to either make the attribute read-only, or when you need to run code to either get or set the values
p45501
aVDon't just use attributes like you would in Java, there is no need to do so in Python
p45502
aVPython is not Java
p45503
aVIn Java, you have to use getters and setters because you cannot change your mind and change the public fields to getters and setters later on
p45504
aVIn python, you can, so don't use getters and setters until you have an actual need to
p45505
aVIf you want to know the full ins and outs of how Python properties work, read the Python Descriptor HOWTO; the  object is a descriptor, as are methods on Python classes; through the magic of  and  methods they transform attribute access on instances
p45506
as(dp45507
g16
V100297
p45508
stp45509
a((dp45510
g2
(lp45511
VIt is not a bug
p45512
aVThe  loop does not create a new scope
p45513
aVOnly functions and modules introduce a new scope, with classes, list/dict/set comprehensions*, lambdas and generators being specialized functions when it comes to scoping
p45514
aVThis is documented in the  loop statement documentation:
p45515
aVThe target list is not deleted when the loop is finished, but if the sequence is empty, it will not have been assigned to at all by the loop
p45516
aVA practical use of this feature is getting the last item of an iterable:
p45517
aV* List comprehensions in Python 2 work like  loops, no new scope, but in Python 3 they, as well as dict and set comprehensions across Python versions, do create a new scope
p45518
as(dp45519
g16
V100297
p45520
stp45521
a((dp45522
g2
(lp45523
VHere's how I'd recode your graph builder; using the  module and  class make the code vastly more readable:
p45524
aVThere is no need to use sets here
p45525
aVNote that I used more meaningful variable names; try to avoid  and  unless they are integer indices
p45526
as(dp45527
g16
V100297
p45528
stp45529
a((dp45530
g2
(lp45531
VBecause the Python list object decreases the reference counts of the items it references in reverse order:
p45532
aVSee that comment; removing references starting from the end apparently reduces thrashing in some cases with large lists
p45533
aVMy guess is that when you create a very large list, the last items are still in the cache and dereferencing those first helps reduce cache churn
p45534
aVAdd swapping and starting from the end makes an even bigger difference
p45535
as(dp45536
g16
V100297
p45537
stp45538
a((dp45539
g2
(lp45540
VYou need to loop over the range, then check if that key is in the dictionary:
p45541
aVNote that the values produced by  do not include the end point, so I used  to ensure it is included anyway
p45542
aVIf your keys are not integers but, say,  objects, you'll have to construct some kind of loop with  to iterate over all dates between two values:
p45543
as(dp45544
g16
V100297
p45545
stp45546
a((dp45547
g2
(lp45548
VGenerally, you don't use getters and setters in Python; unless you need to transform the value, need side-effects during setting or getting, or need to prevent either getting or setting, you just use attributes instead:
p45549
aVInstance attributes are separate from class attributes; setting attributes on  means you are manipulating the instance, attributes on the class () are class attributes and are thus shared amongst instances
p45550
aVThis is achieved by using the class as a fallback when looking up attributes; first the instance is queried, then the class of the instance, then the base classes of the class; setting  means that any  is no longer visible on the instance
p45551
aVThe  method is indeed, technically, not a constructor
p45552
aValready exists when  is called
p45553
aVIt is instead an initializer, you set the first values with it
p45554
aVIf you need an actual constructor (instance factory) you need to look for the  static method instead
p45555
aVNote that in PHP,  is an initializer as well, not a constructor
p45556
aVFor those cases where you do have a need to create setters and getters, use the  decorator function:
p45557
aVDemo:
p45558
as(dp45559
g16
V100297
p45560
stp45561
a((dp45562
g2
(lp45563
VYou create a new tuple with 4 times the same referenced value
p45564
aVSee the Sequence types reference
p45565
aVshallow copies of  concatenated
p45566
aVNote that it's the exact same value that is reused; you see this when you use a mutable value:
p45567
as(dp45568
g16
V100297
p45569
stp45570
a((dp45571
g2
(lp45572
VThere is no need to add anything to your module search path; the SQLite module comes with the Python standard library
p45573
aVHowever, you misspelled the name of the module, it is called  (note the  on the end):
p45574
aVIf you get errors still, your homebrew installation is broken; you probably ran into this bug
p45575
aVRun:
p45576
aVto repair
p45577
as(dp45578
g16
V100297
p45579
stp45580
a((dp45581
g2
(lp45582
VYou don't need to use  (or , which is the exact same library; it was renamed when bundled with Python); the  library already decoded everything from JSON for you
p45583
aVYou got a list from the API, each entry is a ; each such dictionary is a Tweet
p45584
aVYou can see what is contained in the Twitter API documentation
p45585
aVLoop over that list; some items are dictionaries or lists themselves:
p45586
aVTo figure out the full structure, use  to print a structured version:
p45587
aVwhich will make it easier for you to figure out what you can loop over, etc
p45588
as(dp45589
g16
V100297
p45590
stp45591
a((dp45592
g2
(lp45593
VAny callable can be used, so you could use a class to track the numbering:
p45594
aVNow the counter state is contained in the  instance, and  will be set anew each time you start a  run
p45595
as(dp45596
g16
V100297
p45597
stp45598
a((dp45599
g2
(lp45600
VYou could put in the linebreaks yourself, using :
p45601
as(dp45602
g16
V100297
p45603
stp45604
a((dp45605
g2
(lp45606
VUse the  module for ease of use, then a list comprehension:
p45607
aVNote that I use  to pick out the last element of each row
p45608
aVYour code never added anything to ; a  would have fixed that
p45609
as(dp45610
g16
V100297
p45611
stp45612
a((dp45613
g2
(lp45614
VDon't read the whole file in one go, read per line, then split:
p45615
aVYou could also first split on newlines, then loop and split on commas:
p45616
aVBut for comma-separated files, your best bet is to use the  module:
p45617
aVThis gives you the rows as:
p45618
aVSince you have a first row with headers, you could use a  as well and get dictionaries mapping headers to values:
p45619
aVwhich outputs rows as:
p45620
as(dp45621
g16
V100297
p45622
stp45623
a((dp45624
g2
(lp45625
VUse  to combine two input sequences while processing:
p45626
aVThis will work with lists too;  makes merging of long lists efficient; it is the iterator version of the  function, which, in python 2, materializes the whole combined list in memory
p45627
aVIf you can possibly retool the functions that create your input lists into generators, use that:
p45628
aVThis arrangement makes that you can process gigabytes of information while only holding in memory what you need to process one small set of rows
p45629
as(dp45630
g16
V100297
p45631
stp45632
a((dp45633
g2
(lp45634
VUse the  module, which handles files correctly when replacing data, with the  flag set:
p45635
aVWhen you use the  flag, the original file is moved to a backup, and anything your write to  is written to the original filename (so, as a new file)
p45636
aVMake sure you include all lines, altered or not
p45637
aVYou have to rewrite the complete file whenever your replacement data is not exactly the same number of bytes as the parts that you are replacing
p45638
as(dp45639
g16
V100297
p45640
stp45641
a((dp45642
g2
(lp45643
VFilter the list afterwards; either turn the filename portion to an  or create a range of strings that are to be included:
p45644
aVThe above code generates the strings   through to  as a set of strings for fast membership testing, then tests the first 4 characters of each file against that set; because  returns whole filenames we slice off the path for that to work
p45645
aVFor variable paths, I'd store the slice offset, for speed, based on the path:
p45646
aVDemo of the latter:
p45647
as(dp45648
g16
V100297
p45649
stp45650
a((dp45651
g2
(lp45652
VYou can use a ; build it from the first row yourself:
p45653
aVThis is essentially what  does; take the keys from the first row
p45654
aVNote that the  code creates the dictionary with ; this reuses the same strings for each row, and the only memory overhead you have is the  table itself plus the hash values for the keys (these are recalculated each time and cached)
p45655
aVThe strings for the keys are not created anew for each row
p45656
aVThe  approach doesn't either, but doesn't need to keep hashes since  are used
p45657
as(dp45658
g16
V100297
p45659
stp45660
a((dp45661
g2
(lp45662
VRemove the  call to see the difference
p45663
aVWhen you do not pipe the  output to Python, it is instead displayed on your terminal directly; it's output goes to your terminal
p45664
aVIf you pipe it to Python, you get to see the whole contents as bytes, including newline bytes (represented as )
p45665
aVDecode the results if you want the newlines to be printed literally:
p45666
as(dp45667
g16
V100297
p45668
stp45669
a((dp45670
g2
(lp45671
VThe  module is fairly low-level, giving you almost direct access to the C library functionality
p45672
aVYou can always use the  decorator to build your own:
p45673
aVor use  to achieve the same effect:
p45674
aVbut the  decorator gives you the opportunity to do other things with the socket first
p45675
aVPython 3
p45676
aVx does make  a context manager, even though the documentation fails to mention that
p45677
aVSee the  class in the source code, which adds  and  methods
p45678
as(dp45679
g16
V100297
p45680
stp45681
a((dp45682
g2
(lp45683
VThe target name the  statement binds the contextmanager  return value to (the name after ) is not scoped to just the  statement
p45684
aVLike  loop variable, the  target name is scoped in the current function or module namespace
p45685
aVThe name does not disappear or is otherwise cleared when the  suite ends
p45686
aVAs such,  outside of the  statement is perfectly legal, if somewhat nonsensical
p45687
aVAll that the  statement guarantees is that the  method will have been called when the block completes (be that by reaching the end of the block, or because of a ,  or  statement, or because an exception has been raised)
p45688
aVThat said, you'd be better off just moving the return inside the  statement:
p45689
aVand
p45690
aVThe context manager will still be cleaned up properly, but now the  statement looks like it is a logical part of the  block
p45691
aVThe execution order is not altered;  is called, then the function returns
p45692
aVAs always, the Python documentation on the  syntax is excellent
p45693
aVYou could also review the documentation on context managers and the original proposal, PEP-343
p45694
as(dp45695
g16
V100297
p45696
stp45697
a((dp45698
g2
(lp45699
VInside the  function, you are assigning to the , , etc
p45700
aVvariables
p45701
aVThat makes those variables local to that function, but you also try to test their contents at the start
p45702
aVThis is where your error comes from
p45703
aVYou'd have to declare those variables :
p45704
aVYou may want to use a list instead:
p45705
aVand
p45706
aVThis has the added advantage that now you no longer need a  keyword either; you are no longer assigning to  but to the indices contained in
p45707
aVYou are mutating , not replacing it with another value
p45708
aVOther remarks; the line:
p45709
aValso won't work; I think you meant that to be:
p45710
aVbut with a list that could be:
p45711
aVor perhaps
p45712
aVWhen testing for a specific string, use , not
p45713
aVThe latter works but has to do two things; loop over the list and test for equality on each element
p45714
aVgoes straight for the equality test
p45715
as(dp45716
g16
V100297
p45717
stp45718
a((dp45719
g2
(lp45720
VPerhaps the easiest way is to not use ElementTree to process HTML, but to use BeautifulSoup instead; the library handles unwrapping explicitly through the  method:
p45721
as(dp45722
g16
V100297
p45723
stp45724
a((dp45725
g2
(lp45726
VThe return value is not ignored, but generators only yield values, a  just ends the generator, in this case early
p45727
aVAdvancing the generator never reaches the  statement in that case
p45728
aVWhenever a iterator reaches the 'end' of the values to yield, a  must be raised
p45729
aVGenerators are no exception
p45730
aVAs of Python 3
p45731
aV3 however, any  expression becomes the value of the exception:
p45732
aVUse the  function to advance iterators, instead of calling  directly:
p45733
as(dp45734
g16
V100297
p45735
stp45736
a((dp45737
g2
(lp45738
VAs soon as you use a  statement in a function body, it becomes a generator
p45739
aVCalling a generator function just returns that generator object
p45740
aVIt is no longer a normal function; the generator object has taken over control instead
p45741
aVFrom the  expression documentation:
p45742
aVUsing a  expression in a function definition is sufficient to cause that definition to create a generator function instead of a normal function
p45743
aVWhen a generator function is called, it returns an iterator known as a generator
p45744
aVThat generator then controls the execution of a generator function
p45745
aVThe execution starts when one of the generator\u2019s methods is called
p45746
aVIn a regular function, calling that function immediately switches control to that function body, and you are simply testing the result of the function, set by it's  statement
p45747
aVIn a generator function,  still signals the end of the generator function, but that results in a  exception being raised instead
p45748
aVBut until you call one of the 4 generator methods (, ,  or ), the generator function body is not executed at all
p45749
aVFor your specific function , you have a regular function, that contains a generator
p45750
aVThe function itself is nothing special, other that that it exits early when  is executed
p45751
aVThe generator expression on the next line stands on its own, it does not influence the function in which it is defined
p45752
aVYou can define it without the function:
p45753
aVUsing a generator expression produces a generator object, just like using  in a function, then calling that function produces a generator object
p45754
aVSo you could have called  in  with the same result as using the generator expression:
p45755
aVis still a generator function, but using it in  does not make  a generator function too
p45756
aVOnly  can do that
p45757
as(dp45758
g16
V100297
p45759
stp45760
a((dp45761
g2
(lp45762
VDo use the correct methodology when comparing algorithms; use the  module to eliminate fluctuations in CPU utilization and swapping
p45763
aVUsing  shows there is little difference between the two approaches, but  is slightly faster:
p45764
aVMost of the work in your functions is the looping over each and every character and testing for quotes and spaces, not string concatenation itself
p45765
aVMoreover, the  variant does more work; you are appending the elements to a list first (this replaces the  string concatenation operations), then you are concatenating these values at the end using
p45766
aVAnd that method is still ever so slightly faster
p45767
aVYou may want to strip back the work being done to compare just the concatenation part:
p45768
aVwhich shows:
p45769
aVThis shows  concatenation is still a heck of a lot faster than
p45770
aVThe speed difference lies in the loop;  is a list in both cases, but  loops over the values in C, while the other version has to do all it's looping in Python
p45771
aVAnd that makes all the difference here
p45772
as(dp45773
g16
V100297
p45774
stp45775
a((dp45776
g2
(lp45777
VJust convert everything but the first column:
p45778
aVJudging from your other question you are processing a CSV file, so if the first column is always a string there is no point in converting that part of each row:
p45779
aVYou could also use a  -  approach, but why incur the overhead when it is known up front what column has text and what columns have numeric values
p45780
as(dp45781
g16
V100297
p45782
stp45783
a((dp45784
g2
(lp45785
VUse named patterns; giving your pattern a unique name:
p45786
aVthen refer to those names in the  tag instead of the view:
p45787
as(dp45788
g16
V100297
p45789
stp45790
a((dp45791
g2
(lp45792
VYou should pass  a list, you are passing in a single string instead
p45793
aVStrings are sequences too, so  treats every character as a separate element instead:
p45794
as(dp45795
g16
V100297
p45796
stp45797
a((dp45798
g2
(lp45799
VThat same ZCML file registers a  adapter; this adapter adapts the  object to  to intercept traversal
p45800
aVIn the  adapter  method, when the  name is traversed over, the adapter returns the same  view:
p45801
aVSee the  class definition
p45802
as(dp45803
g16
V100297
p45804
stp45805
a((dp45806
g2
(lp45807
VIf you are running  as a script, the parent directory of  is not added to
p45808
aVThe  directory itself is added instead (not as a package but as a import search path)
p45809
aVYou have 3 options:
p45810
aVMove  out of the  package (next to it)
p45811
aVAdd a new script file next to  that only runs:
p45812
aVAdd the parent directory of  to :
p45813
aVThis last option can introduce more problems however; now both the  package and the modules contained in the  package are on
p45814
aVYou can import both  and  and Python will see these as two separate modules, each with their own entry in , with separate copies of their globals
p45815
as(dp45816
g16
V100297
p45817
stp45818
a((dp45819
g2
(lp45820
VYou are stripping empty lines; skip them with a simple :
p45821
aVYou can simplify those lines with a list comprehension:
p45822
aV(no need to use  before these lines now)
p45823
aVAlternatively, filter the lines after the fact:
p45824
aVor
p45825
as(dp45826
g16
V100297
p45827
stp45828
a((dp45829
g2
(lp45830
VThere is no  tag in your actual HTML
p45831
aVIn your browser DOM, the  tag is often an automatic tag; it is inserted because the HTML specification states there should be one, but that doesn't mean your actual HTML source has that tag in it
p45832
aVBeautifulSoup does not add it for you
p45833
aVGo straight for the  tags:
p45834
as(dp45835
g16
V100297
p45836
stp45837
a((dp45838
g2
(lp45839
VDon't
p45840
aVFactor out the calls you need to unit test, and move your exception handler out:
p45841
aVand test
p45842
aVAlternatively, use the  library to test the logging itself:
p45843
as(dp45844
g16
V100297
p45845
stp45846
a((dp45847
g2
(lp45848
VGlobals are limited to the current module
p45849
aVInstead of using globals, pass in the list as a parameter:
p45850
aVand call  with your bodies list from the module that does define the global
p45851
as(dp45852
g16
V100297
p45853
stp45854
a((dp45855
g2
(lp45856
VUse the  function instead, and simply stop iterating when you have what you want:
p45857
as(dp45858
g16
V100297
p45859
stp45860
a((dp45861
g2
(lp45862
VYou need to either use a  instead (with matching fieldnames), or turn the dictionary row into a sequence:
p45863
aVwould output the values sorted by their key, for example
p45864
aVUsing a  could be as simple as:
p45865
aVwhich would write the exact same fields, in the same order, as what your  class is expecting
p45866
as(dp45867
g16
V100297
p45868
stp45869
a((dp45870
g2
(lp45871
VUse a  for your field
p45872
aVYou can do range searches on field indexes using the  keyword:
p45873
aVwould return matches for which the index  value is 10
p45874
aV5 or less
p45875
aVFor a strict , subtract  to the query value:
p45876
as(dp45877
g16
V100297
p45878
stp45879
a((dp45880
g2
(lp45881
VTo get just the textual data, use :
p45882
as(dp45883
g16
V100297
p45884
stp45885
a((dp45886
g2
(lp45887
VBecause C-defined functions are a different type, and only user-defined functions support certain functionality, like adding attributes or nesting the function definitions and referring to scoped names
p45888
aVTake a look at the extra attributes a user-defined function gives you:
p45889
aVA C-defined function will never have a closure, or globals, nor does it have bytecode, for example
p45890
aVBreaking each one out:
p45891
aV: the annotations added to a function definition; you can only do this with user-defined functions, as this is a Python syntax feature
p45892
aV: the list of cells taken from the scope closure; C-defined functions cannot be defined inside another function, so there is no closure for those
p45893
aV: The Python bytecode object; C-defined functions don't have that
p45894
aV: C-defined functions may have default values (keywords) but they are not defined as Python values that you can introspect
p45895
aV: C-defined functions cannot have arbitrary attributes set on them, while user-defined functions can
p45896
aV: This makes a user-defined function a descriptor, making them work as methods in classes
p45897
aVMost C-functions don't need this
p45898
aV: User-defined functions are defined in modules; this points to the global namespace
p45899
aVC-defined functions don't have a python module namespace to point to
p45900
aV: like  but for keyword-only parameters, as a dict; again only Python functions can have these
p45901
as(dp45902
g16
V100297
p45903
stp45904
a((dp45905
g2
(lp45906
VYes, because the automatic concatenation of strings only applies to string literals
p45907
aVIt won't work with variable names:
p45908
aVis a syntax error
p45909
aVThe automatic concatenation is a feature of the parser; if you define multiple string literals within an expression that are not separated, they get auto-joined into one when compiling, not when running the code
p45910
aVSee String literal concatenation in the lexical analysis documentation
p45911
aVNote that you don't need to use  continuation slashes within parethesis (such as a function call)
p45912
as(dp45913
g16
V100297
p45914
stp45915
a((dp45916
g2
(lp45917
VUse :
p45918
aVgives you both the index and the value of the iterable you pass in
p45919
aVNote that the  test goes at the end; list comprehensions should be written in the same order that you would use when nesting loops:
p45920
aVYou really want to make  a set:
p45921
aVto make membership testing a O(1) constant time operation as opposed to a O(n) linear time test against a list
p45922
aVDemo:
p45923
as(dp45924
g16
V100297
p45925
stp45926
a((dp45927
g2
(lp45928
VDon't parse out the individual components; go straight for a  object:
p45929
aVYou can still get the individual components from that:
p45930
aVor format them back to zero-padded strings:
p45931
aVDemo:
p45932
aVTo turn the  value to seconds since the epoch, use  or , depending on your needs:
p45933
aVWithout a timezone there is no difference between these two methods, with a timezone the latter will always return the time as UTC
p45934
as(dp45935
g16
V100297
p45936
stp45937
a((dp45938
g2
(lp45939
VYour expression is almost unreadable, and most of the  backslashes are actually meaningless
p45940
aVThose that do have meaning though are the ,  and  combinations, most of which look like they should not be there at all
p45941
aVFor example
p45942
aVthe part  is broken, as the escaped  makes the  bracket unbalanced
p45943
aVRemoving all the backslashes makes the pattern compile:
p45944
aVNot that the pattern makes any more sense in that case, as there is a  there at the start signifying a opening character class, but the characters that follow it suggest that that was not the intent there, the  we saw early might be part of that class then but then you'd be matching anything that is not in the set , which is probably not what you wanted either
p45945
aVIn short, the whole expression is severely broken, and won't work in the current form in any Python version
p45946
aVIt also looks like you are trying to parse HTML with a regular expression
p45947
aVThat is not going to work very well
p45948
aVUse a proper HTML parser instead, BeautifulSoup for example would make the task of extracting table cell data much simpler
p45949
as(dp45950
g16
V100297
p45951
stp45952
a((dp45953
g2
(lp45954
VYou can monkeypatch  by replacing the methods with the decorated version:
p45955
aVDecorator syntax is just syntactic sugar, after all,  is just a callable whose result replaces the decorated function:
p45956
aVis effectively translated to:
p45957
aVAlternatively, if you prefer to still use a subclass, do the same thing in the body of the class:
p45958
aVIn Python 2, you'd need to unwrap the function first:
p45959
as(dp45960
g16
V100297
p45961
stp45962
a((dp45963
g2
(lp45964
VUse the  recipe  to skip  elements:
p45965
aVNote the  call there; it uses , effectively not returning anything, and the  function falls back to the default
p45966
aVSimplified to your example, where you want to skip 999999 elements, then return element 1000000:
p45967
aVprocesses the iterator in C, something that Python loops cannot beat
p45968
aVTo illustrate, here are the timings for just 10 repeats of each method:
p45969
aVThe  method is nearly 7 times faster than the next fastest method
p45970
as(dp45971
g16
V100297
p45972
stp45973
a((dp45974
g2
(lp45975
VUse an  clause to the  loop:
p45976
aVSee the  statement documentation:
p45977
aVA  statement executed in the first suite terminates the loop without executing the  clause\u2019s suite
p45978
as(dp45979
g16
V100297
p45980
stp45981
a((dp45982
g2
(lp45983
VJust re-open the file in write mode after reading:
p45984
aVIf you are opening the file to both read and write, you must at least rewind to the start of the file and truncate before writing:
p45985
as(dp45986
g16
V100297
p45987
stp45988
a((dp45989
g2
(lp45990
VYes, dictionaries are not special and can be imported into other modules, just like anything else you define in a Python module
p45991
aVLike functions and classes, dictionaries are Python objects, and importing does nothing but create a new reference in the current module to values you imported
p45992
aVYou can manipulate the dictionary from anywhere; dictionaries are mutable structures, once you have a reference to it you can alter the keys and values of that dictionary
p45993
as(dp45994
g16
V100297
p45995
stp45996
a((dp45997
g2
(lp45998
VYou are trying to use the whole  list as a key:
p45999
aVPerhaps you meant to use  instead
p46000
aVA  is a mutable type, and cannot be used as a key in a dictionary (it could change in-place making the key no longer locatable in the internal hash table of the dictionary)
p46001
aVAlternatively, loop over the  sequence:
p46002
aVPlease don't use  as a variable name; you are shadowing the built-in type by doing that
p46003
as(dp46004
g16
V100297
p46005
stp46006
a((dp46007
g2
(lp46008
VYou can escape  by doubling it:
p46009
aVAlternatively, use  formatting instead:
p46010
as(dp46011
g16
V100297
p46012
stp46013
a((dp46014
g2
(lp46015
VYou need to 'return', or in this case  the results of the recursive call:
p46016
aVThe  may not be strictly necessary in this case, but you need to at least loop over a generator to execute the contained code
p46017
aVYou simply called  which creates the generator, but only looping over the generator causes it to execute the generator function to produce items
p46018
aVDemo:
p46019
aVIn Python 3
p46020
aV3 and newer, you can use the  syntax:
p46021
aVLast, but not least, you can use  to test for both  and :
p46022
as(dp46023
g16
V100297
p46024
stp46025
a((dp46026
g2
(lp46027
VUse :
p46028
aVThe output can be sorted:
p46029
aVbut really, there is no real difference between listing  first or  first; they are otherwise equal
p46030
aVSorting the output does double work;  already sorted it's items for you, the above just sorts the lot again with slightly different criteria
p46031
as(dp46032
g16
V100297
p46033
stp46034
a((dp46035
g2
(lp46036
VSplit on the first whitespace encountered:
p46037
aVsplits on arbitrary-width whitespace, but only once, leaving you with the number and the rest of the line in two variables
p46038
as(dp46039
g16
V100297
p46040
stp46041
a((dp46042
g2
(lp46043
VBecause in Python 2, all binary data is represented as strings
p46044
aVThe  type is basically just a sequence of bytes
p46045
aVIn Python 3, the basic  type is a unicode value ( in Python 2) and the Python 2  type has been renamed to  instead, and the  function outputs bytes:
p46046
as(dp46047
g16
V100297
p46048
stp46049
a((dp46050
g2
(lp46051
V is an iterator; it only produces the index  value on the fly; it does not produce them all up front
p46052
aVYou can try to read the  source code, but it basically can be translated to Python like this:
p46053
aVThe  keyword makes this a generator function, and you need to loop over the generator (or call  on it) to advance the function to produce data, one  call at a time
p46054
aVPython also interns  values, all values between -5 and 256 (inclusive) are singletons, so the above code doesn't even produce new  objects until you reach 257
p46055
as(dp46056
g16
V100297
p46057
stp46058
a((dp46059
g2
(lp46060
VThe first function can be reduced to:
p46061
aVYou may want to make it a generator instead:
p46062
aVThe second function could be:
p46063
aVNext step; you are just generating a sequence of base-3 digits
p46064
aVJust generate these directly:
p46065
aVThis produces base3 values, 0-padded to 12 digits:
p46066
aVand  becomes:
p46067
as(dp46068
g16
V100297
p46069
stp46070
a((dp46071
g2
(lp46072
VWhat you see is the interpreter echoing back the return value of :
p46073
aVIf you assign the output of  things work as expected:
p46074
aVor print extra information:
p46075
aVIn other words,  is working as expected, but because it returns the next value from the iterator, you are led to believe that the loop has its own iterator copy somehow
p46076
as(dp46077
g16
V100297
p46078
stp46079
a((dp46080
g2
(lp46081
VUse the  module:
p46082
aVStruct packs values following C conventions; the above format packs one single-precision float value (4 bytes) in big-endian order
p46083
as(dp46084
g16
V100297
p46085
stp46086
a((dp46087
g2
(lp46088
VYou are looking at the module namespaces
p46089
aVThe  globals differs from  globals because they both live in different modules
p46090
aVYou'll see the same global namespace if you use  (for globals in ) and  (for the globals of module ):
p46091
aVEach and every module gets its own namespace,  are not interpreter global, they are module global only
p46092
aVImporting a module means you are importing a reference to that namespace, or creating references to names in that namespace
p46093
aVFrom the datamodel documentation on module objects:
p46094
aVA module object has a namespace implemented by a dictionary object (this is the dictionary referenced by the  attribute of functions defined in the module)
p46095
aVand on function objects:
p46096
aV: A reference to the dictionary that holds the function\u2019s global variables \u2014 the global namespace of the module in which the function was defined
p46097
aVThe  key of the main script merely points to the  module, in imported modules that has been expanded into a dictionary
p46098
aVThese are the same thing, really
p46099
as(dp46100
g16
V100297
p46101
stp46102
a((dp46103
g2
(lp46104
VDon't use a list; use a set instead
p46105
aVRead the first file into a set:
p46106
ag2391
aV5 GB of words isn't that much to store in a set
p46107
aVNow you can test against  in O(1) constant time:
p46108
aVOpen the second file and process it line by line, perhaps using the  module if the lines words are comma-separated
p46109
aVFor a larger set of words, use a database instead; Python comes with the  library:
p46110
aVthen test against that:
p46111
aVEven though I use a  database here, SQLite is smart enough to store data in temporary files when you start filling up memory
p46112
aVThe  connection is basically just a temporary, one-off database
p46113
aVYou can also use a real filepath if you want to re-use the words database
p46114
as(dp46115
g16
V100297
p46116
stp46117
a((dp46118
g2
(lp46119
VYour function returns early:
p46120
aVThe code after the  loop is never reached if that  statement is executed, which happens if  is ever
p46121
as(dp46122
g16
V100297
p46123
stp46124
a((dp46125
g2
(lp46126
VFile object contents need to be transformable; the  tool needs to be able to produce text from their binary contents
p46127
aVFor PDF files, for example, the  transform either uses the poppler or the xpdf command-line tools to extract text from the document to index
p46128
aVWord documents require the  package, etc
p46129
aVYou need to make sure the right tools are installed for your platform for these transforms to work
p46130
aVThese older knowledgebase articles still apply to Plone 4:
p46131
aVEnable full-text indexing of Word documents and PDFs in Plone 3
p46132
aV0 (GNU/Linux)
p46133
aVEnable full-text indexing of Word documents and PDFs in Plone 3
p46134
aV0 (Windows)
p46135
as(dp46136
g16
V100297
p46137
stp46138
a((dp46139
g2
(lp46140
VUse  to group your items:
p46141
aVThis produces a list of , etc
p46142
aVvalues
p46143
aVThe  tool splits up your input sequence into groups, where the next group is determined by the  callable; when the value returned by the  callable changes, a new group is produced
p46144
as(dp46145
g16
V100297
p46146
stp46147
a((dp46148
g2
(lp46149
VIf you are writing a function, then return a value
p46150
aVDo not use print (that is for debugging only)
p46151
aVOnce you use , you can return early if you do find the author:
p46152
aVThe last  statement only executes if there were no lines starting with , because if there was, the function would have returned early
p46153
aVAlternatively, because we default  to , you can use  as well to end the loop early and leave returning to that last line:
p46154
as(dp46155
g16
V100297
p46156
stp46157
a((dp46158
g2
(lp46159
VList comprehensions can give you a filtered set of values fast:
p46160
aVor use a loop to partition the values:
p46161
aVNote that  is strictly  here, but you can tighten up the tests if you need to ignore any values exactly equal to
p46162
as(dp46163
g16
V100297
p46164
stp46165
a((dp46166
g2
(lp46167
VUse nested loops:
p46168
aVList comprehensions work just like nested for loops; if you can work out the sequence as a series of nested loop, you can put it in a list comp:
p46169
aVDemo:
p46170
as(dp46171
g16
V100297
p46172
stp46173
a((dp46174
g2
(lp46175
VYour  call is returning , because you are not testing the correct value in the loop
p46176
aVDon't test product
p46177
aVidproduct_id` argument:
p46178
aVYou are also returning  too early
p46179
aVThat  statement is redundant, just remove it
p46180
aVIf a function ends without a ,  is returned by default:
p46181
aVThis can be collapsed into:
p46182
as(dp46183
g16
V100297
p46184
stp46185
a((dp46186
g2
(lp46187
VUse  instead:
p46188
aVYes, this is a bit of a dance
p46189
aVOutput:
p46190
as(dp46191
g16
V100297
p46192
stp46193
a((dp46194
g2
(lp46195
VIf you only want to remove if both are , then test for that:
p46196
aVwhich can be shortened to:
p46197
aVor use  instead of  to remove the :
p46198
aVbut that is not as readable
p46199
aVPerhaps no more readable, but the list comprehension would be:
p46200
aVor using , sufficient for Python 2:
p46201
as(dp46202
g16
V100297
p46203
stp46204
a((dp46205
g2
(lp46206
VNormally you'd use :
p46207
aVtakes a default parameter to return if  is not present in the dictionary, but if you omit it  is returned
p46208
aVEven if you were to use an explicit key test, you don't need to use :
p46209
aVInterestingly enough, the conditional expression option is slightly faster:
p46210
aVuntil you avoid the attribute lookup for :
p46211
aVso if speed matters, store a reference to the  method (note the  assignment)
p46212
as(dp46213
g16
V100297
p46214
stp46215
a((dp46216
g2
(lp46217
VUse the  function with islice:
p46218
aVThis beats out  for any size:
p46219
aVThe larger  gets, the bigger the difference
p46220
as(dp46221
g16
V100297
p46222
stp46223
a((dp46224
g2
(lp46225
VI'd turn  into dictionary:
p46226
aVand use  to indicate values to be sorted at the end:
p46227
aVDemo:
p46228
aVThis has the advantage of speed;  lookups are O(1) versus list  lookups having a  cost
p46229
aVYou'll notice this more as  and  grow in size
p46230
aVThe disadvantage is that duplicate values in  are handled differently; the  approach picks the last index versus  picking the first
p46231
as(dp46232
g16
V100297
p46233
stp46234
a((dp46235
g2
(lp46236
VThe line:
p46237
aVis executed when you create the class, not when you later print it
p46238
aVWhen you create the class,  is set to
p46239
aVYou'll have to do the interpolation later on, when you actually have a name
p46240
aVPerhaps you need to use callables instead, like  objects:
p46241
aVthen call them passing in  later on:
p46242
as(dp46243
g16
V100297
p46244
stp46245
a((dp46246
g2
(lp46247
VWhen your column names contain whitespace you need to put quotes around the names; you are also missing a closing parenthesis:
p46248
aVQuick demo with the  command line utility:
p46249
aVor the python version:
p46250
as(dp46251
g16
V100297
p46252
stp46253
a((dp46254
g2
(lp46255
VYou want to skip empty lines or lines without a , just catch the  exception in those cases:
p46256
aVHowever, from the comments it appears you have data that is space-separated as well ( has no  character in the line), so perhaps you should split on general whitespace instead:
p46257
aVNow you are splitting on the last arbitrary-width separator on the line (not counting whitespace at the start and end), and only splitting once
p46258
aVIf any of your terms contain whitespace too, this ensures that they are preserved
p46259
aVThis assumes your score values do not have any whitespace in them (which would also break with your own code)
p46260
aVIf you are certain that all you have is  separated data, or you can clean up your input files to use only tabs, an alternative could be to use the  module instead, and to use a dict comprehension:
p46261
as(dp46262
g16
V100297
p46263
stp46264
a((dp46265
g2
(lp46266
VYou can write a generator that'll return everything but the last entry in an input iterator:
p46267
aVthen wrap your  reader object in that:
p46268
aVThe generator basically takes the first entry, then starts looping and on each iteration yield the previous entry
p46269
aVWhen the input iterator is done, there is still one line left, that is never returned
p46270
aVA generic version, letting you skip the last  elements, would be:
p46271
as(dp46272
g16
V100297
p46273
stp46274
a((dp46275
g2
(lp46276
VIf you don't care about the order of the input list, I'd shuffle it, then remove  items from that list, adding those to the other list:
p46277
aVwhere  is a float value between  and
p46278
aVDemo:
p46279
as(dp46280
g16
V100297
p46281
stp46282
a((dp46283
g2
(lp46284
VDon't loop over a list you are removing items from
p46285
aVThe  loop creates a list iterator that keeps track of the current item by incrementing a counter
p46286
aVBut a shrinking list means that the counter will, from loop iteration to loop iteration, point at the wrong item:
p46287
aVWhat happens is that as you remove  from the list , the counter increments to item , which in the now-altered list  points to the value
p46288
aVRemoving  from the list, the iterator count increments to  and in the altered list  that means the next value in the loop is , after which the iterator counter has counted beyond the end and the loop terminates
p46289
aVIf you are going to remove all items from the list, use a while loop:
p46290
aVIf you are removing some items, another option would be to create a shallow copy:
p46291
aVNow you can alter  to your hearts content, as the  loop is iterating over a copy instead
p46292
as(dp46293
g16
V100297
p46294
stp46295
a((dp46296
g2
(lp46297
VYour code does not raise an exception
p46298
aVYou do have a different problem however: you are adding the same list () to  64 times, while constantly altering that list
p46299
aVIn the end you have 64 references to the same list:
p46300
aVYou want to create new lists:
p46301
aVor better still, use :
p46302
aVwhich results in:
p46303
as(dp46304
g16
V100297
p46305
stp46306
a((dp46307
g2
(lp46308
VYou are using the  function on Python 2, which interprets the input as Python code
p46309
aVUse the  function instead
p46310
aVWhen using , the entered text is sent to  which expects a valid python expression, and  is seen as a variable name:
p46311
aVNote how I had to enter  with the quotes for it to work; a literal Python string expression
p46312
aVhas no such restrictions:
p46313
as(dp46314
g16
V100297
p46315
stp46316
a((dp46317
g2
(lp46318
VUse  instead of trying to access  directly
p46319
aVFor old-style classes, this returns :
p46320
aVGenerally speaking, for every dunder (double underscore, ) name, there is a API function or operator that those hooks address
p46321
aVUse the API function or operator instead of accessing the hook directly
p46322
ag6579
ag1298
aVuse  instead of , etc
p46323
aVIf you are testing against exceptions, you probably want to use the  context manager to test for specific exceptions:
p46324
aVYou can then still access the exception instance as  for further testing
p46325
as(dp46326
g16
V100297
p46327
stp46328
a((dp46329
g2
(lp46330
VYou need to pass in a sequence, but you forgot the comma to make your parameters a tuple:
p46331
aVWithout the comma,  is just a grouped expression, not a tuple, and thus the  string is treated as the input sequence
p46332
aVIf that string is 74 characters long, then Python sees that as 74 separate bind values, each one character long
p46333
as(dp46334
g16
V100297
p46335
stp46336
a((dp46337
g2
(lp46338
VYou do not have a JSON string
p46339
aVYou have a Python literal
p46340
aVUse the  function instead:
p46341
aVJSON strings never start with , that is a Python notation
p46342
aVNor does JSON mix byte values and unicode values, JSON strings are always Unicode
p46343
aVYou may want to look into what produces this structure; perhaps the produces of this string should be using  instead of ,  or
p46344
as(dp46345
g16
V100297
p46346
stp46347
a((dp46348
g2
(lp46349
VThis is a change in how objects are tracked in Python 2
p46350
aV7; tuples and dictionaries containing only atomic types (including instances of ), which would never require cycle breaking, are not listed anymore
p46351
aVSee http://bugs
p46352
aVpython
p46353
aVorg/issue4688; this was implemented to avoid a performance issues with creating loads of tuples or dictionaries
p46354
aVThe work-around is to add an object to your dictionary that does need tracking:
p46355
aVOnce tracked, a dictionary only goes back to being untracked after a gc collection cycle:
p46356
as(dp46357
g16
V100297
p46358
stp46359
a((dp46360
g2
(lp46361
VYou are retrieving GZIPped, compressed data; the server expressly tells you it does with
p46362
aVEither use the  library to decompress the data:
p46363
aVor use a library that supports transparent decompression if the response headers indicate compression has been used, like
p46364
as(dp46365
g16
V100297
p46366
stp46367
a((dp46368
g2
(lp46369
VStill convert them to floats, but without the  sign:
p46370
aVThe  removes any extra whitespace, as well as the  percent sign, you don't need that to be able to compare two values:
p46371
aVitself will normally strip away whitespace for you but by stripping it yourself you make sure that the  sign is also properly removed, making this a little more robust when handling data from files
p46372
as(dp46373
g16
V100297
p46374
stp46375
a((dp46376
g2
(lp46377
VYou are looking at whole tuples with unicode strings; the  is normal when showing you a tuple with unicode values inside:
p46378
aVYou want to format each row:
p46379
aVSee the  documentation, specifically the Format Syntax reference; the above formats 3 values with field widths, left-aligning each value into their assigned width
p46380
aVThe widths are approximate (I didn't count the number of spaces in your post exactly), but should be easy to adjust to fit your needs
p46381
aVDemo:
p46382
aVor, using a loop and a sequence of row entries:
p46383
as(dp46384
g16
V100297
p46385
stp46386
a((dp46387
g2
(lp46388
VUse  and the lengths of each of the dictionary values:
p46389
aVIf you are using Python 3, then just use
p46390
aVQuick demo with your input sample and one of mine:
p46391
aVA  won't help you much here, you are not creating a count per entry, you are calculating the total length of all your values
p46392
as(dp46393
g16
V100297
p46394
stp46395
a((dp46396
g2
(lp46397
VUsing the   recipe:
p46398
aVshould do it
p46399
aVThe  method gives us groups of 3 tuples at a time
p46400
aVRemoving the key values from the dictionary values too:
p46401
aVDemo on your input:
p46402
as(dp46403
g16
V100297
p46404
stp46405
a((dp46406
g2
(lp46407
VCall it in the  initializer then:
p46408
aVor call the static method after you defined it, but are still defining the class; because it is a static method, you'd have to access it through the  attribute:
p46409
aVIf you didn't mean to call it, just create a copy of the method with a different name, just do so after you defined it:
p46410
aVThe class body is executed as a function, with the local namespace of the function then forming the class attributes
p46411
aVSo, like a function, if you want to refer to other objects you need to make sure they are defined first
p46412
as(dp46413
g16
V100297
p46414
stp46415
a((dp46416
g2
(lp46417
VYou are missing something, namely the  prefix:
p46418
aVBoth python and  attach meaning to ; your doubled backslash becomes just one backslash when you pass the string value to , by which time  sees , meaning a literal full stop
p46419
ag4212
aVBy using  you tell python not to interpret escape codes, so now  is given a string with , meaning a literal backslash followed by any character:
p46420
aVDemo:
p46421
aVThe rule of thumb is: when defining regular expressions, use  raw string literals, saving you to have to double-escape everything that has meaning to both Python and regular expression syntax
p46422
aVNext, you want to replace the 'escaped' character; use groups for that,  lets you reference groups as the replacement value:
p46423
aVNow the output is:
p46424
as(dp46425
g16
V100297
p46426
stp46427
a((dp46428
g2
(lp46429
VYou are passing a string to the  function:
p46430
aVGive it a integer instead:
p46431
aVby turning the  result to :
p46432
aVTip: you can easily reverse a string by giving it a negative slice stride:
p46433
aVso you can simplify your function to:
p46434
aVor even:
p46435
as(dp46436
g16
V100297
p46437
stp46438
a((dp46439
g2
(lp46440
VJust loop directly over the file object:
p46441
aVThis reads the incoming data stream line by line (internally, the socket fileobject calls  every time you iterate)
p46442
aVThis does assume that your server is sending data as soon as possible
p46443
aVCalling  (plural) guarantees that you read the whole request before you start looping, don't do that
p46444
aVAlternatively, use the  library, which has more explicit support for request streaming:
p46445
aVNote that this only will work if your server starts streaming data immediately
p46446
aVIf your CGI doesn't produce data until the process is complete, there is no point in trying to stream the data
p46447
as(dp46448
g16
V100297
p46449
stp46450
a((dp46451
g2
(lp46452
VUse the  module to output the file, and  (save to string):
p46453
aVThe  module will take care of quoting; the newline will still be there, but with quotes around the data any proper CSV reader (including ) can read the data again
p46454
aVPass the data to  again
p46455
as(dp46456
g16
V100297
p46457
stp46458
a((dp46459
g2
(lp46460
VYou need to make  part of the  method as well
p46461
aVis not defined until that function is called:
p46462
aVYou can put these on the same line if you want to:
p46463
aVIf you need  to be a class attribute instead of an instance attribute, refer directly to the class:
p46464
aVor use :
p46465
aVThe latter means that if you subclass , the class attribute will be set on the appropriate subclass instead
p46466
as(dp46467
g16
V100297
p46468
stp46469
a((dp46470
g2
(lp46471
VDon't use ; it's a debugging tool at best
p46472
aVJust get the first child:
p46473
aVIt appears that BeautifulSoup hasn't quite guessed the encoding correctly, so the non-breaking space (U+00a0) is present as two separate bytes instead of one
p46474
aVIt looks like BeautifulSoup guessed wrong:
p46475
aVYou can force the encoding by using the response headers; this server did set the character set:
p46476
aVThe  parameter tells BeautifulSoup to use UTF-8 instead of Latin 1, and now the non-breaking space is correctly stripped
p46477
as(dp46478
g16
V100297
p46479
stp46480
a((dp46481
g2
(lp46482
VUsually, provided the object you call the operations on does not implement the ,  or  hooks in python, then yes, , ,  and  are atomic operations
p46483
aVAny individual bytecode is an atomic operation as far as Python threads are concerned
p46484
aVThe Python evaluation loop grabs the Global Interpreter Lock (GIL) while interpreting opcodes
p46485
aVYou'd need to look at the bytecode to see where the boundaries lie:
p46486
aVThe story doesn't end there;  uses  (tests for an exception), which in turn can invoke the Python  hook
p46487
aVSimilarly, the  opcode could end up calling a python  hook implementation
p46488
aVIn both cases the GIL would be released again
p46489
aVFor default implementations ( does not implement those hooks) the operations are atomic as Python C code handles the whole operation without falling back to Python and thus the evaluation loop (where the GIL might be released and locked again for another thread)
p46490
aVOf course, you could still be dealing with a custom C library that releases the lock during object protocol operations
p46491
aVThat'd be a an unusual thing to do
p46492
as(dp46493
g16
V100297
p46494
stp46495
a((dp46496
g2
(lp46497
VYou are trying to use the string as a function:
p46498
aVBecause there is nothing between the string literal and the  parenthesis, Python interprets that as an instruction to treat the string as a callable and invoke it with one argument:
p46499
aVSeems you forgot to concatenate (and call ):
p46500
aVThe next line needs fixing as well:
p46501
aVAlternatively, use string formatting with :
p46502
aVwhere  will be replaced by your price calculation, formatting the floating point value as a value with 2 decimals
p46503
as(dp46504
g16
V100297
p46505
stp46506
a((dp46507
g2
(lp46508
VBecause Python is being smart about quoting
p46509
aVYou are asking for a string representation ( uses ), which presents strings in a manner that is legal Python code
p46510
aVWhen you echo values in the Python interpreter, the same representation is used
p46511
aVBecause  contains a single quote, Python gives you double quotes to not have to escape that quote
p46512
aVPython prefers to use single quotes for string representations, and uses double when needed to avoid escaping:
p46513
aVOnly when I used both types of quotes, did Python start to use an escape code () for the single quote
p46514
as(dp46515
g16
V100297
p46516
stp46517
a((dp46518
g2
(lp46519
VUse :
p46520
aVThis will return  as soon as there is any  for which the test is ; it won't test any more values after that
p46521
aVFor future reference, you could also end your loop with :
p46522
aVNote that the  is now part of the  loop instead; if you do not break out of the loop, at the end the  suite is executed, but if you do , then the  suite is skipped
p46523
as(dp46524
g16
V100297
p46525
stp46526
a((dp46527
g2
(lp46528
VYes, use :
p46529
aVor use  to add items to an existing dictionary:
p46530
aVThe  function pairs up two iterables into a sequence of tuples, which both  and  happily turn into key-value pairs:
p46531
as(dp46532
g16
V100297
p46533
stp46534
a((dp46535
g2
(lp46536
VYou can with a lambda:
p46537
aVor you could use a generator expression or list comprehension, depending on what you want:
p46538
aVIn Python 2,  returns a list (so the list comprehension is the equivalent), in Python 3,  is a generator (so the generator expression can replace it)
p46539
aVThere is no built-in or standard library method that does this directly; the use case is too specialised
p46540
as(dp46541
g16
V100297
p46542
stp46543
a((dp46544
g2
(lp46545
VYou use the  method on the instance:
p46546
aVReturn a datetime with the same attributes, except for those attributes given new values by whichever keyword arguments are specified
p46547
as(dp46548
g16
V100297
p46549
stp46550
a((dp46551
g2
(lp46552
VYou are using capturing groups, and  alters behaviour when you use those (it'll only return the contents of capturing groups)
p46553
aVYour regex can be simplified, but your versions will work if you use non-capturing groups instead:
p46554
aVYou don't need to escape the double quote if you use single quotes around the expression, and you only need to vary the  in the expression, so  would work too:
p46555
aVDemo:
p46556
as(dp46557
g16
V100297
p46558
stp46559
a((dp46560
g2
(lp46561
VThey do very different things
p46562
aVThe first defines a new  value in each iteration of the loop, replacing any previous value
p46563
aVEach time you create a new list with one dictionary in it
p46564
aVThe second is a list comprehension, which builds a list consisting of 0 or more dictionaries, one for each element returned by
p46565
aVTo make the first one equivalent to the second, you'd need to define  as an empty list first, then append to it in the loop:
p46566
as(dp46567
g16
V100297
p46568
stp46569
a((dp46570
g2
(lp46571
VYou are setting the same keys over and over again:
p46572
aVBy using keywords, you are setting two keys;  and ; the very definition of a dictionary is that they map keys to values, where keys are unique
p46573
aVIf you wanted to set different key-value combinations for each element in your loop, set different keys
p46574
aVFor example, using  for each key, and  for the values, pass both in as a tuple:
p46575
aVor just set the key-value directly using assignment:
p46576
aVYou replace that whole loop with a dict comprehension:
p46577
aVYour first loop could be simplified using  with a start value of , and a list comprehension:
p46578
aVIf you don't need the  objects, you can just use that same  loop to build the dictionary:
p46579
aVSwap the integer and character components around if you wanted your dictionary to map the other way
p46580
as(dp46581
g16
V100297
p46582
stp46583
a((dp46584
g2
(lp46585
VYou need to open the file in binary mode:
p46586
aVPython will otherwise translate line endings to the native platform form, a transformation that breaks binary data, as documented for the  function:
p46587
aVThe default is to use text mode, which may convert  characters to a platform-specific representation on writing and back on reading
p46588
aVThus, when opening a binary file, you should append  to the mode value to open the file in binary mode, which will improve portability
p46589
aVWhen copying data from a URL to a file, you could use  to handle streaming efficiently:
p46590
aVThis will read data in chunks, avoiding filling memory with large blobs of binary data
p46591
aVThe  statement handles closing the file object for you
p46592
as(dp46593
g16
V100297
p46594
stp46595
a((dp46596
g2
(lp46597
VYour URL configuration has 3 parameters (,  and )
p46598
aVPlus the  argument for methods, that makes 4 arguments
p46599
aVAdjust your  method to accept all parameters:
p46600
aVThese match each of the regular expression capturing groups; I guessed at the parameter names for each, you can adjust as needed
p46601
as(dp46602
g16
V100297
p46603
stp46604
a((dp46605
g2
(lp46606
VYou don't have to use  if you don't want to
p46607
aVThe other functions in the module, such as  use , give you a simpler API to do what you want
p46608
aVAll console applications have 3 'file' streams:  for input, and  and  for output
p46609
aVThe application decides what to write where; usually error and diagnostic information to , the rest to
p46610
aVIf you want to capture the output for either of these outputs in your Python program, you specify the  argument so that the 'stream' is redirected into your program
p46611
aVHence the name
p46612
aVIf you want to capture the output of the  command, it's easiest to use the  function; it takes care of the  argument for you:
p46613
aVNow  contains whatever  wrote to its  stream
p46614
aVIf you need to have more control over the process, then you do need to use the  class:
p46615
as(dp46616
g16
V100297
p46617
stp46618
a((dp46619
g2
(lp46620
VBeautifulSoup text search matches whole strings normally
p46621
aVUse a regular expression when you want to match substrings:
p46622
aVHowever, the page presents the information as a table, it is easier to just process that:
p46623
aVwhich prints
p46624
as(dp46625
g16
V100297
p46626
stp46627
a((dp46628
g2
(lp46629
VIf you have percentages per country code, simply expand the countries list until you have enough elements, then shuffle the list:
p46630
aVNow you can zip these with your email addresses, with the countries distributed evenly according to their weights
p46631
as(dp46632
g16
V100297
p46633
stp46634
a((dp46635
g2
(lp46636
VYou change the codec in the  command; the ISO-8859 standard has multiple codecs, I picked Latin-1 for you here, but you may need to pick another one:
p46637
aVSee the  module for a list of valid codecs
p46638
aVJudging by the pastie data, iso-8859-1 is the correct codec to use, as it is suited for Scandinavian text
p46639
aVGenerally, without other sources, you cannot know what codec a file uses
p46640
aVAt best, you can guess (which is what  does)
p46641
as(dp46642
g16
V100297
p46643
stp46644
a((dp46645
g2
(lp46646
VDon't use
p46647
aVUse the file directly as an iterator:
p46648
aVI also added a few Python best-practices, and you don't need to turn  into a float, then back to a string again
p46649
aVYou could also look into using the  module, it can handle splitting and rejoining lines in C code:
p46650
as(dp46651
g16
V100297
p46652
stp46653
a((dp46654
g2
(lp46655
VUse the  function to turn the string from the file into a number:
p46656
aVThere is no need to read the whole file in memory; process it line by line instead:
p46657
aVThe  statement makes sure the file object is closed automatically
p46658
aVOutput:
p46659
as(dp46660
g16
V100297
p46661
stp46662
a((dp46663
g2
(lp46664
VUse the  function:
p46665
aVThis picks 5 different numbers from the input list
p46666
aVIf duplicate numbers are allowed, a list comprehension will do with  will do:
p46667
aVDemonstration:
p46668
as(dp46669
g16
V100297
p46670
stp46671
a((dp46672
g2
(lp46673
VThe fragment is never sent by the browser when requesting a URL
p46674
aVIt is a client-side-only piece of information
p46675
aVIf you alter just the fragment part (with Javascript or manually, in the location bar of your browser), no new request is made to the server; the browser simply updates the page scroll location
p46676
as(dp46677
g16
V100297
p46678
stp46679
a((dp46680
g2
(lp46681
VUse a set to detect duplicates:
p46682
aVYou could shorten that to:
p46683
aVBoth versions exit early; as soon as a duplicate word is found, the function returns ; it does have to read the whole file to determine there are no duplicates and return
p46684
as(dp46685
g16
V100297
p46686
stp46687
a((dp46688
g2
(lp46689
VYou are building a class; the body of a class is executed as a function to build the definition
p46690
aVThe local namespace of that 'function' forms the set of attributes that make up the class
p46691
aVSee the  statement documentation
p46692
aVMethods in the class body are not executed; like function definitions, you need to call them first
p46693
aVBut if you didn't first call the class body, you don't know what methods the class has, at all
p46694
aVIn the same way, any top-level code in a module is executed when you import a module, to form the module namespace
p46695
aVIf you put  in a module, it is also executed immediately
p46696
as(dp46697
g16
V100297
p46698
stp46699
a((dp46700
g2
(lp46701
VYou have two strings with python lists embedded in them
p46702
aVThey are not actual lists
p46703
aVYou can go back to making these into lists with unicode values with the  function
p46704
aVThat feels like we are fixing a problem that was caused by other code, the better fix would be to not build these values like these in the first place
p46705
aVThis produces proper unicode paths (a good idea on Windows):
p46706
aVIf you can, you want to change the original code to produce a dictionary instead, one that uses the base as keys, and a list of names as the value:
p46707
as(dp46708
g16
V100297
p46709
stp46710
a((dp46711
g2
(lp46712
VUse a sentinel value; it's a private singleton that you test agains with :
p46713
as(dp46714
g16
V100297
p46715
stp46716
a((dp46717
g2
(lp46718
VYou are confusing the test with the loop; move  to the  test expression in the generator expression:
p46719
aVThe  part loops over  elements, and the first part of the generator expression is the actual test
p46720
aVDepending on how  is structured, it may be more performant to make your whitelist a set:
p46721
as(dp46722
g16
V100297
p46723
stp46724
a((dp46725
g2
(lp46726
VCreate your own:
p46727
aVThis takes any number of positional and keyword arguments and does nothing at all
p46728
aVsignifies an empty python block; it works anywhere Python expects a , including loops,  statements and  statements
p46729
aVPython callables always return something (it is a language requirement); if no explicit return value is given  is returned
p46730
aVThe  and  indicate arbitrary length parameters; you can pass in 0 or more positional parameters and the  name will represent a tuple of them, and 0 or more keyword arguments, and they are captured in the  dictionary
p46731
aVFrom the function definition documentation:
p46732
aVIf the form \u201c\u201d is present, it is initialized to a tuple receiving any excess positional parameters, defaulting to the empty tuple
p46733
aVIf the form \u201c\u201d is present, it is initialized to a new dictionary receiving any excess keyword arguments, defaulting to a new empty dictionary
p46734
aVSimple demo of  and  parameters:
p46735
aVFor functional programming, if you need the arguments to be returned as is you need to think about what you need returning; a one-argument function would return just that argument and for anything that needs to take 2 or more arguments and return them all, you'd have to return those arguments as a tuple:
p46736
aVDemo:
p46737
as(dp46738
g16
V100297
p46739
stp46740
a((dp46741
g2
(lp46742
VYou could use the  function:
p46743
as(dp46744
g16
V100297
p46745
stp46746
a((dp46747
g2
(lp46748
VYou need to use the  method to put a datetime in the correct timezone, otherwise a historical offset is chosen by mistake:
p46749
aVSee the  documenation:
p46750
aVUnfortunately using the tzinfo argument of the standard datetime constructors \u2018\u2019does not work\u2019\u2019 with pytz for many timezones
p46751
aVWith this change, the output becomes:
p46752
aVNote that the New York offsets were also incorrect
p46753
as(dp46754
g16
V100297
p46755
stp46756
a((dp46757
g2
(lp46758
VSplit on the last linebreak and attach a new line:
p46759
aVThis first removes any trailing newline after the last line, splits once on the last newline in the text, takes everything before that last newline, and concatenates the result with a new newline and text
p46760
aVDemo:
p46761
aVThis presumes that your lines are separated by  characters; reading text files in text mode gives you such data on any platform
p46762
aVIf you are dealing with data with different line endings, adjust accordingly
p46763
aVIn such cases  can come in useful
p46764
as(dp46765
g16
V100297
p46766
stp46767
a((dp46768
g2
(lp46769
VYou are trying to use the  attribute of your  class as a method, but it is a tuple:
p46770
aVRemove the surplus :
p46771
as(dp46772
g16
V100297
p46773
stp46774
a((dp46775
g2
(lp46776
VYou want to use the  tool to group your input lines by customer number:
p46777
aVreturns the current result of the  function, and an iterable of all rows that have that key value
p46778
aVAs soon as the next row no longer has the same key, a new group is started
p46779
aVOther things I changed:
p46780
aVUse  to have your open files closed automatically, regardless of what else happens
p46781
aVUse  to build paths
p46782
aVUse  to write tab-separated files; it is just another CSV dialect, really
p46783
aVI used a dict comprehension to turn your rows into dictionaries
p46784
aVAlternatively, just use  to do the same thing; no need to read the fields from the first row
p46785
as(dp46786
g16
V100297
p46787
stp46788
a((dp46789
g2
(lp46790
VUse the  function:
p46791
aVThe  function simply formats the input following the Format Specification mini language
p46792
aVThe  makes the format include the  prefix, and the  size formats the output to fit in 10 characters width, with  padding; 2 characters for the  prefix, the other 8 for the binary digits
p46793
aVThis is the most compact and direct option
p46794
as(dp46795
g16
V100297
p46796
stp46797
a((dp46798
g2
(lp46799
VThe exception you see comes from printing your data
p46800
aVPrinting requires that you encode the data to the encoding used by your terminal or Windows console
p46801
aVYou can see this from the exception (and from the traceback, but you didn't include that); if you have a problem with decoding data (which is what happens when you read from a file) then you would get a , you got a  instead
p46802
aVYou need to either adjust your terminal or console encoding, or not print the data
p46803
aVSee http://wiki
p46804
aVpython
p46805
aVorg/moin/PrintFails for troubleshooting help
p46806
as(dp46807
g16
V100297
p46808
stp46809
a((dp46810
g2
(lp46811
VYour code is fine, you are doing nothing with the return value of
p46812
aVAdd a call to  so you can see the result of your conversion, and perhaps wait for a keypress:
p46813
aVWith the  call the Windows console will remain open until you are done reading what the program has to print
p46814
aVIt is not needed when running in IDLE
p46815
as(dp46816
g16
V100297
p46817
stp46818
a((dp46819
g2
(lp46820
VUse the  module:
p46821
aVreturns the current format used; set  to force localisation to be applied (defaults to your  flag), or use the  argument to pick a specific language:
p46822
aVSee the available date format strings to see what the various strings mean
p46823
aVAlternatively, use the javascript catalog view, which includes JavaScript  function
p46824
aVEither way, the Django format is not a JS-recognized format
p46825
aVYou have two options:
p46826
aVUse this Django snippet to add a  method to the JavaScript  prototype that recognises Django formats, or
p46827
aVInstall the django-missing library which includes an updated version of the above snippet as a ready-to-include JS library
p46828
aVIf you need a JS-compatible mask, you'll need to do the translation yourself, based on those two  examples
p46829
as(dp46830
g16
V100297
p46831
stp46832
a((dp46833
g2
(lp46834
VWhen you are not calling the class (omitting the ), you are not making instances
p46835
aVYou are creating another reference to the class
p46836
aVcalls a class to produce an instance
p46837
aVYour  variable is merely a reference to your  class object
p46838
aVThat class object has both  and  attributes, so you can reference those
p46839
aVBut only  is an actual instance, produced by calling the class
p46840
aVWhen looking up attributes on an instance, the class is consulted as well
p46841
aVSo  does not have the  and  attributes, but its class does
p46842
aVYou may want to consult the Python tutorial on classes again to see what the difference is between classes and instances
p46843
as(dp46844
g16
V100297
p46845
stp46846
a((dp46847
g2
(lp46848
VYou want to use ; a list comprehension lets you apply this to all elements in one line:
p46849
aVThere is no literal  in the string; the  is an escape code that signifies the tab character
p46850
aVDemo:
p46851
as(dp46852
g16
V100297
p46853
stp46854
a((dp46855
g2
(lp46856
VYou want to process the links as you find them, and find all forms with one regular expression
p46857
aVUsing  and a replacement function would be the easiest:
p46858
aVBy combining the 3 forms into one pattern you prevent matching the same link multiple times, and by using the replacement function you also avoid replacing multiple occurences where a shorter form of the same link is used (a linked  still contains the  part for future replacement calls)
p46859
aVDemo:
p46860
as(dp46861
g16
V100297
p46862
stp46863
a((dp46864
g2
(lp46865
VThe  function can take an iterable of  pairs; the code you have there passes in a generator expression that produces such pairs
p46866
aVIt loops over  and for each pair only selects those whose  method returns
p46867
aVYou could express it as a for loop as well:
p46868
aVThe  function returns either the key or a default
p46869
aVHere the default is a anonymous function, a
p46870
aVSo the  dictionary either has a value for the key named in the  variable, or a lambda anonymous function is returned
p46871
aVEither way, the result of the  call is itself called
p46872
aVIn Python, functions are first-class objects; you can store them in dictionaries too; if you retrieve one from a dictionary you can still call it:
p46873
aVSo the extra  after  is applied to whatever  returned
p46874
aVLambdas are anonymous functions that can be defined in an expression (a  line is a statement and has to stand on it's own); lambdas thus can be defined while storing it into a dictionary directly:
p46875
as(dp46876
g16
V100297
p46877
stp46878
a((dp46879
g2
(lp46880
VYou are passing the  respones object to ElementTree; you want to pass in the raw file object instead:
p46881
aVreturns the 'file-like' socket object, from which  will read, just like it'll read from the  response (which is itself a file-like object)
p46882
aVConcrete example:
p46883
aVIf you have a compressed URL, the raw socket (like ) returns the compressed data undecoded; in that case you can use the  method on the binary response content:
p46884
as(dp46885
g16
V100297
p46886
stp46887
a((dp46888
g2
(lp46889
VThe server is redirecting you in a loop
p46890
aVYou'll need to figure out why you are being redirected so often
p46891
aVYou could try to see what goes on by not allowing redirects (set ), then resolving them using the  API:
p46892
aVThe  objects are proper responses; print out from these what you need to figure out why you end up in a redirect loop; perhaps the server is providing clues in the headers or the body
p46893
as(dp46894
g16
V100297
p46895
stp46896
a((dp46897
g2
(lp46898
VUse the  module:
p46899
aVEven without the module, you can split lines directly without storing the results in intermediary lists all the time:
p46900
aVBoth versions result in:
p46901
as(dp46902
g16
V100297
p46903
stp46904
a((dp46905
g2
(lp46906
VThe  function alters the list in place and thus always returns
p46907
aVThis is normal and expected behaviour
p46908
aVYou do not need to have a return value as the list itself has already been updated
p46909
aVUse the  method to set a default empty list object:
p46910
aVYou may also be interested in the  class:
p46911
aVIf you want to return a new list with the extra item added, use concatenation:
p46912
as(dp46913
g16
V100297
p46914
stp46915
a((dp46916
g2
(lp46917
VYou want to use a combination of  and  for the two directions:
p46918
aVSQLite uses a dynamic type system but for custom types it has no way of knowing for certain if  is a string or an integer, so you get a string back here
p46919
aVAlternatively, use:
p46920
aVwhich is a lot more flexible and robust when it comes to legacy data, but perhaps you want an exception to be raised
p46921
aVDemo:
p46922
as(dp46923
g16
V100297
p46924
stp46925
a((dp46926
g2
(lp46927
V is an old-style object, so  doesn't work at all here
p46928
aVYou need to directly access the  object in the parent class
p46929
aVIn Python 2, you want to override the  method, not :
p46930
aVDemo:
p46931
as(dp46932
g16
V100297
p46933
stp46934
a((dp46935
g2
(lp46936
VLoop over the list and test each item against the minimum and maximum found so far
p46937
aVand  (infinity and negative infinity) are good starting points to simplify the logic:
p46938
aVAlternatively, start with the first element and only loop over the rest; I use  here to avoid creating a copy of a potentially large list:
p46939
aVor turn the list into an iterable first:
p46940
aVTiming comparisons with a larger, random list:
p46941
aVSo even for lists of 1000 elements, the  and  functions are fastest
p46942
aVSorting is slowest here
p46943
aVThe sorting version can be faster if you allow for in-place sorting, but then you'd need to generate a new random list for each timed run as well
p46944
aVMoving to a million items (and only 10 tests per timed run), we see:
p46945
aVLast but not least, using a million items and  instead of :
p46946
aVNote the ; we give each test run a copy of the list
p46947
aVConclusion: even for large lists, you are better off using the  and  functions anyway
p46948
aVNothing beats a good C loop
p46949
aVBut if you have to forgo those functions, the straight loop is the next better option
p46950
as(dp46951
g16
V100297
p46952
stp46953
a((dp46954
g2
(lp46955
VYou are looking at the output in a browser; HTML browsers consider newlines whitespace, collapsing successive whitespace characters to form one space
p46956
aVYour browser is interpreting the response as HTML-formatted data, use  tags instead:
p46957
aVIf you expected to see just newlines, look at the response source code instead; the newlines are there
p46958
aVIf you wanted to see XML output in a browser, you should set a content type header () so the browser knows you are sending XML instead of HTML:
p46959
aVYour browser will use a default stylesheet to display XML data (usually as a tree with collapsible sections)
p46960
aVYou can use a XML stylesheet (XSLT) to override that behaviour
p46961
aVAdd a stylesheet header:
p46962
aVthe browser will fetch the named stylesheet and apply it to your XML
p46963
as(dp46964
g16
V100297
p46965
stp46966
a((dp46967
g2
(lp46968
VYou can use a generator expression:
p46969
aVbut parenthesis were already taken for
p46970
aVgenerator expressions
p46971
as(dp46972
g16
V100297
p46973
stp46974
a((dp46975
g2
(lp46976
VUse a generator function:
p46977
aVThis yields each section, separated by blank lines, as one string:
p46978
as(dp46979
g16
V100297
p46980
stp46981
a((dp46982
g2
(lp46983
VYou have to test each object; use a list comprehension and  to get all matching indices:
p46984
aVor to get the first index, use  and a generator expression:
p46985
aVDemo:
p46986
as(dp46987
g16
V100297
p46988
stp46989
a((dp46990
g2
(lp46991
VThe  module contains the following warning:
p46992
aVThis version of the csv module doesn\u2019t support Unicode input
p46993
aVAlso, there are currently some issues regarding ASCII NUL characters
p46994
aVAccordingly, all input should be UTF-8 or printable ASCII to be safe; see the examples in section Examples
p46995
aVThe  object supports unicode, but if you are using the  module, then  doesn't, and can lead to more problems
p46996
aVIf your data is ASCII only, simply encode  first:
p46997
aVThere could have been some fixes added to 2
p46998
ag4892
aV3 that make the problem less visible
p46999
as(dp47000
g16
V100297
p47001
stp47002
a((dp47003
g2
(lp47004
VYou could use a generator to produce random values:
p47005
aVThis produces groups of 10  pairs at a time:
p47006
aVYou can adjust the function to produce just keys, just values or dictionaries instead:
p47007
as(dp47008
g16
V100297
p47009
stp47010
a((dp47011
g2
(lp47012
VYou are not doing anything with the method, then testing if the method exists:
p47013
aVYou need to store the result and test that:
p47014
aVIt could also be that you wanted to test , which you set in your  method
p47015
as(dp47016
g16
V100297
p47017
stp47018
a((dp47019
g2
(lp47020
Vcreates a named group; you can now refer to whatever was matched in that group by name
p47021
aVThe view will be passed a keyword parameter by that name when called
p47022
aVis a character group, it matches numeric digits ( through to  for ASCII data)
p47023
aVThe  is a quantifier; only 1 or more digits will match
p47024
aVnames the URL pattern so you can refer to it by name later when creating reverse URLs
p47025
aVSee Naming URL patterns in the Django manual
p47026
aVAll in all, that pattern matches a URL that starts with digits, followed by just a  slash, causing Django to call the  view, passing in the matched digits as the  parameter
p47027
aVThe  keyword makes it easy to generate a URL to this view:
p47028
aVwould generate a URL to
p47029
as(dp47030
g16
V100297
p47031
stp47032
a((dp47033
g2
(lp47034
VThe question mark at the start is the cause of the  error
p47035
aVMatch the dollar plus digits and dots:
p47036
aVDemo:
p47037
as(dp47038
g16
V100297
p47039
stp47040
a((dp47041
g2
(lp47042
VThere are simpler ways to set  from the  submodule; setting  otherwise fine:
p47043
aVThis simply imports  and binds it to the local module namespace
p47044
as(dp47045
g16
V100297
p47046
stp47047
a((dp47048
g2
(lp47049
VYou need to derive from , and you can use  to get the length of the current instance
p47050
aVYou also need to give  a parameter for the other operand of the  operator
p47051
aVDemo:
p47052
as(dp47053
g16
V100297
p47054
stp47055
a((dp47056
g2
(lp47057
VYou are looking at a generator expression
p47058
aVThe part before  is executed in a loop defined by the  expression
p47059
aVThe generator expression produces a sequence of  pairs, which the  constructor uses to build a dictionary
p47060
aVYou could read the code as having the same result as:
p47061
aVIn Python 2
p47062
aV7 and Python 3, you can use a dict comprehension as well:
p47063
aVThe result would be the same; you define  expressions to build the dictionary from the loop
p47064
aVIn generator expressions, as well as (list, dict or set) comprehensions you can use multiple, nested loops, and add  statements to filter the data
p47065
aVThese are defined in nesting order; outermost loop first:
p47066
aVcan be read as:
p47067
aVSee this article for a quick intoduction
p47068
as(dp47069
g16
V100297
p47070
stp47071
a((dp47072
g2
(lp47073
VFirst of all: the  call convention with non-identifier names only works if the called function has a  argument to receive them, as it too cannot define explicit keyword arguments that are not valid identifiers
p47074
aVI'd say that the  grammar only applies to the parser of the source code, and cannot ever be seen as a functional restriction on the contents of the  result
p47075
aVThe functional description below does not restrict the keys of the dictionary explicitly, nor does the function definition documentation
p47076
aVInstead, since the grammar allows an , and the functional spec states that that should resolve to a mapping the contents of which are treated as additional keyword arguments, it is clear (to me) that there are no restrictions on the keys at all, beyond the normal ones applicable to Python dictionaries (keys must be immutable)
p47077
aVYou can pass in tuple or numeric keys for all Python cares
p47078
aVThe functional spec states how the contents are treated, not that the contents must fit a certain format
p47079
aVSo, in my opinion the functional spec would have to explicitly restrict the keys in the  dictionary to disallow what you are doing, because the grammar certainly does not
p47080
aVChanging that would be a huge backwards-incompatible change, and is not likely to ever be added
p47081
aVNote that even though the spec doesn't mention any restrictions on the keys of the dictionary, CPython does:
p47082
aVThis is a restriction made by the python interpreter when invoking code objects (user defined functions)
p47083
aVThe reason why is explained in the source code right after the part that raises the above exception:
p47084
aVBy restricting keywords to strings a speed optimisation is possible
p47085
as(dp47086
g16
V100297
p47087
stp47088
a((dp47089
g2
(lp47090
VIt is not (no longer) recommended you create a subclass; the  and  functions take a  function:
p47091
aVDemo:
p47092
aVThe code you found only worked on Python 2
p47093
aV6 and overrides a private method that is no longer called in later versions
p47094
as(dp47095
g16
V100297
p47096
stp47097
a((dp47098
g2
(lp47099
VYou are passing in a tuple to the  slice:
p47100
aVThe comma makes  a tuple, albeit one that wouldn't be able to stand on it's own
p47101
aVIt is legal Python syntax, but it is called an extended slice
p47102
aVNumpy supports these for matrices, but regular python lists do not
p47103
aVIf you wanted to select all the first columns of all rows (which is what your extended slice would do for a numpy two-dimensional matrix), do so when reading the CSV:
p47104
aVThis picks the first column of each row supplied by the  object
p47105
as(dp47106
g16
V100297
p47107
stp47108
a((dp47109
g2
(lp47110
VImport them first, in the  files
p47111
aVIn , import at least , and in  import , etc
p47112
aVOr import  directly in
p47113
aVWithout importing these, the  module has no reference to the nestend packages
p47114
as(dp47115
g16
V100297
p47116
stp47117
a((dp47118
g2
(lp47119
VYou essentially have CSV data in the XML text value
p47120
aVUse  to parse the XML, then use  to load that text into an array:
p47121
aVNote the generator expression, with a  call; this turns the text of the XML element into a sequence of lines, which  is quite happy to receive
p47122
aVWe do remove the trailing  character from each line
p47123
aVFor your sample input (minus the  lines), this results in:
p47124
as(dp47125
g16
V100297
p47126
stp47127
a((dp47128
g2
(lp47129
VThere is at least one row that doesn't have a 4th element
p47130
aVPerhaps the line is empty
p47131
aVTest for the length, and print the row to test:
p47132
aVIf it is an empty line, just skip it:
p47133
aVYou are using a lot of verbose and redundant code; there is no need to build a separate list when you can just loop over the  object directly, and there is no need to add an empty  block either
p47134
aVIdiomatic Python code would be:
p47135
aVThis use a  instead to create the dictionaries per row, a  statement to ensure the file is closed when done, and  with a start value to track
p47136
as(dp47137
g16
V100297
p47138
stp47139
a((dp47140
g2
(lp47141
VYou are getting the maximum key (by lexographical order)
p47142
aVlooks at the keys only, not the values, unless you tell it to with a  function
p47143
aVsorts before  or , so the maximum key is :
p47144
aVIf you expected the maximum value, use:
p47145
aVDemo:
p47146
as(dp47147
g16
V100297
p47148
stp47149
a((dp47150
g2
(lp47151
VYou can use the  function:
p47152
aVefficiently adds a count to the iterator you are looping over
p47153
aVIn the above example I tell  to start counting at  to match your example; the default is to start at 0
p47154
aVDemo:
p47155
as(dp47156
g16
V100297
p47157
stp47158
a((dp47159
g2
(lp47160
VYou could use the sets here, and take the start and end values from the input list:
p47161
aVThis assumes Python 3; for Python 2, use  to avoid building a list first
p47162
aVThe  call is optional; without it a  is returned of the missing values, with it you get a sorted list
p47163
aVDemo:
p47164
aVAnother approach is by detecting gaps between subsequent numbers; using an older  library sliding window recipe:
p47165
aVThis is a pure O(n) operatation, and if you know the number of missing items, you can make sure it only produces those and then stops:
p47166
aVThis will handle larger gaps too; if you are missing 2 items at 11 and 12, it'll still work:
p47167
aVand the above sample only had to iterate over  to figure this out
p47168
as(dp47169
g16
V100297
p47170
stp47171
a((dp47172
g2
(lp47173
VUse  instead, it joins the lines with newline characters:
p47174
aVreturns a list of wrapped lines
p47175
as(dp47176
g16
V100297
p47177
stp47178
a((dp47179
g2
(lp47180
VClasses do not create a scope
p47181
aVThis is documented in pep 227:
p47182
aVNames in class scope are not accessible
p47183
aVNames are resolved in
p47184
aVthe innermost enclosing function scope
p47185
aVIf a class definition
p47186
aVoccurs in a chain of nested scopes, the resolution process skips
p47187
aVclass definitions
p47188
aVand in the  compound statement documentation:
p47189
aVThe class\u2019s suite is then executed in a new execution frame (see section Naming and binding), using a newly created local namespace and the original global namespace
p47190
aV(Usually, the suite contains only function definitions
p47191
aVWhen the class\u2019s suite finishes execution, its execution frame is discarded but its local namespace is saved
p47192
aV[4] A class object is then created using the inheritance list for the base classes and the saved local namespace for the attribute dictionary
p47193
aVEmphasis mine; the execution frame is a temporary scope
p47194
aVTo access , use :
p47195
aVor access the  class by name, or use  to access the current class (which could be a subclass):
p47196
aVor
p47197
as(dp47198
g16
V100297
p47199
stp47200
a((dp47201
g2
(lp47202
VI suspect your terminal or console is doing the wrapping; you have a prefix on the line that you need to take into account when wrapping
p47203
aVInclude it in the text you are wrapping:
p47204
aVI've used  here to create a new string from the  and  attributes, with a colon in between
p47205
as(dp47206
g16
V100297
p47207
stp47208
a((dp47209
g2
(lp47210
VGenerate separate snippets and join them:
p47211
aVOr you can use string multiplication:
p47212
aVThe  removes the extraneous space at the end; you could use  as well
p47213
aVDemo:
p47214
aVTiming stats:
p47215
aVThe multiplied template option leaves the other options in the dust
p47216
as(dp47217
g16
V100297
p47218
stp47219
a((dp47220
g2
(lp47221
VDon't use  if you don't want it to be a list:
p47222
aVFrom the  option documentation:
p47223
aVNote that  produces a list of one item
p47224
aVThis is different from the default, in which the item is produced by itself
p47225
aVand
p47226
aVIf the nargs keyword argument is not provided, the number of arguments consumed is determined by the action
p47227
aVGenerally this means a single command-line argument will be consumed and a single item (not a list) will be produced
p47228
as(dp47229
g16
V100297
p47230
stp47231
a((dp47232
g2
(lp47233
VYou could use a list comprehension here; its more efficient at creating the final list
p47234
aVDon't use  when iteration will do, don't use  as a variable name, and there is no need to call  on each row:
p47235
as(dp47236
g16
V100297
p47237
stp47238
a((dp47239
g2
(lp47240
VYou are not using  correctly
p47241
aVYou don't need to use it at all
p47242
aVYou need to actually set a global  variable, there is none right now
p47243
aVdoes not make the variable available
p47244
aVJust create a global  first:
p47245
aVthen refer to it in your function
p47246
aVThat is what the  exception is trying to tell you; Python cannot find the global  variable, you didn't assign anything to the name so it doesn't exist
p47247
aVYou only need to use  if you want to assign to a global  in your function:
p47248
aVHere the  keyword is needed to distinguish  from a local variable in the function
p47249
aVCompare:
p47250
aVto
p47251
aVThe first form only set a local variable, the second form set the global variable instead
p47252
as(dp47253
g16
V100297
p47254
stp47255
a((dp47256
g2
(lp47257
VYou want to call the function after defining it:
p47258
aVRemember that Python defines blocks by indentation, so put the  line on the same indentation level as the  line
p47259
aVYou also want to remove the  call from the first line of the function
p47260
aVSome other tips:
p47261
aVDon't create  series of variables
p47262
aVUse lists instead:
p47263
aVIf you want to add 5 to the  variable, you need to store it back in that variable:
p47264
aVor, shorter:
p47265
aVThe  function looks for the list index of the value ; you probably wanted to use indexing directly instead:
p47266
aVRemember that Python list indexes start at 0, not 1
p47267
aVIf you use lists for your fish and trash variables, you can do:
p47268
aVand eliminate all the extra  branches
p47269
aVInstead of using recursion, use a loop:
p47270
as(dp47271
g16
V100297
p47272
stp47273
a((dp47274
g2
(lp47275
VYou need to turn the first file into a set (for fast membership testing)
p47276
aVYou are also using , which gives you three pieces of information, the path to the directory, a list of subdirectories and a list of the files in that directory:
p47277
aVThe  call returns all elements in the  set that are also in the  list
p47278
aVNote that I tell  the full path of the file to move to , using  based on the  variable (path of the directory the file is in) and the filename
p47279
as(dp47280
g16
V100297
p47281
stp47282
a((dp47283
g2
(lp47284
VYou need to bind to the item, you do not need to add a new  instance:
p47285
aVThat's it
p47286
as(dp47287
g16
V100297
p47288
stp47289
a((dp47290
g2
(lp47291
VWhen you redirect Python output, the  stream is opened in buffered mode (instead of line-buffered mode)
p47292
aVThis means that output is kept in memory until enough lines have been printed before flushing the buffer
p47293
aVTo see lines immediately, you need to flush the output stream:
p47294
aVAlternatively, use the  command line switch to force unbuffered I/O:
p47295
aVor you can use the  environment variable:
p47296
aVor re-open the  filehandle in unbuffered mode:
p47297
aVIn Python 3
p47298
aV3 and up this is all a little simpler; you simply tell  to flush:
p47299
as(dp47300
g16
V100297
p47301
stp47302
a((dp47303
g2
(lp47304
VThere are several problems with your function
p47305
aVFirst of all, use  to simplify the test for sequences:
p47306
aVYou need to loop over the recursive  call to pass the elements on to the caller, and pass in the list as separate arguments (using the  syntax, to mirror the function signature):
p47307
aVWith these changes the generator works:
p47308
as(dp47309
g16
V100297
p47310
stp47311
a((dp47312
g2
(lp47313
VUse sets to see if a your tuple is part of the larger tuple:
p47314
aVYou want to turn  into a set once:
p47315
aVIt'd be more efficient to generate all combinations that are guaranteed to be matches though:
p47316
aVEach  is a valid combination of 5 numbers between 1 and 49 inclusive that have all 3 numbers of the  in them, without having to create all possible combinations
p47317
aVIf you create these as generator functions, you can verify that they produce the same output (apart from tuples versus lists;  returns a list):
p47318
aVbut the second method is so much faster:
p47319
aVYes, that is nearly 1000 times faster
p47320
as(dp47321
g16
V100297
p47322
stp47323
a((dp47324
g2
(lp47325
VThere is absolutely nothing magic about the name
p47326
aVIt is just a name
p47327
aVIn this specific example, the name is not used, redundant, and can be removed altogether
p47328
aVA class called  is called, and the result of that call, an instance of the class, is stored in the name
p47329
aVOr it would be if it wasn't for the fact that instantiating the class triggers an infinite loop
p47330
aVCreating an instance means the class  method is invoked, which does:
p47331
aVSo this instance creates a Curses screen, changes a few settings, sets a few instance attributes and calls to methods on the instance,  and
p47332
aVThe  method does all the work, looping endlessly
p47333
aVIt never returns (rather, it calls  at some point, which doesn't actually exist so that'd raise an exception)
p47334
aVAs a result, the  method never returns either, and thus the  call never returns and nothing is ever assigned to
p47335
aVYou could completely remove the  part and not change the functionality of the code:
p47336
aVNot having  there would at least remove the confusion
p47337
as(dp47338
g16
V100297
p47339
stp47340
a((dp47341
g2
(lp47342
VSort the test sets by their order attribute:
p47343
as(dp47344
g16
V100297
p47345
stp47346
a((dp47347
g2
(lp47348
VYou have misunderstood how  and  work
p47349
aVYou need to test each and every character separately:
p47350
aVor use an  test:
p47351
aVexcept that you are testing characters here, not integers, so either turn your character into an integer, or test against digits:
p47352
aVor
p47353
aVThe latter works because strings are sequences too; testing if one character is in the string  is a valid membership test too
p47354
aVSince strings are sequences, you can also just loop over them directly:
p47355
aVNo need to use a  loop and counter there
p47356
aVThis still only tests for digits; to test for letters as well, you could do one of two things:
p47357
aVUse the  module, it has  and  attributes:
p47358
aVor test if the character is between two known characters:
p47359
aVand this works because strings are comparable and sortable; they are smaller or larger according to their position in the ASCII code table
p47360
aVYour next problem is that you are returning  too early; you do this for the first match, but you need to test all characters
p47361
aVOnly return  if you didn't find any misses:
p47362
aVNow we test all characters, return  for the first character that is not alphanumeric, but only when the loop has completed, do we return
p47363
as(dp47364
g16
V100297
p47365
stp47366
a((dp47367
g2
(lp47368
VYes, file objects are iterators
p47369
aVLike all iterators, you can only loop over them once, after which the iterator is exhausted
p47370
aVYour file read pointer is at the end of the file
p47371
aVRe-open the file, or use  to rewind the file pointer if you need to loop again
p47372
aVAlternatively, try to avoid looping over a file twice; extract what you need into another datastructure (list, dictionary, set, heap, etc
p47373
aVduring the first loop
p47374
as(dp47375
g16
V100297
p47376
stp47377
a((dp47378
g2
(lp47379
VYou want to use  to format the timestamp; convert it to a time tuple first using either  or :
p47380
as(dp47381
g16
V100297
p47382
stp47383
a((dp47384
g2
(lp47385
VYou are not creating a copy of the list; you merely create a second reference to it
p47386
aVIf you wanted to create a temporary (shallow) copy, do so explicitly:
p47387
aVor use the full-list slice:
p47388
aVYou modify the mutable list in-place when calling  on the object, so all references to that list will see the changes
p47389
aVThe alternative is to create a new list by using concatenation instead of extending:
p47390
aVNow the  variable has been re-bound to a new list;  still refers to the old list
p47391
as(dp47392
g16
V100297
p47393
stp47394
a((dp47395
g2
(lp47396
VRead all inputfiles into one list, sort the result and write out the lines again:
p47397
aVIf your files are large however, you want to sort the files separately, write out the sorted results, then merge the sorted files into the new output file, line by line, using a merge generator function
p47398
aVYou appear to be working with Windows files, which use  (carriage return plus linefeed) line endings; you could use universal lineending support and open the files with  mode to always give you  line endings:
p47399
aVFor more details on the  mode character, see the  function call
p47400
aVTo remove any duplicates, you'd create a set instead of a list, then use  to write out a sorted sequence again:
p47401
as(dp47402
g16
V100297
p47403
stp47404
a((dp47405
g2
(lp47406
VYou are running with a stale bytecode cache or are re-running the code in an existing interpreter without restarting it
p47407
aVThe traceback code has only bytecode to work with, which contains filename and linenumber information
p47408
aVWhen an exception occurs, the source file is loaded to retrieve the original line of code, but if the source file has changed, that leads to the wrong line being shown
p47409
aVRestart the interpreter and/or remove all  files; the latter will be recreated when the interpreter imports the code again
p47410
aVAs for your specific exception; you probably imported the  class from the  module somewhere:
p47411
aVThe  class does not have a  attribute, only the module does
p47412
as(dp47413
g16
V100297
p47414
stp47415
a((dp47416
g2
(lp47417
VUse a  object:
p47418
as(dp47419
g16
V100297
p47420
stp47421
a((dp47422
g2
(lp47423
VYou want to use simple division and the remainder; the  function gives you both:
p47424
aVTo create your desired output, then use the output of :
p47425
aVis the number of the current chunk (starting at 1; python uses 0-based indexing normally)
p47426
aVThis prints:
p47427
as(dp47428
g16
V100297
p47429
stp47430
a((dp47431
g2
(lp47432
VYou are creating  objects, not
p47433
aVDates ignore all time information
p47434
aVUse  objects instead if you want to preserve the time component:
p47435
as(dp47436
g16
V100297
p47437
stp47438
a((dp47439
g2
(lp47440
VMethods are attributes too
p47441
aVThey just happen to be callable objects
p47442
aVYou can detect if an object is callable by using the  function:
p47443
aVWhen you call a method, you look up the attribute (a  operation) and then call the result:
p47444
aVis two steps; finding the attribute (which in this case looks up the attribute on the class, and treats it as a descriptor), then calls the resulting object, a method
p47445
aVWhen you assign to an attribute, you rebind that name to a new value:
p47446
aVwould be a  operation
p47447
aVIf you wanted to intercept getting and setting attributes on instances of your class, you could provide the attribute access hooks, ,  and
p47448
aVIf you wanted to add a method to an instance, you would have to treat the function as a descriptor object, which produces a method object:
p47449
aVThe return value of , when given an instance and a class, is a bound method
p47450
aVCalling that method will call the underlying function with  bound to the instance
p47451
aVAnd speaking of descriptors, the  function returns a descriptor too, making it possible to have functions that behave like attributes; they can intercept the ,  and  operations for just that attribute and turn it into a function call:
p47452
aVAccessing  invoked the  property get hook, which then calls the original  method
p47453
aVIn almost all situations, you are not going to need the  function; you document your API, and provide methods and attributes and the user of your API will figure it out without testing each and every attribute to see if it is callable
p47454
aVWith properties, you have the flexibility of providing attributes that are really callables in any case
p47455
as(dp47456
g16
V100297
p47457
stp47458
a((dp47459
g2
(lp47460
VThe python numeric limitations, such as there are any, are available on the  module:
p47461
aVis a named tuple with floating point limitations for your platform
p47462
aVFloating point numbers consist of a exponent and a precision; you'd have to be more precise about what you mean by the largest number here; the  number with the largest exponent  and the full precision in use is
p47463
aV; not so much limitations as the implementation detail; you should be able to estimate the largest integer possible from this
p47464
aVPython integers are only limited by your available memory
p47465
aV; the platform word size and limit to lists and tuples and the likes
p47466
aVSo for integers, there basically is a soft limit to the maximum and minimum values
p47467
aVIt depends on how much memory your process can use, and how much memory your process is already using for other things
p47468
aVIn Python 3, there no longer is a separate  type, but in Python 2,  would have to be a , as would
p47469
aVBetween those two extremes lies the range of possible 'short' integers
p47470
aVFor complex numbers, ordering is a little more
p47471
aVcomplex anyway
p47472
aVComplex numbers have a real and imaginary component, both are floats
p47473
aVGuess what
p47474
aVThese are python floats and you already have their limit info above:
p47475
as(dp47476
g16
V100297
p47477
stp47478
a((dp47479
g2
(lp47480
VYes, use  to create a new callable that'll call your function with arguments:
p47481
aVstores your function and your arguments, and when you call the partial object returned, it in turn will invoke the function with those arguments
p47482
aVYou can add extra arguments when calling that object too:
p47483
aVYou can achieve the same thing with lambdas:
p47484
aVbut a  is faster and provides the option to pass in more arguments
p47485
as(dp47486
g16
V100297
p47487
stp47488
a((dp47489
g2
(lp47490
VImporting works a little different, your class is an attribute of the module:
p47491
aVAlternatively use the  form:
p47492
as(dp47493
g16
V100297
p47494
stp47495
a((dp47496
g2
(lp47497
VYou need to add  to an existing list, using :
p47498
aVNow  is a list containing all the words of the lines your user entered
p47499
aVDemo:
p47500
as(dp47501
g16
V100297
p47502
stp47503
a((dp47504
g2
(lp47505
VRead the data in blocks
p47506
aVWhen you reach the end of the device,  will return the empty string
p47507
aVYou can use  with a sentinel to do this easily in a loop:
p47508
aVYou really want to open the device in binary mode,  if you want to make sure no line translations take place
p47509
aVHowever, if you are trying to create copy into another file, you want to look at :
p47510
aVand it'll take care of the opening, reading and writing for you
p47511
aVIf you want to have more control of the blocksize used for that, use , open the file objects yourself and specify a blocksize:
p47512
as(dp47513
g16
V100297
p47514
stp47515
a((dp47516
g2
(lp47517
VYou are setting the  initializer to :
p47518
aVDon't do that
p47519
aVPython expects that to be a method
p47520
aVIf you do not want to have a  method, do not specify it at all
p47521
aVAt most, make it an empty function:
p47522
aVIf you wanted to create an enum-like object, take a look at How can I represent an 'enum' in Python
p47523
aVFor Python 2
p47524
aV7, you could use:
p47525
as(dp47526
g16
V100297
p47527
stp47528
a((dp47529
g2
(lp47530
VIt is just a warning; there is no need to fix anything here
p47531
aVYou could suppress the warning, perhaps
p47532
aVBut it is up to the  project to properly silence that warning
p47533
aVTo suppress the warning, you can use the  module:
p47534
as(dp47535
g16
V100297
p47536
stp47537
a((dp47538
g2
(lp47539
VUse ; simply subtract the two dates:
p47540
as(dp47541
g16
V100297
p47542
stp47543
a((dp47544
g2
(lp47545
VYou need to look for unicode values:
p47546
aVDemo:
p47547
aVYou need to make sure you set the source code encoding correctly, or use unicode escape codes
p47548
as(dp47549
g16
V100297
p47550
stp47551
a((dp47552
g2
(lp47553
VSimply build the structure:
p47554
aVThis gives:
p47555
aVbut you really want to rethink the strategy of your structure
p47556
aVYou'd have to search through the list for a mapping (in the exception handlers) otherwise
p47557
as(dp47558
g16
V100297
p47559
stp47560
a((dp47561
g2
(lp47562
VThe  object itself has a  attribute
p47563
aVYou can add these in a separate loop:
p47564
aVFor your example code, that gives:
p47565
aVYou can combine it with your existing list comprehension by creating an extra nested loop with one element:
p47566
as(dp47567
g16
V100297
p47568
stp47569
a((dp47570
g2
(lp47571
VAdd a  module to your  package with:
p47572
aVthen wherever you need to have access to the database path, use , after which you can access  to get that path
p47573
as(dp47574
g16
V100297
p47575
stp47576
a((dp47577
g2
(lp47578
VUse the file as an iterator (different, potentially more optimal buffer strategy), and take advantage of generator expressions:
p47579
aVThis treats booleans as integers (they are a subclass;  is 1 in an integer context,  is 0)
p47580
aVOr try:
p47581
aVThese do different amounts of work, and depending on the amount of divisible numbers present, one could be faster than the other ( tests  versus summing 0s and 1s)
p47582
as(dp47583
g16
V100297
p47584
stp47585
a((dp47586
g2
(lp47587
VYou have a line that does not have two items on it:
p47588
aVdid not split to two elements and that throws the error
p47589
aVMost likely because you are not splitting your  variable properly and have the whole text as one long text
p47590
aVdoes not occur in your  data
p47591
aVUse  instead:
p47592
as(dp47593
g16
V100297
p47594
stp47595
a((dp47596
g2
(lp47597
VLoop over the intersection of the keys:
p47598
aVThis can be simplified to a dict comprehension:
p47599
aVThis uses the  method ( in Python 3), which acts like a ; the  operator acts like a intersection operator on sets and gives you all keys that are present in both dictionaries
p47600
aVTo sum the total stock, use the  function:
p47601
aVDemo:
p47602
as(dp47603
g16
V100297
p47604
stp47605
a((dp47606
g2
(lp47607
VThere is no point in using  if you don't use an encoding
p47608
aVEither use  with an encoding specified for both reading and writing, or forgo it completely
p47609
aVWithout an encoding,  is an alias for just
p47610
aVHere you really do want to specify the codec of the file you are opening, to process Unicode values
p47611
aVYou should also use  literal values when straying beyond ASCII characters; specify a source file encoding or use unicode escape codes for your data:
p47612
aVThis specifies to the interpreter that you used the UTF-8 codec to save your source files, ensuring that the  code points are correctly decoded to Unicode values, and using  when opening files with  makes sure  that the lines you read are decoded to Unicode values and ensures that your Unicode values are written out to the output file as UTF-8
p47613
aVNote that the  value is a Unicode value as well
p47614
aVIf you use a Unicode path, then  returns Unicode filenames, which is essential if you have any non-ASCII characters in those filenames
p47615
aVIf you do not do all this, chances are your source code encoding does not match the data you read from the file, and you are trying to replace the wrong set of encoded bytes with a few ASCII characters
p47616
as(dp47617
g16
V100297
p47618
stp47619
a((dp47620
g2
(lp47621
VUse a  object:
p47622
aVThis has the nice side-effect of sorting your words by frequency
p47623
aVIf you need the words sorted in alphabetical order, sort the  result:
p47624
aVDemos:
p47625
as(dp47626
g16
V100297
p47627
stp47628
a((dp47629
g2
(lp47630
VYou need to encode the  unicode value explicitly:
p47631
aVon a unicode value implicitly encodes that value, using the default codec (ASCII on Python 2)
p47632
as(dp47633
g16
V100297
p47634
stp47635
a((dp47636
g2
(lp47637
VPython 3 added extended tuple unpacking with support for one wildcard, see PEP 3132:
p47638
aVSee the assignment statements reference documentation:
p47639
aVIf the target list contains one target prefixed with an asterisk, called a \u201cstarred\u201d target: The object must be a sequence with at least as many items as there are targets in the target list, minus one
p47640
aVThe first items of the sequence are assigned, from left to right, to the targets before the starred target
p47641
aVThe final items of the sequence are assigned to the targets after the starred target
p47642
aVA list of the remaining items in the sequence is then assigned to the starred target (the list can be empty)
p47643
aVUse of an asterix in the lef-hand side (target list) of an assignment is a syntax error in Python 2
p47644
as(dp47645
g16
V100297
p47646
stp47647
a((dp47648
g2
(lp47649
VYou only ever increment  if the  statements are
p47650
aVIf they never are, you entered into an infinite loop:
p47651
aVYour inner  loop never completes, so your outer  loop is never tested
p47652
aVChange this to:
p47653
as(dp47654
g16
V100297
p47655
stp47656
a((dp47657
g2
(lp47658
VPython doesn't support overloading, because it doesn't need to
p47659
aVYou normally use keyword parameters with defaults instead:
p47660
aVHowever, a setter on a property only ever takes one argument, the value; you'd have to detect passing in a sequence instead:
p47661
as(dp47662
g16
V100297
p47663
stp47664
a((dp47665
g2
(lp47666
VYou are doing some very funky stuff there that is totally not necessary
p47667
aVThis loop is your problem:
p47668
aVYou are setting the same 5 global variables over and over again, overwriting the previous version
p47669
aVYour use of  is totally not needed when you have the  function giving you the global namespace as a dictionary
p47670
aVBut setting global variables to solve a simple problem is like using a shotgun to catch one gnat
p47671
aVYour code could be vastly simplified:
p47672
aVSample printed output for  set to 5:
p47673
as(dp47674
g16
V100297
p47675
stp47676
a((dp47677
g2
(lp47678
VYou normally would do this with a  loop; I'd just use slicing:
p47679
aVWith a  loop, where you do the incrementing yourself, you'd use:
p47680
aVNote that we just jump through the whole grid  steps at a time, and let  to the per-row work
p47681
aVYou can do that part in a loop too:
p47682
aVTo list the grid by column (so, transposed), you'd need to use:
p47683
as(dp47684
g16
V100297
p47685
stp47686
a((dp47687
g2
(lp47688
VUse the  method to remove tags, preserving their contents:
p47689
as(dp47690
g16
V100297
p47691
stp47692
a((dp47693
g2
(lp47694
VA regular expression with  word boundaries would do the trick:
p47695
aVreturns a list of all 3-digit numbers
p47696
aVDemo:
p47697
as(dp47698
g16
V100297
p47699
stp47700
a((dp47701
g2
(lp47702
VSubtract 256 if over 127:
p47703
aVAlternatively, repack the byte with the  module:
p47704
aVor directly from the character:
p47705
as(dp47706
g16
V100297
p47707
stp47708
a((dp47709
g2
(lp47710
VYou missed a closing parenthesis:
p47711
aVNote that there are two opening, but only one closing parens
p47712
aVNext problem is that you are using curly braces further down:
p47713
aVThis is Python, not C, Java or Javascript; remove the braces and use a colon:
p47714
aVThen you are using parenthesis in a  statement in a way that is not legal Python:
p47715
aVRemove those parenthesis:
p47716
aVNext problem is that you don't define  for two of your methods:
p47717
aVand
p47718
aVAdd  as a first parameter:
p47719
aVNext, you are treating the  and  methods as globals, you need to add  in front of these to call them as methods on the current instance:
p47720
aVshould be (without the redundant parenthesis):
p47721
aVYou then refer to  (which is missing the path) where you wanted  instead (which includes the path):
p47722
aVor you'll get errors opening those files
p47723
aVThen, your file extension testing is flawed; just use  to prevent matching files such as  or
p47724
aVMoreover, there is no need to first ask  to test if something is , then separately return  or ; you can return the boolean test directly:
p47725
aVWhen counting along when looping over sequences, use the  function to generate the counter for you:
p47726
aVcounts lines, starting from 1
p47727
aVNote that  already traverses subdirectories for you
p47728
aVThere is no need to recurse again
p47729
aVRemove the recursion by removing the lines:
p47730
aVWith a few more improvements (use  to have the open file closed again, set  outside the loop, filter early, use string formatting, write out the original line, not lowercased), the full script becomes:
p47731
as(dp47732
g16
V100297
p47733
stp47734
a((dp47735
g2
(lp47736
VDon't encode; the  file stream is opened with your terminal encoding and encodes unicode for you:
p47737
aVYou don't need to use ; python 3 strings are unicode values by default
p47738
aVDemo:
p47739
as(dp47740
g16
V100297
p47741
stp47742
a((dp47743
g2
(lp47744
V expects to have a list of sequences; a list of lists or tuples, really, but strings are sequences too
p47745
aVAppend tuples to :
p47746
aVBecause strings are sequences too, sequences of single characters, you see your  input being split into separate cells
p47747
aVWhat you really want, is for  to separate your values though; if you want a space separated list, use:
p47748
aVand tell  to use spaces as the delimiter:
p47749
as(dp47750
g16
V100297
p47751
stp47752
a((dp47753
g2
(lp47754
VCreate two counters with  and alternate between them in a generator function:
p47755
aVor, version with variable number of counters:
p47756
aVShort demo:
p47757
aVor for the variable number version:
p47758
as(dp47759
g16
V100297
p47760
stp47761
a((dp47762
g2
(lp47763
VMove your  until after your  test:
p47764
aVNote how the above version only converts  to an integer at the last minute
p47765
as(dp47766
g16
V100297
p47767
stp47768
a((dp47769
g2
(lp47770
VThere are no attributes missing in the instance dictionary
p47771
aVLet's take a look at the representation of the element:
p47772
aVWe have a tag name (), attributes ( and , with values) and we have textual content ()
p47773
aVThese are all present in the instance attributes you listed:
p47774
aVis a list of direct descendants of this element; there is only one, a text object ( instances use a representation that looks just like a regular string)
p47775
aVYou could use the  built-in API function to list instance attributes
p47776
aVI see you are using  already; rather than loop over , just use  and save yourself typing a full loop; as a bonus  sorts the keys first:
p47777
aVThe string you are looking at is built by the  hook of the element class:
p47778
aVwhich normally is called when  is used on an object:
p47779
aVThe string is built up from the parsed element information you see in the objects attributes
p47780
as(dp47781
g16
V100297
p47782
stp47783
a((dp47784
g2
(lp47785
VThis means that the server did not send an encoding for the content in the headers, and the  library was also not able to determine an encoding for the contents
p47786
aVYou in fact deliberately test for the lack of encoding; why try to get decoded text if no encoding is available
p47787
aVYou can try to leave the decoding up to the  parser:
p47788
aVand there is no need to pass in the encoding to BeautifulSoup, since if  does not fail, you are using Unicode and BeautifulSoup will ignore the encoding parameter anyway:
p47789
as(dp47790
g16
V100297
p47791
stp47792
a((dp47793
g2
(lp47794
VIt is not being called; you are inheriting from it instead;  is called to create an instance of the class
p47795
aVis called by the  code; your subclass overrides it to handle textual data in the document
p47796
aVBy calling  on your  instance the process is started
p47797
aVSee the  module documentation for the full API
p47798
aVYou could try to understand the full  source code if you really want to know how this all works
p47799
aVThe example you found is doing things quite wrong, actually
p47800
aVThe  refers to a different  variable, one that lives in the module scope
p47801
aVThat line shows that the original developer of that example did not understand what they were doing
p47802
aVThe  line is not the only example; the code could be made much more Pythonic in other ways
p47803
aVThe  definition in the class scope otherwise unused
p47804
aVThe  method should refer to  instead:
p47805
aVThis stores the element text in  for each element, and if a next element matches your  global variable, then it is printed as well, together with the professor name
p47806
aVYou may want to look into using BeautifulSoup instead for a more intuitive HTML parser API
p47807
as(dp47808
g16
V100297
p47809
stp47810
a((dp47811
g2
(lp47812
V without arguments or  as the first argument removes whitespace around the line first, but  does not
p47813
aVRemove it explicitly before splitting:
p47814
aVor after:
p47815
aVremoves all leading and trailing whitespace
p47816
aVYou can be more specific and only remove newlines from the end using `
p47817
aVrstrip():
p47818
as(dp47819
g16
V100297
p47820
stp47821
a((dp47822
g2
(lp47823
VYou want to format your float value for printing only; use formatting:
p47824
aVThe  is a formatting mini language specification for a floating point value of 2 digits after the decimal
p47825
aVYou need to remove the  call to preserve those digits after the decimal
p47826
aVYou don't need to call  so much either:
p47827
aVDemo:
p47828
aVYou can further tweak the formatting to align those numbers up along the decimal point too
p47829
as(dp47830
g16
V100297
p47831
stp47832
a((dp47833
g2
(lp47834
VOpen the file using universal line ending support:
p47835
aVThis avoids opening the file in native-platform text mode (in the C call) and prevents Windows from interpreting the  code point as a line break
p47836
as(dp47837
g16
V100297
p47838
stp47839
a((dp47840
g2
(lp47841
VA week number is not enough to generate a date; you need a day of the week as well
p47842
aVAdd a default:
p47843
aVThe  and  pattern tells the parser to pick the sunday in that week
p47844
aVThis outputs:
p47845
aVYou can pick your own weekday, whatever fits your use case best; the  pattern bases weeks from monday, so perhaps  is a better default here
p47846
aVSee the  and  behaviour section in the documentation, footnote 4:
p47847
aVWhen used with the  method,  and  are only used in calculations when the day of the week and the year are specified
p47848
as(dp47849
g16
V100297
p47850
stp47851
a((dp47852
g2
(lp47853
VJust add another wrapper to capture the  parameter:
p47854
aVI've renamed your original  function to  (because that is what that function did, it decorated ) and renamed the old  to , the usual convention
p47855
aVWhatever you put after the  is an expression, evaluated first to find the actual decorator function
p47856
aVmeans you want to call  and it's return value is then used as the actual decorator for the function the  line applies to
p47857
as(dp47858
g16
V100297
p47859
stp47860
a((dp47861
g2
(lp47862
VYou only call  once, outside the loop:
p47863
aVThe  expression does nothing; no new  calls are made
p47864
aVIf you want to call a new game for each loop, do:
p47865
as(dp47866
g16
V100297
p47867
stp47868
a((dp47869
g2
(lp47870
VYou are trying to print the attribute  of the  method
p47871
aVThat attribute does not exist
p47872
aVLocal variables of a function are not exposed; you cannot reach  unless you make it a instance attribute:
p47873
aVthen
p47874
as(dp47875
g16
V100297
p47876
stp47877
a((dp47878
g2
(lp47879
VYour  method doesn't return anything:
p47880
aVYou need to add a  statement there:
p47881
aVWhen a function doesn't have an explicit return statement, it's return value is always
p47882
aVThus, the line:
p47883
aVsets  to
p47884
aVHowever, even if  does return it's  result, you now have replaced  with a string result, and your next iteration through the loop will now fail because string objects do not have a  method
p47885
aVYou are also referring to a global  value everywhere, after passing it in as an argument to your  instance, storing it as  there
p47886
aVDon't rely on globals, you already have :
p47887
aVIn the above code we dispense with accessing the  global, instead using
p47888
aVThe  variable is strictly used to hold the current guess, and we use  instead
p47889
as(dp47890
g16
V100297
p47891
stp47892
a((dp47893
g2
(lp47894
VIt is very far from CSV, actually
p47895
aVYou can use the file as an iterator; the following generator function yields complete sections:
p47896
aVThis treats the file as an iterator, meaning that any looping advances the file to the next line
p47897
aVThe outer loop only serves to move from section to section; the inner  and  loops do all the real work; first skip lines until a  header section is found (otherwise discarded), then loop over all non-empty lines to create a section
p47898
aVUse the function in a loop:
p47899
aVRepeating your sample data in a text file results in:
p47900
aVYou can add some data converters to that if you want to; a mapping of key to callable would do:
p47901
aVthen in the generator function, instead of  do
p47902
as(dp47903
g16
V100297
p47904
stp47905
a((dp47906
g2
(lp47907
VThe  module has been deprecated:
p47908
aVDeprecated since version 2
p47909
aV6: The  module has been removed in Python 3
p47910
aVUse the  module instead
p47911
aVAs stated, use the  module instead, both in Python 2 and 3:
p47912
as(dp47913
g16
V100297
p47914
stp47915
a((dp47916
g2
(lp47917
VYou are almost there:
p47918
aVPython 2 is a little persnickety and funny about mixing ,  and additional named keyword arguments; your best bet is to not add additional explicit keyword arguments and just take them from  instead
p47919
aVThe  method removes the key from the dictionary, if present, returning the associated value, or the default we specified if missing
p47920
aVThis means that we do not pass  on to the super class
p47921
aVUse  if you just want to check if the paramater has been set without removing it
p47922
as(dp47923
g16
V100297
p47924
stp47925
a((dp47926
g2
(lp47927
VSure it is possible:
p47928
aVbut this incurs a full scan through the dictionary
p47929
aVIt only finds the first such matching key (where 'first' is arbitrary) and raises  instead of  if no keys match
p47930
aVTo get closer to what you are thinking of, it's better to write this as a function:
p47931
as(dp47932
g16
V100297
p47933
stp47934
a((dp47935
g2
(lp47936
VYou are trying to solve a problem that does not exist
p47937
aVThe browser is responsible for detecting and handling the web page encoding
p47938
aVIt'll determine the correct encoding based on the server headers, meta tags in the HTML page and plain guessing if needed
p47939
aVThe DOM gives you Unicode data
p47940
aVJSON handles Unicode data; sending JSON data to your Python process sends appropriately encoded byte data that any decent JSON library will turn back into Unicode values for you
p47941
aVThe Python  module is such a library
p47942
aVJust load the data from your JavaScript script with the  or  functions as is
p47943
aVYour browser will already have used the correct encoding (most likely UTF-8), and the Python  module will decode any of the standard encodings used without additional configuration or handling
p47944
as(dp47945
g16
V100297
p47946
stp47947
a((dp47948
g2
(lp47949
VThe  option was only added in Tornado 3
p47950
aV1 (currently in development)
p47951
aVYou'll need to upgrade your Tornado library to use it, using a checkout or download from the Tornado GitHub repository
p47952
aVSee the 3
p47953
aV1b1 release notes:
p47954
aVand other  instances support some new dict-like methods: , iteration over keys, and (read-only) access to options with square braket syntax
p47955
aVreturns all options with a given group name, and  returns all options
p47956
aVIf you are new to Tornado, you may want to stay away from the bleeding edge and use a released version instead
p47957
as(dp47958
g16
V100297
p47959
stp47960
a((dp47961
g2
(lp47962
VBy the time you hit , your list is , having replaced the first 3 elements
p47963
aVfinds the first occurence of , at index 2, not 5, as you appear to be expecting
p47964
aVThe same goes for ; you already replaced  with  earlier in the loop and  returns  instead of
p47965
aVDon't use  on a changing list; use  instead:
p47966
aVwhich then results in:
p47967
aVYou can replace  with a simple
p47968
aVAnd you can replace your whole script with:
p47969
as(dp47970
g16
V100297
p47971
stp47972
a((dp47973
g2
(lp47974
VYour headers and URL suggest you wanted to post JSON data
p47975
aVEncode your python structure to JSON using the  library:
p47976
aVJSON may look a lot like Python, but it is really a limited form of JavaScript source code
p47977
as(dp47978
g16
V100297
p47979
stp47980
a((dp47981
g2
(lp47982
VYou need to exit your function when you get an exception:
p47983
aVbecause if you do get the exception,  is never set, leading to your  exception
p47984
aVI used  here as an example; your script breaks either way
p47985
aVYou probably should re-raise the exception, or return a suitable default value
p47986
as(dp47987
g16
V100297
p47988
stp47989
a((dp47990
g2
(lp47991
VYour  dictionary is the namespace the interactive shell works in; any assignments to that namespace are reflected directly in that dictionary
p47992
aVIf you need to round-trip certain variables, you'll need to set those variables from the  dictionary:
p47993
aVLike everywhere else in Python, rebinding a variable in the interactive shell does not update other references to the old value
p47994
as(dp47995
g16
V100297
p47996
stp47997
a((dp47998
g2
(lp47999
VYou are not using the full  API here, may as well replace that with a
p48000
aVthen printing:
p48001
aVwhich outputs:
p48002
as(dp48003
g16
V100297
p48004
stp48005
a((dp48006
g2
(lp48007
VThe Python database API standard (PEP 249) does not specify what  returns:
p48008
aVReturn values are not defined
p48009
aVAt a guess, the connector that this code is using returns the affected row count;  would then only be  if one row was updated by that statement
p48010
aVThe most popular Python MySQL adapter, MySQLdb currently returns  for that method; the proper, standards compliant way to make that test would be:
p48011
aVThis 2010 commit to MySQLdb does show that until then MySQLdb did indeed return the rowcount
p48012
as(dp48013
g16
V100297
p48014
stp48015
a((dp48016
g2
(lp48017
VEach of those 128 bits can be 0 or 1; if the left-most bits are 0 your number will be smaller than 2 ** 127 but they were still generated
p48018
aVThis is expected and perfectly normal behaviour
p48019
aVIf you need the left-most bit to be 1, always, use  instead:
p48020
aVThis generates a number that is guaranteed to have the first bit set to 1
p48021
aVAlternatively, generate a 127 bit number and add  to it:
p48022
aVYou can see this behaviour when formatting the  output as 0-padded binary using the  number:
p48023
aVThe numbers are perfectly random, but sometimes the left-most bits end up
p48024
aVBy generating 1 bit fewer instead, and adding in the left-most bit set to 1, you half the number of random values you can generate but guarantee you see 'all' your bits:
p48025
aVIt depends entirely on what you were trying to do if this is at all desirable
p48026
as(dp48027
g16
V100297
p48028
stp48029
a((dp48030
g2
(lp48031
VThe assignment list expressions are evaluated left-to-right while assigning
p48032
aVHere is what happens:
p48033
aVThe right-hand-expression is evaluated to yield
p48034
aVis evaluated to assign  to,  is altered, the list becomes
p48035
aVis evaluated to assign  to,  is altered again because that is now the first position  is back to
p48036
aVYou can see this in the disassembled Python byte code:
p48037
aVBy instruction index 59, Python has evaluated the right-hand-side expression; next up are the assignments
p48038
aVYou can see that  (63-72) is evaluated first, then the  stores the , and only then  is evaluated (instructions 79-85)
p48039
aVThe workaround is to call  once for each value, and storing the indices in variables:
p48040
as(dp48041
g16
V100297
p48042
stp48043
a((dp48044
g2
(lp48045
VThis is expected behaviour
p48046
aVis a generator function, and the body of a generator function is not executed until you iterate over the generator
p48047
aVFrom the  expressions documentation:
p48048
aVWhen a generator function is called, it returns an iterator known as a generator
p48049
aVThat generator then controls the execution of a generator function
p48050
aVThe execution starts when one of the generator\u2019s methods is called
p48051
aVAt that time, the execution proceeds to the first  expression, where it is suspended again, returning the value of  to generator\u2019s caller
p48052
aVThe line  creates that generator
p48053
aVYou pass the generator to  and the  loop starts iterating over the generator
p48054
aVIteration means the  method is called, advancing the generator function
p48055
aVSo, until  starts executing,  does nothing at all
p48056
aVCalling  on the generator starts running that function, until the  statement returns the first  expression to the  loop, at which point it the generator function is suspended again
p48057
as(dp48058
g16
V100297
p48059
stp48060
a((dp48061
g2
(lp48062
VIt is slow because you are re-reading a file for each loop iteration, and create a new function object
p48063
aVNeither of these two things are dependent on the loop variable; move these out of the loop to only run once
p48064
aVFurthermore, the simple function can be inlined; calling a function is relatively expensive
p48065
aVAnd don't call  twice, either
p48066
aVAnd you are only using lowercase letters to generate the words, so  is redundant:
p48067
aVSince you are generating words of length 4, you could save yourself some memory by only loading words of length 4 from your english words file:
p48068
as(dp48069
g16
V100297
p48070
stp48071
a((dp48072
g2
(lp48073
VRead your arguments in pairs:
p48074
aVhas otherwise no special handling for this kind of input
p48075
as(dp48076
g16
V100297
p48077
stp48078
a((dp48079
g2
(lp48080
V1 and 3 are closest, and the difference is that in 1 you create an instance of the  class, in 3 you don't; you are trying to use the unbound methods of the class without passing in an instance:
p48081
aVvs
p48082
aVVersion 2 just inlines calls;  is substituted for  and  is substituted for
p48083
aVYou really should be calling the bound methods instead:
p48084
aVWhat your two working versions are doing is calling the  methods directly, without an instance; the first argument to a method is always , but that can only be supplied automatically when you have an actual instance of the class and access the methods via that instance
p48085
aVUnder the hood, functions on a class behave as descriptor objects, meaning that on trying to access them on a class or instance they return a method object instead that will call the function on your behalve
p48086
aVYour first two versions have to supply a  instance manually instead, which your 3rd version is omitting
p48087
aVMy version obtains bound methods instead, by accessing the methods on a single  instance instead
p48088
aVYou can see the difference when you play with classes in a interactive session:
p48089
as(dp48090
g16
V100297
p48091
stp48092
a((dp48093
g2
(lp48094
VI think you wanted a boolean  operator instead:
p48095
aVor, for this specific case, you could also use an  membership test:
p48096
aVYou cannot use the  bitwise OR operator on unicode strings; it usually applies to integers instead:
p48097
aVor to sets (see all supported set operations):
p48098
aVor on objects that define the  special method, such as what the Django-specific  method returns
p48099
as(dp48100
g16
V100297
p48101
stp48102
a((dp48103
g2
(lp48104
VNo, that would not be fair to say
p48105
aVYou are creating instances of the same standard  type, which proxies file manipulation calls to the operating system
p48106
aVThe mode defines what the operating system will let you do
p48107
aVIt doesn't matter if you use the same filename or different filenames; the OS doesn't care, and neither does Python; the open file objects are distinct
p48108
aVThe Python object itself is immutable; you cannot change the mode, filename or other attributes after the fact
p48109
aVNote that by adding  to the mode, you can both read and write to the file object;  will truncate the file first, while  would not
p48110
as(dp48111
g16
V100297
p48112
stp48113
a((dp48114
g2
(lp48115
VDo what the error message tells you to do; run Python from the command line with the  command line switch to get a traceback
p48116
aVThere is an error in the  module and you need to fix that
p48117
aVAlternatively, set the  environment variable to get the same effect
p48118
as(dp48119
g16
V100297
p48120
stp48121
a((dp48122
g2
(lp48123
VThe  library supports iteration over all users:
p48124
aVproduces  objects
p48125
aVYou need the  call here, because the  endpoint only returns a smaller subset of user information, and location isn't included in that
p48126
aVThis requires another API request, so you may want to pace your script to avoid hitting the GitHub rate limits
p48127
aVA future version of  (newer than 0
p48128
ag4892
aV0) adds support to specify the page (batch) size  to reduce the number of API requests you need to make; the GitHub API defaults to 30 results per page but lets you load up to 100 results per page instead:
p48129
as(dp48130
g16
V100297
p48131
stp48132
a((dp48133
g2
(lp48134
VUse  objects instead, or convert your dictionaries:
p48135
aVor even:
p48136
aVobjects support finding the maximum per key natively through the  operation;  gives you the minimum
p48137
aVDemo:
p48138
aVor using the  version:
p48139
as(dp48140
g16
V100297
p48141
stp48142
a((dp48143
g2
(lp48144
VSo what is CPython
p48145
aVCPython is the original Python implementation
p48146
aVIt is the implementation you download from Python
p48147
aVorg
p48148
aVPeople call it CPython to distinguish it from other, later, Python implementations, and to distinguish the implementation of the language engine from the Python programming language itself
p48149
aVThe latter part is where your confusion comes from; you need to keep Python-the-language separate from whatever runs the Python code
p48150
aVCPython happens to be implemented in C
p48151
aVThat is just an implementation detail really
p48152
aVCPython compiles your python code into bytecode (transparently) and interprets that bytecode in a evaluation loop
p48153
aVCPython is also the first to implement new features; Python-the-language development uses CPython as the base, other implementations follow
p48154
aVWhat about Jython, etc
p48155
aVJython, IronPython and PyPy are the current 'other' implementations of the Python programming language; these are implemented in Java, C# and RPython (a subset of Python), respectively
p48156
aVJython compiles your Python code to Java bytecode, so your Python code can run on the JVM
p48157
aVIronPython lets you run Python on the Microsoft CLR
p48158
aVAnd PyPy, being implemented in (a subset of) Python, lets you run Python code faster than CPython, which rightly should blow your mind
p48159
aV:-)
p48160
aVActually compiling to C
p48161
aVSo CPython does itself not translate your Python code to C
p48162
aVIt instead runs a interpreter loop
p48163
aVThere is a project that does translate Python-ish code to C, and that is called Cython
p48164
aVCython adds a few extensions to the Python language, and lets you compile your code to C extensions, code that plugs into the CPython interpreter
p48165
as(dp48166
g16
V100297
p48167
stp48168
a((dp48169
g2
(lp48170
VUse  to find the table following your  tag, then take it from there:
p48171
aVI used  here, assuming that each table cell contains only text (no markup)
p48172
aVIf there is markup, perhaps you want to use  and  instead
p48173
as(dp48174
g16
V100297
p48175
stp48176
a((dp48177
g2
(lp48178
VUse :
p48179
aVThe image library determines what encoder to use by the extension, but in certain versions of PIL the JPEG encoder do not register the  extension, only
p48180
aVAnother possibility is that your PIL installation doesn't support JPEG at all; try saving the image as a PNG, for example
p48181
as(dp48182
g16
V100297
p48183
stp48184
a((dp48185
g2
(lp48186
VPython can reuse memory positions
p48187
aVWhen you run:
p48188
aVyou create a float value, ask for its , and then Python deletes the value again because nothing refers to it
p48189
aVWhen you then create another float value, Python can reuse the same memory position and thus  is likely to return the same value for :
p48190
aVDo this instead:
p48191
aVNow the float values have references to them (the two variables) and won't be destroyed, and they now have different memory positions and thus  values
p48192
aVThe reason you see different  values for small integers (from -5 through to 256) is because these values are interned; Python only creates one  integer object and re-uses it over and over again
p48193
aVAs a result, these integers all have a unique memory address regardles, as the Python interpreter itself already refers to them, and won't delete them until the interpreter exits
p48194
as(dp48195
g16
V100297
p48196
stp48197
a((dp48198
g2
(lp48199
VYou are using boolean logic  and , which short-circuit (return the first operand for which the outcome of the operator is fixed)
p48200
aVYou are looking for the binary bitwise operators instead,  and :
p48201
aVThe  operator returns the first operand if it is true-y (not empty or numeric 0), the second operand otherwise, the  operator returns the first if it is false-y, the second operator otherwise
p48202
aVThis is why you see  return , and  return
p48203
aVBoth  and  are non-zero, so true in a boolean context
p48204
aVUsing  as a false value you'd see:
p48205
as(dp48206
g16
V100297
p48207
stp48208
a((dp48209
g2
(lp48210
VI'd use  with a wrapper generator:
p48211
aVDemo:
p48212
aVThere is no more clever way that I know of; the  engine cannot otherwise combine substitution and matching
p48213
as(dp48214
g16
V100297
p48215
stp48216
a((dp48217
g2
(lp48218
VThe closures are created by the  bytecode, in the same order as their bytecodes are ordered:
p48219
aVso the order is determined at compile time, by ; this function uses the  tuple as a guide, which lists the closures in the same order
p48220
aVis set when creating a code object in , and the tuple is generated from the keys of a python dictionary, so the order is otherwise arbitrary, as common for dictionaries
p48221
aVIf you are curious, the dict is built in , using the  utility function from all the free variables named in the compiler symbol table, itself a python dictionary
p48222
aVSo, the order of the closures is indeed arbitrary (hash table ordered), and you'd use the  tuple to attach names to the closures:
p48223
as(dp48224
g16
V100297
p48225
stp48226
a((dp48227
g2
(lp48228
VUse ; it preserves entries in input order
p48229
aVThe above code reads your  ordered dictionary using one line
p48230
aVHowever, it looks as if you generate the output file purely based on the order of the input file lines:
p48231
aVRework your code to first collect the counts, then use a separate loop to write out your data:
p48232
as(dp48233
g16
V100297
p48234
stp48235
a((dp48236
g2
(lp48237
VIn this case, I'd hand-craft a regular expression to make these into something you can evaluate as Python:
p48238
aVYes, this is limited; but it works for this set and is robust as long as the keys match
p48239
aVThe regular expression is simple to maintain
p48240
aVMoreover, this doesn't use any external dependencies, it's all based on batteries already included
p48241
aVResult:
p48242
as(dp48243
g16
V100297
p48244
stp48245
a((dp48246
g2
(lp48247
VDepending on the format of the file, you either want to use the  module, or use the  function
p48248
aVFor whitespace-separated values on a line, use :
p48249
aVFor other formats, usually the  module is the best option:
p48250
aVTo read only two lines, use  twice; csv version:
p48251
aVtakes the next item from an iterator; both the  object and the  object are iterators that yield file lines or CSV rows
p48252
aVAlternatively, use the  utility:
p48253
as(dp48254
g16
V100297
p48255
stp48256
a((dp48257
g2
(lp48258
VYour  variable is 0
p48259
aVCheck if  is correct ( is misspelled, but the original directory could be similarly misspelled)
p48260
as(dp48261
g16
V100297
p48262
stp48263
a((dp48264
g2
(lp48265
VYou'd have to search through all dictionaries in your list; use  with a generator expression:
p48266
aVThis will short circuit; return  when the first match is found, or return  if none of the dictionaries match
p48267
as(dp48268
g16
V100297
p48269
stp48270
a((dp48271
g2
(lp48272
VYou want to use the excellent RewriteRule Witch to generate your VHM rewriting configurations
p48273
aVFor your settings, the witch recommends you use:
p48274
aVThis differs from yours in that the root is handled better, and the server name is auto-included from the browser headers, ensuring that you always use the correct server name
p48275
aVHowever, your site is serving just the homepage, even a obvious 404 not found response results in the homepage
p48276
aVSomething is rewriting your paths to discard all path information, perhaps before the VHM proxy rewrite rule is executed
p48277
as(dp48278
g16
V100297
p48279
stp48280
a((dp48281
g2
(lp48282
VExceptions have a  attribute which is a tuple; for a  exception that tuple contains the key that triggered the exception:
p48283
as(dp48284
g16
V100297
p48285
stp48286
a((dp48287
g2
(lp48288
VUse  and  as anchors with look-behind and look-ahead assertions:
p48289
aVThe  look-behind assertion only matches at the location in the text that was preceded by
p48290
aVSimilarly,  matches at the location that is followed by
p48291
aVTogether they form two anchors that limit the  expression, which matches anything
p48292
aVYou can find all such anchored pieces of text with :
p48293
aVIf  and  are variable, you want to use  (to prevent any of their content from being interpreted as regular expression syntax) on them and interpolate:
p48294
as(dp48295
g16
V100297
p48296
stp48297
a((dp48298
g2
(lp48299
VTo test for specific bits in a integer value, use the  bitwise operand; no need to convert this to a binary string
p48300
aVThe above code shifts a test bit to the left twice
p48301
aVAlternatively, shift  to the right 3 times:
p48302
aVTo make this generic for any bit position, subtract 1:
p48303
aVor
p48304
aVYour binary formatting code is overly verbose
p48305
aVJust use the  function to create a binary string representation:
p48306
aVformats your binary value to a 0-padded 32-character binary string
p48307
as(dp48308
g16
V100297
p48309
stp48310
a((dp48311
g2
(lp48312
VYou have non-unique labels; you can use a  to generate numbers on first access, combined with a counter:
p48313
aVThis generates a count in order of the labels first occurrence in
p48314
aVDemo:
p48315
aVBecause we are using a dictionary, the label-to-number lookups are constant cost, so the whole operation will take linear time based on the length of the  list
p48316
aVAlternatively, use a  to get unique values, then map these to a  count:
p48317
aVThis assigns numbers more arbitrarily, as  objects are not ordered:
p48318
aVThis requires looping through  twice though
p48319
aVNeither approach requires you to first define a dictionary of labels; the mapping is created automatically
p48320
as(dp48321
g16
V100297
p48322
stp48323
a((dp48324
g2
(lp48325
VJust delete the name that is masking the builtin:
p48326
aVYou can always still access the original built-in through the   namespace; use this if you want to override the built-in but want to defer to the original still from the override:
p48327
as(dp48328
g16
V100297
p48329
stp48330
a((dp48331
g2
(lp48332
V0-pad your input to a multiple of 8, then turn it into a hex value:
p48333
aVThe output is padded as well to give 2 hex characters per full byte
p48334
aVThis gives:
p48335
as(dp48336
g16
V100297
p48337
stp48338
a((dp48339
g2
(lp48340
VNo, function keyword parameter defaults are determined when the function is defined, not when the function is executed
p48341
aVSet the default to  and detect that:
p48342
aVIf you need to be able to specify  as a argument, use a different sentinel value:
p48343
aVNow callers can set  to  and it won't be seen as the default
p48344
as(dp48345
g16
V100297
p48346
stp48347
a((dp48348
g2
(lp48349
VYou are rebinding  to the module:
p48350
aVThe second line replaces the  you imported first
p48351
aVPick one style of importing from this module and stick to it
p48352
aVor use
p48353
as(dp48354
g16
V100297
p48355
stp48356
a((dp48357
g2
(lp48358
VYou can use the  module to run another python interpreter;  gives you a handy starting point:
p48359
aVbut best practice would be to just import ; make sure you structure it to only run 'script-like' code with a  guard, then import the main 'sending' function from  and re-use that:
p48360
aVthen import  and call
p48361
as(dp48362
g16
V100297
p48363
stp48364
a((dp48365
g2
(lp48366
VYou would use a validator to limit what the field accepts
p48367
aVA  would do the trick here:
p48368
aVNote that there already is a  validator that'll validate email addresses for you; the  validator above will not allow for valid email addresses
p48369
as(dp48370
g16
V100297
p48371
stp48372
a((dp48373
g2
(lp48374
VSplit out your key-value pairs into separate dictionaries:
p48375
aVNote that the order of your output will be arbitrary (dictionaries have no fixed ordering)
p48376
aVYou may want to sort the output to produce a predictable list:
p48377
aVThis produces:
p48378
as(dp48379
g16
V100297
p48380
stp48381
a((dp48382
g2
(lp48383
VDon't
p48384
aVCreating dynamic variables is rarely a good idea, and if you are trying to create local names (inside a function), difficult and greatly affects performance
p48385
aVUse a dictionary instead:
p48386
aVNamespaces are just default dictionaries for code to look up names in
p48387
aVIt is a lot easier and cleaner to create more such dictionaries
p48388
aVYou can still access the global (module namespace with the  function, which returns a (writable) dictionary
p48389
aVYou can access the function local namespace with , but writing to this usually has no effect as local namespace access in functions has been optimized
p48390
aVIn Python 2 you can remove that optimisation by using a  statement in the function
p48391
aVIn Python 3, you can no longer switch off the optimisation as the  statement has been replaced by the  function, which means the compiler can no longer detect with certainty that you are potentially writing to the local namespace with it
p48392
as(dp48393
g16
V100297
p48394
stp48395
a((dp48396
g2
(lp48397
VPython uses closures to capture references to the original variable
p48398
aVThe  objects retain a reference to the  name, through which the value can be accessed
p48399
aVThis means that the  variable continues to live on after  completes
p48400
aVYou can introspect this closure in the  tuple on the lambda objects; functions have the same attribute:
p48401
aVThis is also why all lambdas in your list  refer to the value , and not to the numbers 0 through to 4
p48402
aVThey all refer to the same closure:
p48403
aVThe closure refers to the variable, not to the value of that variable at the time the closure was defined
p48404
aVAt the end of the loop  was last set to , so when looking up  in the lambda closure  will be found, for all lambdas in your list
p48405
aVIf you want your lambdas to refer to the value of  during the loop, capture it in a keyword argument:
p48406
aVNow  is a local variable to the lambda, not a closure
p48407
aVAlternatively, create an entirely new scope from which to draw the closure:
p48408
aVNow  is a new scope with it's own local  for the lambda closure to refer to
p48409
aVThe lambdas then each have their own closures:
p48410
aVClosures refer to a variable in a specific namespace; each time you call a function a new local namespace is created, so each closure refers to  in  in a separate namespace from other calls to
p48411
as(dp48412
g16
V100297
p48413
stp48414
a((dp48415
g2
(lp48416
VUse the  boolean operator:
p48417
aVreturns a boolean value ( or ):
p48418
aVIf you must have an integer, cast it back:
p48419
aVHowever, the python  type is a subclass of , so this may not be needed:
p48420
as(dp48421
g16
V100297
p48422
stp48423
a((dp48424
g2
(lp48425
VEach entry in your list is a string, not a list, so  is a single character ( for your first entry)
p48426
aVYou need to split out just the date portion to :
p48427
aVThe  splits on whitespace, once, for efficiency:
p48428
aVResult:
p48429
aVNote that  returns a new sorted list, the original list is not affected
p48430
aVIf you want to sort  in place, call the  method on it:
p48431
as(dp48432
g16
V100297
p48433
stp48434
a((dp48435
g2
(lp48436
VUse  to insert a :
p48437
aVYou can use a default dictionary and a generator to use this with :
p48438
as(dp48439
g16
V100297
p48440
stp48441
a((dp48442
g2
(lp48443
VIt makes  read-only
p48444
aVYou cannot set , there is no setter associated with the property:
p48445
aVYou'd need to add a setter for it to be writable:
p48446
aVNote the  decorator; the property object itself gives you a decorator function to create a new decorator with the setter replaced with the new decorated function
p48447
aVThere is a  equivalent as well
p48448
aVSee the  function documentation for more detail
p48449
as(dp48450
g16
V100297
p48451
stp48452
a((dp48453
g2
(lp48454
VYou have a list after splitting, you can slice that list to get a sublist:
p48455
aVHere  is set to the first element of your split string,  to a list of all elements but the first:
p48456
aVFrom here on out, I'd use SQL parameters to do the actual queries
p48457
aVBuild the filters, then pass in the chain of all split arguments as one long parameter list:
p48458
aVHere  generates suitable SQL with parameter placeholders:
p48459
aVwhich  would fill into your query from the parameters that  provides:
p48460
aVThe  placeholders used here are specific to certain types of database adapter; others may use  instead; check your database adapter documentation
p48461
as(dp48462
g16
V100297
p48463
stp48464
a((dp48465
g2
(lp48466
VTo turn your set of values into a dictionary with ordered 'keys' picked from a sequence, use a  with counter to assign keys:
p48467
aVThis assigns numbers (starting at 1) as keys to the values in your inputlist, on a first-come first-serve basis
p48468
aVDemo:
p48469
as(dp48470
g16
V100297
p48471
stp48472
a((dp48473
g2
(lp48474
VYou are discarding the return value for the recursive call:
p48475
aVYou want to propagate the value of the recursive call too, include a  statement:
p48476
aVNow your code prints:
p48477
as(dp48478
g16
V100297
p48479
stp48480
a((dp48481
g2
(lp48482
VThis means the exception has no message attached
p48483
aVPrint the exception type:
p48484
aVYou may also want to print the traceback:
p48485
aVYou want to avoid catching  however, this is no better than a blanket  statement
p48486
aVCatch more specific exceptions instead
p48487
as(dp48488
g16
V100297
p48489
stp48490
a((dp48491
g2
(lp48492
VYou'll have to update the  mapping; it stores a reference to the function on import, so before you can patch it
p48493
aVuses that mapping, and not the  function directly
p48494
aVYou can use the public  function to re-define the  archiver:
p48495
aVThis replaces the existing callable registered for the  format
p48496
as(dp48497
g16
V100297
p48498
stp48499
a((dp48500
g2
(lp48501
VAccess the module through , reload that, then reassign the imported names:
p48502
aVetc
p48503
aVAll the  syntax does is import  then bind  to the same object  refers to
p48504
aVBy using  you don't have to explicitly import the module again, and can reach the new definitions of the objects for rebinding after reloading
p48505
as(dp48506
g16
V100297
p48507
stp48508
a((dp48509
g2
(lp48510
VThey don't quite do the same thing; the first one does a lot more work:
p48511
aVIt looks up the  and  methods each time in the loop, and then calls them
p48512
aVThis requires a stack push and pop for each call
p48513
aVIt appends each new element to a list one by one
p48514
aVThe Python list has to be grown dynamically to make room for these elements as you do so
p48515
aVThe list comprehension collects all generated elements in a C array before creating the python list object in one operation
p48516
aVThe two functions do produce the same result, one is just needlessly slower
p48517
aVIf you want to go into the nitty gritty details, take a look at the bytecode disassembly using the  module:
p48518
aVThe number of bytecode instructions per iteration is much larger for the explicit for loop
p48519
aVThe  loop has to execute 11 instructions per iteration (if  is True), vs
p48520
aV7 for the list comprehension, where the extra instructions mostly cover  and
p48521
aVIf you want to make the first version faster, replace  with an  test, loop directly over the dictionary and cache the  attribute in a local variable:
p48522
aVThen use the  module to test timings properly (repeated runs, most accurate timer for your platform):
p48523
aVHere  is approaching the list comprehension method in speed, but the latter still can win by building the python list object in one step
p48524
as(dp48525
g16
V100297
p48526
stp48527
a((dp48528
g2
(lp48529
VThe  module imports  with the line:
p48530
aVand does this before you can patch it
p48531
aVYou need to update that reference too:
p48532
as(dp48533
g16
V100297
p48534
stp48535
a((dp48536
g2
(lp48537
VYou reverse the sort:
p48538
aVNow the most recent date is sorted first instead of last
p48539
as(dp48540
g16
V100297
p48541
stp48542
a((dp48543
g2
(lp48544
VYou could use a regular expression:
p48545
aVIf you need the values to be integers, use  to apply the  function to each matched group:
p48546
aVFor your code sample, that gives me:
p48547
as(dp48548
g16
V100297
p48549
stp48550
a((dp48551
g2
(lp48552
VYou would be better off using the  class; it allows you to specify the order of the columns, and pick out only certain keys:
p48553
as(dp48554
g16
V100297
p48555
stp48556
a((dp48557
g2
(lp48558
V is a regular dictionary
p48559
aVJust loop over it:
p48560
aVor retrieve all the keys with:
p48561
aVDo note that you have one special key  in that dictionary
p48562
aVIt may be that your indentation is off, but it appears you are not correctly counting your file entries:
p48563
aVwould only count () words if  had not been seen in the per-word dictionary before; correct that to:
p48564
aVTo expand this to arbitrary words, you loop over the outer :
p48565
as(dp48566
g16
V100297
p48567
stp48568
a((dp48569
g2
(lp48570
VThe last two are not the same
p48571
aVThe first hex sequence is a raw representation of a Python  byte string; it decodes from Latin-1 to:
p48572
aVbut your second value is a unicode string; it uses the Python  unicode codepoint escapes:
p48573
aVSo the Unicode literal value does match what you see in phpmyadmin
p48574
aVThe are the same except for the last 3 characters:
p48575
aVWithout more information it is hard to tell why your MySQL setup is returning  and  instead of the  and  codepoints; I don't directly see the correlation there
p48576
aVYou'll probably need to configure the SQLAlchemy connector to match the encoding used in this MySQL database, setting the  parameter at the database connection level, table level or even column level if need be
p48577
as(dp48578
g16
V100297
p48579
stp48580
a((dp48581
g2
(lp48582
VPython does not merge namespaces without additional help
p48583
aVYou have a  top-level package in one place that is being found before the other top-level  package is found
p48584
aVThat first package found has  as a contained module, but not the  module
p48585
aVYou'll need to use a setuptools namespace setup to enable this behaviour; install your packages with a  compliant  and let it register and manage namespaces for you
p48586
as(dp48587
g16
V100297
p48588
stp48589
a((dp48590
g2
(lp48591
VYou'll need to swap the  and  lines if you want  to check up on whatever  returned:
p48592
aVNow  will wrap whatever method  returned, and you can thus inspect what that method returns
p48593
as(dp48594
g16
V100297
p48595
stp48596
a((dp48597
g2
(lp48598
VYou are trying to call  on the  value, which is an integer
p48599
aVDon't do that
p48600
as(dp48601
g16
V100297
p48602
stp48603
a((dp48604
g2
(lp48605
VYou are trying to run a Python 2 codebase with Python 3
p48606
aVwas renamed to  in Python 3
p48607
aVRun the game with Python 2 instead
p48608
aVDon't try to port it unless you know what you are doing, most likely there will be more problems beyond  vs
p48609
aVFor the record, what you are seeing is not a syntax error but a runtime exception instead
p48610
as(dp48611
g16
V100297
p48612
stp48613
a((dp48614
g2
(lp48615
VYou are looking for the  function instead
p48616
aV(without arguments) returns the current namespace, in a function that is the local namespace, not the module globals
p48617
aVDemo:
p48618
aVHowever, you want to rethink your variables
p48619
aVInvariably, you really want to create a list or dictionary instead:
p48620
aVcreates 11 nested lists, which you access with , , etc
p48621
as(dp48622
g16
V100297
p48623
stp48624
a((dp48625
g2
(lp48626
VYou named your class  with a capital B, but import , lowercase
p48627
aVPython is case sensitive, you'll need to match the class name correctly
p48628
as(dp48629
g16
V100297
p48630
stp48631
a((dp48632
g2
(lp48633
VUse the  method on the datetime object:
p48634
aVAlternatively, turn your  and  objects into strings for their default string representations:
p48635
aVDemo:
p48636
aVThe default string format for  objects includes the microsecond component
p48637
as(dp48638
g16
V100297
p48639
stp48640
a((dp48641
g2
(lp48642
VSave yourself some grief and use a format that is easier to both write and parse
p48643
aVThe  library would save and load data without additional parsing:
p48644
aVBy using  you write out a structure that is quite readable too
p48645
as(dp48646
g16
V100297
p48647
stp48648
a((dp48649
g2
(lp48650
VMostly, yes, as long as you keep to using the tools Python provides you and don't write code that is platform specific
p48651
aVUse  to build paths, for example
p48652
aVOpen files in binary mode when you deal with binary data, text mode when it's text data
p48653
aVEtc
p48654
aVPython code itself is platform agnostic; the interpreter on Linux can read python code written on Windows just fine and vice versa
p48655
aVThe general rule of thumb is to pay attention to the documentation of the modules you are using; any platform specific gotchas should be documented
p48656
as(dp48657
g16
V100297
p48658
stp48659
a((dp48660
g2
(lp48661
VUse a list comprehension:
p48662
aVIf you have to use a for loop, you'd use  to include an index so you can replace the individual items in the list:
p48663
as(dp48664
g16
V100297
p48665
stp48666
a((dp48667
g2
(lp48668
VUse the  function on it:
p48669
aVShort demo:
p48670
as(dp48671
g16
V100297
p48672
stp48673
a((dp48674
g2
(lp48675
V returns an integer, but you discard that result
p48676
aVReassign it:
p48677
aVThe function does not change the variable in-place
p48678
aVIf  is a string as well, you'll need to do the same thing for , or just remove that line
p48679
as(dp48680
g16
V100297
p48681
stp48682
a((dp48683
g2
(lp48684
VYou need to parse the response body, not the response object:
p48685
aVor pass in a file object:
p48686
aVThe latter could fail if the stream is compressed; the raw file object does not decompress this for you
p48687
as(dp48688
g16
V100297
p48689
stp48690
a((dp48691
g2
(lp48692
VYou are using  on Python 2, which already runs  on the input
p48693
aVJust remove the  call, or replace  with
p48694
aVAlternatively, use Python 3 to run this code, it is clearly aimed at that version
p48695
aVIf your book uses this syntax, then you want to use the right version to run the code samples
p48696
aVMost of all, don't use  on Python 2 or  on Python 3
p48697
aVIf you want integer numbers, use  instead
p48698
aVPython 2 example:
p48699
aVPython 3 version:
p48700
as(dp48701
g16
V100297
p48702
stp48703
a((dp48704
g2
(lp48705
VIf  is a string value, you can use the  module to parse out the information, including the year:
p48706
aVThis has the advantage that you can do further tests on the  object, including sorting and date arithmetic
p48707
aVDemo:
p48708
as(dp48709
g16
V100297
p48710
stp48711
a((dp48712
g2
(lp48713
VThe  module does not support the  millisecond formatter because the  tuple doesn't support milliseconds
p48714
aVThe  module does support milliseconds
p48715
aVUse that module instead:
p48716
aVDemo:
p48717
as(dp48718
g16
V100297
p48719
stp48720
a((dp48721
g2
(lp48722
VYou record the start time, then later on calculate the difference between that start time and the current time
p48723
aVDue to platform differences, for precision you want to use the  callable:
p48724
aVThis gives you a wall-clock time duration in seconds as a floating point value
p48725
aVDemo:
p48726
as(dp48727
g16
V100297
p48728
stp48729
a((dp48730
g2
(lp48731
VYou are printing only the last line, because your  statement falls outside of the for loop:
p48732
aVIndent that line to match the previous:
p48733
as(dp48734
g16
V100297
p48735
stp48736
a((dp48737
g2
(lp48738
VYou are using  incorrectly
p48739
aVPass in a list of arguments:
p48740
aVThe argument is not handled by a shell and is not parsed out like a shell would do
p48741
aVThis is a good thing as it prevents a security problem with untrusted command line arguments
p48742
aVYour other options include using  to do the whitespace splitting for you, or, as a last resort, telling  to use a shell for your command with the  flag
p48743
aVSee the big warning on the  documentation about enabling the shell
p48744
as(dp48745
g16
V100297
p48746
stp48747
a((dp48748
g2
(lp48749
VYou need to make a few choices; allow multiple matches, find only the first match, or only allow for at most one match
p48750
aVTo find the first match, use :
p48751
aVThis will raise  if no match was found; return a default instead or catch the exception:
p48752
aVThese versions will only loop over the dictionary items until a match is found, then stop; the full  loop equivalent would be:
p48753
aVNote the  block; it is only called when the  loop was allowed to complete, and was not interrupted by a  statement
p48754
aVTo find all matching keys, use can use a list comprehension:
p48755
aVFinally, to allow for only one match, efficiently, use two  calls on the same iterator, and raise an error if a second match is found:
p48756
aVAdapting that to the  loop approach again, would require you to break only if a second item is found:
p48757
aVYour version doesn't work because you print 'not found' for each and every key that doesn't match
p48758
aVYou can only know that you didn't match a key until the very end when you've iterated over all the keys in your dictionary
p48759
as(dp48760
g16
V100297
p48761
stp48762
a((dp48763
g2
(lp48764
VYou are writing JSON; the JSON standard allows for  escape sequences to encode non-ASCII characters
p48765
aVThe Python  module uses this by default
p48766
aVSwitch off the feature by using the  switch when dumping the data:
p48767
aVThis does mean that the output is no longer encoded to UTF-8 bytes as well; you'll need to use a  managed file for this:
p48768
aVNow your unicode characters will be written to the file as UTF-8 encoded bytes instead
p48769
aVWhen opening the file with another program that decodes UTF-8 again, your codepoints should be displayed again as the same characters
p48770
as(dp48771
g16
V100297
p48772
stp48773
a((dp48774
g2
(lp48775
VYou need to set the attribute directly on the module; that is the global namespace for that module:
p48776
aVYou do have to set globals on a per-module basis
p48777
aVGlobals from one module do no not propagate to other modules on import
p48778
aVYou can add to the  module ( in Python 3):
p48779
aVThese are then visible in all modules:
p48780
aVGenerally speaking, you really want to avoid doing this
p48781
aVFind some other method to solve your problem
p48782
aVImport code instead of relying on globals being set
p48783
as(dp48784
g16
V100297
p48785
stp48786
a((dp48787
g2
(lp48788
VPython is recursively checking each element of the dictionaries to ensure equality
p48789
aVSee the C   implementation, which checks each and every key and value (provided the dictionaries are the same length); if dictionary  has the same key, then a  tests if the values match too; this is essentially a recursive call
p48790
aVDictionaries are not hashable because their  attribute is set to , and most of all they are mutable, which is disallowed when used as a dictionary key
p48791
aVIf you were to use a dictionary as a key, and through an existing reference then change the key, then that key would no longer slot to the same position in the hash table
p48792
aVUsing another, equal dictionary (be it equal to the unchanged dictionary or the changed dictionary) to try and retrieve the value would now no longer work because the wrong slot would be picked, or the key would no longer be equal
p48793
as(dp48794
g16
V100297
p48795
stp48796
a((dp48797
g2
(lp48798
VUse a :
p48799
aVUse  on Python 2 for a little more efficiency
p48800
aVBecause you have a list of dictionaries, we need to pull out the values from each of those dictionaries first; I used  with a generator expression to list all values in a sequence:
p48801
aVThe alternative is to use nested loops in the generator expression:
p48802
as(dp48803
g16
V100297
p48804
stp48805
a((dp48806
g2
(lp48807
VYes, up until 3
p48808
aV1  erroneously would implicitly encode strings to UTF-8 bytes; this was fixed in Python 3
p48809
ag5740
aVSee issue 10783
p48810
aVThe conclusion was that the implicit conversion was a Bad Idea, and it was reverted while the developers still had a chance to do so:
p48811
aVI prefer to break the API today than having to maintain a broken API for
p48812
aV10 or 20 years :-)  And we have a very small user base using Python 3,
p48813
aVit's easier to change it now, than in the next release
p48814
aVThis is also documented in the porting section of the 3
p48815
aV2 What's New guide:
p48816
aVnow only allows bytes for the  string pack code
p48817
aVFormerly, it would accept text arguments and implicitly encode them to bytes using UTF-8
p48818
aVThis was problematic because it made assumptions about the correct encoding and because a variable-length encoding can fail when writing to fixed length segment of a structure
p48819
aVYou need to explicitly encode your strings before packing
p48820
as(dp48821
g16
V100297
p48822
stp48823
a((dp48824
g2
(lp48825
VYou need to specify an encoding to decode the bytes to Unicode with:
p48826
aVIn this case, I was able to guess the encoding from experience, you need to provide the correct codec used for each encoding you encounter
p48827
aVFor web data, that is usually included in the from of the content-type header:
p48828
aVwhere  is the official standard name for the Latin 1 encoding, for example
p48829
aVPython recognizes  as an alias for
p48830
aVNote that your input data is not plain ASCII
p48831
aVIf it was, it'd only use bytes in the range 0 through to 127;  is 163 decimal, so outside of the ASCII range
p48832
as(dp48833
g16
V100297
p48834
stp48835
a((dp48836
g2
(lp48837
VYour syntax is incorrect, you wanted:
p48838
aVinstead to assign multiple values to multiple names
p48839
aVAlternatively, put the two statements on separate lines:
p48840
aVYou cannot combine multiple assignment statements with commas like you tried; that works in JavaScript but not in Python
p48841
as(dp48842
g16
V100297
p48843
stp48844
a((dp48845
g2
(lp48846
VNo, the JSON standard uses unicode throughout (this is a good thing)
p48847
aVThe  library has no options, short of subclassing the decoder, to switch to returning byte strings instead
p48848
aVJust encode the delimiter
p48849
as(dp48850
g16
V100297
p48851
stp48852
a((dp48853
g2
(lp48854
VWhenever you want to build a dictionary based on a filter, use a dict comprehension:
p48855
as(dp48856
g16
V100297
p48857
stp48858
a((dp48859
g2
(lp48860
V returns whatever the user entered
p48861
aVYou are not storing what the function returns; it is discarded instead
p48862
aVStore it in your variable:
p48863
aVYou probably want to turn that into an integer;  returns a string:
p48864
aVYou only need to ask for it once for each try:
p48865
aVAlso see Asking the user for input until they give a valid response
p48866
as(dp48867
g16
V100297
p48868
stp48869
a((dp48870
g2
(lp48871
V will only be evaluated if  is , yes
p48872
aVThe  operator short-circuits if  is falsey
p48873
aVFrom the boolean operators documentation:
p48874
aVThe expression  first evaluates ; if  is false, its value is returned; otherwise,  is evaluated and the resulting value is returned
p48875
aVYou can test this yourself with a function that prints something when called:
p48876
aVPython consideres empty containers and numeric 0 values as false:
p48877
aVCustom classes can implement a  hook to return a boolean flag for the same test, or implement a  hook if they are a container type instead; returning  means the container is empty and is to be considered false
p48878
aVOn a closely related note, the  operator does the same thing, but in reverse
p48879
aVIf the first expression evaluates to true the second expression will not be evaluated:
p48880
as(dp48881
g16
V100297
p48882
stp48883
a((dp48884
g2
(lp48885
VInteger division
p48886
aVevaluates to 1 as it is rounded down
p48887
aVUse  instead to force floating point arithmetic:
p48888
aVor use Python 3, where floating point division is the default, or use  to achieve the same in Python 2:
p48889
aVThis behaviour is documented under the Binary arithmetic operators section:
p48890
aVThe  (division) and  (floor division) operators yield the quotient of their arguments
p48891
aVThe numeric arguments are first converted to a common type
p48892
aVPlain or long integer division yields an integer of the same type; the result is that of mathematical division with the \u2018floor\u2019 function applied to the result
p48893
aVDivision by zero raises the  exception
p48894
aVSee PEP 238 about why this behaviour was changed in Python 3, and for a reference to the  statement
p48895
as(dp48896
g16
V100297
p48897
stp48898
a((dp48899
g2
(lp48900
VUse a conditional expression on the left-hand side of the list comprehension:
p48901
aVThis produces:
p48902
as(dp48903
g16
V100297
p48904
stp48905
a((dp48906
g2
(lp48907
VTo hook into methods being called you'd have to use a decorator:
p48908
aVand apply this to each of the methods in your class:
p48909
aVNote that I renamed the counter to use one underscore, to avoid having to figure out the mangled name
p48910
aVIf you must have  work (so with the double underscore), you could do that by passing in the name of the class:
p48911
aVThen decorate the methods with:
p48912
aVIf you wanted to create a counter per instance instead, simply add to the counter on the class:
p48913
aVor use  if you want to use a separate counter per sub-class of
p48914
as(dp48915
g16
V100297
p48916
stp48917
a((dp48918
g2
(lp48919
VYou don't just have a dictionary
p48920
aVYou have a list with one dictionary in it
p48921
aVUse  to add a second dictionary:
p48922
as(dp48923
g16
V100297
p48924
stp48925
a((dp48926
g2
(lp48927
VAdjust my decorator to decrement the counter again after the call:
p48928
aVThe  block will always be called, even if the method causes an exception to be raised
p48929
as(dp48930
g16
V100297
p48931
stp48932
a((dp48933
g2
(lp48934
V is a local variable in your  function; it is not visible outside of that function
p48935
aVYour function does return the value of ; assign it:
p48936
aVI used a different name here to illustrate that  is a different variable
p48937
as(dp48938
g16
V100297
p48939
stp48940
a((dp48941
g2
(lp48942
V takes any type, as long as they are orderable
p48943
aVThe items must either support the  lower then or the  lower or equal than operator ( will use the latter if the first isn't available)
p48944
aVFor example, you could use tuples (); tuples have a relative order based on their contents, starting with the first item
p48945
aVOr you can use custom objects that implement at least one of , ,  or  to implement comparisons between them and thus define an ordering (and, preferably, include a  equality method too)
p48946
aVThe  decorator would then supply your class with the remaining methods:
p48947
aVwould be an orderable custom class, which  would be happy to handle for you
p48948
as(dp48949
g16
V100297
p48950
stp48951
a((dp48952
g2
(lp48953
VListing names in  does not, by itself, import items into a module
p48954
aVAll it does is list names to import from that module if you used  syntax
p48955
aVImport  into :
p48956
as(dp48957
g16
V100297
p48958
stp48959
a((dp48960
g2
(lp48961
VUse the  attribute of the file object:
p48962
aVThis is the filename of the open fileobject, or  for
p48963
as(dp48964
g16
V100297
p48965
stp48966
a((dp48967
g2
(lp48968
V is a 2-character string:
p48969
aVwould match one or two digits;  matches any character in the range from 0 through to 9; it is the shorthand equivalent of
p48970
aVAlternatively, use two alternatives:
p48971
aVwould allow for 1 digit, or would allow for
p48972
aVNote that it'll still match  because that string starts with
p48973
aVAdd a boundary test if you want to prevent that to match still:
p48974
aVDemo of that last pattern:
p48975
as(dp48976
g16
V100297
p48977
stp48978
a((dp48979
g2
(lp48980
VThe  in-place add operator on a list does the same thing as calling  on
p48981
aVtakes an iterable and adds each and every element to the list
p48982
aVon the other hand, adds a single item to the list
p48983
as(dp48984
g16
V100297
p48985
stp48986
a((dp48987
g2
(lp48988
VUse :
p48989
aVor in a list comprehension:
p48990
as(dp48991
g16
V100297
p48992
stp48993
a((dp48994
g2
(lp48995
VYou are probably importing the file under different names, or running it as both the  file and importing it
p48996
aVWhen Python runs your script (the file named on the command line) it gives it the name , which is a namespace stored under
p48997
aVBut if you then import that same file using an  statement, it'll be run again and the resulting namespace is stored under the module name
p48998
aVThus,  where  includes an  statement or imports other code that then in turn imports  again will result in all the code in  to be run twice
p48999
aVAnother option is that you are importing the module twice under different full names; both as part of a package and as a stand-alone module
p49000
aVThis can happen when both the directory that contains the package and the package itself are listed on your  module search path
p49001
as(dp49002
g16
V100297
p49003
stp49004
a((dp49005
g2
(lp49006
VGenerate a list, shuffle that and pop from it each time the function is called:
p49007
aVNote that this re-generates the  list once you've run out, but then you've used up all 8999 possible numbers and would have to accept repetitions anyway
p49008
as(dp49009
g16
V100297
p49010
stp49011
a((dp49012
g2
(lp49013
VYou want to apply the dictionary as keyword arguments:
p49014
aVor change your  class to receive one argument:
p49015
as(dp49016
g16
V100297
p49017
stp49018
a((dp49019
g2
(lp49020
VYes, assign it directly to your class:
p49021
aVAny attribute on the class is shared between instances, unless you assign the same attribute name to the instance (which masks the class attribute)
p49022
aVYou can change that value by assigning directly to the class attribute, either via  or by referencing the class name directly
p49023
aVBy using  subclasses can refer to their own class at all times
p49024
as(dp49025
g16
V100297
p49026
stp49027
a((dp49028
g2
(lp49029
VYou can alter python classes after the fact:
p49030
aVNow you've added a property  to your class, as well as add a  attribute
p49031
aVYou may need to override any existing methods on the class that assume they can assign to , of course
p49032
aVThe process of dynamically adding or replacing attributes of objects is often referred to as Monkey Patching
p49033
as(dp49034
g16
V100297
p49035
stp49036
a((dp49037
g2
(lp49038
VSimply loop over your list:
p49039
aVwill be assigned each button from your list in turn letting you call the  method on it
p49040
as(dp49041
g16
V100297
p49042
stp49043
a((dp49044
g2
(lp49045
VYou need to place the exclamation mark right after the opening  for bottle to recognize it:
p49046
aVPreferably, you want to omit the spaces there altogether, to be on the safe side:
p49047
as(dp49048
g16
V100297
p49049
stp49050
a((dp49051
g2
(lp49052
VUse a list comprehension:
p49053
aVDemo:
p49054
aVAlternatively, you can use , which works just like  but will split the data on any newline character combination, be that ,  or
p49055
aVIt handles the last line a little smarter too
p49056
aVIf this data comes from a file, consider using the right tools though; the  module can handle the intricacies of quoting on comma-separated data much better:
p49057
aVThe data doesn't have to come from a file,  can handle any iterable, including the result of :
p49058
as(dp49059
g16
V100297
p49060
stp49061
a((dp49062
g2
(lp49063
VThe  value for the current script is the exact same path you passed to Python;  is thus a relative path and doesn't include the directory name
p49064
aVYou do need to make it an absolute path, but you do not need to use :
p49065
aVDemo:
p49066
aVIn PHP, you have the luxury of the web server executing your files with fully specified absolute paths, so you never saw this 'problem' crop up there
p49067
as(dp49068
g16
V100297
p49069
stp49070
a((dp49071
g2
(lp49072
VFirst of all, why not import the other script, and call a function from it to return you the data
p49073
aVThat would return you a full python object instead of having to handle strings
p49074
aVIf you do want to pass structures around, I'd use the  module to serialize and deserialize the list of dictionaries:
p49075
aVand
p49076
aVThat'd make the output of your other script useful to more tools beyond Python
p49077
as(dp49078
g16
V100297
p49079
stp49080
a((dp49081
g2
(lp49082
VYou have a namespaced XML file
p49083
aVElementTree is not too smart about namespaces
p49084
aVYou need to give the ,  and  methods an explicit namespace dictionary
p49085
aVThis is not documented very well:
p49086
aVThis uses a simple XPath query; '
p49087
aV//' means find any child tag,  limits the search to the  tags in the namespace labeled with the  prefix (from the  mapping) and  limits the search to elements that have a  attribute
p49088
aVDemo:
p49089
aVYou can use this information to search for the specific rate too; either build a dictionary, or search the XML document directly for matching currencies:
p49090
as(dp49091
g16
V100297
p49092
stp49093
a((dp49094
g2
(lp49095
VTo pick one post at random, you still have to loop through all of them and collect them in a list:
p49096
aVThis code collects all posts (title, image url, source url) into a list, then use  to pick a random entry from that list
p49097
as(dp49098
g16
V100297
p49099
stp49100
a((dp49101
g2
(lp49102
VYou have  configured to display raw characters as ASCII character combinations representing these non-printable characters; the  or  command line switch does this:
p49103
aVCauses "raw" control characters to be displayed
p49104
aVThe default is to display control characters using the caret  notation; for example, a control-A (octal 001) is displayed as "^A"
p49105
aVWarning: when the -r option is used, less cannot keep track of the actual appearance of the screen (since this depends  on  how  the screen  responds to each type of control character)
p49106
aVThus, various display problems may result, such as long lines being split in the wrong place
p49107
aVThis is a special  feature
p49108
aVIf you want to do the same with your Python program, you'll need to make the same translation yourself
p49109
aVCreate a mapping turning 'special' characters into escape codes:
p49110
as(dp49111
g16
V100297
p49112
stp49113
a((dp49114
g2
(lp49115
VThe  route only accepts GET requests:
p49116
aVThere is no POST route for that endpoint, so you'll get a 404 for that
p49117
aVAlso, if you need to pass  to the server, do so in the data passed in the POST request; setting  does not then pass that parameter to the server
p49118
aVYou retrieve the modhash from your  GET response:
p49119
aVNote how the response from  has a  method, there is no need to use the  module yourself
p49120
aVYou then use the  in POST request data:
p49121
as(dp49122
g16
V100297
p49123
stp49124
a((dp49125
g2
(lp49126
VSet  to  to skip any whitespace following a delimiter:
p49127
aVWhen , whitespace immediately following the delimiter is ignored
p49128
aVThe default is
p49129
aVDemo:
p49130
as(dp49131
g16
V100297
p49132
stp49133
a((dp49134
g2
(lp49135
VYou are parsing XML; the XML API hands you  values
p49136
aVYou are then attempting to write the unicode data to a CSV file without encoding it first
p49137
aVPython then attempts to encode it for you but fails
p49138
aVYou can see this in your traceback, it is the  call that fails, and the error tells you that encoding is failing, and not decoding (parsing the XML)
p49139
aVYou need to choose an encoding, then encode your data before writing:
p49140
aVI used the UTF8 encoding because it can handle any Unicode code point, but you need to make your own, explicit choice
p49141
as(dp49142
g16
V100297
p49143
stp49144
a((dp49145
g2
(lp49146
VNo,  just means 'upload this file', which can be used with FTP but is not limited to that
p49147
aVYou can just upload the file data as the  parameter:
p49148
aVwhere  will read and upload the image data for you
p49149
as(dp49150
g16
V100297
p49151
stp49152
a((dp49153
g2
(lp49154
VDon't mix using the file object as an iterator, and calling  on the object
p49155
aVBy using  on  you are treating the object as an iterator, calling  under the hood
p49156
aVFrom the  documentation:
p49157
aVIn order to make a for loop the most efficient way of looping over the lines of a file (a very common operation), the  method uses a hidden read-ahead buffer
p49158
aVAs a consequence of using a read-ahead buffer, combining  with other file methods (like ) does not work right
p49159
aVThe solution is to not use  or not to use the file object as iterator
p49160
aVIn this case, use  instead of  to consistently use the object as an iterator
p49161
aVThat is more efficient than using  in any case:
p49162
aVor even:
p49163
as(dp49164
g16
V100297
p49165
stp49166
a((dp49167
g2
(lp49168
VThat is not the code you ran; you did this instead:
p49169
aVNote that the  function is not being called
p49170
aVWhat you are seeing is the string representation of a method object
p49171
aVYour code otherwise is perfectly correct, it is just not the code that ran when you saw that error:
p49172
as(dp49173
g16
V100297
p49174
stp49175
a((dp49176
g2
(lp49177
VYou really should use a proper test runner (such as  or )
p49178
aVIn your specific case, I'd use  instead:
p49179
aVNote that I removed  from your argument parser, so the  option becomes hidden, but it will no longer interfere with
p49180
aVI also pass the remaining arguments on to
p49181
as(dp49182
g16
V100297
p49183
stp49184
a((dp49185
g2
(lp49186
VYou can work it out easily by replacing the calculations with the actual values:
p49187
aVIn the first call, you are indexing:
p49188
aVCounting from 0, that's the last row, , first element,
p49189
aVThe second call evaluates to:
p49190
aVso first cell of the second-last row,  is a
p49191
aVNote that in Python, you can use negative indices without calculating the  first; remove the  from your function and it'll all work just the same:
p49192
aVThat is because Python treats negative indices as counting from the end; internally it'll use the length of the sequence (which is stored with the sequence) to calculate just the same thing but faster
p49193
as(dp49194
g16
V100297
p49195
stp49196
a((dp49197
g2
(lp49198
VYes, use the  function on the iterator:
p49199
aVNote that this can raise  if the file has no more lines
p49200
aVYou can tell  to return a default value instead:
p49201
aVwhich will be returned instead of raising the exception
p49202
as(dp49203
g16
V100297
p49204
stp49205
a((dp49206
g2
(lp49207
VYour filter call can be turned into a string:
p49208
aVYou can then use that to ask for a MySQL explanation:
p49209
aVYou may have to include any bound parameters the filters added to your query as a dictionary:
p49210
as(dp49211
g16
V100297
p49212
stp49213
a((dp49214
g2
(lp49215
VYou'll have to sort then filter, as well as parse all the dates in your structure:
p49216
aVDemo:
p49217
aVThe alternative is to filter all dates that come after and is closest to your search date:
p49218
aVDemo:
p49219
aVYou really want to rethink your structure, and use something like a heap queue or btree to keep your data structure more accessible for this kind of access
p49220
aVEven a sorted list with parsed  tuples  would perform much better, as the  module would let you find your 'next' value in O(log n) time as opposed to O(n log n) for sorting or O(n) for the complex  filter
p49221
aVYou can quickly turn your structure into such a list with:
p49222
aVthen find your next match with:
p49223
aVand you use  to keep the list sorted
p49224
as(dp49225
g16
V100297
p49226
stp49227
a((dp49228
g2
(lp49229
VNo, there is only one way of commenting, using :
p49230
aVA comment starts with a hash character (#) that is not part of a string literal, and ends at the end of the physical line
p49231
aVTriple quoting, , creates a string object, which happens to be used as the docstring when it is the first line of a function, module or a a class
p49232
aVTriple quoting is useful in many other places too, but should not be confused with commenting
p49233
aVYou can use a triple quoted string like any other string literal, with the specific benefit that you can use actual newlines in your source code instead of having to use  escape characters
p49234
aVAlthough it can be used to disable a block of code by turning it into a multi-line string instead, you really should not do this
p49235
aVUse proper source code control and simply delete the block, or use an editor that lets you comment out whole blocks by inserting  for you instead
p49236
aVFor actual comments, use
p49237
aVThe Python style guide (PEP 8) has some things to say about when and how to use commenting; it has this to say about indentation:
p49238
aVBlock comments generally apply to some (or all) code that follows them, and are indented to the same level as that code
p49239
aVEach line of a block comment starts with a # and a single space (unless it is indented text inside the comment)
p49240
as(dp49241
g16
V100297
p49242
stp49243
a((dp49244
g2
(lp49245
VDistribute has indeed been deprecated by the new  version 0
p49246
ag4892
aVx series
p49247
aVInstall the latest  version 0
p49248
ag4892
aV4:
p49249
aVAs of the 0
p49250
aV7 release the Distribute project was merged back into the setuptools library:
p49251
ag2391
ag4892
aVMerged Setuptools and Distribute
p49252
aVSee docs/merge
p49253
aVtxt for details
p49254
aVSee the indicated merge
p49255
aVtxt document online
p49256
as(dp49257
g16
V100297
p49258
stp49259
a((dp49260
g2
(lp49261
VThe first creates a naive  object without a timezone, the second attaches a timezone object, making that object timezone aware
p49262
aVBoth objects will give you the date and time according to UTC
p49263
aVQuoting from the  module documentation:
p49264
aVAn aware object has sufficient knowledge of applicable algorithmic and political time adjustments, such as time zone and daylight saving time information, to locate itself relative to other aware objects
p49265
aVAn aware object is used to represent a specific moment in time that is not open to interpretation [1]
p49266
aVA naive object does not contain enough information to unambiguously locate itself relative to other date/time objects
p49267
aVWhether a naive object represents Coordinated Universal Time (UTC), local time, or time in some other timezone is purely up to the program, just like it\u2019s up to the program whether a particular number represents metres, miles, or mass
p49268
aVNaive objects are easy to understand and to work with, at the cost of ignoring some aspects of reality
p49269
aVNaive and aware objects are not comparable, nor can you perform datetime arithmetic between a naive and an aware datetime object
p49270
aVMany operations on  objects differ between the two types; I recommend you search for 'naive' in the documentation
p49271
aVWhere operations differ it is due to the extra timezone information present; for example,  will return the same value as  but with DST forced off for naive objects, but for an aware object the returned tuple represents UTC time whatever the timezone attached to the object was
p49272
as(dp49273
g16
V100297
p49274
stp49275
a((dp49276
g2
(lp49277
VI'd use  instead to make it clear we are calculating dates here, and use  to get the current weekday instead of using the  call, giving us a 0-based weekday number (0 is Monday)
p49278
aVDemo:
p49279
aVOn python 2 you can replace  with  if you like; for a 7-day value that won't make much difference
p49280
aVJust to make it explicit;  exists as well, and there is a  too, so there is no need to use  anywhere
p49281
as(dp49282
g16
V100297
p49283
stp49284
a((dp49285
g2
(lp49286
VList all names in the directory instead, so you can do a case-sensitive match:
p49287
aVDemo:
p49288
as(dp49289
g16
V100297
p49290
stp49291
a((dp49292
g2
(lp49293
VYou are looking for  instead
p49294
aVIt is listed in your exploratory output for :
p49295
aVAlmost members have that attribute; the only exception is the  string:
p49296
aVFor  the predicate cannot access the attribute name; the predicate only has access to the value, not the attribute name under which it is stored, and strings never have name of their own
p49297
as(dp49298
g16
V100297
p49299
stp49300
a((dp49301
g2
(lp49302
VYou need to return the recursive call value too:
p49303
aVWithout the  you ignore, discard, the recursive search return value
p49304
aVDemo with the  added:
p49305
as(dp49306
g16
V100297
p49307
stp49308
a((dp49309
g2
(lp49310
VYou can't, not with
p49311
aVOnce  is being called, the instance is already created
p49312
aVYou want a factory function instead:
p49313
aVFrom an API point of view, there is no difference;  is a callable that produces either an  or a  instance
p49314
aVThe other possible route involves defining a  function instead; this is the class constructor:
p49315
aVWhich is just a more involved factory function, really
p49316
aVNote that the  method returns the result of  of one of the subclasses based on , so both  and  will be passed a  parameter, wether they want one or not
p49317
aVThe  line is needed to allow instantiating  or  directly; you can omit that line if that is not a requirement and only the  factory class is used
p49318
as(dp49319
g16
V100297
p49320
stp49321
a((dp49322
g2
(lp49323
VDon't use a regular expression; just use :
p49324
aVperforms better than a regular expression and is simpler to boot:
p49325
as(dp49326
g16
V100297
p49327
stp49328
a((dp49329
g2
(lp49330
VYou are generating one number then printing that out several times
p49331
aVGenerate several numbers instead:
p49332
aVor generate a list:
p49333
aVor better still, generate all permissible numbers (using  then pick a sample from that:
p49334
aVNow  is guaranteed to consist of entirely unique numbers
p49335
aVThe  variable does not magically update every time you print it because it refers only to the result of
p49336
as(dp49337
g16
V100297
p49338
stp49339
a((dp49340
g2
(lp49341
VYou need to return a callable object instead
p49342
aVThe XML-RPC proxy returns an instance of an object that is callable, but can also be traversed over
p49343
aVSo for , you are wrapping  in a function; that function object does not have a  attribute because functions generally don't have such attributes
p49344
aVReturn a proxy object instead; the  hook makes it a callable object, just like a function would be:
p49345
aVor, merged into one object:
p49346
as(dp49347
g16
V100297
p49348
stp49349
a((dp49350
g2
(lp49351
VYou can make it a class method:
p49352
aVThis has the added advantage that subclasses can simply inherit it, or override it to adjust what the method does (including calling the original parent implementation)
p49353
aVIt provides an alternative class factory:
p49354
aVneatly grouping this factory with the class itself
p49355
as(dp49356
g16
V100297
p49357
stp49358
a((dp49359
g2
(lp49360
VUse :
p49361
aVReplace  escapes by their single-character equivalent
p49362
aVIt looks as if you have a double or ever triple encoded URL; the  part has been encoded to  which decodes to  which in turn becomes
p49363
aVThe URL itself may contain another stage of encoding but you didn't share enough of the actual URL with us to determine that
p49364
as(dp49365
g16
V100297
p49366
stp49367
a((dp49368
g2
(lp49369
VOther answers tell you why  skips items as you alter the list
p49370
aVThis answer tells you how you should remove characters in a string without an explicit loop, instead
p49371
aVUse :
p49372
aVThis deletes all characters listed in the second argument
p49373
aVDemo:
p49374
aVIn Python 3, the  method (Python 2: ) differs in that it doesn't take a deletechars parameter; the first argument is a dictionary mapping Unicode ordinals (integer values) to new values instead
p49375
aVUse  for any character that needs to be deleted:
p49376
as(dp49377
g16
V100297
p49378
stp49379
a((dp49380
g2
(lp49381
V is a metacharacter, it matches only at the start of a string
p49382
aVEscape it:
p49383
aVThere is no need to use a  in your expression, especially not when both 'alternate' strings are the same
p49384
aVIt appears however that you have the  or  control character, not the two-character  string
p49385
aVJust use  to split on that value, no need for a regular expression:
p49386
as(dp49387
g16
V100297
p49388
stp49389
a((dp49390
g2
(lp49391
VYou use a list comprehension:
p49392
aVThe  part is called a conditional expression
p49393
aVThis replaces the list with a new list
p49394
aVIf you have multiple references to the same list, you can replace the elements of the list instead with a slice assignment:
p49395
aVNow all elements in  will be replaced with all the elements produced by the list comprehension
p49396
aVThe difference between the two expressions is subtle but crucial; the first rebinds  to point to a new list, the second retains that list but only replaces the elements contained in the list itself
p49397
as(dp49398
g16
V100297
p49399
stp49400
a((dp49401
g2
(lp49402
VFrom the  documentation:
p49403
aVThis is equivalent to
p49404
aVFor older Python versions (e
p49405
ag1298
ag5740
aV3 or 2
p49406
aV4), use just that:
p49407
aVDemo:
p49408
as(dp49409
g16
V100297
p49410
stp49411
a((dp49412
g2
(lp49413
VYou are looking at the string representation, which is itself a valid Python string literal
p49414
aVThe  is itself just one slash, but displayed as an escaped character to make the value a valid Python literal string
p49415
aVYou can copy and paste that string back into Python and it'll produce the same value
p49416
aVUse  to see the actual value being displayed, or test for the length of the resulting value:
p49417
as(dp49418
g16
V100297
p49419
stp49420
a((dp49421
g2
(lp49422
VObjects that are no longer referenced are indeed garbage collected (they are deleted automatically when their reference count drops to 0)
p49423
aVA module global, however, will never have it's reference count drop to 0; once imported a module object (its namespace), lives in the  mapping
p49424
aVThe namespace itself refers to your object
p49425
aVIn other words, your object lives on forever, until you either delete it from the module namespace, delete the module namespace itself () or your python script exits
p49426
as(dp49427
g16
V100297
p49428
stp49429
a((dp49430
g2
(lp49431
VPickle data is opaque, binary data, even when you use protocol version 0:
p49432
aVWhen you try to store that in a , Django will try to decode that data to UTF8 to store it; this is what fails because this is not UTF-8 encoded data; it is binary data instead:
p49433
aVThe solution is to not try to store this in a
p49434
aVUse a  instead:
p49435
aVA field to store raw binary data
p49436
aVIt only supports  assignment
p49437
aVBe aware that this field has limited functionality
p49438
aVFor example, it is not possible to filter a queryset on a BinaryField value
p49439
aVYou have a  value (Python 2 strings are byte strings, renamed to  in Python 3)
p49440
aVIf you insist on storing the data in a text field, explicitly decode it as ; the Latin 1 codec maps bytes one-on-one to Unicode codepoints:
p49441
aVand make sure you encode it again before unpickling again:
p49442
aVDo note that if you let this value go to the browser and back again in a text field, the browser is likely to have replaced characters in that data
p49443
aVInternet Explorer will replace  characters with , for example, because it assumes it is dealing with text
p49444
aVNot that you ever should allow accepting pickle data from a network connection in any case, because that is a security hole waiting for exploitation
p49445
as(dp49446
g16
V100297
p49447
stp49448
a((dp49449
g2
(lp49450
VYes, it is legal to do so
p49451
aVNo, it is not bad practice
p49452
aVJust take into account that the right-hand side, the value expression, is evaluated first, and assignment then takes place from left to right;  is assigned to  first, then to
p49453
aVFrom the assignment statement documentation:
p49454
aVAn assignment statement evaluates the expression list (remember that this can be a single expression or a comma-separated list, the latter yielding a tuple) and assigns the single resulting object to each of the target lists, from left to right
p49455
aVYou assign the same value to all targets
p49456
aVThat means that each variable refers to one value only
p49457
aVThis is important when that value is mutable, like a list or a dictionary
p49458
as(dp49459
g16
V100297
p49460
stp49461
a((dp49462
g2
(lp49463
VYou are assigning the same list to , not a copy
p49464
aVIf you wanted  to refer to a copy of the list, create one using either  or a full slice:
p49465
aVor
p49466
aVYou can test this easily from the interactive interpreter:
p49467
as(dp49468
g16
V100297
p49469
stp49470
a((dp49471
g2
(lp49472
VYou are passing in a list of arguments, but set
p49473
aVSwitch off the latter (remove the argument,  is the default) and let Python handle the command:
p49474
aVNote that it'll be vastly simpler to install the  library and do the whole task from Python with minimal fuss:
p49475
as(dp49476
g16
V100297
p49477
stp49478
a((dp49479
g2
(lp49480
VPython decodes all file data to Unicode values
p49481
aVYou didn't specify an encoding to use, so Python uses the default for your system, the  Windows Latin codepage
p49482
aVHowever, that is the wrong encoding for your file data
p49483
aVYou need to specify an explicit codec to use:
p49484
aVWhat encoding to use exactly, is unfortunately something you need to figure out yourself
p49485
aVI used UTF-8 as an example codec
p49486
aVBe aware that some versions of RoboCopy have problems producing valid output
p49487
aVIf you don't yet know what Unicode is, or want to know about encodings, see:
p49488
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p49489
aVby Joel Spolsky
p49490
aVThe Python Unicode HOWTO
p49491
aVPragmatic Unicode by Ned Batchelder
p49492
aVThe reason you see the error crop up for different parts of your file is that your data contains more than one codepoint that the cp1252 encoding cannot handle
p49493
as(dp49494
g16
V100297
p49495
stp49496
a((dp49497
g2
(lp49498
VGenerally speaking, you can't
p49499
aVA decorator is just syntactic sugar for applying a callable
p49500
aVIn your case the decorator syntax translates to:
p49501
aVThat is,  is replaced by whatever  returns
p49502
aVWhat it returns could be anything
p49503
aVNow, if what  returns has itself been decorated with  and you are using Python 3
p49504
aV2 or newer, then you can see if there is a  attribute on the new  method; it's a reference to the original wrapped function
p49505
aVOn earlier versions of Python, you can easily do this yourself too:
p49506
aVYou can add any number of attributes to that wrapper function, including custom attributes of your own choosing:
p49507
aVand then test for that attribute:
p49508
aVOne last thing you can do is test for that wrapper function; it'll have a  attribute that you can test against
p49509
aVThat name might not be unique, but it is a start
p49510
aVIn the above sample decorator, the wrapper function is called , so  will be True
p49511
as(dp49512
g16
V100297
p49513
stp49514
a((dp49515
g2
(lp49516
VYou'll have to make this separate  blocks:
p49517
aVThis assumes you want to run  only if  failed
p49518
aVIf you need to run  regardless, you need to put the  blocks one after the other:
p49519
aVI'm using  here because it is never a good practice to blindly ignore all exceptions
p49520
aVYou'll be ignoring ,  and  as well otherwise, which you normally do not want to ignore or intercept without some kind of re-raise or conscious reason for handling those
p49521
as(dp49522
g16
V100297
p49523
stp49524
a((dp49525
g2
(lp49526
VJPEG is a lossy format
p49527
aVOn save, your pixel data is compressed with an algorithm that does not preserve precise pixel information
p49528
aVWhen reading and decompressing that data, there is no guarantee that specific pixels will still have the exact same colour value
p49529
aVis close enough, as far as the JPEG compression is concerned
p49530
aVUse a different format that preserves pixel data exactly like PNG, if this is important to your application
p49531
as(dp49532
g16
V100297
p49533
stp49534
a((dp49535
g2
(lp49536
VWhatever you pass to the  function has to be executed first
p49537
aVHow else would Python know what to pass to the  function
p49538
aVGenerally speaking, in order for Python to call a function, you need to first determine what values you are passing into that function
p49539
aVSee the Calls expression documentation:
p49540
aVAll argument expressions are evaluated before the call is attempted
p49541
aVCalling  you are passing in a string (), and the result of calling
p49542
aVPython has to execute those sub-expressions first before it can call
p49543
aVIn this specific case, just use  as the  prompt:
p49544
aVand don't bother with
p49545
aVIf you did want to print  on a separate line first, call  with just that string, then on a separate line, call :
p49546
aVNote that  returns whatever string the user entered, you want to store that somewhere
p49547
aVIn my examples,  is that 'somewhere'
p49548
as(dp49549
g16
V100297
p49550
stp49551
a((dp49552
g2
(lp49553
VYou have an error in your format; it's not  but :
p49554
aVThe corrected format works just fine:
p49555
as(dp49556
g16
V100297
p49557
stp49558
a((dp49559
g2
(lp49560
VYou'd use a dispatch sequence:
p49561
aVor if the list of functions and limits is large, use a  search to find the closest limit
p49562
as(dp49563
g16
V100297
p49564
stp49565
a((dp49566
g2
(lp49567
VPython keeps an internal cache for compiled regular expressions
p49568
aVWhenever you use one of the top-level functions that takes a regular expression, Python first compiles that expression, and the result of that compilation is cached
p49569
aVGuess how many items the cache can hold
p49570
aVThe moment you exceed the cache size, Python 2 clears all cached expressions and starts with a clean cache
p49571
aVPython 3 increased the limit to 512 but still does a full clear
p49572
aVThe work-around is for you to cache the compilation yourself:
p49573
aVYou could use  to bundle the  call together with the replacement expression:
p49574
aVthen later on use  to use the compiled regular expression pattern together with a specific replacement pattern
p49575
as(dp49576
g16
V100297
p49577
stp49578
a((dp49579
g2
(lp49580
VIf your  attribute is a string, your test will fail
p49581
aVAlso note that  has been deprecated in Python, use  instead to test inequality
p49582
aVYour template, simplified and with calling  on the value first to ensure that it is numeric, then becomes:
p49583
as(dp49584
g16
V100297
p49585
stp49586
a((dp49587
g2
(lp49588
V takes keyword arguments, not a dictionary:
p49589
aVOf course, you can use the  call convention to have your dictionary be applied as keyword arguments still:
p49590
aVWether or not you pack the rest of the arguments into the keyword arguments depends entirely on the original method on ; does it accept those arguments as keyword arguments
p49591
aVIn Python 3 that is not necessarily a given, nor do built-in (C defined) functions and methods always accept keyword arguments instead of positional arguments
p49592
as(dp49593
g16
V100297
p49594
stp49595
a((dp49596
g2
(lp49597
VFor the default type,  is a C-function call, which means that it is executed with one bytecode evaluation
p49598
aVThis makes that call atomic
p49599
aVPython threads switch only when the bytecode evaluation loop lets them, so at bytecode boundaries
p49600
aVSome Python C functions do call back into Python code (think  special method hooks), but the  method does not, at least not for the default  type
p49601
as(dp49602
g16
V100297
p49603
stp49604
a((dp49605
g2
(lp49606
VUse :
p49607
aVDemo:
p49608
as(dp49609
g16
V100297
p49610
stp49611
a((dp49612
g2
(lp49613
VThe  function returns a special descriptor object:
p49614
aVIt is this object that has extra methods:
p49615
aVThese act as decorators too
p49616
aVThey return a new property object:
p49617
aVthat is a copy of the old object, but with one of the functions replaced
p49618
aVRemember, that the  syntax is just syntactic sugar; the syntax:
p49619
aVreally means the same thing as
p49620
aVso  the function is replaced by , which we saw above is a special object
p49621
aVThen when you use , what you are doing is call that  method I showed you above, which returns a copy of the same property, but with the setter function replaced with the decorated method
p49622
aVThe following sequence also creates a full-on property, by using those decorator methods
p49623
aVFirst we create some functions and a  object with just a getter:
p49624
aVNext we use the  method to add a setter:
p49625
aVLast we add a deleter with the  method:
p49626
aVLast but not least, the  object act as a descriptor object, so it has ,  and  methods to hook into instance attribute getting, setting and deleting:
p49627
aVThe Descriptor Howto includes a pure python sample implementation of the  type:
p49628
as(dp49629
g16
V100297
p49630
stp49631
a((dp49632
g2
(lp49633
VDecorators are applied when you define the class
p49634
aVWhen defining a class, you are not running a method and thus  is not defined
p49635
aVThere is no instance for  to refer to
p49636
aVYou'd have to use a metaclass instead, that adds the decorator when building the subclass, or you'd have to use a class decorator, that applies the right decorator after the class has been defined
p49637
aVThe class decorator could be:
p49638
aVthen apply this to the subclasses:
p49639
as(dp49640
g16
V100297
p49641
stp49642
a((dp49643
g2
(lp49644
VYour code is perfectly fine
p49645
aVYou don't have to have an  method
p49646
aVYou can still use , even with an ABC
p49647
aVAll that the ABC meta tests for is if the names have been defined
p49648
aVSetting  in an  does requires that you define a class attribute, but you can set that to  at first:
p49649
aVNow you can set constraints on the ABC requiring that a  abstract property be available; the  class attribute will satisfy that constraint
p49650
as(dp49651
g16
V100297
p49652
stp49653
a((dp49654
g2
(lp49655
VYou did not call the  method
p49656
aVAdd :
p49657
aVNote that a file object such as  can work as an iterator
p49658
aVThere is no need to call ; just loop over  directly
p49659
aVYour code still needs adjustment; both  and  give you a sequence of lines:
p49660
aVIn your version,  was assigned a whole line from the file at a time, and since each line contains at least a newline,  would always be False
p49661
as(dp49662
g16
V100297
p49663
stp49664
a((dp49665
g2
(lp49666
VWhen you access , you invoke the  object as a descriptor, which means it is already bound to the  class
p49667
aVUnwrap it again:
p49668
aVThe  attribute gives you access to the original function, so you can rewrap it with a new  call
p49669
aVAlternatively, use the  mapping to get the actual classmethod itself, bypassing the descriptor calls:
p49670
as(dp49671
g16
V100297
p49672
stp49673
a((dp49674
g2
(lp49675
VYou read the file already
p49676
aVThe file pointer is now at the end and you won't read any more data
p49677
aVStore the file data once:
p49678
aVAlternatively, seek back to the start:
p49679
aVor reopen the file
p49680
as(dp49681
g16
V100297
p49682
stp49683
a((dp49684
g2
(lp49685
VUsing an instance of :
p49686
as(dp49687
g16
V100297
p49688
stp49689
a((dp49690
g2
(lp49691
V in  is not a global
p49692
aVIt is a scoped variable
p49693
aVYou'll need to use Python 3 before you can make that work in this way; you are looking for the  statement added to Python 3
p49694
aVIn Python 2, you can work around this limitation by using a mutable (such as a list) for  instead:
p49695
aVNow you are no longer altering the  name itself; it remains unchanged, it keeps referring to the same list
p49696
aVAll you are doing is altering the first element contained in the  list
p49697
aVAn alternative 'spelling' would be to make  a function attribute:
p49698
aVNow  is no longer local to ; it has become an attribute on the unchanging  function instead
p49699
aVFor your specific problem, you are actually overthinking things
p49700
aVJust have the recursion do the summing:
p49701
aVDemo:
p49702
as(dp49703
g16
V100297
p49704
stp49705
a((dp49706
g2
(lp49707
VYou want to take an iterative approach, really
p49708
aVYour code can be replaced with a list comprehension:
p49709
aVor, shorter and only taking one  call by taking advantage of comparison chaining:
p49710
aVbut that'll only be marginally faster
p49711
aVIf you need to loop over  later, don't use an intermediary list
p49712
aVLoop and filter over  directly
p49713
aVPerhaps even  itself can be replaced by a generator, and filtering that generator can be done iteratively too
p49714
aVNow you no longer have a list of 1 million items
p49715
aVYou have a generator that will produce 1 million items as needed without holding it all in memory
p49716
as(dp49717
g16
V100297
p49718
stp49719
a((dp49720
g2
(lp49721
VYou have a unicode string and a byte string
p49722
aVThey are not the same thing
p49723
aVOne holds a Unicode value,
p49724
aVThe other holds a UTF-8 encoded series of bytes,
p49725
aVPython 2 does do an implicit conversion when comparing Unicode and byte string values, but you should not count on that conversion, and it depends entirely on the default codec set for your system
p49726
aVIf you don't yet know what Unicode really is, or why UTF-8 is not the same thing, or want to know anything else about encodings, see:
p49727
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p49728
aVby Joel Spolsky
p49729
aVThe Python Unicode HOWTO
p49730
aVPragmatic Unicode by Ned Batchelder
p49731
as(dp49732
g16
V100297
p49733
stp49734
a((dp49735
g2
(lp49736
VThe scripts support for DCWorkflow only supports through-the-web-addable objects, which limits you to External Methods there
p49737
aVA better bet is to use workflow events instead
p49738
aVFor each workflow transition, two events are fired:
p49739
aVIf you subscribe to either of those events, you can then filter on the correct workflow and transistion to react to transitions from trusted code
p49740
aVEach event fired has the following attributes:
p49741
aV: the workflowed object
p49742
aV: the current applicable workflow object
p49743
aV: a  object
p49744
aV: another  object
p49745
aV: a  object
p49746
aV: a dictionary with the current workflow variables
p49747
aV: a dictionary of extra arguments passed in to the change-transition call
p49748
aVRegister a subscriber using ZCML:
p49749
aVor, because the transition events are object events, listen only to the transition event if it applies to your objects:
p49750
aVwhich registers your handler only for transition events on objects with the  interface only
p49751
aVThe handler would be:
p49752
aVor, when limiting it to one object interface:
p49753
as(dp49754
g16
V100297
p49755
stp49756
a((dp49757
g2
(lp49758
VYou will have to loop through the list
p49759
aVThe good news is is that you can use a generator expression with  to do that looping:
p49760
aVThis can raise a  exception if there is no such matching dictionary
p49761
aVUse
p49762
aVto return a default instead for that edge-case (here  is used, but pick what you need)
p49763
as(dp49764
g16
V100297
p49765
stp49766
a((dp49767
g2
(lp49768
VUse  (negative infinity) as the starter value:
p49769
aVAny other numeric value is always going to be larger than that value
p49770
aVFor searching for a minimum, you can use the positive equivalent, :
p49771
as(dp49772
g16
V100297
p49773
stp49774
a((dp49775
g2
(lp49776
VUse the  module to unpack these values to a tuple of integers:
p49777
aVThe  format specifier tells  to expect 3 values in little endian format, one unsigned short (a 2 byte value, read as an integer) and to unsigned chars (1 byte values, read as integers)
p49778
aVYou could then pass these to  to create a date object if you want:
p49779
aVDemo:
p49780
aVor you could use string formatting:
p49781
aVto create a string representing that date
p49782
as(dp49783
g16
V100297
p49784
stp49785
a((dp49786
g2
(lp49787
VYou want to use the ABCs defined in the  module only to detect a mapping (because you want to iterate over key-value pairs instead of keys), and use the standard  function for everything else:
p49788
aVNote the  call; it takes any iterable sequence object and returns an iterator object that will operate on it
p49789
aVIt supports both objects that implement the iterator protocol and objects that support a  method:
p49790
ag15438
aVo must be a collection object which supports the iteration protocol (the  method), or it must support the sequence protocol (the  method with integer arguments starting at )
p49791
aVSo where  looks for both a  and a  method,  only looks for
p49792
aVNote that you should not go overboard with accepting and handling too many different types; there should not be an exception for strings here, for example
p49793
aVRethink your code to perhaps be more strict in what you promise to handle
p49794
as(dp49795
g16
V100297
p49796
stp49797
a((dp49798
g2
(lp49799
VYou use the  function:
p49800
aVwill scan the whole list until it finds
p49801
aVUse  instead (provided that  is indeed in )
p49802
aVNote that removing from the middle of a list is still going to incur a cost as the elements from that position onwards all have to be shifted left one step
p49803
aVA binary tree might be a better solution if that is going to be a performance bottleneck
p49804
as(dp49805
g16
V100297
p49806
stp49807
a((dp49808
g2
(lp49809
VSeveral reasons:
p49810
aVYour parenthesis are not balanced:
p49811
aVThat's one closing parenthesis missing, and the one you have is in the wrong position
p49812
aVThis should be:
p49813
aVYour  statement is missing the  colon
p49814
aVYour second  function is not a function, it pretends to be a Python 2 statement instead
p49815
aVCorrect it by adding parenthesis:
p49816
aVYour indentation appears to be incorrect, but that could be a posting error
p49817
aVYour last line is not valid either; you want to call , not :
p49818
aVWith , you don't need to close the object, really
p49819
aVYou misspelled :
p49820
aVWorking code:
p49821
as(dp49822
g16
V100297
p49823
stp49824
a((dp49825
g2
(lp49826
VMap to a  or  object, then write that to the file:
p49827
aVAnother option is to use the  function to turn your hex strings into a  value:
p49828
aVHere we have to chop off the  part first, then reformat the value to pad it with zeros and join the whole into one string
p49829
as(dp49830
g16
V100297
p49831
stp49832
a((dp49833
g2
(lp49834
VYou are trying to index  with
p49835
aVis a string; it is already the item you wanted to get
p49836
aVThe  loop is giving you each element from  in turn, assigning it to the  variable
p49837
aVis not an integer index into the  list
p49838
aVNote that your counter is going to go out of bounds; if you want to have an index into the  list along with the element, use the  function
p49839
aVYou are also replacing the  list with a slice from ; perhaps you wanted to extend the list instead:
p49840
aValthough it is not clear exactly what you wanted to do with the  list in this case
p49841
as(dp49842
g16
V100297
p49843
stp49844
a((dp49845
g2
(lp49846
VYou are looking at a context manager; for relevant documentation that is an easier term to search on
p49847
aVThe original proposal PEP-343 to add the feature describes context managers in detail
p49848
aVThe datamodel documentation describes what makes a context manager
p49849
aVContext managers have  and  methods
p49850
aVThe  statement itself is documented as a compound statement in the reference documentation
p49851
aVFor file objects, the File object documentation (part of the standard types documentation) describes that most file objects can be used as context managers
p49852
aVFor files specifically, the relevant part you were looking for is documented with the  method, because that is what the context manager  method does for files: close the files whatever else happened
p49853
aVTranslating that to older Python versions where there is no support for the  statement yet, that means you have to manually close your file, with a   combination:
p49854
aVThis ensures that  is properly closed whatever else happens
p49855
as(dp49856
g16
V100297
p49857
stp49858
a((dp49859
g2
(lp49860
VYou can install Python 2
p49861
aV4 as well
p49862
aVAny of the minor versions, 2
p49863
aV4, 2
p49864
aV5, 2
p49865
aV6, etc
p49866
aVcan live side by side
p49867
aVCode you write for 2
p49868
aV4 will also run on Python 2
p49869
aV7, albeit that you may hit some deprecation warnings
p49870
aVIf you are using the 2
p49871
aV7 interpreter to write 2
p49872
aV4 code, you'll need to be careful that you don't use syntax and modules that have been added in newer Python versions
p49873
aVTo see what has been added, look at the What's new documentation; there is a document for each minor version:
p49874
aVWhat's new in Python 2
p49875
ag2176
aVWhat's new in Python 2
p49876
ag5279
aVWhat's new in Python 2
p49877
ag4892
aVYou specifically want to look for syntax changes and for new modules to avoid
p49878
as(dp49879
g16
V100297
p49880
stp49881
a((dp49882
g2
(lp49883
VThe  module is present in Python 2
p49884
aV4:
p49885
aVhttp://docs
p49886
aVpython
p49887
aVorg/release/2
p49888
aV4/lib/module-tarfile
p49889
aVhtml
p49890
aVQuoting from the module documentation:
p49891
aVNew in version 2
p49892
ag35
aVIt is a pure-python module, so it has no C library dependencies that might prevent it from being installed
p49893
aVThe  function is easily backported:
p49894
as(dp49895
g16
V100297
p49896
stp49897
a((dp49898
g2
(lp49899
VFilter out empty lines:
p49900
aVThis supports an arbitrary number of input lines by using the  arbitrary positional argument syntax
p49901
as(dp49902
g16
V100297
p49903
stp49904
a((dp49905
g2
(lp49906
V is an empty list, any index will raise an exception
p49907
aVIf you wanted to add elements to that list, use  instead
p49908
aVNote that you can loop over sequences directly, there is no need to keep your own counter:
p49909
aVYou can reduce this further by immediately printing all words that start with , no need to build a separate list:
p49910
aVIf you wanted to sort the list with all  words coming first, use a custom sort key:
p49911
aVsorts the words first by the boolean flag for ;  is sorted before  so we negate that test, then the words themselves
p49912
aVDemo:
p49913
as(dp49914
g16
V100297
p49915
stp49916
a((dp49917
g2
(lp49918
VYou are passing in a list into the function
p49919
aVis not a string, but a whole list of strings
p49920
aVLoop over it:
p49921
as(dp49922
g16
V100297
p49923
stp49924
a((dp49925
g2
(lp49926
VUse  to group your input by a specific key, such as the first letter:
p49927
aVIf your list is already sorted, you can omit the  call
p49928
aVThe  callable will return the first letter of each word (the character at index 0), and  will then yield that key plus an iterable that consists only of those items for which the key remains the same
p49929
aVIn this case that means looping over  gives you all items that start with the same character
p49930
aVDemo:
p49931
as(dp49932
g16
V100297
p49933
stp49934
a((dp49935
g2
(lp49936
VAssign it something different:
p49937
aVor
p49938
aVfor an empty list
p49939
aVAlternatively, slice assign an empty list:
p49940
aVto remove all elements in the list  refers to
p49941
as(dp49942
g16
V100297
p49943
stp49944
a((dp49945
g2
(lp49946
VThe   type returns an already opened fileobject
p49947
aVYou don't need to open it again:
p49948
aVFrom the  documentation:
p49949
aVTo ease the use of various types of files, the  module provides the factory  which takes the , ,  and  arguments of the  function
p49950
aVFor example, FileType('w') can be used to create a writable file:
p49951
aVand from the  objects documentation:
p49952
aVArguments that have  objects as their type will open command-line arguments as files with the requested modes, buffer sizes, encodings and error handling (see the  function for more details)
p49953
as(dp49954
g16
V100297
p49955
stp49956
a((dp49957
g2
(lp49958
VYou are looking for the  module, which lets you analyse and traverse the abstract syntax tree of python code
p49959
aVThe  function lets you compile a python source file into a AST, but the module itself provides a helper function too, :
p49960
aVSomeone wrote an e-book on Python AST wrangling: Green Tree Snakes - the missing Python AST docs that you might find interesting
p49961
as(dp49962
g16
V100297
p49963
stp49964
a((dp49965
g2
(lp49966
VThe whole configuration is done at runtime
p49967
aVThe examples use string constants for the names, but you are not bound to that
p49968
aVYou first load the configuration, then when you have all the elements, simply loop over those and register them as arguments:
p49969
aVthen parse your command line
p49970
aVAlternatively,  as a partial parsing mode as well; simply call  to parse everything that  does know about, it'll return a namespace object (all the options it could parse) and the remaining arguments it didn't know how to handle:
p49971
aVIn the above example,  did not know how to handle the  and  arguments, so it returned those for your own code to handle
p49972
aVThe  argument was processed
p49973
as(dp49974
g16
V100297
p49975
stp49976
a((dp49977
g2
(lp49978
VI'd parse that with a generator, yielding sections as you parse the file
p49979
aVtakes care of interpreting the value as a Python literal:
p49980
aVLoop over the above function to receive  tuples:
p49981
aVFor your sample input data, that results in:
p49982
as(dp49983
g16
V100297
p49984
stp49985
a((dp49986
g2
(lp49987
V lines create constants
p49988
aVJust create variables in python for those:
p49989
aVSo all you need to do is remove the  part, and insert a  equals sign
p49990
aVA set of regular expressions would do the job:
p49991
aVDemo:
p49992
aVIf you still want to transform the defines to functions, just adjust the replacement pattern:
p49993
aVwhich results in:
p49994
as(dp49995
g16
V100297
p49996
stp49997
a((dp49998
g2
(lp49999
VBackslashes have special meaning in Python strings, and  is the escape code for a carriage return character
p50000
aVUse double slashes, forward slashes or  raw strings (which do not interpret backslashes as escape sequences) to define the path:
p50001
as(dp50002
g16
V100297
p50003
stp50004
a((dp50005
g2
(lp50006
VYou are using the wrong directive;  is used to include another package; Django will look for a  within the package  when you use that directive
p50007
aVYou want to name the view itself instead:
p50008
aVNote: no  is being used
p50009
as(dp50010
g16
V100297
p50011
stp50012
a((dp50013
g2
(lp50014
V is indeed a list of strings
p50015
aVUse the  function to turn a string to a number, provided the string can be converted
p50016
aVYou need to assign the result, however:
p50017
aVor simply use:
p50018
aVYou did call  but ignored the return value
p50019
as(dp50020
g16
V100297
p50021
stp50022
a((dp50023
g2
(lp50024
VYou need to create pointers either way:
p50025
aVNow  can refer to  (provided it is not ), and  can refer to
p50026
aVIf you try to make an instance of  the child of more than one , the last 'parent' wins
p50027
as(dp50028
g16
V100297
p50029
stp50030
a((dp50031
g2
(lp50032
VThe data you are reading from the filename includes the newline at the end of each line ( does not remove it)
p50033
aVYou should remove this yourself;  removes all whitespace, including newlines:
p50034
aVYou do not need to call  on the  elements, because reading from a file already results in a list of strings
p50035
aVMoreover, the  formatting placeholder converts its value to a string if it is not one yet
p50036
aVWith a newline ( character in the  output below), you get the exact error you see:
p50037
aVIf you are going to process just one line from the file input, use  to read that one line and save yourself having to index a list
p50038
aVYou still need to strip off the newline
p50039
aVIf you are going to process all lines, just loop directly over the input file, which yields each line separately, again with the newline:
p50040
as(dp50041
g16
V100297
p50042
stp50043
a((dp50044
g2
(lp50045
VQuoting the PEP 8 style guide:
p50046
aVWhen importing a class from a class-containing module, it's usually okay to spell this:
p50047
aVIf this spelling causes local name clashes, then spell them
p50048
aVEmphasis mine
p50049
aVDon't use ; you are relying on the internal implementation details of , which may later change what imports it is using
p50050
aVYou can import  directly, so do so unless otherwise documented by the module author
p50051
aVYou can use the  convention to limit what is imported from a module with ; the  command honours that list as well
p50052
aVListing the names you explicitly export in  helps clean up the  text presentation:
p50053
aVThe public names defined by a module are determined by checking the module\u2019s namespace for a variable named ; if defined, it must be a sequence of strings which are names defined or imported by that module
p50054
aVThe names given in  are all considered public and are required to exist
p50055
aVIf  is not defined, the set of public names includes all names found in the module\u2019s namespace which do not begin with an underscore character ()
p50056
aVshould contain the entire public API
p50057
aVIt is intended to avoid accidentally exporting items that are not part of the API (such as library modules which were imported and used within the module)
p50058
as(dp50059
g16
V100297
p50060
stp50061
a((dp50062
g2
(lp50063
VYou normally do not do this; you leave the parameter out altogether and leave it to python to fill in the default:
p50064
aVYou can retrieve the default values from a function with the  function
p50065
aVYour example is rather simple of course; it only takes one argument that you know to have a  default value
p50066
aVIn more common situations there are positional parameters too, which do not have defaults
p50067
aVTo reconstruct what arguments have defaults, you need to re-combine the arguments and their defaults:
p50068
aVDemo:
p50069
as(dp50070
g16
V100297
p50071
stp50072
a((dp50073
g2
(lp50074
VYou can run arbitrary SQL statements with , including that pragma statement
p50075
aVThe  statement returns a sequence of rows:
p50076
as(dp50077
g16
V100297
p50078
stp50079
a((dp50080
g2
(lp50081
VDon't use the minidom
p50082
aVUse the ElementTree API instead
p50083
aVIt can handle subtree searches much better:
p50084
as(dp50085
g16
V100297
p50086
stp50087
a((dp50088
g2
(lp50089
VYou are only storing references to the original list
p50090
aVYou want to create copies instead:
p50091
aVor
p50092
aVThe  syntax creates a new list from a slice from the first to the last element of the original list
p50093
as(dp50094
g16
V100297
p50095
stp50096
a((dp50097
g2
(lp50098
VYou do not have a list
p50099
aVThe  function returns , not whatever it just printed to your terminal or IDE
p50100
aVStore the random values, then print:
p50101
aVNow you can just sort the list:
p50102
as(dp50103
g16
V100297
p50104
stp50105
a((dp50106
g2
(lp50107
VNo, the  library is not compatible with Python 3
p50108
aVIt relies on , a package that is not Python 3 compatible itself:
p50109
aVitself uses the same obsolete syntax in :
p50110
aVBoth  and  need to be ported first
p50111
as(dp50112
g16
V100297
p50113
stp50114
a((dp50115
g2
(lp50116
VConvert your file to a set instead:
p50117
aVNow you can do efficient membership tests per line, provided you can split your lines:
p50118
as(dp50119
g16
V100297
p50120
stp50121
a((dp50122
g2
(lp50123
VThe function object has a code object associated with it; you can  that code object:
p50124
aVThis will not however set  in the local namespace, because it is compiled to create a local name only, using the  opcode
p50125
aVYou'd have to transform this bytecode to use  opcodes instead, requiring you to learn AST transformations
p50126
aVIf you did want to go down this route, then read Exploring Dynamic Scoping in Python, which teaches you the ins and outs of Python scoping and byte code
p50127
as(dp50128
g16
V100297
p50129
stp50130
a((dp50131
g2
(lp50132
VYou probably have your own  python file in your system path, perhaps in the local directory
p50133
aVDon't do that, as it breaks  (and other python code)
p50134
aVTo be compatible with both python 2 and 3,  uses constructs like:
p50135
aVThe  line could throw a  exception if you have a local  module or  package that masks the standard library file
p50136
aVBecause the first import throws an , the second line is executed, which also fails because the  package is only available on Python 3
p50137
aVFrom your project, run the following code to diagnose where you have that module:
p50138
aVIf that still works, then run:
p50139
aVas it could be that  indirectly imports something that you masked
p50140
aVuses  statements for example, so a local  module would also break the import
p50141
aVIt is important that you do this from your flask project, just before the  line
p50142
as(dp50143
g16
V100297
p50144
stp50145
a((dp50146
g2
(lp50147
VYou are creating too long a path and the OS no longer accepts a longer environment variable
p50148
aVExtend the path only once
p50149
aVTest for the presence of the paths you are adding:
p50150
aVThis code only adds new elements if not already present
p50151
as(dp50152
g16
V100297
p50153
stp50154
a((dp50155
g2
(lp50156
VYou really want to define how instances of type  compare by implementing special Python hook methods, incorporating your  method into the class itself
p50157
aVAn  method will tell Python how two objects are equal, and you can use the , ,  and  hooks to define ordering comparisons
p50158
aVUse the  class decorator to minimize the number of methods you need to implement:
p50159
aVNow you can just compare the  instances directly using the Python , , ,  and  operators:
p50160
as(dp50161
g16
V100297
p50162
stp50163
a((dp50164
g2
(lp50165
VYou got confused
p50166
aVYou are running , not
p50167
aVRun  to have it call
p50168
aVBecause you are running  it's  block is running and  is an empty string
p50169
aVYour code is otherwise working Just Fine:
p50170
as(dp50171
g16
V100297
p50172
stp50173
a((dp50174
g2
(lp50175
VUse a class decorator instead:
p50176
aVwhere  is defined as:
p50177
aVDemo:
p50178
aVThis sets the docstring after defining the whole class, without having to create an instance first
p50179
aVIf you need the docstring available to method decorators, you are, unfortunately, wholly stuck with your decorator that duplicates the parent class
p50180
aVThe reason for this is that you cannot introspect what the superclass is going to be while defining the class body
p50181
aVThe local namespace during class definition does not have access to the arguments passed to the class factory
p50182
aVYou could use a metaclass to add the base classes to the local namespace, then use a decorator to pull those out again, but in my opinion that gets ugly, fast:
p50183
aVDemo usage:
p50184
as(dp50185
g16
V100297
p50186
stp50187
a((dp50188
g2
(lp50189
VUse  to have python format everything it knows about a given function for you
p50190
aVYou can also use the  function to get a named tuple overview of the arguments accepted
p50191
aVYou can pass the result of that function to  to format that as a python function as well:
p50192
aVFor the above example function,  prints:
p50193
as(dp50194
g16
V100297
p50195
stp50196
a((dp50197
g2
(lp50198
VYou'd have to special-case the song handling:
p50199
aVThis sorts the keys as well to make sure you get consistent objects (same order)
p50200
aVThis gives you:
p50201
as(dp50202
g16
V100297
p50203
stp50204
a((dp50205
g2
(lp50206
VPython 3 opens text files by default as UTF-8 to decode to Unicode values
p50207
aVYour inputfile is not UTF-8 however, and decoding fails
p50208
aVIt is impossible to deduce from the error message or your post what the correct encoding is, but you need to find out and specify it when opening the file:
p50209
aVNote the  as well; see the  documentation
p50210
aVYour  handling is overly verbose, just use:
p50211
as(dp50212
g16
V100297
p50213
stp50214
a((dp50215
g2
(lp50216
VYou can't, because that is a self-referencing link
p50217
aVYou have already opened the document
p50218
aVA  in a URL signifies a location within a document
p50219
aVWhen the URL starts with a  it is location within the current document; the browser will scroll to whatever ID is named after the
p50220
aVIn the following example, clicking on the  link instructs the browser to scroll the document to position the  element at the top of the browser window:
p50221
aVWhen the URL consists only of a , the URL is a no-op
p50222
aVIt is a placeholder, for JavaScript to intercept the link click usually
p50223
aVYou can ignore it altogether when processing this document with Python
p50224
aVYour Python HTML parser is not a browser, no JavaScript is being run to handle the mouseclick on that link element
p50225
aVThere is not even a mouseclick
p50226
aVIf you are trying to process a JavaScript-driven page, you could either use a JavaScript debugger (comes with most browsers) to figure out what it is doing, or run a headless browser controlled by Python
p50227
aVYou could use Ghost
p50228
aVpy to do the latter:
p50229
aVThis runs a headless Webkit browser
p50230
as(dp50231
g16
V100297
p50232
stp50233
a((dp50234
g2
(lp50235
VYou need one more ; each conditional expression needs both an  and an , you are omitting the  from the second conditional expression
p50236
aVBut your problem can be expressed much more simply as:
p50237
aVThis first filters on any tuple that has a zero in it, then picks the value that is not 0
p50238
aVDemo:
p50239
as(dp50240
g16
V100297
p50241
stp50242
a((dp50243
g2
(lp50244
VYou really don't want to go down this rabbit hole, but if you insist, it is possible
p50245
aVWith some work
p50246
aVThe nested function is created anew for each call to :
p50247
aVThe  opcode there creates a function with a closure, a nested function referring to  from the parent function (the  opcode builds the closure cell for the function)
p50248
aVWithout calling the  function, you can only access the code object; it is stored as a constant with the  function code
p50249
aVThe byte code for  counts on being able to access the  variable as a scoped cell, however, which makes the code object almost useless to you:
p50250
aVloads a value from a closure cell
p50251
aVTo make the code object into a function object again, you'd have to pass that to the function constructor:
p50252
aVbut as you can see, the constructor expects to find a closure, not an integer value
p50253
aVTo create a closure, we need, well, a function that has free variables; those marked by the compiler as available for closing over
p50254
aVAnd it needs to return those closed over values to us, it is not possible to create a closure otherwise
p50255
aVThus, we create a nested function just for creating a closure:
p50256
aVNow we can recreate  without calling :
p50257
aVPerhaps just calling  would have been simpler
p50258
aVIncidentally, as you can see, functions are first-class objects in Python
p50259
aVis an object, and by adding  you invoke, or call the function
p50260
aVIn this case, that function returns another function object, one that you can call as well
p50261
aVIn the above tortuous example of how to create  without calling , I referred to the  function object without calling it; to disassemble the Python byte code attached to it, or to retrieve constants or closures from it, for example
p50262
aVIn the same way, the  function returns the  function object; the point of  is to create that function for something else to later call it
p50263
aVThe above session was conducted with compatibility between Python 2 and 3 in mind
p50264
aVOlder Python 2 versions work the same way, albeit that some of the details differ a little; some attributes have different names, such as  instead of , for example
p50265
aVLook up the documentation on these in the  module and the Python datamodel if you want to know the nitty gritty details
p50266
as(dp50267
g16
V100297
p50268
stp50269
a((dp50270
g2
(lp50271
VIn Python 3, when you pass a byte value (raw bytes from the network without decoding) you get to see the representation of the byte value as a Python byte literal
p50272
aVThis includes representing newlines as  characters
p50273
aVBy decoding, you now have a unicode string value instead, and  can handle that directly:
p50274
aVThis is perfectly normal behaviour
p50275
as(dp50276
g16
V100297
p50277
stp50278
a((dp50279
g2
(lp50280
VReturn both the value and the key, in that order:
p50281
aVfor just the keys, or
p50282
aVfor key-value pairs; the  negative-step slice reverses the value and the key for sorting
p50283
aVThis sorts first on the value, then uses the key if the values are equal
p50284
aVResult:
p50285
aVFor a mixed direction sort, negate the values, and reverse the sort:
p50286
aVNegating the numbers causes them to be sorted in descending order while the keys retain ascending order; reversing then swaps that to ascending and descending, respectively
p50287
as(dp50288
g16
V100297
p50289
stp50290
a((dp50291
g2
(lp50292
VIn CPython, the file object will close on its own once the reference count drops to 0, which is right after  returns
p50293
aVFor other Python implementations it may take a little longer depending on the garbage collection algorithm used
p50294
aVThe file is certainly going to be closed no later than program exit
p50295
aVYou should really use the file object as a context manager and have the  statement call close on it:
p50296
aVAs soon as the block of code indented under the  statement exits (be it with an exception, a ,  or  statement, or simply because all code in the block finished executing), the  file object will be closed
p50297
aVBonus tip: file objects are iterables, so the following also works:
p50298
aVfor the exact same result
p50299
as(dp50300
g16
V100297
p50301
stp50302
a((dp50303
g2
(lp50304
VUse a dictionary, and store only the highest value found so far
p50305
aVBecause the scores are given as letters, that means you need to find the 'lowest' letter, lexographically:
p50306
as(dp50307
g16
V100297
p50308
stp50309
a((dp50310
g2
(lp50311
VOne uses a positional parameter, the other a keyword parameter
p50312
aVIf the  object definition has  as the first parameter, the two versions mean the same thing as Python will fill parameters from left to right, even if those paramaters are keyword parameters
p50313
aVPresumably, you are looking at code using SQLAlchemy; the  type has exactly that signature;  is the first parameter:
p50314
as(dp50315
g16
V100297
p50316
stp50317
a((dp50318
g2
(lp50319
VThe interpreter is written in C
p50320
aVIt compiles Python code into bytecode, and then an evaluation loop interprets that bytecode to run your code
p50321
aVYou identify what Python is written in by looking at it's source code
p50322
aVSee the source for the evaluation loop for example
p50323
aVNote that the Python
p50324
aVorg implementation is but one Python implementation
p50325
aVWe call it CPython, because it is implemented in C
p50326
aVThere are other implementations too, written in other languages
p50327
aVJython is written in Java, IronPython in C#, and then there is PyPy, which is written in a (subset of) Python, and runs many tasks faster than CPython
p50328
as(dp50329
g16
V100297
p50330
stp50331
a((dp50332
g2
(lp50333
VYou are using a newer text role,
p50334
aVPyPI appears to only support docutils 0
p50335
aV8, with  and  added to the PyPI parser directly, which means that  is not supported
p50336
aVGitHub uses a newer version of docutils (0
p50337
aV9 or 0
p50338
aV10)
p50339
aVRemove the  altogether:
p50340
aVwith:
p50341
aVetc
p50342
as(dp50343
g16
V100297
p50344
stp50345
a((dp50346
g2
(lp50347
VFirst of all:  normally is a function
p50348
aVYour code masks the function by using a local variable with the same name
p50349
aVYou can do this with any built-in Python object
p50350
aVIn other words, you are not using the  function here
p50351
aVYou are using a for loop variable that happens to use the same name
p50352
aVYou could have called it  and it would be no more about dictionaries than it is about Guido's choice of coffee
p50353
aVFrom the perspective of the  loop, there is no difference between your two examples
p50354
aVYou'd otherwise use the  function to produce an iterator type; an object that has a  method ( in Python 3)
p50355
aVThe  loop does this for you, normally
p50356
aVWhen using an object that can produce an iterator, the  statement will use the C equivalent of calling  on it
p50357
aVYou would only use  if you were doing other iterator-specific stuff with the object
p50358
as(dp50359
g16
V100297
p50360
stp50361
a((dp50362
g2
(lp50363
VYes, by defining  as an ABC (Abstract Base Class):
p50364
aVYou can subclass , but you can only create instances of such a subclass if the  method has a concrete implementation:
p50365
as(dp50366
g16
V100297
p50367
stp50368
a((dp50369
g2
(lp50370
VYou are opening a relative path, but your working directory is not what you think it is
p50371
aVUse an absolute path instead:
p50372
aVWithout an absolute path, Python uses the current working directory
p50373
aVWhat that directory is depends on how you ran your script, and is not something you should rely on
p50374
as(dp50375
g16
V100297
p50376
stp50377
a((dp50378
g2
(lp50379
VThe library that you use only looks for global class objects in your module
p50380
aVSet each class as a global; the  function gives you access to your module namespace as a dictionary:
p50381
aVThe  code does not look for your views in lists
p50382
aVTo be specific,  uses the following loop to detect handlers:
p50383
aVonly considers top-level objects
p50384
as(dp50385
g16
V100297
p50386
stp50387
a((dp50388
g2
(lp50389
VYou are using transactions
p50390
aVDatabase transactions isolate different connections and ensure that you keep the database in a consistent state
p50391
aVNot until you commit the transaction can other connections see your changes
p50392
aVYour SQLAlchemy connection can see all changes it made because it is party to its own transaction
p50393
aVNote that the other option is to abort the transaction, and roll back all changes, and your new object will no longer exist in the database, in this connection or any other
p50394
aVDatabase transactions are a general concept and not specific to SQLAlchemy
p50395
as(dp50396
g16
V100297
p50397
stp50398
a((dp50399
g2
(lp50400
VPython is printing the string representation, which includes a non-printable byte
p50401
aVNon-printable bytes (anything outside the ASCII range or a control character) is displayed as an escape sequence
p50402
aVThe point is that you can copy that representation and paste it into Python code or into the interpreter, producing the exact same value
p50403
aVThe  escape code represents a byte with hex value F6, which when interpreted as a Latin-1 byte value, is the  character
p50404
aVYou probably want to decode that value to Unicode to handle the data consistently
p50405
aVIf you don't yet know what Unicode really is, or want to know anything else about encodings, see:
p50406
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p50407
aVby Joel Spolsky
p50408
aVThe Python Unicode HOWTO
p50409
aVPragmatic Unicode by Ned Batchelder
p50410
as(dp50411
g16
V100297
p50412
stp50413
a((dp50414
g2
(lp50415
VIt is the path from top-level module down to the object itself
p50416
aVSee PEP 3155, Qualified name for classes and functions
p50417
aVIf you have a nested package named  with a class , the method  on that class will have a fully qualified name of
p50418
aVis the unqualified name
p50419
aVA qualified name lets you re-import the exact same object, provided it is not an object that is private to a local (function) namespace
p50420
as(dp50421
g16
V100297
p50422
stp50423
a((dp50424
g2
(lp50425
VSounds like you have a javascript error
p50426
aVThe fieldset tabs are handled in pure JS; all but the first are hidden on page load
p50427
aVLook in your browser console and see what is tripping up the JS and preventing the code from moving the fieldsets to tabs
p50428
as(dp50429
g16
V100297
p50430
stp50431
a((dp50432
g2
(lp50433
VUse  to turn your hex strings to binary data, then XOR that, going back to hex with :
p50434
aVThe actual XOR is applied per byte of the decoded data (using  and  to go to and from integers)
p50435
aVNote that like in your example, I truncated  to be the same length as  (ignoring characters from the start of )
p50436
aVYou can encode all of  with a shorter key  by cycling the bytes:
p50437
aVYou don't have to use , but it is a lot easier than looping over  and  2 characters at a time and using  to turn that into integer values for XOR operations
p50438
as(dp50439
g16
V100297
p50440
stp50441
a((dp50442
g2
(lp50443
VI think you are looking for the  parameter; you can iterpolate  into your help strings with
p50444
aVThe value for  can be set when creating the  instance; it is the first parameter:
p50445
aVand can be retrieved with the  attribute:
p50446
aVHowever, calls  on this name, and does not store the directory of the program anywhere
p50447
as(dp50448
g16
V100297
p50449
stp50450
a((dp50451
g2
(lp50452
V does two things:
p50453
aVcollect the stack by asking the interpreter for the stack frame from the caller () then following all the  references
p50454
aVThis is cheap
p50455
aVper frame, collect the filename, linenumber, and source file context (the source file line plus some extra lines around it if requested)
p50456
aVThe latter requires reading the source file for each stack frame
p50457
aVThis is the expensive step
p50458
aVTo switch off the file context loading, set the  parameter to :
p50459
aVEven with context set to 0, you still incur some filesystem access per frame as the filename is determined and verified to exist for each frame
p50460
as(dp50461
g16
V100297
p50462
stp50463
a((dp50464
g2
(lp50465
VYou need to list your  loops in the same order you nest them:
p50466
aVYou had swapped the  and  loops, which would only work if there was a global  variable still available in your session or in your module
p50467
aVIt may be easier in this case to just use a generator function instead of a generator expression, by using  instead of :
p50468
aVThis will have the exact same effect but is perhaps more readable
p50469
as(dp50470
g16
V100297
p50471
stp50472
a((dp50473
g2
(lp50474
VYou call  with just two arguments,  and
p50475
aVYou leave  to the default, :
p50476
aVThis means the  test is  and you end up with passing  to
p50477
aVPerhaps you meant to test if  is not set:
p50478
as(dp50479
g16
V100297
p50480
stp50481
a((dp50482
g2
(lp50483
VUse Unicode filenames and let Python encode the codepoints to the correct encoding for your system
p50484
aVAlternatively, detect the filesystem encoding yourself, and ensure that your filenames are using that specific encoding when passing these to the  function
p50485
aVIf you do not yet know what Unicode is, or how that relates to encodings, I urge you to read:
p50486
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p50487
aVby Joel Spolsky
p50488
aVThe Python Unicode HOWTO
p50489
aVPragmatic Unicode by Ned Batchelder
p50490
aVbefore you continue
p50491
aVIf you are specifying a literal string in your source code, then you need to make sure that you have specified the codec used to save your source, and to use a unicode literal:
p50492
aVspecifies that you saved your source code in UTF-8 and that the  variable should hold a Unicode string (note the  string literal)
p50493
as(dp50494
g16
V100297
p50495
stp50496
a((dp50497
g2
(lp50498
VUse :
p50499
aVRun on my Mac OS X 10
p50500
ag1140
ag400
aVNote that your Python executable may be a universal binary, in which case you could get the wrong architecture quoted:
p50501
aV: On Mac OS X (and perhaps other platforms), executable files may be universal files containing multiple architectures
p50502
aVYou can also test :
p50503
aVThe above would return  if you were running a 32-bit platform
p50504
as(dp50505
g16
V100297
p50506
stp50507
a((dp50508
g2
(lp50509
VYou create a list of 1999 elements:
p50510
aVYou then loop over a  up to, but not including, that length:
p50511
aVThus  is never going to be larger than 1998
p50512
aVInstead of , use an upper limit constant:
p50513
aVNext problem is that you continue to loop with ; you will generate numbers that are no longer part of the  list, so they cannot be removed a second time
p50514
aVYou can use exception handler to catch the exception:
p50515
aVbut you may want to rethink the  loop condition
p50516
as(dp50517
g16
V100297
p50518
stp50519
a((dp50520
g2
(lp50521
VYou are using the  function on Python 2
p50522
aVUse  instead, or switch to Python 3
p50523
aVruns  on the input given, so entering  is interpreted as python code, looking for the  variable
p50524
aVYou could work around that by entering  (so with quotes) but that is hardly a solution
p50525
aVIn Python 3,  has been renamed to , replacing the version from Python 2 altogether
p50526
aVIf your materials (book, course notes, etc
p50527
aVuse  in a manner that expects  to work, you probably need to switch to using Python 3 instead
p50528
as(dp50529
g16
V100297
p50530
stp50531
a((dp50532
g2
(lp50533
VYou need to set  again
p50534
aVThe expression is not re-evaluated every time you set ; it is only calculated once
p50535
aVExecuting  did not magically change  to point to the other lambda
p50536
aVSimply run the  expression a second time:
p50537
aVIf you expected  to be re-evaluated, you'd need to make that a function or lambda by itself:
p50538
aVBut note that you now have to call  to return your lambda object, which we then call with an argument
p50539
aVBy invoking  the expression is reevaluated, the  name is looked up in the surrounding scope (as a global in this case) and one of the lambdas is returned
p50540
as(dp50541
g16
V100297
p50542
stp50543
a((dp50544
g2
(lp50545
VIn your production environment,  is already a  object:
p50546
aVSo to find the difference between your production and development environments, you'll have to trace what produces  and find out why one environment produces strings, and the other produces  objects instead
p50547
aVIf you are using datetime operations on your server backend, take into account that some SQL servers support native datetime arithmetic, but SQLite (the database you usually develop against) does not
p50548
aVPostgreSQL will produce  objects, SQLite produces strings
p50549
aVYou'll either want to switch how you handle dates here based on your database settings, or detect if you already have a  object and skip parsing
p50550
as(dp50551
g16
V100297
p50552
stp50553
a((dp50554
g2
(lp50555
V does not match , so the  extension is not being matched
p50556
aVAdd the  dot to your character class
p50557
aVYou want to drop the trailing slash as well:
p50558
aVThis now will match the literal text  followed by between 0 and 256 letters, digits, underscores and dots
p50559
aVQuick demo:
p50560
as(dp50561
g16
V100297
p50562
stp50563
a((dp50564
g2
(lp50565
VYou are removing an item from the list returned by
p50566
aVYou need to delete from the dictionary instead:
p50567
aVreturns the first or last key-value, after deleting it
p50568
aVSetting  to  signals you wanted to remove the first
p50569
aVNote that you can test against just the first value:
p50570
aVI'd also just use key assignment instead of  for just one element:
p50571
as(dp50572
g16
V100297
p50573
stp50574
a((dp50575
g2
(lp50576
VYour  and  methods return an integer
p50577
aVcan only work with sequences (lists, sets, tuples, strings, iterators, etc
p50578
aVYou don't need to call  at all here; you are testing one integer against another:
p50579
aVis plenty
p50580
aVYou also want to avoid using a leading  on integer literals
p50581
aVis interpreted as an octal number; if you ever had to change that number to using more digits, or using digits outside of the range 0-7, you'd be in for a nasty surprise:
p50582
as(dp50583
g16
V100297
p50584
stp50585
a((dp50586
g2
(lp50587
VYou want to pass in the tuple as separate arguments, using the  splat syntax:
p50588
aVBy prefixing  with an asterisk, you are telling Python to call  with all values from that variable as separate parameters
p50589
aVSee the calls expression documentation for details; there is a  form as well to expand mapping into keyword arguments
p50590
as(dp50591
g16
V100297
p50592
stp50593
a((dp50594
g2
(lp50595
VYou get the error because  returns ; you cannot write  to a file:
p50596
aVYour attempt to read and write to  will otherwise fail; you should not both treat the file object as an iterator () and expect to be able to write to the file
p50597
aVThe file iterator uses a read-ahead buffer and you have no idea where your write is going to end up in the file
p50598
aVIt is otherwise entirely unclear as to what you are trying to do
p50599
aVNormally, you'd write a custom subclass of the  class that collects data in instance attributes
p50600
aVYou then call , after which you collect whatever you wanted from those attributes
p50601
aVYou may be better off using an easier API for HTML like BeautifulSoup, which doesn't require you to create a parser subclass and is much easier to use when it comes to simple HTML extraction tasks
p50602
as(dp50603
g16
V100297
p50604
stp50605
a((dp50606
g2
(lp50607
VUse the  module; the  function returns a  tuple:
p50608
aVNote that you have to include the year; in a leap-year, February has 29 days, after all
p50609
aVYou can get just the current year with the  module:
p50610
aVNow you only have to ask for a month number:
p50611
aVThis prints the abbreviated month and the number of days:
p50612
as(dp50613
g16
V100297
p50614
stp50615
a((dp50616
g2
(lp50617
VYou are generating invalid SQL code
p50618
aVAn  statement does not accept  parenthesis around the table name
p50619
aVTo quote a table name (which makes it case sensitive, so be careful) put double quotes around it:
p50620
aVThe above example also uses proper SQL parameters for the row data; you generally want to let the database prepare a generic statement and reuse the prepared statement for each insert
p50621
aVBy using SQL parameters you not only ensure that  is properly escaped, but also let the database prepare the generic statement
p50622
aVI used the default paramstyle format for pg8000
p50623
aVYou probably want to rethink your  loop condition; why not test if  instead
p50624
aVor use a python  loop with  instead:
p50625
as(dp50626
g16
V100297
p50627
stp50628
a((dp50629
g2
(lp50630
VThe part before the colon is only used in string formatting, and is a templating function, not about formatting the actual values themselves
p50631
aVThe part after the colon is handled separately, and can also be specified using the  function:
p50632
aVformats the number as lower-cased zero-padded hexadecimal of minimal 2 characters
p50633
aVIt is this functionality that  lets you hook into; this is the business end of formatting the value
p50634
aVThe part before the colon specifies the , how the string formatter retrieves a value to format
p50635
aVWhen formatting the value, it shouldn't matter at all how the field was determined
p50636
aVThe  is only useful to locate the value on which to call , and to specify an alternate conversion method ( or ) for that value
p50637
aVNote that by using  the  method is ignored and  is used instead
p50638
aVThe same applies to  and :
p50639
as(dp50640
g16
V100297
p50641
stp50642
a((dp50643
g2
(lp50644
VWhen redirecting the output,  is not connected to a terminal and Python cannot determine the output encoding
p50645
aVWhen not directing the output, Python can detect that  is a TTY and will use the codec configured for that TTY when printing unicode
p50646
aVSet the  environment variable to tell Python what encoding to use in such cases, or encode explicitly
p50647
as(dp50648
g16
V100297
p50649
stp50650
a((dp50651
g2
(lp50652
VYou are creating your dictionary incorrectly
p50653
aVUse:
p50654
aVinstead
p50655
aVYour code sets the whole  sequence as the value for each key in , instead of the individual column value, then appending that same dictionary to the  list for each column key
p50656
as(dp50657
g16
V100297
p50658
stp50659
a((dp50660
g2
(lp50661
VYou are using a local variable  here:
p50662
aVYou do set  before that point, but only if certain conditions match
p50663
aVWhen those conditions do not match,  is never assigned to and the exception is thrown
p50664
aVFor example, in the first  branch, the loop is:
p50665
aVIf  never matches, then  is never set either
p50666
aVYour function also doesn't return anything, so the line  will only ever assign  to
p50667
aVYou need to use the  keyword to set a return value for your function
p50668
aVLast but not least, you only pass the first row from your CSV file to the function, and that first row has no website associated with it:
p50669
as(dp50670
g16
V100297
p50671
stp50672
a((dp50673
g2
(lp50674
VJust match digits:
p50675
aVmatches the characters 0-9,  matches between 1 and 3 of them
p50676
aVIf you don't want to match anything that starts with  and then followed by a number higher than 200, you can create an expression that is more picky:
p50677
aVMatches a one-digit number between 1 and 9, or a 2 digit number between 10 and 99, or a 3 digit number between 100 and 199, or the number 200
p50678
aVNone of these expressions prevent the match from being followed by more digits
p50679
aVYou may need to add the  boundary anchor to the end of the expression:
p50680
aVFor your posted sample, I'd explicitly include the  parameter:
p50681
as(dp50682
g16
V100297
p50683
stp50684
a((dp50685
g2
(lp50686
VYour  statement does not do what you think it does
p50687
aVYou are applying operator chaining and you are testing 2 things:
p50688
aVThis will always be  because  is not
p50689
aVDemo:
p50690
aVFrom the comparisons documentation:
p50691
aVComparisons can be chained arbitrarily, e
p50692
ag1298
aV,  is equivalent to , except that  is evaluated only once (but in both cases  is not evaluated at all when  is found to be false)
p50693
aVYou do not need to test for  here; Python's  statement is perfectly capable of testing that for itself:
p50694
aVYour next problem is that you never change , so now you'll append 1000  strings to your list
p50695
aVYou'd be better off using a  loop over  and setting  each iteration:
p50696
aVNow your function works:
p50697
as(dp50698
g16
V100297
p50699
stp50700
a((dp50701
g2
(lp50702
VYou are trying to iterate over an integer:
p50703
aVPerhaps you wanted to iterate over the range instead:
p50704
aVproduces a sequence of integers up to (but not including)  for you
p50705
aVNote that you can swap variables in place in Python without a temporary intermediary:
p50706
aVand you don't need to 'pre-declare' variables either; the ,  and  lines are redundant
p50707
as(dp50708
g16
V100297
p50709
stp50710
a((dp50711
g2
(lp50712
VAll lines are instances of , so you break out on the first line
p50713
aVRemove that test, and test for an empty line by stripping away whitespace first:
p50714
aVI don't think you need to break at an empty line, really; the  loop ends on its own at the end of the file
p50715
aVIf your lines contain other sorts of data, you'd need to do the conversion yourself, coming from string
p50716
as(dp50717
g16
V100297
p50718
stp50719
a((dp50720
g2
(lp50721
Vmerely concatenates strings
p50722
aVIf  is , then the result is
p50723
aVcan be any pattern that matches up to 7 digits or arbitrary characters
p50724
aVIf  were to be the empty string, your pattern would match, but so would
p50725
aVYour initial prefix and postfix ( and ) match:
p50726
aVthe literal text  plus one arbitrary character ( in regular expressions match one character, whatever that may be)
p50727
aVOne arbitrary character plus at least one digit
p50728
aVThe following pattern would match your directories more concisely:
p50729
aVbecause that matches the literal text  (noe the escaped  there) and 1 or more digits
p50730
aVYou do not need to use string concatenation to achieve that
p50731
aVNote that if you wanted to take user input from the command line, you probably want to use the  function on those strings to escape any regular expression meta characters in the string
p50732
aVDepending on what you are trying to do you should consider not using regular expressions as well perhaps
p50733
as(dp50734
g16
V100297
p50735
stp50736
a((dp50737
g2
(lp50738
VYou are printing the return value of the  function
p50739
aVAll functions in Python have a return value, and if you don't use a  statement, that value defaults to
p50740
aVInstead of printing in the  function, rename that function to  and have it return the formatted string:
p50741
aVthen use
p50742
aVThe  method above uses a format string syntax that refers to the first parameter passed in (, python indexing is 0-based), and interpolates attributes from that parameter
p50743
aVThe first parameter is your  instance
p50744
aVYou can expand on that and add some more formatting, such as zero-padding your numbers:
p50745
as(dp50746
g16
V100297
p50747
stp50748
a((dp50749
g2
(lp50750
VThe problem here is the lack of a key for the nested object, not the
p50751
aVYou'd need to find a way to fix that syntax or parse it yourself
p50752
aVIf we make a few assumptions about the syntax, you should be able to use a regular expression to fix the JSON data before decoding:
p50753
aVThis assumes that any  combo indicates the location of a missing key, and generates one to insert there
p50754
aVThat is a reasonable assumption to make, but may break things if you have string data with exactly that sequence
p50755
aVDemo:
p50756
as(dp50757
g16
V100297
p50758
stp50759
a((dp50760
g2
(lp50761
V does not directly support dependencies
p50762
aVYour options instead are:
p50763
aVUse priorities
p50764
aVSet  for  to a low value and it'll be started before , and shut down after
p50765
aVThe default value for  is
p50766
aVIf you put the two programs into one group as well, that'd let you start and stop them in tandem, with the priorities regulating their start and stop order
p50767
aVWrite an event listener that listens for  -to- transition and  events for , then instruct  to start and stop  according to those events
p50768
aVHave  autostart, but disable autostarting for , so that the event handler controls it
p50769
as(dp50770
g16
V100297
p50771
stp50772
a((dp50773
g2
(lp50774
VThe error indicates you are mixing Unicode data and byte strings
p50775
aVYour file data consists of only byte strings, which means your other POST values (the keys and values in ) or the filenames use unicode values
p50776
aVEncode all those values to byte strings first
p50777
as(dp50778
g16
V100297
p50779
stp50780
a((dp50781
g2
(lp50782
VA terminal generally uses line-buffering, while a pipe would use block buffering
p50783
aVThis means that your  call, which includes a newline, will fill the line buffer, triggering a flush
p50784
aVWhen redirecting, no flush takes place until the program completes
p50785
aVon the other hand, always flushes the buffer it is writing to when it completes
p50786
aVWith line buffering (terminal output), the order is:
p50787
aVprints a line with newline, buffer is flushed, you see  being printed
p50788
aVwrites output, exits, flushes the buffer, you see  printed
p50789
aVWith block buffering, the order is:
p50790
aVprints a line with newline, not fully filling the buffer
p50791
aVwrites output, exits, flushes the buffer, you see  printed
p50792
aVYour program exits, flushes its block buffer, you see  being printed
p50793
aVYour options are to use to flush explicitly using  or to set the buffering on  explicitly with
p50794
as(dp50795
g16
V100297
p50796
stp50797
a((dp50798
g2
(lp50799
VYou are reading all rows into a list, then processing that list
p50800
aVDon't do that
p50801
aVProcess your rows as you produce them
p50802
aVIf you need to filter the data first, use a generator function:
p50803
aVI also simplified your filter test; the logic is the same but more concise
p50804
aVYou can now loop over  directly
p50805
aVDo the same in :
p50806
aVNow loop directly over  in your code:
p50807
aVYou now only hold one row in memory, instead of your thousands of lines per criterion
p50808
aVmakes a function a generator function, which means it won't do any work until you start looping over it
p50809
as(dp50810
g16
V100297
p50811
stp50812
a((dp50813
g2
(lp50814
VNo, the egg format does not have any provisions for code signing
p50815
aVPyPI does provide you with an MD5 signature (as part of the download URL), but current tools do not verify this at the moment
p50816
aVThe newer Wheel binary package format supports both cryptographic hashes and digital (S/MIME ) signatures; an installer is required to verify the hashes upon installation, digital signature verification is optional
p50817
aVNote that due to Python's dynamic and flexible nature, there is little point in relying on signed code after installation, as another python module can completely change the code structures in any other Python module
p50818
as(dp50819
g16
V100297
p50820
stp50821
a((dp50822
g2
(lp50823
VBecause a set has no fixed order
p50824
aVQuoting the set documentation:
p50825
aVA set object is an unordered collection of distinct hashable objects
p50826
aVUse a list or tuple if you require ordering, or use an  object to create unique keys that preserve ordering:
p50827
as(dp50828
g16
V100297
p50829
stp50830
a((dp50831
g2
(lp50832
VThe  object is the nested  file inside the  package
p50833
aVOnce you have imported the sub module, it also becomes available as an attribute of the package (unless you also included a  name in the  file
p50834
aVThe Python 3
p50835
aV3 module loader (which is implemented in Python) simply sets a nested module as an attribute on the parent:
p50836
aVThis behaviour is more or less implied in the Python packages documentation:
p50837
aVAll modules have a name
p50838
aVSubpackage names are separated from their parent package name by dots, akin to Python\u2019s standard attribute access syntax
p50839
aVThus you might have a module called  and a package called , which in turn has a subpackage called  and a module within that subpackage called
p50840
as(dp50841
g16
V100297
p50842
stp50843
a((dp50844
g2
(lp50845
VYou should be using the  package instead
p50846
aVThe  module was removed for the z3c
p50847
aVform 2
p50848
ag2176
aV0 release in October 2011
p50849
aVWhen using , replace your import with:
p50850
as(dp50851
g16
V100297
p50852
stp50853
a((dp50854
g2
(lp50855
VThe default representation of any Python container is to use the  output of the contents, not
p50856
aVThe solution would be for you to either give the  instance a  method (you can monkey-patch that in), or to use a subclass of  that uses  instead of  when displaying the contents
p50857
aVMonkey-patching in a  could be as simple as:
p50858
aVOf course, if this is your own code, just define a  method in the class body itself
p50859
as(dp50860
g16
V100297
p50861
stp50862
a((dp50863
g2
(lp50864
VSlice the string and reassign it to the same position in your list:
p50865
as(dp50866
g16
V100297
p50867
stp50868
a((dp50869
g2
(lp50870
VUse the  function:
p50871
aVThe return value of  is a list of tuples with  values
p50872
aVis your current function,  is the calling frame, etc
p50873
aVThe  string is (by default) 1 line of source code, but if you pass a larger number to  more lines of context will be provided:
p50874
aVNote that gathering code context for each entry in the stack is somewhat costly; source files are read for each entry
p50875
aVSet the context to  if you are not using this feature
p50876
aVDemo:
p50877
as(dp50878
g16
V100297
p50879
stp50880
a((dp50881
g2
(lp50882
VUse the  library:
p50883
aVThe  method recognises a wide variety of date formats, and returns a  object
p50884
aVUse the  method if you want to format the result as a (uniform) string again:
p50885
aVDemo:
p50886
as(dp50887
g16
V100297
p50888
stp50889
a((dp50890
g2
(lp50891
VPython supports triple-quoted strings:
p50892
aVShell supports only single-quoted strings:
p50893
aVBy using four quotes,  sees that as 2 empty strings, but Python sees the first three as the start of a triple-quoted string, and includes the fourth as part of the string value
p50894
aVThe rest of the line is then interpreted as a command by , but as part of a string by Python
p50895
aVThe  then forms a comment as far as  is concerned, but it is still a string to Python, closing it off with a closing triple-quote
p50896
aVSo, to summarize:
p50897
aVsees: empty string () - empty string () - command () - comment ()
p50898
aVPython sees: triple-quoted string literal (containing the characters )
p50899
aVSo  executes that command, replacing itself with the  with the script name and the rest of the command line arguments, and Python reads this file and just sees an initial string literal that isn't going anywhere
p50900
aVBecause it is the first string literal in the file, it'll be set as the docstring for the  module but that is hardly going to matter if this is the main script
p50901
as(dp50902
g16
V100297
p50903
stp50904
a((dp50905
g2
(lp50906
VUse :
p50907
aVYour version generated permutations instead
p50908
as(dp50909
g16
V100297
p50910
stp50911
a((dp50912
g2
(lp50913
VUse :
p50914
aVor a simple loop:
p50915
as(dp50916
g16
V100297
p50917
stp50918
a((dp50919
g2
(lp50920
VPython uses 0-based indexing, making  out of range
p50921
aVThe pseudo-code uses 1-based indexing
p50922
aVYou need to decrease both your indices by one:
p50923
aVand
p50924
as(dp50925
g16
V100297
p50926
stp50927
a((dp50928
g2
(lp50929
VYou split the whole file by tabs, resulting in a single list of strings
p50930
aVYou then loop over that list, assigning  (individual strings) to a long list of variables
p50931
aVFrom your error message, you are trying to assign a 4-character string to those variables, leading to individual characters being assigned, which fails because the number of characters doesn't match the number of variables
p50932
aVMost likely, you want to process a tab-delimited file
p50933
aVUse the  module for such tasks:
p50934
aVBecause the file has headers, you can also use a  and use dictionaries instead (keyed with the headers):
p50935
aVNot all rows have all values; some appear to be missing Nucleotide_Sequence and Protein_Sequence columns
p50936
aVFor future reference, you can loop directly over a python list, there is no need to use indices with a :
p50937
as(dp50938
g16
V100297
p50939
stp50940
a((dp50941
g2
(lp50942
VUse the  built-in function to pair values of two lists:
p50943
aVIf you wanted to combine each element from row1 with each element of row2 instead (the product of the two lists), use  instead:
p50944
aVsimply pairs up the lists producing  items,  pairs up each element in one list with each element in the other, producing  times  items:
p50945
as(dp50946
g16
V100297
p50947
stp50948
a((dp50949
g2
(lp50950
VYour CSV is created, but you are using a relative file path
p50951
aVYou'd have to print  to know where it is being created, or set the current working directory to where you expect your file to appear
p50952
aVBest to use an absolute file path instead:
p50953
as(dp50954
g16
V100297
p50955
stp50956
a((dp50957
g2
(lp50958
VUse a  object to gather your ids, and  to generate them:
p50959
aVNote that I lowercase the sentence and strip any leftover punctuation
p50960
aVResult:
p50961
aVThis uses 0-based indexing (like everything in Python)
p50962
aVIf you have to count from 1, tell  to start counting from there:
p50963
as(dp50964
g16
V100297
p50965
stp50966
a((dp50967
g2
(lp50968
VWhen you execute a python file with  you are executing it in the current namespace
p50969
aVThe REPL namespace is a built-in module:
p50970
aVwhich means there is no sourcefile for  to retrieve:
p50971
aVYour next problem is that because you use  the module set for your code is always going to be wrong
p50972
aVcannot determine where you defined the code, as  bypasses the normal import mechanisms:
p50973
aVAt no point does your code work with  unless you run it directly from a file that has the same source code
p50974
aVOn some platforms it may appear to work because  ends up triggering code that sets the  attribute of the current module
p50975
aVThe only way you actually make this work is to
p50976
aVCreate a fake module object in  and give it a  attribute that points to
p50977
aVPass in a namespace to  that sets  to match the fake module object
p50978
aVDemo:
p50979
aVJust to make it explicit, creating a copy of  only prevents  from modifying your current module namespace (or your REPL namespace)
p50980
aVThere is otherwise no difference between the dictionaries being passed to
p50981
as(dp50982
g16
V100297
p50983
stp50984
a((dp50985
g2
(lp50986
VYou are looking for the  boolean operator instead:
p50987
aVis JavaScript, Java, Perl, PHP, Ruby, Go, OCaml, Haskell, MATLAB, R, Lasso, ColdFusion, C, C#, or C++ boolean syntax instead
p50988
as(dp50989
g16
V100297
p50990
stp50991
a((dp50992
g2
(lp50993
VYou are looking at a Python literal representation of the number, which just indicates that it is a python  integer
p50994
aVThis is normal
p50995
aVYou do not need to worry about that
p50996
aVIf you need to print such a number, the  will not normally be there
p50997
aVWhat happens is that the Python interpreter prints the result of  on all return values of expressions, unless they return , to show you what the expression did
p50998
aVUse  if you want to see the string result instead:
p50999
as(dp51000
g16
V100297
p51001
stp51002
a((dp51003
g2
(lp51004
VYou are ignoring the return value of the recursive call, add a  there:
p51005
aVWithout the  statement there, your function just ends and returns  instead
p51006
aVThe return value of the recursive call is otherwise ignored
p51007
aVWith the  statement, your code works:
p51008
as(dp51009
g16
V100297
p51010
stp51011
a((dp51012
g2
(lp51013
VA Python list always shows the contents as representations, calling  on the objects
p51014
aVYou can hook into that by specifying a  method as well
p51015
aVAlternatively, don't print the list directly, but only the contents:
p51016
aVor join them as a long string:
p51017
aVDo make sure you actually return a value from your  method though:
p51018
aVbecause it is the return value that is printed by
p51019
as(dp51020
g16
V100297
p51021
stp51022
a((dp51023
g2
(lp51024
VSimply return the negative number:
p51025
aVThis reverses the  sort order, but do note that the data is sorted on column  first
p51026
aVNote that you can combine the sorting with the previous line in your code by using the  function:
p51027
as(dp51028
g16
V100297
p51029
stp51030
a((dp51031
g2
(lp51032
VYou are mixing tabs and spaces
p51033
aVDon't do that
p51034
aVRun your script with  then fix the errors that finds
p51035
aVNext, configure your editor to only use spaces:
p51036
aVView -> Indentation -> Indent Using Spaces
p51037
aVView -> Indentation -> Tab Width: 4
p51038
aVView -> Indentation -> Convert Indentation to Spaces
p51039
aVand perhaps set that as the default for Python
p51040
aVSee Indentation settings in the Sublime Text 2 documentation
p51041
as(dp51042
g16
V100297
p51043
stp51044
a((dp51045
g2
(lp51046
VYou want to parse the command line arguments instead of reading input after the program starts
p51047
aVUse the  module for that, or parse  yourself
p51048
as(dp51049
g16
V100297
p51050
stp51051
a((dp51052
g2
(lp51053
VThe  function is basically a class factory
p51054
aVBuild that class once at the module level:
p51055
aVthen import  everywhere instead
p51056
aVIt's just a class, you don't have to re-create that class every time you want to build the tuple
p51057
as(dp51058
g16
V100297
p51059
stp51060
a((dp51061
g2
(lp51062
VGroup one is always found because you allow empty matches
p51063
aVYou want to match at least one character, not 0 or more, so use :
p51064
aVNow the match will throw an exception if group one is missing
p51065
aVMake use of that:
p51066
aVThe alternative is to use a function to do the replacement:
p51067
aVDemo:
p51068
as(dp51069
g16
V100297
p51070
stp51071
a((dp51072
g2
(lp51073
VThe index server failed to respond, the connection timed out
p51074
aVThis happens when PyPI is down, for example
p51075
aVBy default, the index server is , but you can set your own with the  option
p51076
aVWe use an egg proxy (set up with ) to create a local cache automatically, to avoid such problems
p51077
aVOur buildouts use that server as the index, and the proxy will download any missing packages from PyPI and cache them locally
p51078
aVSo, for any packages that we have used in the past, we can continue to serve even when PyPI is (temporarily) down
p51079
as(dp51080
g16
V100297
p51081
stp51082
a((dp51083
g2
(lp51084
VTo convert your inputs to , use  as a function
p51085
aVIt returns the converted value:
p51086
aVYour code instead assigned first , then  to a local name , masking the built-in
p51087
aVYour next problem will be that you didn't give the user any chance to enter text into your program
p51088
aVI recommend you read up on some TKinter GUI tutorials some more; not until you start the main loop does your end user get to interact with your UI and enter text
p51089
as(dp51090
g16
V100297
p51091
stp51092
a((dp51093
g2
(lp51094
VFirst of all, the Python 2  type has been renamed to  in Python 3, and byte literals use the  prefix
p51095
aVThe Python 2  type is the new Python 3  type
p51096
aVTo get the Python 3 file behaviour in Python 2, you'd use  or ; Python 3 decodes text files to Unicode by default
p51097
aVWhat you see is that for binary files, Python 3 gives you the exact same thing as in Python 2, namely byte strings
p51098
aVWhat changed then, is that the  of a byte string is prefixed with  and the  function will use the  representation of any object passed to it except for unicode values
p51099
aVTo print your binary data as unicode text with the  function
p51100
aV, decode it to unicode first
p51101
aVBut then you could perhaps have opened the file as a text file instead anyway
p51102
aVThe  type has some other improvements to reflect that you are dealing with binary data, not text
p51103
aVIndexing individual bytes or iterating over a  value gives you  values (between 0 and 255) and not characters, for example
p51104
as(dp51105
g16
V100297
p51106
stp51107
a((dp51108
g2
(lp51109
VSure, just have your property set an instance attribute that is returned on subsequent access:
p51110
aVThe  descriptor is a data descriptor (it implements ,  and  descriptor hooks), so it'll be invoked even if a  attribute exists on the instance, with the end result that Python ignores that attribute, hence the need to test for a separate attribute on each access
p51111
aVYou can write your own descriptor that only implements , at which point Python uses an attribute on the instance over the descriptor if it exists:
p51112
aVIf you prefer a  approach (which has something to say for it), that'd be:
p51113
aVSubsequent access will find the  attribute on the instance and  won't be consulted
p51114
aVDemo:
p51115
as(dp51116
g16
V100297
p51117
stp51118
a((dp51119
g2
(lp51120
V throws an  because  is empty:
p51121
aVYou'll need to figure out why  is empty when running under
p51122
aVPerhaps you are counting on filesystem access to python files that  has zipped up into an archive for distribution
p51123
as(dp51124
g16
V100297
p51125
stp51126
a((dp51127
g2
(lp51128
VUse the  function with a generator expression:
p51129
aVThe function will loop over the generator expression until a true-ish value is returned, after which itself returns
p51130
aVIf no such value is found,  is returned instead
p51131
aVThis is very efficient, as it will only test as many  values as needed to determine that there is one that matches
p51132
as(dp51133
g16
V100297
p51134
stp51135
a((dp51136
g2
(lp51137
VNo, it cannot
p51138
aVPython package and module names need to be valid identifiers:
p51139
aVIdentifiers must start with a letter or an underscore
p51140
aVThe import statement defines the grammar for modules as:
p51141
aVPackages are a special kind of module (implemented as a directory with  file) and are not exempt from these rules
p51142
aVTechnically you can work around this by not using the  statement, as the  module and  hook do not enforce the restriction
p51143
aVIt is however not a good idea to name your package or module such that you need to use non-standard import mechanisms to make it work
p51144
as(dp51145
g16
V100297
p51146
stp51147
a((dp51148
g2
(lp51149
VYour  and  submodules are not visible until explicitly imported somewhere
p51150
aVYou can import them in the  package file:
p51151
aVat which point they become available for import from
p51152
aVAnother option is to import the modules from your own code:
p51153
aVOnly when explicitly imported are submodules also set as attributes of the package
p51154
as(dp51155
g16
V100297
p51156
stp51157
a((dp51158
g2
(lp51159
VYou assigned the conversion to  to the wrong name:
p51160
aVis still a string
p51161
aVAssign the conversion to  instead:
p51162
as(dp51163
g16
V100297
p51164
stp51165
a((dp51166
g2
(lp51167
VI would not close the underlying stream
p51168
aVPassing in an already open file object means the caller has taken responsibility of that object and closing that object on  would be extremely annoying, at best
p51169
aVPIL does something similar, albeit not in a context manager
p51170
aVWhen passing in a filename, it'll close the fileobject after it completes reading the image data
p51171
aVIt sets a boolean flag just for that
p51172
aVPass in a file object instead and it'll read but not close
p51173
aVI'd do the same here:
p51174
as(dp51175
g16
V100297
p51176
stp51177
a((dp51178
g2
(lp51179
VUse  objects instead:
p51180
aVObjects in a set need to be immutable to be hashable
p51181
aVobjects are mutable, but  are not
p51182
aVThey are to s what s are to s
p51183
aVIf you were instead trying to create a union of all the sets, then just create a new, empty set and pass your generator expression to that:
p51184
aVThis builds one set with the union of all your matched sets
p51185
aVDemos against your test input:
p51186
aVBecause  is a dictionary, you can do this a little faster still by using dictionary view objects:
p51187
aVor if you are using Python 3,  returns a view objects by default:
p51188
as(dp51189
g16
V100297
p51190
stp51191
a((dp51192
g2
(lp51193
VYou are not matching the initial space; you also want to group the date for easy extraction, and limit the  and  patterns to non-greedy:
p51194
aVDemo:
p51195
aVYou can narrow down the pattern some more; you only need to match 3 letters for the month for example:
p51196
as(dp51197
g16
V100297
p51198
stp51199
a((dp51200
g2
(lp51201
VYou appear to be using recursive programming but you are not understanding how that should work
p51202
aVYou are calling your function recursively, but recursive counting requires you to divide your problem into subproblems; solve one and delegate the rest to the recursive call, or split up the set into subproblems until you have a small set you know how to solve
p51203
aVYou however are trying to solve the subproblem for all elements in the list instead, then passing the whole list to the recursive call
p51204
aVThis just leads to an infinite recursion exception because you only ever look at the same problem set
p51205
aVA recursive version would be:
p51206
aVThis just looks at the first element and delegates counting of the rest of the list to the recursive call
p51207
aVIf the list is empty, 0 is returned
p51208
aVSubdividing up the list into halves is another option, returning only when the list is empty or has just one element:
p51209
aVIf you wanted to loop over the list and count that way (without recursion), increment  and only return when you completed the loop:
p51210
aVHowever, the simplest solution is to use the standard  function:
p51211
aVand be done with it
p51212
as(dp51213
g16
V100297
p51214
stp51215
a((dp51216
g2
(lp51217
VBecause the first calculation does not return exactly 2
p51218
aV0:
p51219
aVlimits floating point display to 12 significant digits only, causing the value to be rounded to 2
p51220
ag2391
as(dp51221
g16
V100297
p51222
stp51223
a((dp51224
g2
(lp51225
VYou need to implement  and  methods to teach Python about how to recognise unique  instances
p51226
aVNow your object is comparable, and equal objects will also return equal values for
p51227
aVThis lets  and  objects store your objects efficiently and detect if it is already present:
p51228
as(dp51229
g16
V100297
p51230
stp51231
a((dp51232
g2
(lp51233
VYou return the first item only
p51234
aVJoin the results:
p51235
aVThis joins all key-value pairs with newlines, but you can pick any join string you like, including the empty string
p51236
aVDemo:
p51237
aVJust take into account that dictionaries have no fixed ordering, depending on the insertion and deletion history of your dictionary the output order can differ
p51238
as(dp51239
g16
V100297
p51240
stp51241
a((dp51242
g2
(lp51243
VFor splitting a multi-line string on newlines, you would normally use  instead, which handles different newline conventions:
p51244
aVNote that  only gives you the first line in any case; for multi-line input you probably want to read from  instead:
p51245
aVor read lines in a loop:
p51246
as(dp51247
g16
V100297
p51248
stp51249
a((dp51250
g2
(lp51251
VYou would have to make it a global; local variables in functions are not accessible, nested or otherwise
p51252
aVJust accessing  as a global works just fine:
p51253
aVTo change  within a function scope, declare it a global with the  keyword
p51254
as(dp51255
g16
V100297
p51256
stp51257
a((dp51258
g2
(lp51259
VUse :
p51260
aVDemo:
p51261
aVThe  utility function groups sequences by a key; here by wether or not the values are greater than 4 or not; each iteration gives us a sequence of values that are one or the other  If the values in the current group are indeed greater we print them on seperate lines, otherwise they are joined again into one string with semicolons
p51262
as(dp51263
g16
V100297
p51264
stp51265
a((dp51266
g2
(lp51267
VYou do not have enough data on the SPOJ timings
p51268
aVThe codechef timings all look too close to call to me
p51269
aVAny timing difference between one  call and one  call are going to come down to differences in swap availability, other processes running on the machine, I/O flushes, etc
p51270
aVIn other words, not to any actual performance differences between the two approaches
p51271
aVYou'll have to do your own timings, on your own machine, against thousands of runs to be able to figure out if one is actually faster than the other
p51272
as(dp51273
g16
V100297
p51274
stp51275
a((dp51276
g2
(lp51277
VYou are looking at the Python representation of objects, not strings
p51278
aVEach element in the list is an instance of the  class
p51279
aVThese objects have an  attribute, simply refer to the attribute directly:
p51280
aVOther attributes are  for other releases,  for the release title, etc
p51281
as(dp51282
g16
V100297
p51283
stp51284
a((dp51285
g2
(lp51286
VYou need to determine the time anew in your loop
p51287
aVThe  variable is static, it does not update to reflect changing time
p51288
aVIf you want to loop for a certain amount of time, start with  instead and then calculate elapsed time:
p51289
aVwill print 'test' every 5 seconds for 5 minutes (300 seconds)
p51290
aVYou can do the same with  objects of course, but the  call is a little simpler to work with
p51291
aVTo loop until a certain time  can be used like:
p51292
aVAgain, note that the loop needs to call a method each time to determine what the current time is
p51293
as(dp51294
g16
V100297
p51295
stp51296
a((dp51297
g2
(lp51298
VFile objects (be they temporary or otherwise) cannot be read multiple times without re-positioning the file position back to the start
p51299
aVYour options are:
p51300
aVTo reopen the file multiple times, creating multiple file objects for the same file
p51301
aVTo rewind the file object before each read
p51302
aVTo reopen the file, use a  and use a regular  call to re-open the same filename several times
p51303
aVYou probably will want to pass  to the constructor, especially on Windows, to be able to do this
p51304
aVTo rewind, call  on the file object
p51305
as(dp51306
g16
V100297
p51307
stp51308
a((dp51309
g2
(lp51310
VIf you want to traverse dictionaries, use a loop:
p51311
aVor use :
p51312
aVthen use either version as:
p51313
aVNote that either version takes a variable number of arguments to let you pas 0 or more keys as positional arguments
p51314
aVDemos:
p51315
aVAnd to clarify your error message: You passed the expression  to your function call, which defines a list with one element (), which you then try to index with , a string
p51316
aVList indices can only be integers:
p51317
as(dp51318
g16
V100297
p51319
stp51320
a((dp51321
g2
(lp51322
VA  object does not make a copy of a string passed to it
p51323
aVThere is no need to, as strings are not mutable
p51324
aVWhen reading data from a  object in chunks, new string objects are created that are substrings from the original input string
p51325
aVMemory consumption never goes down immediately when freeing objects
p51326
aVMemory allocation is only redistributed as needed by the OS, and many types of (small) objects can be interned by Python for efficiency and are never freed, only reused
p51327
as(dp51328
g16
V100297
p51329
stp51330
a((dp51331
g2
(lp51332
VUse a regular expression to match specific text contents:
p51333
aVDemo:
p51334
as(dp51335
g16
V100297
p51336
stp51337
a((dp51338
g2
(lp51339
VJust pass in a callable that gets the first element of each item
p51340
aVUsing  is easiest:
p51341
aVbut if you have to test against integer values instead of lexographically sorted items, a lambda might be better:
p51342
aVWhich one you need depends on what you expect the maximum to be for strings containing digits of differing length
p51343
aVIs  smaller or larger than
p51344
aVDemo:
p51345
aVor showing the difference between  and a  with :
p51346
as(dp51347
g16
V100297
p51348
stp51349
a((dp51350
g2
(lp51351
VIt is a binary format with embedded ASCII strings
p51352
aVIt is a proprietary format, you'd have to parse the C data structures yourself using  and a lot of code
p51353
aVPerhaps you'd be better off converting the format or using a 3rd-party Python library; Convert the file to the  format (usable with matlab) with this script (Python code, uses ):
p51354
aVwould produce a  file
p51355
as(dp51356
g16
V100297
p51357
stp51358
a((dp51359
g2
(lp51360
VNo, but you can get the same data from your database by using  commands and querying the system tables
p51361
aVis just listing the  tool commands
p51362
aVno point in making those work in Python
p51363
aVuses  and the system tables to show you the schema, formatted as SQL commands
p51364
aVJust use the output from the queries to format your data with print statements or the  module to output CSV data
p51365
as(dp51366
g16
V100297
p51367
stp51368
a((dp51369
g2
(lp51370
VJust use a loop:
p51371
aVDictionaries are mutable, adding a key is reflected in all references to the dictionary
p51372
aVDemo:
p51373
as(dp51374
g16
V100297
p51375
stp51376
a((dp51377
g2
(lp51378
V expects a sequence, better give it a one-element tuple:
p51379
aVA Python string is a sequence too, one of individual characters
p51380
aVSo the  call tried to treat each separate character as a parameter for your query, and unless your string is one character short that means it'll not provide the right number of parameters
p51381
aVDon't forget to commit your inserts:
p51382
aVor use the database connection as a context manager:
p51383
as(dp51384
g16
V100297
p51385
stp51386
a((dp51387
g2
(lp51388
VYou only registered your package, but did not upload anything
p51389
aVRun  to do so; for a pure python package a source distribution is all you need
p51390
aVYou may want to read the PyPI howto for more details
p51391
as(dp51392
g16
V100297
p51393
stp51394
a((dp51395
g2
(lp51396
VUse  to generate all permutations of a list:
p51397
aVbut you really want to rethink your data structure
p51398
aVIf you made your keys  objects instead, you simply would test for:
p51399
aVwhich would be a lot faster
p51400
aVDemos:
p51401
as(dp51402
g16
V100297
p51403
stp51404
a((dp51405
g2
(lp51406
VUse the  module, included with Python:
p51407
as(dp51408
g16
V100297
p51409
stp51410
a((dp51411
g2
(lp51412
VYou need to use Python 2
p51413
aV7 or newer for the syntax to work
p51414
aVOn older versions, use:
p51415
aVNote that if you had read the answer by jamylak, you would already have known this
p51416
aV:-)
p51417
as(dp51418
g16
V100297
p51419
stp51420
a((dp51421
g2
(lp51422
VAPass in a index to your command function using the  function:
p51423
aVMake sure that you pass the index as a keyword parameter to bind the value when defining the lambda (a closure would use the last value of )
p51424
aVtakes a second argument, the index to start at, which defaults at 0
p51425
as(dp51426
g16
V100297
p51427
stp51428
a((dp51429
g2
(lp51430
VUse  to print formatted representations that are usually not that wide
p51431
aVYou'll have to use your terminal functionality to search though
p51432
aVUse Python itself to search through dictionaries:
p51433
aVwould find a key-value pair where  is contained in the key value
p51434
aVYou may want to look into an alternative shell such as iPython, or an alternative terminal for Windows that offers a little more functionality over the bare-bones CMD
p51435
as(dp51436
g16
V100297
p51437
stp51438
a((dp51439
g2
(lp51440
VYou need to fix your print statment:
p51441
aVor use string concatenation:
p51442
aVor string formatting:
p51443
aVYour code will then go into an infine loop recalculating the same value for  over and over again, as random values are not recalculated each time
p51444
aV, ,  and  are static, they do not reference a function call they reference the return value of one call to  each
p51445
aVYou can simplify your code using a loop, which does recalculate  based on new random values each time:
p51446
as(dp51447
g16
V100297
p51448
stp51449
a((dp51450
g2
(lp51451
VYou only need to state an identifier is global when you are changing it in a function
p51452
aVIf you only reference  and  and not assign to them, you can omit the  statements
p51453
aVFunctions are globals too, for example
p51454
aVis not being assigned to, only referenced, and you didn't need to use  to be able to do so
p51455
aVPython uses different opcodes to assign to locals versus globals
p51456
aVIf you do:
p51457
aVversus
p51458
aVPython uses two different operations to update  as a local or a global
p51459
aVMore generally speaking, you want to avoid using globals to pass around state
p51460
aVPass values as parameters (using primitives, or a compound structure such as a dictionary or a custom class instance) around instead
p51461
aVIt makes your code easier to read and debug as you can trace the state through the functions instead of having to keep track of a global separately
p51462
as(dp51463
g16
V100297
p51464
stp51465
a((dp51466
g2
(lp51467
VIf you want to post JSON, encode the JSON data structure, jQuery does not do that for you:
p51468
aVSee Serializing to JSON in jQuery
p51469
as(dp51470
g16
V100297
p51471
stp51472
a((dp51473
g2
(lp51474
VYou have a list, not an iterator
p51475
aVJust slice it instead:
p51476
aVor skip that first row when you still have an actual  object:
p51477
aVYou'd be better off returning the  object instead of reading all rows into memory there; unless you absolutely need random access to the rows
p51478
aVYou also should really use the  function instead as it works for Python 2
p51479
aV6+ and 3, where the iterator  method has been renamed to
p51480
aVYou'd otherwise never use , because  on a  iterator returns one row
p51481
as(dp51482
g16
V100297
p51483
stp51484
a((dp51485
g2
(lp51486
VRead both files into lists, then use  to combine them:
p51487
aV  with open('params
p51488
aVtxt') as paramfile:
p51489
aV    parameters = [line
p51490
aVstrip() for line in paramfile]
p51491
as(dp51492
g16
V100297
p51493
stp51494
a((dp51495
g2
(lp51496
VYou are printing the return value of your function, and printing inside the function
p51497
aVRemove the  statement you are using to print the return value of the call
p51498
aVWhere you do:
p51499
aVremove the :
p51500
aVA function in Python always has a return value, even if you do not use a  statement, defaulting to :
p51501
aVThe alternative is to not use  in your function, but return a string instead:
p51502
as(dp51503
g16
V100297
p51504
stp51505
a((dp51506
g2
(lp51507
VYou are missing a closing parethesis:
p51508
aVPython cannot detect the missing parenthesis until the next line, where the  statement is unexpected
p51509
aVYou only need one pair of parenthesis there:
p51510
aVYou also do not need to call  to do a membership test on a dictionary:
p51511
aVis enough
p51512
aVYou probably want to loop directly over the  list and use  instead:
p51513
aVor switch to using a generator expression:
p51514
aVUse  if you are using Python 3;  in Python 2 and  in Python 3 return dictionary view objects which, for keys at least, act like sets
p51515
as(dp51516
g16
V100297
p51517
stp51518
a((dp51519
g2
(lp51520
VCreate a dictionary mapping month to an ordinal:
p51521
aVand use that to sort:
p51522
aVDemo:
p51523
aVTo sort on month first, year second, return a tuple from the key function:
p51524
aVDemo:
p51525
aVIn this specific case there is no difference because the per-month data is already in sorted order
p51526
as(dp51527
g16
V100297
p51528
stp51529
a((dp51530
g2
(lp51531
VThe read position in a file is a simple index maintained by the OS kernel; there is no physical head movements involved
p51532
aVThe C code subtracting 10 from the current position or you calculating the new position in python will make very little difference
p51533
as(dp51534
g16
V100297
p51535
stp51536
a((dp51537
g2
(lp51538
VYour code loops over the string , one individual character at a time; here the character  is larger than  because it's ASCII codepoint is higher
p51539
aVAt no point do you actually build a  list of numbers
p51540
aVUse a list to append numbers to:
p51541
aVThen loop over  to calculate the min and max
p51542
aVBonus tip: set your  and  names to  and  respectively, instead of
p51543
aVThis simplifies your tests for the minimum and maximum because these two values are guaranteed to be the largest and smallest numbers:
p51544
aVNote that you can do both tests in one loop
p51545
as(dp51546
g16
V100297
p51547
stp51548
a((dp51549
g2
(lp51550
Vwill tell you what command is found on the path first;  will list all Python commands found on your path
p51551
aVSee the  manpage for more details
p51552
aVwill tell you what the version is for that command
p51553
as(dp51554
g16
V100297
p51555
stp51556
a((dp51557
g2
(lp51558
VThe file  does not exist in your present working directory, which is most likely the  folder
p51559
aVWithout a full path, Python looks in the current working directory, and what that is depends on the way your program was started and if any calls to  were made to change the current working directory
p51560
aVUse a full path to your archive file:
p51561
aVwhere  is set to the full path of the folder where  is located
p51562
aVNote that you can save yourself a loop if all you do is append the rows from your CSV to ; the following will do that in one command:
p51563
as(dp51564
g16
V100297
p51565
stp51566
a((dp51567
g2
(lp51568
VUse a list comprehension:
p51569
aVThere is also the option to use multiplication:
p51570
aVbut that creates a list of 3 references to the same nested list:
p51571
aVwhich is usually not what you want
p51572
aVThe list comprehension re-evaluates the expression on the left hand side (the part before the  expression) for each loop iteration and that creates a new list for each index in the outer list:
p51573
aVIf you want to use a list stored in a variable to repeat, make sure you create a copy on each iteration:
p51574
as(dp51575
g16
V100297
p51576
stp51577
a((dp51578
g2
(lp51579
VThe behaviour you see is normal
p51580
aVYou have a UTF-8 encoded byte string, and when printing a list, Python will always show such strings as Python string literals in their most portable form
p51581
aVYou really want to use Unicode values, and print individual items from the list:
p51582
aVIf you don't yet know the difference between Unicode and a byte string or anything much about codecs, I urge you to read:
p51583
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p51584
aVby Joel Spolsky
p51585
aVThe Python Unicode HOWTO
p51586
aVPragmatic Unicode by Ned Batchelder
p51587
aVbefore you continue
p51588
as(dp51589
g16
V100297
p51590
stp51591
a((dp51592
g2
(lp51593
VYou are inserting text into an XML element
p51594
aVText always will be escaped to be XML-safe
p51595
aVIf you wanted to add a new tag, create a new ; the  factory is easiest:
p51596
aVIf you wanted to wrap the contents of the , simply move all elements over (plus the  attribute:
p51597
aVDemo:
p51598
as(dp51599
g16
V100297
p51600
stp51601
a((dp51602
g2
(lp51603
VIt appears you have written Python lists directly to your CSV file, resulting in the  literal syntax instead of normal columns
p51604
aVYou then removed most of the information that could have been used to turn the information back to Python lists with unicode strings again
p51605
aVWhat you have left are Python unicode literals, but without the quotes
p51606
aVUse the  to decode the values to Unicode again:
p51607
aVor add back the  quoting, using a triple-quoted string in an attempt to avoid needing to escape embedded quotes:
p51608
aVIf you still have the original file (with the  formatted lines), use the  function to turn those back into Python lists
p51609
aVNo point in using the CSV module here:
p51610
aVDemo with :
p51611
as(dp51612
g16
V100297
p51613
stp51614
a((dp51615
g2
(lp51616
VYou need to pass in unicode text:
p51617
aVDo make sure you use the  comment at the top, and make sure your text editor is actually using that codec
p51618
aVIf your editor saves the file as Latin-1 encoded text, use that codec in the header, etc
p51619
aVThe comment communicates to Python how to interpret your source file, especially when it comes to parsing string literals
p51620
aVAlternatively, use escape codes for anything non-ASCII in your Unicode literals:
p51621
aVand avoid the issue of what codec to use in the first place
p51622
aVI urge you to read:
p51623
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p51624
aVby Joel Spolsky
p51625
aVThe Python Unicode HOWTO
p51626
aVPragmatic Unicode by Ned Batchelder
p51627
aVbefore you continue
p51628
as(dp51629
g16
V100297
p51630
stp51631
a((dp51632
g2
(lp51633
VYou don't and do not need to
p51634
aVPython lists grow and shrink dynamically as needed to fit their contents
p51635
aVSets are implemented as a hash table, and like Python dictionaries grow and shrink dynamically as needed to fit their contents
p51636
aVPerhaps you were looking for  (which takes a  parameter) or something using a  (using  when you have reached the maximum) instead
p51637
as(dp51638
g16
V100297
p51639
stp51640
a((dp51641
g2
(lp51642
VUse a nested list comprehension:
p51643
aVThis produces a list of lists containing byte strings of UTF-8 encoded data
p51644
aVIf you were to print these lists, you'll see Python represent the contents of the Python byte strings as Python literal strings; with quotes and with any bytes that aro not printable ASCII  codepoints represented with escape sequences:
p51645
aVThis is normal as Python presents this data for debugging purposes
p51646
aVThe  and  escape sequences represent the two UTF-8 bytes C39F (hexadecimal) that are used to encode the small ringel-es character
p51647
as(dp51648
g16
V100297
p51649
stp51650
a((dp51651
g2
(lp51652
VJust alter your  variable first, and only write when you are done with your replacements:
p51653
aVNote that now there is only one  call
p51654
aVYou can even chain the  calls:
p51655
aVFor one-character replacements, you may want to consider the  method, combined with the  helper function:
p51656
as(dp51657
g16
V100297
p51658
stp51659
a((dp51660
g2
(lp51661
VYou are printing the EXIF dictionary, which is keyed on EXIF numeric tags
p51662
aVYou'll either need to know the numeric tag of the entry you are looking for or use the  mapping to translate the numbers to human-readable strings:
p51663
aVYou'll still need to figure out which tagname to use
p51664
as(dp51665
g16
V100297
p51666
stp51667
a((dp51668
g2
(lp51669
VBuildout and virtualenv can work just fine together
p51670
aVUpload your , your  and use the virtualenv python to run the  script
p51671
aVKenneth Reitz (of  fame, and Heroku's Python guy) has created a buildpack that does just that
p51672
as(dp51673
g16
V100297
p51674
stp51675
a((dp51676
g2
(lp51677
VUse string concatenation:
p51678
aVor use string formatting:
p51679
aVor
p51680
as(dp51681
g16
V100297
p51682
stp51683
a((dp51684
g2
(lp51685
VDon't use
p51686
aVUse the  module instead:
p51687
as(dp51688
g16
V100297
p51689
stp51690
a((dp51691
g2
(lp51692
V gives you the direct, unprocessed raw data as stored on the object
p51693
aVThe  methods are allowed to transform that data in some way as needed
p51694
aVFor example,  fields will transform text to safe HTML when using , but  gives you the untransformed data, be that markdown, restructuredtext or unprocessed HTML
p51695
aVFrom the developer documentation:
p51696
aVArchetypes has two kinds of access methods:
p51697
aVnormal, , which filters output;
p51698
aVraw, the so-called edit accessor,  which does not filter output
p51699
aVWhen you want to edit the current contents of a field, use , when rendering the contents, use
p51700
aVSpecifically, related items are stored in a reference field, where the  method returns object UIDs, the  method returns objects, having first resolved the UIDs for you
p51701
aVImage fields, like file fields, will wrap the data in the associated object type ( for image fields) if not already that type when using  but return whatever the underlying storage has got for
p51702
aVUsually the object is already wrapped though
p51703
as(dp51704
g16
V100297
p51705
stp51706
a((dp51707
g2
(lp51708
VThe  function takes only one string argument (and not multiple, like )
p51709
aVUse string formatting:
p51710
aVThe  placeholders are replaced by the two arguments to , creating essentially the same string to prompt the user for input
p51711
aVSee the  method documentation for more details
p51712
as(dp51713
g16
V100297
p51714
stp51715
a((dp51716
g2
(lp51717
VYou gave your script a name of a standard module or something else that is imported by the  package
p51718
aVYou created a circular import
p51719
aVBecause  didn't complete importing the first time you get to see these differences in the list of supported objects
p51720
aVDon't do that
p51721
aVRename your script to something else and it'll all work
p51722
as(dp51723
g16
V100297
p51724
stp51725
a((dp51726
g2
(lp51727
VYou can use the Python Imaging Library to convert RGB datapoints to most standard formats
p51728
aVwhich produces:
p51729
aVThe  method can also take a format argument,  would fix the output to PNG
p51730
aV(I recommend you install the Pillow fork as it is more actively maintained and adds proper packaging and Python 3 support)
p51731
as(dp51732
g16
V100297
p51733
stp51734
a((dp51735
g2
(lp51736
VYour  string has an extra newline at the end
p51737
aVStrip it:
p51738
aVThis is quite normal for lines read from a file; the  escape sequence stands for a newline
p51739
as(dp51740
g16
V100297
p51741
stp51742
a((dp51743
g2
(lp51744
VYou are only removing references to the elements from your list
p51745
aVYou need to call  on the parent element instead
p51746
aVElementTree does not retain parent pointers; given a  element alone you cannot go back the  element that is its parent
p51747
aVThis means you need to retain a reference to the parent as well
p51748
aVLoop over the  elements, then in a nested loop find the  elements you want to remove and with the  parent still available, call  to remove a child element from that parent
p51749
as(dp51750
g16
V100297
p51751
stp51752
a((dp51753
g2
(lp51754
VYou cannot do this in the regular console
p51755
aViPython keeps a copy of the source in case you want to see it again later on, but the standard Python console does not
p51756
aVHad you imported the function from a file, you could have used :
p51757
aVbut, just to be explicit,  will fail for functions entered in the interactive console:
p51758
aVbecause nothing in the interpreter retains the input (other than the readline library, which might save input history, just not in a format directly usable by )
p51759
as(dp51760
g16
V100297
p51761
stp51762
a((dp51763
g2
(lp51764
VYou don't need to worry about most of those modules
p51765
aVThe  module requires Tcl/Tk with headers, on a Debian-based system installing  is enough to satisfy the requirements
p51766
aVThe  module requires you to have a Sun audio device
p51767
aVYou don't have one, trust me
p51768
aVThe  modules are legacy modules
p51769
aVYou could install  to get some of these to compile, but I would not worry about these
p51770
aVThe  module will switch between available modules as needed, but almost all modern code has long since abandoned using DBM-like storage in favor of sqlite3
p51771
as(dp51772
g16
V100297
p51773
stp51774
a((dp51775
g2
(lp51776
VYou need to import the class from the module:
p51777
aVor refer to the class as an attribute of the module you imported:
p51778
aVThis is one reason for the Python style guide PEP-8 to recommend that you use all-lowercase names for your module files, to avoid confusing the module with the contents of the module
p51779
as(dp51780
g16
V100297
p51781
stp51782
a((dp51783
g2
(lp51784
VYou are missing a closing parenthesis:
p51785
aVPython cannot know that there is a parenthesis missing until the next line, where your  statement makes no sense as part of the  call
p51786
as(dp51787
g16
V100297
p51788
stp51789
a((dp51790
g2
(lp51791
V is a different operator in Python 3; in Python 2  alters behaviour when applied to 2 integer operands and returns the result of a floor-division instead:
p51792
aVAdd:
p51793
aVto the top of your code to make  use float division in Python 2, or use  to force Python 3 to use integer division:
p51794
aVUsing either of these techniques works in Python 2
p51795
aV2 or newer
p51796
aVSee PEP 238 for the nitty-gritty details of why this was changed
p51797
as(dp51798
g16
V100297
p51799
stp51800
a((dp51801
g2
(lp51802
VYou need to convert those months to date objects, then to time values:
p51803
aVJSON does not have a standard for representing datetime values; what you are describing are JavaScript timestamps instead
p51804
aVDemo:
p51805
as(dp51806
g16
V100297
p51807
stp51808
a((dp51809
g2
(lp51810
V is a list:
p51811
aVbut you then try to create a new range from that list:
p51812
aVwhere  is an attempt to add  to a list
p51813
aVDon't do that
p51814
aVJust loop over your existing range:
p51815
as(dp51816
g16
V100297
p51817
stp51818
a((dp51819
g2
(lp51820
VUse a  object to track what you already have seen:
p51821
aVNow  contains all the data you've seen, keyed on name, each value a list of matching lines
p51822
aVInstead of adding a line, you can store parsed information in the list
p51823
aVThis groups your data into a structure per name
p51824
as(dp51825
g16
V100297
p51826
stp51827
a((dp51828
g2
(lp51829
VYou have several problems with your code:
p51830
aVYou discard  each permutation loop iteration and re-create it from scratch
p51831
aVBuild it once:
p51832
aVbut for fast membership tests (), use a  instead:
p51833
aVNote that it is not clear why you need a dictionary with one key; a simple variable would do fine here
p51834
aVYou read a file but don't strip the newlines from the lines
p51835
aVWith a newline, your  test will never return True because the code that generates the
p51836
aVJust treat the file as an iterable, call  on it to get the next line:
p51837
aVor even:
p51838
aVYou are not really looking ahead
p51839
aVYou are looking behind; if the previous line matched a condition, the next line is appended
p51840
as(dp51841
g16
V100297
p51842
stp51843
a((dp51844
g2
(lp51845
V values are lists of 3 sets each:
p51846
aVYou need to read the previous answer more closely and pick the right set to call  on
p51847
aVThe previous answer loops over 4 elements in your input line, uses the first element to find the list of sets, and adds each of the other 3 elements to those sets:
p51848
aVPersonally, I'd use:
p51849
aVto achieve the same thing
p51850
as(dp51851
g16
V100297
p51852
stp51853
a((dp51854
g2
(lp51855
VYou could set up the LDAP connection to use a certificate instead of a password
p51856
aVRoss Patterson outlines the procedure, but the mailinglist post he links to is gone
p51857
aVThe same thread is however still available on GMane
p51858
as(dp51859
g16
V100297
p51860
stp51861
a((dp51862
g2
(lp51863
VYes,  and  both use  to retrieve HTTPS resources, which does not verify SSL certificates:
p51864
aVWarning: HTTPS requests do not do any verification of the server\u2019s certificate
p51865
aVYour  tool does verify certificates, but your local certificate authorities certificates are incomplete, it seems; see SSL certificate rejected trying to access GitHub over HTTPS behind firewall for instructions on how to update those
p51866
aVAs for your original error, it appears your firewall proxy is doing the peer resets
p51867
as(dp51868
g16
V100297
p51869
stp51870
a((dp51871
g2
(lp51872
VCount the tabs; if you presume that the note field never has 4 tabs on one line in it, you can collect the note until you find a line that does have 4 tabs in it:
p51873
aVThe above generator function will not yield a row until it is certain that there is no note continuing on the next line, effectively looking ahead
p51874
aVNow use the  function as a generator and loop over the results:
p51875
aVDemo:
p51876
as(dp51877
g16
V100297
p51878
stp51879
a((dp51880
g2
(lp51881
VSimply remove the items with the  filter:
p51882
aVDemo:
p51883
aVCalling  with  removes all 'empty' or numeric 0 items; anything that would evaluate to false in a boolean context
p51884
aVeats list comprehensions for breakfast:
p51885
as(dp51886
g16
V100297
p51887
stp51888
a((dp51889
g2
(lp51890
VTo test if a row was empty, just use it in a boolean context; empty lists are false
p51891
aVTo test if a string starts with some specific characters, use , which can take either a single string or a tuple of strings:
p51892
aVBecause you are really testing for fixed-width character strings, you can also just slice the first column and test with  against a sequence; a set would be most efficient:
p51893
aVHere the  slice notation returns the first character of the  column (or an empty string if that first column is empty)
p51894
aVI used the open file object as a context manager () so that Python automatically closes the file for us when the code block is done (or an exception is raised)
p51895
aVYou should never call double-underscore methods ("dunder" methods, or special methods) directly, the proper API call would be  instead
p51896
aVDemo:
p51897
as(dp51898
g16
V100297
p51899
stp51900
a((dp51901
g2
(lp51902
VJust try to parse it as a timestamp:
p51903
aVThe  test has the advantage that it guarantees that you have a valid datetime value, not just a pattern of digits that still could represent an invalid datetime ( is not a valid timestamp, for example)
p51904
as(dp51905
g16
V100297
p51906
stp51907
a((dp51908
g2
(lp51909
VUse  to generate a list of files in either directory (with paths relative to their roots):
p51910
aVCreate a set of paths from one:
p51911
aVthen find all the pathnames in the other root that are the same by using a set intersection:
p51912
aVloops over the files efficiently pairing up lines; if one file is longer than the other the remaining lines will be paired up with  to ensure that you detect one as different from the other
p51913
aVDemo:
p51914
as(dp51915
g16
V100297
p51916
stp51917
a((dp51918
g2
(lp51919
VYou have an expression with 5 groups
p51920
aVThe fact that you have 2 of those in one optional part and the other 3 in a mutually exclusive other part of your expression doesn't change that fact
p51921
aVEither 2 or 3 of the groups are going to be empty, depending on what line you matched
p51922
aVIf you have to match either line with one expression, there is no way around this
p51923
aVYou can use named groups (and return a dictionary of matched groups) to make this a little easier to manage, but you will always end up with empty groups
p51924
as(dp51925
g16
V100297
p51926
stp51927
a((dp51928
g2
(lp51929
VIf the callback function returns a value, it is assumed that it is to replace the data that was passed in
p51930
aVIf the function doesn\u2019t return anything, nothing else is effected
p51931
aVThis means that whatever you return is expected to take the place of the response object you were passed
p51932
aVNothing in the documentation states that you can return just anything
p51933
aVWhat did you expect to happen instead
p51934
aVIf you wanted to return a response that has different data, return something that acts like a response still
p51935
aVThis means that either you need to subclass the  response object, or implement something that provides the same API:
p51936
aVYou may want to copy over some of the other attributes from the original response; check the documentation on what attributes  objects have
p51937
as(dp51938
g16
V100297
p51939
stp51940
a((dp51941
g2
(lp51942
VThe difference is that the second method does not work:
p51943
aVexpects to find a iterable of key-value pairs, keyword arguments, or another dictionary:
p51944
aVUpdate the dictionary with the key/value pairs from other, overwriting existing keys
p51945
aVReturn
p51946
aVaccepts either another dictionary object or an iterable of key/value pairs (as tuples or other iterables of length two)
p51947
aVIf keyword arguments are specified, the dictionary is then updated with those key/value pairs:
p51948
aVis a built-in method that produces a sequence by applying the elements of the second (and subsequent) arguments to the first argument, which must be a callable
p51949
aVUnless your  object is a callable and the  object is a sequence, your first method will fail too
p51950
aVDemo of a working  application:
p51951
aVHere  just produces key-value pairs, which satisfies the  expectations
p51952
as(dp51953
g16
V100297
p51954
stp51955
a((dp51956
g2
(lp51957
VYou are going about it the wrong way
p51958
aVYou simply leave the set of characters to the regular expression:
p51959
aVmatches any 5-character pattern built from those 5 characters; that matches the same 3125 different combinations you generated with your set line, but doesn't need to build all possible combinations up front
p51960
aVOtherwise, your regular expression attempt had no correlation to your  variable, the pattern  would match 0 or more arbitrary characters, followed by the literal text
p51961
as(dp51962
g16
V100297
p51963
stp51964
a((dp51965
g2
(lp51966
VYour exception indicates that  is not what you think it is
p51967
aVTo look at other, adjacent rows, provided  is indeed a list, I'd use  to include the current index and then use that index to load next and previous rows:
p51968
as(dp51969
g16
V100297
p51970
stp51971
a((dp51972
g2
(lp51973
VYou are converting every byte to a 2-byte string representing the hex value of that byte
p51974
aVA hex string representation is not the same thing as the original byte
p51975
aVI'd be very surprised if that did not double the size of the file
p51976
aVIf you are using a HEX editor to look at the original image that displays the bytes as hexadecimal characters, then you are confusing one editors representation of that data with the actual contents of the file
p51977
aVIf you wanted to do that task more efficiently, you can use the  function to do it in much less code
p51978
aVThe mirror operation is called :
p51979
as(dp51980
g16
V100297
p51981
stp51982
a((dp51983
g2
(lp51984
V indeed must return just the filenames that are ignored
p51985
aVHowever, the function is called for each directory  visits; you get to ignore files per directory
p51986
aVIf you have a full path to a file you need to ignore, then match against the first parameter passed to your  function; it is the full path to that directory:
p51987
aVI return a set here; set membership testing is faster than with a list
p51988
aVIf you have a predefined set of paths to ignore, parse those out into a dictionary; keys are the directory path, values sets of filenames in that path:
p51989
as(dp51990
g16
V100297
p51991
stp51992
a((dp51993
g2
(lp51994
VUse nested  calls:
p51995
aVreturns  only if all of the elements in the iterable passed to it are
p51996
aVthus is  only if all elements are false:
p51997
as(dp51998
g16
V100297
p51999
stp52000
a((dp52001
g2
(lp52002
VJust use the  module to read the data, massage this per row, and write it out again
p52003
aVYou can create 'empty' columns by using  or an empty string  as the value for that column
p52004
aVVice-versa, reading empty columns (so between consecutive tabs) gives you empty strings
p52005
aVUpdate:
p52006
aVInstead of using a flag, use the reader as an iterator (calling  on it to get the next row instead of using a  loop):
p52007
as(dp52008
g16
V100297
p52009
stp52010
a((dp52011
g2
(lp52012
VYou need to call  to invoke  from
p52013
aVis not a global function, it is a method on the class
p52014
aVYou may want to read through the Python tutorial on classes some more to get the finer details down
p52015
as(dp52016
g16
V100297
p52017
stp52018
a((dp52019
g2
(lp52020
VThe error indicates that the  callable does not take a  keyword argument
p52021
aVThe syntax you used is normally used for keyword arguments
p52022
aVAssign separately:
p52023
as(dp52024
g16
V100297
p52025
stp52026
a((dp52027
g2
(lp52028
VNo, the  lib has no method to handle that
p52029
aVThe  encoding standard used for GET and POST requests allows only for one level of key-value pairs, and there is no standard for nested values
p52030
aVInstead various frameworks invented their own to handle this
p52031
aVYou are looking at one of many variations
p52032
aVThe output you see is created by the  function, which handles sequences by repeating the key multiple times; your nested dictionary is seen as a sequence and only the keys are thus serialized
p52033
aVNormally this would be used for lists of values instead, and mimics what a browser would do when serialising multiple form fields with the same name
p52034
aVYou'll have to encode the nested dictionary yourself:
p52035
aVwould return a sequence of key-value tuples
p52036
aVKeep the rest of your URL parameters in the same format:
p52037
as(dp52038
g16
V100297
p52039
stp52040
a((dp52041
g2
(lp52042
VYou are using the wrong operator
p52043
aVYou want boolean ;  is a bitwise operator:
p52044
aVYou can eliminate that nested list comprehension, it is redundant:
p52045
aVNext, use the  function to generate all combinations instead of nested loops, and  to test if all values are non-zero:
p52046
aVbut you may as well omit the  from the set and save yourself the  test:
p52047
aVand perhaps you wanted to correct that test to equals to 0:
p52048
aVResult:
p52049
as(dp52050
g16
V100297
p52051
stp52052
a((dp52053
g2
(lp52054
VYou need to reverse the ordering of your functions:
p52055
aVso lower first, then declare the ascending order
p52056
aVAlternatively, change the collation to :
p52057
aVwhich arguably is a better idea anyway
p52058
aVI don't think the  is required, leaving that off simplifies your code somewhat:
p52059
as(dp52060
g16
V100297
p52061
stp52062
a((dp52063
g2
(lp52064
V is using an absolute import
p52065
aVYou cannot arbitrarily nest packages into other directories and still expect things to work
p52066
aVInstead, add the  directory (which should not have a  file) to your  module search path
p52067
aVThat way the  module will still be importable as a top-level package
p52068
aVNext, you may want to look into Python packaging, dependencies and using a tool like  or  to deploy your code for you
p52069
aVThose tools handle dependencies for you and will install  as required
p52070
aVSee the Hitchhikers Guide to Packaging for an introduction
p52071
as(dp52072
g16
V100297
p52073
stp52074
a((dp52075
g2
(lp52076
VThe expression uses some features that work differently in Python
p52077
aVPython doesn't have a  character group; I used a POSIX regex reference to expand it
p52078
aVThe expression uses optional groups; matching either  or  at the start, but then uses both in the replacement
p52079
aVThis will fail in Python
p52080
aVSolution: use a replacement function
p52081
aVSo to get the same functionality, you can use:
p52082
aVDemo:
p52083
as(dp52084
g16
V100297
p52085
stp52086
a((dp52087
g2
(lp52088
VCreate a set from the last column; a set comprehension is easiest
p52089
aVIf the length of the set is 1, all values in that column are the same:
p52090
aVor as a function:
p52091
aVDemo:
p52092
as(dp52093
g16
V100297
p52094
stp52095
a((dp52096
g2
(lp52097
VYou are using  methods on an open file object
p52098
aVYou can read the file as a list of files by simply calling  on the object:
p52099
aVThis does include the newline characters
p52100
aVYou can strip those in a list comprehension:
p52101
as(dp52102
g16
V100297
p52103
stp52104
a((dp52105
g2
(lp52106
VNest the loops:
p52107
aVNote that we don't need to use indices (generated by ); loop directly over the lists instead
p52108
aVYou could use  and  here too to speed things up a little more still:
p52109
aVor even:
p52110
aVbecause  can be faster than list comprehensions, especially when used with  to avoid the extra stack-push a  would require
p52111
as(dp52112
g16
V100297
p52113
stp52114
a((dp52115
g2
(lp52116
VUse a  direct link to the index page listing those packages:
p52117
aVbut you really want to use an internal version number (append , etc
p52118
aVand pin to those version numbers
p52119
aVSee Specifying Your Project\u2019s Version in the Packaging Guide
p52120
aVThat way you can still switch between your version and the publicly released version simply by switching version numbers
p52121
aVAnother thing you want to do is use a proper pip requirements file to pin version numbers, and version-control that file
p52122
aVYou can include indexes and find-links urls in that file too
p52123
as(dp52124
g16
V100297
p52125
stp52126
a((dp52127
g2
(lp52128
VFunctions can return values
p52129
aVReturn values are cool
p52130
aVReturn  from :
p52131
aVYou may also want to look in to object-oriented programming techniques; define a class that handles all your FTP-related operations, and store the FTP server connection as an attribute of the instance
p52132
as(dp52133
g16
V100297
p52134
stp52135
a((dp52136
g2
(lp52137
VUse the  module and write tab delimited values:
p52138
aVYour input file most likely used tab-delimited columns as well, not multiple spaces
p52139
as(dp52140
g16
V100297
p52141
stp52142
a((dp52143
g2
(lp52144
VUse  to generate an index:
p52145
aVYou can collapse the four lines into 1 using a list comprehension:
p52146
as(dp52147
g16
V100297
p52148
stp52149
a((dp52150
g2
(lp52151
VThey are not the same thing at all
p52152
aVqueries for the number of items contained in a container
p52153
aVFor a string that's the number of characters:
p52154
aVReturn the length (the number of items) of an object
p52155
aVThe argument may be a sequence (string, tuple or list) or a mapping (dictionary)
p52156
aVon the other hand returns the memory size of the object:
p52157
aVReturn the size of an object in bytes
p52158
aVThe object can be any type of object
p52159
aVAll built-in objects will return correct results, but this does not have to hold true for third-party extensions as it is implementation specific
p52160
aVPython string objects are not simple sequences of characters, 1 byte per character
p52161
aVSpecifically, the  function includes the garbage collector overhead if any:
p52162
aVcalls the object\u2019s  method and adds an additional garbage collector overhead if the object is managed by the garbage collector
p52163
aVString objects do not need to be tracked (they cannot create circular references), but string objects do need more memory than just the bytes per character
p52164
aVIn Python 2,  method returns (in C code):
p52165
aVwhere  is the C struct header size for the type,  basically is the same as  and  is the per-character size
p52166
aVIn Python 2
p52167
aV7, for byte strings, the size per character is 1, but it's  that is confusing you; on my Mac that size is 37 bytes:
p52168
aVFor  strings the per-character size goes up to 2 or 4 (depending on compilation options)
p52169
aVOn Python 3
p52170
aV3 and newer, Unicode strings take up between 1 and 4 bytes per character, depending on the contents of the string
p52171
as(dp52172
g16
V100297
p52173
stp52174
a((dp52175
g2
(lp52176
V returns a descriptor, and a descriptor needs two items:
p52177
aVA starting point from which to search the class hierarchy
p52178
aVThe argument to bind the returned methods
p52179
aVIf you do not pass in a second argument,  cannot invoke the descriptor protocol to bind the returned functions
p52180
aVare still bound; to a class and not an instance, but  does not know what you'll use it for
p52181
aVshould not and cannot know that you are looking up a class method instead of a regular method; class methods only differ from regular methods because their  method acts differently
p52182
aVWhy are class methods bound
p52183
aVBecause when you subclass  but do not override , calling  invokes the  function, binds it to  and your first argument to  will be that subclass, not
p52184
aVWithout a second argument,  returns an unbound object
p52185
aVYou can do the binding yourself using the  method too:
p52186
aVIn Python 3, calling  without arguments from inside a bound method will use the calling frame to discover, implicitly, what the type and bound object are, so you no longer have to explicitly pass in the type and object arguments in that case
p52187
aVPython 3 actually adds a implicit  scoped variable to methods for this purpose
p52188
aVSee PEP 3135
p52189
as(dp52190
g16
V100297
p52191
stp52192
a((dp52193
g2
(lp52194
VDon't use a  in this case
p52195
aVA  object is a data descriptor, which means that any access to  will invoke that descriptor and Python will never look for an attribute on the instance itself
p52196
aVYou have two options: use the  hook or build a descriptor that only implements
p52197
aVUsing the  hook
p52198
aVNow normal attribute lookups are used when reading  but when assigning to  the  method is invoked instead, letting you intercept  and adjust it as needed
p52199
aVDemo:
p52200
aVA setter descriptor
p52201
aVA setter descriptor would only intercept variable assignment:
p52202
aVNote how we need to assign to the instance  attribute to prevent invoking the setter again
p52203
aVDemo:
p52204
as(dp52205
g16
V100297
p52206
stp52207
a((dp52208
g2
(lp52209
VYou are recombining your lists incorrectly:
p52210
aVThis creates a nested loop, not a parallel loop
p52211
aVThe normal solution here is to use :
p52212
aVHowever, you can greatly simplify your code by building the  mapping while looping over the file:
p52213
aVwithout arguments will split on variable width whitespace and remove trailing and leading whitespace, all in one go
p52214
aVYou can then assign the list output to a series of names, including a catch-all starred name for the remaining items; I use it to capture the name, two ignored columns and then the rest in the  list, which we then convert to integers with a list comprehension
p52215
as(dp52216
g16
V100297
p52217
stp52218
a((dp52219
g2
(lp52220
V is more accurate, for three reasons:
p52221
aVit repeats the tests many times to eliminate the influence of other tasks on your machine, such as disk flushing and OS scheduling
p52222
aVit disables the garbage collector to prevent that process from skewing the results by scheduling a collection run at an inopportune moment
p52223
aVit picks the most accurate timer for your OS,  or , see
p52224
as(dp52225
g16
V100297
p52226
stp52227
a((dp52228
g2
(lp52229
VNo, you can't
p52230
aVPython's compiler is not nearly smart enough to detect in what cases it could remove the code block and  statement
p52231
aVPython would have to do a whole lot of logic inference otherwise
p52232
aVCompare:
p52233
aVwith
p52234
aVfor example
p52235
aVPython would have to detect the difference between these two expressions at compile time; one can be optimised away, the other cannot
p52236
aVNote that the difference in runtime between code with and without  statements is truly minute, everything else being equal
p52237
aVA small constant value test and jump is not anything to fuss about, really
p52238
as(dp52239
g16
V100297
p52240
stp52241
a((dp52242
g2
(lp52243
VThe Python interpreter assigns the last expression value to
p52244
aVThis behaviour is limited to the REPL interpreter only, and is intended to assist in interactive coding sessions:
p52245
aVThe standard Python interpreter goes to some length to not trample on user-defined values though; if you yourself assign something else to  then the interpreter will not overwrite that (technically speaking, the  variable is a  attribute, your own assignments are 'regular' globals)
p52246
aVYou are not using the standard Python interpreter though; you are using IPython, and that interpreter is not that careful
p52247
aVIPython documents this behaviour explicitly:
p52248
aVThe following GLOBAL variables always exist (so don\u2019t overwrite them
p52249
ag4212
aV(a single underscore) : stores previous output, like Python\u2019s default interpreter
p52250
ag15438
aVOutside of the Python interpreter,  is by convention used as the name of the translatable text function (see the  module; external tools look for that function to extract translatable strings)
p52251
aVIn loops, using  as an assignment target tells readers of your code that you are going to ignore that value; e
p52252
ag1298
aVto generate a list of 5 random float values
p52253
as(dp52254
g16
V100297
p52255
stp52256
a((dp52257
g2
(lp52258
VNo,  will not raise an exception; you are passed a standard Python  type in that case
p52259
as(dp52260
g16
V100297
p52261
stp52262
a((dp52263
g2
(lp52264
VYou installed the latest Plone hotfix, 20130618
p52265
aVIt includes a DDOS-prevention measure limiting the size of the  cookie data to 8kb (decompressed)
p52266
aVFuture Zope versions will also include this fix
p52267
aVTo work around this temporarily your only option is to increase the maximum size default
p52268
aVDoing this will allow other threads use larger cookies as well until you restore the default:
p52269
aVThe cookie data consists almost entirely of object paths (absolute paths as tuples) as  dumps, you'll have to estimate a suitable maximum size from that
p52270
as(dp52271
g16
V100297
p52272
stp52273
a((dp52274
g2
(lp52275
VSet the version in  only, and read your own version with , effectively querying the  metadata:
p52276
aVfile:
p52277
aVfile:
p52278
aVTo make this work in all cases, where you could end up running this without having installed it, test for  and the distribution location:
p52279
as(dp52280
g16
V100297
p52281
stp52282
a((dp52283
g2
(lp52284
VYou have the  fork of  installed in your site packages, but your  is trying to install  2
p52285
ag5740
aV0, which uses the new merged  0
p52286
aV7 or newer egg
p52287
aVThe  fork of  was merged back into the  project and the transition is causing some pain
p52288
aVYour options are:
p52289
aVTell  to use an earlier  version
p52290
aVRun  with the  option, forcing it to stick to a specific, earlier version:
p52291
aVVersion 2
p52292
ag1124
aV1 of buildout will not upgrade itself to 2
p52293
aV2 or newer and works with your -supplied  egg
p52294
aVUninstall the old  egg
p52295
aVManually delete all ,  and  files from your  directory:
p52296
aVand (optionally) reinstall  from with the latest ; the current version is 0
p52297
ag2392
aV6, and the  PyPI page links you to this  version
p52298
aVYou'll also need to upgrade your  script, see below
p52299
aVUse a recent
p52300
aVVersion 1
p52301
aV9 or newer of  (released March 2013) lets you create a virtualenv without the  egg using the  switch:
p52302
aVUse that to create a virtual env python to run your
p52303
aVYou still need to upgrade your  too
p52304
aVSee below
p52305
aVUpgrade your
p52306
aVFor  versions 2
p52307
ag5740
aV0 and up the  script has been updated to load  the-not-forked-version
p52308
aVGrab a new copy at from github (link to the 2 branch version), replace your old  with it, and bootstrap again
p52309
aVDo make sure you removed the old forked really--but-pretending-to-be- egg first or run with a virtual env python that does not have that egg
p52310
aVSee above
p52311
as(dp52312
g16
V100297
p52313
stp52314
a((dp52315
g2
(lp52316
VThere are excellent reasons to simplify that to the second form; it is the preferred Pythonic method; but just use  directly:
p52317
aVIf an index is needed as well, use :
p52318
aVCreating a  loop over the  of the  of the list is usually a sign someone moved to Python from a language without a  construct, like C, and they have not yet gotten used to how Python  loops really work
p52319
as(dp52320
g16
V100297
p52321
stp52322
a((dp52323
g2
(lp52324
VUse absolute imports, it'll work fine across python versions
p52325
aVInside  put:
p52326
aVwhere the  import works from Python 2
p52327
aV5 and onwards; see PEP 328
p52328
aVWithout the  import,  is ambiguous; Python 3 will treat it as absolute and load the top-level package, Python 2 treats it as relative and import the nested module instead
p52329
aVThe alternative is to use a relative import:
p52330
aVwhich will work across the same spectrum of versions
p52331
as(dp52332
g16
V100297
p52333
stp52334
a((dp52335
g2
(lp52336
VUse  to generate all combinations:
p52337
aVis a generator; it produces combinations on demand as the  loop loops over it, or you can ask it for a new combination each time with the  function
p52338
aVThis makes  very memory efficient
p52339
aVBecause it is implemented entirely in C,  is also very fast, faster than a list comprehension would be
p52340
aVTo generate a list, call  on it:
p52341
aVTime comparisons between  and a list comprehension:
p52342
as(dp52343
g16
V100297
p52344
stp52345
a((dp52346
g2
(lp52347
VYou need to pass arguments for a subtask in the  keyword argument, which must be a tuple according to the  documentation:
p52348
aVor use the  method on your  task, but again pass the arguments as a tuple:
p52349
aVAlternatively, use star arguments with the  method:
p52350
aVThe subtasks documentation you yourself linked to use a tuple in the examples; arguments and keyword arguments are two pieces of data that Celery has to store for you until it can run that task, then it'll apply those arguments and keyword arguments for you
p52351
aVBut the  function takes more than just the arguments and keyword arguments for your task; it also takes additional options
p52352
aVIn order to work with arbitrary arguments  (positional or keyword) to your task, and support other arguments that are not passed to your task, the function signature has no choice but to accept positional arguments as an explicit tuple, and keyword arguments as an explicit dictionary
p52353
aVThe  method does not accept any arguments other than what the task itself would accept, so it does support passing arguments as if you called the task directly
p52354
aVInternally, this uses catch-all arguments: , and just passes the captured arguments as a tuple and dictionary on to
p52355
as(dp52356
g16
V100297
p52357
stp52358
a((dp52359
g2
(lp52360
V interpolates values into a string and lets you set the formatting for those values
p52361
aVYour string contains the simple placeholder  and that is replaced by the value passed in as a keyword
p52362
aVThe short-short version of your template is:
p52363
aVSee Format String Syntax for the nitty-gritty details of how  template slots let you specify what values to interpolate, and Format Specification Mini-Language on how you can alter how values are formatted
p52364
as(dp52365
g16
V100297
p52366
stp52367
a((dp52368
g2
(lp52369
VYou are using  and  on Python 3, where they return a  object
p52370
aVYou then zip these objects, which iterates over the  objects to create the pairs
p52371
aVIteration over a  object produces integers
p52372
aVSee the  type documentation:
p52373
aVWhile  literals and representations are based on ASCII text,  objects actually behave like immutable sequences of integers, with each value in the sequence restricted such that
p52374
aVYou do not need to use  when looping over a  object; you already have integers representing the individual bytes
p52375
aVSimply use a  object again after XOR-ing the values:
p52376
aVNote that  returns a  object too
p52377
aVIf you have to have a string (unicode) object then decode from ASCII:
p52378
aVDemo:
p52379
as(dp52380
g16
V100297
p52381
stp52382
a((dp52383
g2
(lp52384
VIn your second setup, the  function is not applied
p52385
aVYou are creating  object, regardless, in the  method:
p52386
aVNote the  line there
p52387
aVIn  you call the parent method:
p52388
aVpassing on  to  which creates a  object
p52389
aVSo when you create  with  you are passing  set to the string  to , which expected a dictionary instead:
p52390
aVand this is where your code fails:
p52391
aVOnly set  on  if no  has been set yet:
p52392
aVand set  first in :
p52393
as(dp52394
g16
V100297
p52395
stp52396
a((dp52397
g2
(lp52398
VYou need to open the file properly (use the open file object and the  module to parse the comma-separated values), read each row and convert the strings into  numbers, then apply the correct formula:
p52399
aVwhich can be simplified with a list comprehension to:
p52400
aVThe  statement assigns the open file object to  and makes sure it is closed again when the code block is done
p52401
aVWe add up the squares of the column values with , which is fed a generator expression that converts each column to  before squaring it
p52402
as(dp52403
g16
V100297
p52404
stp52405
a((dp52406
g2
(lp52407
VIt's objects all the way down, yes
p52408
aVIntegers, for example, have methods:
p52409
aVand so do functions:
p52410
as(dp52411
g16
V100297
p52412
stp52413
a((dp52414
g2
(lp52415
VUse  to remove characters of the end of a string:
p52416
aVYou can give it multiple characters; the argument is treated as a set and all characters at the end of the string that match that set are removed:
p52417
aVwould remove all tabs, newlines and spaces from the end of the line
p52418
aVIf you want to remove any whitespace, regardless, call  without an argument:
p52419
as(dp52420
g16
V100297
p52421
stp52422
a((dp52423
g2
(lp52424
VIf you want to round down always (instead of rounding to the nearest precision), then do so, explicitly, with the  function:
p52425
aVDemo:
p52426
as(dp52427
g16
V100297
p52428
stp52429
a((dp52430
g2
(lp52431
VNope, that's pretty much it
p52432
aVBut a list comprehension, basing off the  result, should be easy enough:
p52433
aVRemember, ranges do not have to start at 0
p52434
aV:-)
p52435
aVDemo:
p52436
as(dp52437
g16
V100297
p52438
stp52439
a((dp52440
g2
(lp52441
VYour  function only prints, it does not return anything
p52442
aVThe  variable inside that function is a local variable, not visible outside of the function
p52443
aVOutside of the  function,  is a different variable with the value  so your  value will never match it
p52444
aVReturn a value from the function to pass back to the caller:
p52445
aVthen test for that return value:
p52446
as(dp52447
g16
V100297
p52448
stp52449
a((dp52450
g2
(lp52451
VThe API does not give you the opportunity to set the blocksize, no
p52452
aVYou can increase the buffer by patching the constant on the function:
p52453
aVThe  parameter of functions can be replaced at will, just make sure you replace it with a tuple of equal length
p52454
as(dp52455
g16
V100297
p52456
stp52457
a((dp52458
g2
(lp52459
VAny characters inside a  character class are part of that class:
p52460
aVmatches either a digit or a literal  asterisk
p52461
aVIf you wanted to match 0 or more digits, put the asterisk outside the class:
p52462
aVat which point you don't need to use  as the  is a class all by itself:
p52463
aVThe first two patterns already use  (1 or more), so those match 1 or more digits or asterisks
p52464
aVWhat you wanted to match then is:
p52465
aVor even:
p52466
aVto match just 2 digits each
p52467
as(dp52468
g16
V100297
p52469
stp52470
a((dp52471
g2
(lp52472
VYou are building a string with literal quotes
p52473
aVYou don't need to, omit the  characters
p52474
aVor use string formatting:
p52475
aVYour original version was the equivalent of:
p52476
aV(note the extra single quote characters)
p52477
as(dp52478
g16
V100297
p52479
stp52480
a((dp52481
g2
(lp52482
VThe proper way is to decode to Unicode
p52483
aVByte strings can be any encoding
p52484
aVIf you always use ASCII, then use that as your codec:
p52485
as(dp52486
g16
V100297
p52487
stp52488
a((dp52489
g2
(lp52490
V includes any  objects, which is what you are tripping over
p52491
aVare essentially string objects, and you are trying to index that with the  line:
p52492
aVWhy not just load the tag directly using
p52493
aVDemo:
p52494
as(dp52495
g16
V100297
p52496
stp52497
a((dp52498
g2
(lp52499
VYes, it is
p52500
aVAssigning first then returning makes no difference when it comes to catching exceptions
p52501
aVThe assignment to  is entirely redundant
p52502
as(dp52503
g16
V100297
p52504
stp52505
a((dp52506
g2
(lp52507
VYou are looping over  way too many times
p52508
aVCollapse this into one loop, and track the  items in a dictionary instead:
p52509
aVCounting all items first then trying to limit looping over  by that many times while still looping over all the different types of items defeats the purpose somewhat
p52510
aVYou may want to consider giving the various indices in  names
p52511
aVYou can use tuple unpacking:
p52512
aVbut building  out of a -based class would help in code documentation and debugging even more
p52513
as(dp52514
g16
V100297
p52515
stp52516
a((dp52517
g2
(lp52518
VThe best approach is to use a set:
p52519
aVas membership testing in a set is O(1) (constant cost)
p52520
aVThe other two approaches are equal in complexity; merely a difference in constant costs
p52521
aVBoth the  test on a list and the  chain short-circuit; terminate as soon as a match is found
p52522
aVOne uses a sequence of byte-code jumps (jump to the end if ), the other uses a C-loop and an early exit if the value matches
p52523
aVIn the worst-case scenario, where  does not match an element in the sequence either approach has to check all elements before it can return
p52524
aVOf the two, I'd pick the  test any day because it is far more readable
p52525
as(dp52526
g16
V100297
p52527
stp52528
a((dp52529
g2
(lp52530
VYou usually use the  function to zip lists; your use of  is a happy side-effect of how that function works
p52531
aVstill produces tuples, but you can combine that with :
p52532
aVor you can use a list comprehension (slower but more flexibility when filtering, nesting loops and transforming the data):
p52533
as(dp52534
g16
V100297
p52535
stp52536
a((dp52537
g2
(lp52538
VSeek back to the start of the file:
p52539
as(dp52540
g16
V100297
p52541
stp52542
a((dp52543
g2
(lp52544
VNope, not possible, really
p52545
aVWhen  is not  your module was imported by another piece of code, as a regular module
p52546
aVYou cannot bail out early in that case
p52547
aVAnd what's wrong with a one time extra indentation level
p52548
aVJust hit tab in the editor, and be done with it
p52549
aVPersonally, I find that using a  function documents the intent much better than leaving the code unindented
p52550
as(dp52551
g16
V100297
p52552
stp52553
a((dp52554
g2
(lp52555
VYou are correctly looping and yielding
p52556
aVWhat you are not doing is use the results correctly:
p52557
aVwill replace any previous textual value each loop iteration
p52558
aVThis is why you see the last value only; all previous calls to  succeeded, but where then overwritten again by the next iteration
p52559
aVYou need to append to the existing text in the  widget instead
p52560
aVI suggest you use the  method:
p52561
aVIf you wanted to assign items one by one to your field on user events, call  on  every time you need a new address:
p52562
aVinstead of looping over it
p52563
aVThe above sample line sets the field to  if you've run out of email addresses
p52564
as(dp52565
g16
V100297
p52566
stp52567
a((dp52568
g2
(lp52569
VYou are overcomplicating things
p52570
aVDon't generate any numbers until you have an actual request
p52571
aVThen see how old your last number is, generate enough numbers to cover the intervening time period, update your tables, return the result
p52572
aVThere is no actual need to actually generate a random number every 10 seconds here
p52573
aVYou only need to produce the illusion that the numbers have been generated every 10 seconds, that more than suffices for your use case
p52574
aVA good database will handle concurrent access for you, and most will also let you set exclusive locks
p52575
aVGrab a lock when you need to update the numbers
p52576
aVFail to grab the lock
p52577
aVSomething else is already updating the numbers
p52578
aVPre-generate numbers; nothing says you actually have to only generate the numbers for the past time slot
p52579
aVRandomize what requests pre-generate to minimize lock contention
p52580
aVAppend the numbers to the end of the pool, so that if you accidentally run this twice all you get is double the extra random numbers, so you can wait twice as long before you need to generate more
p52581
aVMost of all, generating a sequence of random numbers is cheap, so doing this during any request is hardly going to slow down your responses
p52582
as(dp52583
g16
V100297
p52584
stp52585
a((dp52586
g2
(lp52587
VThe code applies a round-about way to remove punctuation
p52588
aVIt can be simplified to:
p52589
aVwhere  is a regular expression character class definition
p52590
aVIt'll match any character in the input text that is a member of that class, so any comma, exclamation mark, etc
p52591
aVwill match
p52592
aVThe  function will replace any match with the second argument, in this case the empty string, removing all named punctuation marks
p52593
aVThis function is better filled by the  function, whose second argument is a sequence of characters to delete from the input text
p52594
aVDemo:
p52595
as(dp52596
g16
V100297
p52597
stp52598
a((dp52599
g2
(lp52600
VUse the  function instead; you are sending a value of less than 256 but more than 128, but are creating a Unicode character
p52601
aVThe unicode character has to then be encoded first to get a byte character, and that encoding fails because you are using a value outside the ASCII range (0-127):
p52602
aVThis is normal Python 2 behaviour; when trying to convert a unicode string to a byte string, an implicit encoding has to take place and the default encoding is ASCII
p52603
aVIf you were to use  instead, you create a byte string of one character and that implicit encoding does not have to take place:
p52604
aVAnother method you may want to look into is the  module, especially if you need to send integer values greater than 255:
p52605
aVThe above example packs an integer into a unsigned short in network byte order, for example
p52606
as(dp52607
g16
V100297
p52608
stp52609
a((dp52610
g2
(lp52611
VNo, you are not changing what the  expression makes the generator produce
p52612
aVwill change what the local  inside  will be set to only
p52613
aVWhat happens is:
p52614
aVYou create , a generator function, and execution is frozen
p52615
aVYou call  on the generator
p52616
aVExecution is resumed,  is printed and the code runs until the  expression
p52617
aVis returned and assigned to the global
p52618
aVThe generator is paused again
p52619
aVYou call
p52620
aVExecution is resumed,  is assigned to the local variable  in the generator function,  prints that
p52621
aVis executed, the generator is paused and  is assigned to the global variable
p52622
aVis printed
p52623
aVBy this point the generator function is still paused, and the last line of the generator function is never executed
p52624
aVIf you were to call  again, then  would be printed, the generator end and  would be raised
p52625
as(dp52626
g16
V100297
p52627
stp52628
a((dp52629
g2
(lp52630
V is nothing more than , so use:
p52631
aVand be done with it
p52632
aVIf you have to use a list comprehension, replace the  call:
p52633
aVbut that is just as redundant as the inner list comprehension
p52634
aVWhat you are trying to do is pass individual elements to the  function, which only takes sequences
p52635
as(dp52636
g16
V100297
p52637
stp52638
a((dp52639
g2
(lp52640
VYour code is working just fine and what you see is normal
p52641
aVThose are literal representations of Python long integers
p52642
aVWhen printing a list, the contents of a list are printed as representations, the same output as the  function would give
p52643
aVThe alternative is to print individual elements of the list instead
p52644
aVYou don't need to worry about the long representation, however
p52645
aVThat is just an implementation detail of Python integers leaking through:
p52646
aVHere, the Python interpreter prints the results of expressions as  representations too
p52647
aVIntegers larger than  automatically become  integers
p52648
aVQuoting the documentation:
p52649
aVPlain integers (also just called integers) are implemented using  in C, which gives them at least 32 bits of precision ( is always set to the maximum plain integer value for the current platform, the minimum value is )
p52650
aVLong integers have unlimited precision
p52651
aVand
p52652
aVUnadorned integer literals (including binary, hex, and octal numbers) yield plain integers unless the value they denote is too large to be represented as a plain integer, in which case they yield a long integer
p52653
aVInteger literals with an  or  suffix yield long integers ( is preferred because  looks too much like eleven
p52654
aVComparisons and arithmetic between regular and long integers is fully supported and transparent:
p52655
aVPython fully supports mixed arithmetic: when a binary arithmetic operator has operands of different numeric types, the operand with the \u201cnarrower\u201d type is widened to that of the other, where plain integer is narrower than long integer is narrower than floating point is narrower than complex
p52656
aVComparisons between numbers of mixed type use the same rule
p52657
aVPython 3 removed the distinction altogether
p52658
as(dp52659
g16
V100297
p52660
stp52661
a((dp52662
g2
(lp52663
VWhen you call  you split the string into individual characters
p52664
aVThis happens because strings are sequences too
p52665
aVTo split a string into separate lines use the  method:
p52666
aVTo print the first word of each line, use  to spilt on whitespace:
p52667
aVOr a little more efficiently by splitting only once:
p52668
as(dp52669
g16
V100297
p52670
stp52671
a((dp52672
g2
(lp52673
VOn Python 3, use  to get a dictionary view object, which lets you do set operations on just the keys:
p52674
aVIn Python 2, you'd use  for that
p52675
aVIn Python 2,  returns a list, a copy of the keys in the dictionary
p52676
aVThis can be passed around an a separate object that can be manipulated in its own right, including removing elements without affecting the dictionary itself; in Python 3 you'd use  for that
p52677
as(dp52678
g16
V100297
p52679
stp52680
a((dp52681
g2
(lp52682
VYou need to refer to names in the module via the global name you imported
p52683
aVIf you import just , then refer to names in that module as attributes on the module object:
p52684
aVor you need to import names from the module:
p52685
aVto create a reference in your current module to the same function
p52686
aVAn alternative spelling would be:
p52687
as(dp52688
g16
V100297
p52689
stp52690
a((dp52691
g2
(lp52692
VThe module won't work on Python 3, as it uses Python 2 specific syntax
p52693
aVThere is an open pull request for supporting Python 3
p52694
aVYou can try to use the patch in that pull request, or switch to Python 2
p52695
aVUpdate: As of version 0
p52696
aV6  supports Python 3
p52697
aVInstall that version or newer
p52698
as(dp52699
g16
V100297
p52700
stp52701
a((dp52702
g2
(lp52703
VUse an iteration grouper; the  module recipes list includes the following:
p52704
aVThis lets you iterate over your tweets in groups of 5000:
p52705
as(dp52706
g16
V100297
p52707
stp52708
a((dp52709
g2
(lp52710
VPython will unpack values from the right-hand side recursively
p52711
aVNo tuples are created
p52712
aVInstead, the syntax on the left-hand side is interpreted by the compiler to figure out how to assign sequences from the right-hand side
p52713
aVTo see this in action, disassemble assignment code:
p52714
aVHere  is unpacked twice to be stored in ; the compiler determined that the left-hand side is a nested sequence and compiled that down to two  bytecodes
p52715
aVThis is all documented in the assignment statement reference:
p52716
aVAssignment is defined recursively depending on the form of the target (list)
p52717
aVand
p52718
aVAssignment of an object to a target list is recursively defined as follows
p52719
aVIf the target list is a single target: The object is assigned to that target
p52720
aVIf the target list is a comma-separated list of targets: The object must be an iterable with the same number of items as there are targets in the target list, and the items are assigned, from left to right, to the corresponding targets
p52721
aVand
p52722
aVAssignment of an object to a single target is recursively defined as follows
p52723
ag15438
aVIf the target is a target list enclosed in parentheses or in square brackets: The object must be an iterable with the same number of items as there are targets in the target list, and its items are assigned, from left to right, to the corresponding targets
p52724
aVThat last part particularly tells you that the left-hand side is not interpreted as a Python list or tuple; it just looks the same
p52725
as(dp52726
g16
V100297
p52727
stp52728
a((dp52729
g2
(lp52730
VYou are not splitting the text into words; instead you are looping over the characters one by one
p52731
aVSplit your text using the  method leaving the arguments to the default (splitting on variable-width whitespace):
p52732
as(dp52733
g16
V100297
p52734
stp52735
a((dp52736
g2
(lp52737
VAccording to this commit, making the name optional was done explicitly to support passing in a  object, but as you discovered that then skips detecting the mime type and defaults to  instead
p52738
aVYour approach then, is entirely correct
p52739
aVSimply set the  attribute to goad  into detecting a mime type
p52740
aVThe alternative is to use a better library to POST to the web
p52741
aVI recommend you look at , which supports multipart POSTing of files out of the box, including a way to set the filename
p52742
aVThe mimetype will be based on that explicit filename if passed in
p52743
as(dp52744
g16
V100297
p52745
stp52746
a((dp52747
g2
(lp52748
VYou should simplify your code and build your lists directly, and build an outer list by appending:
p52749
aVThe above code builds the nested lists in one go
p52750
as(dp52751
g16
V100297
p52752
stp52753
a((dp52754
g2
(lp52755
VWhat you are trying to do is create two nested lists, so nest your comprehensions:
p52756
aVor, since you are not doing anything with the expression, just:
p52757
aVIn Python 2, even the  call is redundant
p52758
aVYou did not share what your 'define  outside the list comprehension code' looked like, but do realize that a list comprehension supports nested for loops
p52759
aVA list comprehension can be seen as a series of for loops and  statements, which, read from left to right are seen as nested statements:
p52760
aVshould be read as:
p52761
aVJudging from your output you did something like this instead:
p52762
aVwhere  was set to  on Python 2
p52763
as(dp52764
g16
V100297
p52765
stp52766
a((dp52767
g2
(lp52768
V changes the  list in place
p52769
aVPython API methods that alter a structure in-place generally return , not the modified data structure
p52770
aVIf you wanted to create a new randomly-shuffled list based of an existing one, where the existing list is kept in order, use  with  for a sorting key:
p52771
aVDemo:
p52772
as(dp52773
g16
V100297
p52774
stp52775
a((dp52776
g2
(lp52777
VYour regular expression is not matching your actual file contents
p52778
aVAs such,  returns
p52779
aVThe problem here is that you indented your regular expression but did not compensate for the extra whitespace:
p52780
aVNote that the whitespace at the start of the line there matters
p52781
aVUse separate strings (Python will join them at compile time):
p52782
as(dp52783
g16
V100297
p52784
stp52785
a((dp52786
g2
(lp52787
VYou are matching way too much with the  pattern
p52788
aVMatch just digits and dots:
p52789
aVThis matches one character in the class of  and , followed by one or more characters in the  plus  class (digits or a dot)
p52790
aVDemo:
p52791
aVNote that your  negative character class pattern also excludes the  symbol
p52792
aVEverything inside  of the negative character class is excluded
p52793
as(dp52794
g16
V100297
p52795
stp52796
a((dp52797
g2
(lp52798
VJust assign the result of the boolean test in your case:
p52799
aVOtherwise you are looking for a conditional expression:
p52800
as(dp52801
g16
V100297
p52802
stp52803
a((dp52804
g2
(lp52805
VPython can return multiple values (in the form of a tuple), obsoleting the need to pass values by reference
p52806
aVIn your simple sample case, even if you were able to apply the same technique, you could not achieve the same result as Python strings are not mutable
p52807
aVAs such, your simple example can be translated to Python as:
p52808
aVThe alternative is to pass in mutable objects (dictionaries, lists, etc
p52809
aVand alter their contents
p52810
as(dp52811
g16
V100297
p52812
stp52813
a((dp52814
g2
(lp52815
VImplement the  hook; in case of a slice a  object is passed in
p52816
aVA simple version could be:
p52817
aVNote that for slice assignment and slice deletion you must also implement the  and  hooks
p52818
aVWhen overriding existing container types, you'll also have to handle the  method; it is deprecated but Python 2 types still implement it
p52819
aVAgain, there are corresponding  and  hooks for slice assignment and deletion too
p52820
as(dp52821
g16
V100297
p52822
stp52823
a((dp52824
g2
(lp52825
VAs documented on the  PyPI page you need to include the  egg too; the traceback shows you it is missing:
p52826
as(dp52827
g16
V100297
p52828
stp52829
a((dp52830
g2
(lp52831
VWhen writing to a file, you must write strings but you are trying to write a floating point value
p52832
aVUse  to turn those into strings for writing:
p52833
aVNote that your  line does nothing, really
p52834
aVIt refers to the  method on the file object but does not actually invoke it
p52835
aVNeither would you want to close the file during the loop
p52836
aVInstead, use the file as a context manager to close it automatically when you are d one
p52837
aVYou also need to include newlines, explicitly, writing to a file does not include those like a  statement would:
p52838
aVNote that you are incrementing the counter by 0
p52839
aV1, not 1, so you are creating 10 times more entries than your question seems to suggest you want
p52840
aVIf you really wanted to only write integers between 1 and 999, you may as well use a  loop:
p52841
as(dp52842
g16
V100297
p52843
stp52844
a((dp52845
g2
(lp52846
VBram worked against an older version of Python, one where the  code did not add  and  attributes to  objects
p52847
aVSpecifically, the Python version he developed with did not have this change applied
p52848
aVThe workaround is to copy those attributes yourself from the original  object in the  class found in the original  file:
p52849
as(dp52850
g16
V100297
p52851
stp52852
a((dp52853
g2
(lp52854
VYou are doing two things wrong:
p52855
aVYou are not converting text to integers
p52856
aVYou are using  to add to the list
p52857
aVThe two mistakes conspire to make your code fail
p52858
aVUse:
p52859
aVinstead
p52860
aVPython strings are sequences too
p52861
aVUsing  adds every element of the input sequence to the list; for strings that means individual characters:
p52862
aVon the other hand, adds individual values to a list:
p52863
aVisn't too picky about whitespace, so even though your  values include a newline,  will work:
p52864
as(dp52865
g16
V100297
p52866
stp52867
a((dp52868
g2
(lp52869
VUse the  module, bundled with Python:
p52870
as(dp52871
g16
V100297
p52872
stp52873
a((dp52874
g2
(lp52875
VYou can only use immutable values for dictionary keys
p52876
aVvalues are mutable, so these cannot be used:
p52877
aVUse  values instead:
p52878
aVDemo:
p52879
aVDictionary keys must be hashable; see the Mapping types documentation:
p52880
aVA dictionary\u2019s keys are almost arbitrary values
p52881
aVValues that are not hashable, that is, values containing lists, dictionaries or other mutable types (that are compared by value rather than by object identity) may not be used as keys
p52882
aVand the hashable entry in the Python glossary:
p52883
aVAn object is  if it has a hash value which never changes during its lifetime (it needs a  method), and can be compared to other objects (it needs an  or  method)
p52884
aVHashable objects which compare equal must have the same hash value
p52885
aVBecause  values are mutable, they fail the hashable criteria; any two sets that compare equal now, can be changed later to no longer be equal, and thus their hash value would need to change too
p52886
aVBecause both dictionaries and sets rely on the hash value not changing, mutable containers cannot be used as dictionary keys
p52887
aVDictionary values (as opposed to keys) are not restricted to hashable objects
p52888
aVIf you wanted to create set values instead, use a loop:
p52889
aVor use a  object instead and avoid the  call:
p52890
aVDemo:
p52891
as(dp52892
g16
V100297
p52893
stp52894
a((dp52895
g2
(lp52896
VYou are trying to insert the table name (not the database)
p52897
aVYou appear to be mixing that up with SQL parameters; string templating and providing SQL parameters for your query are two entirely separate operations
p52898
aVYou'd have to use string formatting separately to build the query string:
p52899
aVor perhaps a little clearer to illustrate what is going on:
p52900
aVNote that this opens you up to a possible SQL injection vector
p52901
aVPerhaps you should look into a decent SQL library instead; SQLAlchemy lets you build SQL queries from Python calls (among other tasks)
p52902
as(dp52903
g16
V100297
p52904
stp52905
a((dp52906
g2
(lp52907
VFrom the list comprehension documentation:
p52908
aVWhen a list comprehension is supplied, it consists of a single expression followed by at least one  clause and zero or more  or  clauses
p52909
aVIn this case, the elements of the new list are those that would be produced by considering each of the for or if clauses a block, nesting from left to right, and evaluating the expression to produce a list element each time the innermost block is reached
p52910
aVIn other words, pretend that the  loops are nested
p52911
aVReading from left to right your list comprehension can be nested as:
p52912
aVwhere the list comprehension will use that last, innermost block as the values of the resulting list
p52913
as(dp52914
g16
V100297
p52915
stp52916
a((dp52917
g2
(lp52918
VYou are not passing anything to
p52919
aVreads from the  pipe, not from the command line
p52920
aVIf you wanted to read from the command line instead, use :
p52921
aVYou'll want to use string concatenation to build your PHP call:
p52922
aVYou can avoid having to split in Python by passing the two values as two separate command line arguments (here with quoting, although that is optional for your specific simple case):
p52923
aVand in Python use:
p52924
as(dp52925
g16
V100297
p52926
stp52927
a((dp52928
g2
(lp52929
V is an individual row from your input CSV and already split into columns
p52930
aVYou are trying to split an empty string in this case:
p52931
aVJust use  instead:
p52932
as(dp52933
g16
V100297
p52934
stp52935
a((dp52936
g2
(lp52937
VYes, encode your data to bytes before posting:
p52938
aVI'm assuming here that your data is ASCII-only (email addresses generally are, presumably your password is too)
p52939
as(dp52940
g16
V100297
p52941
stp52942
a((dp52943
g2
(lp52944
VThe second option is more pythonic for two reasons:
p52945
aVIt is one operator, translating to one bytecode operand
p52946
aVThe other line is really ; two operators
p52947
aVAs it happens, Python optimizes the latter case and translates  into  anyway, but that is an implementation detail of the CPython compiler
p52948
aVIt is close to how you'd use the same logic in the English language
p52949
as(dp52950
g16
V100297
p52951
stp52952
a((dp52953
g2
(lp52954
VYou need to figure out what codec was used to produce the inputfile you are parsing
p52955
aVAll 8-bit data (which includes files and network streams) have to use some form of encoding to squeeze human language into the limitations of the computer formats used
p52956
aVYour data is encoded too, just not in UTF-8 or ISO-8859-1 (latin 1)
p52957
aVYour UTF-8 decoding error message indicates that you have a hex byte 82 at position 3, so lets assume your example really looks like this:
p52958
aVCode page 437 happens to have  at position hex 82, so the above decodes to Unicode cleanly and with expected results:
p52959
aVHowever, without more detail about your source documents and associated metadata, it is impossible to tell if that is the correct codec to be used
p52960
aVFor one, there is entirely too little information in your post to say what codec is correct, code page 850 also uses codepoint 82 to represent
p52961
aVThe codec is to be determined on a case by case anyway, as it'll depend on how you got the source data in the first place on how you can detect what codec was used
p52962
aVI urge you to read:
p52963
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p52964
aVby Joel Spolsky
p52965
aVThe Python Unicode HOWTO
p52966
aVPragmatic Unicode by Ned Batchelder
p52967
aVbefore you continue, to fully appreciate what a codec means, and how that differs from Unicode
p52968
as(dp52969
g16
V100297
p52970
stp52971
a((dp52972
g2
(lp52973
V needs the current class to base off the search for a parent:
p52974
aVYou may want to match the  method names with the  methods and save yourself the extra  testing there
p52975
aVSimple aliases would do; , for example
p52976
aVneeds the current class to determine the correct Method Resolution Order, which depends entirely on the combination and order of base classes
p52977
aVIf you give it a base class start off from instead, then  will skip any methods on that base class as it must assume that that base class is the parent instead
p52978
as(dp52979
g16
V100297
p52980
stp52981
a((dp52982
g2
(lp52983
VThat's because whatever you enter, at least one of the tests is True:
p52984
aVUse  instead:
p52985
aVor use a membership test ():
p52986
as(dp52987
g16
V100297
p52988
stp52989
a((dp52990
g2
(lp52991
VJust load the file with :
p52992
aVYour JSON contains a dictionary top-level object, so the above code calls  to loop over each key-value combo in that object
p52993
as(dp52994
g16
V100297
p52995
stp52996
a((dp52997
g2
(lp52998
VBecause you imported the  module object, not the  class
p52999
aVIf you want to use just , import that:
p53000
aVAll that importing does, apart from executing the module if that hasn't already happened, is bind the imported name in your own namespace
p53001
aVbinds  to whatever  was bound to from
p53002
aVlets you specify a new name
p53003
as(dp53004
g16
V100297
p53005
stp53006
a((dp53007
g2
(lp53008
VPython dictionaries have no set order
p53009
aVThe behaviour you see is entirely normal and correct
p53010
aVQuoting the Python documentation for the  method:
p53011
aVKeys and values are listed in an arbitrary order which is non-random, varies across Python implementations, and depends on the dictionary\u2019s history of insertions and deletions
p53012
aVSee Why the order in Python dictionaries is arbitrary
p53013
aVfor why that is
p53014
aVIf you require ordering to be preserved, use a  instead:
p53015
as(dp53016
g16
V100297
p53017
stp53018
a((dp53019
g2
(lp53020
VYour code is manipulating a variable  without ever setting it first:
p53021
aVAdd the following line at the top of the function:
p53022
aVThe code will not work as currently written anyway because it attempts to read from a file opened in 'write and read' mode; the file pointer is set to the end of the file and thus reading from it will never return data without seeking to the strat first
p53023
aVThe function could do with some more cleaning up:
p53024
aVIt is unclear to me when 'ERROR' messages should be raised; use  instead of loud 'print' statements to exit the function early in any case
p53025
as(dp53026
g16
V100297
p53027
stp53028
a((dp53029
g2
(lp53030
VYou'd use iteration, list comprehensions or generators and the  module:
p53031
as(dp53032
g16
V100297
p53033
stp53034
a((dp53035
g2
(lp53036
VThe forbidden view is a view like any other, really; see the  decorator documentation:
p53037
aVAn analogue of  which registers a forbidden view
p53038
aVThe  constructor accepts most of the same arguments as the constructor of
p53039
aVIt can be used in the same places, and behaves in largely the same way, except it always registers a forbidden exception view instead of a \u2018normal\u2019 view
p53040
aVThis means it accepts the same predicates as  does; the decorator basically calls , which means its arguments can be used in the decorator; the documentation for that method explicitly excludes , but a route name is an option:
p53041
aVIf there are too many routes to map to, consider using a custom predicate
p53042
aVYou already have custom authentication policy switcher; all you need to do is add a custom predicate that'll detect which policy is being used
p53043
as(dp53044
g16
V100297
p53045
stp53046
a((dp53047
g2
(lp53048
VUse a generator expression to loop over all your citation dictionaries:
p53049
aVNote that using  is a very round-about way of saying , which is an incorrect and unreliable way of saying  (access the value associated with the  key in a dictionary referenced by the name )
p53050
as(dp53051
g16
V100297
p53052
stp53053
a((dp53054
g2
(lp53055
VYou are almost there
p53056
aVYou can do just that, refer to the unbound method on the  class, then pass in an instance to invoke that method
p53057
aVIn other words:  is a reference to an unbound method waiting for you to call it with a  instance:
p53058
aVUnbound methods, like functions, are objects and you can store them in lists, etc:
p53059
aVNow all you need to do is loop over your sunsets, your sunrises, etc
p53060
aVzip those up (or otherwise combine them) with their matching  instances and for you to call the method
p53061
as(dp53062
g16
V100297
p53063
stp53064
a((dp53065
g2
(lp53066
VYou are ignoring the output of your  call:
p53067
aVPython strings are immutable, so  returns a new string value
p53068
aVRebind  to the result:
p53069
as(dp53070
g16
V100297
p53071
stp53072
a((dp53073
g2
(lp53074
VYou copied the list, but not the contents, which you then change
p53075
aVYour  instances are mutable too, and  refers to the same instance as  does
p53076
aVSure,  is a copy, but the  instance is not
p53077
aVUse  to recursively create copies of your objects:
p53078
as(dp53079
g16
V100297
p53080
stp53081
a((dp53082
g2
(lp53083
V is not a list, it is itself an iterator
p53084
aVBy looping over all elements you've exhausted that iterator
p53085
aVIt no longer returns elements when you loop over it again, and  complains because it is passed an empty sequence
p53086
aVSimply recreate the object:
p53087
aVwhich returns a fresh iterator
p53088
as(dp53089
g16
V100297
p53090
stp53091
a((dp53092
g2
(lp53093
VBy storing that product and returning that result:
p53094
aVNow we have a function that produces your calculation, and it returns the result:
p53095
as(dp53096
g16
V100297
p53097
stp53098
a((dp53099
g2
(lp53100
VLeave the decoding to the XML parser; it'll detect what codec to use
p53101
aVOpen the file without converting to unicode:
p53102
aVNote the use of the standard function  instead of
p53103
aVThis applies to any XML parser; it is the job of the parser to determine from the XML prologue what codec to use for parsing the document
p53104
aVIf no prologue is present then UTF-8 is the default
p53105
as(dp53106
g16
V100297
p53107
stp53108
a((dp53109
g2
(lp53110
VYou have optional groups:
p53111
aVThe question mark makes that an optional match
p53112
aVBut Python will always return all groups in the pattern, and for any group that didn't match anything, an empty value (, usually) is returned instead:
p53113
aVNote the  in the output, that's the 4th word-group before the comma not matching anything because there are only 3 words to match
p53114
aVYou must've used , which explicitly returns strings, and the pattern group that didn't match is thus represented as an empty string instead
p53115
aVRemove the question marks, and your pattern won't match your input example until you add that required 4th word before the comma:
p53116
aVIf you need to match between 2 and 4 words, but do not want empty groups, you'll have to make one group match multiple words
p53117
aVYou cannot have a variable number of groups, regular expressions do not work like that
p53118
aVMatching multiple words in one group:
p53119
aVHere the  syntax creates a non-capturing group, one that does not produce output in the  list; used here so we can put a quantifier on it
p53120
aVtells the regular expression we want the preceding group to be matched between 1 and 3 times
p53121
aVNote the output; the second group contains a variable number of words (between 1 and 3)
p53122
as(dp53123
g16
V100297
p53124
stp53125
a((dp53126
g2
(lp53127
VUse a list comprehension and concatenation:
p53128
aVThis would remove multiple copies of  in the list
p53129
aVIf you only want to remove the first occurrence of  even if there are multiple copies, you need to stick to slicing:
p53130
aVbut that incurs two searches for that index
p53131
aVSince you mention in comments that you have no repeats in your data, you should stick with the first option
p53132
as(dp53133
g16
V100297
p53134
stp53135
a((dp53136
g2
(lp53137
VYou are looking at Python string literals
p53138
aVA  sequence is an escape code, which Python uses for any codepoint that is not printable or over codepoint 128
p53139
aVFor codepoints over 255, a  escape sequence is used instead
p53140
aVPython will print representations of values contained in a container, such as a list or dictionary, by default
p53141
aVThe representation ( function result) of a unicode value is printed as a python string literal:
p53142
as(dp53143
g16
V100297
p53144
stp53145
a((dp53146
g2
(lp53147
VA view is a basic component; it adapts a context and the request, so this component can apply data from the request and the context to produce
p53148
aVsomething
p53149
aVA page is a specialized view; it produces output aimed at the browser
p53150
aVIt usually involves a template
p53151
aVA viewlet and viewlet manager are closely tied together
p53152
aVA viewlet is a specialized view that is not meant to be used on it's own but is used in an assembly
p53153
aVThe viewlet manager does the assembling here; you ask a viewlet manager for all the viewlets that are registered with that manager and are active
p53154
aVViewlets are usually things like the login link, the personal information bar for logged-in users, etc
p53155
aVThe login link would only be active if there is no logged in user, the personal bar only active if there is a logged in user, etc
p53156
aVBasically, viewlets let you delegate the responsibility of a certain 'area' of rendered pages to components, where a manager handles one specific area and viewlets are the components that are used to render the snippets
p53157
as(dp53158
g16
V100297
p53159
stp53160
a((dp53161
g2
(lp53162
VYou do not have UTF-8 data
p53163
aVFrom the exception message I'd say you have Latin-1 encoded data instead:
p53164
aVYou can use the  function to create a file object that returns file data ready-decoded:
p53165
as(dp53166
g16
V100297
p53167
stp53168
a((dp53169
g2
(lp53170
VYou ignore the return value of recursive calls:
p53171
aVand
p53172
aVSo when  is :
p53173
aVyou call  after which your function ends
p53174
aVWithout an explicit return that means your function return value is set to  instead
p53175
aVAdd  statements to those lines:
p53176
as(dp53177
g16
V100297
p53178
stp53179
a((dp53180
g2
(lp53181
VThis is called interning, and yes, Python does do this to some extent, for shorter strings created as string literals
p53182
aVSee Python string interning for some discussion
p53183
aVInterning is runtime dependent, there is no standard for it
p53184
aVInterning is always a trade-off between memory use and the cost of checking if you are creating the same string
p53185
aVThere is a built-in intern() function to force the issue if you are so inclined, which documents some of the interning Python does for you automatically:
p53186
aVNormally, the names used in Python programs are automatically interned, and the dictionaries used to hold module, class or instance attributes have interned keys
p53187
as(dp53188
g16
V100297
p53189
stp53190
a((dp53191
g2
(lp53192
VPython copied the C formatting instructions
p53193
aVFor output,  and  are the exact same thing, both in Python and in C
p53194
aVThe difference lies in what these do when you use them to parse input, in C by using the  function
p53195
aVSee Difference between format specifiers %i and %d in printf
p53196
aVPython doesn't have a  equivalent, but the Python string formatting operations retained the two options to remain compatible with C
p53197
aVThe new  and  format specification mini-language dropped support for  and stuck with  only
p53198
as(dp53199
g16
V100297
p53200
stp53201
a((dp53202
g2
(lp53203
VYou are examining the first iteration, which works fine
p53204
aVThe exception occurs later on
p53205
aVStep through the loop some more, because at some point you'll run into a namespace key for which the value has been set to  (not a tuple of a boolean and a list)
p53206
aVWhy
p53207
aVBecause earlier in your code you do:
p53208
aVNote the  there; you perhaps meant to set that to:
p53209
aVNote that to loop over the keys of a dictionary, you can do so directly:
p53210
aVand save yourself an attribute lookup, a function call, and the creation of a whole new list object
p53211
as(dp53212
g16
V100297
p53213
stp53214
a((dp53215
g2
(lp53216
VCPython only allows switching between threads between Python bytecode steps
p53217
aVThis is where the GIL comes in; every N byte code instructions the lock is released and a thread switch can take place
p53218
aVThe  code is handled by one bytecode () that triggers the  method to be called on the dictionary
p53219
aVA , configured with  as the default value factory, handles the  method entirely in C, and the GIL is never unlocked, making  lookups thread safe
p53220
aVNote the qualification there; if you create a  instance with a different default-value factory, one that uses Python code ( for example), all bets are off as that means the C code calls back into Python code and the GIL can be released again while executing the  function
p53221
as(dp53222
g16
V100297
p53223
stp53224
a((dp53225
g2
(lp53226
VIt is rather unclear what you are trying to do, or what your expected output is
p53227
aVI've addressed general issues with your template code, lets see if that addresses your issues:
p53228
aVIt appears you have your opening and closing  tags muddled up
p53229
aVCurrently your structure looks like:
p53230
aVwhile I suspect you really wanted:
p53231
aVYou can combine the conditional spans with  attributes instead of replacing nested  tags, forming:
p53232
aVor, applied to your sample code, with some improvements to make things a little more readable:
p53233
aVYou perhaps want to make sure that those for  results are already floating point values and avoid all those  calls in your view
p53234
aVAlso take into account that floating point values could be not quite zero, a value of  is not equal to  but would be printed as  if you ask for a precision of 4 digits behind the comma
p53235
as(dp53236
g16
V100297
p53237
stp53238
a((dp53239
g2
(lp53240
VYour generator does not yield new lists, it yields the same list over and over again
p53241
aVWhen you append that yielded reference to  you only get to see the same original list, in it's most recently shuffled form, over and over again
p53242
aVYield a copy instead:
p53243
aVor create a random sort instead of using inplace shuffling with the  function:
p53244
as(dp53245
g16
V100297
p53246
stp53247
a((dp53248
g2
(lp53249
VUse a loop and yield slices:
p53250
aVor, if you must return a list:
p53251
as(dp53252
g16
V100297
p53253
stp53254
a((dp53255
g2
(lp53256
VYou are seeing the code output byte values; if you expected unicode strings instead, simply decode:
p53257
aVwhere  should be replaced by the encoding your data uses
p53258
as(dp53259
g16
V100297
p53260
stp53261
a((dp53262
g2
(lp53263
VFirst attack just the pairing part:
p53264
aVThen apply this to your dictionary:
p53265
aVDemo:
p53266
as(dp53267
g16
V100297
p53268
stp53269
a((dp53270
g2
(lp53271
VYou have  installed, which means that BeautifulSoup 4 will use that parser over the standard-library  option
p53272
aVYou can upgrade lxml to 3
p53273
ag5740
aV1 (which for me returns 1701 results for your test page); lxml itself uses  and  which may be to blame too here
p53274
aVYou may have to upgrade those instead / as well
p53275
aVSee the lxml requirements page; currently libxml2 2
p53276
ag4892
aV8 or newer is recommended
p53277
aVOr explicitly specify the other parser when parsing the soup:
p53278
as(dp53279
g16
V100297
p53280
stp53281
a((dp53282
g2
(lp53283
VYou can loop through your list and apply the regular expression to each:
p53284
aVThe above is a compact version of:
p53285
aVThe code takes into account that some of your urls do not contain a UID number
p53286
aVDemo:
p53287
as(dp53288
g16
V100297
p53289
stp53290
a((dp53291
g2
(lp53292
VZip the rows:
p53293
aVThe  function does the pairing for you, by passing in the  object with the  argument Python will loop over the CSV rows and pass each row as a separate argument to
p53294
as(dp53295
g16
V100297
p53296
stp53297
a((dp53298
g2
(lp53299
VYes, your understanding is entirely correct
p53300
aVPython will call a  method if present on the left-hand operand; if not, a corresponding  method on the right-hand operand can also hook into the operation
p53301
aVSee emulating numeric types for a list of hooks Python supports for providing more arithmetic operators
p53302
aVNote that the  call is redundant;  will not fail if the  string is not present; the whole function could be simplified to:
p53303
aVThe reverse version would be:
p53304
as(dp53305
g16
V100297
p53306
stp53307
a((dp53308
g2
(lp53309
VYou are not creating a duplicate of
p53310
aVAll you do is create another reference to the same list
p53311
aVTo create a copy of a list, you can just slice it from start to end:
p53312
aVbut for your case, that is not enough
p53313
aVYou need to copy the nested lists
p53314
aVIn this case, a list comprehension is easiest:
p53315
aVA more comprehensive solution is to use the  function to make absolutely sure that the top-level object and all contained objects are copies:
p53316
as(dp53317
g16
V100297
p53318
stp53319
a((dp53320
g2
(lp53321
VUse the  module and string formatting:
p53322
aVThe  class turns your rows into dictionaries, much handier here because then you can use named slots in the -powered string template
p53323
as(dp53324
g16
V100297
p53325
stp53326
a((dp53327
g2
(lp53328
V returns an empty string when you come to the end of the file, and that is not a valid number
p53329
aVTest for it:
p53330
aVYou appear to beappending to a list; lists have a method for that:
p53331
aVIf you want to get a random sample from your file, there are better methods
p53332
aVOne is to read all values, then use , or you can pick values as you read the file line by line all the while adjusting the likelihood the next line is part of the sample
p53333
aVSee a previous answer of mine for a more in-depth discussion on that subject
p53334
as(dp53335
g16
V100297
p53336
stp53337
a((dp53338
g2
(lp53339
VYou loop over your dictionary keys, then count the same keys that many times
p53340
aVThere is nothing dynamic about your loop body:
p53341
aVIf you have 12 keys in your dictionary, the above line is executed 12 times
p53342
aVIf you expected to see your loop access multiple keys with the same name, you misunderstood how dictionaries work
p53343
aVDictionaries map unique keys to values
p53344
aVSpecifying a key more than once in a literal dictionary declaration will result in a dictionary with only one copy of each key, with one of their values:
p53345
aVIn CPython, the compiler gives you the last value per key defined, which is why you see  in your example dictionary
p53346
aVYour sample input dictionary ends up with only four unique keys:
p53347
aVwhich makes me suspect you ran your loop 3 times to come to a count of 12 (looping over the dictionary gives you 4 keys)
p53348
aVIf you have an actual list of dictionaries, then take each separate dictionary from that list and use that as the basis of your count:
p53349
aVwhere  could be:
p53350
as(dp53351
g16
V100297
p53352
stp53353
a((dp53354
g2
(lp53355
VYour output sample suggest you are looking for url encoding, not Latin-1
p53356
aVThe  and  functions can be used to do such quoting, but the  character does not need quoting and won't be quoted:
p53357
aVReplace special characters in string using the  escape
p53358
aVLetters, digits, and the characters  are never quoted
p53359
aVDemo:
p53360
aVIf you are using Python 3, the  and  functions are found in the  module
p53361
as(dp53362
g16
V100297
p53363
stp53364
a((dp53365
g2
(lp53366
VYour  module defines an argument parser at the module level and prints the help message as it parses your command line arguments
p53367
aVIf you only want the parsing to take place if  is being run as a script, move the  call to your  test block:
p53368
as(dp53369
g16
V100297
p53370
stp53371
a((dp53372
g2
(lp53373
VIt is not quite the same thing
p53374
aVis a diagnostic tool that omits attributes that  and  would find
p53375
aVFrom the  documentation:
p53376
aVThe default  mechanism behaves differently with different types of objects, as it attempts to produce the most relevant, rather than complete, information:
p53377
aVIf the object is a module object, the list contains the names of the module\u2019s attributes
p53378
aVIf the object is a type or class object, the list contains the names of its attributes, and recursively of the attributes of its bases
p53379
aVOtherwise, the list contains the object\u2019s attributes\u2019 names, the names of its class\u2019s attributes, and recursively of the attributes of its class\u2019s base classes
p53380
aVand
p53381
aVNote: Because  is supplied primarily as a convenience for use at an interactive prompt, it tries to supply an interesting
p53382
aVset of names more than it tries to supply a rigorously or consistently
p53383
aVdefined set of names, and its detailed behavior may change across
p53384
aVreleases
p53385
aVFor example,  attributes are not in the result
p53386
aVlist when the argument is a class
p53387
aVEmphasis mine
p53388
aVThis means that  will find metaclass supplied attributes, but  would not, and what is found can differ accross Python releases as the definition for the function is to provide debugging convenience, not completeness
p53389
aVDemo of the specific metaclass scenario, where  finds the metaclass-defined attribute:
p53390
aVLast but not least:
p53391
aVIf the object has a method named , this method will be called and must return the list of attributes
p53392
aVThis means that  and  can vary even more widely in what attributes are 'found' if a  method has been implemented
p53393
aVJust stick with
p53394
aVIt is faster, for one, because testing for an attribute is cheap as that's just a membership test against one or more dictionaries
p53395
aVEnumerating all dictionary keys and merging them across instance, class and base classes on the other hand has a far higher CPU cost
p53396
as(dp53397
g16
V100297
p53398
stp53399
a((dp53400
g2
(lp53401
VYou gave  a string value:
p53402
aVbut try to subtract in integer:
p53403
aVDon't do that:
p53404
aVPerhaps you meant to make  an integer instead
p53405
as(dp53406
g16
V100297
p53407
stp53408
a((dp53409
g2
(lp53410
VYou are looking at the  representation of a string
p53411
aVThis is normal
p53412
aVA string representation uses escape codes for non-printable characters or anything that requires escaping
p53413
aVPython containers show their contents, when printed, as string representations for debugging purposes
p53414
aVThe resulting string representation is re-usable as a string literal, you can paste that right back into Python and it'll produce the same value
p53415
aVPrint individual values of you want to see the output unescaped:
p53416
aVand if you feel so inclined, compare that with the  result of the string:
p53417
as(dp53418
g16
V100297
p53419
stp53420
a((dp53421
g2
(lp53422
VYes, you can also do
p53423
aVFrom a boolean logic point of view, that is the same as
p53424
aVThere are differences between these statements, but they'll both produce either  or , and both return the same output for the exact same values of
p53425
aVYou can try out what statements like these do in your Python interactive interpreter:
p53426
aVetc
p53427
aVIf you really want to dig down into this, the best method is to use a set:
p53428
aVbecause set membership testing takes constant cost (independent of the size of the set) where chaining  statements or using a list to test against takes linear cost (the more elements you need to test against the longer it takes)
p53429
as(dp53430
g16
V100297
p53431
stp53432
a((dp53433
g2
(lp53434
VYou run both  commands first, then only display the output of one of the commands
p53435
aVBy the time you come to , etc
p53436
aVboth  and  have already been set and have captured the output of the commands
p53437
aVBoth  and  have been run, with the last one undoing anything the first command achieved
p53438
aVMove the  calls into the  statements:
p53439
as(dp53440
g16
V100297
p53441
stp53442
a((dp53443
g2
(lp53444
VMethods are just attributes, so use  to retrieve one dynamically:
p53445
aVNote that the method name is , not
p53446
aVDon't confuse syntax with the name here
p53447
aVreturns just the method object, you still need to call it (jusing )
p53448
as(dp53449
g16
V100297
p53450
stp53451
a((dp53452
g2
(lp53453
VThere is a much better way to transpose your rows and columns:
p53454
aVDemo:
p53455
aVtakes multiple sequences as arguments and pairs up elements from each to form new lists
p53456
aVBy passing in  with the  splat argument, we ask Python to expand  into separate arguments to
p53457
aVNote that the output gives you a list of tuples; map elements back to lists as needed:
p53458
as(dp53459
g16
V100297
p53460
stp53461
a((dp53462
g2
(lp53463
VThat page sets no cookies by itself:
p53464
aVNo  header is set
p53465
aVThe page does load other resources, so your browser sends additional GET requests for the images, the JavaScript and the CSS, each of which could include a  header in the response
p53466
aVJavaScript calls could set cookies too
p53467
aVModern browsers let you inspect the response headers of all resources loaded by a webpage
p53468
aVLook for  headers in those responses
p53469
as(dp53470
g16
V100297
p53471
stp53472
a((dp53473
g2
(lp53474
VYou want to use the file object, not the filename:
p53475
aVHowever, your input was GZIP-compressed as well:
p53476
aVNote that your own code forgot to state the correct mode for the opened file object as well;  without arguments opens the file in read-modus, and writes would fail with an  exception
p53477
as(dp53478
g16
V100297
p53479
stp53480
a((dp53481
g2
(lp53482
VIgnore
p53483
aVIf you want to create a package that specifies dependencies for a tool like  to go out and find for you, you need to base your  of off  instead
p53484
aVdependencies are listed in , which takes a list:
p53485
aVwhich should be distributions of their own
p53486
aVand  are modules included with Python and should not be listed
p53487
as(dp53488
g16
V100297
p53489
stp53490
a((dp53491
g2
(lp53492
V is the PDB command to traverse stack frames
p53493
aVYou are in the 'uppermost' frame already
p53494
aVwill tell you more about it:
p53495
aVThe command is closely related to  and :
p53496
aVIf you want to print the variable , prefix it with a  to have it not interpreted by the debugger as a debug command:
p53497
aVor use :
p53498
aVFrom the  output:
p53499
aVCommands that the debugger doesn't recognize are assumed to be Python
p53500
aVstatements and are executed in the context of the program being
p53501
aVdebugged
p53502
aVPython statements can also be prefixed with an exclamation
p53503
aVpoint ('
p53504
aVis the frame in the stack where your program started; it is the oldest in time; the , the other end of the stack, is where Python is executing code and is the current frame of execution, where Python would continue if you hit the  command
p53505
aVA little demo with a recursive function:
p53506
as(dp53507
g16
V100297
p53508
stp53509
a((dp53510
g2
(lp53511
VIf  is a string of  pairs, one per line, you'll need to parse those out into pairs:
p53512
aVThis presumes your query returns individual  strings to split out into key and value pairs
p53513
aVOnly use  with a sequence of key-value pairs, or another dictionary
p53514
aVJust passing in a string won't work; Python treats the string as a sequence of one-character strings, and a one-character string does not fit the requirement for a key-value pair
p53515
as(dp53516
g16
V100297
p53517
stp53518
a((dp53519
g2
(lp53520
VIn Python 3, use:
p53521
aVputting the keyword arguments after the positionals
p53522
aVThis syntax will not work in Python 2
p53523
aVDemo:
p53524
aVYou must specify a different value for  using a keyword argument when calling the  function defined here
p53525
as(dp53526
g16
V100297
p53527
stp53528
a((dp53529
g2
(lp53530
VSearch per sublist, adding up results per contained list with :
p53531
aVDemo:
p53532
as(dp53533
g16
V100297
p53534
stp53535
a((dp53536
g2
(lp53537
VYour  method already returned a decoded value:
p53538
aVBut you then try to decode the result again:
p53539
aVthen complains that  returned a python dictionary
p53540
aVJust remove the  call from that line:
p53541
as(dp53542
g16
V100297
p53543
stp53544
a((dp53545
g2
(lp53546
VYou do not need to recreate the string; sets do not have a set ordering anyway, and a set suffices to create permutations:
p53547
as(dp53548
g16
V100297
p53549
stp53550
a((dp53551
g2
(lp53552
VYou are testing if the entry objects are the same as the answers
p53553
aVUse the actual values:
p53554
aVinstead of testing against  and
p53555
as(dp53556
g16
V100297
p53557
stp53558
a((dp53559
g2
(lp53560
VIf they all have zeros in the same place, then loop over the index in reverse and remove that index from each list:
p53561
aVBy looping over the list in reverse, you keep the indices stable (only elements past the current index have been removed, shrinking only the tail of the lists)
p53562
aVSince you are not using the return value of  (all you get is s anyway, right
p53563
aV, you may as well just use  on the list index instead
p53564
aVI used  here instead of calculating the more strenuous ; it is just as efficient but a lot more readable
p53565
aVThe  function returns an iterator, handling the reversed number sequence very efficiently
p53566
aVOn Python 2, you can do the same with :
p53567
aVDemo:
p53568
as(dp53569
g16
V100297
p53570
stp53571
a((dp53572
g2
(lp53573
VUse  to store functions with default values to pass in
p53574
aVYou still need to call the function:
p53575
aVA  object, when called, will turn around and call the wrapped function, passing in the arguments you already stored with the , plus any others you passed in:
p53576
aVLast but not least, take a look a the  module; that module already contains a  and  function for you:
p53577
aVThese functions return the result instead of printing the value
p53578
aVIn the above example, it is the python interactive interpreter that does the printing instead
p53579
as(dp53580
g16
V100297
p53581
stp53582
a((dp53583
g2
(lp53584
VIt looks like you are almost there
p53585
aVI'd use a  to detect repeated numbers (more efficient):
p53586
aVMake sure you get your delimiter right; if the above doesn't work for you then  may show you whole rows with the delimiters still in them, as strings
p53587
aVSay, your file uses  as a delimiter instead, the output would look something like:
p53588
aVwhile configuring the correct delimiter would give you:
p53589
as(dp53590
g16
V100297
p53591
stp53592
a((dp53593
g2
(lp53594
VYou test for the intersection:
p53595
aVDemo:
p53596
aVYou could loop over your set too, with a  loop, but that would not be nearly as efficient
p53597
as(dp53598
g16
V100297
p53599
stp53600
a((dp53601
g2
(lp53602
VA deep copy never copies the class definition, only the instance attributes
p53603
aVIt instead creates a new instance
p53604
aVPython instances only hold a reference to the class definition
p53605
aVJust call  on that instance:
p53606
aVprovided the class has such a method
p53607
aVIt is your specific class that prevents a successful deep-copy:
p53608
aVThe  function looks for a  method on the instance, and your  hook instead returns a  class
p53609
aVYou can prevent this by testing your  a little first:
p53610
aVThis signals that your class does not handle private attributes or special method names
p53611
as(dp53612
g16
V100297
p53613
stp53614
a((dp53615
g2
(lp53616
VFrom the  documentation:
p53617
aVThe optional argument completekey is the  name of a completion key; it defaults to
p53618
aVIf completekey is not  and  is available, command completion is done automatically
p53619
aVYou need to have  available for tab completion to work
p53620
aVCommand methods only ever take one argument and you need to do the parsing of the argument in the command method itself
p53621
aVYou can, of course, call  or  methods if necessary
p53622
as(dp53623
g16
V100297
p53624
stp53625
a((dp53626
g2
(lp53627
VUse the  function to include a loop index:
p53628
aVAlternatively, just slice your list to only consider the first  elements, albeit that that creates a new copy of the sublist:
p53629
aVIf you need to test for specific values of , you can also exit a  loop early with :
p53630
as(dp53631
g16
V100297
p53632
stp53633
a((dp53634
g2
(lp53635
VSome of your  tags do not have a  attribute, so  returns
p53636
aVUse:
p53637
aVto return an empty string in that case, or test for the attribute first:
p53638
as(dp53639
g16
V100297
p53640
stp53641
a((dp53642
g2
(lp53643
VBecause dictionaries are mutable, you cannot use dictionaries as keys of another dictionary or store them in a set
p53644
aVYou'll have to capture an immutable 'snapshot' of the dictionary instead:
p53645
aVProvided the dictionary values are not mutable either, you can use the return value of the  function as keys instead
p53646
aVNow you can build the combined dictionary:
p53647
aVDemo:
p53648
as(dp53649
g16
V100297
p53650
stp53651
a((dp53652
g2
(lp53653
VYou are looping over all the keys and values in the dictionary
p53654
aVThis means that the  block is going to be called for all keys in that loop that do not match:
p53655
aVIf the first key-value pair looped over does not match, the  block is executed and you appear to be returning
p53656
aVTo look for a matching key in the dictionary, either test for it with  or use the  method to get the value or a default:
p53657
aVor use:
p53658
as(dp53659
g16
V100297
p53660
stp53661
a((dp53662
g2
(lp53663
VYou start counting at one, but python indices are always zero-based
p53664
aVStart your line count at zero:
p53665
aVor subtract one from , deleting from  (not ):
p53666
aVNote that in order for your  call to return any lines, you need to either re-open the file first, or seek to the start:
p53667
as(dp53668
g16
V100297
p53669
stp53670
a((dp53671
g2
(lp53672
VMap your values to  when creating the named tuple instances:
p53673
aVThis keeps the  value as a string, and maps the remaining values to
p53674
aVThis does require knowledge of the CSV columns as which ones can be converted to integer is hardcoded here
p53675
aVDemo:
p53676
aVNote that you should test against the rows, not the  class:
p53677
aVwithin the loop, or in a new loop of collected rows
p53678
as(dp53679
g16
V100297
p53680
stp53681
a((dp53682
g2
(lp53683
VStart with using a list of dictionaries instead of 30 separate variables:
p53684
aVAnd use  to generate all combinations between matching contained lists:
p53685
aVHere the generator expression retrieves the same key from all dictionaries in one statement
p53686
aVOutput for your sample input; note, there is no  and no , so for keys 2 and 3 no output is generated
p53687
aVLooping over many keys then producing products from 30 different lists is going to take a while
p53688
aVYou may have to rethink what you are trying to  do and avoid doing too much work
p53689
as(dp53690
g16
V100297
p53691
stp53692
a((dp53693
g2
(lp53694
VEach decorator gets to wrap another function
p53695
aVThe function passed to  is the result of the  decorator
p53696
aVJust test for specific traits of the  wrapper, provided you make the wrapper recognisable:
p53697
aVI used an arbitrary attribute on the wrapper function, but you could try to test for a name (not so unambiguous), for the signature (using  perhaps), etc
p53698
aVThis is limited to direct wrapping only
p53699
aVGenerally speaking, you don't want to couple decorators as tightly as all this
p53700
aVWork out a different solution and only depend on function signature or return values
p53701
as(dp53702
g16
V100297
p53703
stp53704
a((dp53705
g2
(lp53706
VUse  to copy data:
p53707
aVreads from the  object in chunks, writing them to the  fileobject directly
p53708
aVDo not use  or a iteration buffer, since you do not need the overhead of finding line endings
p53709
aVUse the same mode for both reading and writing; this is especially important when using Python 3; I've used binary mode for both here
p53710
as(dp53711
g16
V100297
p53712
stp53713
a((dp53714
g2
(lp53715
VYou don't
p53716
aVand  are not objects, they are operators, part of the language
p53717
aVJust use strings for those
p53718
aVuses string formatting to interpolate  and  into a string; note the  and  are already part of the string
p53719
as(dp53720
g16
V100297
p53721
stp53722
a((dp53723
g2
(lp53724
VThe  objects basically 'empty' proxies
p53725
aVThey point to the original dictionary
p53726
aVUnfortunately, the current dictionary view objects are not really reusable
p53727
aVQuoting from the source code:
p53728
aVNote the  entry; these objects do not support arbitrary mappings, nor can we create new instances or subclass these from Python code:
p53729
aVYou are forced to create your own and implement all the hooks the view objects support:
p53730
aVetc
p53731
aVThe methods the original objects implement are:
p53732
aVThe , , , , , ,  and  methods implement overrides for the ,  and  operators to provide set operations
p53733
aVIf you are reasonably secure in reading C code, take a look at the view objects implementation to peek at how they implement their methods
p53734
as(dp53735
g16
V100297
p53736
stp53737
a((dp53738
g2
(lp53739
VThe entry point is called , plural, you misspelled it as  (singular)
p53740
aVSee Automatic Script Creation in the  documentation
p53741
as(dp53742
g16
V100297
p53743
stp53744
a((dp53745
g2
(lp53746
VI strongly suspect that your indentation is incorrect, and by mixing spaces and tabs Python interprets your method as:
p53747
aVwhere  is left outside the loop and never increments
p53748
aVAlternatively,  could be indented too far:
p53749
aVYour function would return  for any case where there is a row with  below
p53750
aVYou can test for such problems by running your script with , where  tells python to look for inconsistent use of tabs and spaces and raise an error if it finds such problems
p53751
aVYou can simplify your code by using , and inlining the test, exiting reading the file early:
p53752
aVThe inner  loop can be simplified down further by using  and an generator expression:
p53753
aVas  stops looping once a result has been found
p53754
as(dp53755
g16
V100297
p53756
stp53757
a((dp53758
g2
(lp53759
VUse  to make all division float division
p53760
aVAlternatively, use  instead of  to interpret a string as a floating point number instead:
p53761
as(dp53762
g16
V100297
p53763
stp53764
a((dp53765
g2
(lp53766
VYou are double-encoding the JSON response
p53767
aVYou are receiving a string value, one that  could turn into Python objects
p53768
aVTo save that response to a file, do not encode, do not decode, just save it straight to the file object
p53769
aVThe most efficient way would be to use :
p53770
as(dp53771
g16
V100297
p53772
stp53773
a((dp53774
g2
(lp53775
VThe best method is to use  with a  default:
p53776
aVThen just use:
p53777
aVand the dictionary will create a new list for you if the key is not yet in the mapping
p53778
aVis a subclass of  and otherwise behaves just like a normal  object
p53779
aVWhen using a standard ,  correctly sets  for you to the default, so that version should have worked just fine
p53780
aVYou can chain that call with :
p53781
aVHowever, by using  you replace the value for  with the output of , which is
p53782
as(dp53783
g16
V100297
p53784
stp53785
a((dp53786
g2
(lp53787
V instances are objects too
p53788
aVBut their keys are just not exposed as as attributes
p53789
aVExposing the keys as attributes (too or instead of item access) would lead to namespace pollution; you'd never be able to use a  key, for example
p53790
aVis already an attribute on dictionaries:
p53791
aVAttributes of objects and the contents of dictionaries are two separate things, and the separation is deliberate
p53792
aVYou can always subclass  to add attribute access using the  hook method:
p53793
aVDemo:
p53794
aVExisting attributes on the  class take priority:
p53795
as(dp53796
g16
V100297
p53797
stp53798
a((dp53799
g2
(lp53800
VMove  outside of the - block:
p53801
aVIf any of the imports before the  line fails, the rest of the block is not executed, and  is never imported
p53802
aVInstead, execution jumps to the exception handling block, where you then try to access a non-existing name
p53803
as(dp53804
g16
V100297
p53805
stp53806
a((dp53807
g2
(lp53808
VYou are looking at byte string values, printed as  results because they are contained in a dictionary
p53809
aVString representations can be re-used as Python string literals and non-printable and non-ASCII characters are shown using string escape sequences
p53810
aVContainer values are always represented with  to ease debugging
p53811
aVThus, the string 'K\u005cxc3\u005cxa4se' contains two non-ASCII bytes with hex values C3 and A4, a UTF-8 combo for the U+00E4 codepoint
p53812
aVYou should decode the values to  objects:
p53813
aVor better still, use  to decode the file as you read it:
p53814
aVPrinting the resulting dictionary will still use  results for the contents, so now you'll see  instead, because  is the escape code for Unicode point 00E4, the  character
p53815
aVPrint individual words if you want the actual characters to be written to the terminal:
p53816
aVBut now you can compare these values with other data that you decoded, provided you know their correct encoding, and manipulate them and encode them again to whatever target codec you needed to use
p53817
aVwill do this automatically, for example, when printing unicode values to your terminal
p53818
aVYou may want to read up on Unicode and Python:
p53819
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p53820
aVby Joel Spolsky
p53821
aVThe Python Unicode HOWTO
p53822
aVPragmatic Unicode by Ned Batchelder
p53823
as(dp53824
g16
V100297
p53825
stp53826
a((dp53827
g2
(lp53828
VYou can use a  object:
p53829
aVor, a little more complex to drop the :
p53830
aVThe  method returns the counts in descending sorted order by count, but you can also just use normal dictionary access to list the number-count pairs in arbitrary order
p53831
as(dp53832
g16
V100297
p53833
stp53834
a((dp53835
g2
(lp53836
VYou can use the  function to get arbitrary attributes named in a variable from the module:
p53837
aVSimply use  to ask the user for either  or  and you are set
p53838
aVYou may want to use a / to catch mistakes:
p53839
as(dp53840
g16
V100297
p53841
stp53842
a((dp53843
g2
(lp53844
VYou assigned to a local name :
p53845
aVNow  is an integer and shadows the built-in function
p53846
aVYou want to use a different name there instead:
p53847
aVOther tips:
p53848
aVUse  instead of testing for equality to :
p53849
aVDitto for testing for ; that is what  already does:
p53850
as(dp53851
g16
V100297
p53852
stp53853
a((dp53854
g2
(lp53855
VThis is an educated guess, based solely on eyeballing your code:
p53856
aVYou refer to  in the  method, but don't define it in that method
p53857
aVis a local name in a different method instead
p53858
aVIf you want to reach the  object you assigned to  in the  method, store a reference to it on  so you can refer to it in other methods too:
p53859
as(dp53860
g16
V100297
p53861
stp53862
a((dp53863
g2
(lp53864
VUse the  module to do proper timings
p53865
aVIt avoids common pitfalls, uses the most precise timer implementation for your platform and tries to minimise the influence of OS scheduling by repeating the tested code many times
p53866
aVUsing a profiler on the other hand adds a lot of overhead to support instrumenting the full call stack;  measures the complete execution time, not individual calls in the stack
p53867
aVUsing  shows the two versions are too close to call (default is 1 million iterations):
p53868
aVBoth operations are one bytecode:
p53869
as(dp53870
g16
V100297
p53871
stp53872
a((dp53873
g2
(lp53874
VYour parenthesis are unbalanced; there are 2 opening parenthesis, and 3 closing parenthesis; that is one closing parenthesis too many:
p53875
aVYou probably want to remove the closing parenthesis after :
p53876
as(dp53877
g16
V100297
p53878
stp53879
a((dp53880
g2
(lp53881
VThere is no need to open the  object, it is already an open file object:
p53882
aVAll that  needs is an iterable object
p53883
aVA  object fits that requirement
p53884
aVDemo:
p53885
as(dp53886
g16
V100297
p53887
stp53888
a((dp53889
g2
(lp53890
VYou need to explicitly translate your message string, using  and :
p53891
aVNormally, templates take care of these steps for you, but for JSON you'll need to do so yourself
p53892
aVYou probably want to define a  for your project, and reuse that to produce your message strings
p53893
aVAdd the following to your project:
p53894
aVthen use:
p53895
as(dp53896
g16
V100297
p53897
stp53898
a((dp53899
g2
(lp53900
VI cannot actually make  work
p53901
aVis almost the same file, but is actually used by the  codebase
p53902
aVMy conclusion is that that file and probably the whole  directory is a left-over from an earlier development stage and the author simply has forgotten to clean it up
p53903
aVThe  import is otherwise nothing more but a broken import
p53904
aVIt does not magically transform into importing the  package
p53905
aVdoes work, and uses  instead
p53906
as(dp53907
g16
V100297
p53908
stp53909
a((dp53910
g2
(lp53911
VUse an absolute path
p53912
aVYou can get the path of the script to create that path:
p53913
aVOtherwise, relative files (anything without an absolute path) are opened relative to the current working directory, and that depends entirely on how you started the script and your operating system defaults
p53914
aVThe  variable is the filename of the current module, the  calls ensure it is a full absolute path (so including the drive when on Windows, starting with a  on POSIX systems), from which we then take just the directory portion
p53915
as(dp53916
g16
V100297
p53917
stp53918
a((dp53919
g2
(lp53920
VYou are only referencing the function name
p53921
aVAdd parenthesis to actually call the function:
p53922
aVThis will print ; the return value is discarded as nothing captures it
p53923
aVYou could add an extra print statement to show the return value:
p53924
aVdoes not mean 'execute the function named', it means 'execute the python code given'
p53925
as(dp53926
g16
V100297
p53927
stp53928
a((dp53929
g2
(lp53930
VYou are looking for  instead
p53931
aVIt takes a mapping of unicode ordinals (integer numbers) and the values should be ordinals too, or unicode strings, or  to signal to delete that character:
p53932
aVDemo:
p53933
as(dp53934
g16
V100297
p53935
stp53936
a((dp53937
g2
(lp53938
VYou'll have to use a function match:
p53939
as(dp53940
g16
V100297
p53941
stp53942
a((dp53943
g2
(lp53944
VClasses already register what subclasses are defined; call the  method to get a list:
p53945
aVreturns a list of currently still alive subclasses
p53946
aVIf you ever would clear all references to  ( in the module, delete all instances, subclasses, imports, etc
p53947
aVthen it'd no longer be listed when you call
p53948
aVNote that in essence,  is a CPython implementation detail, but the method is present in all Python versions that support new-style classes (2
p53949
aV2 and up, all the way to 3
p53950
aVx)
p53951
aVOtherwise, the canonical way to hook into class creation is to define a metaclass:
p53952
aVDemo:
p53953
aVor you can use a class decorator:
p53954
aVDemo:
p53955
aVThe difference being where you put the responsibility of registering monsters; with the base  type, or with explicit decorators
p53956
aVEither way, the metaclass or the class decorator registers a permanent reference
p53957
aVYou can use the  module if you really, really want to emulate the  behaviour
p53958
as(dp53959
g16
V100297
p53960
stp53961
a((dp53962
g2
(lp53963
VTo evaluate expressions as Python, use the  function, passing in  as the namespace:
p53964
aVDo know this opens you up to attack vectors, where malicious users can execute arbitrary code and change your program to do completely different things
p53965
aVDemo:
p53966
as(dp53967
g16
V100297
p53968
stp53969
a((dp53970
g2
(lp53971
VTrim  to an empty list to prevent further traversing of directories below the current one:
p53972
aVNote that the above code alters the list  refers to with a slice assignment, it does not rebind  to a new list
p53973
as(dp53974
g16
V100297
p53975
stp53976
a((dp53977
g2
(lp53978
VUse a list comprehension to build a replacement list, where all elements are not equal to :
p53979
aVNote that in Python, the datatype is called a , not an array
p53980
as(dp53981
g16
V100297
p53982
stp53983
a((dp53984
g2
(lp53985
V is the most pythonic function to achieve just that:
p53986
aVloops over the first argument until that produces a result, then returns that
p53987
aVIf the first argument is exhausted,  is raised instead, unless a second argument is given, a default, in which case that value is returned instead of raising the exception
p53988
aVBy giving it a generator expression that embodies the search, you efficiently scan the  list for the first match
p53989
aVIf that turns out to be the default, then we continue to scan until we find the other match, or reach the end of the list
p53990
aVDemo:
p53991
aVThe above method is quite efficient in that it only has to scan the input list once, and the scan stops as soon as a match is found
p53992
aVNote that this function will raise  if the default is not present either:
p53993
aVYou could instead return  in that case by giving the first  call a default return value as well:
p53994
as(dp53995
g16
V100297
p53996
stp53997
a((dp53998
g2
(lp53999
VYou've encountered a simple bug in your code
p54000
aVThe rest room has a queue, to which Person objects are added for which there is no stall available
p54001
aVThe logic goes:
p54002
aVNote that either  removes a person from the  list, or if there are no stalls available, then the person is added to  and also removed from
p54003
aVThe  code then processes that queue:
p54004
aVSo people are taken from the queue, and reentered into the restroom
p54005
aVIf any of the stalls are empty,  tries to remove that person from  again
p54006
aVAt this point the exception is raised, because that person is most definitely not in that list anymore
p54007
aVThe solution is to not remove  from the population in two different places, or to re-add the person back into the population when processing the queue
p54008
aVChanging the queue processing code to:
p54009
aVfixes the issue, for example:
p54010
as(dp54011
g16
V100297
p54012
stp54013
a((dp54014
g2
(lp54015
VYou'll need to restart your server, it is running stale bytecode
p54016
aVThe source code shown does not match the exception (there is no global name  being accessed on that line, only an attribute )
p54017
aVTracebacks have to use the source code from disk when showing an exception, and if the source code has changed in the meantime the byte code and source code are out of sync and errors stop making sense
p54018
as(dp54019
g16
V100297
p54020
stp54021
a((dp54022
g2
(lp54023
VI sometimes need to send the information strictly in order
p54024
aVDon't use a dictionary then, use a list of tuples:
p54025
aVDictionaries and JSON objects do not have a set order
p54026
aVNeither will preserve your input order, nor are they required to
p54027
aVTo quote the JSON RFC:
p54028
aVAn object is an unordered collection of zero or more name/value pairs [
p54029
aVand the Python  documentation:
p54030
aVKeys and values are listed in an arbitrary order which is non-random, varies across Python implementations, and depends on the dictionary\u2019s history of insertions and deletions
p54031
as(dp54032
g16
V100297
p54033
stp54034
a((dp54035
g2
(lp54036
VYour data was written out as UTF-8:
p54037
aVThis either means you did not write out Latin-1 data, or your source code was saved as UTF-8 but you declared your script (using a PEP 263-compliant header to be Latin-1 instead
p54038
aVIf you saved your Python script with a header like:
p54039
aVbut your text editor saved the file with UTF-8 encoding instead, then the string literal:
p54040
aVwill be misinterpreted by Python as well, in the same manner
p54041
aVSaving the resulting unicode value to disk as Latin-1, then reading it again as Latin-1 will preserve the error
p54042
aVTo debug, please take a close look at  in the first script
p54043
aVIf it looks like:
p54044
aVthen your source code encoding and the PEP-263 header are disagreeing on how the source code should be interpreted
p54045
aVIf your source code is correctly decoded the correct output is:
p54046
aVIf Spyder is stubbornly ignoring the PEP-263 header and reading your source as Latin-1 regardless, avoid using non-ASCII characters and use escape codes instead; either using  unicode code points:
p54047
aVor  one-byte escape codes for code-points below 256:
p54048
as(dp54049
g16
V100297
p54050
stp54051
a((dp54052
g2
(lp54053
VIf you need a new list, use slicing and concatenation:
p54054
aVPython slice notation allows for negative indices, interpreted as relative to the length of the list
p54055
aVis the same as ; slicing everything but the last three elements
p54056
aVYou can also alter  in-place by assigning to a slice:
p54057
aVreplaces the last 3 elements of  with all elements of
p54058
as(dp54059
g16
V100297
p54060
stp54061
a((dp54062
g2
(lp54063
VUse  to group your numbers per  value:
p54064
aVis an iterable that yields all contiguous strings that have the same second value (split on whitespace); your input has two  groups that are contiguous, for example
p54065
aVDemo:
p54066
aVor, if you wanted to actually sum the values as integers:
p54067
aVwhich prints
p54068
aVIf you just need the sums, make it a list comprehension:
p54069
as(dp54070
g16
V100297
p54071
stp54072
a((dp54073
g2
(lp54074
VUse a nested list comprehension:
p54075
aVso for each element  in , we create a new list with tuples containing
p54076
aVDemo:
p54077
as(dp54078
g16
V100297
p54079
stp54080
a((dp54081
g2
(lp54082
VJust concatenate the items to create a new list from  and the element from :
p54083
aVYou can simplify your loop using the  function:
p54084
aVThen move the whole definition of  to a list comprehension:
p54085
aVDemo:
p54086
as(dp54087
g16
V100297
p54088
stp54089
a((dp54090
g2
(lp54091
VMost of the time, you then want to use a conditional expression instead:
p54092
aVShort-circuiting is very Pythonic however, just be aware of the pitfalls where  is false-y; using short-circuiting will result in different result in that case
p54093
aVMost of the time, you do not want to assign  instead
p54094
aVEven in that case, you can still get the same result with an adjusted condition:
p54095
aVShort-circuiting is great for defaults:
p54096
aVor for making sure pre-conditions are met:
p54097
as(dp54098
g16
V100297
p54099
stp54100
a((dp54101
g2
(lp54102
VYou included a newline in your MD5 input string:
p54103
aVWhen reading data from a file, make sure you remove the newline character at the end of the lines
p54104
aVYou can use  to just remove line separation characters from the end of the line, or use  to remove all whitespace from start or end of the line:
p54105
as(dp54106
g16
V100297
p54107
stp54108
a((dp54109
g2
(lp54110
VYou are using assignment where you wanted to test for equality
p54111
aVUse two  signs:
p54112
aVis an assignment statement, and you cannot use statements inside of other statements;  tests if  is equal to 0
p54113
as(dp54114
g16
V100297
p54115
stp54116
a((dp54117
g2
(lp54118
VAll you need is to subclass  and add a  function:
p54119
aVThe default  type will call a  method if present before raising a , which is what the  type makes use of
p54120
aVSee the  documentation (scroll down to the  description):
p54121
aVNew in version 2
p54122
aV5: If a subclass of dict defines a method , if the key key is not present, the  operation calls that method with the key key as argument
p54123
aVThe  operation then returns or raises whatever is returned or raised by the  call if the key is not present
p54124
aVNo other operations or methods invoke
p54125
aVIf  is not defined,  is raised
p54126
aVmust be a method; it cannot be an instance variable
p54127
aVDemo:
p54128
as(dp54129
g16
V100297
p54130
stp54131
a((dp54132
g2
(lp54133
VUse  the  module:
p54134
aVDemo:
p54135
aVAn alternative could be to use  and ; for just lists, tuples and integers that also allows you to round-trip:
p54136
aVJSON has the added advantage that it is a standard format; other tools outside of Python support serialising, parsing and validation
p54137
as(dp54138
g16
V100297
p54139
stp54140
a((dp54141
g2
(lp54142
VSort each value in your dictionary based on the  source list, using  and , all in just 3 lines of code:
p54143
aVDemo:
p54144
as(dp54145
g16
V100297
p54146
stp54147
a((dp54148
g2
(lp54149
VBasically, you want to see if you can traverse the tree; use  to loop over the elements and if a  is raised, the path doesn't exist:
p54150
aVapplies the  function recursively to , starting with
p54151
aVTo support finding lineages deeper down the tree, you need to recurse down the tree on s
p54152
aVDemo:
p54153
as(dp54154
g16
V100297
p54155
stp54156
a((dp54157
g2
(lp54158
VYou need to loop over the  list to test each word:
p54159
aVThe  clause is part of the  statement; it is executed when the loop was not interrupted by a  statement, so in this case if none of the values from  matched
p54160
aVThis can be shortened with the  function and a generator expression:
p54161
as(dp54162
g16
V100297
p54163
stp54164
a((dp54165
g2
(lp54166
VYou installed a different Twitter API module; you installed  1
p54167
aV10
p54168
aV0, not
p54169
aVThe APIs between the two projects differ significantly:
p54170
aVYou may want to uninstall  and install  instead
p54171
aVHowever, if all you need is a good Twitter API package for Python, take a look at the list that Twitter maintains
p54172
aVTweepy and a different  package are under active maintenance
p54173
as(dp54174
g16
V100297
p54175
stp54176
a((dp54177
g2
(lp54178
VUse a mutually exclusive group:
p54179
aVOnly one argument in the group is allowed to be used
p54180
aVDemo:
p54181
as(dp54182
g16
V100297
p54183
stp54184
a((dp54185
g2
(lp54186
VFirst of all, you are misunderstanding how your command line is being parsed
p54187
aVYou pass in:
p54188
aVwhich means that Python sees:
p54189
aVand the  thus parses just  as the value for the  switch
p54190
aVAs a result,  is set to , and  on that value results in  because there is no  (comma and space) in that input string
p54191
aVTo include spaces in an argument, use quoting on the command line:
p54192
aVbut you really want to adjust your command-line parsing to split just on commas and tolerate spaces instead:
p54193
aVAnother thing to understand is that splitting a string using  will result in a list with at least one element:
p54194
aVso your test for  will always be
p54195
aVNote that the normal Python idiom is to use  for  instead () because  is a singleton
p54196
as(dp54197
g16
V100297
p54198
stp54199
a((dp54200
g2
(lp54201
VYou want to loop over the split values:
p54202
aVthen use a set to make the whole list unique:
p54203
aVor just use a set and be done with it:
p54204
aVDemo:
p54205
aVIf order matters (the above code returns words in arbitrary order, the sorted order is a coincidence by virtue of the implementation details of CPython), use a separate set to track duplicate values:
p54206
aVTo illustrate the difference, a better input sample:
p54207
as(dp54208
g16
V100297
p54209
stp54210
a((dp54211
g2
(lp54212
VUse a combination  and splitting on all whitespace with :
p54213
aVThis treats each line separately, removes empty lines, and then collapses all whitespace per line into single spaces
p54214
aVProvided the input is a Python 3 string, the same solution works across both Python versions
p54215
aVDemo:
p54216
aVTo preserve tabs, you'd need to strip and split on just spaces and filter out empty strings:
p54217
aVDemo:
p54218
as(dp54219
g16
V100297
p54220
stp54221
a((dp54222
g2
(lp54223
V is defined as a function in the class body of  only
p54224
aVA class body is executed like a function to define the class; the resulting local namespace is used to form the class attributes
p54225
aVThis is why  is still a local name within  when used as a decorator on
p54226
aVYou could compare that with defining the decorator inside a function, then trying to apply it outside of that function; it won't work, because the decorator is a local variable
p54227
aVYou could use  in class  ( to unwrap the function from the method wrapper):
p54228
aVBetter still, do not defined the decorator inside a class at all but instead defined it outside of
p54229
aVIt is not a method, after all:
p54230
as(dp54231
g16
V100297
p54232
stp54233
a((dp54234
g2
(lp54235
VYou have found an easter egg in Python
p54236
aVIt is a joke
p54237
aVIt means that delimiting blocks by braces instead of indentation will never be implemented
p54238
aVNormally, imports from the special  module enable features that are backwards-incompatible, such as the  function, or true division
p54239
aVSo the line  is taken to mean you want to enable the 'create blocks with braces' feature, and the exception tells you your chances of that ever happening are nil
p54240
aVYou can add that to the long list of in-jokes included in Python, just like ,  and
p54241
aVThe Python developers have a well-developed sense of humour
p54242
as(dp54243
g16
V100297
p54244
stp54245
a((dp54246
g2
(lp54247
VYour outer list comprehension has a nested generator expression:
p54248
aVNote the  part there; those are the generator objects you see in you output
p54249
aVMake that a list comprehension too perhaps:
p54250
aVHowever, if you wanted to apply the function on every pairing of elements from , you probably wanted:
p54251
aVDemo:
p54252
aVYou could use the  utility funcnion to produce the pairings:
p54253
aVNext, adjust the  function to take two inputs, and perhaps use a more optimum approach using integers:
p54254
aVThe latter version blows the old way out of the water when it comes to speed:
p54255
as(dp54256
g16
V100297
p54257
stp54258
a((dp54259
g2
(lp54260
VYou defined a  class whose initializer method requires two arguments:
p54261
aVyet you try to create one without passing in those arguments:
p54262
aVPass in a length and width instead:
p54263
aVYour next problem is that  is not defined, you probably want to calculate that:
p54264
aVOn a design note: normally in Python you do not use 'private' variables like that; simply use normal attributes instead:
p54265
aVand directly get or set those attributes on the instance as needed:
p54266
aVAttributes that start with a double underscore () are meant to avoid subclasses from accidentally redefining them; the aim is to protect those attributes from being clobbered because they are vital to the internal working of the current class
p54267
aVThe fact that their names get mangled and thus are less accessible does not really make them private, just harder to reach
p54268
aVWhatever you do, do not mistake them for private names like you would in Java, for example
p54269
as(dp54270
g16
V100297
p54271
stp54272
a((dp54273
g2
(lp54274
VLoop over the file object, line by line, then split the lines:
p54275
aVThe  call applies the default split algorithm (split on arbitrary-width whitespace), but limits it to just one split to return just 2 items
p54276
aVThe advantage is that lines that start with whitespace (such as the  line in your post) are handled correctly too as the leading whitespace is removed before splitting
p54277
aVThis produces:
p54278
as(dp54279
g16
V100297
p54280
stp54281
a((dp54282
g2
(lp54283
VOS X packages (and bundles) are usually defined by their extension
p54284
aVSimply create a directory with an  extension to see it be presented as a (broken) application in the Finder
p54285
aVThe official documentation lists the following ways to define bundles:
p54286
aVThe Finder considers a directory to be a package if any of the following conditions are true:
p54287
aVThe directory has a known filename extension:
p54288
aVapp,
p54289
aVbundle,
p54290
aVframework,
p54291
aVplugin,
p54292
aVkext, and so on
p54293
aVThe directory has an extension that some other application claims represents a package type; see \u201cDocument Packages
p54294
aV\u201d
p54295
aVThe directory has its package bit set
p54296
aVThe preferred way to specify a package is to give the package directory a known filename extension
p54297
aVFor the most part, Xcode takes care of this for you by providing templates that apply the correct extension
p54298
aVAll you have to do is create an Xcode project of the appropriate type
p54299
aVThe simplest way to detect packages then is to detect those extensions
p54300
aVThe quick and dirty way is to simply look for a hard-coded list of extensions, using the above documentation as your guide
p54301
aVThe next step up is to query the OS if a given extension has been registered as a Document Package
p54302
aVSee How to check whether directories with a given extension are shown by the Finder as a package
p54303
aVTo detect the package bit on directories, you'll have to use the  library to retrieve the  key and then use the  header info to decode the binary data returned; the  flag is 0x2000:
p54304
as(dp54305
g16
V100297
p54306
stp54307
a((dp54308
g2
(lp54309
VSimply slice your row to get the first 2 elements, concatenate the 3rd and 4th:
p54310
aVAlternatively, unpack the elements first:
p54311
aVDemo:
p54312
aVYou created a tuple of the first 2 elements, plus the second two elements concatenated with :
p54313
aVresulting in a nested structure of
p54314
as(dp54315
g16
V100297
p54316
stp54317
a((dp54318
g2
(lp54319
VUse  to make sure input text is treated as literal text in a regular expression:
p54320
aVDemo:
p54321
aVescapes all non-alphanumerics; adding a backslash in front of each such a character:
p54322
as(dp54323
g16
V100297
p54324
stp54325
a((dp54326
g2
(lp54327
VYou are looping over a dictionary:
p54328
aVbut that only yields keys, so one single object at a time
p54329
aVIf you want to loop over keys and values, use the  method:
p54330
aVOn Python 2, use the  method for efficiency:
p54331
as(dp54332
g16
V100297
p54333
stp54334
a((dp54335
g2
(lp54336
VWrite the headers separately, by creating a new  for the rows:
p54337
aVobjects have no way of switching between dialects
p54338
aVJust create a new object if you have to use a different dialect for some rows
p54339
as(dp54340
g16
V100297
p54341
stp54342
a((dp54343
g2
(lp54344
VAvoid writing such overly convoluted code in the first place:
p54345
aVWhy generate a default to be parsed out to a timetuple again instead of just going there straight
p54346
as(dp54347
g16
V100297
p54348
stp54349
a((dp54350
g2
(lp54351
VBecause you are basing values on multiple input keys, use a loop, not a comprehension
p54352
aVUsing a  object makes the logic a little simpler too:
p54353
aVOutput:
p54354
as(dp54355
g16
V100297
p54356
stp54357
a((dp54358
g2
(lp54359
VBecause garbage collection only deals with circular references
p54360
aVQuoting from the  module documention:
p54361
aVSince the collector supplements the reference counting already used in Python, you can disable the collector if you are sure your program does not create reference cycles
p54362
aVCPython uses reference counting to clean up most objects
p54363
aVWhen you replace the list  referred to with an empty list, the reference counts for the old list dropped to 0, so it is deleted at that point
p54364
aVDeleting the list causes the reference counts for the  instances to drop to 0 too, etc
p54365
aVIf you create circular references instead, and disable garbage collection, you'll see the numbers remain constant:
p54366
as(dp54367
g16
V100297
p54368
stp54369
a((dp54370
g2
(lp54371
VYou are not splitting the line, you are only taking the character at position 1
p54372
aVUse  to split the line once on :
p54373
aVYou may want to use a set instead to avoid the same page number being added twice
p54374
aVYou can also use  to simplify this a little further still:
p54375
aVThis gives:
p54376
aVfor your input text; a  is a subclass of  and behaves just like a normal dictionary, except that it'll create a new  for each key you try to access but is not yet present
p54377
as(dp54378
g16
V100297
p54379
stp54380
a((dp54381
g2
(lp54382
VNo; copying over  may work, but is likely only the tip of the iceberg
p54383
aVDjango 1
p54384
aV5 requires Python 2
p54385
aV6 or newer
p54386
aVDo not try to run in on Python 2
p54387
ag2176
aVYou could downgrade to Django 1
p54388
aV4 instead, which does support Python 2
p54389
ag2176
as(dp54390
g16
V100297
p54391
stp54392
a((dp54393
g2
(lp54394
VAssuming you mean to include a fixed CSV file with your code, store an absolute path based on the script path:
p54395
aVis the filename of the current module or script,  is the directory the module resides in
p54396
aVFor scripts,  can be a relative pathname, so we use  to turn that into an absolute path
p54397
aVThis means you can run your script from anywhere
p54398
aVIf you meant to make your script work with arbitrary CSV input files, use command line options:
p54399
aVwhere  will be an open file object, so your  can just do:
p54400
as(dp54401
g16
V100297
p54402
stp54403
a((dp54404
g2
(lp54405
VWrap the file in a generator function to strip quotes:
p54406
aVthen use that function like:
p54407
aVThe  class happily takes any iterable object, not just files
p54408
aVThe  function can be adjusted to fit your specific file contents
p54409
aVIf there are quotes around columns as well, you could remove just one quote from the start and end of the line, for example
p54410
as(dp54411
g16
V100297
p54412
stp54413
a((dp54414
g2
(lp54415
VInstead of mocking, you could simply subclass the database class and test against that:
p54416
aVand instantiate that class instead of  for your tests
p54417
aVThe methods are still the same, the behaviour will still be the same, but now all methods using  use your test-supplied connection instead
p54418
as(dp54419
g16
V100297
p54420
stp54421
a((dp54422
g2
(lp54423
VYou cannot alter the target list ( in this case) of a  loop
p54424
aVUse a  loop instead:
p54425
aVAlternatively, use an iterable and increment that:
p54426
aVBy assigning the result of  to a local variable, we can advance the loop sequence inside the loop using standard iteration tools (, or here, a shortened version of the  consume recipe)
p54427
aVnormally calls  for us when looping over a iterator
p54428
as(dp54429
g16
V100297
p54430
stp54431
a((dp54432
g2
(lp54433
VYou can stuff an arbitrary object into the  structure:
p54434
aVThe Python import machinery will look up objects using attribute access, triggering the  method on your  instance
p54435
aVDo this in the  or  file and you are all set to go
p54436
aVThe  package does need to exist for the import machinery to find the  object
p54437
as(dp54438
g16
V100297
p54439
stp54440
a((dp54441
g2
(lp54442
VYour  command-line switch wants to have an argument
p54443
aVMake it a switch instead:
p54444
aVNote that I removed the  argument, you want the result to be stored in , not
p54445
aVYour  function needs to return the result of :
p54446
aVThere won't be a , just test for  only, and you want to sum the  attribute, not the  namespace object itself
p54447
aVYou probably wanted to print the result:
p54448
aVIf you wanted to use a loop instead, loop over :
p54449
as(dp54450
g16
V100297
p54451
stp54452
a((dp54453
g2
(lp54454
VUse the  class:
p54455
aVDemo:
p54456
aVI'd use a  object to count the characters:
p54457
aVResult:
p54458
as(dp54459
g16
V100297
p54460
stp54461
a((dp54462
g2
(lp54463
VUse a generator expression as that one argument:
p54464
aVHere the predicate is in the expression side of the generator expression, but you can use any expression there, including using functions
p54465
aVDemo:
p54466
aVThe generator expression will be iterated over until  finds a  result, and no further:
p54467
as(dp54468
g16
V100297
p54469
stp54470
a((dp54471
g2
(lp54472
VUse  and  to efficiently limit the number of results you can loop over:
p54473
aVEven if there are many, way too many matches in a directory, you'll never handle more than the first 1000 matches, without creating several lists with matching filenames
p54474
as(dp54475
g16
V100297
p54476
stp54477
a((dp54478
g2
(lp54479
VYes, it is wrong; you'll need to accept a argument that tells your script where to find the CSV files:
p54480
aVNow your script accepts one command-line argument, a path to the directory to list your files in:
p54481
aVThe default is to look in the current directory still
p54482
as(dp54483
g16
V100297
p54484
stp54485
a((dp54486
g2
(lp54487
VIt means  consists of an incomplete Python statement
p54488
aVAn empty string would do that, for example:
p54489
aVIf your inputs consist of integers, use  instead for clearer error messages, and check for empty lines
p54490
aVThere are better ways to build your data structure; a list comprehension for example:
p54491
aVThis structure is enough to hold all the totals; there is no point in keeping per-hour values when you can just sum the whole thing per day instead
p54492
aVI'd read from  instead of using , summing the temperature and humidity per day directly:
p54493
aVand calculating the averages becomes:
p54494
as(dp54495
g16
V100297
p54496
stp54497
a((dp54498
g2
(lp54499
VThe parameters set on the request object are not taken into account (nor should they) when issuing a redirect
p54500
aVAppend a query string to the redirection URL instead;  does the job admirably:
p54501
aVThe  call returns a 303 See Other response with the URL you passed in the the method as the  header; the browser then opens that new location, and will include any GET parameters you added to the URL
p54502
as(dp54503
g16
V100297
p54504
stp54505
a((dp54506
g2
(lp54507
VEach sub-command has it's own help; try , for example
p54508
aVYou'd have to override the help action yourself, and loop over the subcommands and print help for each
p54509
aVThis requires some foibling with internal attributes:
p54510
aVYou probably want to tweak the output some more though
p54511
as(dp54512
g16
V100297
p54513
stp54514
a((dp54515
g2
(lp54516
VYou can exit any loop with :
p54517
aVIf neither of the  statements evaluate to , the loop continues
p54518
aVis an exception, usually raised by iterators to signal that they are done
p54519
aVMost Python code that uses it only needs to catch that exception, but if you wanted to raise it, use a  statement
p54520
aVThere is no point in doing so here; your script is not being run as an iterator and the  exception will not have the desired effect
p54521
as(dp54522
g16
V100297
p54523
stp54524
a((dp54525
g2
(lp54526
VYes, use slicing to pick a random number of characters from the string, no need to split it into a list first:
p54527
aVStrings are sequences too and support slicing directly without needing to turn it into a list first
p54528
aVYou can omit the end-point, slicing defaults to the end of the string in that case
p54529
as(dp54530
g16
V100297
p54531
stp54532
a((dp54533
g2
(lp54534
VSimply use string methods to split the html text and take the first part;  works much simpler:
p54535
aVIf you wanted to keep the  text too, use:
p54536
aVThere is no need to use a regular expression here; you are matching literal text
p54537
aVRegular expressions is a wonderfully expressive and powerfool tool, but don't use it if there are simpler alternatives
p54538
aVDemo:
p54539
as(dp54540
g16
V100297
p54541
stp54542
a((dp54543
g2
(lp54544
VThe form on that page sends a GET request to , not to
p54545
aVA GET request appends url-encoded query parameters to the URL with a :
p54546
as(dp54547
g16
V100297
p54548
stp54549
a((dp54550
g2
(lp54551
VYou'll have to convert the sets to lists too if you want to apply ordering
p54552
aVThe  function gives you a sorted list from any iterable, letting you skip a step:
p54553
aVShort demo:
p54554
as(dp54555
g16
V100297
p54556
stp54557
a((dp54558
g2
(lp54559
VThe Python  and  functions, like the Python slice notation, do not include the end value;  generates 8 numbers from  to , not 10
p54560
aVmakes sure  is part of the generated range
p54561
aVUse  or  to see the difference; 10 is not a prime number and is being filtered out
p54562
as(dp54563
g16
V100297
p54564
stp54565
a((dp54566
g2
(lp54567
VPython does not have a multidimensional array type
p54568
aVIt only has lists
p54569
aV(a 3rd-party Python extension) does have array types, and these serve a specialized function within that library, namely fast C-based mathematical operations on homogenous sequences
p54570
aVWith the standard Python  type, putting one inside the other creates a nested structure that can be used to model a multidimensional structure
p54571
aVYou nest the  item access,  first retrieves the second element of the outer list, then the 43rd element of that second element
p54572
aVarrays are specialist structures that explicitly model multiple dimensions as part of the main type, rather than nesting arrays inside arrays, and that means they can support addressing of multiple dimensions in the  syntax, where  comes in the form of a tuple, technically
p54573
aVPython does have a single dimensional  type, that, like  arrays, models homogenous C-type sequences
p54574
as(dp54575
g16
V100297
p54576
stp54577
a((dp54578
g2
(lp54579
VThere is no real advantage
p54580
aVGuido added the module 1998; the first revision already includes those factory functions
p54581
aVPerhaps he had plans for those factory functions, perhaps he was looking at the Java implementation and copied over some idioms, perhaps he wanted to make things pluggable with a C re-implementation in the back of his head
p54582
aVWe can only guess, or ask Guido directly
p54583
as(dp54584
g16
V100297
p54585
stp54586
a((dp54587
g2
(lp54588
VFrom the Windows Sockets Error Codes list:
p54589
aVWSAECONNABORTED 10053
p54590
aVSoftware caused connection abort
p54591
aVAn established connection was aborted by the software in your host computer, possibly due to a data transmission time-out or protocol error
p54592
aVThere was a timeout or other network-level error
p54593
aVThis is your operating system closing the socket, nothing to do with Python or Flask, really
p54594
aVIt could be the remote browser stopped responding, the network connection died, or a firewall closed the connection because it was open too long, or any other number of reasons
p54595
as(dp54596
g16
V100297
p54597
stp54598
a((dp54599
g2
(lp54600
VYes, do not use tabs when indenting
p54601
aVIt is too easy to mix tabs and spaces
p54602
aVQuoting from the PEP 8 Python Style Guide:
p54603
aVNever mix tabs and spaces
p54604
aVThe most popular way of indenting Python is with spaces only
p54605
aVThe second-most popular way is with tabs only
p54606
aVCode indented with a mixture of tabs and spaces should be converted to using spaces exclusively
p54607
aVWhen invoking the Python command line interpreter with the -t option, it issues warnings about code that illegally mixes tabs and spaces
p54608
aVWhen using -tt these warnings become errors
p54609
aVThese options are highly recommended
p54610
aVFor new projects, spaces-only are strongly recommended over tabs
p54611
aVMost editors have features that make this easy to do
p54612
aVEmphasis mine
p54613
aVFirst, detect inconsistent indentation by running your code with
p54614
aVFix those errors
p54615
aVThen convert tabs to spaces, and configure your editor to only use spaces for indentation
p54616
aVThe Python Style Guide recommends 4 spaces per indentation level, and so do I
p54617
as(dp54618
g16
V100297
p54619
stp54620
a((dp54621
g2
(lp54622
VThe Wikipedia API returns JSON data, use the  module to decode:
p54623
aVDemo:
p54624
aVIf you instead have a string that starts with , you already have a Python unicode value and are looking at the representation of that string:
p54625
aVJust print that value to have Python encode it to your terminal codec and represent that em-dash character in a format your terminal will understand
p54626
aVYou may want to read up about Python and Unicode and encodings before you continue, if you do not understand what the difference is between a unicode value and byte strings:
p54627
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p54628
aVby Joel Spolsky
p54629
aVThe Python Unicode HOWTO
p54630
aVPragmatic Unicode by Ned Batchelder
p54631
as(dp54632
g16
V100297
p54633
stp54634
a((dp54635
g2
(lp54636
VYou are collecting the existing tuple, then creating a new tuple with that existing tuple nested into it:
p54637
aVInstead, append a new one-element tuple:
p54638
aVYou certainly should leave your one-element values to be just a rectangle, start with a one-element tuple:
p54639
aVor, much better still, use a list, you are after all altering it constantly:
p54640
aVIf you make  a  object you don't even have to test for the key first:
p54641
as(dp54642
g16
V100297
p54643
stp54644
a((dp54645
g2
(lp54646
VNo, there is no way to put an exception handler in one line
p54647
aVYou can only put simple statements on one line, and  -  is a compound statement
p54648
aVThere are also no functions that'll swallow exception for you
p54649
aVThe only way you'd be able to pull something like this off in one line, is to create a new code object from raw bytes that define the bytecodes for a blanket  -  construct
p54650
aVUsing that bytecode you would then go on to create a function that swallows exceptions
p54651
aVHowever, I am not going to write one for you
p54652
aVSorry
p54653
as(dp54654
g16
V100297
p54655
stp54656
a((dp54657
g2
(lp54658
VUse the  module to print tracebacks from your current position or for a given exception
p54659
aVYou don't state what output you are expecting, but the  module most likely will be able to produce output best suited for your needs, whatever they may be
p54660
as(dp54661
g16
V100297
p54662
stp54663
a((dp54664
g2
(lp54665
VYou can't
p54666
aVJust store the return value first:
p54667
as(dp54668
g16
V100297
p54669
stp54670
a((dp54671
g2
(lp54672
VDo not use a profiler to measure overall timing differences between two snippets of Python code
p54673
aVA profile severely impacts code execution times across the interpreter, as different code paths will trigger the  trace function at different times, and the trace function itself could introduce subtle timing differences for different events that completely skew the results making your data useless for absolute timing comparisons
p54674
aVWhen profiling, you are as much measuring how the the profiler reacts to different code paths as that you are measuring the code paths themselves
p54675
aVThat's fine for when you want to pinpoint where in complex code all your execution time goes, but it is terrible for comparing two different pieces of code purely on how fast they perform
p54676
aVThat leaves just your  results, which are too close to call
p54677
aVBoth methods are about as fast as one another
p54678
as(dp54679
g16
V100297
p54680
stp54681
a((dp54682
g2
(lp54683
VYou could reraise the exception, and handle the generic case in the outer handler of a nested setup:
p54684
aVThe unqualified  statement re-raises the current exception, so the  exception is thrown again to be handled by the  handler
p54685
aVThe other path you could take is to test for the exception type:
p54686
as(dp54687
g16
V100297
p54688
stp54689
a((dp54690
g2
(lp54691
V works because a cursor is an iterable; you can also use  in a loop:
p54692
aVA good database adapter implementation will fetch rows in batches from the server, saving on the memory footprint required as it will not need to hold the full result set in memory
p54693
aVhas to return the full list instead
p54694
aVThere is little point in using  over ; the end effect is then indeed the same, but you wasted an opportunity to stream results instead
p54695
as(dp54696
g16
V100297
p54697
stp54698
a((dp54699
g2
(lp54700
VUse a generator expression, looping over all the dictionaries then their values:
p54701
aVFor Python 3, substitute  with
p54702
aVDemo:
p54703
as(dp54704
g16
V100297
p54705
stp54706
a((dp54707
g2
(lp54708
VYou can't
p54709
aVScoped names (closures) are determined at compile time, you cannot add more at runtime
p54710
aVThe best you can hope to achieve is to add global names, using the function's own global namespace:
p54711
aVis the global namespace for the wrapped function, so this works even if the decorator lives in a different module
p54712
aVIf  was defined as a global already, it is replaced with the new value, and after calling the function, the globals are restored
p54713
aVThis works because any name in a function that is not assigned to, and is not found in a surrounding scope, is marked as a global instead
p54714
aVDemo:
p54715
aVBut instead of decorating, I could just as well have defined  in the global scope directly
p54716
as(dp54717
g16
V100297
p54718
stp54719
a((dp54720
g2
(lp54721
VUse the  module to handle your data; it'll remove the quoting and handle the splitting:
p54722
aVFor your sample input, this produces:
p54723
as(dp54724
g16
V100297
p54725
stp54726
a((dp54727
g2
(lp54728
VThe  module is not part of the Python standard library
p54729
aVYou need to install it first
p54730
aVInstallation instructions are included
p54731
aVOnce installed, use , not ; the latter means import the  name from the  module or package
p54732
aVPython imports should use just the name of the module, so not the filename with extenion
p54733
aVPython can import code from more than just  python files
p54734
as(dp54735
g16
V100297
p54736
stp54737
a((dp54738
g2
(lp54739
VUse the  module to wrap text at a certain linewidth, and optionally handle indentation
p54740
aVTo wrap lines at a certain width, then add your own indentation, you could use:
p54741
aVThis wraps your  text to 100 characters wide, then indents the whole text except the first line with 11 spaces; you end up with text 111 characters wide
p54742
as(dp54743
g16
V100297
p54744
stp54745
a((dp54746
g2
(lp54747
VIf you are trying to transpose the rows and columns of your CSV file, you are going about it the wrong way
p54748
aVUse this instead:
p54749
aVis now a list of lists, each nested list a column from your  file object
p54750
aVYou are only zipping one row at a time, and you the empty string tuples are simply empty columns
p54751
aVLooking at your update, all you really want to do is slice your rows:
p54752
as(dp54753
g16
V100297
p54754
stp54755
a((dp54756
g2
(lp54757
VSomeone overlooked testing that method; the correct incantation is:
p54758
aVbecause the rest of the code proceeds to turn it into a , for both Python 2 and Python 3
p54759
aVI've issued a pull request, after talking with the maintainer on IRC
p54760
aVUpdate: the patch has now been merged
p54761
as(dp54762
g16
V100297
p54763
stp54764
a((dp54765
g2
(lp54766
VPython 2 orders objects of different types rather arbitrarily
p54767
aVIt did this to make lists always sortable, whatever the contents
p54768
aVWhich direction that comparison comes out as is really not of importance, just that one always wins
p54769
aVAs it happens, the C implementation falls back to comparing type names; 's type name is , which sorts before
p54770
aVIn Python 3, your code would raise an exception instead:
p54771
aVbecause, as you found out, supporting arbitrary comparisons mostly leads to hard-to-crack bugs
p54772
as(dp54773
g16
V100297
p54774
stp54775
a((dp54776
g2
(lp54777
VYou are nesting tuples; concatenate instead:
p54778
aVNow you create a tuple of 3 elements and the string formatting works
p54779
aVDemo:
p54780
aVand to illustrate the difference:
p54781
aVAlternatively, use :
p54782
aVHere we interpolate the first argument (), then the first element of the second argument (, formatting the value as an integer), then the second element of the second argument (, formatting the value as an integer with 2 digits and leading zeros)
p54783
as(dp54784
g16
V100297
p54785
stp54786
a((dp54787
g2
(lp54788
VYou need to JSON encode the dictionary
p54789
aVYou don't then need to put quotes around the dictionary, and JavaScript will see it as a JavaScript object
p54790
as(dp54791
g16
V100297
p54792
stp54793
a((dp54794
g2
(lp54795
VUse a  query per table:
p54796
as(dp54797
g16
V100297
p54798
stp54799
a((dp54800
g2
(lp54801
VIn this case, using a regular expression is probably the easiest, since some of your entries contain spaces
p54802
aVThe following expression finds anything that is not digits, followed by something that consists only of digits, dots and colons:
p54803
aVThis produces a dictionary object:
p54804
as(dp54805
g16
V100297
p54806
stp54807
a((dp54808
g2
(lp54809
VYou are rounding your error down to two decimal places by calling :
p54810
aVDon't do that if you want to show more precision:
p54811
aVYou do a lot of redundant work in your code, simplify it down a little:
p54812
as(dp54813
g16
V100297
p54814
stp54815
a((dp54816
g2
(lp54817
VCreate an inverse mapping of  first:
p54818
aVNow the rest is much simpler; you can look codes against that inverse mapping and find the corresponding name in O(1) time:
p54819
aVDemo:
p54820
aVGenerally speaking, do not loop over  when you can just loop directly over that list
p54821
aVYou can use the  function to add an index if you need one for other purposes
p54822
aVYour  and  lists are not of equal length, so you cannot just use indices that work in one on the other
p54823
aVYour approach would require nested loops (very inefficient, you are now looping over the whole of  for every entry in ):
p54824
as(dp54825
g16
V100297
p54826
stp54827
a((dp54828
g2
(lp54829
VAdd a new, valid line above the  loop, like a  statement
p54830
aVGet a syntax error there now
p54831
aVThen your list is not properly closed, you are missing a closing bracket on your first line
p54832
aVCheck if all your opening , , and  braces are matched with a corresponding ,  or
p54833
as(dp54834
g16
V100297
p54835
stp54836
a((dp54837
g2
(lp54838
VUse  to shuffle a list, in-place:
p54839
aVDemo:
p54840
aVIf you wanted to preserve  (maintain the order), you can use  with a random key to return a new randomized list:
p54841
aVThis leaves  unaltered:
p54842
as(dp54843
g16
V100297
p54844
stp54845
a((dp54846
g2
(lp54847
VIt is thread-safe only if item access is not handled by Python code
p54848
aVThe unpacking is handled by one bytecode:
p54849
aVProvided  is really a standard Python , that is threadsafe
p54850
aVAs soon as accessing items from  triggers a custom , all bets are off
p54851
as(dp54852
g16
V100297
p54853
stp54854
a((dp54855
g2
(lp54856
VYou are comparing strings, not numbers:
p54857
aVLexographically,  sorts before
p54858
aVRegular expressions work on strings, returned  matches are strings even when digits are matched
p54859
aVUse  to turn your strings into integers:
p54860
aVWhen trying to debug Python code, use  instead of  to detect type problems; had you used  you would have seen that  would be printed instead of  (so with quotes to denote a string)
p54861
as(dp54862
g16
V100297
p54863
stp54864
a((dp54865
g2
(lp54866
VJust add  to your  string:
p54867
aVIf you wanted to use spaces for delimiters instead of commas, configure your  to use a different delimiter:
p54868
as(dp54869
g16
V100297
p54870
stp54871
a((dp54872
g2
(lp54873
VYou are looking at  multidimensional array slicing
p54874
aVThe comma marks a tuple, read it as , which  arrays interpret as: first dimension to be sliced end-to-end (all rows) with , then for each row,  selects one column
p54875
aVSee Indexing, Slicing and Iterating in the  tutorial
p54876
as(dp54877
g16
V100297
p54878
stp54879
a((dp54880
g2
(lp54881
VUse a raw string literal:
p54882
aVbecause backslashes have meaning in a regular Python string too
p54883
aVA raw string literal (a string literal prefixed with ) ignores (most) escape sequences that Python supports
p54884
aVSee The Backslash Plague in the Python Regular Expression HOWTO
p54885
as(dp54886
g16
V100297
p54887
stp54888
a((dp54889
g2
(lp54890
VUse the  function with a generator expression to find if there is any dictionary value that contains your item:
p54891
aVUse  on Python 3
p54892
aVThe generator expression loops over the dictionary values (without producing a list of all values first) and tests against each value, one by one as the generator expression is iterated over
p54893
aVonly tests elements from the generator expression until one is , and then stops looping, making this relatively efficient
p54894
aVIf you need to have the key of the matching value, use :
p54895
aVwhich returns either the matching key, or  in no match is found
p54896
as(dp54897
g16
V100297
p54898
stp54899
a((dp54900
g2
(lp54901
Vaccess the text of the nested span:
p54902
aVYou need to make sure that  actually found something; above I test that there is indeed a  found
p54903
as(dp54904
g16
V100297
p54905
stp54906
a((dp54907
g2
(lp54908
VJust make  a tuple, so call  for each element in your  list:
p54909
aVand make your string use three quotes:
p54910
aVString formatting supports passing in a tuple defined in a variable, as long as it has the correct length:
p54911
aVAlternatively, use  to format:
p54912
aVYou can also use tuple unpacking; assign each tuple in the list to two variables in the loop:
p54913
as(dp54914
g16
V100297
p54915
stp54916
a((dp54917
g2
(lp54918
VNamed replacement fields (the  parts in a format string match against keyword arguments to the  method, and not positional arguments
p54919
aVKeyword arguments are like keys in a dictionary; order doesn't matter, as they are matched against a name
p54920
aVIf you wanted to match against positional arguments, use numbers:
p54921
aVIn Python 2
p54922
aV7 and up, you can omit the numbers; the  replacement fields are then auto-numbered in order of appearance in the formatting string:
p54923
aVThe formatting string can match against both positional and keyword arguments, and can use arguments multiple times:
p54924
aVQuoting from the format string specification:
p54925
aVThe field_name itself begins with an arg_name that is either a number or a keyword
p54926
aVIf it\u2019s a number, it refers to a positional argument, and if it\u2019s a keyword, it refers to a named keyword argument
p54927
aVEmphasis mine
p54928
aVIf you are creating a large formatting string, it is often much more readable and maintainable to use named replacement fields, so you don't have to keep counting out the arguments and figure out what argument goes where into the resulting string
p54929
aVYou can also use the  calling syntax to apply an existing dictionary to a format, making it easy to turn a CSV file into formatted output:
p54930
aVHere, , ,  and  are all keys in the  dictionary, and it is much easier to see what happens when I apply the  to the formatting string
p54931
as(dp54932
g16
V100297
p54933
stp54934
a((dp54935
g2
(lp54936
VYou got the order mixed up:
p54937
aVNot that that'll work as that'll list the  every time a banned word does show up in the sentence
p54938
aVTake a look at the fully expanded nested loops version:
p54939
aVUse the  function to test for banned words instead:
p54940
aVloops over the generator expression only until a  value is found; it'll stop doing work the moment a banned word is found in the sentence
p54941
aVThis is more efficient at least
p54942
as(dp54943
g16
V100297
p54944
stp54945
a((dp54946
g2
(lp54947
VHeaders are part of a request, of which the URL is one part
p54948
aVPython creates a request for you when you pass in just a URL to  functions
p54949
aVCreate a  object, add the headers to that object and use that instead of a string URL:
p54950
aVHowever,  is marked as 'legacy API' in the code and doesn't support using a  object
p54951
aVRemoving a few lines supporting 'file://' urls is easy enough:
p54952
aV  from urllib
p54953
aVrequest import urlopen
p54954
as(dp54955
g16
V100297
p54956
stp54957
a((dp54958
g2
(lp54959
VYou can use :
p54960
aVThis splits on any of the characters in the  character class:
p54961
aVYou can group the split expression to include the characters in separate list elements in the output:
p54962
aVTo keep the punctuation attached to the sentence, use  instead:
p54963
as(dp54964
g16
V100297
p54965
stp54966
a((dp54967
g2
(lp54968
VIf you need to use a regex, use a negative character class ():
p54969
aVA negative character class matches anything not named in the class
p54970
aVDemo:
p54971
aVBut using  is way faster:
p54972
aVUsing  is more than 10 times faster than a regular expression:
p54973
aVUsing Jakub's method is slower still:
p54974
as(dp54975
g16
V100297
p54976
stp54977
a((dp54978
g2
(lp54979
VWhen you use a  statement, the function ends
p54980
aVYou are returning just the first value, the loop does not continue nor can you return elements one after another this way
p54981
aVjust writes that value to your terminal and does not end the function
p54982
aVThe loop continues
p54983
aVBuild a list, then return that:
p54984
aVor just return a concatenation:
p54985
as(dp54986
g16
V100297
p54987
stp54988
a((dp54989
g2
(lp54990
VJust set a flag:
p54991
aVAlternatively, nest the loops, to search for each -after- event:
p54992
as(dp54993
g16
V100297
p54994
stp54995
a((dp54996
g2
(lp54997
VRead in all numbers from the big file into a set, then test new numbers against that:
p54998
aVThis adds numbers not already in  to the end, in as efficient a way as possible
p54999
aVIf  becomes too big for the above to run efficiently, you may need to use a database instead
p55000
as(dp55001
g16
V100297
p55002
stp55003
a((dp55004
g2
(lp55005
VTo compile Python with  support, you need to install the  package so that Python can find the headers
p55006
aVYou'd need to re-install your source-compiled Python to take this along
p55007
as(dp55008
g16
V100297
p55009
stp55010
a((dp55011
g2
(lp55012
V is a reserved keyword
p55013
aVUse a different variable name
p55014
aVYour code otherwise works fine:
p55015
as(dp55016
g16
V100297
p55017
stp55018
a((dp55019
g2
(lp55020
VYou won't know whether future versions will break your app; no one can foretell the future
p55021
aVFuture problems can be solved by then pinning versions on installation, or you can issue a new release of your project with a fix or  requirement specification
p55022
aVUse  when a minimum version is required; e
p55023
ag1298
aVwhen you know that you rely on a specific feature of that library that was introduced as of a specific version, or because older versions use a different API
p55024
aVYou generally want to avoid using  in ; leave version pinning up to the installer and you need to retain flexibility
p55025
aVIf that specific version turns out to have a major security flaw, you need to update your  and release a new version just to allow anyone whom installed your package to benefit
p55026
as(dp55027
g16
V100297
p55028
stp55029
a((dp55030
g2
(lp55031
VUse:
p55032
aVin your  module, or give it a different name
p55033
aVSee PEP 328 - Imports: Multi-Line and Absolute/Relative for the nitty gritty details
p55034
aVIn Python 2, imports are first resolved relative to the current module, before searching the modules path; with the above statement imports are always absolute unless you use the new relative import syntax (, etc
p55035
aVThe statement switches import behaviour per module; adding it to your  module will not alter behaviour of importing in other modules
p55036
as(dp55037
g16
V100297
p55038
stp55039
a((dp55040
g2
(lp55041
VQuoting from :
p55042
aVThere is a numerical subdirectory for each running process; the subdirectory is named by the process ID
p55043
aVA terminated process is no longer running, and its  directory (including the  file), is no longer going to be there
p55044
aVIf it was going to be there, you can just store the PID in a variable before you call :
p55045
aVThere is no 'just before termination' event;  waits, then reaps the exit code
p55046
aVYou could do your own waiting with  instead:
p55047
aVis a named tuple, see  for a list of what names it supports
p55048
aVBoth  and  are floating point values
p55049
as(dp55050
g16
V100297
p55051
stp55052
a((dp55053
g2
(lp55054
VYou are missing a closing parenthesis:
p55055
aVRule of thumb: when you get a syntax error you cannot immediately spot on that line, look at the previous line to see if you balanced your parenthesis and braces properly
p55056
as(dp55057
g16
V100297
p55058
stp55059
a((dp55060
g2
(lp55061
VThe slice start and stop arguments are equal, so the  call on the xrange raises :
p55062
aVand the  generator function immediately terminates
p55063
aVThis is only logical, the  function is not going to produce any numbers in that case
p55064
aVThe  documentation is illustrative, and not meant to be complete
p55065
aVYou've found one edgecase where the sample Python code does not work the same way that the C implementation works
p55066
aVTo make the Python code work for this case as well, catch the  exception, and test for the edgecase explicitly in the loop:
p55067
aVThe Python sample code uses a  object to make the code more compact and easier to read; the C code does its own start, stop and step parsing, and handles the count itself instead of delegating to , and thus doesn't run into this edgecase
p55068
as(dp55069
g16
V100297
p55070
stp55071
a((dp55072
g2
(lp55073
VYou don't need to do anything special
p55074
aVJust refer to it directly:
p55075
as(dp55076
g16
V100297
p55077
stp55078
a((dp55079
g2
(lp55080
VYou are looping over keys, not values:
p55081
aVLoop over the values instead:
p55082
aVor loop over the  results:
p55083
aVYour code loops over the individual characters of each key instead, so  indexes a string
p55084
as(dp55085
g16
V100297
p55086
stp55087
a((dp55088
g2
(lp55089
VIt sounds as if you want to produce a random set of numbers, then pick from those one-by-one
p55090
aVA random sequence without repetition, in other words
p55091
aVGenerate all those numbers, shuffle, then use  to pick one at a time and remove it from the set of possibilities:
p55092
aVremoves the last value from the list of randomly shuffled numbers
p55093
aVIt may be enough even to just shuffle and then loop over the list:
p55094
aVYou can bundle the random-number-sequence production up as an iterator in a function:
p55095
aVYou can call  on the iterator and it'll produce another random number from the sequence, until the sequence is exhausted (at which point  is returned)
p55096
as(dp55097
g16
V100297
p55098
stp55099
a((dp55100
g2
(lp55101
VYou need to build an absolute path, preferably using :
p55102
aVdoes not take separate directory and filename arguments, the second argument is the  argument, always
p55103
as(dp55104
g16
V100297
p55105
stp55106
a((dp55107
g2
(lp55108
VWeak references are used to avoid keeping instances around, not to ensure that an object is deleted when their referant is
p55109
aVThe  instance will only be deleted from memory when all strong references to it are deleted (with any reference that is not a weak reference being a strong reference instead)
p55110
aVIf the  attribute is the only reference to an instance of , then that instance will be deleted when the  reference is rebound to something else or cleared (if  is deleted the  attribute would automatically be cleared), as the reference count to  drops to 0
p55111
aVIn other words, if  were to be a weak reference to , and there were no other references to , dereferencing  would return  instead, as the  would already be deleted
p55112
aVUsing weak references outside of  could, however, be a way to ensure that  were to be the only strong reference to that  instance
p55113
as(dp55114
g16
V100297
p55115
stp55116
a((dp55117
g2
(lp55118
VYou are printing the return value of the  call:
p55119
aVThat function returns
p55120
aVThe function also writes to the same file descriptor as  does, so you are first writing  to stdout, then ask  to write more text to  including the return value
p55121
aVYou probably just wanted to add  at the end there without a space
p55122
aVUse string concatenation or formatting:
p55123
aVor
p55124
aVor
p55125
aVThe two string formatting variations format the floating point value with two decimals after the decimal point
p55126
aVSee String formatting operations (for the  variant, old style string formatting), or Format String Syntax (for the  method, a newer addition to the language)
p55127
as(dp55128
g16
V100297
p55129
stp55130
a((dp55131
g2
(lp55132
V gives you the desired combinations of
p55133
aVUse that with a list comprehension to create :
p55134
aVDemo:
p55135
as(dp55136
g16
V100297
p55137
stp55138
a((dp55139
g2
(lp55140
VPython's  singleton is translated to a JSON , and vice versa
p55141
aVUse that instead:
p55142
as(dp55143
g16
V100297
p55144
stp55145
a((dp55146
g2
(lp55147
V (using the connection object as a context manager) ensures that the transaction is committed if no exceptions occurred within the code block governed by the  statement
p55148
aVWithout the context manager, use  to explicitly commit the transaction
p55149
as(dp55150
g16
V100297
p55151
stp55152
a((dp55153
g2
(lp55154
V is a method on the  class
p55155
aVIt forms a test assertion; where  must be equal to  for the test to pass
p55156
as(dp55157
g16
V100297
p55158
stp55159
a((dp55160
g2
(lp55161
VUse  (see Counter in Collections module Python if you are on a Python version < 2
p55162
aV7):
p55163
as(dp55164
g16
V100297
p55165
stp55166
a((dp55167
g2
(lp55168
VYou are attempting to create a  namedtuple object from a CSV row that contains only two columns
p55169
aVPython slices allow you to slice beyond the length of a sequence;  on a line that only contains 2 values returns a new list of just to values
p55170
aVThis is an error in your CSV file; you need to verify that every row has enough columns
p55171
aVNote that  would have the same result, and that slices 5 elements of each CSV result row (not 6, the stop value is not included); you are also slicing the row, not the CSV file (you seem to be under the impression that slicing  will result only 6 namedtuple objects)
p55172
aVIn any case, you probably want to use  instead to go straight to dictionaries for your template formatting
p55173
aVThe  tool has the additional
p55174
as(dp55175
g16
V100297
p55176
stp55177
a((dp55178
g2
(lp55179
VThere are no pitfalls, the classes are not registered centrally
p55180
aVAll you see is the classes using  to generate a representation string
p55181
aVThe classes themselves only live on as  references on the instances as the local name is cleared up when the  function finishes
p55182
as(dp55183
g16
V100297
p55184
stp55185
a((dp55186
g2
(lp55187
VNo, you'll have to cast the output of  or  back to
p55188
aVThese functions are documented to produce a , (almost) always
p55189
aVThey do so if you pass other types of sequences as well
p55190
aVQuoting from the  documentation:
p55191
aVThe iterable arguments may be a sequence or any iterable object; the result is always a list
p55192
aVIn other words,  and  don't care about the exact type of the sequences you pass in, that is not limited to your  type
p55193
aVThe exception is , which special-cases for  and ; quoting the  documentation:
p55194
aVIf iterable is a string or a tuple, the result also has that type; otherwise it is always a list
p55195
aVThis special handling is hard-coded and cannot be extended
p55196
aVIn Python 3, this exception no longer applies; both  and  return a generator there instead
p55197
as(dp55198
g16
V100297
p55199
stp55200
a((dp55201
g2
(lp55202
VSet the header from the main template; add the following tag to your  file to have it include the header on every request that uses the main template:
p55203
as(dp55204
g16
V100297
p55205
stp55206
a((dp55207
g2
(lp55208
VI'm presuming you are using Python 3; in Python 2,  would work as Python 2 will first look for a local, relative import before looking for a global, absolute reference
p55209
aVYou have two more options:
p55210
aVand
p55211
aVThe latter imports relative to the current package, which allows you to rename your  package without having to update all your internal imports
p55212
aVWhat you use is a matter of style and taste
p55213
as(dp55214
g16
V100297
p55215
stp55216
a((dp55217
g2
(lp55218
VYou'll have to use a more elaborate default:
p55219
aVIt might be a good idea, for the sake of readability, to make that a separate function:
p55220
aVHere,  is a little more explicit that you are renaming one key in the result
p55221
as(dp55222
g16
V100297
p55223
stp55224
a((dp55225
g2
(lp55226
VInstead of looking at just the speeds, look at your players and enemies, and devise a key to determine what speed goes with what player
p55227
aVYou didn't share any details on how you define players and speeds; I'll use a number here for now:
p55228
aVIt may well be that you can simplify this based on your data structures; if you have objects per player and enemy that have a speed attribute, for example, you can access that attribute in the key function instead
p55229
aVreturns the highest value by ; no need to sort all speeds if all you need is the fastest driver
p55230
as(dp55231
g16
V100297
p55232
stp55233
a((dp55234
g2
(lp55235
VPython uses an evaluation loop to execute the bytecode
p55236
aVSee  for the implementation (in C)
p55237
aVIf you wanted to interpret the byte code instructions yourself from Python, you'd need an intimate knowledge of what each instruction is supposed to do and where to find the data structures that govern their execution
p55238
aVhere, for example, loads the constant at index 1 from the code object that is attached to the function and puts it on the stack, and  takes the top stack value, turns it into a string and writes it to
p55239
as(dp55240
g16
V100297
p55241
stp55242
a((dp55243
g2
(lp55244
VYou are using the vote count from each senator as an index into the total votes
p55245
aVDon't do that
p55246
aVUse  instead
p55247
aVYou also need to make a copy of the  list you assign to  to avoid altering the mutable list in place:
p55248
aVYou could also use  on each column (use  to transpose rows and columns); this avoids altering any of the vote lists in place altogether:
p55249
aVEither version now returns the average correctly:
p55250
aVMoreover, the lists contained in  are not altered
p55251
as(dp55252
g16
V100297
p55253
stp55254
a((dp55255
g2
(lp55256
VUse  or  to parse the query string:
p55257
aVDemo:
p55258
aVBecause any key in a query string can occur more than once, you can end up with more than one value per key
p55259
aVThe  function collects all values into lists per key, the  function simply returns each key-value pair as a tuple, letting you decide what to do with duplicates
p55260
as(dp55261
g16
V100297
p55262
stp55263
a((dp55264
g2
(lp55265
VPython sees one character for the  escape code
p55266
aVThe  is not a separate character:
p55267
aVAs such, it is not a digit, a dot or a dash, and the regular expression removes it
p55268
aVYou may need to figure out what meaning the  byte has in the the original data
p55269
aVFor example, in Latin-1, the B1 codepoint stands for the  character, making your value look like:
p55270
aVwhich may have a different meaning from what you are giving it
p55271
as(dp55272
g16
V100297
p55273
stp55274
a((dp55275
g2
(lp55276
VYou are missing a parenthesis on the previous lines:
p55277
aVI count 4 opening parens, but only 3 closing; you are not closing the  call:
p55278
aVIn Python, when you get a Syntax Error that doesn't immediately make sense, check the preceding lines to make sure you have your braces and parentheses properly balanced
p55279
aVFor every ovening ,  or  there must be a matching closing ,  or
p55280
as(dp55281
g16
V100297
p55282
stp55283
a((dp55284
g2
(lp55285
VThe code snippet you posted does not do any of the Trie search
p55286
aVAt all
p55287
aVThe function you are looking at permutes the given signature key (a string of zeros and ones) to find the nearest match; if no matches starting with the first character of the signature are found, it looks for items with the inverse value instead
p55288
aVFor your sample data, if you were to look for the signature , there are no exact matches
p55289
aVBut the  prefix search will return results for a search for , for , and for
p55290
aVThe search for  fails, so  is used to replace the last  with a , which does match, so  is the result of  function
p55291
aVTo find matches, prefix matching is delegated to the  object
p55292
aVThis datatype is taken from the Biopython project, and is coded entirely in C; if you are so inclined, study the  function to see how that type searches for matching prefixes
p55293
aVDocumentation on that data type is sparse; the best we have is this autogenerated module page:
p55294
aVThis module implements a trie data structure
p55295
aVThis allows an O(M)
p55296
aVlookup of a string in a dictionary, where M is the length of the
p55297
aVstring
p55298
aVIt also supports approximate matches
p55299
as(dp55300
g16
V100297
p55301
stp55302
a((dp55303
g2
(lp55304
VRemove the blanket except
p55305
aVYour script is not freezing, but any error you get is being ignored in an endless loop
p55306
aVBecause you use a blanket  you catch all exceptions, including the keyboard interrupt exception
p55307
aVAt the very least log the exception, and catch only :
p55308
aVis a subclass of , not  and won't be caught by this except handler
p55309
aVTake a look at the  module for copying files, you doing way too much work:
p55310
aVHandling files should only ever raise  or it's subclasses, there is no need to catch everything here
p55311
as(dp55312
g16
V100297
p55313
stp55314
a((dp55315
g2
(lp55316
VYou are using  wrong; use it with the two lists:
p55317
aVYou are applying it to each country name and country code individually:
p55318
aVcombines the two input sequences by pairing off each element; in strings, the individual characters are the elements of the sequence
p55319
aVBecause there are only two characters in the country codes, you end up with lists of two elements, each a tuple of paired characters
p55320
aVOnce you combined both lists into a new one, you can most certainly sort that list, either on the first or second element:
p55321
as(dp55322
g16
V100297
p55323
stp55324
a((dp55325
g2
(lp55326
VYou are trying to patch the  method; the fact that there is a  method as well makes no odds here
p55327
aVYou'd normally decorate the  method instead, using a regular (function) decorator; if you have to use a class decorator, then use one that subclasses the decorated class:
p55328
as(dp55329
g16
V100297
p55330
stp55331
a((dp55332
g2
(lp55333
V is the wrong test; it tests if there is a  attribute, and BeautifulSoup dynamically turns attributes into searches for children
p55334
aVHTML tag attributes are not translated into Python attributes
p55335
aVUse dictionary-style testing instead; you loop over all elements which can include the  instance, so I use  to not break on objects that don't have attributes:
p55336
aVYou can also instruct  to only match  tags with a  attribute by using  as a keyword argument filter ( just means  in any case):
p55337
aVThis still includes the HTML declaration of course; search for just  links:
p55338
as(dp55339
g16
V100297
p55340
stp55341
a((dp55342
g2
(lp55343
VFirst and foremost: Python  loops are not really the same thing as a C  loop
p55344
aVThey are For Each loops instead
p55345
aVYou iterate over the elements of an iterable
p55346
aVgenerates an iterable sequence of integers, letting you emulate the most common C  loop use case
p55347
aVHowever, most of the time you do not want to use
p55348
aVYou would loop over the list itself:
p55349
aVIf you have to have a index, you usually use  to add it to the loop:
p55350
aVFor really 'funky' loops, use  or create your own generator function:
p55351
aVto print , ,
p55352
aVYou can extend that to sequences too:
p55353
aVwhich prints:
p55354
as(dp55355
g16
V100297
p55356
stp55357
a((dp55358
g2
(lp55359
VThe following expression is at fault:
p55360
aVWhere  is the Plone site
p55361
aVThe parent of a Plone site is the Zope root object, but the  skin method only exists within the Plone site
p55362
aVIt is not clear why you try to get the folder contents of the parent of the context; you may need to test if you are not at the site root here
p55363
as(dp55364
g16
V100297
p55365
stp55366
a((dp55367
g2
(lp55368
VYou are interpolating your data, leave that to the database adapter, which will handle escaping the various values as appropriate
p55369
aVThere is also no need to expand the whole list of row values:
p55370
aVYou don't really have to type out all those  placeholders; have Python generate them for you:
p55371
aVSince you have more than one row, have the database loop through them and execute the same query for each row in turn:
p55372
aVNo need to loop yourself
p55373
as(dp55374
g16
V100297
p55375
stp55376
a((dp55377
g2
(lp55378
VYou can turn functions into no-ops (that log a warning) with a decorator:
p55379
aVHere  is a decorator factory
p55380
aVIt returns one of two decorators depending on the condition
p55381
aVOne decorator simply leaves the function untouched
p55382
aVThe other decorator replaces the decorated function altogether, with one that issues a warning instead
p55383
aVUse:
p55384
as(dp55385
g16
V100297
p55386
stp55387
a((dp55388
g2
(lp55389
VDon't read the whole contents into memory
p55390
aVThere is no need
p55391
aVMoreover,  will already split your strings into characters, so you don't need to do this yourself
p55392
aVThe trick here is to create a generator that pairs off your characters while reading the two files in chunks, which would be the most efficient way to read the files
p55393
aVLastly, use  to keep counts:
p55394
aVHere the code is read in chunks of 1024 bytes; adjust as needed for best performance
p55395
aVNo more than 2048 bytes from the files are held in memory at once, pairs are generated on the fly as they are counted
p55396
as(dp55397
g16
V100297
p55398
stp55399
a((dp55400
g2
(lp55401
VQuoting from the reference documentation:
p55402
aVPython evaluates expressions from left to right
p55403
aVSo yes, you can count on that
p55404
as(dp55405
g16
V100297
p55406
stp55407
a((dp55408
g2
(lp55409
VIf you want to list keys taken from  that are not present in the dictionary, use a list comprehension:
p55410
aVYour code created 3 pairs, one of each of the elements in , with 3 arbitrary keys from
p55411
aVIf those three arbitrary keys happen to not be equal to the 3 values from  they all are included in your output:
p55412
as(dp55413
g16
V100297
p55414
stp55415
a((dp55416
g2
(lp55417
VYou cannot use  until the class body has finished executing
p55418
aVYou can refer to 'local' names; the class body is executed as a function, and the local namespace of that function is used to supply the class attributes; within the class body,  is a local name:
p55419
as(dp55420
g16
V100297
p55421
stp55422
a((dp55423
g2
(lp55424
VIn that case you'd have to use a dictionary to map ids to dictionaries first:
p55425
as(dp55426
g16
V100297
p55427
stp55428
a((dp55429
g2
(lp55430
VYou could use  with a predicate:
p55431
aVThis let's you specify either a value to accept or to reject
p55432
aVUsually, however, you'd use an inline list comprehension instead of a function:
p55433
as(dp55434
g16
V100297
p55435
stp55436
a((dp55437
g2
(lp55438
VThe package is not compatible with Python 3; you'll have to request the author ports it
p55439
aVThere is an existing patch you could try out
p55440
aVIn the meantime, look into other libraries instead, the  library does support Python 3 and has a far superior API to
p55441
as(dp55442
g16
V100297
p55443
stp55444
a((dp55445
g2
(lp55446
VIn Python 3
p55447
aV3, use the new  type instead:
p55448
aVThe documentation gives you a backwards-compatible version on a platter:
p55449
aVThe only difference between your version and this one is that this one doesn't use  and  (not needed at all), this version takes initial values in the initializer, and it includes a nice representation:
p55450
as(dp55451
g16
V100297
p55452
stp55453
a((dp55454
g2
(lp55455
VUse a list of prompts:
p55456
as(dp55457
g16
V100297
p55458
stp55459
a((dp55460
g2
(lp55461
VYou can subclass  and implement :
p55462
aVDemo:
p55463
aVYou could subclass  too, you'd get the factory handling plus copy and pickle support thrown in:
p55464
aVDemo:
p55465
aVbut, as you can see, the  does lie about it's name
p55466
as(dp55467
g16
V100297
p55468
stp55469
a((dp55470
g2
(lp55471
VYou should definitely drop the list comprehension
p55472
aVEnd of
p55473
aVYou are confusing anyone reading your code
p55474
aVYou are building a list for the side-effects
p55475
aVYou are paying CPU cycles and memory for building a list you are discarding again
p55476
aVIn your simplified case, you are overlooking the fact you could have used a list comprehension directly:
p55477
as(dp55478
g16
V100297
p55479
stp55480
a((dp55481
g2
(lp55482
VDon't use ; it assumes that whatever output was produced by the command is decodable with the same encoding as  uses
p55483
aVTry  instead; it returns bytes
p55484
as(dp55485
g16
V100297
p55486
stp55487
a((dp55488
g2
(lp55489
VYou have random bytes; I'd be very surprised if that ever was decodable to a string
p55490
aVIf you have to have a unicode string, decode from Latin-1:
p55491
aVbecause it maps bytes one-on-one to corresponding Unicode code points
p55492
as(dp55493
g16
V100297
p55494
stp55495
a((dp55496
g2
(lp55497
VYou'd need to sort (using , then group (using , then use  on each group
p55498
aVThese are all standard-library modules
p55499
aVWithout any imports, you'd have to loop twice; first to group everything, then to find the maximum value for each group:
p55500
aVDemo:
p55501
aVor without imports:
p55502
as(dp55503
g16
V100297
p55504
stp55505
a((dp55506
g2
(lp55507
VYour  function signature captures  as a list of arguments using  as a catch-all marker
p55508
aVThis makes  a list of lists, with one argument
p55509
aVBut to define  you don't do the same; you pass in just the list
p55510
aVEither do:
p55511
aVor do:
p55512
aVor
p55513
aVto make the two codepaths equivalent
p55514
as(dp55515
g16
V100297
p55516
stp55517
a((dp55518
g2
(lp55519
VIf that handler takes keyword arguments, then use a dictionary for the third element:
p55520
aVOr you can apply the arguments using  syntax; in that case just catch all values in the loop:
p55521
aVIf you have to unpack into at least 2 arguments, do so in a separate step:
p55522
aVwhere  would be a tuple of 0 or more elements
p55523
aVIn Python 3, you can handle arbitrary width unpacking with a splat () target:
p55524
aVwhere  captures 0 or more extra values in the unpack
p55525
aVThe other route, to elements in  to a minimal length could be done with:
p55526
aVDemo:
p55527
as(dp55528
g16
V100297
p55529
stp55530
a((dp55531
g2
(lp55532
VYour remote machine is running a different Python version, Python 3
p55533
aVIn Python 3, the  statement has been replaced with a  function, and your code is throwing a syntax error
p55534
aVThe work-around is to either run the code remotely with Python 2 as well, or to make your code compatible with both Python 2 and 3:
p55535
as(dp55536
g16
V100297
p55537
stp55538
a((dp55539
g2
(lp55540
VHave the first  return a empty dictionary as the default, then use  on that:
p55541
aVNow you'll either get the value for , or
p55542
aVThe alternative is to test for  explicitly:
p55543
as(dp55544
g16
V100297
p55545
stp55546
a((dp55547
g2
(lp55548
VYou can ask  not to add a newline:
p55549
aV, by default, is set to
p55550
aVFor your sample, that'd be:
p55551
aVprinting a space instead of a newline after
p55552
aVYou could also include the space in your list of ASCII codepoints; ASCII space is , but you add  to your values, so including  should do it:
p55553
as(dp55554
g16
V100297
p55555
stp55556
a((dp55557
g2
(lp55558
VYour code works just fine, except for lines that neither start with a  nor contain a  character
p55559
aVUsually, those are empty lines
p55560
aVTest for the  character before splitting:
p55561
aVYou can simplify the code and make it a dict comprehension:
p55562
aVYou can loop over  (a file object) directly; no need to read all lines into memory using  first
p55563
aVI used  to only split on the equals sign once
p55564
as(dp55565
g16
V100297
p55566
stp55567
a((dp55568
g2
(lp55569
VThe double slashes are not the problem here
p55570
aVIt is the  carriage return character at the end that is causing you problems
p55571
aVString it from the path:
p55572
aVPython is merely showing a string literal representation of your  string, for ease of debugging
p55573
aVAny character with special meaning, outside of the printable ASCII range, is escaped, including backslashes
p55574
aVThe value itself does not have doubled backslashes:
p55575
aVNote how printing  shows the path value having only single backslashes and how the first 3 characters of the path are , the string having length 3 and not 4
p55576
aVIn a Python string literal the backslashes would denote escape sequences however, so Python escapes those too
p55577
as(dp55578
g16
V100297
p55579
stp55580
a((dp55581
g2
(lp55582
V is a generator function
p55583
aVCalling it returns the generator
p55584
aVYou then need to use that generator to get your values
p55585
aVBy looping, for example, or by calling  on it:
p55586
aVNote that calling  again will calculate the same value again and produce a new generator
p55587
aVYou may just want to use a global to cache the value
p55588
aVStoring it as an attribute on the function could work:
p55589
as(dp55590
g16
V100297
p55591
stp55592
a((dp55593
g2
(lp55594
VYou'll have to first collect all your 'columns', then write
p55595
aVYou can do that by converting everything to a list of lists, then use  to transpose the list of columns to a list of rows:
p55596
aVDemo showing the row output:
p55597
as(dp55598
g16
V100297
p55599
stp55600
a((dp55601
g2
(lp55602
VWhen using a negative step, swap the start and end values too:
p55603
aVNote that the end value is excluded, and  should be used to include the first character ( would slice from the end again and thus  would be empty)
p55604
aVDemo:
p55605
aVHowever, it may be easier to first slice, then reverse, and save yourself the headaches of such slicings:
p55606
as(dp55607
g16
V100297
p55608
stp55609
a((dp55610
g2
(lp55611
VYou need to pass in  as a keyword parameter instead:
p55612
aVYou are expected to pass in a Python boolean value
p55613
aVThe parameter is not part of the bit
p55614
aVly URL, it is a parameter to the API call instead
p55615
aVAll optional API parameters (so apart from the link), are passed in as keyword parameters, including , ,  and
p55616
aVYou can take a look at the internal method that handles these parameters if you are so inclined
p55617
as(dp55618
g16
V100297
p55619
stp55620
a((dp55621
g2
(lp55622
VUse  and a list comprehension:
p55623
aVOn Python 3, replace  with
p55624
aVis used to make sure both keys and values are strings before joining
p55625
aVDemo:
p55626
aVNote that the order will be arbitrary; dictionaries do not have a set ordering (instead the order depends on the insertion and deletion history of the keys)
p55627
aVWrapping this in a function is left as exercise for the reader
p55628
as(dp55629
g16
V100297
p55630
stp55631
a((dp55632
g2
(lp55633
VAppend tuples to one list, then split out the lists using :
p55634
aVtransposes the nested list; columns become rows
p55635
aVBecause you have two 'columns' (pairs of values), you end up with two rows instead
p55636
as(dp55637
g16
V100297
p55638
stp55639
a((dp55640
g2
(lp55641
VYou mean
p55642
aVIt calls the base initializer from the subclass initializer
p55643
aVYour subclass has replaced the base class initializer with its own
p55644
aVIn this case commenting that out happens to work because the unbound initializer was called with an empty list instead of  and is thus a no-op
p55645
aVThis is an error on behalf of the authors, most likely
p55646
aVBut it is a good idea generally to make sure the base class has run its initialization code when you subclass
p55647
aVThat way all internal data structures the base class methods rely on have been set up correctly
p55648
as(dp55649
g16
V100297
p55650
stp55651
a((dp55652
g2
(lp55653
V will not filter out the document type; it filters what elements remain in document, but the doc-type is retained as it is part of the 'container' for the filtered elements
p55654
aVYou are looping over all elements in the document, so the first element you encounter is the  object
p55655
aVUse  on the 'strained' document:
p55656
aVor filter out the  object:
p55657
as(dp55658
g16
V100297
p55659
stp55660
a((dp55661
g2
(lp55662
VYou need to copy the last row, not just reference it:
p55663
aVLists are mutable; basically an ordered container of references to other python objects that let you add, remove and change references
p55664
aVBy changing all values in a list, you are rebinding those references inside the list
p55665
aVis just a reference to that list of references
p55666
aVYou didn't copy those references; you merely copied a reference to the container
p55667
aVYou could just replace the matrix again:
p55668
aVNow you rebind , and create new nested lists, so  before this code would refer to the old last row
p55669
as(dp55670
g16
V100297
p55671
stp55672
a((dp55673
g2
(lp55674
VThe  was returned from  but discarded
p55675
aVWhat happens is this:
p55676
aVfirst time the  loop calls  on the generator, the code advances until  is yielded
p55677
aVis , so  is called
p55678
aVThe code advances through the generator function, and  is set to
p55679
aVThe generator does not pause there, it now has control
p55680
aVThe generator runs through the  loop and comes back to the  expression
p55681
aVis yielded
p55682
aVIt becomes the return value for
p55683
aVThe return value is discarded here
p55684
aVThe  loop continues, calls  again
p55685
aVThe generator is continued again with  returning , loops round to  and yielding
p55686
aVThe  loop continues to call  on the generator,  and  are yielded, the generator ends
p55687
aVQouting from the  documentation:
p55688
aVResumes the execution and \u201csends\u201d a value into the generator function
p55689
aVThe  argument becomes the result of the current  expression
p55690
aVThe  method returns the next value yielded by the generator, or raises  if the generator exits without yielding another value
p55691
aVEmphasis mine
p55692
as(dp55693
g16
V100297
p55694
stp55695
a((dp55696
g2
(lp55697
VPython dictionaries have unique keys
p55698
aVJSON objects SHOULD have unique names, but the SOLR sample you found violates that
p55699
aVQuoting from the JSON RFC:
p55700
aVThe names within an object SHOULD be unique
p55701
aVBecause in Python dictionaries, names are unique, you cannot use the standard  library to generate the output you have shown
p55702
aVYou'll have to roll your own encoder if you require that specific output
p55703
aVI'd generate a list of tuples of  pairs, then encode the dictionaries with the  library and then use string templating for the last step:
p55704
aVThis approach is a little fragile in that it doesn't ensure  values are escaped according to JSON rules, but as long as the action values are simple ASCII strings without quotes it'll work just fine
p55705
aVYou can always add encoding to  and manually escaping any  characters
p55706
aVDemo:
p55707
as(dp55708
g16
V100297
p55709
stp55710
a((dp55711
g2
(lp55712
VYou have data that is not UTF-8 encoded
p55713
aVJSON strings are really Unicode strings, but you are giving it a byte string instead
p55714
aVDecode your data manually first instead of having the  module do it for you, wrongly
p55715
aVJudging by the error code, you have windows-1252 (cp1252) encoded data instead, so the following will work:
p55716
aVIt could also be windows-1250; both 1250 and 1252 encode the  character (Unicode codepoint U+017D, LATIN CAPITAL LETTER Z WITH CARON) to hex 8E
p55717
as(dp55718
g16
V100297
p55719
stp55720
a((dp55721
g2
(lp55722
Vzip, filter and unzip again:
p55723
aVThe  call pairs each  with the corresponding  element, the generator expression filters out any pair where the  is listed in , and the  then teases out the remaining pairs into separate lists again
p55724
aVDemo:
p55725
as(dp55726
g16
V100297
p55727
stp55728
a((dp55729
g2
(lp55730
VAny name you refer to in a function is considered a global, until you assign to it
p55731
aVThe compiler sees the assignment in the function and marks the name as a local variable instead
p55732
aVAs a local name,  has no value when you try to print it
p55733
aVUse the  keyword if you wanted assignment to  to affect the global variable:
p55734
as(dp55735
g16
V100297
p55736
stp55737
a((dp55738
g2
(lp55739
VJust set it to  on the class:
p55740
aVthen test for
p55741
aVIf  should be a valid value for the attribute, use a different singleton sentinel:
p55742
aVand test for
p55743
aVThis way, all references to  are properly rewritten to include the class name
p55744
aVThe other path would be to not use double-underscore names for your attributes
p55745
aVshould only be used for attributes you want to namespace to your specific class so that subclasses do not accidentally clobber it with their own attributes
p55746
aVIn other words, do not use double-underscore names unless you really understand what they are for and actually need it
p55747
aVAny code that is not part of a framework for wider consumption by unknown third parties
p55748
aVJust stick to single underscores instead
p55749
as(dp55750
g16
V100297
p55751
stp55752
a((dp55753
g2
(lp55754
VUse a list comprehension, and a  to filter out duplicates and preserve order:
p55755
aVDemo:
p55756
aVIf order does not need to be preserved, just use a set comprehension instead and return the resulting set:
p55757
as(dp55758
g16
V100297
p55759
stp55760
a((dp55761
g2
(lp55762
VUse :
p55763
aVThis works for any list of objects that all have the same method (by name); it doesn't matter if there are different types in the list
p55764
as(dp55765
g16
V100297
p55766
stp55767
a((dp55768
g2
(lp55769
VUse  and :
p55770
aVThis will raise  if there is all sublists are length 4 or there are no sublists
p55771
aVYou can ask  to return a default value instead:
p55772
as(dp55773
g16
V100297
p55774
stp55775
a((dp55776
g2
(lp55777
VUse  to turn columns into rows:
p55778
aVDemo:
p55779
as(dp55780
g16
V100297
p55781
stp55782
a((dp55783
g2
(lp55784
VImporting the module doesn't waste anything; the module is always fully imported (into the  mapping), so whether you use  or  makes no odds
p55785
aVI elaborate on why this is and what importing a module really means over on Programmers, on a cross-site duplicate question at 'import module' vs
p55786
aV'from module import function'
p55787
as(dp55788
g16
V100297
p55789
stp55790
a((dp55791
g2
(lp55792
VYou'd adopt a binary search to find the right  object for your  value
p55793
aVThe  module provides a starting point:
p55794
aVThe only thing I did was add a  function to the signature here
p55795
aVtakes a callable that returns the value against we are bisecting
p55796
aVNow you can use bisection to find your  index:
p55797
aVThis returns either the index of a matching , or the index of the next  object whose  value is higher than
p55798
aVYou may need to test and/or adjust the algorithm for those cases
p55799
aVFor example, you could verify that  does indeed match the desired value:
p55800
aVDemo:
p55801
as(dp55802
g16
V100297
p55803
stp55804
a((dp55805
g2
(lp55806
VUse a dictionary, then encode and write once, read and decode once:
p55807
aVReading:
p55808
aVor better still, start with the dictionary instead of separate variables in the first place
p55809
as(dp55810
g16
V100297
p55811
stp55812
a((dp55813
g2
(lp55814
VRename the function to , and add a new function :
p55815
aVor just bite the bullet and update all code that calls  and adjust that code to either use the returnvalue indexed to  or make use of the headers as well
p55816
as(dp55817
g16
V100297
p55818
stp55819
a((dp55820
g2
(lp55821
VYou need to de-indent the  statement
p55822
aVYou are returning in the loop, so in the first iteration
p55823
aVInstead of:
p55824
aVdo:
p55825
aVNow you let the loop do it's work properly and not end the function early
p55826
aVThere probably is a better way to read your file, depending on the format of the file
p55827
aVIf each entry is listed on a new line, I'd read it as follows:
p55828
as(dp55829
g16
V100297
p55830
stp55831
a((dp55832
g2
(lp55833
VWhen you  without arguments, the interpreter looks for the last exception raised and handled
p55834
aVIt then acts the same as if you used  with the most recent exception type, value and traceback
p55835
aVThis is stored in the interpreter state for the current thread, and the same information can be retrieved using
p55836
aVBy 'handled' I mean that an except clause caught the exception
p55837
aVQuoting the  statement documentation:
p55838
aVBefore an except clause\u2019s suite is executed, details about the exception are assigned to three variables in the  module:  receives the object identifying the exception;  receives the exception\u2019s parameter;  receives a traceback object (see section The standard type hierarchy identifying the point in the program where the exception occurred
p55839
aVThese details are also available through the  function, which returns a tuple
p55840
aVSee the implemenation notes in the Python evaluation loop (C code), specifically:
p55841
aVThe second
p55842
aVbullet was for backwards compatibility: it was (and is) common to
p55843
aVhave a function that is called when an exception is caught, and to
p55844
aVhave that function access the caught exception via sys
p55845
aVexc_ZZZ
p55846
aV(Example: traceback
p55847
aVprint_exc())
p55848
aVThe traceback reflects how you came to the re-raise accurately
p55849
aVIt is the current stack (line 10 calling , line 5 calling ) plus the original location of the exception raised: line 3
p55850
as(dp55851
g16
V100297
p55852
stp55853
a((dp55854
g2
(lp55855
VThe recommended way is to set a guard instead
p55856
aVThe guard expression should be able to look up a view to facilitate more complex guard code, but when a guard returns  the transition isn't even listed as available
p55857
as(dp55858
g16
V100297
p55859
stp55860
a((dp55861
g2
(lp55862
VYou need to turn your numbers into integers first; use a predicate function to try to do this:
p55863
aVThe predicate function here also removes quotes; your input list looks like it was not cleaned up properly and you may want to do so first before testing for negative values
p55864
aVThen use that to test for negative values:
p55865
aVor test if there are any negative values:
p55866
as(dp55867
g16
V100297
p55868
stp55869
a((dp55870
g2
(lp55871
VYour  object is a generator expression; these produce items on demand and are not indexable
p55872
aVYou could use a list comprehension instead:
p55873
aVNow you have a indexable list object instead
p55874
aVEven better, you can now loop over this object multiple times; you cannot do that with a generator
p55875
aVThe proper way to handle your case however, is to store the previous line only:
p55876
as(dp55877
g16
V100297
p55878
stp55879
a((dp55880
g2
(lp55881
VUse the  method of string formatting instead:
p55882
aVDemo:
p55883
aVThe  formatting specification allows for multiple passes, where replacement fields can fill in parameters for formatting specifications
p55884
aVIn the above example, the hard-coded padding width specification would look like:
p55885
aVor
p55886
aVwith a named parameter
p55887
aVI've simply replaced the  width specifier with another replacement field
p55888
aVTo get the same effect with old-style  string formatting you'd need to use the  width character:
p55889
aVbut this can only be used with a tuple of values (dictionary formatting is not supported) and only applies to the field width; other parameters in the formatting do not support dynamic parameters
p55890
as(dp55891
g16
V100297
p55892
stp55893
a((dp55894
g2
(lp55895
VPrinting with a single  statement and a comma always prints a trailing space
p55896
aVEither use one print statement with everything concatenated, or use  to write to the terminal directly without the extra spaces:
p55897
aVor
p55898
aVor use string formatting:
p55899
as(dp55900
g16
V100297
p55901
stp55902
a((dp55903
g2
(lp55904
V takes a  parameter, a function that when passed one of the objects returns the value by which to compare them
p55905
aVUse  to get that value:
p55906
aVThis returns the matching object for which that attribute is the maximum
p55907
aVIf you wanted to store just that maximum value itself, you have two options:
p55908
aVTake the attribute from the returned object:
p55909
aVPass just the attributes instead to  with a generator expression:
p55910
aVIf you find that you need to order the  classes in various directions by the same attribute again and again (to find the minimum, maximum, sort them, etc
p55911
aVyou may want to make your class orderable as well
p55912
aVTo do that, you'll need to implement some of the basic customization hooks Python will look for
p55913
aVWith some extra trickery, you can get away with just the lower-then and equals operations, and by using the  class decorator:
p55914
aVNow your  class is orderable, entirely on the basis of ; for the  function, that means you can drop the  parameter altogether
p55915
as(dp55916
g16
V100297
p55917
stp55918
a((dp55919
g2
(lp55920
VQuoting the documentation:
p55921
aVWhen an  or  prefix is present, a character following a backslash is included in the string without change, and all backslashes are left in the string
p55922
aVFor example, the string literal  consists of two characters: a backslash and a lowercase
p55923
aVString quotes can be escaped with a backslash, but the backslash remains in the string; for example,  is a valid string literal consisting of two characters: a backslash and a double quote;  is not a valid string literal (even a raw string cannot end in an odd number of backslashes)
p55924
aVSpecifically, a raw string cannot end in a single backslash (since the backslash would escape the following quote character)
p55925
aVAdded emphasis mine
p55926
aVRaw strings thus do attach some meaning to a backslash, but only where quotes are concerned
p55927
as(dp55928
g16
V100297
p55929
stp55930
a((dp55931
g2
(lp55932
VUse a dictionary to collect your data
p55933
aVDon't try to set new local names for each list
p55934
aVYou could use string templating too, and a list comprehension to turn your result rows into lists:
p55935
aVOne caveat: only do this with a pre-defined list of table names; don't ever interpolate untrusted input like that without hefty escaping to prevent SQL injection attacks
p55936
as(dp55937
g16
V100297
p55938
stp55939
a((dp55940
g2
(lp55941
VYou are importing an implicit namespace package
p55942
aVQuoting from the Python 3
p55943
aV3 What's New page:
p55944
aVNative support for package directories that don\u2019t require init
p55945
aVpy marker files and can automatically span multiple path segments (inspired by various third party approaches to namespace packages, as described in PEP 420)
p55946
aVand PEP 420 Implicit Namespace Packages:
p55947
aVIf the scan completes without returning a module or package, and at least one directory was recorded, then a namespace package is created
p55948
aVThe new namespace package:
p55949
aVHas a  attribute set to an iterable of the path strings that were found and recorded during the scan
p55950
aVDoes not have a  attribute
p55951
aVand
p55952
aVNamespace packages and regular packages are very similar
p55953
aVThe differences are:
p55954
aVPortions of namespace packages need not all come from the same directory structure, or even from the same loader
p55955
aVRegular packages are self-contained: all parts live in the same directory hierarchy
p55956
aVNamespace packages have no  attribute
p55957
aVNamespace packages'  attribute is a read-only iterable of strings, which is automatically updated when the parent path is modified
p55958
aVNamespace packages have no  module
p55959
aVNamespace packages have a different type of object for their  attribute
p55960
aVRemove the  directory from your  and your test will fail the way it did in earlier Python versions
p55961
as(dp55962
g16
V100297
p55963
stp55964
a((dp55965
g2
(lp55966
VUse  instead,  interprets the input values as Python code turning your  input into a float number
p55967
as(dp55968
g16
V100297
p55969
stp55970
a((dp55971
g2
(lp55972
VYou are looping over the keys of , not the values
p55973
aVYour keys are strings
p55974
aVEven if you were looping over the values, none of the values in  can be indexed by
p55975
aVYou could just print , but that is probably not what you wanted to start with
p55976
aVYou want to put all your named dictionary into one 'parent' dictionary instead:
p55977
aVNow you can loop over this dictionary and access various keys per student:
p55978
aVNote the use of  here to loop over just the values of the  dictionary, as we don't use the keys here
p55979
aVUse the same loop to calculate your averages, but remember that a function ends when a  statement is encountered
p55980
aVYou can always return multiple values from a function by returning a tuple:
p55981
aVor you could use a dictionary, for example
p55982
as(dp55983
g16
V100297
p55984
stp55985
a((dp55986
g2
(lp55987
VThe most efficient way would be to create a map from word to order:
p55988
aVthen use that mapping in sorting:
p55989
aVThe alternative is to use  on the list to scan through the list and find the index for each word while sorting:
p55990
aVbut this is not nearly as efficient as using the  dictionary
p55991
aVDemo:
p55992
aVThe two methods would result in different sorting orders if any of the values in the predefined list were not unique
p55993
aVThe  method uses the first occurrence  of a value as the sort value, the dictionary method would use the last instead
p55994
aVThere are ways around that, you can make the dictionary method process the list and indices in reverse for example
p55995
as(dp55996
g16
V100297
p55997
stp55998
a((dp55999
g2
(lp56000
VUse a source code analysis plugin; there are several to choose from, offering different levels of integration and auto-completion, and support for Sublime Text 2 and / or 3
p56001
aVSublimeCodeIntel - Full-featured code intelligence and smart autocomplete engine
p56002
aVSublimePythonIDE - ST3 only: A rewrite of SublimeRope for ST3, uses the Rope library to add python completions and refactoring to ST3
p56003
aVPython-Auto-Complete - A Sublime Text 2 plugin which adds additional auto-completion capability to Python scripts
p56004
aVSublimeRope - ST2 only, use SublimePythonIDE with ST3: Adds Python completions and some IDE-like functions to Sublime Text 2, through the use of the Rope library
p56005
aVAll packages are available through Sublime Package Control
p56006
as(dp56007
g16
V100297
p56008
stp56009
a((dp56010
g2
(lp56011
VThe string is split twice in the first case
p56012
aVPython cannot be certain, as a dynamic language, that the  value is immutable and that the  method will return the same results every time
p56013
aVIt has no choice but to execute  each time
p56014
as(dp56015
g16
V100297
p56016
stp56017
a((dp56018
g2
(lp56019
VYou are trying to do two things here:
p56020
aVGet the last element of each nested list
p56021
aVGroup those elements by the first element of each nested list
p56022
aVYou can use list comprehension to get the last element of each nested list:
p56023
aVIf the whole list is sorted by the first element (the id) then you can use  to do the second part:
p56024
aVDemo:
p56025
aVIf it wasn't sorted, you'd either have to sort it first (using ), or, if you don't need a sorted version anywhere else, use a  approach to grouping:
p56026
as(dp56027
g16
V100297
p56028
stp56029
a((dp56030
g2
(lp56031
VTo test for membership against a series of values, use a  instead of a list
p56032
aVLike dictionary lookups, set membership tests are O(1) operations
p56033
aVCheap, independent of the size of the set
p56034
aVIf you needed to map values, use a dictionary:
p56035
aVThis all depends on exactly what kind of lookups you are trying to do; many different kinds of lookups can be made very efficient with the right data structures
p56036
aVLooping over large lists for every line in a file is usually not the best option
p56037
as(dp56038
g16
V100297
p56039
stp56040
a((dp56041
g2
(lp56042
VThe function returns the new, stripped string, but you discard that return value
p56043
aVUse a list comprehension instead to replace the whole  list; you'll need to ignore the newlines at the end as well; the  method won't ignore those for you
p56044
aVDemo:
p56045
as(dp56046
g16
V100297
p56047
stp56048
a((dp56049
g2
(lp56050
VYou are testing for the presence of the list incorrectly:
p56051
aVHere you assume that just because the previous row had the same element name, you will have already added a list for that key
p56052
aVApparently that assumption is wrong for the  key
p56053
aVJust test for the key:
p56054
aVYou can also use  to have it return the list value, or set an empty list value if the key is not yet set:
p56055
as(dp56056
g16
V100297
p56057
stp56058
a((dp56059
g2
(lp56060
VIn this case,  is ; the script is trying to read data from the stdin pipe of the script
p56061
aVYou need to pipe data into this script; perhaps something like
p56062
as(dp56063
g16
V100297
p56064
stp56065
a((dp56066
g2
(lp56067
VYou are looking at a tuple assignment
p56068
aVThe right-hand side expression is expected to have resulted in a sequence of two elements, and these two elements are assigned to the two named targets on the left hand side
p56069
aVIn other words,  is expected to return two values, and those two values are assigned to the variables  and
p56070
aVMost likely, the lines in the file contain text like
p56071
aVIf  does not return two values, an exception will be raised instead
p56072
as(dp56073
g16
V100297
p56074
stp56075
a((dp56076
g2
(lp56077
VA regular expression would work better:
p56078
aVDemo:
p56079
as(dp56080
g16
V100297
p56081
stp56082
a((dp56083
g2
(lp56084
VYou are calling the method on the class
p56085
aVYou probably wanted to call it on  instead:
p56086
aVThis goes for all  references in your methods; call methods on the instance unless you have a very specific reason to call them on the class instead, in which case you need to pass in an instance as the first argument, explicitly
p56087
as(dp56088
g16
V100297
p56089
stp56090
a((dp56091
g2
(lp56092
VCreate a dictionary keyed by zipcode, with lists of company names as the values
p56093
aVNow you only have to match company names per zipcode, a much smaller search space
p56094
as(dp56095
g16
V100297
p56096
stp56097
a((dp56098
g2
(lp56099
VYou didn't add the egg to your egg section:
p56100
aVWithout that entry the instance won't ever see the egg
p56101
as(dp56102
g16
V100297
p56103
stp56104
a((dp56105
g2
(lp56106
VPython list indices are 0 based, so  is not a valid index
p56107
aVUse
p56108
aVinstead
p56109
aVHowever, it looks like you are looping over a Pandas dataframe
p56110
aVYou may want to review iterating row by row through a pandas dataframe and  What is the most efficient way to loop through dataframes with pandas
p56111
as(dp56112
g16
V100297
p56113
stp56114
a((dp56115
g2
(lp56116
VDon't use a regular expression
p56117
aVUse a list comprehension instead:
p56118
aVThis creates a list of all entries in  that are a prefix of
p56119
as(dp56120
g16
V100297
p56121
stp56122
a((dp56123
g2
(lp56124
VUse a dict comprehension:
p56125
aVIf you are using Python 3, remove the  prefixes, so use  and
p56126
aVDemo:
p56127
as(dp56128
g16
V100297
p56129
stp56130
a((dp56131
g2
(lp56132
VThe module defines an abstract class interface for use with the
p56133
aVThat module was removed from Python 3; the fact that the  module is still there is likely an oversight
p56134
aVUse it to turn HTML tree events into formatted documents
p56135
aVFor example, if during parsing a HTML document a  header is encountered, the  method will be called, followed by a  method call
p56136
aVUse this module if you are transforming HTML documents; like building a HTML-to-plaintext converter, or a web browser
p56137
as(dp56138
g16
V100297
p56139
stp56140
a((dp56141
g2
(lp56142
VThe  attribute was part of the  class
p56143
aVThe module was deprecated in Python 2
p56144
aV6 and is not present in Python 3
p56145
aVThe  module in Python 3, on the other hand, was called  in Python 2
p56146
aVIt does not have the  attribute
p56147
aVYou can emulate the attribute by listening for start tag events, for any  tag add the  attribute (if present) to a list to build the same list:
p56148
aVAlternatively, use a friendlier API like BeautifulSoup to gather link anchors instead
p56149
as(dp56150
g16
V100297
p56151
stp56152
a((dp56153
g2
(lp56154
VYour terminal happens to be configured to UTF-8
p56155
aVThe fact that printing  works is a coincidence; you are writing raw UTF-8 bytes to the terminal
p56156
aVis a value of length two, containing two bytes, hex values C3 and A1, while  is a unicode value of length one, containing a codepoint U+00E1
p56157
aVThis difference in length is one major reason to use Unicode values; you cannot easily measure the number of text characters in a byte string; the  of a byte string tells you how many bytes were used, not how many characters were encoded
p56158
aVYou can see the difference when you encode the unicode value to different output encodings:
p56159
aVNote that the first 256 codepoints of the Unicode standard match the Latin 1 standard, so the U+00E1 codepoint is encoded to Latin 1 as a byte with hex value E1
p56160
aVFurthermore, Python uses escape codes in representations of unicode and byte strings alike, and low code points that are not printable ASCII are represented using  escape values as well
p56161
aVThis is why a Unicode string with a code point between 128 and 255 looks just like the Latin 1 encoding
p56162
aVIf you have a unicode string with codepoints beyond U+00FF a different escape sequence,  is used instead, with a four-digit hex value
p56163
aVIt looks like you don't yet fully understand what the difference is between Unicode and an encoding
p56164
aVPlease do read the following articles before you continue:
p56165
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p56166
aVby Joel Spolsky
p56167
aVThe Python Unicode HOWTO
p56168
aVPragmatic Unicode by Ned Batchelder
p56169
as(dp56170
g16
V100297
p56171
stp56172
a((dp56173
g2
(lp56174
VYou have a local  file in the same directory
p56175
aVPython imports that file instead of the  package
p56176
aVRemove or rename that file
p56177
as(dp56178
g16
V100297
p56179
stp56180
a((dp56181
g2
(lp56182
VFirst of all, don't name a variable ; you are now masking the built-in  type, and can easily lead to bugs if you expect  to still be that type elsewhere in your code
p56183
aVTo prepend a string to the first element of each nested list, use a simple list comprehension:
p56184
aVThis builds a new list from the nested list, by concatenating a one-element list with the first element altered, plus the remainder of the sublist
p56185
aVDemo:
p56186
as(dp56187
g16
V100297
p56188
stp56189
a((dp56190
g2
(lp56191
VYou need to import the  type, or refer to it directly:
p56192
aVor use  to refer to it
p56193
aVHowever, you seem to be looking at the output of the script as well as the code itself:
p56194
aVRunning that code in my interactive Python interpreter prompt, I see:
p56195
as(dp56196
g16
V100297
p56197
stp56198
a((dp56199
g2
(lp56200
V functions return generators, which are a type of iterator
p56201
aVYou could either loop over the object with a  loop, or turn the result into a list by calling  on it:
p56202
aVYou can also store the object in a variable and use the  function to get results from the generator one by one
p56203
as(dp56204
g16
V100297
p56205
stp56206
a((dp56207
g2
(lp56208
VFor a simple one-file module, sure, that's enough
p56209
aVBut a  file also lets you create a distribution, associate metadata with the distribution (author, homepage, description, etc
p56210
aV, register your package with the Python Package Index and most of all, lets you define what other packages might be needed to run your code
p56211
aVis not just for installing your module
p56212
aVInstalling a module with a  based on  also gives you additional functionality, such as support for namespaced packages (multiple distributions sharing a top-level name) and the ability to install multiple versions of a package side by side
p56213
as(dp56214
g16
V100297
p56215
stp56216
a((dp56217
g2
(lp56218
VThis is entirely correct; a dictionary comprehension is executed as a function scope
p56219
aVAny variables referenced in that function scope not defined in that scope are presumed to be globals
p56220
aVYou get the same effect if you were to use an explicit function in your -ed code:
p56221
aVThis is documented in the Displays for sets and dictionaries section:
p56222
aVNote that the comprehension is executed in a separate scope, so names assigned to in the target list don\u2019t \u201cleak\u201d in the enclosing scope
p56223
aVIn Python 2
p56224
aVx, list comprehensions do not get their own scope, something that has since been changed in Python 3
p56225
as(dp56226
g16
V100297
p56227
stp56228
a((dp56229
g2
(lp56230
VYou'll have to make it a separate validator; you are passing the second regular expression into the  object as a message
p56231
aVJust use a simple function that validates the value; you don't need a regular expression here, you want to invalidate values instead
p56232
aVWriting a regular expression that matches only on a negative gets complicated and is not what you want to do here:
p56233
aVSee Writing validators
p56234
as(dp56235
g16
V100297
p56236
stp56237
a((dp56238
g2
(lp56239
VThe  method alters the dictionary in place and returns
p56240
aVThe dictionary itself is altered, no altered dictionary needs to be returned
p56241
aVAssign the dictionary first:
p56242
aVThis is clearly documented, see the  method documentation:
p56243
aVUpdate the dictionary with the key/value pairs from other, overwriting existing keys
p56244
aVReturn
p56245
as(dp56246
g16
V100297
p56247
stp56248
a((dp56249
g2
(lp56250
VIf a section is defined by the starting line, you can use a generator function to yield sections from an input iterable:
p56251
aVUse this with an input file, for example:
p56252
aVIf sections are simply based on the number of lines, use the  grouper recipe to group the input iterable into groups of a fixed length:
p56253
as(dp56254
g16
V100297
p56255
stp56256
a((dp56257
g2
(lp56258
VYou'll have to use a Python 3 version of ; the version you are using is installing Python 2 tools into a Python 3 virtual environment and these are not compatible
p56259
as(dp56260
g16
V100297
p56261
stp56262
a((dp56263
g2
(lp56264
VYou are receiving the text as encoded UTF8 data
p56265
aVIt is all working correctly
p56266
aVHowever, if you are printing the data on the receiving end directly to a terminal that happens to be configured to display UTF-8, you won't see any difference
p56267
aVPrint the representation instead:
p56268
aVto see the string literal representation including any non-printable, non-ASCII bytes displayed as escape strings
p56269
as(dp56270
g16
V100297
p56271
stp56272
a((dp56273
g2
(lp56274
VYou want to map, not filter:
p56275
aVor, using a list comprehension:
p56276
aVFiltering is akin to the  statement at the end of the list comprehension, mapping is comparable to the expression at the start
p56277
aVDemo:
p56278
as(dp56279
g16
V100297
p56280
stp56281
a((dp56282
g2
(lp56283
VUse  instead
p56284
as(dp56285
g16
V100297
p56286
stp56287
a((dp56288
g2
(lp56289
VYou have lists, not strings
p56290
aVTake the first element of each list:
p56291
as(dp56292
g16
V100297
p56293
stp56294
a((dp56295
g2
(lp56296
VDo not use string interpolation
p56297
aVUse SQL parameters instead:
p56298
aVand leave escaping (and proper quoting) up to the database adapter instead
p56299
aVThis:
p56300
aVSimplifies your code
p56301
aVQuotes different data types correctly
p56302
aVLets the database reuse query plans for varying data
p56303
aVPrevents SQL injection attacks
p56304
aVSee the Passing parameters into  in the Django SQL documentation
p56305
aVIf you are using a different database connector (not the connection provided by Django) verify the specific style of parameter placeholders in the documentation
p56306
aVThe  database adapter for example, uses  as the placeholder syntax
p56307
as(dp56308
g16
V100297
p56309
stp56310
a((dp56311
g2
(lp56312
VDo not get the other method from the ; use  instead so the descriptor protocol can kick in
p56313
aVAnd don't wrap the  function in a  object as that'd neutralize the descriptor you put on
p56314
aVYou need to bind  to the function you generate; a closured  would change with the loop:
p56315
aVDon't forget to return  at the end; I've changed this to use a separate function to create a new scope to provide a new local name  instead of a keyword parameter; this avoids difficulties with  and explicit keyword arguments:
p56316
as(dp56317
g16
V100297
p56318
stp56319
a((dp56320
g2
(lp56321
VA raw string literal is only used to create string values, by avoiding (most) string escape codes that a regular string literal would use
p56322
aVYour string started with the  character; it never contained a backslash and a  character
p56323
aVIf you defined the value contained in  with a string literal, you forgot to escape the backslash
p56324
aVIf the data came from somewhere else, you are looking at a raw hex byte value of 08:
p56325
aVIf this byte was meant to be two characters instead, you could repair the data with string replacement:
p56326
as(dp56327
g16
V100297
p56328
stp56329
a((dp56330
g2
(lp56331
VThose specific constants are only defined on Windows
p56332
aVQuoting from the relevant section:
p56333
aVThe  class and following constants are only available on Windows
p56334
aVThe  module tests for ; if equal to , the  and  classes are defined, and the constants are imported from the  module (which is only ever compiled on Windows)
p56335
aVNote that these constants were not added to  until Python 2
p56336
ag4892
aV2; if you are running Python 2
p56337
ag4892
aV1 or 2
p56338
ag4892
aV0 you'd have to import them from the  module directly
p56339
ag5740
ag4892
aV2 and newer include this bugfix that exposes these constants, but the documentation bugfix failed to mention that the version that these constants were exposed in
p56340
aVHere is a workaround you can use, that adds these constants for you:
p56341
as(dp56342
g16
V100297
p56343
stp56344
a((dp56345
g2
(lp56346
VYou have a database dump, not a database
p56347
aVThe file is merely a text file containing SQL instructions that'll recreate the tables, indices, views, and the data contained therein, if given to MySQL to run against a database
p56348
aVYou'll need to load the dump into a database before you can connect to it:
p56349
aVHere  connects to an existing database on hostname, with the given username and password, and loads the SQL from the file you have
p56350
aVYou'll need to create a database first, if you don't have one at hand to load the dump into
p56351
as(dp56352
g16
V100297
p56353
stp56354
a((dp56355
g2
(lp56356
VYou already accept a dynamic list of keywords
p56357
aVSimply call the function with those keywords:
p56358
aVYou can use the  call syntax to pass in a dictionary to a function instead, it'll be expanded into keyword arguments (which your  function parameter will capture again):
p56359
as(dp56360
g16
V100297
p56361
stp56362
a((dp56363
g2
(lp56364
VThe two are quite different
p56365
aVis a class method, for one, so it'll only let you set class attributes
p56366
aVThey are also called at different times
p56367
aVThe test runner creates a new instance for every test
p56368
aVIf you test class contains 5 test methods, 5 instances are created and  is called 5 times
p56369
aVis normally called only once
p56370
aV(If you shuffle up test ordering and test methods from different classes are intermingled,  can be called multiple times, use  to clean up properly and that won't be a problem)
p56371
aVAlso, a test runner usually creates all test instances at the start of the test run; this is normally cheap, as test instances don't hold (much) state so won't take up much memory
p56372
aVAs a rule of thumb, you should not use  at all
p56373
aVUse  to create state shared between all the tests, and use  to create per-test state
p56374
aVis called just before a test is run, so you can avoid building up a lot of memory-intensive state until it is needed for a test, and not before
p56375
as(dp56376
g16
V100297
p56377
stp56378
a((dp56379
g2
(lp56380
V tests for the type or subclasses of that type
p56381
aVDon't ever use ; you would use  instead:
p56382
aVbut  is much better as it avoids having to look up the type in the first place
p56383
aVLast but not least, types are singletons, testing for  identity would be marginally better:
p56384
aVbut not much better
p56385
aVNote that for old style classes (anything not inheriting from )  will not return the class, but  instead; you'd have to use  instead
p56386
aVcorrectly handles that situation:
p56387
as(dp56388
g16
V100297
p56389
stp56390
a((dp56391
g2
(lp56392
VYou'd have to collect all the various key elements into lists, then loop over those (using , preferably)
p56393
aVThe collecting can be done with :
p56394
aVproduces the same sequence of combinations as if you had nested your loops
p56395
as(dp56396
g16
V100297
p56397
stp56398
a((dp56399
g2
(lp56400
VThe -O2 flag instructs the C compiler to make certain optimization choices, see the GCC optimization flags documentation
p56401
aVThe Python interpreter is written in C; optimizing the machine code the compiler produces means the program could run faster as the code avoids some common speed bottlenecks
p56402
aVThis doesn't apply to just Python
p56403
aVThe downside is that certain aggressive optimizations can introduce errors or reduce speed as assumptions made for these optimizations turn out not to be true
p56404
aVWhat works differs from program to program; without in-depth knowledge of what the optimizations do and a thorough test suite to catch any problems introduced, you should stay away from these flags unless someone who does have that knowledge tells you to use an optimization setting
p56405
aVYou'd be better off focusing on optimising your own Python code instead; there are much bigger gains to be had there
p56406
aVProfile your code, rethink data structures, and if need be, rewrite parts in C as a Python extension
p56407
aVAnd sometimes it is a fact of the problem space you are tackling that certain tasks take time
p56408
as(dp56409
g16
V100297
p56410
stp56411
a((dp56412
g2
(lp56413
VAvoid reinventing the wheel, and use the  module instead:
p56414
aVAs for your error: You are using 0-based date arithmetic; whenever you come to the end of a month, you switch to day 0 of the next month
p56415
aVThis means you will never hit the end condition if the  day is the last day of the month, for example; before you test for  you already changed the date to
p56416
aVUse 1-based arithmetic, and only change the month when you get beyond the last day of that month
p56417
aVNote that you can test equality between tuples, no need to do a full test against each element
p56418
aVYour leap year calculation needs a little refinement too:
p56419
as(dp56420
g16
V100297
p56421
stp56422
a((dp56423
g2
(lp56424
VYour  method assumes that the class is still present by the time it is called
p56425
aVThis assumption is incorrect
p56426
aVhas already been cleared when your Python program exits and is now set to
p56427
aVTest if the global reference to the class still exists first:
p56428
aVor use  to get the local reference:
p56429
aVbut do note that this means that the semantics for  change if  is subclassed (each subclass gets a  attribute versus only  having a  attribute)
p56430
aVQuoting from the  hook documentation:
p56431
aVWarning: Due to the precarious circumstances under which  methods are invoked, exceptions that occur during their execution are ignored, and a warning is printed to  instead
p56432
aVAlso, when  is invoked in response to a module being deleted (e
p56433
ag1298
aV, when execution of the program is done), other globals referenced by the  method may already have been deleted or in the process of being torn down (e
p56434
ag1298
aVthe import machinery shutting down)
p56435
aVFor this reason,  methods should do the absolute minimum needed to maintain external invariants
p56436
aVStarting with version 1
p56437
aV5, Python guarantees that globals whose name begins with a single underscore are deleted from their module before other globals are deleted; if no other references to such globals exist, this may help in assuring that imported modules are still available at the time when the  method is called
p56438
aVIf you are using Python 3, two additional notes apply:
p56439
aVCPython 3
p56440
aV3 automatically applies a randomized hash salt to the  keys used in a  dictionary; this also affects the order in which globals are cleaned up, and it could be that you see the problem on only some of the runs
p56441
aVCPython 3
p56442
aV4 no longer sets globals to  (in most cases), as per Safe Object Finalization; see PEP 442
p56443
as(dp56444
g16
V100297
p56445
stp56446
a((dp56447
g2
(lp56448
VThe Windows filesystem uses UTF16 encoding
p56449
aVYour best bet is to use unicode values instead though, as Python will automatically use the correct codecs and APIs for your platform to encode filenames:
p56450
as(dp56451
g16
V100297
p56452
stp56453
a((dp56454
g2
(lp56455
VYou cannot make a GET request with a JSON-encoded body, as a GET request only ever consists of the URL and the headers
p56456
aVParameters are encoded into the URL using URL encoding instead, there is no option to encode such parameters to JSON instead
p56457
aVYou create URL-encoded parameters with the  function, then appended to the URL with
p56458
aVDo not use the  parameter; using that keyword argument forces a request to use the POST method:
p56459
aVdata must be a  object specifying additional data to send to the server, or  if no such data is needed
p56460
aVCurrently HTTP requests are the only ones that use data; the HTTP request will be a POST instead of a GET when the data parameter is provided
p56461
aVdata should be a buffer in the standard application/x-www-form-urlencoded format
p56462
as(dp56463
g16
V100297
p56464
stp56465
a((dp56466
g2
(lp56467
VThere are bytes before the  statement (unicode non-breaking whitespace characters are a prime candidate) that could cause this
p56468
aVCheck the first 50 bytes or so:
p56469
aVIf you see a sequence like  then you have UTF-8 encoded non-breakable space characters in there, for example
p56470
as(dp56471
g16
V100297
p56472
stp56473
a((dp56474
g2
(lp56475
VUse  on each tuple:
p56476
aVbefore printing
p56477
as(dp56478
g16
V100297
p56479
stp56480
a((dp56481
g2
(lp56482
VAdd the milliseconds separately by dividing the timestamp microseconds by 1000:
p56483
aVDemo:
p56484
as(dp56485
g16
V100297
p56486
stp56487
a((dp56488
g2
(lp56489
VYour code runs when the module is imported
p56490
aVPython executes all top-level statements, including class definitions at that time
p56491
aVA class definition body is executed as a function, with the local namespace becoming the class attributes
p56492
aVThis means that class bodies are executed on import, provided the class is defined at the top-level of the module
p56493
aVWhen Python encounters a decorated function when executing, it'll define the class, then execute the decorator function, passing in the function object and binding the return value of the decorator to the name of the function
p56494
aVSince the class body is executed during import, this means your decorator is executed at that time
p56495
as(dp56496
g16
V100297
p56497
stp56498
a((dp56499
g2
(lp56500
VYour code is using a relative path; python is looking in the current directory (whatever that may be) to load your file
p56501
aVWhat the current directory is depends on how you started your Python script and if you executed any code that may have changed the current working directory
p56502
aVUse a full absolute path instead:
p56503
aVUsing  is entirely correct, the  module recommends you do so:
p56504
aVIf csvfile is a file object, it must be opened with the \u2018b\u2019 flag on platforms where that makes a difference
p56505
aVWindows is such a platform
p56506
as(dp56507
g16
V100297
p56508
stp56509
a((dp56510
g2
(lp56511
VFair warning: this is a hack only suitable for experimentation and play in a Python interpreter environment
p56512
aVDo not feed untrusted input into this code
p56513
aVYou can define  as an instance of the following class:
p56514
aVInstances of this object will evaluate the expression automatically when printed or echoed in a Python interpreter
p56515
aVExpressions only support references to global names
p56516
aVDemo:
p56517
as(dp56518
g16
V100297
p56519
stp56520
a((dp56521
g2
(lp56522
VUnless you need set attributes dynamically and bypass descriptors or the  hook, do not assign attributes directly to
p56523
aVNot all instances have a  attribute even, not if the class defined a  attribute to save memory
p56524
aVIf you do need to set attributes dynamically but don't need to bypass a descriptor or a  hook, you'd use the  function normally
p56525
as(dp56526
g16
V100297
p56527
stp56528
a((dp56529
g2
(lp56530
VUse the  library to convert such text to 'regular' text:
p56531
aVDo note that you need to pass in a byte string, not a  value; the library decodes to Unicode for you
p56532
aVObligatory disclaimer: I am the author of that library, albeit quite some time ago now
p56533
as(dp56534
g16
V100297
p56535
stp56536
a((dp56537
g2
(lp56538
VJust prepend the number, using string formatting, for example:
p56539
aVUse the  function to generate your counter:
p56540
aVDemo:
p56541
as(dp56542
g16
V100297
p56543
stp56544
a((dp56545
g2
(lp56546
VYou are overcomplicating things, by quite some distance
p56547
aVPython takes care of most of this for you
p56548
aVThere is no need to open a socket yourself, nor do you need to build headers and the HTTP opening line
p56549
aVUse the  and  modules to do the work for you:
p56550
aVtakes a second parameter, the data to be sent in a  request; the library takes care of calculating the length of the body, and sets the appropriate headers
p56551
aVMost of all, under the hood it uses another library, , to take care of the socket connection and producing valid headers and a HTTP request line
p56552
aVThe POST body is encoded using , which also takes care of proper quoting for you
p56553
aVYou may also want to look into the external  library, which provides an easier-to-use API still:
p56554
as(dp56555
g16
V100297
p56556
stp56557
a((dp56558
g2
(lp56559
VThe  stylesheet defines what the layout is on a mobile device
p56560
aVYou can clear that file in your own skin layer
p56561
as(dp56562
g16
V100297
p56563
stp56564
a((dp56565
g2
(lp56566
VJust call  on the generator for those occasions you need the result to be materialized:
p56567
as(dp56568
g16
V100297
p56569
stp56570
a((dp56571
g2
(lp56572
VYou need to split the sentence, reverse the words, then reassemble
p56573
aVThe simplest way to split is to do so on whitespace, with ; reassembly is then just a case of re-joining the reversed words with a space:
p56574
aVDemo:
p56575
as(dp56576
g16
V100297
p56577
stp56578
a((dp56579
g2
(lp56580
VFunctions and  objects act as descriptors; both return a wrapper that when called will in turn call the underlying function with an extra parameter
p56581
aVThe only difference between how functions and  objects behave is in what that extra parameter is
p56582
aVTo create a hybrid of the two approaches, build your own descriptor decorator:
p56583
aVHere, we return a wrapper that'll use either the class or the instance as the first parameter, depending on what is available when the descriptor  method is called
p56584
aVDemo:
p56585
as(dp56586
g16
V100297
p56587
stp56588
a((dp56589
g2
(lp56590
VThe stack trace is a linked sequence of frame objects; each frame object has a reference to the globals and locals for that frame
p56591
aVThe traceback object has a  attribute, this is the 'current' frame
p56592
aVThe object also has a  attribute, the link to the next traceback object in the stack
p56593
aVEach frame object has  and  attributes, both are dictionaries
p56594
aVThe  module documentation has a handy overview of the attributes found on traceback and frame objects
p56595
aVYou may want to look over the  module; it provides a higher-level API to manipulate and display tracebacks
p56596
as(dp56597
g16
V100297
p56598
stp56599
a((dp56600
g2
(lp56601
VSome of the URLs you are trying to scrape do not exist
p56602
aVSimply skip perhaps, by ignoring the exception:
p56603
as(dp56604
g16
V100297
p56605
stp56606
a((dp56607
g2
(lp56608
VYou didn't call  at all, so the variables were never set
p56609
aVCall it first, then call :
p56610
aVNames don't just pop into existence just because you marked them as  in a function; Python names require assignment (binding) to materialize
p56611
as(dp56612
g16
V100297
p56613
stp56614
a((dp56615
g2
(lp56616
VYou opened the  for appending; every time you run this script more data will be added to the end, and the old data already there is retained
p56617
aVYour code is working fine otherwise, but I'd use  to format the output rows instead of using ; you can feed the  object directly into the   method and be done with it
p56618
aVI'd also use the file objects as context managers with the  statement and have them closed automatically:
p56619
as(dp56620
g16
V100297
p56621
stp56622
a((dp56623
g2
(lp56624
VThis is deliberate, since all expressions return something, even if it is only
p56625
aVYou'd see nothing but  in your interpreter
p56626
aVYou can explicitly show the return value with  or , or by printing (which calls  on results by default):
p56627
aVwould be closest to what the interpreter does if an expression result is not
p56628
aVThe regular Python interpreter uses  to display interpreter expression results; the IPython interpreter uses it's own hook to do this, but this hook explicitly ignores
p56629
aVYou can certainly use your own wrapper, the following hook delegates to a pre-existing hook and always displays , regardless:
p56630
as(dp56631
g16
V100297
p56632
stp56633
a((dp56634
g2
(lp56635
VTo return all numbers in all strings in a list named , you can use a list comprehension:
p56636
aVThis casts the numbers to integers as well
p56637
aVIf you needed floating point values (so, numbers with a decimal point in them), add on a pattern for one decimal point flanked by digits:
p56638
aVIf, however, you are only looking for strings that are numbers (rather than just contain numbers),  may suffice:
p56639
aVNote that this will not match floating point numbers ( is only  if all characters are digits; a decimal point doesn't count)
p56640
as(dp56641
g16
V100297
p56642
stp56643
a((dp56644
g2
(lp56645
VYou can use the  operator:
p56646
aVor, if the position is important, use a slice:
p56647
aVThe latter works for lists that are size one, two or longer, and only is  if the list is length 2 and the second element is equal to :
p56648
as(dp56649
g16
V100297
p56650
stp56651
a((dp56652
g2
(lp56653
VYou need to store your  and  values on the instance, by making them attributes on :
p56654
aVYou really want to review the Classes chapter of the Python tutorial though
p56655
as(dp56656
g16
V100297
p56657
stp56658
a((dp56659
g2
(lp56660
VYou can create a instance of  and call the methods on that, provided you pass in the name of an existing method on the class
p56661
aVwill do in this case:
p56662
aVHowever, you are probably looking for a good Mock library instead
p56663
aVwould be a good choice
p56664
as(dp56665
g16
V100297
p56666
stp56667
a((dp56668
g2
(lp56669
VYou need to use a raw string, double your slashes or use forward slashes instead:
p56670
aVIn regular python strings, the  character combination signals a extended Unicode codepoint escape
p56671
as(dp56672
g16
V100297
p56673
stp56674
a((dp56675
g2
(lp56676
VYou are reading all lines, and assigning the first line (a sequence) to two variables
p56677
aVThis only works if the first line consists of 2 characters
p56678
aVUse the file as an iterator instead:
p56679
aVHere  reads the next line from the file
p56680
aVThe alternative would be to use a pair-wise recipe:
p56681
aVNote the  calls, to remove any extra whitespace (including the newline at the end of each line)
p56682
as(dp56683
g16
V100297
p56684
stp56685
a((dp56686
g2
(lp56687
VThe author of the underlying  class has replaced the normal semantics of various Python expressions to implement a mini query language
p56688
aVMost likely, the  class overrides the  and  hooks
p56689
aVThe  expression is handled by the  hook and returns some kind of specialized object that is then passed to the  hook via the  syntax
p56690
aVThe  hook then uses that specialised object to determine what indices in the sequence to alter
p56691
aVThe  operator looks for a  method on either operand, and if present, that method is called and the return value (normally  or ) is returned as the result for that equality test
p56692
aVHowever, the  method on  returns something else; and that 'something' could also implement additional hooks (such as  and ) to make further refinements to the query language possible
p56693
aVThe  assignment is translated to , so the outcome of  is passed to that method for it to alter the underlying sequence based on the 'search query'
p56694
aVAt a guess,  could also work, provided the special object implements the  hook; it may implement the  hook to make  work as well
p56695
aVThe reason  and  could be supported is that  and  are not overridable with hooks (these short-circuit, a hook would require both operands to be evaluated breaking short-circuit expectations)
p56696
as(dp56697
g16
V100297
p56698
stp56699
a((dp56700
g2
(lp56701
VEnvironment variables for a given user are set by shell configuration files, something that Supervisor will not do for you
p56702
aVIf you rely on certain environment variables to be set, set those in your configuration for that process instead
p56703
as(dp56704
g16
V100297
p56705
stp56706
a((dp56707
g2
(lp56708
VYou'd have to merge all sets; take the unions of the sets in both lists, then take the intersection of these two unions:
p56709
as(dp56710
g16
V100297
p56711
stp56712
a((dp56713
g2
(lp56714
VI'd collect all values into  with  values, then unzip the values back into separate dictionaries; from some experimentation I am guessing you want to ignore empty values and only put them back in to make up the output dictionary:
p56715
aVNow we get:
p56716
as(dp56717
g16
V100297
p56718
stp56719
a((dp56720
g2
(lp56721
VYou cannot use a conditional after , only after
p56722
aVis only checked if the preceding  or  conditionals did not match
p56723
aVDemo:
p56724
aVEven though  was set to  in the first block, the  condition did not match
p56725
aVQuoting from the  statement documentation:
p56726
aVIt selects exactly one of the suites by evaluating the expressions one by one until one is found to be true [
p56727
aV; then that suite is executed (and no other part of the  statement is executed or evaluated)
p56728
aVIf all expressions are false, the suite of the  clause, if present, is executed
p56729
aVEmphasis mine
p56730
aVIn fact, this extends to the other conditions too:
p56731
aVNote how the  condition is entirely ignored; if it wasn't, an exception would be raised
p56732
as(dp56733
g16
V100297
p56734
stp56735
a((dp56736
g2
(lp56737
VIt appears you are looking at more than just ; you have two capturing groups defined in your regular expression
p56738
aVYou can make the second group non-capturing by using  instead of :
p56739
as(dp56740
g16
V100297
p56741
stp56742
a((dp56743
g2
(lp56744
VYou set  to a  in :
p56745
aVHere  is a sequence of floating point values (the  values), and you set  to the lowest value of these (you could have used  there instead of sorting)
p56746
aVPerhaps you meant to set it to  instead
p56747
as(dp56748
g16
V100297
p56749
stp56750
a((dp56751
g2
(lp56752
VYour functions do not define a  parameter, nor will they ever get one
p56753
aVYou need to use methods; you can create these from the functions by treating them as descriptors and explicitly calling  on them:
p56754
aVNormally, the  method is called on functions when accessing them on a class (either directly or via an instance)
p56755
aVThis doesn't happen for functions added directly on an instance however, so you need to do it manually
p56756
as(dp56757
g16
V100297
p56758
stp56759
a((dp56760
g2
(lp56761
VYou have CSV files here, so use the  module to read and write these files
p56762
aVUse a set to store the unique keys from A, then use that set to filter rows from B:
p56763
aVNote that sets, like dictionaries, can only store hashable values, so we turn the first two columns of each CSV row into a tuple to fit that requirement
p56764
as(dp56765
g16
V100297
p56766
stp56767
a((dp56768
g2
(lp56769
VUse date formatting with :
p56770
aVDemo:
p56771
aVYou can do the same with the separate integer components of the  object, but you need to use the right string formatting parameters; to format an integer to two digits with leading zeros, use , for example:
p56772
aVbut using  is more efficient
p56773
as(dp56774
g16
V100297
p56775
stp56776
a((dp56777
g2
(lp56778
VYou have two options here: implement conflict resolution, or retry the commit with fresh data
p56779
aVConflict resolution only applies to custom types you store in the ZODB, and can only be applied if you know how to merge your change into the newly-changed state
p56780
aVThe ZODB looks for a  method on custom types and calls that method with the old state, the saved state you are in conflict with, and the new state you tried to commit; you are supposed to return the merged state
p56781
aVFor a simple counter, like in your example, that'd be a as simple as updating the saved state with the change between the old and new states:
p56782
aVThe other option is to retry the commit; you want to limit the number of retries, and you probably want to encapsulate this in a decorator on your method, but the basic principle is that you loop up to a limit, make your calculations based on ZODB data (which, after a conflict error, will auto-read fresh data where needed), then attempt to commit
p56783
aVIf the commit is successful you are done:
p56784
as(dp56785
g16
V100297
p56786
stp56787
a((dp56788
g2
(lp56789
VYour understanding is not entirely correct
p56790
aVThe  module is an object;  is then an attribute lookup on that object; it has to be a callable object because you try to call it with the  syntax
p56791
aVThat means it can be a class, or a function or any other object with a  method
p56792
aVThat callable returns something; all callables do
p56793
aVFor a class, generally an instance is returned, but for a function that can be any Python object
p56794
aVWhatever  does, it returns an object that has a  attribute, or has a  method that returns something when called with the name
p56795
aVIn this specific case,  is a function, which has been imported into the  package initializer module
p56796
aVThis function, indirectly, creates a  instance, and calls the  method on that instance
p56797
aVThat method, eventually, returns a  instance, which does have a  attribute
p56798
as(dp56799
g16
V100297
p56800
stp56801
a((dp56802
g2
(lp56803
VYou can supply a  of exceptions to the  block to catch:
p56804
aVThe catch-all  parameter will always result in a tuple
p56805
aVI've added a  keyword as well, so you can configure the number of retries too:
p56806
aVDemo:
p56807
as(dp56808
g16
V100297
p56809
stp56810
a((dp56811
g2
(lp56812
VYou are splitting on the comma, but with two commas side-by-side you'll have empty strings in the result:
p56813
aVThis in turn leads to the empty lists when trying to split that empty string further:
p56814
aVand that leads to an index error on
p56815
aVFilter out the empty values; using  would do that nicely:
p56816
aVDemo:
p56817
as(dp56818
g16
V100297
p56819
stp56820
a((dp56821
g2
(lp56822
V doesn't do that
p56823
aVIt's Python, which escapes any special characters when representing a string:
p56824
aVIn a regular Python string literal, a  has special meaning, so it is escaped when echoing back the value, which can be pasted right back into a Python script or interpreter session to recreate the same value
p56825
aVOn Linux or Mac, you generally do not need to escape a  value in a filename; a  has no special meaning in a regular python string, nor in most Linux or Mac filenames:
p56826
as(dp56827
g16
V100297
p56828
stp56829
a((dp56830
g2
(lp56831
VYou have both a hardware package and a hardware module
p56832
aVDon't
p56833
aVRename one or the other; Python has to inspect the  directory too
p56834
aVIn case 1, the  package is being imported before the  module is found, and it appears you left the  file empty, so trying to access  raises an attribute error
p56835
aVIn case 2, the  directory is inspected for a  file first, raising a warning to let you know that that file is missing; this is to prevent a common error made by beginnning Python developers that forget to create that file
p56836
aVPython then does find  and imports that instead
p56837
aVYou should not use directory names that match module names
p56838
aVJust rename  (and adjust your imports) or rename the directory
p56839
as(dp56840
g16
V100297
p56841
stp56842
a((dp56843
g2
(lp56844
VYou have your loops inverted in the first version
p56845
aVYou are creating inner tuples looping over  and outer tuples with a loop over
p56846
aVYour code is the equivalent (with lists instead of tuples) of this instead:
p56847
aVand relied on  still being assigned as a global
p56848
aVYou can see this too when you indent your expression based on the parenthesis:
p56849
aVReverse the loops (indented differently to communicate the grouping better):
p56850
aVThe above is the equivalent of:
p56851
aVYou can simplify your code with using :
p56852
as(dp56853
g16
V100297
p56854
stp56855
a((dp56856
g2
(lp56857
VThe loop creates a nested dictionary, and sets all values to 1, presumably to then just use the keys as a way to weed out duplicate values
p56858
aVYou could use sets instead and avoid the  value:
p56859
aVNote that you don't even need to create the initial dictionaries; you can create the whole set with one statement, a set comprehension
p56860
aVIf other code does rely on dictionaries with the values being set to  (perhaps to update counts at a later stage), it'd be more performant to use the  class method instead:
p56861
aVLooking at your source blog article however shows that the dictionaries are only used to do membership testing against the keys, so using sets here is much better and transparent to the rest of the code to boot
p56862
as(dp56863
g16
V100297
p56864
stp56865
a((dp56866
g2
(lp56867
VBeautifulsoup does not load a URL for you
p56868
aVYou need to pass in the full HTML page, which means you need to load it from the URL first
p56869
aVHere is a sample using the  function to achieve that:
p56870
aVNow you can extract the colours just fine:
p56871
as(dp56872
g16
V100297
p56873
stp56874
a((dp56875
g2
(lp56876
VSure, by using multiple assignment targets:
p56877
aVor by just plain incrementing  on a separate line:
p56878
aVbecause readable trumps overly clever
p56879
aVThere is no  operator because integers in Python are immutable; you rebind the name to a new integer value instead
p56880
as(dp56881
g16
V100297
p56882
stp56883
a((dp56884
g2
(lp56885
VThe  loop assigns a new value to  every loop iteration, namely the next value taken from the loop iterable (in this case
p56886
aVYou can modify  in the loop itself, but that doesn't alter the iterable  is working with
p56887
aVIf you wanted to change the loop iterable, then you'd have to do so directly on the iterable:
p56888
aVHere, we create a iterator object from the  sequence by using the  function; the  statement does the exact same thing under the hood, but now we can address the iterator directly
p56889
aVThe  function advances the iterator to the next value, just like the  loop would do
p56890
aVHowever, it may be easier to just use a  loop instead:
p56891
aVThe thing to remember is that the Python  loop statement is nothing like a C or Java or JavaScript  loop
p56892
aVIt is a Foreach loop instead
p56893
aVsimply generates a sequence of numbers to loop over, as opposed to a C-style  loop, which combines the initial assignment (), test () and loop incrementer () into one statement
p56894
as(dp56895
g16
V100297
p56896
stp56897
a((dp56898
g2
(lp56899
VExpressions are resolved using the documented operator precedence table
p56900
aVThis means that multiplication and division comes before subtraction, with operators of equal precedence being applied from left to right, so the expression can be read as:
p56901
aVThe same applies to the modulo operator; the operations are applied from left to right:
p56902
as(dp56903
g16
V100297
p56904
stp56905
a((dp56906
g2
(lp56907
VThis is perfectly safe, you can assign additional attributes on your custom exception instance, as long as it is not
p56908
aVPlenty of custom exception subclasses in the standard library do the same
p56909
aVFor example, the  exception adds , , ,  and  attributes
p56910
as(dp56911
g16
V100297
p56912
stp56913
a((dp56914
g2
(lp56915
VFirst of all, just use:
p56916
aVYour rather elaborate callable returns the same list over and over again
p56917
aVYou are using the same list for all values in your dictionary
p56918
aVThe above lambda returns a new list each time it is called instead:
p56919
aVYou thus fill your dictionary with references to one list, and altering values in that one list is reflected everywhere the reference to that one list is printed
p56920
as(dp56921
g16
V100297
p56922
stp56923
a((dp56924
g2
(lp56925
VIf your  only contains values found in the first column, then split the line and only test the first value against a , not a :
p56926
aVTesting against a set is a O(1) constant time operation (independent of the size of the set)
p56927
aVDemo:
p56928
aVYou may want to return a generator instead, and only filter, not build a list in memory:
p56929
aVYou can loop, but not index this result:
p56930
aVand not need to hold all matched entries in memory
p56931
as(dp56932
g16
V100297
p56933
stp56934
a((dp56935
g2
(lp56936
VYou probably have empty lines in your input file; you would want to skip these
p56937
aVYou can also simplify your tile reading code:
p56938
aVThis only processes lines if there is a  character in them, splits only once, and creates the  list in one loop
p56939
aVAs for using : you are starting the other script in the background
p56940
aVThat script then opens the file to write to and explictly empties the file, before it generates new data
p56941
aVAt the same time you are trying to read from that file
p56942
aVChances are you end up reading an empty file at that time, as the other process hasn't yet finished generating and writing the data, and as file writes are buffered you won't see all of the data until the other process closes the file and exits
p56943
aVDon't use  at all here
p56944
aVImport the other file instead; then the code will be executed during import and the file is guaranteed to be closed
p56945
as(dp56946
g16
V100297
p56947
stp56948
a((dp56949
g2
(lp56950
VYou are reading a Excel sheet with data outside of the ASCII range
p56951
aVWhen writing unicode values to a CSV file, automatic encoding takes place, but for values outside the ASCII range of characters that fails
p56952
aVEncode explicitly:
p56953
aVYou may need to pick a different encoding, depending on your needs
p56954
as(dp56955
g16
V100297
p56956
stp56957
a((dp56958
g2
(lp56959
VYour  value is a string that includes the newline character from the file still, so test for a string value:
p56960
aVor strip the newline:
p56961
aV  if FS
p56962
aVstrip() == '0':
p56963
aVor turn  into a float first:
p56964
aVor strip  while splitting:
p56965
aVFurther tips:
p56966
aVJust loop over  directly; don't use :
p56967
aVEven if you still need an index as well, you use  to generate the index:
p56968
aVYou can use the  module to handle splitting data files into rows:
p56969
as(dp56970
g16
V100297
p56971
stp56972
a((dp56973
g2
(lp56974
VYou created a list of only the dictionary values, but then try to loop over it as if it already contains both keys and values of those dictionaries
p56975
aVPerhaps you wanted to loop over each matched dictionary
p56976
aVI'd instead flatten the structure:
p56977
aVthen just search:
p56978
aVDemo:
p56979
as(dp56980
g16
V100297
p56981
stp56982
a((dp56983
g2
(lp56984
VThe  statement is adding the spaces; if you want the space to be dropped, don't  but use  instead:
p56985
aVThis uses string formatting with  to create the same output format, but now no space will be written following the  value
p56986
as(dp56987
g16
V100297
p56988
stp56989
a((dp56990
g2
(lp56991
VUse a conditional expression:
p56992
aVOnly one of  and  will be evaluated depending on the outcome of
p56993
aVQuoting the documentation:
p56994
aVThe expression  first evaluates the condition, C (not x); if C is true, x is evaluated and its value is returned; otherwise, y is evaluated and its value is returned
p56995
aVAdapting this to your code:
p56996
as(dp56997
g16
V100297
p56998
stp56999
a((dp57000
g2
(lp57001
VYou need to read the file:
p57002
aVtakes a string to compress, not a filename
p57003
as(dp57004
g16
V100297
p57005
stp57006
a((dp57007
g2
(lp57008
VYes, that function is called ; use it with :
p57009
aVtakes the first to values of , passes those to the first argument, , effectively executing
p57010
aVIt then takes that result, plus the next value in  and applies the first argument again, and so on until  is done
p57011
aVFor  with 4 elements, that comes down to:
p57012
aVor the equivalent of:
p57013
aVbut reduce works for any length of  > 0 (for a list of length 1 the first value is returned without applying the first argument)
p57014
aVNote that your use of  is very unpythonic; don't ever do that
p57015
aVYou could have written your loop with an initial  from  instead:
p57016
as(dp57017
g16
V100297
p57018
stp57019
a((dp57020
g2
(lp57021
VYou need to add the Django Supervisor application to the  list in your settings module
p57022
aVQuoting the documentation:
p57023
aVTo get started, just include "djsupervisor" in your INSTALLED_APPS and drop a "supervisord
p57024
aVconf" file in your project directory, right next to the main manage
p57025
aVpy script
p57026
as(dp57027
g16
V100297
p57028
stp57029
a((dp57030
g2
(lp57031
VThe remote connection timed out
p57032
aVThe host you are trying to connect to is not answering; it is not refusing connections, it is just not responding at all to connection attempts
p57033
aVPerhaps the host is overloaded or down
p57034
aVIt could also be caused by the site blocking your IP address by dropping the packets (a firewall  rule instead of a  rule)
p57035
aVYou can try to connect to the site from a different IP address; if those connections work fine, but not from the original address, there is a higher likelihood that you are deliberately being blocked
p57036
as(dp57037
g16
V100297
p57038
stp57039
a((dp57040
g2
(lp57041
VFrom the  documentation:
p57042
aVJoin one or more path components intelligently
p57043
aVIf any component is an absolute path, all previous components (on Windows, including the previous drive letter, if there was one) are thrown away, and joining continues
p57044
aVA  at the start makes  an absolute path
p57045
aVIf you wanted to join multiple path elements that perhaps contain a leading path separator, then strip those first:
p57046
aVSpecial-casing absolute paths makes it possible for you to specify either a relative path (from a default parent directory) or an absolute path and not have to detect if you have an absolute or relative path when constructing your final value
p57047
as(dp57048
g16
V100297
p57049
stp57050
a((dp57051
g2
(lp57052
VYou need a dictionary to track the matches
p57053
aVYou do not need a regular expression, only the first 5 characters need to be tracked
p57054
aVStore rows by their 'key', comprised of the first column and the first 5 characters of the second, and add a count
p57055
aVYou need to count first, then write out the collected rows and counts
p57056
aVIf ordering matters, you can replace the dictionary with  but otherwise the code is the same:
p57057
as(dp57058
g16
V100297
p57059
stp57060
a((dp57061
g2
(lp57062
VThis is normal behaviour; Python is giving you a string representation that can be pasted right back into a Python script or interpreter prompt
p57063
aVSince  is a character used in Python string literals to start an escape sequence (such as  or ) the backslashes are doubled
p57064
aVIn fact, it is the characters without escaped backslashes that are the key here;  is the escape code for a carriage return
p57065
aVYou need to use one of the following options to specify Windows paths instead:
p57066
aVEscape all backslashes by doubling them in your string literals:
p57067
aVNow the  won't be interpreted as an escape code
p57068
aVUse a raw string literal:
p57069
aVIn raw string literals most escape codes are ignored
p57070
aVUse forward slashes:
p57071
aVForward slashes work fine as path separators on Windows, and there's no chance of them being interpreted as escape characters
p57072
as(dp57073
g16
V100297
p57074
stp57075
a((dp57076
g2
(lp57077
VThe compiler connects them
p57078
aVWhen compiling  and , the  name in  is marked as a closure, and a free variable in
p57079
aVOn execution, the interpreter then knows to attach a reference to the  name from  to the  function object as a closure cell
p57080
aVYou can see the result in the disassembly of the bytecode:
p57081
aVThe  wraps the  name in a closure for  to use;  builds a function object (from the byte code object loaded with ) with attached closure cells as a tuple
p57082
aVIn , the  opcode loads the value from the  closure
p57083
aVThe closure can be found back on the resulting  function object:
p57084
aVso the  function object carries the closure with it for later dereferencing
p57085
as(dp57086
g16
V100297
p57087
stp57088
a((dp57089
g2
(lp57090
VYour PHP code encodes the password to UTF16, little endian; if your password value is a unicode value, that works just fine in Python:
p57091
aVThe above session was done in Python 2; in Python 3 the  prefix can be omitted as all string values are Unicode
p57092
as(dp57093
g16
V100297
p57094
stp57095
a((dp57096
g2
(lp57097
VBecause  does not include the empty line at the end, while  returns an empty string for the last :
p57098
aVThis is explicitly mentioned in the  documentation:
p57099
aVUnlike  when a delimiter string sep is given, this method returns an empty list for the empty string, and a terminal line break does not result in an extra line
p57100
aVIf there is no trailing newline, the output is identical:
p57101
aVIn other words,  doesn't add anything, but  does remove
p57102
as(dp57103
g16
V100297
p57104
stp57105
a((dp57106
g2
(lp57107
VYes, the  and  libraries use the old-style  string formatting syntax internally
p57108
aVThese libraries were developed before  and  were available, or in the case of  the library authors aimed at compatibility with earlier Python versions
p57109
aVIf the  formatting ever is removed, then those libraries will indeed have to move to using string formatting using  placeholders
p57110
aVHowever, for various reasons, the  old-style string formatting style is here to stay for the foreseeable future; it has been 'un-deprecated';  is to be preferred but  is kept around for backwards compatibility
p57111
as(dp57112
g16
V100297
p57113
stp57114
a((dp57115
g2
(lp57116
VYou are testing all the arguments, even if there is only one that matches
p57117
aVFor each argument that doesn't match, you print your error message
p57118
aVUse the  function to see if there are any matches:
p57119
aVor invert the test; use  and bail out early:
p57120
aVIf  with a generator expression is a little too hard to grok, you can still use a  loop, but you need to use  to end the loop early and a  suite that'll be executed when the  loop was not exited early:
p57121
as(dp57122
g16
V100297
p57123
stp57124
a((dp57125
g2
(lp57126
V is a different project from
p57127
aVInstalling just  will not install
p57128
aVBoth install packages from the Python Package Index, but  uses  to provide a nicer interface and a slightly different approach
p57129
aVIn other words, to use  you first need to install
p57130
aVoffers more features than , including uninstalling and 'editable' installations where a git, subversion or mercurial repository is cloned and installed as a development egg
p57131
aVNote that the  package is smaller than the  package:
p57132
aV: size 444
p57133
aV7kb
p57134
aV: size 101
p57135
aV2kb
p57136
aVYou must be installing the  or  recommended packages to bring the installed size to 30MB
p57137
as(dp57138
g16
V100297
p57139
stp57140
a((dp57141
g2
(lp57142
VYou can create a dynamic subclass of the interface using the  metatype
p57143
aVCreate a dictionary of the additional schema fields:
p57144
aVNow you can create a dynamic interface subclassing your existing interface:
p57145
aVThis can all be wrapped up in a class decorator if you so desire:
p57146
aVwhich you'd use on your existing interface:
p57147
aVThis creates a subclass; you can also replace the whole interface with the generated interface:
p57148
aVDemo of that last version:
p57149
as(dp57150
g16
V100297
p57151
stp57152
a((dp57153
g2
(lp57154
VTest by masking with :
p57155
aVis used to combine flags, use  (bitwise AND) to test if a flag is set
p57156
aVThe  line is most likely an error in the  example, it is always going to be
p57157
aVDemo:
p57158
aVBecause numeric 0 is false and any other numeric value is true,  is seen as true
p57159
aVNote that  is ; it is the equivalent of not having set any flags
p57160
aVYou can test for that explicitly ( or ), or infer it from tests for the other flags
p57161
as(dp57162
g16
V100297
p57163
stp57164
a((dp57165
g2
(lp57166
VYou can loop over the  results and collect them in a  object
p57167
aVDo adjust your regular expressions to not include the quotes, and add some whitespace tolerance, though:
p57168
aVYou can replace  with  and  with  if all you want is unique values
p57169
aVDemo:
p57170
aVYou can sort this result too, if so desired
p57171
as(dp57172
g16
V100297
p57173
stp57174
a((dp57175
g2
(lp57176
VYou are confusing the  output with the object
p57177
aVResponse objects have a  attribute, test against that:
p57178
aVHowever, to hammer a service repeatedly until it gives you a 200 response is likely to get your IP address blocked
p57179
aVBuild in some kind of exponential back-off to prevent DOS-ing the API
p57180
as(dp57181
g16
V100297
p57182
stp57183
a((dp57184
g2
(lp57185
VYou cannot use an augmented assignment statement on multiple targets, no
p57186
aVQuoting the augmented assignment documentation:
p57187
aVWith the exception of assigning to tuples and multiple targets in a single statement, the assignment done by augmented assignment statements is handled the same way as normal assignments
p57188
aVSimilarly, with the exception of the possible in-place behavior, the binary operation performed by augmented assignment is the same as the normal binary operations
p57189
aVEmphasis mine
p57190
aVIn-place augmented assignment is translated from  to  (with corresponding  hooks for each operator) and translating that operation to multiple targets is not supported
p57191
aVUnder the hood, augmented assignment is a specialisation of the binary operators (, , , etc), not of assignment
p57192
aVBecause the implementation is based on those operators and binary operators only ever have two operands, multiple targets were never included in the original implementation proposal
p57193
aVYou'll have to simply apply the assignments separately:
p57194
aVor, if you really, really wanted to get convoluted, use the  module and  to apply  to the combinations (via , then use tuple assignment:
p57195
aVwhere  will ensure that the right hook is called allowing for in-place subtraction for mutable types that support it
p57196
aVor, if you are manipulating types that don't support in-place manipulation, using a generator expression suffices:
p57197
as(dp57198
g16
V100297
p57199
stp57200
a((dp57201
g2
(lp57202
VImported modules are cached; it doesn't make much of any difference to the performance of your script if you split it up into separate modules
p57203
aVOnly the first import of a module has a minimal loading impact
p57204
aVIt is certainly not worth the price you'd pay in diminished maintainability of one large monolithic script
p57205
aVFocus on the performance bottlenecks instead; the inner loops of your algorithm
p57206
as(dp57207
g16
V100297
p57208
stp57209
a((dp57210
g2
(lp57211
VYou can assign a different file-like object to ; anything that is printed is written to that object
p57212
aVYou can use a  object to replace :
p57213
aVand inspect what was printed by calling
p57214
aVDemo:
p57215
aVNote that I restored  from
p57216
aVYou may want to store the old value of  instead and restore to that to support scenarios where your platform already replaced  before
p57217
as(dp57218
g16
V100297
p57219
stp57220
a((dp57221
g2
(lp57222
VYour class holds a reference to two  instances, not your instances
p57223
aVUse a  method to create new instances for every  instance:
p57224
aVAs it happens, because you rebind each of the string attributes on the instances you create, you happen to create instance attributes for those
p57225
aVYou'd be better off moving those into  as well and making their relationship as instance attributes explicit:
p57226
aVand do the same for your  class
p57227
as(dp57228
g16
V100297
p57229
stp57230
a((dp57231
g2
(lp57232
VSet your attributes after creating the :
p57233
aVMultiple assignment works only when assigning, not in a dict literal notation
p57234
as(dp57235
g16
V100297
p57236
stp57237
a((dp57238
g2
(lp57239
VYou triple-encoded your JSON, but decoded only once
p57240
aVYou need another two  calls before you have a Python object you can index on :
p57241
aVPerhaps you wanted to load the original string to start with
p57242
aVJust once would then be enough:
p57243
as(dp57244
g16
V100297
p57245
stp57246
a((dp57247
g2
(lp57248
VIt indicates a accelerator letter in the menu
p57249
aVYou can jump to that menu option when the menu is open and you hit that letter on your keyboard, or as a shortcut key together with a modifier key (ALT-F to open the File menu entry, etc
p57250
aVdirectly
p57251
aVFrom the documentation:
p57252
aVThe label string for the normal menu items (not separators) may include the accelerator which can be used to activate the menu item from keyboard
p57253
aVAn accelerator key can be specified using the ampersand  character
p57254
aVIn order to embed an ampersand character in the menu item text, the ampersand must be doubled
p57255
aVThe use of an ampersand to mark the accelerator key is not limited to wxPython; it is a convention introduced by Microsoft Windows and you'll find it used in many different GUI frameworks
p57256
aVAccording to Wikipedia:
p57257
aVThis convention originated in the first WIN32 api, and is used in Windows Forms, and is also copied into many other tookits on multiple operating systems
p57258
as(dp57259
g16
V100297
p57260
stp57261
a((dp57262
g2
(lp57263
VYou cannot use argument unpacking on Python 3
p57264
aVThe syntax used to work in Python 2 but was removed from Python 3 (see PEP 3113 for the arguments):
p57265
aVvs
p57266
aVUse one argument for the  structure, and address the components in the
p57267
aVOr better still, use a function and unpack the structure in the function body
p57268
as(dp57269
g16
V100297
p57270
stp57271
a((dp57272
g2
(lp57273
VI know Python pretty well, but I've hardly ever used Ruby
p57274
aVThere are several things wrong here:
p57275
aVPython imports are done for module names; you are trying to import a filename instead
p57276
aVNormally, you'd add the directory to the  directory to the Python module search path (either with the  environment variable or by manipulating the  list from Python code), but you are trying to import the setup script here
p57277
aVYou'd run  to install the library
p57278
aVOr, much better, use  or  to install the package for you
p57279
aVis a command-line utility
p57280
aVIt doesn't appear to provide an API to import
p57281
aVI'd not use a Ruby-to-Python bridge here, just run the tool using the Ruby equivalent of the Python  module; as a separate process
p57282
as(dp57283
g16
V100297
p57284
stp57285
a((dp57286
g2
(lp57287
VYou'll have to use a  file to list data files that you want included in a source distribution
p57288
aVis only consulted for binary distributions (a great shortcoming)
p57289
aVSee The  template in the distutils documentation
p57290
as(dp57291
g16
V100297
p57292
stp57293
a((dp57294
g2
(lp57295
VNo, there isn't
p57296
aVYou are better of either changing all the code calling , or by adding a different method that returns the two parameters and have  use that method:
p57297
aVNote that you can just return a tuple instead of a list too; tuples only require a comma to define so the syntax is lighter (no need for square brackets)
p57298
aVYou can do the same when unpacking the returned value:
p57299
as(dp57300
g16
V100297
p57301
stp57302
a((dp57303
g2
(lp57304
VYou are printing the return value of , which returns
p57305
aVIt returns  because the  method clears the dictionary in place
p57306
aVBy convention, any method on a default Python type that alters the mutable structure in-place, returns
p57307
aVThe same applies to  or to , for example
p57308
aVYour second sample does not print the return value of
p57309
aVIt prints the empty dictionary after you cleared it
p57310
as(dp57311
g16
V100297
p57312
stp57313
a((dp57314
g2
(lp57315
V is a list of entries, each a dictionary:
p57316
aVYou could just grab the first one listed:
p57317
as(dp57318
g16
V100297
p57319
stp57320
a((dp57321
g2
(lp57322
VUse the  module to compare small Python snippets
p57323
aVIt avoids the common pitfalls, making timing values comparable
p57324
aVHowever, you are mostly timing write speed to  when timing  (and in Python 3, encoding to the terminal codec)
p57325
as(dp57326
g16
V100297
p57327
stp57328
a((dp57329
g2
(lp57330
VBy looping over  you are looping over the keys of the dictionary; these are all integers
p57331
aVIf you wanted to store the values, loop over the  sequence (or use  when using Python 3):
p57332
aVIt looks as if the original PHP object was a list (the keys are all sequential); you may want to access the values in sorted order:
p57333
as(dp57334
g16
V100297
p57335
stp57336
a((dp57337
g2
(lp57338
VYou are passing the downloaded data to , which expects to be passed a filename instead
p57339
aVThe code then tries to open a filename named by the gzipped data, and fails
p57340
aVEither save the URL data to a file, then use  on that, or decompress the gzipped data using the  module instead
p57341
aV'Saving' the data can be as easy as using a  in-memory file object:
p57342
as(dp57343
g16
V100297
p57344
stp57345
a((dp57346
g2
(lp57347
VWhen you delete an object, you are merely removing the reference to that object
p57348
aVIf that object's reference count drops to 0, it is removed from memory, taking with it any references that that object holds to other objects
p57349
aVDictionaries, for example, do not contain any objects
p57350
aVAll they contain, are references to other objects
p57351
aVIf you remove all references to a dictionary, it is automatically cleaned up, deleted, and all it's references are gone too
p57352
aVAny keys or values the dictionary referenced will see their reference count drop by 1; and they, in turn, will be cleaned up if that count drops to 0
p57353
aVThere is no need to recursively delete anything, therefor
p57354
aVIf your objects are no longer referenced, they are cleaned up automatically
p57355
aVNote that even when Python releases objects, the process memory usage does not necessarily follow
p57356
aVOperating Systems can and do keep memory assigned to a process to reduce memory churn; a process may need to grow memory usage again and unless there is an urgent need for the memory elsewhere, the allocation is retained for some time
p57357
as(dp57358
g16
V100297
p57359
stp57360
a((dp57361
g2
(lp57362
VYou cannot tell the default class pickler to ignore something, no
p57363
aVdoes support the  module  and  methods
p57364
aVIf your classes implement those two methods, whatever is returned is then used by  to represent the state instead
p57365
aVBoth methods do need to be implemented
p57366
aVIf  is not implemented,  uses the  attribute instead, so your own version merely needs to use that same dictionary, remove the  key and you are done:
p57367
aVWhatever  returns will be processed further, recursively, there is no need to worry about handling subobjects there
p57368
aVIf adding  and  is not an option, you can also register a custom serialization handler for your class; the disadvantage is that while  can get away with just returning a dictionary, a custom handler will need to return a fully flattened value
p57369
as(dp57370
g16
V100297
p57371
stp57372
a((dp57373
g2
(lp57374
VYou want to test if  is boolean true instead:
p57375
aVYou are instead testing if  is True,  which it just so happens to be:
p57376
aVis going to be True if it is an empty string, , numeric 0 or an empty container
p57377
aVYou could also use  but why limit yourself
p57378
aVAnother way of spelling this:
p57379
aVbut by just returning an empty list first you avoid the empty list comprehension altogether
p57380
as(dp57381
g16
V100297
p57382
stp57383
a((dp57384
g2
(lp57385
VBeautifulSoup uses a pluggable HTML parser to build the 'soup'; you need to try out different parsers, as each will treat a broken page differently
p57386
aVI had no problems parsing that page with any of the parsers, however:
p57387
aVMake sure you have the latest  package installed, I have seen consistent problems in the 4
p57388
aV1 series solved in 4
p57389
ag5740
as(dp57390
g16
V100297
p57391
stp57392
a((dp57393
g2
(lp57394
VYou don't need to create a  method at all; SQLAlchemy provides you with one out of the box
p57395
aVEven if you did have to build one, you could just accept arbitrary keyword arguments
p57396
aVThat is just what the SQLAlchemy version does:
p57397
aVTranslated into prose, this method tests if each and every keyword you pass in is an attribute on the class before using  to set the value on the instance
p57398
aVNote that this uses keyword arguments; you could not do this with positional arguments, because your class attributes are stored in a dictionary and thus have no set order
p57399
aVIf you want to use positional arguments, you need to manually create an  method, or define an order on the class for an (inherited)  to make use of:
p57400
aVHere, any positional args are merged into  given a stored field order in a new  attribute on the class
p57401
as(dp57402
g16
V100297
p57403
stp57404
a((dp57405
g2
(lp57406
VUse  and generalize:
p57407
aVOr:
p57408
aVIf a list suffices, then the  can be replaced with a list comprehension () or replaced with  in the second version (Python 3) or just removed altogether (Python 2)
p57409
aVDemo:
p57410
as(dp57411
g16
V100297
p57412
stp57413
a((dp57414
g2
(lp57415
VFor Python 3  or Python 2  values,  only takes a dictionary; codepoints (integers) are looked up in that mapping and anything mapped to  is removed
p57416
aVTo remove (some
p57417
aVpunctuation then, use:
p57418
aVThe  class method makes it trivial to create the mapping, setting all values to  based on the sequence of keys
p57419
aVTo remove all punctuation, not just ASCII punctuation, your table needs to be a little bigger; see J
p57420
ag15782
aVSebastian's answer (Python 3 version):
p57421
as(dp57422
g16
V100297
p57423
stp57424
a((dp57425
g2
(lp57426
VNope, that's exactly how I'd do it
p57427
aVThe alternative would be to use an event to update the modification date of parent folders, but that'd incur a the risk of conflict errors
p57428
as(dp57429
g16
V100297
p57430
stp57431
a((dp57432
g2
(lp57433
VYou can write your exception handler to be compatible with both python versions instead:
p57434
aVDemo:
p57435
aVThere is no need to do Python version detection here, unless you need this to work across Python versions 2
p57436
aV5 through to 2
p57437
aV7 and Python 3
p57438
ag1205
as(dp57439
g16
V100297
p57440
stp57441
a((dp57442
g2
(lp57443
VFirst of all, the empty list is considered false in a boolean, so you don't need to test for inequality against ;  is enough
p57444
aVWhat you really want to do is to produce the inner list once, then both test and calculate the minimum in one go
p57445
aVDo this with an extra inner 'loop':
p57446
aVThe  loop iterates over a one-element tuple that produces the list once, so that you can then test if it is empty () before then calculating the  result to be passed to the outer  call
p57447
aVNote that You do not need a list comprehension for that outer loop; this is a generator expression instead, saving you building up a list object that is then discarded again
p57448
aVDemo:
p57449
as(dp57450
g16
V100297
p57451
stp57452
a((dp57453
g2
(lp57454
VReady-opened file objects:
p57455
aVThen use  and  as already-open file objects
p57456
aVPrints the following when you use the  command-line switch:
p57457
as(dp57458
g16
V100297
p57459
stp57460
a((dp57461
g2
(lp57462
VFor just numbers, you can use  to create all combos, after generating a list with both positive and negative numbers:
p57463
aVDemo:
p57464
as(dp57465
g16
V100297
p57466
stp57467
a((dp57468
g2
(lp57469
VYou need to store your matches in a dictionary instead, keyed by title
p57470
aVYou can then find the same show again if you encounter it in your file more than once:
p57471
aVAfter collecting all your shows, use  to extract all show dictionaries as a list
p57472
as(dp57473
g16
V100297
p57474
stp57475
a((dp57476
g2
(lp57477
VYou are manipulating the same list over and over again, not a copy
p57478
aVCreate a new list in the loop instead:
p57479
aVor create a copy of the list:
p57480
aVwhere  returns a full slice of all the elements
p57481
aVYou could also use  or import the  module and use  to create a copy of the existing list
p57482
aVAppending a list to another list only adds a reference, and your code thus created many references to the same list that you kept changing in the loop
p57483
aVYou could have seen what was happening had you printed tabla on every loop
p57484
aVPrinting  on every loop iteration only shows that the state of that list was correct for that iteration, not that all the references to that list in  were changing along with it:
p57485
aVNotice how all  lists change together; they are in fact all the same list
p57486
aVIf you create a new list instead, things work as expected:
p57487
as(dp57488
g16
V100297
p57489
stp57490
a((dp57491
g2
(lp57492
VThe error occurs when the  list is empty (length 0)
p57493
aVYou may want to test for that:
p57494
aVIf you need to add 6 random choices from the  list it is better to shuffle the  list and then add the first 6 of that list to :
p57495
aVbut chances are of course you end up with an empty list again at some point
p57496
aVAnother approach is to just use :
p57497
aVThis just picks 6 random names from the list, but leaves  unaffected and a future pick of 6 names could repeat names
p57498
as(dp57499
g16
V100297
p57500
stp57501
a((dp57502
g2
(lp57503
VThe  function returns the tag that has been removed
p57504
aVThe tree itself has been properly modified
p57505
aVQuoting from the  documentation:
p57506
aVLike ,  returns the tag that was replaced
p57507
aVIn other words: it works correctly
p57508
aVPrint the new parent of  instead of the return value of  to see that the  tags have indeed been removed:
p57509
aVHere python echoes the  return value, followed by the output of the  statement showing the parent of the  tag is now the  tag
p57510
aVThe first print shows the other  tag still wrapped, the second print shows them both as direct children of the  tag
p57511
as(dp57512
g16
V100297
p57513
stp57514
a((dp57515
g2
(lp57516
VYou are seeing a   hook misbehaving somewhere
p57517
aVThe  is being thrown while shutting down, as the Python interpreter is exiting everything is deleted and any exceptions thrown in a  deconstructor hook are being ignored (but are printed)
p57518
aVOn exit, Python clears everything in the namespace by rebinding everything to , but the order in which this happens is not set
p57519
aVThe still running generator is closed ( is called) when deleted, which triggers a  exception in the generator, which Python tests against your  line
p57520
aVIf, however,  has already been cleared up and Python sees  the  is thrown and you see that message printed
p57521
aVYou can trigger the error without exiting Python by adding:
p57522
aVIf you use  and consume the rest of the generator, or explicitly close the generator with  before Python exits and deletes , the error message goes away
p57523
aVAnother work-around would be to handle  first:
p57524
aVand Python will not evaluate the next  handler
p57525
aVThe error cannot be reproduced with Python 3
p57526
aV2 or earlier, so it looks like hash randomization (introduced in Python 3
p57527
aV3) randomizes the order objects are cleared; this certainly explains why you see the error only on some of your runs, but not on earlier Python runs where the hash order is fixed
p57528
aVNote that the interaction of  hooks and other global objects in Python is documented with a big red warning in the  documentation:
p57529
aVWarning: Due to the precarious circumstances under which  methods are invoked, exceptions that occur during their execution are ignored, and a warning is printed to  instead
p57530
aVAlso, when  is invoked in response to a module being deleted (e
p57531
ag1298
aV, when execution of the program is done), other globals referenced by the  method may already have been deleted or in the process of being torn down (e
p57532
ag1298
aVthe import machinery shutting down)
p57533
aVFor this reason,  methods should do the absolute minimum needed to maintain external invariants
p57534
aVStarting with version 1
p57535
aV5, Python guarantees that globals whose name begins with a single underscore are deleted from their module before other globals are deleted; if no other references to such globals exist, this may help in assuring that imported modules are still available at the time when the  method is called
p57536
as(dp57537
g16
V100297
p57538
stp57539
a((dp57540
g2
(lp57541
VYou are creating one instance, then copying the reference to that instance  times:
p57542
aVThis does not create a list of  instances of ; it creates a list of  references, all pointing to one object
p57543
aVUse a list comprehension instead:
p57544
aVIn a list comprehension, the expression on the left is re-executed for each iteration of the loop
p57545
as(dp57546
g16
V100297
p57547
stp57548
a((dp57549
g2
(lp57550
VYou need to mark your first  quantifier as non-greedy by appending :
p57551
aVDemo:
p57552
aVBy making the quantifier non-greedy, the regular expression engine will match the minimum to satisfy the pattern, rather than the maximum
p57553
as(dp57554
g16
V100297
p57555
stp57556
a((dp57557
g2
(lp57558
VA file is a sequence of bytes
p57559
aVIf you want to change something in the middle that requires more or fewer bytes to express, the rest of the file needs to resize
p57560
aVBecause a file is a physical sequence of bytes on a storage medium, that means you need to rewrite the entire rest of the file
p57561
aVIn other words, you need to move over everything following
p57562
aVIn practice, that means rewriting the file, as that is much easier to achieve
p57563
as(dp57564
g16
V100297
p57565
stp57566
a((dp57567
g2
(lp57568
VSplit on  and map to :
p57569
aVThis produces a list; if you need a tuple, just wrap it in a  call:
p57570
aVIn Python 3,  returns a generator, so you would use a list comprehension to produce the list:
p57571
aVDemo:
p57572
as(dp57573
g16
V100297
p57574
stp57575
a((dp57576
g2
(lp57577
VIf you are to use regular expressions, your approach is incorrect
p57578
aVJust parse the whole sentence
p57579
aVA look-ahead assertion will give you the word before  or :
p57580
aVDemo:
p57581
aVThis also works on a whole body of text:
p57582
as(dp57583
g16
V100297
p57584
stp57585
a((dp57586
g2
(lp57587
VThere is no need to split words, at all; directly passing a string to the counter updates the counts per character
p57588
aVYou also need to collect all counts first, and only then write them out to the output file:
p57589
aVNote that the inputfile is processed in 8kb chunks rather than in one go; you can adjust the block size (preferably in powers of 2) to maximize throughput
p57590
aVYou could use  instead of  here if you want your output file to be sorted by frequency (descending)
p57591
as(dp57592
g16
V100297
p57593
stp57594
a((dp57595
g2
(lp57596
VYou are using an early release of the  library
p57597
aVThe API for the  attribute changed; since at least 1
p57598
aV0 of the library it is now a function
p57599
aVThe  requires  1
p57600
aV0 or newer; upgrade the library
p57601
as(dp57602
g16
V100297
p57603
stp57604
a((dp57605
g2
(lp57606
VThe  function is not nearly sophisticated for this kind of task
p57607
aVYou'd be better of with a library that can control the Unix terminal, such as the  library
p57608
aVThe library essentially lets you build a simple terminal GUI
p57609
aVIf you need more, take a look at Urwid as well
p57610
aVUrwid offers more complex GUI widgets for the discerning terminal GUI developer
p57611
aVYou can't use the  module on Windows unfortunately; apparently there are DOS and OS/2 ports but it is primarily a POSIX-only library
p57612
aVOn Windows you'll have to use a port such as , or you could try the  module (the latter drives the Windows CMD console in a similar manner)
p57613
as(dp57614
g16
V100297
p57615
stp57616
a((dp57617
g2
(lp57618
VYou need to pass in a  object for :
p57619
aVbut if you wanted to see the SQL statements that SQLAlchemy issues you are better off switching on echoing by setting  when creating the connection
p57620
aVThe Flask SQLAlchemy integration layer supports a  option to set that flag
p57621
as(dp57622
g16
V100297
p57623
stp57624
a((dp57625
g2
(lp57626
VRegular expressions do not support 'recursive' parsing
p57627
aVProcess the group between the  and  characters after capturing it with a regular expression
p57628
aVThe  module would do nicely here to parse your quoted strings:
p57629
aVoutput:
p57630
as(dp57631
g16
V100297
p57632
stp57633
a((dp57634
g2
(lp57635
VCapturing groups do not multiply when matching multiple patterns
p57636
aVThey only capture once, the last pattern to match in this case
p57637
aVCapture all hexadecimal numbers, then split the result:
p57638
aVoutputs
p57639
aVThe alternative would be to define 6 groups, one for the leading  pattern, and 1 each for the 5 hexadecimal patterns, but that would lock your pattern to 5 hexadecimal values instead of a variable number
p57640
as(dp57641
g16
V100297
p57642
stp57643
a((dp57644
g2
(lp57645
VIf you want to modify the dicts in place, use a loop:
p57646
aVIf you need a copy of all dictionaries, a list comprehension with nested dict comprehension works but may not be the most efficient:
p57647
aVDemo of the latter:
p57648
aVA function that creates a copy of the dictionary and adjusts the score:
p57649
aVthen
p57650
aVmay be faster for larger dictionaries
p57651
as(dp57652
g16
V100297
p57653
stp57654
a((dp57655
g2
(lp57656
VYou would have to create a new function object from the old one:
p57657
aVHere,  is a dictionary that is to be used as the global namespace for the newly created function object
p57658
aVAll other arguments echo the original function's
p57659
aVcould be based on a copy of , of course
p57660
aVDemo:
p57661
as(dp57662
g16
V100297
p57663
stp57664
a((dp57665
g2
(lp57666
VA list comp will do:
p57667
aVThis outputs a list of strings, so with quotes:
p57668
aVWe can format that a little more:
p57669
aVDemo:
p57670
aVAlternative methods of formatting the string to avoid the excessive  and  curl brace escaping:
p57671
aVusing old-style  formatting:
p57672
aVusing a  object:
p57673
aVFurther demos:
p57674
as(dp57675
g16
V100297
p57676
stp57677
a((dp57678
g2
(lp57679
VYour function doesn't return anything
p57680
aVPrinting is not the same thing as returning a value
p57681
aVThe default return value for a function is , which causes your error
p57682
aVYou want to return something, most likely :
p57683
aVthen loop over the results:
p57684
aVor collect them all in a list with a list comprehension:
p57685
aVgiving you a list
p57686
as(dp57687
g16
V100297
p57688
stp57689
a((dp57690
g2
(lp57691
VYou've encountered an issue with  objects not reflecting their size correctly
p57692
aVUp until Python 2
p57693
ag4892
aV3 the object's  method did not reflect the size accurately
p57694
aVOn Python 2
p57695
ag4892
aV4 and newer, as well as any other new Python 3 release made after August 2012, a bug fix was included that added the size
p57696
aVOn Python 2
p57697
ag4892
aV5 I see:
p57698
aVwhich conforms with the 56 bytes of size my 64-bit system requires for the base object, plus 4 bytes per signed integer contained
p57699
aVOn Python 2
p57700
ag4892
aV3, I see:
p57701
aVPython  objects on my system use 8 bytes per reference, so their size is naturally almost twice as big
p57702
as(dp57703
g16
V100297
p57704
stp57705
a((dp57706
g2
(lp57707
VSearch for:
p57708
aVinstead and find anything that is not the end character
p57709
aVDemo:
p57710
aVYour regular expression uses a capturing group around each set of letters or whitespace, and only the last such match inside the  angle brackets is returned, as a capturing group is not multiplied even if it matches multiple patterns
p57711
aVis 3 matches;  and only the last such match is returned for the capturing group
p57712
aVYou can make your version work by using:
p57713
aVinstead, or include the whitespace in the character class and remove the outer wildcard:
p57714
as(dp57715
g16
V100297
p57716
stp57717
a((dp57718
g2
(lp57719
V returns a list of method names, all strings
p57720
aVTest with the actual string:
p57721
aVThis will still return  as  only lists a summary of the most important methods
p57722
aVYou'd have to additionally list everything on the metaclass of  as well, which in this case is :
p57723
aVQuoting from the documentation of :
p57724
aVNote: Because  is supplied primarily as a convenience for use at an interactive prompt, it tries to supply an interesting
p57725
aVset of names more than it tries to supply a rigorously or consistently
p57726
aVdefined set of names, and its detailed behavior may change across
p57727
aVreleases
p57728
aVFor example,  attributes are not in the result
p57729
aVlist when the argument is a class
p57730
aVEmphasis mine
p57731
aVis the fallback implementation here;  defines a reasonable default (falling back to an identity test,  implemented as ) and as long as your custom class doesn't implement a custom version, that is not interesting and listing it would only needlessly clutter the result of
p57732
as(dp57733
g16
V100297
p57734
stp57735
a((dp57736
g2
(lp57737
VPython modules are singletons within one run of the interpreter
p57738
aVRunning  in a separate process will not alter the value of  in another Python interpreter
p57739
as(dp57740
g16
V100297
p57741
stp57742
a((dp57743
g2
(lp57744
VNo element  was found:
p57745
aVso the list is empty
p57746
aVTesting your code, I get the message:
p57747
aVwhich contains no such tags
p57748
aVThe error message seems to indicate that the specific bot id you are using does not or no longer exist
p57749
aVPerhaps you need to sign up for a new bot of your own on the Pandorabots homepage
p57750
aVI note that you are doing Some nasty unescaping
p57751
aVWhy not grab the text nodes under that tag instead and let the DOM library take care of that for you
p57752
aVYou may want to look into the ElementTree API (included with Python) instead as it is easier to use
p57753
as(dp57754
g16
V100297
p57755
stp57756
a((dp57757
g2
(lp57758
VYou are not making a streaming request, so the raw socket has already been read from
p57759
aVJust use  instead:
p57760
aVThe raw socket can only be read from still if you used  when creating the request:
p57761
aVbut since you are reading the whole response into memory anyway there is not much point in doing so here
p57762
as(dp57763
g16
V100297
p57764
stp57765
a((dp57766
g2
(lp57767
VYou'll have to use the Node API to remove and add nodes:
p57768
aVDemo:
p57769
as(dp57770
g16
V100297
p57771
stp57772
a((dp57773
g2
(lp57774
V returns a sequence of tuples when more than one capturing group is given in the pattern
p57775
aVYour pattern has two such groups
p57776
aVThus, each  consists of  pairs:
p57777
aVNote that since you are matching whitespace and digits only, the  flag is entirely redundant
p57778
aVYou assign the last such  to , then loop back up and prepend that to , and that doesn't work:
p57779
aVPerhaps you wanted to rejoin the values into a valid piece of text again:
p57780
as(dp57781
g16
V100297
p57782
stp57783
a((dp57784
g2
(lp57785
VUse the  function to split out the URL into constituent parts:
p57786
aVYou can then split the  value further if desired:
p57787
aVor, (better), use the  library to extract the public suffix of a given domain name:
p57788
as(dp57789
g16
V100297
p57790
stp57791
a((dp57792
g2
(lp57793
VYes, just assign to the attribute on the module:
p57794
aVNote that any other code that already imported  as a global is not going to be updated
p57795
as(dp57796
g16
V100297
p57797
stp57798
a((dp57799
g2
(lp57800
VDrop the  curly braces, they are not used with :
p57801
aVOnly use  quantifiers with fixed numbers:
p57802
aVmatches exactly 3 letters, for example
p57803
as(dp57804
g16
V100297
p57805
stp57806
a((dp57807
g2
(lp57808
VUse the  function to escape regular expression meta characters for you
p57809
aVWhat you are seeing is otherwise perfectly normal Python behaviour; you are looking at a python literal representation; the output can be pasted back into a Python interpreter and recreate the value
p57810
aVAs such, anything that could be interpreted as an escape code is escaped for you; a single  would normally be doubled to prevent it being interpreted as the start of an escape sequence:
p57811
aVYou can see this at work in other places in your  string; the  character combination represents a newline character, not two separate characters  and
p57812
aVIf you wanted to include a literal  and  in the text, you'd have to double the backslash to
p57813
aVFurther on into the value of  you'll find , which is a single backslash followed by a  quote
p57814
as(dp57815
g16
V100297
p57816
stp57817
a((dp57818
g2
(lp57819
VDo not use a  for this
p57820
aVThe  hook is not even guaranteed to be called:
p57821
aVIt is not guaranteed that  methods are called for objects that still exist when the interpreter exits
p57822
aVInstead, manage the cache with a Context Manager and only mark the cache as reusable when the  method is called with the  set to
p57823
as(dp57824
g16
V100297
p57825
stp57826
a((dp57827
g2
(lp57828
VYou are looking for the maximum; the  function does that for you, and you can supply it with a function to determine what value the maximum is determined by:
p57829
aVHere,  provides that function; it takes the specified element from any object you pass to it
p57830
aVDemo:
p57831
as(dp57832
g16
V100297
p57833
stp57834
a((dp57835
g2
(lp57836
VYou use attribute access:
p57837
aVIf  is a method, make sure to call it:
p57838
as(dp57839
g16
V100297
p57840
stp57841
a((dp57842
g2
(lp57843
VYou need to close the  file before you open it with Excel:
p57844
aVBy using a  statement the open file object is automatically closed when the block indented under the statement completes
p57845
aVWindows doesn't like it when more than one application has a file open
p57846
as(dp57847
g16
V100297
p57848
stp57849
a((dp57850
g2
(lp57851
VPrint just the :
p57852
aVYou may want to remove the leading and trailing whitespace:
p57853
as(dp57854
g16
V100297
p57855
stp57856
a((dp57857
g2
(lp57858
VYou grabbed the first table, but there is more than one table on that page
p57859
aVIn fact, there are 46 tables
p57860
aVYou want to find the tables with the  class:
p57861
aVNote that searching for a specific class is done with the  keyword argument
p57862
as(dp57863
g16
V100297
p57864
stp57865
a((dp57866
g2
(lp57867
VPython modules are cleaned up when exiting, and any  methods probably are called:
p57868
aVIt is not guaranteed that  methods are called for objects that still exist when the interpreter exits
p57869
aVNames starting with an underscore are cleared first:
p57870
aVStarting with version 1
p57871
aV5, Python guarantees that globals whose name begins with a single underscore are deleted from their module before other globals are deleted; if no other references to such globals exist, this may help in assuring that imported modules are still available at the time when the  method is called
p57872
aVWeak reference callbacks rely on the same mechanisms as  methods do; the C deallocation functions ()
p57873
aVThe  instance will retain a reference to the  class method, but the global name  could be cleared already (it is assigned  in CPython); your method should be safe as it never refers to  once the callback has been registered
p57874
as(dp57875
g16
V100297
p57876
stp57877
a((dp57878
g2
(lp57879
V is not the same thing as ; it removes one pair from the dictionary as a tuple, and you are looping over that pair
p57880
aVThe most efficient method is to use a  loop instead; no need to call , just test against the dictionary itself, an empty dictionary is considered false:
p57881
aVThe alternative is to use :
p57882
aVbut that requires the whole dictionary to be copied into a list first
p57883
aVHowever, if you were looking for a FIFO queue, use  instead:
p57884
aVor use
p57885
as(dp57886
g16
V100297
p57887
stp57888
a((dp57889
g2
(lp57890
VThe exception is thrown when the result set is loaded and SQLAlchemy wants to populate the result objects
p57891
aVOne column is qualified as a  type, but the Oracle result set is giving you an integer instead
p57892
aVThe  library will normally convert Oracle-supplied native DATE column value into Python  object
p57893
aVHowever, this is not happening for all your rows here
p57894
aVYou'll need to narrow down what row or rows have a column that is not being translated to a  object
p57895
aVFind a pattern in the filters that include or exclude these rows and narrow it down so you can inspect the database rows by hand in a different client
p57896
as(dp57897
g16
V100297
p57898
stp57899
a((dp57900
g2
(lp57901
VYou have another  module or package in your path somewhere, and it is getting imported instead
p57902
aVTo diagnose where that other module is living, add:
p57903
aVbefore the  line; it'll print the filename of the module
p57904
aVYou'll have to rename one or the other module to not conflict
p57905
as(dp57906
g16
V100297
p57907
stp57908
a((dp57909
g2
(lp57910
VFirst of all,  is not the method to use to determine printed size
p57911
aVA python object memory footprint is a poor indicator for the number of characters required to represent a python object as a string
p57912
aVYou are looking for  instead
p57913
aVUse a simple generator expression plus  to get a total:
p57914
aVThe comma between expressions tells  to print a space, so the total length  will write to  is the sum length of all string representations, plus the whitespace between the elements
p57915
aVI am assuming you do not want to include the newline  writes as well
p57916
aVDemo:
p57917
as(dp57918
g16
V100297
p57919
stp57920
a((dp57921
g2
(lp57922
VYou need to refer to the attributes of your class, as ,  and  are not local variables
p57923
aVAdd  in front of them:
p57924
as(dp57925
g16
V100297
p57926
stp57927
a((dp57928
g2
(lp57929
V and  only work on local filenames
p57930
aVI'd use the  function instead and load full  objects, and inspect their  attribute with the  module utility functions:
p57931
as(dp57932
g16
V100297
p57933
stp57934
a((dp57935
g2
(lp57936
VYou need to keep track of what fossils you have already seen, per formation
p57937
aVA  object makes coding that easiest; it keeps a  per formation we can test against:
p57938
aVThe above code 'streams' your CSV rows in one generator expression straight into the  object; no intermediate data is kept
p57939
aVEach row is tested to:
p57940
aVsee that the formation column is not empty
p57941
aVsee that the formation was not yet recorded for the given fossil
p57942
aVrecord the formation for the given fossil
p57943
aVI've assumed that the fossil name is in column 0; you didn't specify how to extract the fossil name in your question
p57944
as(dp57945
g16
V100297
p57946
stp57947
a((dp57948
g2
(lp57949
VThe  library will lock the database per process when writing to the database and each process will wait for the lock to be released to get their turn
p57950
aVThe database doesn't need to be written to until commit time however
p57951
aVYou are using the connection as a context manager (good
p57952
aVso the commit takes place after your loop has completed and all  statements have been executed
p57953
aVIf your database has uniqueness constraints in place, it may be that the commit fails because one process has already added rows that another process conflicts with
p57954
as(dp57955
g16
V100297
p57956
stp57957
a((dp57958
g2
(lp57959
VThe  database adapter is giving you  objects
p57960
aVUse methods on those objects to format them to a string if you require a different output
p57961
aVThe  method would be best suited for your purposes:
p57962
aVDemo:
p57963
aVIf, however, Oracle is really returning objects with the year set to  (not ) you need to repair the data:
p57964
as(dp57965
g16
V100297
p57966
stp57967
a((dp57968
g2
(lp57969
VThere are double-quoted characters in your input string; dashes replaced by  escape strings
p57970
aVThat works okay in JavaScript, but not in JSON values
p57971
aVYou'll have to repair these first:
p57972
aVWhomever generated your HTML comments wanted to prevent  characters from being interpreted as the end-of-comment  character sequence, so they escaped the dashes using Javascript unicode escape sequences
p57973
as(dp57974
g16
V100297
p57975
stp57976
a((dp57977
g2
(lp57978
VYou don't have a memory leak
p57979
aVYou are simply returning a callable object; when you no longer reference it it'll be cleaned up automatically
p57980
aVThe  method doesn't add any more references to the object other than the local variable name
p57981
aVThat reference is cleared when the function exits
p57982
aVThe  and  expressions only hold a reference to the object for long enough to look up the  method and invoke it
p57983
aVWhen the  method returns, the number of references to the  instance drops to 0 and the object is cleared
p57984
as(dp57985
g16
V100297
p57986
stp57987
a((dp57988
g2
(lp57989
VAs far as  is concerned, there is no difference between a zip file and any other binary blob of data
p57990
aVYour server is broken here; it is cutting of the connection when you send it a zip file
p57991
aVThat is not something  can do anything about
p57992
aVYou may want to test against  when you run into problems like these; it is a testing service built by the author of the  library
p57993
aVAnother tip: you don't need to read the whole file object into memory when sending
p57994
aVJust pass the object itself to  instead:
p57995
aVDemo against :
p57996
as(dp57997
g16
V100297
p57998
stp57999
a((dp58000
g2
(lp58001
VNo you cannot, because  tests for identity, not equality
p58002
aVThe  reference has to point to the same object as
p58003
aVis a singleton object, and  is a keyword in Python 3, so you cannot make  refer to another object either
p58004
as(dp58005
g16
V100297
p58006
stp58007
a((dp58008
g2
(lp58009
VNo you cannot
p58010
aVThe  call needs to know what class the method is part of, to search the base classes for an overridden method
p58011
aVIf you pass in  (or better still, ) then  is given the wrong starting point to search for methods, and will end up calling it's own method again
p58012
aVSee it as a pointer in the list of classes that form the Method Resolution Order sequence
p58013
aVIf you pass in  then the pointer will refer to any subclasses instead of the original starting point
p58014
aVThe following code leads to an infinite recursion error:
p58015
aVDemo:
p58016
aVbecause  is , not , in
p58017
aVIn the example, the MRO for  is , and  needs to know where to start searching for any overridden methods
p58018
aVBy using  you tell it to start at , so it'll find  next, which is where we started
p58019
as(dp58020
g16
V100297
p58021
stp58022
a((dp58023
g2
(lp58024
V is a dictionary view object; such objects are iterators
p58025
aVYou can return your own implementation of such an object from a  method
p58026
aVThe specific type returned by  is not available for re-use, you'll have to implement your own from scratch
p58027
aVI covered creating your own in a previous answer; there are a fair number of methods to cover
p58028
as(dp58029
g16
V100297
p58030
stp58031
a((dp58032
g2
(lp58033
V does need to be passed an instance
p58034
aVThe  method calls:
p58035
aVwhere  is
p58036
aVAll that  provides is
p58037
aVand
p58038
aVYou'll need to pass in a dummy object that provides  instead of passing in the interface directly
p58039
as(dp58040
g16
V100297
p58041
stp58042
a((dp58043
g2
(lp58044
VYou have a file that either contains too many newlines (in the JSON values themselves) or too few (no newlines between the tweets at all)
p58045
aVYou can still repair this by using some creative re-stitching
p58046
aVThe following generator function should do it:
p58047
aVThis should be able to read all your JSON objects in sequence:
p58048
aVIt is otherwise fine to have multiple JSON strings written to one file, but you need to make sure that the entries are clearly separated somehow
p58049
aVWriting JSON entries that do not use newlines, then using newlines in between them, for example, makes sure you can later on read them one by one again and process them sequentially without this much hassle
p58050
as(dp58051
g16
V100297
p58052
stp58053
a((dp58054
g2
(lp58055
VYou need to use absolute filenames when renaming:
p58056
aVYou also do not appear to be looping over the  list; add another  loop:
p58057
aVYou may want to avoid using  as a name, it shadows the built-in type
p58058
aVPerhaps  is a better choice
p58059
as(dp58060
g16
V100297
p58061
stp58062
a((dp58063
g2
(lp58064
VYou are looking for the  function here:
p58065
aVDemo:
p58066
as(dp58067
g16
V100297
p58068
stp58069
a((dp58070
g2
(lp58071
VYou are passing in a generator expression
p58072
aVA list comprehension is specified with square brackets ()
p58073
aVA list comprehension builds a list object first, so it uses syntax closely related to the list literal syntax:
p58074
aVA generator expression, on the other hand, creates an iterator object
p58075
aVOnly when iterating over that object is the contained loop executed and are items produced
p58076
aVThe generator expression does not retain those items; there is no list object being built
p58077
aVA generator expression always uses  round parethesis, but when used as the only argument to a call, the parenthesis can be omitted; the following two expressions are equivalent:
p58078
aVQuoting from the generator expression documentation:
p58079
aVThe parentheses can be omitted on calls with only one argument
p58080
aVSee section Calls for the detail
p58081
as(dp58082
g16
V100297
p58083
stp58084
a((dp58085
g2
(lp58086
VYou are creating one list, then append that same list to   times
p58087
aVAppend copies instead:
p58088
aVOr better still, generate the whole grid with a generator expression:
p58089
as(dp58090
g16
V100297
p58091
stp58092
a((dp58093
g2
(lp58094
VYou forgot two commas:
p58095
aVNow Python sees an attempt to index the list on the left-hand side with a  tuple:
p58096
aVThe second  'list' would give you the same problem but doesn't yet come into play
p58097
aVFix it by adding commas between:
p58098
aVor, as a complete list:
p58099
as(dp58100
g16
V100297
p58101
stp58102
a((dp58103
g2
(lp58104
VA closure binds to a free variable, not it's value
p58105
aVFor a self-referencing closure, all Python needs to do is create a closure for the free  name first (not yet bound to anything), create the function object with the closure, and then bind  to that object
p58106
aVAs such, you need to combine creating a closure and a function into the same outer function, such that you create a closure to the name the function is going to be bound to:
p58107
aVTo make this work with unpickling you'd have to loop over the closure argument () and detect where there is a recursion, and replace that one item with , I suppose
p58108
as(dp58109
g16
V100297
p58110
stp58111
a((dp58112
g2
(lp58113
V is a list, so that object requires you to use integer indices
p58114
aVEach item in that list is itself a dictionary again
p58115
aVIn this case there is only one such item
p58116
aVTo get all  dictionaries out of that structure you'd need to do a little more processing:
p58117
aVwould give you a list of of matching values for  in the first context
p58118
aVDemo:
p58119
as(dp58120
g16
V100297
p58121
stp58122
a((dp58123
g2
(lp58124
VYou are both looping over the file and seeking in it, multiple times, but never reset the position before reading again
p58125
aVIn the first iteration, you read the first line, then you seek elsewhere into the file, write to that position, then  out of the  loop
p58126
aVThe next iteration of the  loop then starts reading from  again, but the file is now positioned at the point where the last  left off
p58127
aVThat means you are now reading whatever followed the data you just have written
p58128
aVThis is probably not what you wanted to do
p58129
aVIf you wanted to read the line from the same position, and write it back to the same location, you need to seek first and use  instead of iteration to read your line
p58130
aVThen seek again before writing:
p58131
aVoutfile = open(OversightFile, 'r+')
p58132
aVNote however, that if you write out data that is shorter or longer than the original line, the file size will not adjust
p58133
aVWriting a longer line will overwrite the first characters of the next line, a shorter write will leave the trailing characters of the old line in the file
p58134
as(dp58135
g16
V100297
p58136
stp58137
a((dp58138
g2
(lp58139
VYour  line results in the string , which is then passed to the  method
p58140
aVThis value has no letters, so the line:
p58141
aVreturns an empty list
p58142
aVThe next line:
p58143
aVthen fails because  gives a  exception
p58144
aVYour code is hard to read because you use one-letter variables and put multiple statements on one line, so it is hard to make out what your expectations are in that function
p58145
aVThe exception has otherwise nothing to do with
p58146
aVThere is a simple bug in your own code somewhere
p58147
as(dp58148
g16
V100297
p58149
stp58150
a((dp58151
g2
(lp58152
VMatch anything that is not a  character; you also cannot use a variable-width look-behind so your version doesn't work at all
p58153
aVUse a non-capturing pattern instead
p58154
aVDemo:
p58155
aVThe better solution is to use a HTML parser instead
p58156
aVI can recommend BeautifulSoup:
p58157
as(dp58158
g16
V100297
p58159
stp58160
a((dp58161
g2
(lp58162
VDecode from :
p58163
as(dp58164
g16
V100297
p58165
stp58166
a((dp58167
g2
(lp58168
VYou can still call each function in the list
p58169
aVIf you make all entries lists then it becomes much easier to handle both cases:
p58170
aVIf all you are doing is finding the one action that matches , you'd be better off using a dictionary and look up the  and  items from that *directly:
p58171
as(dp58172
g16
V100297
p58173
stp58174
a((dp58175
g2
(lp58176
VThere is no  function
p58177
aVIf you check out the  documentation you can see that it has  and  functions
p58178
aVUse  to test against a path name; the module opens that file for you and and determines the type
p58179
aVUse  to test a byte sequence ( in Python 2,  in Python 3)
p58180
aVThere is also a  class that you can instantiate (per thread
p58181
aVto alter how it operates:
p58182
aVdocumented as:
p58183
aVCreate a new  wrapper
p58184
aV- if , mimetypes are returned instead of textual descriptions
p58185
aV- if , codec is returned
p58186
aV- use a mime database other than the system default
p58187
aVand according to the , that is all as far as public API is concerned
p58188
aVThe  class handles  internally; setting  when creating a  instance will set a  flag for example
p58189
aVIt looks as if the code you encountered covers a different Python  library altogether that required more internals hand-holding
p58190
aVMy advice: Don't try to replicate that
p58191
aVUse this new library and it's documented API only
p58192
as(dp58193
g16
V100297
p58194
stp58195
a((dp58196
g2
(lp58197
VYou need to use a tuple; cast your list into a tuple and that works just fine:
p58198
aVDefine  to be a tuple to start with:
p58199
aVYou can combine that into a function:
p58200
aVor better still, make  a catch-all argument, which always resolves to a tuple:
p58201
aVThe latter is what the  function (and related functions) already does
p58202
as(dp58203
g16
V100297
p58204
stp58205
a((dp58206
g2
(lp58207
VYou want to split your lines using , and you'll need to write to another file first, then move that back into place; reading and writing to the same file is tricky and should be avoided unless you are working with fixed record sizes
p58208
aVHowever, the  module makes in-place file editing easy enough:
p58209
aVThe  statement writes to , which  conveniently redirects when  is set
p58210
aVThis means you are writing to the output file (that replaces the original input file), writing a bonus newline on every loop too
p58211
as(dp58212
g16
V100297
p58213
stp58214
a((dp58215
g2
(lp58216
VInstead of removing the  decorator lines, provide your own pass-through no-op version
p58217
aVYou can add the following code to your project somewhere:
p58218
aVImport this before any code using the  decorator and you can use the code with or without the line profiler being active
p58219
aVBecause the dummy decorator is a pass-through function, execution performance is not impacted (only import performance is every so lightly affected)
p58220
aVIf you don't like messing with built-ins, you can make this a separate module; say :
p58221
aV(no assignment to ) and use  in any module that uses the  decorator
p58222
as(dp58223
g16
V100297
p58224
stp58225
a((dp58226
g2
(lp58227
VCollect the values into a dictionary of lists; a  object is easiest:
p58228
aVOutputs:
p58229
aVetc
p58230
aVWriting lowest and highest values:
p58231
as(dp58232
g16
V100297
p58233
stp58234
a((dp58235
g2
(lp58236
VUse a list comprehension:
p58237
aVNow you have a list of dictionaries that have those two keys
p58238
aVDemo:
p58239
aVIf you only wanted the first such a dictionary, use  and a generator expression:
p58240
aVHere  will be set to either the first dictionary with the two keys, or  if there is no such dictionary
p58241
aVIf such syntax is a little daunting, here is a version with a  loop instead:
p58242
as(dp58243
g16
V100297
p58244
stp58245
a((dp58246
g2
(lp58247
VYour console or terminal font doesn't support that codepoint; it is printing just fine otherwise
p58248
aVHowever, your terminal is not configured to print UTF-8, so printing the UTF-8 bytes results in garbage instead
p58249
aVYou need to change the font used for your terminal or console program instead, to show that specific codepoint
p58250
aVHowever, if the codepoint you are printing in U+F0FC then no font will print that other than as a placeholder glyph
p58251
aVThat is private-use codepoint and no common-use font will be able to display it
p58252
aVIn this case, you'll have to replace that codepoint with something else to represent whatever that codepoint stood for in the original data
p58253
aVIn chat you mentioned it was a Powerpoint checkmark
p58254
aVYour output is limited to the Windows 1252 codepage so you need to pick a character within that standard, take the unicode codepoint for that character and replace the U+F0FC codepoints with that value
p58255
aVIf you were to use  character (hex 95 in the 1252 codepage, unicode point U+2022) for example, then you replace the private codepoint with:
p58256
as(dp58257
g16
V100297
p58258
stp58259
a((dp58260
g2
(lp58261
VUse a  object and split your words on whitespace
p58262
aVYou probably want to lowercase your words as well, and remove punctuation:
p58263
aVor perhaps use a regular expression that only matches word characters:
p58264
aVNow you have a  dictionary with per-word counts
p58265
aVDemo:
p58266
as(dp58267
g16
V100297
p58268
stp58269
a((dp58270
g2
(lp58271
VSQLite handles this case just fine:
p58272
aVIn other words: There is no problem here
p58273
aVSQLite 3 operates with type affinity rather than fixed types, but because you declared the columns as  even if you were to insert integer data it would still be converted to text and stored as such
p58274
as(dp58275
g16
V100297
p58276
stp58277
a((dp58278
g2
(lp58279
V returns a iterable, not a sequence
p58280
aVYou cannot index or slice an iterable
p58281
aVUse  to define a subset; when looping over the  result, the underlying iterable will be advanced to the starting index, then will yield items until the end index:
p58282
aVThis iterates over the chained sequence, so you cannot then access the items before the  index
p58283
as(dp58284
g16
V100297
p58285
stp58286
a((dp58287
g2
(lp58288
VUse  judiciously:
p58289
aVOutputs:
p58290
aVYou should really look into  and save yourself having to sort like that
p58291
aVThe  method lists items in reverse sorted order by frequency for you
p58292
as(dp58293
g16
V100297
p58294
stp58295
a((dp58296
g2
(lp58297
VYou can use the format mini language to specify alignments:
p58298
aVThe  formatting specification sets the field width to 20 characters and right-aligns the value in that field
p58299
aVThis does not support alignment by decimal point, however
p58300
aVYou can specify dynamic field widths though:
p58301
aVwhich you can adapt to add or remove whitespace around a floating point number:
p58302
aVHere the field width is adjusted to shift the decimal point left or right based on how much space the whole value is going to take
p58303
aVNote that the field width is the total width, so including the decimal point and the 6 decimals
p58304
as(dp58305
g16
V100297
p58306
stp58307
a((dp58308
g2
(lp58309
VPython 2 will automatically encode Unicode values, or decode string values when mixing string and unicode operations
p58310
aVThis is where your confusion stems from
p58311
aVWhen writing a Unicode value to a file, for example, Python 2 will try to encode that value to a string
p58312
aVBecause no encoding has been specified, the default encoding is used instead, which on Python 2 is ASCII
p58313
aVThe same goes for using a  value in a unicode context, Python 2 will decode it using the ASCII codec
p58314
aVYour sample values, however, contain a codepoint or byte that is not representable as an ASCII character, so the automatic conversions fail
p58315
aVThe  or  exceptions you see are the result of the automatic conversions
p58316
aVSpecifically,  tries to decode  to Unicode to interpolate it into the unicode  template string
p58317
aVTo avoid automatic conversions, you thus need to use explicit conversions instead
p58318
aVAnd to use explicit conversions, you need to know the right encoding used for your byte string, or what codec you are targeting when encoding unicode
p58319
aVYour computer is a Windows machine configured to use a Latin-1-like codepage, either the 1250 or 1252 codepage
p58320
aVThat is why printing the  byte prints a  when you write that byte to the terminal directly
p58321
aVPython knows your computer is configured with that codepage, if you print  you'll see  or  or similar printed
p58322
aVThat is why Python knows how to print a Unicode value and you'll see the  character when printing the  codepoint
p58323
aVYour  value is not encoded in UTF-8 however
p58324
aVTrying to decode that value from UTF8 will thus fail
p58325
aVYou need to decode from  instead:
p58326
aVIf you use , then no exception will be thrown as  can be decoded to Unicode correctly
p58327
as(dp58328
g16
V100297
p58329
stp58330
a((dp58331
g2
(lp58332
VNow that you have your dictionary, loop over the items and write to a file:
p58333
aVYou may want to use a  object instead of a regular dictionary for :
p58334
aVand remove the  lines altogether
p58335
as(dp58336
g16
V100297
p58337
stp58338
a((dp58339
g2
(lp58340
VUse  for the shorter input and do not use :
p58341
aVNow ,  and  will be cycled through to match up with the rest of the characters in :
p58342
as(dp58343
g16
V100297
p58344
stp58345
a((dp58346
g2
(lp58347
VYou need to install the Python development headers too
p58348
aVOn Debian (Raspbian \u201cwheezy\u201d), install the  package:
p58349
aVor run:
p58350
aVand get a few more packages that come in handy when compiling Python C extensions
p58351
aVOn Fedora (Pidora) the equivalent of that last command is:
p58352
as(dp58353
g16
V100297
p58354
stp58355
a((dp58356
g2
(lp58357
VUse  to add up all values of a sequence:
p58358
aVBut if you wanted to keep a running total, just loop through your list:
p58359
aVThat also can be used to build a list:
p58360
as(dp58361
g16
V100297
p58362
stp58363
a((dp58364
g2
(lp58365
VSQLite does not support storage on a distributed file system
p58366
aVConcurrent access required locking and that is not transferred across such a system
p58367
aVYou'll have to move to a database that supports a networked model instead, such as MySQL or PostgreSQL
p58368
as(dp58369
g16
V100297
p58370
stp58371
a((dp58372
g2
(lp58373
VYou need to retrieve the ,  and  values from the  object first:
p58374
aVassuming that the HTML form that submits to this script has ,  and  fields
p58375
aVLooking at , your original form does use exactly those fields
p58376
aVGET and POST provided data are always strings, but the  function wants you to pass in integer values, so here they are parsed into integers with the  function
p58377
aVThen, you are assigning the output of the  function to the name , but are not using that at all in the rest of the code
p58378
aVPerhaps you need to re-examine what all those  statements should be testing against
p58379
as(dp58380
g16
V100297
p58381
stp58382
a((dp58383
g2
(lp58384
VYou are importing a local file
p58385
aVYou have a file named  in your local directory that masks the global module
p58386
aVimports that file, not the standard library module
p58387
aVUse  to locate that file if you cannot find it
p58388
aVRename that file to something else
p58389
aVThe Python 2
p58390
aV4  module supports  without upgrading
p58391
as(dp58392
g16
V100297
p58393
stp58394
a((dp58395
g2
(lp58396
VJust store the old functions in a dictionary:
p58397
aVthen use the  dictionary to restore them:
p58398
aVThis only works if ,  and  were globals to begin with
p58399
aVYou can use the same trick to assign  to all those names:
p58400
aVThis sets the keys ,  and  to the same value
p58401
as(dp58402
g16
V100297
p58403
stp58404
a((dp58405
g2
(lp58406
VYou need to pick an output encoding for the CSV file as well:
p58407
aVThe default codec for your system cannot handle the codepoints you are reading from the input filename
p58408
aVOpening this file in Excel may not work; do follow the procedure in this answer, picking the UTF16 codec, to ensure that Excel reads the file correctly
p58409
aVYou could also try using UTF-8, adding in a UTF-8 BOM to the start of the file:
p58410
aVIt is mostly Microsoft software that uses a BOM in UTF-8 files, since UTF-8 only has one byte order to pick from, unlike UTF-16 and UTF-32, but it apparently makes Excel happy(er)
p58411
as(dp58412
g16
V100297
p58413
stp58414
a((dp58415
g2
(lp58416
VMove the  statement to the left, two indentation levels:
p58417
aVNow it'll be executed after the loop has completed, instead of for every iteration of the loop
p58418
as(dp58419
g16
V100297
p58420
stp58421
a((dp58422
g2
(lp58423
VInstead of picking a random index from the list of snapshots, shuffle the list once and pop items from that shuffled list:
p58424
aVBy using a  loop testing against the list you are removing from, you guarantee the loop  will terminate when the list is empty
p58425
aVBecause the list is shuffled, the items are processed in random order
p58426
as(dp58427
g16
V100297
p58428
stp58429
a((dp58430
g2
(lp58431
VIt doesn't matter, as Python will create the instance if you only raised the class
p58432
aVHowever, it is better to be explicit and create the instance yourself, to make it unambiguous you meant to use it without arguments
p58433
as(dp58434
g16
V100297
p58435
stp58436
a((dp58437
g2
(lp58438
VYou do not need to use  here
p58439
aVAt all
p58440
aVDon't use  to interpolate string values into other string values
p58441
aVMoreover, assignment in a  is not allowed (assignment is a statement, and a  only supports expressions)
p58442
aVThe following  does the same thing:
p58443
aVand uses  as a global
p58444
aVYou can also pass in  as an argument if  is not a global of the module you defined the  in:
p58445
as(dp58446
g16
V100297
p58447
stp58448
a((dp58449
g2
(lp58450
VTake the first character of each key, call  on that and sum your values by that uppercased letter
p58451
aVThe following loop
p58452
aVshould do it
p58453
aVYou can also use a  object to simplify that a little:
p58454
aVor you could use :
p58455
as(dp58456
g16
V100297
p58457
stp58458
a((dp58459
g2
(lp58460
V uses floor division, not floating point division, because both operands are integers:
p58461
aVUse floating point values, or use  to switch to the Python 3 behaviour where the  operator always uses floating point division:
p58462
as(dp58463
g16
V100297
p58464
stp58465
a((dp58466
g2
(lp58467
VYou are decoding UTF-8 data as Latin 1, use the correct codec instead:
p58468
aVThe correct Unicode codepoint for the  letter is , represented by  or  in a Python Unicode literal, and the hex bytes C3A8 in UTF-8
p58469
aVMisintepreting C3 A8 leads to two unicode characters  and , which you then write back to your file as C3 and A8 again because Latin1 maps one-on-one with Unicode
p58470
as(dp58471
g16
V100297
p58472
stp58473
a((dp58474
g2
(lp58475
VYou can use a list comprehension to join lists:
p58476
aVThe list comprehension creates a string of each nested list, then we join that new list of rows into a larger string with newlines
p58477
aVDemo:
p58478
aVYou could also have used a  loop:
p58479
as(dp58480
g16
V100297
p58481
stp58482
a((dp58483
g2
(lp58484
VA generator function returns a generator only when called
p58485
aVCall  to create the generator object:
p58486
aVor call the returned object:
p58487
aVYou did call ; had you referred to just  without calling it you'd have a reference to that function
p58488
as(dp58489
g16
V100297
p58490
stp58491
a((dp58492
g2
(lp58493
VJinja2 only supports Python 3
p58494
aV3 and up, you are trying to install it for Python 3
p58495
ag5740
aVQuoting from the documentation:
p58496
aVJinja 2
p58497
aV7 brings experimental support for Python >=3
p58498
ag35
aVPython 3
p58499
aV3 added support for  string literals to make it easier to write compatible code that runs both on Python 2 and 3, which Jinja2 makes use of
p58500
aVYou'll either have to upgrade to Python 3
p58501
aV3, or pick a different templating library
p58502
as(dp58503
g16
V100297
p58504
stp58505
a((dp58506
g2
(lp58507
V does the same search for you, but will only ever return the first match
p58508
aVUse  instead to create an index:
p58509
aVThe alternative approach would be to tell  where to start searching from
p58510
aVThe previous position you printed, for example:
p58511
as(dp58512
g16
V100297
p58513
stp58514
a((dp58515
g2
(lp58516
VYou assigned an integer to :
p58517
aVbut then try to use it as a function:
p58518
aVPerhaps you want to rename that variable; presumably you wanted to use the  function there
p58519
as(dp58520
g16
V100297
p58521
stp58522
a((dp58523
g2
(lp58524
VYou are changing the sequence, not the iterator
p58525
aVThe  loop calls  on the object you are looping over, creating a loop iterator
p58526
aVFor a  object, the list iterator created keeps a reference to the original list and an internal index, and every time the  loop asks for the next item (calls  on the iterator), the item at the current index is returned and the index is incremented
p58527
aVIn this case it is safe, as the loop iterator object will happily continue over the extra items
p58528
aVAs long as you don't add items to  indefinitely, the loop will complete
p58529
aVIf you were to remove items from , however, the loop iterator would not see those changes and you would get 'surprising' results:
p58530
aVprints:
p58531
aVbecause the loop iterator yields  on the next iteration, which is now , not
p58532
aVSimilar problems would occur if you were to insert items before the current iteration index
p58533
aVYou can create the iterator yourself, and experiment manually to see what happens:
p58534
as(dp58535
g16
V100297
p58536
stp58537
a((dp58538
g2
(lp58539
VYou want to count the paths using a dictionary, then use only those that have a count of 1, then loop using a list comprehension to do the final filter
p58540
aVUsing a  object makes the counting part easy:
p58541
as(dp58542
g16
V100297
p58543
stp58544
a((dp58545
g2
(lp58546
VThe code uses a generator expression, not a list comprehension
p58547
aVUse a loop and  adding up the results:
p58548
aVor, if you want the conditional expression expanded into an  statement as well:
p58549
as(dp58550
g16
V100297
p58551
stp58552
a((dp58553
g2
(lp58554
VThe line before it is missing a closing parenthesis:
p58555
aVYou have 3 opening parenthesis, but are closing only 2
p58556
aVThe second opening parenthesis can be dropped:
p58557
aVYou have the same problem a few lines down:
p58558
as(dp58559
g16
V100297
p58560
stp58561
a((dp58562
g2
(lp58563
VFor historical (hysterical
p58564
aVreasons Python's  type is a subclass of , and  is equal to 1 and  is equal to 0
p58565
aVThey hash to the same location as well:
p58566
aVSince both  and  are considered equal and they hash to the same slot, both  and  treat them as the same thing
p58567
aVYou'll see the same with a dictionary:
p58568
aVThis behaviour extends to other numbers too; floating point values equal to integer values will show the same behaviour:
p58569
aVbut at least the reasons why that happens are a little more
p58570
aVobvious
p58571
as(dp58572
g16
V100297
p58573
stp58574
a((dp58575
g2
(lp58576
VIf you need to update the count, then you have to read twice and count the number of rows you are keeping first
p58577
aVYou can keep a separate counter to rewrite the first column once you are writing the matched lines:
p58578
as(dp58579
g16
V100297
p58580
stp58581
a((dp58582
g2
(lp58583
VYou are running this in , which does not support UTF-8 by default
p58584
aVRun it as  or use  to fix that
p58585
aVThe other way to work around that, is to use a different locale; set your locale to Latin-1 for example:
p58586
aVbut then you are limited to 256 codepoints, versus the full range (several million) of the Unicode standard
p58587
aVNote that Python 2 never decoded the input; writing out what you read from the terminal will look fine because the raw bytes you read are interpreted by the terminal in the same locale; reading and writing Latin-1 bytes works just fine
p58588
aVThat's not quite the same as processing Unicode data, however
p58589
as(dp58590
g16
V100297
p58591
stp58592
a((dp58593
g2
(lp58594
VUse a list comprehension:
p58595
aVDemo:
p58596
aVThis produces a new list
p58597
aVYou can also reverse sublists in place by calling the  method on each one in a loop:
p58598
as(dp58599
g16
V100297
p58600
stp58601
a((dp58602
g2
(lp58603
VDon't use a regular expression at all
p58604
aVUse an HTML parser, like BeautifulSoup:
p58605
aVThis loads the URL data, finds the "infobox" table, then the row with the NCES entry
p58606
aVThere are 12 exactly-7-digit numbers in the HTML source, but the above code extracts the correct number in one go
p58607
as(dp58608
g16
V100297
p58609
stp58610
a((dp58611
g2
(lp58612
VYou need to either read the file first (as binary ) and use pickle
p58613
aVload()` command
p58614
aVThe latter is preferable:
p58615
aVNeither method supports loading a pickle from a filename
p58616
as(dp58617
g16
V100297
p58618
stp58619
a((dp58620
g2
(lp58621
VOn Python 3,  always returns a string value
p58622
aVUse the  type to convert it:
p58623
aVA string value and an int are not orderable:
p58624
aVNote that  can throw a  exception, if the input cannot be converted:
p58625
as(dp58626
g16
V100297
p58627
stp58628
a((dp58629
g2
(lp58630
V returns an int  status code , not a context manager
p58631
aVYou cannot use it in a  statement
p58632
aVJust return the return value of that call
p58633
aVNote that it will not raise a  exception either; it'll raise  if the process exits with a non-zero status code
p58634
aVPerhaps what you really wanted to use was
p58635
as(dp58636
g16
V100297
p58637
stp58638
a((dp58639
g2
(lp58640
VYou have a tuple, not a list, and those are immutable
p58641
aVUse concatenation if you want to alter the tuple, adding another tuple with elements:
p58642
aVHere you re-bind  to a new tuple that is the concatenation of the original value plus a tuple of length one
p58643
aVYou can omit the parenthesis even:
p58644
aVas it is the comma that makes the expression on the right a tuple
p58645
aVThe alternative is to turn your tuple into a list with the  type first:
p58646
aVand now you can call  and  at will
p58647
as(dp58648
g16
V100297
p58649
stp58650
a((dp58651
g2
(lp58652
VIf you want to read multidimensional data from a CSV, use the  or  functions, depending on how complete your CSV file is (use the former if row length varies, the latter if constant and uniform)
p58653
aVYou are instead trying to build a multidimensional  array manually, which as you discovered doesn't quite work like that
p58654
as(dp58655
g16
V100297
p58656
stp58657
a((dp58658
g2
(lp58659
VEscape the embedded quotes with :
p58660
aVIf your text contains only double quotes, you can single quotes and not have to escape the double quotes:
p58661
aVLast but not least, you can triple the outer quotes and save yourself having to escape newlines too:
p58662
aVFor your example, single quotes would already do the trick:
p58663
as(dp58664
g16
V100297
p58665
stp58666
a((dp58667
g2
(lp58668
VYou are looking at UTF-8 decoded as Windows codepage 1252 instead:
p58669
aVFixing this requires going the other way:
p58670
aVThere may have been some loss there though, as the UTF-8 encoding for  uses a codepoint not supported by 1252:
p58671
aVThere are several other Windows codepage candidates that can be tried here though; 1254 would result in similar output, for example, with only minor differences
p58672
as(dp58673
g16
V100297
p58674
stp58675
a((dp58676
g2
(lp58677
VEncode each value in the list to a string:
p58678
aVYou need to pick a valid encoding; don't use  as that'll use the system default (for Python 2 that's ASCII) which will not encode all possible codepoints in a Unicode value
p58679
aVUTF-8 is capable of encoding all of the Unicode standard, but any codepoint outside the ASCII range will lead to multiple bytes per character
p58680
aVHowever, if all you want to do is test for a specific string, test for a unicode string and Python won't have to auto-encode all values when testing for that:
p58681
as(dp58682
g16
V100297
p58683
stp58684
a((dp58685
g2
(lp58686
VYou are setting a local variable  in the  function
p58687
aVAssignment to a name in a function marks it as a local, unless you specifically tell the Python compiler otherwise
p58688
aVIn Python 3, you can explicitly mark  as non-local using the  keyword:
p58689
aVNow  is marked as a free variable and looked up in the surrounding scope instead when assigned to
p58690
aVIn Python 2 you cannot mark a Python local as such
p58691
aVThe only other option you have is marking  as a
p58692
aVYou'll have to resort to tricks where you alter values contained by a mutable object that lives in the surrounding scope
p58693
aVAn attribute on the  function would work, for example;  is local to the  scope, attributes on that object would be visible to anything that has access to :
p58694
aVAnother trick is to use a mutable container, such as a list:
p58695
aVIn both cases you are not assigning to a local name anymore; the first example uses attribute assignment on the  object, the second alters the  list, not assign to  itself
p58696
as(dp58697
g16
V100297
p58698
stp58699
a((dp58700
g2
(lp58701
VRead the file, appending the word and positions as tuples to a list
p58702
aVThen sort that list, remove the indices and join the words:
p58703
aVDemo:
p58704
as(dp58705
g16
V100297
p58706
stp58707
a((dp58708
g2
(lp58709
VUse a HTML parser instead, then simply replace the quotes with
p58710
aVBeautifulSoup makes this task easy:
p58711
as(dp58712
g16
V100297
p58713
stp58714
a((dp58715
g2
(lp58716
VYou missed that  is an operator too
p58717
aVWithout , the regular  operator returns a boolean:
p58718
aVis thus the inverse boolean 'value' of
p58719
aVIn a boolean context  is false:
p58720
aVso  is boolean
p58721
aVBoth  and  are objects too, and both have a memory address (the value  returns for the CPython implementation of Python):
p58722
aVtests if two references are pointing to the same object; if something is the same object, it'll have the same  as well
p58723
aVreturns a boolean value,  or
p58724
aVis the inverse of the  operator
p58725
aVIt is the equivalent of , in one operator
p58726
aVIt should not be read as  here:
p58727
as(dp58728
g16
V100297
p58729
stp58730
a((dp58731
g2
(lp58732
VYour OS provides the current timezone, as well as UTC time
p58733
aVThe OS does not, however, provide other timezone info, such as when DST switches take place
p58734
aVIn other words, you can get the current time in the UTC timezone, but not accurately calculate local time across the year, as the offset to UTC changes with the summertime and wintertime switches
p58735
as(dp58736
g16
V100297
p58737
stp58738
a((dp58739
g2
(lp58740
VUse either  and looping, or use , but don't mix both
p58741
aVUsing the file object as an iterable creates an internal buffer that would create confusion for what position the next  will read from (which does not use a buffer)
p58742
aVJust use  instead of  and you are good
p58743
aVBoth  and  return the line with the newline included, make sure you strip the line of whitespace before you test for the empty string
p58744
aVNote that you can use  to split off a value from the end of a line:
p58745
aVor use :
p58746
aVYour function does not need to use a  loop; you could also just use a  loop and break when the line is empty:
p58747
as(dp58748
g16
V100297
p58749
stp58750
a((dp58751
g2
(lp58752
VUse a dict comprehension:
p58753
aVThis simply loops over all the keys of  and echos that key as the value as well for each key-value pair
p58754
as(dp58755
g16
V100297
p58756
stp58757
a((dp58758
g2
(lp58759
V returns a string, always, but you are testing against integers
p58760
aVMake them strings:
p58761
aVYour entered  doesn't match any of your tests, so the function ends without ever reaching an explicit  statement and Python reverts to the default return value of
p58762
aVBetter still, replace the whole  tree with a dictionary:
p58763
as(dp58764
g16
V100297
p58765
stp58766
a((dp58767
g2
(lp58768
V is the same thing as
p58769
aVMore-over, negative indices have a different meaning to ; it does not mean that the values are negated
p58770
aVUse a  instead:
p58771
aVDemo:
p58772
aVNegative indices take items from the end of a sequence:
p58773
aVThe  will never modify the retrieved item, certainly not negate it
p58774
aVNote that  is only a convenience method, you do not have to use it and for more complex sorting orders, a custom function or lambda is the better choice
p58775
as(dp58776
g16
V100297
p58777
stp58778
a((dp58779
g2
(lp58780
VCall the  function:
p58781
aVReturn the directory currently selected to create temporary files in
p58782
aVYou can change where temporary files are created by setting the  value to different directory if you want to influence where temporary files are created
p58783
aVQuoting from the documentation, if that value is  the rules are as follows:
p58784
aVIf tempdir is unset or  at any call to any of the above functions, Python searches a standard list of directories and sets tempdir to the first one which the calling user can create files in
p58785
aVThe list is:
p58786
aVThe directory named by the  environment variable
p58787
aVThe directory named by the  environment variable
p58788
aVThe directory named by the  environment variable
p58789
aVA platform-specific location:
p58790
aVOn RiscOS, the directory named by the  environment variable
p58791
aVOn Windows, the directories , , , and , in that order
p58792
aVOn all other platforms, the directories , , and , in that order
p58793
aVAs a last resort, the current working directory
p58794
as(dp58795
g16
V100297
p58796
stp58797
a((dp58798
g2
(lp58799
VThe Python compiler marks a name as local to a function if you assign to it
p58800
aVYour last line assigns to  so it is seen as a local name, not a global
p58801
aVYou need to tell the compiler explicitly that  is a global, by using the  keyword inside the function:
p58802
aVIf there is no assignment, a name is considered non-local instead and you do not need to mark it
p58803
as(dp58804
g16
V100297
p58805
stp58806
a((dp58807
g2
(lp58808
VUse the  iterable instead
p58809
aVUse  to pull in all strings and join them together:
p58810
aVIterating over  yields each and every contained string, directly or in child tags
p58811
aVDemo:
p58812
as(dp58813
g16
V100297
p58814
stp58815
a((dp58816
g2
(lp58817
VYou are confusing Unicode with encodings
p58818
aVAn encoding is a standard that represents text as within the confines of individual values in the range of 0-255 (bytes), while Unicode is a standard that describes codepoints representing textual glyphs
p58819
aVThe two are related but not the same thing
p58820
aVThe Unicode standard includes several encodings
p58821
aVUTF-16 is one such encoding that uses 2 bytes per codepoint, but it is not the only encoding included in the standard
p58822
aVUTF-8 is another such encoding, and it uses a variable number of bytes per codepoint
p58823
aVYour file, however, is written using ASCII, the default codec used by Python 2 when you do not specify an explicit encoding
p58824
aVIf you expected to see 2 bytes per codepoint, encode to UTF-16 explicitly:
p58825
aVThis writes UTF-16 in little endian byte order; there is also a  codec
p58826
aVNormally, for multi-byte encodings like UTF-16 or UTF32, you'd also include a BOM, or Byte Order Mark; it is included automatically when you write UTF-16 without picking any endianes
p58827
aVI strongly urge you to study up on Unicode, codecs and Python before you continue:
p58828
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p58829
aVby Joel Spolsky
p58830
aVThe Python Unicode HOWTO
p58831
aVPragmatic Unicode by Ned Batchelder
p58832
as(dp58833
g16
V100297
p58834
stp58835
a((dp58836
g2
(lp58837
VYou should not be using  at all here; use  an  to catch arguments and pass those on:
p58838
as(dp58839
g16
V100297
p58840
stp58841
a((dp58842
g2
(lp58843
V removes the trailing newline, not all the newlines in the middle
p58844
aVYou have one long string, after all
p58845
aVUse  to split your document into lines without newlines; you can rejoin it if you want to:
p58846
aVbut now  will have all lines running together without a delimiter
p58847
as(dp58848
g16
V100297
p58849
stp58850
a((dp58851
g2
(lp58852
VYes,  can also recieve, by sending to the generator:
p58853
aVAny value passed to the  method is returned by the  expression
p58854
aVSee the  expressions documentation
p58855
aVwas made an expression in Python 2
p58856
aV5; before it was just a statement and only produced values for the generator
p58857
aVBy making  an expression and adding  (and other methods to send exceptions as well) generators are now usable as simple coroutines; see PEP 342 for the initial motivations for this change
p58858
as(dp58859
g16
V100297
p58860
stp58861
a((dp58862
g2
(lp58863
VIn Python, functions are objects too
p58864
aVWhen you call the  function, it returns the nested  function; it is in fact creating a new copy of that function:
p58865
aVYou stored that returned function object in , then called it:
p58866
aVYou can do this with any function; store a reference to a function in another name:
p58867
as(dp58868
g16
V100297
p58869
stp58870
a((dp58871
g2
(lp58872
VThe two codepaths are not equivalent
p58873
aVIn-place add acts on two operators, the assignment target and the item added
p58874
aVIn  that is , a local variable, and the in-place addition is translated to following:
p58875
aVand since you return  and  refers to the same object, this becomes  and that reference is cleaned up after the function exits
p58876
aVIn , you complicated matters, since now descriptors are getting involved again:
p58877
aVbecomes:
p58878
aVso you assign the result of  to the instance attribute ; the descriptor has no  method and is not consulted
p58879
aVBut, and here is the catch, the  object holds a reference to  itself,  is a reference to
p58880
aVYou created a circular reference
p58881
aVThis reference keeps the object alive long enough to show through the weak reference, but as soon as the garbage collection process runs and breaks this cycle,  will be gone anyway
p58882
aVMoral of this story
p58883
aVDon't use  in combination with a non-data descriptor; include both  and  because you need to control what happens when the result is assigned back
p58884
as(dp58885
g16
V100297
p58886
stp58887
a((dp58888
g2
(lp58889
VThat is normal Python behaviour; you are looking at a unicode string representation, one that can be pasted back into a Python interpreter without encoding problems as any non-ASCII or non-printable byte is represented as an escape code
p58890
aVNote that the newlines are also represented by their  escape code
p58891
aVUse  to write out the byte values without Python string literal representation:
p58892
aVThe codepoints are unicode codepoints, but because they are below U+0100 Python represents them with the  escape code
p58893
aVHigher codepoints would use the  escape code
p58894
aVIn the Unicode standard, code points below U+0100 match the Latin 1 standard
p58895
aVIf you expected UTF-8 bytes instead, then encode the Unicode value to UTF-8 again:
p58896
as(dp58897
g16
V100297
p58898
stp58899
a((dp58900
g2
(lp58901
V doesn't do anything
p58902
aVJust putting it, alone, on a line dereferences the name but doesn't invoke it
p58903
aVPerhaps you meant to call it
p58904
aVTo step out of a  loop you could also use , which is a statement:
p58905
as(dp58906
g16
V100297
p58907
stp58908
a((dp58909
g2
(lp58910
VYour next step could be to use a class generated with the  factory:
p58911
aVNote that like  objects, -derived objects are immutable
p58912
aVYou cannot assign to the attributes, you'd create a new object instead
p58913
aVYou'd only need to switch to custom classes if you needed to add functionality to your objects; add methods that act on the data associated with an object:
p58914
as(dp58915
g16
V100297
p58916
stp58917
a((dp58918
g2
(lp58919
VYou gave your  the type ; that is not a type SQLite recognizes
p58920
aVCorrect that to be  and the column will auto-increment
p58921
aVSee SQLite Autoincrement for more details
p58922
as(dp58923
g16
V100297
p58924
stp58925
a((dp58926
g2
(lp58927
VYou can re-combine multiple lists column-by-column with the  function:
p58928
aVIf all you do is loop over each combination, use it directly in a loop:
p58929
as(dp58930
g16
V100297
p58931
stp58932
a((dp58933
g2
(lp58934
VYou are trying to call , which is an integer constant denoting one of the pre-defined logging levels:
p58935
aVYou probably wanted to use the  function (note, all lowercase) instead:
p58936
aVLogs a message with level  on this logger
p58937
aVThe arguments are interpreted as for
p58938
as(dp58939
g16
V100297
p58940
stp58941
a((dp58942
g2
(lp58943
VAll your dictionary values are references to the one class-attribute
p58944
aVYou want to create copies instead:
p58945
aVThis uses the  method to create a shallow copy instead; this is enough as the values of  are mere strings and these are immutable so are safe to be shared
p58946
aVYou could also use a dictionary literal to create a new dictionary from scratch; you don't seem to be using  anywhere else so inlining is a possibility:
p58947
aVLast but not least, did you mean to use the  singleton instead of a string  perhaps
p58948
as(dp58949
g16
V100297
p58950
stp58951
a((dp58952
g2
(lp58953
VYou used a  where you should have used a :
p58954
aVfor the last entry in:
p58955
aVMake that single quote a double
p58956
aVAs for your translation program; it sounds as if your file encoding is incorrect, or is decoded incorrectly
p58957
aVPerhaps you should figure out the correct encoding instead, and not blindly replace Latin-1 bytes with UTF-8 sequences for Hebrew codepoints
p58958
aVIf you were to use the  module to open the file with the correct codec and decode to Unicode, you most probably will find the data is correctly encoded anyway
p58959
aVI strongly urge you to study up on Unicode, codecs and Python before you continue:
p58960
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p58961
aVby Joel Spolsky
p58962
aVThe Python Unicode HOWTO
p58963
aVPragmatic Unicode by Ned Batchelder
p58964
as(dp58965
g16
V100297
p58966
stp58967
a((dp58968
g2
(lp58969
V is an integer value
p58970
aVYou are trying to treat is like a function by calling it:
p58971
aVPerhaps you wanted to print it after the text:
p58972
aVThe same error applies to , correct it in a similar fashion:
p58973
as(dp58974
g16
V100297
p58975
stp58976
a((dp58977
g2
(lp58978
VIt is documenting that the  keyword argument to the  method is optional
p58979
aVWhen  is omitted, it defaults to
p58980
aVThe  positional argument is required
p58981
aVYou can use any callable for the ; it'll simply be called with no arguments in that case
p58982
aVYou may want to decorate the callable with the  decorator
p58983
aVPySide  objects are direct analogies of the PyQT New-style Signal and Slot Support
p58984
as(dp58985
g16
V100297
p58986
stp58987
a((dp58988
g2
(lp58989
VYou need to open the file in append mode, using :
p58990
aVYou opened the file in  write mode, which clears the file before writing
p58991
aVFrom the  documentation:
p58992
aVThe mode parameter should be  to read an existing file,  to truncate and write a new file, or  to append to an existing file
p58993
aVIf  is  and file refers to an existing ZIP file, then additional files are added to it
p58994
aVBold emphasis mine
p58995
as(dp58996
g16
V100297
p58997
stp58998
a((dp58999
g2
(lp59000
VYes, process the file line by line in an iterator:
p59001
aVThis uses a buffer for read performance but does not put as much pressure on your memory, avoiding having to swap
p59002
aVNext, use  to do the frequency counting for you
p59003
aVIt'll handle the counting and selecting the top N words for you, in the most efficient manner available in pure Python code
p59004
aVA naive way to get words would be to split the lines on whitespace; combining that with a generator expression could give you all the word counts in one line of code:
p59005
aVThe  class was added in Python 2
p59006
aV7; for 2
p59007
aV6 you can use this backport
p59008
as(dp59009
g16
V100297
p59010
stp59011
a((dp59012
g2
(lp59013
VThere is no point in trying to protect that password
p59014
aVAny token in that file that can be used to access the database can be used by anyone else to access the database
p59015
aVThat's how shared secret security works
p59016
aVReplace the password by a randomly generated token, and you still have to communicate that token to , for example
p59017
aVYour better bet is to restrict what computers can connect to your MySQL database using that username and password, adding an additional layer of security
p59018
aVOh, and making sure no one can access  by securing your webserver and source control systems properly
p59019
as(dp59020
g16
V100297
p59021
stp59022
a((dp59023
g2
(lp59024
VYou are reading a byte string, then transferring those raw bytes straight to your output and your terminal or IDE console is complaining that the bytestream contain sequences that are illegal in UTF-8
p59025
aVUse  to read the file into unicode data, then let Python encode the unicode values to your terminal codec automatically:
p59026
aVor loop directly over the file:
p59027
aVis the Python name for the Windows ANSI codepage:
p59028
aVWindows only: Encode operand according to the ANSI codepage (CP_ACP)
p59029
aVPerhaps you meant a different, specific Windows codepage; in that case pick out the right  codec, such as  or  for Microsoft's Western Europe Latin-1 variants
p59030
as(dp59031
g16
V100297
p59032
stp59033
a((dp59034
g2
(lp59035
VYou want to test if there is no intersection:
p59036
aVor
p59037
aVor, inversely, that the sets are disjoint:
p59038
aVThe method forms take any iterable, you don't even have to turn  into a set for that
p59039
aVThe following one-liner would work too:
p59040
aVDemo:
p59041
aVIf all you are testing for is one element, then it could be that creating sets is going to cost more in performance than what you gain in testing for membership, and just doing:
p59042
aVwhere  is a short list
p59043
aVYou can use the  module to compare pieces of Python code to see what works best for your specific typical list sizes
p59044
as(dp59045
g16
V100297
p59046
stp59047
a((dp59048
g2
(lp59049
VYou should not use  for SQL parameters
p59050
aVStick to  and let the MySQL connector handle the types:
p59051
aVQuoting from the Python-MySQL documentation:
p59052
aVString constant stating the type of parameter marker formatting expected by the interface
p59053
aVSet to  = ANSI C  format codes, e
p59054
ag1298
aVIf a mapping object is used for conn
p59055
aVexecute(), then the interface actually uses  = Python extended format codes, e
p59056
ag1298
aVHowever, the API does not presently allow the specification of more than one style in paramstyle
p59057
aVGranted, using  for SQL parameters is confusingly similar to Python string formatting, but it is not the same
p59058
as(dp59059
g16
V100297
p59060
stp59061
a((dp59062
g2
(lp59063
VUse  to create an infinite loop, and use  to end it
p59064
aVNow you can end the loop as soon as you read an empty line and not fail when trying to address elements that won't exist:
p59065
aVNote you don't even have to test more than just ; an empty string is considered false in a boolean test like
p59066
as(dp59067
g16
V100297
p59068
stp59069
a((dp59070
g2
(lp59071
VTo create subprocesses
p59072
aVThis is an operating system (OS) concept, and has nothing to do with Java interfaces
p59073
aVYour OS controls processes, like your python program
p59074
aVWith the  module it is easy to ask the OS to create more such processes, and communicate with them
p59075
aVProcesses are controlled in a hierarchy, a tree structure of parents and children
p59076
aVThere is one master process that started with the OS kernel when your computer booted, and everything else is either a direct subprocess of that master process, or a indirect child process
p59077
aVThe module provides a higher-level API to do this than the lower-level, direct translations of the C-API functions , , etc
p59078
aVwith more flexibility and safety against security problems
p59079
as(dp59080
g16
V100297
p59081
stp59082
a((dp59083
g2
(lp59084
VNormally, because it is good practice to call the initializer of the class you are inheriting from
p59085
aVHowever, the author seems to have substituted  for an empty list; I'd have used one of:
p59086
aVor at the very least provided an explicit  argument:
p59087
aVIn this case, you are subclassing ; it's initializer takes a initial list of elements to  start with, but your own initializer only takes , so the superclass initializer is passed an explicit empty list
p59088
aVThe  method does little more than clear and extend; it is the equivalent of , resetting it's size and making it re-usable in case  is called multiple times
p59089
aVPassing in a new list object to the  initializer makes the call entirely useless and a no-op; that's an error that must've slipped by the technical review
p59090
as(dp59091
g16
V100297
p59092
stp59093
a((dp59094
g2
(lp59095
V does not handle parsing XML responses, no
p59096
aVXML responses are much more complex in nature than JSON responses, how you'd serialize XML data into Python structures is not nearly as straightforward
p59097
aVPython comes with built-in XML parsers
p59098
aVI recommend you use the ElementTree API:
p59099
aVor, if the response is particularly large, use an incremental approach:
p59100
aVThe external lxml project builds on the same API to give you more features and power still
p59101
as(dp59102
g16
V100297
p59103
stp59104
a((dp59105
g2
(lp59106
VThere is no need to encode the data
p59107
aVFeed it directly to ; the JSON standard uses  escape codes to denote unicode values too
p59108
aVThe values are not encoded in UTF-8, the Python  module will handle them for you
p59109
aVEven if the data was encoded in UTF-8, the  module will handle that for you as well
p59110
aVEven if it didn't, you'd use , not encode
p59111
aVUTF-8 data looks different as well; the U+2019 codepoint looks like:
p59112
aVwhen encoded to UTF-8
p59113
as(dp59114
g16
V100297
p59115
stp59116
a((dp59117
g2
(lp59118
VBy decoding the data from UTF-8 to Unicode values, then having Python encode those values back to your terminal encoding automatically:
p59119
aVYou can use  and have the data decoded for you as you read:
p59120
as(dp59121
g16
V100297
p59122
stp59123
a((dp59124
g2
(lp59125
VAdd an outer loop:
p59126
as(dp59127
g16
V100297
p59128
stp59129
a((dp59130
g2
(lp59131
VYou defined  as a function parameter; that makes it a local name in that function
p59132
aVThat doesn't make the name available to other scopes; the global namespace that the decorator lives in cannot see that name
p59133
aVThe wrapper function, however, can
p59134
aVIt'll be passed that parameter from the  wrapper when called:
p59135
as(dp59136
g16
V100297
p59137
stp59138
a((dp59139
g2
(lp59140
VUse zero-width negative look-around assertions:
p59141
aVThe look-around assertions (lookbehind and lookahead) match a position, not a character; the negative assertions only match if the preceding text or the following text respectively does not match the named pattern
p59142
aVThis means only locations that do not follow or precede a number will be matched; the start and end of a string will do for that purpose
p59143
aVDemo:
p59144
as(dp59145
g16
V100297
p59146
stp59147
a((dp59148
g2
(lp59149
VYou can use the  function to look up local names:
p59150
aVbut you really want to rethink your data structure instead and perhaps use a dictionary to store  and
p59151
aVreturns the current local namespace as a dictionary
p59152
aVYou should treat this dictionary as read-only, especially within functions
p59153
as(dp59154
g16
V100297
p59155
stp59156
a((dp59157
g2
(lp59158
VYour loops are all working, but your  function only prints one loop
p59159
aVThe second time  is called,  is still  greater than  and the loop won't run, and won't print
p59160
aVIf you wanted to create nested loops, then it'd be simpler using integers and divide by 10:
p59161
aVThis can be collapsed into one loop using :
p59162
as(dp59163
g16
V100297
p59164
stp59165
a((dp59166
g2
(lp59167
VYou are using the wrong tool
p59168
aVDon't use regular expressions to parse HTML
p59169
aVUse a HTML parser instead
p59170
aVThe BeautifulSoup library makes your task trivial:
p59171
aVDemo:
p59172
as(dp59173
g16
V100297
p59174
stp59175
a((dp59176
g2
(lp59177
V replaces all occurrences of the first operand with the second operand
p59178
aVIt does not treat the second argument as an expression, however
p59179
aVReplace one occurrence at a time; the  method takes a third argument that limits how many replacements are made:
p59180
aVNow the  is called for each iteration through the loop
p59181
aVDemo:
p59182
as(dp59183
g16
V100297
p59184
stp59185
a((dp59186
g2
(lp59187
VSee the Naming and Binding reference; Python names in functions that are not assigned to ('bound') in that function, are considered free variables
p59188
aVIf a variable is used in a code block but not defined there, it is a free variable
p59189
aVFree variables are looked up in parent scopes, ultimately in the global scope
p59190
aVThe  name is never assigned to in the  function, so Python considers it a free variable and looks it up in the global namespace
p59191
aVThere is an actual global in your module by that name, so the code works and does not throw a  exception
p59192
aVYou also gave the function a local name , that is passed the  object; inside the function  is bound to the same object, so you could have used  instead
p59193
as(dp59194
g16
V100297
p59195
stp59196
a((dp59197
g2
(lp59198
VThe smarter thing would have been to use ZEO to share the ZODB storage among the processes
p59199
aVZEO shares a ZODB database across the network and extends the conflict resolution across multiple clients, which can reside on the same machine or elsewhere
p59200
aVAlternatively, you could use the  backend to store your ZODB instead of using the standard ; this backend uses a traditional relational database to provide concurrent access instead
p59201
aVSee zc
p59202
aVlockfile
p59203
aVLockError in ZODB for some usage examples for either option
p59204
aVThe ZODB data structures are otherwise merely persisted Python data structures; merging the three ZODB datastructures requires you to open each of the databases and merging the nested structures as needed
p59205
as(dp59206
g16
V100297
p59207
stp59208
a((dp59209
g2
(lp59210
VLoop over the counter with a list comprehension:
p59211
aVDemo:
p59212
aVIf you wanted your values to be listed in sorted order, use  instead of
p59213
as(dp59214
g16
V100297
p59215
stp59216
a((dp59217
g2
(lp59218
VLoop over the open file object:
p59219
aVSo, yes, use a  loop and use 0-based indexing
p59220
as(dp59221
g16
V100297
p59222
stp59223
a((dp59224
g2
(lp59225
VYou need to add a handler for the  method as well:
p59226
as(dp59227
g16
V100297
p59228
stp59229
a((dp59230
g2
(lp59231
VThe  method requires a  parameter:
p59232
aVWithout it you always have one argument at least and it will not be callable; it is the decorator instance instead
p59233
aVIn other words, without an explicit ,  will be two elements long when you pass in the argument and it'll be  you wanted to test
p59234
as(dp59235
g16
V100297
p59236
stp59237
a((dp59238
g2
(lp59239
VYou are seeing the result of UTF-8 bytes being mis-interpreted as Latin-1 (ISO-8859-1)
p59240
aVYou should, however, not pass Unicode to the ElementTree API in the first place
p59241
aVUse the  attribute instead;  gives you decoded values (and in this case, incorrectly decoded):
p59242
as(dp59243
g16
V100297
p59244
stp59245
a((dp59246
g2
(lp59247
VUse the  switch to , then encode the value to UTF-8 manually:
p59248
aVIf you are writing this to a file, you can use  instead of  to produce a file object that encodes Unicode values for you as you write, then use  instead to write to that file:
p59249
aVIn Python 3, the built-in  is an alias for
p59250
aVIf you are passing in byte strings (type  in Python 2,  in Python 3) encoded to UTF-8, make sure to also set the  keyword:
p59251
aVNote that your second sample is not valid Unicode; you gave it UTF-8 bytes as a unicode literal, that would never work:
p59252
aVOnly when I encoded that string to Latin 1 (whose unicode codepoints map one-to-one to bytes) then decode as UTF-8 do you see the expected output
p59253
aVThat has nothing to do with JSON and everything to do with that you use the wrong input
p59254
aVThe result is called a Mojibake
p59255
aVIf you got that Unicode value from a string literal, it was decoded using the wrong codec
p59256
aVIt could be your terminal is mis-configured, or that your text editor saved your source code using a different codec than what you told Python to read the file with
p59257
aVOr you sourced it from a library that applied the wrong codec
p59258
aVThis all has nothing to do with the JSON library
p59259
as(dp59260
g16
V100297
p59261
stp59262
a((dp59263
g2
(lp59264
VYou need to print an empty line after the headers, and you Content-disposition header is missing the type ():
p59265
aVYou may also want to use a more efficient method of uploading the resulting file; use  to copy the data to :
p59266
aVYou should not use  for binary data in any case; all you get is  byte literal  syntax
p59267
aVThe  object is the underlying binary I/O buffer, copy binary data directly to that
p59268
as(dp59269
g16
V100297
p59270
stp59271
a((dp59272
g2
(lp59273
VDo not use a capturing group that repeats; only the last value will be captured
p59274
aVwill only return captured groups when you use them
p59275
aVA non-capturing group for the repeat would work much better here:
p59276
aVDemo:
p59277
aVWithout the capturing group,  returns the whole match
p59278
as(dp59279
g16
V100297
p59280
stp59281
a((dp59282
g2
(lp59283
V is another instance of the  class
p59284
aVEach element in the tree has two 'child' nodes,  and  and the  merely delegates printing of those nodes directly to the nodes themselves, with a configurable indentation
p59285
aVNormally, you'd call , and Python in turn will call , but that doesn't give you the option of passing in the indentation level; so this code calls  directly instead
p59286
as(dp59287
g16
V100297
p59288
stp59289
a((dp59290
g2
(lp59291
VYou need to import the  module explicitly:
p59292
aVbefore it is available
p59293
aVAlternatively, import the function into your local namespace:
p59294
as(dp59295
g16
V100297
p59296
stp59297
a((dp59298
g2
(lp59299
VTo ignore corrupted data (which can lead to data loss), set  on the  call:
p59300
aVThe  function documentation states:
p59301
aVignores errors
p59302
aVNote that ignoring encoding errors can lead to data loss
p59303
aVThis does not mean you can recover from the apparent data corruption you are experiencing
p59304
aVTo illustrate, imagine a byte was dropped or added somewhere in your file
p59305
aVUTF-16 is a codec that uses 2 bytes per character
p59306
aVIf there is one byte missing or surplus then all byte-pairs following the missing or extra byte are going to be out of alignment
p59307
aVThat can lead to problems decoding further down the line, not necessarily immediately
p59308
aVThere are some codepoints in UTF-16 that are illegal, but usually because they are used in combination with another byte-pair; your exception was thrown for such an invalid codepoint
p59309
aVBut there may have been hundreds or thousands byte-pairs preceding that point that were valid UTF-16, if not legible text
p59310
as(dp59311
g16
V100297
p59312
stp59313
a((dp59314
g2
(lp59315
VYou are testing if
p59316
aVThis doesn't work when  is :
p59317
aVis evaluated lazily; first the left is evaluated, and only if  is the second argument evaluated
p59318
aVThe first is only  if  is , so the right-hand expression is only ever evaluated as
p59319
aVUse  instead, and negate the  test:
p59320
aVThe above expression is the proper logical inversion of
p59321
aVAlternatively use  around your original expression:
p59322
aVBecause you are using a regular  loop, there is no need to use a conditional expression here; the following, assigning to the existing loop variable , suffices:
p59323
as(dp59324
g16
V100297
p59325
stp59326
a((dp59327
g2
(lp59328
VUse the timezone's  method to apply a timezone other than UTC to a timestamp:
p59329
aVNote the one hour time difference now displayed, as the correct current and not historical timezone transitions are applied
p59330
aVNext, you need to interpret the resulting timestamp as UTC again lest Python apply the local timezone to the timestamp again:
p59331
as(dp59332
g16
V100297
p59333
stp59334
a((dp59335
g2
(lp59336
VIt looks like you are getting muddled up between  (the  result, so a list of integers) and  (uppercase, the loop variable, an integer)
p59337
aVBecause  is a list, you should not try to test against if it is smaller or greater than a single integer either;  makes no sense; ordering between different types always places numbers first, then orders them by type name; integers are always lower than lists, so  is always
p59338
aVOr as a list comprehension:
p59339
as(dp59340
g16
V100297
p59341
stp59342
a((dp59343
g2
(lp59344
VUse a list comprehension:
p59345
aVYou can combine that with the :
p59346
aVI've used  here since you don't need the list produced by ; only the sequence
p59347
aVQuick demo:
p59348
as(dp59349
g16
V100297
p59350
stp59351
a((dp59352
g2
(lp59353
VName it  and put it at the root of your site
p59354
aVMake sure you don't have a default page set
p59355
as(dp59356
g16
V100297
p59357
stp59358
a((dp59359
g2
(lp59360
VYou are setting an attribute
p59361
aVAssignment to an attribute always uses
p59362
aVand  are only consulted when looking up the value of a specific attribute; when setting you are not retrieving a value
p59363
aVThis is not an override; even if  was not defined, the  method would not be consulted
p59364
as(dp59365
g16
V100297
p59366
stp59367
a((dp59368
g2
(lp59369
VUse a generator function to detect new entries by the starting :
p59370
aVThis yields complete recombined sections, ready to write to a CSV
p59371
aVFor your sample input, that produces:
p59372
as(dp59373
g16
V100297
p59374
stp59375
a((dp59376
g2
(lp59377
VDescriptors are always part of the class; instances have their own attributes and normally they take precedence over any attributes on the class
p59378
aVData descriptors are simply descriptors that have both a  and a  method
p59379
aVSo Python does this:
p59380
aVSee if there is a data descriptor; a descriptor with both hooks
p59381
aVLook for an attribute on the instance
p59382
aVLook for regular (non-data) descriptor on the class
p59383
aVFall back to a regular attribute on the class
p59384
aVPoint 3
p59385
aVand 4
p59386
aVare really the same thing; descriptors are class attributes with specific methods; so point 4 is really point 3 when there is no descriptor hooks on that attribute
p59387
as(dp59388
g16
V100297
p59389
stp59390
a((dp59391
g2
(lp59392
VJust sort the list; the default sort does just what you want
p59393
aVWhen comparing two tuples, they are ordered according to their contents; sorted on the first element first, then if they are equal, sorted on the second element, etc
p59394
aVDemo:
p59395
aVI moved the  element forward to show that it is still sorted after
p59396
aVPython's  method and  function take a  function that returns a value on which to sort instead if you need a different sort order
p59397
aVIf you wanted to sort on the last element first, then second last, etc
p59398
aVfor example, you'd use:
p59399
aVwhere the lambda returns a reversed tuple to sort on instead
p59400
aVThe callable object you pass to  is called for each element in the input sequence to 'augment' the list before sorting, as if you had done:
p59401
aVThe  uses a reversing slice
p59402
aVFor more detail, see the Python Sorting HOWTO
p59403
as(dp59404
g16
V100297
p59405
stp59406
a((dp59407
g2
(lp59408
VSomewhere, in regular python code, add the following:
p59409
aVto whitelist the module
p59410
aVYes, this has to be run from file-system-based Python, for obvious security reasons
p59411
as(dp59412
g16
V100297
p59413
stp59414
a((dp59415
g2
(lp59416
VNo, you cannot, because after one syntax error the rest of the code structure is no longer recoverable
p59417
aVTake a missing parenthesis for example; was that a parenthesis that was missing, or a comma
p59418
aVIs the function call on the next line therefor part of the expression with the error, or not
p59419
aVIf the comma was missing, there might be a parenthesis missing on the next line
p59420
aVIf the parenthesis was missing, there might be a parenthesis too many on the next line
p59421
aVThat'd be two  very different syntax errors that depend on what the previous syntax error really was meant to be
p59422
aVA syntax error in one place invalidates the rest of the code and there is no point in continuing parsing, at least not for Python which needs to produce valid bytecode
p59423
aVYou can use a Python linter; many can be integrated with your text editor of choice
p59424
aVA Python IDE or linter does not have to produce bytecode and can be more flexible in handling syntax errors (continueing checking on subsequent lines), and can tell you about other problems too, like missing or unused imports and variables
p59425
as(dp59426
g16
V100297
p59427
stp59428
a((dp59429
g2
(lp59430
V lists only the filename without a path
p59431
aVPrepend these with  again:
p59432
aVIf all you are doing is loop over the lines from the file, just loop over the file itself; using  makes sure that the file is closed for you when done too
p59433
aVLast but not least,  returns the new string value, not change the value itself, so you need to store that return value:
p59434
as(dp59435
g16
V100297
p59436
stp59437
a((dp59438
g2
(lp59439
VYou are creating 19683 new tuples of 9 elements
p59440
aVYour computer does not have enough memory available for all those tuples at once
p59441
aVIf you do not use , then only a generator object is created, one that will produce the 19683 one-by-one as you iterate over it
p59442
aVYou should filter the output of  without converting it to a list:
p59443
aVYou could turn  into a list, but if all you do is loop over that list and process items one by one, you should not do that
p59444
aVOnly turn it into a list if you need random access to the elements
p59445
as(dp59446
g16
V100297
p59447
stp59448
a((dp59449
g2
(lp59450
VYou'd use  on the list without string formatting, then interpolate the result:
p59451
aVDemo:
p59452
aVIf some of your arguments are not yet strings, use a list comprehension:
p59453
aVor use :
p59454
aVYou'd do the same with your function:
p59455
aVIf you are limited by a (rather arbitrary) restriction that you cannot use a  in the interpolation argument list, use a  to create the formatting string instead:
p59456
as(dp59457
g16
V100297
p59458
stp59459
a((dp59460
g2
(lp59461
VSure, use a list comprehension with two loops:
p59462
as(dp59463
g16
V100297
p59464
stp59465
a((dp59466
g2
(lp59467
VThere is no need to  the exception; the exception has already been raised and your context manager is merely being informed of that
p59468
aVTest if there was no exception instead:
p59469
aVIf your context manager were to return  at that moment you'd suppress the exception; just exiting the function instead returns  and the exception remains 'raised'
p59470
aVNote that the  module includes two types of temporary file objects that act as context managers, that self-delete already, independent of platform
p59471
aVOn POSIX systems you can unlink the file right after creation; the file descriptor remains alive until you close the file
p59472
aVWindows offers a 'delete on close' option too
p59473
aVThe  class uses the right option for your platform
p59474
as(dp59475
g16
V100297
p59476
stp59477
a((dp59478
g2
(lp59479
VYour  cards are all strings:
p59480
aVNote the  and , etc
p59481
aVstrings
p59482
aVYet you try to treat them as integers:
p59483
aVwill never be in , because all your values are strings
p59484
aVSo the above  statements are always
p59485
aVThe next part is:
p59486
aVWhen 'number' cards are drawn, the  is still true, they are not equal to , so you count all cards as value 10
p59487
aVYou'll need to rethink how to handle the number cards here
p59488
aVYou can test for alphanumeric ordering:
p59489
aVwould work for your numeric cards too, as all numbers sort before capitals in the ASCII standard
p59490
aVUse that instead of the  test
p59491
aVNext problem is that you are then trying to add up the value using strings when the cards are numeric:
p59492
aVbut that adds up strings; a string value is always greater than numbers (in Python 3, comparing strings and numbers raises an error)
p59493
aVUse  to sum actual numbers:
p59494
aVNow at least you have something working:
p59495
aVBut this is still too high
p59496
aVThat's because you use  to store the calculation but never reset it
p59497
aVYou keep on adding for each new calculation
p59498
aVUse a local variable instead of :
p59499
aVNow the game works as expected:
p59500
as(dp59501
g16
V100297
p59502
stp59503
a((dp59504
g2
(lp59505
VUse  to decode the object on the fly:
p59506
as(dp59507
g16
V100297
p59508
stp59509
a((dp59510
g2
(lp59511
VSince there is no  function, you built your own, but picked a slow method
p59512
aVUse a list comprehension instead:
p59513
aVThis will still be slower than string replacement because you cannot avoid the Python loop here
p59514
aVUsing a set for  helps:
p59515
aVbut the fastest way to replace individual characters in text is actually a different technique altogether
p59516
aVUse  for that:
p59517
aVWith these changes the timings become:
p59518
aVblowing the looped  calls right out of the water too
p59519
as(dp59520
g16
V100297
p59521
stp59522
a((dp59523
g2
(lp59524
VThis line won't do what you think it does:
p59525
aVApart from the missing  (presumably that's a typo), the code won't work for two reasons:
p59526
aVreturns  if nothing is found,  if the searched-for string is found at the start
p59527
aVis considered  in a boolean context and you should instead test for
p59528
aVYou are not testing for either
p59529
aVYou are only testing for
p59530
aVThe  expression is evaluated first, and short-circuits to return the first -ish value, the first non-empty string, so  in this case
p59531
aVYou should instead test for the presence of strings using :
p59532
aVDemo:
p59533
aVYour next problem is that  won't take kindly to extra text in your input text
p59534
aVYou already determined that  is present, and that is what throws the exception
p59535
aVYou could use a regular expression, like the Ruby code:
p59536
aVDemo:
p59537
as(dp59538
g16
V100297
p59539
stp59540
a((dp59541
g2
(lp59542
VYou are only ever assigning to a local name (variable); you are not assigning anything to the attributes of the objects involved
p59543
aVIn other words, only  is rebound to different objects, but  is a local name in the  function
p59544
aVAt no point do you assign to attributes on  or
p59545
aVThis has otherwise nothing to do with mutability
p59546
aVIf you expected  to be affected by the line  then you are perhaps misunderstanding what that line does
p59547
aVThat line:
p59548
aVlooks up the  attribute on the object referenced by
p59549
aVcalls the resulting object
p59550
aVstores the result of the call in a name , rebinding it if it was bound before
p59551
aVRebinding simply discards the previous reference, so now  is pointing to whatever  returned
p59552
aVThe previous object that  was bound to is otherwise not changed
p59553
aVIf there were no other references to that previous object anywhere else in Python, then that object is cleared from memory (deleted)
p59554
aVIn a linked list, presumably there is still a reference to it from the previous object in the list though
p59555
aVYou could see objects as balloons, and names (variables) as labels; assignment attaches the name to the object by a string
p59556
aVYou can attach multiple labels to any given balloon, but a given label can only ever be attached to one balloon
p59557
aVRebinding, then, simply cuts the string tying the label to the balloon, and retying it to another balloon
p59558
aVAny balloon that has no more strings attached to it simply flies away never to be seen again
p59559
as(dp59560
g16
V100297
p59561
stp59562
a((dp59563
g2
(lp59564
VUse the  function to test if a condition holds  for all elements:
p59565
aVThe  function takes an iterable (something that produces results one by one) and will only return  itself if all those elements are true
p59566
aVThe moment it finds anything that is false, it'll return  and not look further
p59567
aVHere the iterable is a generator expression, one that executes an equality test for each element in the input sequence
p59568
aVThe fact that  stops iterating early if a false value is encountered makes this test very efficient if the test in the contained generator expression is False for any element early on
p59569
aVNote that if  is empty, then  returns  as well as it won't find any elements that are false in an empty sequence
p59570
aVYou could test for the sequence being non-empty first:
p59571
aVto work around that
p59572
as(dp59573
g16
V100297
p59574
stp59575
a((dp59576
g2
(lp59577
VYou need to double each :
p59578
aVThis escapes the ; the output transforms each  back to
p59579
aVDemo:
p59580
as(dp59581
g16
V100297
p59582
stp59583
a((dp59584
g2
(lp59585
VDo not create separate lists; create a list of lists:
p59586
aVor better still, use the  module:
p59587
aVLists or dictionaries are far superiour structures to keep track of an arbitrary number of things read from a file
p59588
aVNote that either loop also lets you address the rows of data individually without having to read all the contents of the file into memory either; instead of using  just process that line right there
p59589
aVJust for completeness sake, here's the one-liner compact version to read in a CSV file into a list in one go:
p59590
as(dp59591
g16
V100297
p59592
stp59593
a((dp59594
g2
(lp59595
VUnfortunately,  used the  call instead of the built-in Python 2  function
p59596
aVThis opened the file in text mode, which like on Python 3 expects Unicode input
p59597
aVHowever, the  module does not support Unicode data; it certainly does not produce Unicode
p59598
aVYou'll either have to open the file in binary mode on Python 2:
p59599
aVor use the built-in  call instead:
p59600
aVwhere you have to use  as the mode anyway
p59601
aVIf you are trying to write out unicode data, you'll have to encode that data before passing it to the  object
p59602
aVThe  module examples section includes code to make encoding from Unicode before writing a little easier
p59603
as(dp59604
g16
V100297
p59605
stp59606
a((dp59607
g2
(lp59608
VProcess the previous line:
p59609
aVWhen the loop terminates, you know that the last line was just read
p59610
aVA generic version, letting you process the N last lines separately, use a  object:
p59611
as(dp59612
g16
V100297
p59613
stp59614
a((dp59615
g2
(lp59616
VYour JSON data is not UTF-8 encoded
p59617
aVThe  parameter to the  function instructs it how to interpret Python byte strings in  (e
p59618
ag1298
aVthe input), not how to encode the resulting output
p59619
aVIt doesn't encode the output at all because you used
p59620
aVEncode the data before compression:
p59621
aVWhen decompressing again, there is no need to decode from UTF-8; the  function assumes UTF-8 if the input is a bytestring
p59622
as(dp59623
g16
V100297
p59624
stp59625
a((dp59626
g2
(lp59627
VDo not use  for this; use the module-level  name instead
p59628
aVIf the current working directory is elsewhere, you end up in an infinite loop when you reach the root directory and continually fail to go up one directory
p59629
aVNow  is a path to the directory containing the current Python file
p59630
aVUse that to find the top of your project (not by using  but by using  functions)
p59631
as(dp59632
g16
V100297
p59633
stp59634
a((dp59635
g2
(lp59636
VUse  and exclude any indices you want removed:
p59637
aVFor performance, it'd be fastest if  was a
p59638
as(dp59639
g16
V100297
p59640
stp59641
a((dp59642
g2
(lp59643
V is a command supplied by
p59644
aVMake sure you import from that project in , not from :
p59645
aVThe tutorial does tell you to do this, but it appears you missed that part
p59646
as(dp59647
g16
V100297
p59648
stp59649
a((dp59650
g2
(lp59651
VYou are looking at JSON data; use the  module to parse this into Python structures
p59652
aVThe rest of your tasks are then easy:
p59653
as(dp59654
g16
V100297
p59655
stp59656
a((dp59657
g2
(lp59658
VUse the  function with a generator expression testing each nested list:
p59659
aVThis will only test as many nested lists as needed to find any for which the test is
p59660
aVNote that it is simpler to just loop directly over  in loops:
p59661
as(dp59662
g16
V100297
p59663
stp59664
a((dp59665
g2
(lp59666
V does create the file if it is not present:
p59667
aVHowever, the mode does not create directories
p59668
aVThe directory you wanted to create the file in is not present
p59669
aVCreate that first, or correct the directory if it is supposed to exist already
p59670
as(dp59671
g16
V100297
p59672
stp59673
a((dp59674
g2
(lp59675
VYou are looking for the set difference; the  operator will do that for you:
p59676
aVIf you use the  method the second operand does not need to be a set, it can be any iterable:
p59677
aVDemo:
p59678
as(dp59679
g16
V100297
p59680
stp59681
a((dp59682
g2
(lp59683
VIt is unfortunate that both projects picked a generic name
p59684
aVThis makes it almost impossible to correctly specify which one you need to install
p59685
aVA workaround would be to specify a minimum version;  is up to version 1
p59686
ag2176
aV5 at the time of writing, while  only ever released version 1
p59687
aV0, over 3 years ago
p59688
aVPin your requirement to 1
p59689
aV5 and newer and  will go looking for  even if  is installed:
p59690
aVThis workaround will fail, of course, the day  releases a 1
p59691
aV5 or newer version
p59692
as(dp59693
g16
V100297
p59694
stp59695
a((dp59696
g2
(lp59697
VIf you wanted to replace elements with a comment containing the replaced tag, replace the object with a new  object:
p59698
aVIn Python, instead of using a  loop with , just loop over the sequence directly; in the above code I loop directly over the  results
p59699
aVBeautifulSoup elements may print as if they are just HTML text, but in reality they are not strings but  objects
p59700
aVDon't try to treat them as strings
p59701
as(dp59702
g16
V100297
p59703
stp59704
a((dp59705
g2
(lp59706
VA python  loop evaluates the expression that yields the iterable over which to loop once only
p59707
aVYou can manipulate the  object in the loop without affecting the outcome of what  is looping over
p59708
aVThis differs from the Java  construct (which is a very different construct from the Python  statement, which is really a Foreach construct), which evaluates the 3 associated expressions for each iteration
p59709
aVIn your first example, you created a  result, and once that is created it is not updated for each loop iteration
p59710
aVIn your second example, you created a copy of  using a full-length slice () for the loop to iterate over
p59711
aVThe copy is not re-created for each loop iteration
p59712
aVThere is a caveat here, however
p59713
aVThe  loop calls  on the object-to-be-iterated-over
p59714
aVFor a list object, the resulting list iterator does keep a reference to the original list, as well as an iteration index
p59715
aVEvery time the  loop advances the iterator (calling  on it), the iteration index is incremented and looked up on the original list, until the index is equal to the list length
p59716
aVIf you keep adding to the list in the loop, that would create an infinite loop
p59717
aVYou can see this if you do not create a copy of the list to iterate over:
p59718
aVHere, the iterator created for  keeps yielding the next element as  is extended in the loop, and if I had not added a length limit in the loop this would have continued forever
p59719
as(dp59720
g16
V100297
p59721
stp59722
a((dp59723
g2
(lp59724
VYou cannot use endless generators to fill any  arbitrary arguments call
p59725
aVPython iterates over the generator to load all arguments to pass on to the callable, and if the generator is endless, that will never complete
p59726
aVYou can use non-endless generators without problems
p59727
aVYou could use  to cap a generator:
p59728
aVAfter all, you already know how many slots your template has
p59729
as(dp59730
g16
V100297
p59731
stp59732
a((dp59733
g2
(lp59734
VOpen the output file as binary:
p59735
aVor decode the  objects before writing:
p59736
aVIf your original log file contains those characters, you wrote binary data to that log file instead
p59737
aVYou can re-interpret those lines as bytes objects by using the  utility function:
p59738
aVtakes strings that represent Python literals and turns them back into Python objects just like the Python compiler would
p59739
as(dp59740
g16
V100297
p59741
stp59742
a((dp59743
g2
(lp59744
VBecause setting an attribute on a function object does not create a local name
p59745
aVReference it on the function object within the function too:
p59746
aVor make it a global
p59747
aVBetter still, avoid such shenanigans and just make  a local or a function argument, and return  at the end of the function to the caller
p59748
as(dp59749
g16
V100297
p59750
stp59751
a((dp59752
g2
(lp59753
VYou already have newlines in the element, so just print that:
p59754
aVYou can split out the string into separate elements by using :
p59755
aVShould you require the times and activities as separate strings, split each line on the string :
p59756
as(dp59757
g16
V100297
p59758
stp59759
a((dp59760
g2
(lp59761
VCombine it in one with a conditional expression:
p59762
aVYou don't need to test for  here;  already does this for you
p59763
aVA little more readable would be to separate out the end value into a variable:
p59764
as(dp59765
g16
V100297
p59766
stp59767
a((dp59768
g2
(lp59769
VJust turn the integers into  directly:
p59770
aVThe sequence of integers is directly interpreted as byte values
p59771
as(dp59772
g16
V100297
p59773
stp59774
a((dp59775
g2
(lp59776
VUse the  function to combine the two lists:
p59777
aVDemo:
p59778
aVpairs up elements from lists into a sequence of tuples; the  constructor takes a sequence of tuples and interprets them as key-value pairs
p59779
as(dp59780
g16
V100297
p59781
stp59782
a((dp59783
g2
(lp59784
VPython looks up names as globals by default; only names assigned to in functions are looked up as locals (so any name that is a parameter to the function or was assigned to in the function)
p59785
aVYou can see this when you use the  function to decompile code objects or functions:
p59786
aVloads  as a global name, only looking in the globals namespace
p59787
aVThe  opcode uses the current namespace (function locals) to look up names by index (function local namespaces are highly optimized and stored as a C array)
p59788
aVThere are three more opcodes to look up names;  (reserved for true constants, such as  and literal definitions for immutable values),  (to reference a closure) and
p59789
aVThe latter does look at both locals and globals and is only used when a function code object could not be optimized, as  is a lot slower
p59790
aVIf you really wanted  to be looked up in , you'd have to force the code to be unoptimised; this only works in Python 2, by adding a  call (or  statement):
p59791
aVNow  is used for  because for all Python knows, the  call added that name as a local
p59792
aVEven in this case, the locals  looks into, will be the locals of the function itself, and not the locals passed to , which are for only for the parent scope
p59793
as(dp59794
g16
V100297
p59795
stp59796
a((dp59797
g2
(lp59798
VI'd use:
p59799
aVThis matches the  as well, which you omitted
p59800
aVDemo:
p59801
as(dp59802
g16
V100297
p59803
stp59804
a((dp59805
g2
(lp59806
VRemove the  call
p59807
aVin Python 2 is the equivalent of  in Python 3, and if you need to use  in Python 2 then in Python 3 you need to remove the  call
p59808
aVYou'll have to parse the input yourself;  is not a valid Python operator, you cannot use  to solve that Codeforces problem
p59809
aVThe simplest way to solve the posted problem is to read the input line by line:
p59810
as(dp59811
g16
V100297
p59812
stp59813
a((dp59814
g2
(lp59815
VYou retrieved a list of rows, and each row is a tuple of columns
p59816
aVAs each row contains only one column the rows are tuples with one value each
p59817
aVIn python, it is the comma that makes an expression a tuple, even if there is only one element:
p59818
aVSimply select the first element of each row:
p59819
as(dp59820
g16
V100297
p59821
stp59822
a((dp59823
g2
(lp59824
VYou indented the  and  methods too far; they are nested functions inside of the  class
p59825
aVNote that you are never making instances; you are instead creating multiple references to the class
p59826
aVCall* the class to produce an instance:
p59827
aVand then you don't have to pass in an explicit argument for  either:
p59828
as(dp59829
g16
V100297
p59830
stp59831
a((dp59832
g2
(lp59833
V should not be listed in the  attribute of the class; slots cannot refer to methods as each slot is implemented by a descriptor object instead
p59834
aVThere is a pull request in the project repository that fixes that specific problem
p59835
aVIt simply removes the  string from the  definition
p59836
aVDo note that the authors of the package have abandoned the project:
p59837
aVDEVELOPMENT STOPPED - 03
p59838
aV01
p59839
aV2011
p59840
aVI doubt that there will ever be a stable version of xlwt3
p59841
as(dp59842
g16
V100297
p59843
stp59844
a((dp59845
g2
(lp59846
VYou missed a closing parenthesis:
p59847
as(dp59848
g16
V100297
p59849
stp59850
a((dp59851
g2
(lp59852
VUse a dictionary:
p59853
aVAlternatively, look up the name as an attribute on the module:
p59854
aVprovided the names match those defined on the module
p59855
as(dp59856
g16
V100297
p59857
stp59858
a((dp59859
g2
(lp59860
VYou are using the  bitwise OR operator
p59861
aVYou are probably looking for the  operator instead
p59862
aVis the boolean OR operator
p59863
aVNote that  is deprecated, you want to use  really
p59864
aVIn Python, the  type is a subclass of , with  equal to 1 and  equal to 0, thus using a bitwise operator on  and  has the same output as if these values were integers instead:
p59865
aVbut because  has a higher precedent than  (or ) it is executed first:
p59866
aVshort circuits, it returns the first expression value that is boolean true-ish (non-empty for collections, non-zero for numeric values)
p59867
as(dp59868
g16
V100297
p59869
stp59870
a((dp59871
g2
(lp59872
VSeek back 256 bytes from the end (using ) and truncate the file (with )
p59873
aVAdding a  is probably prudent:
p59874
as(dp59875
g16
V100297
p59876
stp59877
a((dp59878
g2
(lp59879
VUse a  object instead; the  module has been deprecated and is not comparable with the built-in types:
p59880
aVFrom the documentation for the  module:
p59881
aVDeprecated since version 2
p59882
aV6: The built-in / types replace this module
p59883
aVIf you are stuck with code using the  module, stick to its types exclusively when comparing:
p59884
aVPython  and  do accept any sequence for many of the operators and functions, so inverting your test also works:
p59885
aVThe same applies to the  function on the  and  classes:
p59886
aVbut not mixing the deprecated types and the new built-ins is entirely the best option
p59887
as(dp59888
g16
V100297
p59889
stp59890
a((dp59891
g2
(lp59892
V is a utility class factory function provided by the  library to make it easier to develop code for both Python 2 and 3
p59893
aVIt creates a base class with the specified meta class for you, compatible with the version of Python you are running the code on
p59894
aVQuoting from the documentation:
p59895
aVCreate a new class with base class base and metaclass metaclass
p59896
aVThis is designed to be used in class declarations like this:
p59897
aVThis is needed because the syntax to attach a metaclass changed between Python 2 and 3:
p59898
aVPython 2:
p59899
aVPython 3:
p59900
aVThe  function makes use of the fact that metaclasses are a) inherited by subclasses, and b) a metaclass can be used to generate new classes; it effectively creates a new base class by using the metaclass as a factory to generate an empty class:
p59901
aVThe  base class's metaclass is , both on Python 2 and 3
p59902
as(dp59903
g16
V100297
p59904
stp59905
a((dp59906
g2
(lp59907
VThe line  results in the property setter being invoked
p59908
aVThe property setter tries to set , which results in the property setter being invoked
p59909
aVThe property setter tries to set , which results in the property setter being invoked
p59910
aVThe property setter tries to set , which results in the property setter being invoked
p59911
aVThe property setter tries to set , which results in the property setter being invoked
p59912
aVThe property setter tries to set , which results in the property setter being invoked
p59913
aVThe property setter tries to set , which results in the property setter being invoked
p59914
aVThe property setter tries to set , which results in the property setter being invoked
p59915
aVThe property setter tries to set , which results in the property setter being invoked
p59916
aVInfinite recursion detected
p59917
aVWhen your property is not named , this obviously does not happen
p59918
aVTo be explicit: Python sees the line  as a  opcode:
p59919
aVThe implementation for  will first look for a data descriptor on the class, and finds your   object
p59920
aVThe call is then effectively translated to:
p59921
aVThe  object looks up the configured setter function, which is  and calls it as
p59922
aVThis in turn calls  again and recursion takes over from there
p59923
as(dp59924
g16
V100297
p59925
stp59926
a((dp59927
g2
(lp59928
VRemember the previous item and keep picking a new choice until it differs:
p59929
aVUse this as a generator:
p59930
aVUsing  makes it easier to pick just 100:
p59931
as(dp59932
g16
V100297
p59933
stp59934
a((dp59935
g2
(lp59936
VSQLite copies unmodified pages of data in a temporary rollback journal file, and applies your changes to in memory copies of those same pages
p59937
aVWhen you make enough changes so that memory becomes a problem, changes are flushed out to the original database
p59938
aVThe rollback journal is used to roll back incomplete transactions
p59939
aVHow different databases handle the rollback journal depends heavily on the database implementation
p59940
aVAn ACID compliant database will have to store uncommitted transaction data somewhere, and a disk-backed journal is an obvious choice
p59941
aVThe SQLite documentation includes an exhaustive explanation on how exactly it implements transactions
p59942
as(dp59943
g16
V100297
p59944
stp59945
a((dp59946
g2
(lp59947
VIn Python 2, when comparing different types, python sorts numeric types before everything else, and between the rest sorts types by type name
p59948
aVThus, integers sort before tuples, but instances of class  will sort after instances of class
p59949
aVPython 3 does away with this madness; comparing different types results in a TypeError instead:
p59950
aVThe Python  type has overloaded the  operator by implementing the  or 'greater then' magic method; it is called for the  expression because the  type has no , lower-then and Python tests the inverse in that case; after all,  is true if  is true
p59951
aVThe  hook raises a  when the other operand is not a :
p59952
aVThe overloaded  (greater then) operator for sets is used to test if the left-hand operand is a proper superset of the right-hand operand
p59953
aV(Technically,  objects implement the C-API  function, not the  hook directly, but the  hook translates to a  call in that case automatically)
p59954
aVWhen an overloaded comparison method (one of , , , , , , or ) returns the  singleton object this signals that the comparison is not supported and Python falls back to the default behaviour
p59955
aVThis default behaviour, as already stated in How do Python comparison operators < and > work with a function name as an operand
p59956
aVdiffers between Python 2 and 3
p59957
aVFor Python 3, a comparison hook returning  causes Python to raise :
p59958
aVPython 2 is more stubborn and when  is returned or no hooks have been implemented, the C code ends up in the  C function, which:
p59959
aVOrders by memory addresses when the types of both objects are the same (line 768-776)
p59960
aVOrders  before anything (line 780-783)
p59961
aVOrders numbers before other types ( tests set type name to empty, lines 786-793)
p59962
aVOrders by typename ( and  in lines 786-793)
p59963
aVIf the type names are the same, orders by memory address of the type objects (lines 800 and 801)
p59964
as(dp59965
g16
V100297
p59966
stp59967
a((dp59968
g2
(lp59969
VThe  method returns the altered named tuple instance
p59970
aVYou are discarding the returned value
p59971
aVLike tuples, namedtuple-derived class instances are immutable, and  does not change the value in-place
p59972
aVReplace the original value with the new:
p59973
as(dp59974
g16
V100297
p59975
stp59976
a((dp59977
g2
(lp59978
VYou are conflating thruthness with equality; they are not the same thing
p59979
aVUse  if you need to compare to actual  and  values:
p59980
aVYou generally do not compare directly with  or
p59981
aVRather, you use conditional expressions or statements:
p59982
aVOnly empty containers, numeric zero and  and  are falsey, everything else is thruthy; you can use  to test for that condition explicitly
p59983
aVYou can make custom types  look like empty containers by implementing  and returning , or look like a number by implementing * and returning  when the instance is to be the boolean equivalent of numeric zero
p59984
aV*In Python 3, use  instead
p59985
as(dp59986
g16
V100297
p59987
stp59988
a((dp59989
g2
(lp59990
VLoop over the lines, using :
p59991
aVThis uses  to keep track of the  position, putting the whole ascii-art string on the screen starting at position (2, 2)
p59992
as(dp59993
g16
V100297
p59994
stp59995
a((dp59996
g2
(lp59997
VYou have to split your lines into words and test each word:
p59998
aVThis (ab)uses the fact that the Python boolean is a subclass of  and  == 1 and  == 0
p59999
aVYou can make it more explicit with a filter:
p60000
aVYou may want to combine both counts into one loop however:
p60001
aVNote that you should never use a blanket except statement; just catch the specific exception instead
p60002
as(dp60003
g16
V100297
p60004
stp60005
a((dp60006
g2
(lp60007
VUse the  method to join strings together with an  delimiter:
p60008
aVDemo:
p60009
aVHowever, it looks as if you are building a SQL query; don't interpolate the values in that case, use SQL parameters instead:
p60010
aVand then use  to pass the parameters to the database adapter
p60011
aVCheck what format your database adapter uses; some use  (C sprintf style) and others use  as placeholders
p60012
as(dp60013
g16
V100297
p60014
stp60015
a((dp60016
g2
(lp60017
VYou need to create a new dictionary in the loop:
p60018
aVotherwise you keep assigning the same object and change it in the loop over and over again
p60019
aVYou were only storing a reference to an existing dictionary in , not a copy
p60020
aVYou can create multiple references to a dictionary, and any changes are visible through all those references:
p60021
aVThe expression  only stores a reference to  under a given key in , and all those references point to the same object
p60022
aVBy moving the  and  lines into the loop, you create new dictionaries each iteration
p60023
aVAnother method of ensuring you are creating a reference to a new dictionary is by creating a copy of it with the  method, but creating a new dictionary here is preferable
p60024
aVYou may want to give your variables better names as well; instead of ,  and , perhaps you want to use ,  and  instead
p60025
as(dp60026
g16
V100297
p60027
stp60028
a((dp60029
g2
(lp60030
VThe  is only loaded when you are import the package
p60031
aVYou are instead treating the directory as a script, by executing the directory
p60032
aVYou can still treat the package as a script, instead of the directory however
p60033
aVTo both treat the directory as a package and as the main script, by using the  switch:
p60034
as(dp60035
g16
V100297
p60036
stp60037
a((dp60038
g2
(lp60039
VYou are reading a large file into memory in one go
p60040
aVDon't do that, read it in chunks and update the hash as you go along:
p60041
aVThis opens the file in binary mode, avoiding interpreting different line-ending conventions (which would alter the hash)
p60042
aVThe above code uses the two-argument form of the  function, where the second argument is the sentinel value; iteration stops when the first argument, a callable, returns the second argument
p60043
aVPython file objects return an empty string when EOF is reached
p60044
as(dp60045
g16
V100297
p60046
stp60047
a((dp60048
g2
(lp60049
VKeyword arguments are stored in a dictionary, and dictionary order (e
p60050
ag1298
aVarbitrary, based on the hashing algorithm, hash collisions and insertion history) applies
p60051
aVFor your first sample, a dictionary with both  and  keys results in  being listed first:
p60052
aVNote that the  literal dict notation inserts keys from right-to-left, while keyword parsing inserts keywords from left-to-right (this is a CPython implementation detail); hence the use of the  constructor in the above example
p60053
aVThis matters when two keys hash to the same slot, like  and :
p60054
aVDictionary output order is highly dependent on the insertion and deletion history and the specific Python implementation; Python 3
p60055
aV3 introduced a random hash seed to prevent a serious denial of service vector, for example, which means that the dictionary order will be radically different even between Python processes
p60056
as(dp60057
g16
V100297
p60058
stp60059
a((dp60060
g2
(lp60061
VYour expression is too greedy
p60062
aVReign it in:
p60063
aVHowever, the better approach is to use a proper HTML parser, like BeautifulSoup:
p60064
aVfinds all  tags with a  attribute, for example
p60065
as(dp60066
g16
V100297
p60067
stp60068
a((dp60069
g2
(lp60070
VTurn the integer to a string explicitly then:
p60071
aVor use string formatting:
p60072
aVYou cannot just concatenate a string () and an integer (the number between  and ) referenced by
p60073
as(dp60074
g16
V100297
p60075
stp60076
a((dp60077
g2
(lp60078
VYou are using a dictionary to enumerate your replacement patterns
p60079
aVDictionaries return keys and values in arbitrary ordering
p60080
aVAs such, the  ->  replacement takes place before the  ->  replacement
p60081
aVThis replacement works for partial words too
p60082
aVThe solution would be to sort the keys in reverse order of length to ensure that longer matches are replaced first:
p60083
aVDemo:
p60084
as(dp60085
g16
V100297
p60086
stp60087
a((dp60088
g2
(lp60089
VNo entry results in an empty string; empty strings (like empty containers and numeric zero) tests as boolean false; simply test for :
p60090
aVYou may want to strip the string of all whitespace to avoid breaking when only spaces or tabs are entered:
p60091
aVYou still need to verify that the user entered a valid integer, however
p60092
aVYou can catch the  exception:
p60093
as(dp60094
g16
V100297
p60095
stp60096
a((dp60097
g2
(lp60098
VDocstrings are just string literals that are found at the start of the function
p60099
aVThey still have to follow indentation rules
p60100
aVYour string is not correctly indented for the  block; by being de-dented from the  block before, you ended the -- blocks altogether and no  is permitted to follow
p60101
aVUse a regular, normal comment instead, a line starting with ; lines that contain only comments are exempt from the indentation rules:
p60102
aVor indent the string (which is entirely still executed by Python as code, but otherwise not assigned and thus discarded again):
p60103
as(dp60104
g16
V100297
p60105
stp60106
a((dp60107
g2
(lp60108
VIf you need to receive multiple lines of input interactively from a user through a terminal, use the  function in a loop:
p60109
aVHowever, if you are reading from a pipe (your script being used to recieve piped data from something else), read from  instead of using  as you can just use that as a file object:
p60110
aVor read it all into a list in one go:
p60111
aVIn both cases you get lines as a sequence, and you can simply use  to count the number of lines
p60112
as(dp60113
g16
V100297
p60114
stp60115
a((dp60116
g2
(lp60117
V and  both use the  attribute of a module to limit what is imported or documented
p60118
aVNote that  is generally considered bad practice unless you are building a central API for a package with the implementation dispersed over various contained modules
p60119
as(dp60120
g16
V100297
p60121
stp60122
a((dp60123
g2
(lp60124
Vglobals are only global to their own module, not across the Python interpreter
p60125
aVPass in the  name as a function parameter instead:
p60126
aVwhere the  function has been redefined to accept a parameter:
p60127
aVNote that the  keyword only has any effect when used in a function; it tells the Python compiler that a name in a function is to be assigned to globally, not locally
p60128
aVNames at the module level are already global
p60129
aVThe  line in  is a no-op, it does nothing, and can be removed altogether
p60130
as(dp60131
g16
V100297
p60132
stp60133
a((dp60134
g2
(lp60135
VYour code is working just fine, but you are extracting the files to the current working directory
p60136
aVWhat that directory is depends on how you started your program
p60137
aVYou most likely want to explicitly specify a directory to extract the zipfile to
p60138
aVThe directory the user choose is a good point to start:
p60139
as(dp60140
g16
V100297
p60141
stp60142
a((dp60143
g2
(lp60144
VYou split on all spaces, then rejoin the pairs:
p60145
aVDemo:
p60146
as(dp60147
g16
V100297
p60148
stp60149
a((dp60150
g2
(lp60151
VBecause  is the same value as :
p60152
aVYou are referring to the same index, the first value the list
p60153
aVThere is no such thing as negative integer zero
p60154
aVPerhaps you were looking for  instead
p60155
aVNegative integers select from the end:
p60156
as(dp60157
g16
V100297
p60158
stp60159
a((dp60160
g2
(lp60161
VThis is a limit to CPython function definitions; you cannot specify more than 255 explicit arguments to a callable
p60162
aVThis applies to any function definition, not just named tuples
p60163
aVIt is the generated code for the class that is hitting this limit
p60164
aVYou cannot define a function with more than 255 arguments; the  class method of the resulting class is thus not achievable in the CPython implementation
p60165
aVYou'll have to ask yourself, however, if you really should be using a different structure instead
p60166
aVIt looks like you have a list-like piece of data to me; 400 numbered names is a sure sign of your data bleeding into your names
p60167
aVYou can work around this by creating your own subclass, manually:
p60168
aVThis version of the named tuple avoids the long argument lists altogether, but otherwise behaves exactly like the original
p60169
aVThe somewhat verbose  method is not strictly needed but does emulate the original behaviour when arguments are incomplete closely
p60170
aVNote the construction of the  attribute; replace this with your own to name your tuple fields
p60171
aVPass in a generator expression to set your arguments:
p60172
aVor if you have a list of values:
p60173
aVEither technique bypasses the limits on function signatures and function call argument counts
p60174
aVDemo:
p60175
as(dp60176
g16
V100297
p60177
stp60178
a((dp60179
g2
(lp60180
VReplace  with a dictionary; it is the membership testing against a list, as well as the  calls that are costing you the most performance; both require scans across the list
p60181
aVUse  to concatenate a series of characters; that builds one new string object instead of N new objects:
p60182
aVDictionary membership tests and lookups are O(1) constant cost; by building the dictionary with  values you can avoid multiple  calls per value; depending on how many values are re-used it could be faster to use  instead and move the  call to the list comprehension
p60183
as(dp60184
g16
V100297
p60185
stp60186
a((dp60187
g2
(lp60188
VThe terminal 'color palette' is set by the terminal application itself to map default curses colours to application-specific 'interpretations'
p60189
aVIf you use red, the terminal can choose to display that as burgundy or cherry red, or if the user so desires, something completely different
p60190
aVIn other words, just use the curses colours (combined with or without the bright or blink modifiers) and things should Just Work
p60191
aVI believe that the  call merely makes transparency available; it is a direct call to the  ncurses API function
p60192
aVncurses colors are otherwise palette based; you need to set your own color attributes per pair number with  calls, then select a color pair with  from the palette to display text with that specific pair; or build text attributes directly for a given  call
p60193
as(dp60194
g16
V100297
p60195
stp60196
a((dp60197
g2
(lp60198
VCall  on the dictionary instead:
p60199
aVIn Python 3, the  method returns a dictionary view object, which acts as a set
p60200
aVIterating over the dictionary directly also yields keys, so turning a dictionary into a list results in a list of all the keys:
p60201
as(dp60202
g16
V100297
p60203
stp60204
a((dp60205
g2
(lp60206
VWhen an iterator is exhausted, it raises  when  is called on it
p60207
aVThus, the  will propagate the  exception to the caller, interrupting the infinite loop
p60208
as(dp60209
g16
V100297
p60210
stp60211
a((dp60212
g2
(lp60213
VYour code never represents cards as mere strings
p60214
aVInstead, you are using instances of the class :
p60215
aVYou'll need to test against the  attribute instead:
p60216
aVNote that  is always a string, so you'll need to turn it into an integer when it is a number card
p60217
aVI've assumed that that is the goal of the  branch, in any case
p60218
aVYour code in that function can be greatly simplified:
p60219
aVAlternatively, you could just use the  mapping you already have:
p60220
as(dp60221
g16
V100297
p60222
stp60223
a((dp60224
g2
(lp60225
VBeautifulSoup results are not strings; they are  objects, mostly
p60226
aVLook for the text of the  tags, use the  attribute:
p60227
aVThis finds the first  link in a table
p60228
aVTo find all text of all links:
p60229
as(dp60230
g16
V100297
p60231
stp60232
a((dp60233
g2
(lp60234
VTo sort a list of lists on the second column, use  for ease and clarity:
p60235
aVor, to sort in-place:
p60236
aVis a little faster than using a  for the task
p60237
aVDemo:
p60238
aVYou'd only see your exception if you had floating point values in your inputlist directly:
p60239
aV(for Python 3; Python 2's error message is slightly different, resulting in  instead)
p60240
aVThis is because the  call is applied to all elements in the outer list but only works on nested ordered sequences, not on the one floating point value now added
p60241
as(dp60242
g16
V100297
p60243
stp60244
a((dp60245
g2
(lp60246
VYou are appending to the save file, and you need to overwrite instead:
p60247
aVThe  code otherwise encounters multiple JSON values and it cannot handle more than one in the file
p60248
as(dp60249
g16
V100297
p60250
stp60251
a((dp60252
g2
(lp60253
VNote that the OS assigns memory in chunks, and doesn't necessarily reclaim it all in one go
p60254
aVI've found the memory profiling package to be wildly inaccurate because it appears it fails to take that into account
p60255
aVYour  slice creates a new list with (2*10**7) - 1 elements, nearly a whole new copy, easily doubling the memory space required for the lists
p60256
aVThe  call also returns a full new list object, the output of the zipping action, again requiring memory for the intermediary result, plus 20 million 2-element tuples
p60257
aVYou could use a new iterator instead of slicing:
p60258
aVThe list iterator returned from the  call is much more light-weight; it only keeps a reference to the original list and a pointer
p60259
aVCombining this with  avoids creating the output list as well
p60260
as(dp60261
g16
V100297
p60262
stp60263
a((dp60264
g2
(lp60265
VYou are looking for  instead:
p60266
aVor, alternatively printing the letters in sorted order:
p60267
aVsorts the results by counts, descending
p60268
aVon the other hand returns a sorted list of the keys of the  dictionary, so that version more closely matches your attempted output
p60269
aVYour code instead used  to count each letter every time you encountered it
p60270
aVYou'd normally use a dictionary to track counts and avoid using the full scan of :
p60271
as(dp60272
g16
V100297
p60273
stp60274
a((dp60275
g2
(lp60276
VUse  to remove codepoints; any codepoint mapping to  is removed:
p60277
aVThe  class method makes it easy to create a dictionary mapping all keys to
p60278
aVDemo:
p60279
aVAdjusted to your code:
p60280
as(dp60281
g16
V100297
p60282
stp60283
a((dp60284
g2
(lp60285
VThe purpose of  is to either return  or raise an exception if the exit status of the called process was not 0:
p60286
aVRun command with arguments
p60287
aVWait for command to complete
p60288
aVIf the return code was zero then return, otherwise raise
p60289
aVUse  instead if you need to read the output of the other command:
p60290
aVRun command with arguments and return its output as a byte string
p60291
aVThe function was added in Python 2
p60292
aV7; if you are using an earlier version of Python, here is a backport:
p60293
as(dp60294
g16
V100297
p60295
stp60296
a((dp60297
g2
(lp60298
VDon't use  in this case
p60299
aVIf you need to have a time duration, convert to a  and use its  method to work into a milisecond value:
p60300
aVDemo:
p60301
as(dp60302
g16
V100297
p60303
stp60304
a((dp60305
g2
(lp60306
VIt means your set is empty, and the set is empty because your  function will read from a file object that has already been read from before
p60307
aVYou are opening the file as part of the function definition, which means you can only read it once
p60308
aVDo not use function default parameters for expressions you want to be evaluated each time the function is called
p60309
aVSee "Least Astonishment" in Python: The Mutable Default Argument
p60310
aVDo this instead:
p60311
aVNow the function opens the file object each time the function is called and starts reading from the first byte again
p60312
aVThe  parameter is now a immutable string, used to open the file object when running the function instead of when defining the function
p60313
aVCorrecting a few other issues:
p60314
aVThe  call will pull in that first line for us (the headers) and any further looping over  will continue from the next line
p60315
aVDon't use ; it is deprecated
p60316
aVYou could test for  or  or  instead ( in order of preference)
p60317
aVDon't use  when  or  will do just fine
p60318
aVUse  to close files automatically when done with the block of code
p60319
as(dp60320
g16
V100297
p60321
stp60322
a((dp60323
g2
(lp60324
VYou do not need to provide your own wrapper anymore, just use  on the inner function, which takes one extra first positional argument, the function wrapped:
p60325
aVThe  package doesn't use a closure for decorators and instead passes in the wrapped function as an argument
p60326
aVDemo:
p60327
as(dp60328
g16
V100297
p60329
stp60330
a((dp60331
g2
(lp60332
VUse :
p60333
aVor a simple loop:
p60334
as(dp60335
g16
V100297
p60336
stp60337
a((dp60338
g2
(lp60339
VUse  with empty dictionaries as defaults:
p60340
aVIf the  key is not present, an empty dictionary is returned, so the next chained  will also not find  and return an empty dictionary in turn
p60341
aVThe  test then returns
p60342
aVThe alternative is to just catch the :
p60343
as(dp60344
g16
V100297
p60345
stp60346
a((dp60347
g2
(lp60348
VYou need to accept the input dictionary as a function parameter, and you need to return the reversed result:
p60349
aVBecause a dict comprehension creates a new dictionary altogether, the above is all that is needed; no explicit copy needs to be created
p60350
aVDemo:
p60351
aVAgain, this does not touch the original dictionary:
p60352
as(dp60353
g16
V100297
p60354
stp60355
a((dp60356
g2
(lp60357
VIt's simple enough with Python to read three lines of data at a time:
p60358
aVThe  calls remove any extra whitespace, including the newline at the end of each line of input text
p60359
aVDemo:
p60360
as(dp60361
g16
V100297
p60362
stp60363
a((dp60364
g2
(lp60365
VYou are looking for multisets, really
p60366
aVUse , the Python implementation of a multiset:
p60367
aVDemo:
p60368
aVYou may want to retain the  instances however; but if you need it the  method generates a sequence of elements times their count to produce your desired output again
p60369
as(dp60370
g16
V100297
p60371
stp60372
a((dp60373
g2
(lp60374
VIt is standard practice to only close the connection when the request is complete, yes
p60375
aVPostpone the close to the latest possible moment
p60376
aVUse could use a context manager to handle the closing for you:
p60377
aVthen use:
p60378
aVand the connection will be closed automatically after the  statement has been processed
p60379
as(dp60380
g16
V100297
p60381
stp60382
a((dp60383
g2
(lp60384
VYou need to create the directory  for this to work
p60385
aVOpening a file with  does not create directories for you
p60386
aVIt only signals that you want to open a file for both reading and writing and that it should be cleared (truncated) first
p60387
aVUse the  function if you also need to create parent directories
p60388
aVFor your  loop, I'd leave off the  altogether
p60389
aVJust dedent the  line instead
p60390
aVYour second error is for a URL being opened as a local file
p60391
aVCheck the URL, it points to a file on your harddisk that does not exist
p60392
as(dp60393
g16
V100297
p60394
stp60395
a((dp60396
g2
(lp60397
VUse proper string formatting, use single quotes for the formatting string and simply include the quotes:
p60398
aVThe alternative is to pass in a list of arguments and have Python take care of quoting for you:
p60399
aVWhen the first argument to  is a list, Python uses the process described under the section Converting an argument sequence to a string on Windows
p60400
aVOn Windows, an args sequence is converted to a string that can be
p60401
aVparsed using the following rules (which correspond to the rules used
p60402
aVby the MS C runtime):
p60403
aVArguments are delimited by white space, which is either a space or a tab
p60404
aVA string surrounded by double quotation marks is interpreted as a single argument, regardless of white space contained within
p60405
aVA quoted
p60406
aVstring can be embedded in an argument
p60407
aVA double quotation mark preceded by a backslash is interpreted as a literal double quotation mark
p60408
aVBackslashes are interpreted literally, unless they immediately precede a double quotation mark
p60409
aVIf backslashes immediately precede a double quotation mark, every pair of backslashes is interpreted as a literal backslash
p60410
aVIf the
p60411
aVnumber of backslashes is odd, the last backslash escapes the next
p60412
aVdouble quotation mark as described in rule 3
p60413
aVThis means that passing in your arguments as a sequence makes Python worry about all the nitty gritty details of escaping your arguments properly, including handling embedded backslashes and double quotes
p60414
as(dp60415
g16
V100297
p60416
stp60417
a((dp60418
g2
(lp60419
VThe  function returns a string value, but  is an integer
p60420
aVComparing strings to numbers always ends up with Python 2 ordering numbers as smaller than strings
p60421
aVConvert the result of  to an integer:
p60422
aVThis may throw a  exception if the input given is not a valid number; you may want to catch that exception and tell the user to enter a number instead:
p60423
as(dp60424
g16
V100297
p60425
stp60426
a((dp60427
g2
(lp60428
VYour second regular expression doesn't match:
p60429
aVbecause it starts with a space
p60430
aVRemove that initial space and it works fine:
p60431
aVThe exception you see is thrown because the  method receives positional arguments as a tuple, tries to look up item 0 and as it was passed an empty set of arguments you get the
p60432
as(dp60433
g16
V100297
p60434
stp60435
a((dp60436
g2
(lp60437
VUse  to read and write Unicode values instead:
p60438
aVRenaming codec files is the last thing you should do
p60439
as(dp60440
g16
V100297
p60441
stp60442
a((dp60443
g2
(lp60444
VJust loop over the dictionary and test if all items match:
p60445
aVwhere  is your dictionary
p60446
aVIf  is a dictionary as well, you can test if  is a superset of :
p60447
aVDemo:
p60448
aVThis all assumes Python 2; in Python 3, replace both  and  with  calls
p60449
as(dp60450
g16
V100297
p60451
stp60452
a((dp60453
g2
(lp60454
VYour  class requires 3 arguments to initialize, you passed in none
p60455
aVYou named the method  (with capital ) but try to call  (all lowercase)
p60456
aVBoth are simple to correct:
p60457
aVYou do not have to name attributes for your class as parameters to the  function either
p60458
aVThe  method overrides any attributes set, for example, so why ask them to be set in  in the first place
p60459
as(dp60460
g16
V100297
p60461
stp60462
a((dp60463
g2
(lp60464
VRead the file only once, and turn the set into a list; the  implementation already turns a set into tuple just to be able to pick a sample
p60465
aVAvoid that overhead and just use  instead:
p60466
aVNo need to call  because you already converted the read values
p60467
aVThis at least speeds up picking a random value on repeat calls to
p60468
aVIf you need to call this only once per run of your program, there is no way around this other than creating a simpler file with just the unique book values
p60469
as(dp60470
g16
V100297
p60471
stp60472
a((dp60473
g2
(lp60474
VIn a set of  -  -  statements, Python will only ever execute one of the suites
p60475
aVThe first  or  condition to return  determines what block is picked; if none match then  is executed
p60476
aVInstead of , use  to start a new block:
p60477
aVNow it is a separate  suite and will be tested separately from the preceding
p60478
aVNote that you don't need to use  to index from the end; negative indices achieve the same:
p60479
aVThis achieves the same result (albeit just setting ) without the need for the  length variable
p60480
as(dp60481
g16
V100297
p60482
stp60483
a((dp60484
g2
(lp60485
VSum the values:
p60486
aVDemo:
p60487
as(dp60488
g16
V100297
p60489
stp60490
a((dp60491
g2
(lp60492
VYou are returning the string version of the python data structure
p60493
aVReturn an actual JSON response instead; leave the values as Unicode:
p60494
aVNow Java does not have to interpret Python escape codes, and can instead parse valid JSON instead
p60495
as(dp60496
g16
V100297
p60497
stp60498
a((dp60499
g2
(lp60500
VPython objects have a minimal size, the overhead of keeping several pieces of bookkeeping data attached to the object
p60501
aVA Python  object is no exception
p60502
aVTake a look at the difference between a string with no, one, two and three characters:
p60503
aVThe Python  object overhead is 37 bytes on my machine, but each character in the string only takes one byte over the fixed overhead
p60504
aVThus, a  value with 1000 million characters requires 1000 million bytes + 37 bytes overhead of memory
p60505
aVThat is indeed about 0
p60506
aV931 gigabytes
p60507
aVYour sample code 'B' created ten times more characters, so you needed nearly 10 gigabyte of memory just to hold that one string, not counting the rest of Python, and the OS and whatever else might be running on that machine
p60508
as(dp60509
g16
V100297
p60510
stp60511
a((dp60512
g2
(lp60513
V uses the globals of the module it is executed in
p60514
aV'lives' in the  global namespace, so any expression executed by  uses the same namespace as that function and thus can resolve ,  and
p60515
aVImporting a function does not alter its namespace; the globals for  don't change merely by being called from
p60516
aVIf it did, any imports in  would also need to be imported into , for each and every function you ever wanted to use
p60517
aVThat would be incredibly impractical
p60518
aVYou can even see the globals for functions you import;  will show you the exact namespace of
p60519
as(dp60520
g16
V100297
p60521
stp60522
a((dp60523
g2
(lp60524
VYou could generate the summer dates:
p60525
aVThis use a  object instead of a , as the time portion is irrelevant here
p60526
aVThe  calls make sure we reuse the current year
p60527
aVThis all assumes, of course, that summer semester starts and ends on the same dates each year
p60528
aVDemo:
p60529
as(dp60530
g16
V100297
p60531
stp60532
a((dp60533
g2
(lp60534
VIt is only of use to the Python test suite;  prints:
p60535
aVYou probably don't want to use this function
p60536
aVIt exists mainly to be
p60537
aVused in Python's test suite
p60538
aVtypestr must be  or
p60539
aVfmt must be one of ,
p60540
aVor , and in addition can only be
p60541
aVone of the latter two if it appears to match the underlying C reality
p60542
aVOverrides the automatic determination of C-level floating point type
p60543
aVThis affects how floats are converted to and from binary strings
p60544
aVThere is a  as well, the getter method for the same information, same purpose
p60545
aVSee the  test suite for more details on its use
p60546
aVUse the  module to get more accurate decimal calculations, but do check out  for details on how accurate floats are on your platform
p60547
aVMy 64bit Mac OS X system can only manage 15 digits, for example
p60548
as(dp60549
g16
V100297
p60550
stp60551
a((dp60552
g2
(lp60553
VYou'll have to name each parameter explicitly:
p60554
aVThere is no standard for marshalling more complex structures into GET query parameters; the only standard that exists gives you key-value pairs
p60555
aVAs such, the  library doesn't support anything else
p60556
aVYou can of course write your own marshaller, one that takes nested dictionaries or lists and generates a flat dictionary or tuple of key-value pairs for you
p60557
as(dp60558
g16
V100297
p60559
stp60560
a((dp60561
g2
(lp60562
VThe exception is thrown because you have a faulty proxy configuration
p60563
aVOn POSIX systems, the library looks for  environment variables (upper and lowercase)
p60564
aVFor a HTTP URL, that's the  environment variable
p60565
aVYou can verify this by looking for proxy variables:
p60566
aVWhatever value you have configured on your system is not a valid hostname and port combination and Python is choking on that
p60567
as(dp60568
g16
V100297
p60569
stp60570
a((dp60571
g2
(lp60572
VYou didn't define a class, you defined a function with nested functions
p60573
aVUse  to define a class instead:
p60574
aVNote that you need to refer to  in
p60575
aVDemo:
p60576
aVDo note that using a mutable value for a function keyword argument default is generally not a good idea
p60577
aVFunction arguments are defined once, and can lead to unexpected errors, as now all your classes share the same dictionary
p60578
aVSee "Least Astonishment" in Python: The Mutable Default Argument
p60579
as(dp60580
g16
V100297
p60581
stp60582
a((dp60583
g2
(lp60584
VYou need to refer to  to access attributes on your class:
p60585
aVA  method must return a string value, so using  for this is a little
p60586
aVweird
p60587
aVNo need to override the  method, you didn't do anything new in it
p60588
aVYou may want to name your base class something other than  so you don't mask the module (and not need to import it in your  method)
p60589
aVBest practice is to use CamelCase names for classes;  would be a better choice
p60590
aVFor this kind of operation, I'd just use a function instead:
p60591
aVAt best, you'd make  a method on your math class:
p60592
as(dp60593
g16
V100297
p60594
stp60595
a((dp60596
g2
(lp60597
VYou need to use the actual API to get JSON content
p60598
aVis the regular HTML frontend
p60599
aVYou probably wanted to search for repositories:
p60600
aVThis gives me:
p60601
as(dp60602
g16
V100297
p60603
stp60604
a((dp60605
g2
(lp60606
VYou'll need to use a regular expression here, as you only want to match those anchor links that have  in the title, not as the whole title:
p60607
aVThis gives 47 matches for the URL you've given
p60608
as(dp60609
g16
V100297
p60610
stp60611
a((dp60612
g2
(lp60613
VYou cannot refer to a class name while still defining it
p60614
aVThe class body is executed as a local namespace; you can refer to functions and attributes as local names instead
p60615
aVMoreover, default values to function keyword parameters are bound at definition time, not when the method is called
p60616
aVUse  as a sentinel instead
p60617
aVInstead of:
p60618
aVuse:
p60619
aVYou probably wanted to use the class as a factory for instances instead of as a namespace for what are essentially functions
p60620
aVEven if you only used one instance (a singleton) there are benefits in actually creating an instance first
p60621
as(dp60622
g16
V100297
p60623
stp60624
a((dp60625
g2
(lp60626
VThe session machinery takes care of providing you with one connection per thread; since you can only execute sequential code within one thread that connection cannot become a bottleneck
p60627
aVDifferent parts of the code can request their own session; the session machinery will reuse session connections as required
p60628
aVThis is not something you generally have to worry about, that's all handled for you by  and its dependencies
p60629
as(dp60630
g16
V100297
p60631
stp60632
a((dp60633
g2
(lp60634
VBeautifulSoup can use different parsers to handle HTML input
p60635
aVThe HTML input here is a little broken, and the default  parser doesn't handle it very well
p60636
aVUse the  parser instead:
p60637
as(dp60638
g16
V100297
p60639
stp60640
a((dp60641
g2
(lp60642
VUse , it does exactly what you need already, splitting on arbitrary-width whitespace:
p60643
aVNote that the leading whitespace has been removed as well
p60644
aVQuoting the documentation:
p60645
aVIf sep is not specified or is , a different splitting algorithm is applied: runs of consecutive whitespace are regarded as a single separator, and the result will contain no empty strings at the start or end if the string has leading or trailing whitespace
p60646
aVConsequently, splitting an empty string or a string consisting of just whitespace with a  separator returns
p60647
as(dp60648
g16
V100297
p60649
stp60650
a((dp60651
g2
(lp60652
VNo, interned objects are maintained in a range of locations, no one method exists to list them all
p60653
aVStrings can be interned, as you discovered, and you can intern strings yourself by using the  function
p60654
aVSmall integers between -5 and 256 are interned
p60655
aVTuples are reused; the empty tuple () is a singleton, and 2000 each of tuple sizes 1 through to 20 are kept cached for recycling
p60656
aV(Just the tuple objects, not the contents)
p60657
aVis a singleton, as are , ,  and
p60658
aVAs of Python 3
p60659
aV3, instance  dictionaries can share keys to save on memory
p60660
aVThe compiler can mark immutable (and in certain circumstances, mutable) sourcecode literals as constants, store them as such with the bytecode and re-use them each time the bytecode is run
p60661
aVThis applies to strings, numbers, tuples, lists (if used with an  statement) and as of Python 3
p60662
aV2 sets (again, when used with )
p60663
aVThere may be more I haven't discovered yet
p60664
aVThese optimizations all help to avoid too much heap churn
p60665
aVAnd apart from , , ,  and  being a singletons they are all CPython-specific optimisations, they are not part of the Python language definition itself
p60666
as(dp60667
g16
V100297
p60668
stp60669
a((dp60670
g2
(lp60671
VThe  class can handle this without change:
p60672
aVThe  value points to where decoding ended
p60673
as(dp60674
g16
V100297
p60675
stp60676
a((dp60677
g2
(lp60678
V does not have a  method; it is not a type that supports indexing
p60679
aVOnly mutable sequence and mapping objects implement
p60680
aVThe method is normally used to hook into index assignment ()
p60681
aVI suspect you wanted to set an attribute instead; if so, just use  on :
p60682
as(dp60683
g16
V100297
p60684
stp60685
a((dp60686
g2
(lp60687
VYou are passing 3 arguments to :
p60688
aVand it only takes one; only  takes multiple arguments
p60689
aVUse string formatting:
p60690
aVor use string concatenation:
p60691
aVbut that requires you to turn  into a string explicitly
p60692
as(dp60693
g16
V100297
p60694
stp60695
a((dp60696
g2
(lp60697
V is a dictionary, not a list
p60698
aVLoop over the keys:
p60699
aVor you'll get  exceptions
p60700
aVYou may be interested in the  class; it's a counting dictionary:
p60701
as(dp60702
g16
V100297
p60703
stp60704
a((dp60705
g2
(lp60706
VYou can leave that to the  module
p60707
aVJust import ;  with the same key will always return the same object; the following code added to  would log messages to the same logger:
p60708
aVThe logging configuration is global by design
p60709
aVThere is an advantage in just using the current module name as the logging key instead; it lets you tease out what location messages were logged from:
p60710
as(dp60711
g16
V100297
p60712
stp60713
a((dp60714
g2
(lp60715
VJust use :
p60716
aVsplits from the end of a string; with a limit of 1 it'll only split on the very last  in the string and  gives you everything before that last
p60717
aVDemo:
p60718
aVIf there is no  in the string, the original string is returned:
p60719
aVAs for your loop; you are testing against a reversed string and the condition returns  until the last  has been removed; you'd have to test in the loop for what character you just removed:
p60720
aVbut this is rather inefficient compared to using ; creating a new string for each character removed is costly
p60721
as(dp60722
g16
V100297
p60723
stp60724
a((dp60725
g2
(lp60726
VYou have a  character every 20 positions; split your strings into sections of 20 characters, and pair up the results:
p60727
aVZip the results together gives:
p60728
aVFrom there on out you can do what you want with the columns; in the above sample I merely put them together into lists of whitespace-stripped strings
p60729
as(dp60730
g16
V100297
p60731
stp60732
a((dp60733
g2
(lp60734
VThe preceding line has an incorrect count of opening  parenthesis compared to the number of closing parens:
p60735
aVAdd one more closing :
p60736
as(dp60737
g16
V100297
p60738
stp60739
a((dp60740
g2
(lp60741
VYou are rebinding  within the  method; that does not alter the object  referred to before you rebound it
p60742
aVYou simply pointed the local variable at a new object instead
p60743
aVHowever, tuples are immutable, and so are their subclasses
p60744
aVYou cannot alter  anymore by the time  is being called
p60745
aVYou'll need to use a  method here to influence how the instance is created instead;  is the constructor,  is an initializer:
p60746
aVDemo:
p60747
aVNote that the last expression results in a tuple again; slicing the object still returns tuples:
p60748
aVDepending on what you are trying to do, you may need to override some of the container methods
p60749
as(dp60750
g16
V100297
p60751
stp60752
a((dp60753
g2
(lp60754
VUse :
p60755
aVDemo:
p60756
aVThis works for lists as well; it is the most efficient method to create a dictionary from a sequence
p60757
aVNote all values are references to that one default you passed into , so be careful when that default value is a mutable object
p60758
as(dp60759
g16
V100297
p60760
stp60761
a((dp60762
g2
(lp60763
VFunction default values are evaluated when the function is defined, not when it is called
p60764
aVYour default values are set in stone the moment Python loads the module
p60765
aVUse sentinel values instead:
p60766
aVNow the values are set every time the function is called instead
p60767
aVNote that your  function can be improved as well; create a  object, and use the  function to format the date:
p60768
aVThis will return dates as with zeropadded digits; you could also use:
p60769
aVto return non-zero-padded values
p60770
aVDemo:
p60771
as(dp60772
g16
V100297
p60773
stp60774
a((dp60775
g2
(lp60776
VYou are assigning to  instead of using it as a function
p60777
aVRemove the , call the function instead:
p60778
aVDemo:
p60779
aVIf you get a  exception, you still have local variable  bound to a string; in an interactive Python session, simply delete that local variable:
p60780
aVYou'll have to work your way through your homework yourself; put in a little effort yourself and give your teacher something to work with
p60781
aVWe certainly won't do your homework for you, what would be the point in that
p60782
as(dp60783
g16
V100297
p60784
stp60785
a((dp60786
g2
(lp60787
VThe exception is raised
p60788
aVThe  block is executed when the generator is closed
p60789
aVClosing a generator is done by raising a  exception in the generator context
p60790
aVThe exception in ignored because the generator isn't closed until it is being deleted (automatically in this case, when Python exits); the generator  handler closes the generator, which triggers the  block:
p60791
aVExceptions raised during cleanup are always ignored; see the  documentation:
p60792
aVWarning: Due to the precarious circumstances under which
p60793
aVmethods are invoked, exceptions that occur during their execution are
p60794
aVignored, and a warning is printed to  instead
p60795
aVThe solution is to not have exceptions being raised when a generator is cleaned up, or catch the exception by closing the generator explicitly:
p60796
aVYou could also catch the  exception and perform some cleanup at that point:
p60797
aVbut note that any exception other than  or  will always be propagated; see the  documentation:
p60798
aVIf the generator function then raises  (by exiting normally, or due to already being closed) or  (by not catching the exception), close returns to its caller
p60799
aVIf the generator yields a value, a  is raised
p60800
aVIf the generator raises any other exception, it is propagated to the caller
p60801
as(dp60802
g16
V100297
p60803
stp60804
a((dp60805
g2
(lp60806
VWrap your code in a ,  block and call :
p60807
aVYou could add a  statement to that to re-raise the caught exception
p60808
aVDemo:
p60809
aVThe traceback was logged by the  module, not by my interactive Python session
p60810
aVThe traceback leads from the  block to the exception; the  function is the above example is not included
p60811
as(dp60812
g16
V100297
p60813
stp60814
a((dp60815
g2
(lp60816
VA list comprehension with the  function is easiest:
p60817
aVThis applies each separate tuple as an argument to  using the  expansion syntax
p60818
aVthen pairs up each value from each tuple into new tuples
p60819
aVDemo:
p60820
aVThis forces the output to use lists; you can just use straight  if all you need is the 3-value combos:
p60821
aVIn Python 3, use  or just loop over the output
p60822
as(dp60823
g16
V100297
p60824
stp60825
a((dp60826
g2
(lp60827
VI'd use a decent text editor
p60828
aVSublime Text lets me select a block and comment it out;  will be inserted on every line, and another command lets me revert the commenting
p60829
aVIf you are stuck with no decent editor, you could use a triple-quoted string:
p60830
aVThis will create a giant string object, that is then not assigned to anything
p60831
aVYou do need to make sure that the opening quotes are indented properly, and that the line following the closing quotes has valid indentation too
p60832
aVOf course, this presumes that you don't have a triple-quoted string using the same quoting style in those 500 lines already; you can capture  blocks in  quotes and vice-versa, but if you have existing text blocks using both styles, you'll have to escape those manually
p60833
as(dp60834
g16
V100297
p60835
stp60836
a((dp60837
g2
(lp60838
VYou are confusing Python byte literal syntax here; you do not need to generate the literal syntax, just the byte value; the  type accepts a sequence of integers too:
p60839
aVApplied to your code:
p60840
aVor, simpler still:
p60841
aVusing literal hex integer notation
p60842
aVDemo for :
p60843
aVThe  function outputs 4 characters per byte; starting with a literal  followed by the hex representation of the integer number
p60844
aVEncoded to UTF8 that's still 4 bytes,  for the integer value , for example, versus  for the actual byte you wanted
p60845
as(dp60846
g16
V100297
p60847
stp60848
a((dp60849
g2
(lp60850
VYou can use  to test if the string can be converted:
p60851
aVA generator expression is enough here, no need to create an intermediary list
p60852
aVDemo:
p60853
aVNote that  also tolerates whitespace; if you suspect your input list has whitespace around the numbers, you can add a  call too to widen the net a little:
p60854
aVIf you need to support signed values too (an initial  or ) you could try:
p60855
aVfor an even more exhaustive test
p60856
aVis a little more tolerant still but this is more than close enough for most cases; if you want to capture each and every possibility you'd have to resort to regular expressions
p60857
aVDemo:
p60858
as(dp60859
g16
V100297
p60860
stp60861
a((dp60862
g2
(lp60863
V,  and  are not valid values for the  keyword; see Standard option actions for what is available
p60864
aVIt is not clear what you expect those options to do, however
p60865
aVYou specified the destination as , but that is already in use as a boolean flag for the ,  option
p60866
aVIf you wanted to set boolean flags for each of these in their  options, then do so with  actions:
p60867
as(dp60868
g16
V100297
p60869
stp60870
a((dp60871
g2
(lp60872
VTest against the  dictionary:
p60873
aVor use the  method on that attribute:
p60874
aVQuick demo:
p60875
as(dp60876
g16
V100297
p60877
stp60878
a((dp60879
g2
(lp60880
VYour  hook returns a value for all attributes:
p60881
aVand thus a test for  returns :
p60882
aVMake sure you raise a  for attributes the object doesn't support instead
p60883
aVNote: this applies only to old-style instances; instances for new-style classes (the default in Python 3, and any class inheriting from  in Python 2) are not tested for the  attribute; instead the class itself is consulted
p60884
aVYou could thus switch to new-style classes as well to mitigate this, but your  should still not be too broad
p60885
as(dp60886
g16
V100297
p60887
stp60888
a((dp60889
g2
(lp60890
VUse  word boundary anchors:
p60891
aVmatches points in the text that go from a non-word character to a word character, and vice-versa, so space followed by a letter, or a letter followed by a word
p60892
aVBecause  in a regular python string is interpreted as a backspace character, you need to either use a raw string literal () or escape the backslash ()
p60893
aVYou may also want to add the  flag to your search to find both lower and uppercase text:
p60894
aVDemo:
p60895
as(dp60896
g16
V100297
p60897
stp60898
a((dp60899
g2
(lp60900
VWhen testing for exception codes, use  as a context manager; this gives you access to the raised exception, letting you test the  attribute:
p60901
aVTo 'suppress' or test the output, you'll have to capture either  or , depending on the  output (help text goes to )
p60902
aVYou could use a context manager for that:
p60903
aVand use these as:
p60904
aVI nested the context managers here, but in Python 2
p60905
aV7 and newer you can also combine them into one line; this tends to get beyond the recommended 78 character line limit in a hurry though
p60906
as(dp60907
g16
V100297
p60908
stp60909
a((dp60910
g2
(lp60911
VYou have a  character in the real URL you used
p60912
aVQuote the URL on your command line:
p60913
aVThe  character puts a command in the background and the shell starts parsing from there for a new command
p60914
as(dp60915
g16
V100297
p60916
stp60917
a((dp60918
g2
(lp60919
VThe more efficient method would be to parse out the sections into a structure per  value, in sorted order:
p60920
aVThe  call inserts new entries in sorted order into the list, saving you another sorting loop
p60921
aVNow use this to home in on the ranges given a   value:
p60922
aVThis still doesn't search for a next match against the 'stop' parameter, of course, but the latter loop can be folded into a generator expression, suitable for use in the  function, and because the ranges are sorted, you can continue the search for the next site name:
p60923
aVThe  iterable 'remembers' where the first  search stopped, we can loop over it to continue searching for a suitable  value in from that point
p60924
aVNote that presumably the  values are always going to be equal or larger than the  values; there is no point in testing against the next item  values as well; if  is  then  is also
p60925
as(dp60926
g16
V100297
p60927
stp60928
a((dp60929
g2
(lp60930
VYou add  to  in the while loop; if  you end up with  and that is not a valid index; indices to lists must fall in the range  (so  included,  excluded)
p60931
aVAppend before incrementing , in the loop, and extend the result with the remainder (which are already sorted):
p60932
aVSlices never raise an ; if the indices fall outside the available values, empty lists are returned
p60933
aVAt least one of  and  is going to be an empty list
p60934
aVDemo:
p60935
as(dp60936
g16
V100297
p60937
stp60938
a((dp60939
g2
(lp60940
V is a built-in exception; an import failure will not look for the exception in the current module globals
p60941
aVIn fact, in Python 2, the import machinery doesn't even look in builtins for this; it uses the C equivalent of the exception,
p60942
aVYou cannot replace the exception with your own
p60943
aVJust catch the exception at the top level of your python main script:
p60944
aVor raise a custom exception in a exception handler instead
p60945
aVThis is far clearer to future maintainers of your code than hacking additional features into standard exceptions
p60946
aVIn Python 3
p60947
aV1 and up, the import machinery has been largely reimplemented using a lot more Python code, and there you can do this by using the  module and assigning to , but I'd strongly advice against such hackery
p60948
aVIf you do go this route, note that  is passed  and  keyword arguments in addition to
p60949
as(dp60950
g16
V100297
p60951
stp60952
a((dp60953
g2
(lp60954
VYou'd have to loop through the values:
p60955
aVFor Python 3, replace  with
p60956
aVThis tests the minimum number of values; no intermediary list is created, and the  loop terminates the moment a match is found
p60957
aVDemo:
p60958
as(dp60959
g16
V100297
p60960
stp60961
a((dp60962
g2
(lp60963
VStore the classes and files in a sequence, the results into a dictionary:
p60964
as(dp60965
g16
V100297
p60966
stp60967
a((dp60968
g2
(lp60969
V objects are great when you need subsets of binary data that only need to support indexing
p60970
aVInstead of having to take slices (and create new, potentially large) objects to pass to another API you can just take a  object
p60971
aVOne such API example would be the  module
p60972
aVInstead of passing in a slice of the large  object to parse out packed C values, you pass in a  of just the region you need to extract values from
p60973
aVobjects, in fact, support  unpacking natively; you can target a region of the underlying  object with a slice, then use  to 'interpret' the underlying bytes as long integers, or floating point values, or n-dimensional lists of integers
p60974
aVThis makes for very efficient binary file format interpretations, without having to create more copies of the bytes
p60975
as(dp60976
g16
V100297
p60977
stp60978
a((dp60979
g2
(lp60980
VYou could use a regular expression to remove the invalid portion:
p60981
aVThe  matches any character that is not a valid Base64 character, plus the trailing  padding and newlines and carriage returns (which are allowed in encoded values to wrap lines)
p60982
aVDemo:
p60983
aVor, using the decodable portion of your sample:
p60984
aVThis solution easily beats the  option on speed:
p60985
aVUsing a regular expression is almost 10 times faster for this simple sample; for longer text the results will be faster still
p60986
as(dp60987
g16
V100297
p60988
stp60989
a((dp60990
g2
(lp60991
VTest if the option is set in the same  stamement:
p60992
aVwhere  takes the  instance returned by
p60993
aVUnfortunately, you cannot verify this until all arguments have been parsed, you cannot use this function as a  parameter, because the  option can be specified anywhere on the command line, before or after the option that specifies your project name
p60994
aVIf you require that  is listed before any projects on your command line, you could use a custom  instead; a custom action is passed the  object as parsed so far:
p60995
as(dp60996
g16
V100297
p60997
stp60998
a((dp60999
g2
(lp61000
VSearch for the  tag with specific attributes:
p61001
aVDemo:
p61002
as(dp61003
g16
V100297
p61004
stp61005
a((dp61006
g2
(lp61007
VFor immutable values, just multiply the list:
p61008
aVFor mutable values, use a list comprehension:
p61009
aVThe  name here is just a convention; it means we are ignoring the loop target name in the loop itself
p61010
as(dp61011
g16
V100297
p61012
stp61013
a((dp61014
g2
(lp61015
VLoop over the list you have:
p61016
aVBecause the loop will  the part after the loop is not executed if any delimiter matched
p61017
as(dp61018
g16
V100297
p61019
stp61020
a((dp61021
g2
(lp61022
VYou use logging everywhere, regardless
p61023
aVIn your modules, use:
p61024
aVand log away
p61025
aVUse the different levels (, , , etc
p61026
aVdepending on what type of message you are logging
p61027
aVYour main entry point then configures the  module output
p61028
aVThat can include completely disabling any output, or directing debug information to a file, but logging errors to the console
p61029
aVYour modules do not need to care, the  module handles configuration of the output handlers and formatting as global state
p61030
as(dp61031
g16
V100297
p61032
stp61033
a((dp61034
g2
(lp61035
VNo need to use tuple assignment here; the right-hand value is immutable, so you can just as well share the reference:
p61036
aVThis is not unintuitive at all, in my view, and the python compiler will only need to store one constant with the bytecode, while using tuple assignment requires an additional tuple constant:
p61037
aVDon't use this if the right-hand expression is mutable and you want ,  and  to have independent objects; use a generator expression then:
p61038
aVor better still, don't be so lazy and just type them out:
p61039
aVIt's not as if your left-hand assignment is dynamic
p61040
as(dp61041
g16
V100297
p61042
stp61043
a((dp61044
g2
(lp61045
V is the escape code for a literal ; it is being unescaped entirely correctly
p61046
aVDon't confuse this with the URL escaped , which is the escape character for spaces:
p61047
aVonly decodes encoded spaces to literal spaces ( -> ), not encoded  symbols ( -> )
p61048
aVIf you have input to decode that uses  instead of  where you expected spaces, then those input values were perhaps doubly quoted, you'd need to unquote them twice
p61049
aVYou'd see  escapes encoded too:
p61050
aVwhere  is the quoted  character
p61051
as(dp61052
g16
V100297
p61053
stp61054
a((dp61055
g2
(lp61056
V can handle any iterable, and expects each iteration over that iterable to yield a complete line
p61057
aVThe iterable can be a file-like object, or (normally) a list of strings:
p61058
aVIf you pass in just a single string object, the string itself is iterated over as if each character was a line, but because of the quotes  will continue to read 'lines' until it finds a closing quote character
p61059
aVThe next 'line' contains just a comma, so that is seen as a line of two empty values
p61060
aVOr, to take the first 5 characters () as an example,  does this:
p61061
aVIterate and receive
p61062
aVThis is a quoted value, so include everything up to the end of the line
p61063
aVThere is an opening quote, iterate until a closing quote is found, everything until that point is appended to the existing value
p61064
aVloop and receive , append
p61065
aVloop and receive , append
p61066
aVloop and receive
p61067
aVQuote closed, yield a complete row
p61068
aVIterate and receive
p61069
aVThis is a complete line with a delimiter, so yield
p61070
aVWhenever I need to pass in a string value to  I use ; this method will always return a list, so this works for lines without newlines too:
p61071
aVI leave in the newlines (pass in  to ; quoted values with newlines are then properly returned with the newlines included
p61072
as(dp61073
g16
V100297
p61074
stp61075
a((dp61076
g2
(lp61077
VA dict comprehension is executed in a new scope, like a function
p61078
aVAs such, the expression locals are limited to just those named in the loop, in this case
p61079
aVThe parent function locals are not considered, because closures are only bound at compile time
p61080
aVNames referenced by  cannot make use of closures
p61081
aVThe following also doesn't work:
p61082
aVThe names  and  are not available to the inner  function unless the compiler has determined that that function actually needs access to them:
p61083
aVHere, the line  can only be referring to the parent scope locals (they are not assigned to in  itself), so the compiler has created closures for these and the names have become available as locals within
p61084
aVList comprehensions in Python 2 do not have their own namespace, an omission corrected in Python 3 and not extended to dict and set comprehensions
p61085
aVSee Python list comprehension rebind names even after scope of comprehension
p61086
aVIs this right
p61087
as(dp61088
g16
V100297
p61089
stp61090
a((dp61091
g2
(lp61092
VSimple:
p61093
aVis only true if all characters in the string are letters:
p61094
aVReturn true if all characters in the string are alphabetic and there is at least one character, false otherwise
p61095
aVDemo:
p61096
as(dp61097
g16
V100297
p61098
stp61099
a((dp61100
g2
(lp61101
VYou already imported the function object; leave of the  reference:
p61102
aVThis will not do what you want still, as it'll print to , not return a pretty-printed value
p61103
aVUsing the  module is not very suitable for use in a web server environment really
p61104
aVYou'd have to create a  instance and use it's  to generate output instead:
p61105
as(dp61106
g16
V100297
p61107
stp61108
a((dp61109
g2
(lp61110
VYour data structure should really be moved to a dictionary, keyed on the  value
p61111
aVUse  and  to keep track of the values and make summing easier:
p61112
aVDemo:
p61113
aVIf you still require a sequence of dictionaries in the same format, you can then turn the above dictionary of counters back into 'plain' dictionaries again:
p61114
aVresulting in:
p61115
as(dp61116
g16
V100297
p61117
stp61118
a((dp61119
g2
(lp61120
VYou can use  to limit an iterable to a number of items, including limiting a file object to a number of lines
p61121
aVBecause you are reading lines, you should be opening the file in text mode instead (drop the ):
p61122
aVThis allows you to process the lines one at a time, but you'll only process the first  lines
p61123
aVIf all you are doing is copying those lines to another file, do:
p61124
aVThe  method takes the  generator and will take 1000 lines at a time to write those in as a chunk to the output file, all in C code
p61125
as(dp61126
g16
V100297
p61127
stp61128
a((dp61129
g2
(lp61130
VUse a  object:
p61131
aVNote that  is not needed, the  call with no arguments also strips the string
p61132
aVApart from defaulting non-existing keys to 0,  objects have additional advantages, such as listing words ordered by frequency (including a top N), summing and subtracting
p61133
aVThe above code results in:
p61134
as(dp61135
g16
V100297
p61136
stp61137
a((dp61138
g2
(lp61139
VPython  returns a  instance when a match is made, it includes a  method to give you the matched position:
p61140
aVNote the  though; an asterisk () is a regular expression metacharacter, so it needs to be escaped with a slash to match a literal
p61141
aVThe  defines a character class that matches any character in the two named ranges, and the  following the class limits it to matching exactly two characters
p61142
aVDemo:
p61143
aVIf you need to remove everything after this string, use  instead:
p61144
aVThis uses a look-behind assertion; it looks for your pattern, then matches everything that follows, and the  call then removes what was matched from the inputstring
p61145
aVDemo:
p61146
aVNote how everything after  and  is gone now
p61147
as(dp61148
g16
V100297
p61149
stp61150
a((dp61151
g2
(lp61152
VIf  is empty, there is no last letter to test:
p61153
aVUse  instead:
p61154
aVdoes not raise an exception when the string is empty:
p61155
aVAlternatively, using a slice would also work:
p61156
aVas slices always return a result (at minimum an empty string) but  is more self-evident as to what it does to the casual reader of your code
p61157
as(dp61158
g16
V100297
p61159
stp61160
a((dp61161
g2
(lp61162
VBest practice is to use absolute paths
p61163
aVUse the  path not to change directories, instead use it to calculate a base path to use to build absolute paths
p61164
aVIn a top-level module, add:
p61165
aVand reuse  to build absolute paths:
p61166
aVChanging the working directory is rarely needed or useful
p61167
as(dp61168
g16
V100297
p61169
stp61170
a((dp61171
g2
(lp61172
VYou need to escape the  characters, double them:
p61173
aVshould be:
p61174
aVYou want to get rid of all the commas too
p61175
aVNote that you can create a multiline string using triple quotes; make it a raw string (using ) and you don't have to escape anything either:
p61176
as(dp61177
g16
V100297
p61178
stp61179
a((dp61180
g2
(lp61181
VYou don't really need to test for pipes explicitly, you only want to look for files
p61182
aVUse ; it'll return  for a pipe, but  for an actual file:
p61183
as(dp61184
g16
V100297
p61185
stp61186
a((dp61187
g2
(lp61188
VYour function doesn't return the recursive call:
p61189
aVWithout a return statement here, your function ends without an explicit return and  is returned instead:
p61190
aVThe above should have returned  ( gives  is )
p61191
aVFor any starting value of 5 or over the function uses more than one level of recursion and a  return value ends up being used for multiplication
p61192
aVAdd :
p61193
aVYour statements can be simplified:
p61194
aVYour sample loop then generates:
p61195
as(dp61196
g16
V100297
p61197
stp61198
a((dp61199
g2
(lp61200
VYou can use the  module for the output; simply loop over the input file and use  to split lines into rows:
p61201
aVThe  and  starter values make it easier to calculate the minimum and maximum coordinates later on
p61202
aVThe last line is
p61203
as(dp61204
g16
V100297
p61205
stp61206
a((dp61207
g2
(lp61208
VYou'd indeed have to match that with a regular expression
p61209
aVIf your command-line argument is of the form  in , use:
p61210
aVThe  makes sure that any characters in the input that could be interpreted as regular expression meta-characters are properly escaped
p61211
aVFor  that'd result in the pattern  which matches anything containing the literal text ; you don't really need to include any wild-card characters as for a  match text containment is enough
p61212
as(dp61213
g16
V100297
p61214
stp61215
a((dp61216
g2
(lp61217
VYou need to activate the  tween
p61218
aVThe tween commits transactions after each request, implicitly starting a new transaction when a new request comes in
p61219
aVWhen you do not start a new transaction, the old transaction will not see data committed in other transactions (threads); this is a inherent feature of database transactions, as not doing so would lead to inconsistency errors
p61220
as(dp61221
g16
V100297
p61222
stp61223
a((dp61224
g2
(lp61225
VThese lines push  well outside the allowed range of indices:
p61226
aVNow  is guaranteed to be equal to or greater than , which is an invalid index
p61227
aVPerhaps you meant to use  modulus instead
p61228
aVThe  modulus operator would constrain the value to the range  (so 0 is included,  is excluded, which are the exact values that are allowed for an index into
p61229
as(dp61230
g16
V100297
p61231
stp61232
a((dp61233
g2
(lp61234
VYou are looking for  instead:
p61235
aVIndexing on Python strings gives you individual characters:
p61236
aVbut you appear to be looking to index the  list instead:
p61237
aVThe  loop does the latter, binding each element in  to  in turn, letting your loop print it
p61238
aVIf you only need to print one element, just use  directly instead of using a loop
p61239
as(dp61240
g16
V100297
p61241
stp61242
a((dp61243
g2
(lp61244
V is a dictionary view
p61245
aVJust use  directly on the dictionary instead if you need a list of keys, item 0 will be the first key in the (arbitrary) dictionary order:
p61246
aVor better still just use:
p61247
aVEither method works in both Python 2 and 3 and the  option is certainly more efficient for Python 2 than using
p61248
aVNote however that dictionaries have no set order and you will not know what key will be listed first
p61249
aVIt looks as if you are trying to find the maximum key instead, use  with :
p61250
aVThe function result is certainly going to be the same for any given  dictionary, as your code doesn't differ in codepaths between the random number comparison branches of the  statement
p61251
as(dp61252
g16
V100297
p61253
stp61254
a((dp61255
g2
(lp61256
VRead data from the shorter file into memory, into a dictionary keyed on the  row:
p61257
aVthen use this dictionary to match against the geo data, write out matches:
p61258
aVThis all assumes the census file is not so big as to take up too much memory
p61259
aVIf that's the case you'll have to use a database instead (read all data into a SQLite database, match in the same vein agains the geo data)
p61260
as(dp61261
g16
V100297
p61262
stp61263
a((dp61264
g2
(lp61265
V is rebound; the variable is updated to point to  in each loop
p61266
aVFor each  in , either the key is found ( succeeds) or the  is used to create a new value for that key
p61267
aVIf the key was found but the value was not a  type, the found value is replaced with a new  result
p61268
aVOnce the new value has been determined for this level,  is told to forget about the old dictionary and pointed to the new instead
p61269
aVRebinding does not change the old value
p61270
aVIt merely stops referring to that old value
p61271
aVLet's use a simple example:
p61272
aVAt the start,  and  are the same object
p61273
aVThink of names here as paper labels, and their values as balloons
p61274
aVThe labels are tied with string to the balloons
p61275
aVIn the above example, the  and  labels are both tied to the same dictionary balloon
p61276
aVWhen we enter the  loop, the  lookup succeeds and  is tied to the result of , an empty dictionary:
p61277
aVThis is a regular Python dictionary, and  is
p61278
aVNext line rebinds the  label to that dictionary
p61279
aVThe string is simply untied from the original dictionary and now attached to the same balloon  is tied to:
p61280
aVThe original dictionary was not altered by the rebinding
p61281
aVHaving run out of keys (there was only one in ), the next part then assigns  to :
p61282
aVHowever,  is not the only label attached to this dictionary balloon
p61283
aVDictionaries themselves contain keys and values, both of which are labels that are tied to balloons too
p61284
aVThe  label is still tied to the outer dictionary balloon, and it has a  key associated value, which was tied to a nested dictionary, and it is this nested dictionary we just changed:
p61285
aVThe algorithm merely followed along labels via strings to new dictionaries
p61286
aVUsing more complex key combinations just means more strings are being followed, with perhaps an extra dictionary being pumped up to be tied in
p61287
as(dp61288
g16
V100297
p61289
stp61290
a((dp61291
g2
(lp61292
VYou can use  to remove everything after the last space of the remainder:
p61293
aVThis limits the split to the first space from the right, and the  index takes whatever was split off before that space
p61294
aVIf there are no spaces, this just returns the original (sliced) string
p61295
as(dp61296
g16
V100297
p61297
stp61298
a((dp61299
g2
(lp61300
VYou appear to be under the impression that you must put functions in classes
p61301
aVThis is not the case
p61302
aVis not a class, it is a module
p61303
aVThe only classes the  module defines are exceptions; everything else in the documented API is a top-level function
p61304
aVYou can take a look at the  sourcecode; the  function is defined directly in the module source code as:
p61305
aVwhere ,  and  are other public functions in the same module, and ,  and  are functions in the same module that are not meant to be part of the public API
p61306
aVPython is not Java, after all; Java restricts you to one class per file, with the same name, and all code must be part of a class
p61307
aVIn Python, classes are entirely optional
p61308
as(dp61309
g16
V100297
p61310
stp61311
a((dp61312
g2
(lp61313
VYou'd be better off using a  object; s support this usecase explicitly with the  method:
p61314
aVReturn a list of the n most common elements and their counts from the most common to the least
p61315
aVwhere you'd actually use the  object instead of  to begin with
p61316
aVobjects are a  subclass, so you can use them as drop-in replacements when you are keeping track of per-key frequencies, albeit that they make counting items a lot easier in many cases
p61317
aVIf you are stuck with a regular dictionary, then you can implement this functionality yourself using the  module, specifically, the  function:
p61318
aVwhere  is then a list of 30 key-value tuples:
p61319
as(dp61320
g16
V100297
p61321
stp61322
a((dp61323
g2
(lp61324
VYou could use , applying  using the splat arbitrary arguments syntax :
p61325
aVDemo:
p61326
aVThis creates tuples, not lists; you can map the  output to lists as required:
p61327
as(dp61328
g16
V100297
p61329
stp61330
a((dp61331
g2
(lp61332
VLoop over the descendants of the  object, collect all  text objects, and when you encounter the  tag, stop:
p61333
aVDemo:
p61334
aVIf you want to do this for all  tags (not just the first), you need to loop over the  tags found with  instead:
p61335
as(dp61336
g16
V100297
p61337
stp61338
a((dp61339
g2
(lp61340
V returns at least one element
p61341
aVIf sep was not found in the text, that one element is the original, unsplit text
p61342
aVFor an empty string, the sep delimiter will of course never be found, and is specifically called out in the documentation:
p61343
aVSplitting an empty string with a specified separator returns
p61344
aVYou probably are confused by the behaviour of the  delimiter option (the default):
p61345
aVIf sep is not specified or is , a different splitting algorithm is applied: runs of consecutive whitespace are regarded as a single separator, and the result will contain no empty strings at the start or end if the string has leading or trailing whitespace
p61346
aVConsequently, splitting an empty string or a string consisting of just whitespace with a  separator returns
p61347
aV(emphasis mine)
p61348
aVThat makes  the exception, not the rule
p61349
as(dp61350
g16
V100297
p61351
stp61352
a((dp61353
g2
(lp61354
VYour error indicates you have data with the letter  (lowercase L) instead of the number  in the year:
p61355
aVThat is not a valid date that'll fit the requested format; replacing the  with  and the input date works just fine:
p61356
aVFix your input, the format is correct
p61357
as(dp61358
g16
V100297
p61359
stp61360
a((dp61361
g2
(lp61362
VLowercase the  operands:
p61363
aVThe  test is not influenced by case
p61364
as(dp61365
g16
V100297
p61366
stp61367
a((dp61368
g2
(lp61369
VBasic authentication is always supported; if a basic auth header is present the cookie-based login form redirect will not be shown
p61370
aVPresumably you want to disable the redirect for the RSS feed instead, so when basic auth headers are not present a 401 auth-required response is sent instead of a redirect
p61371
aVIf so, then you'll need to provide PluggableAuthService plugin, implementing the   interface to intercept the  call and make sure unathorized is raised before the  plugin can redirect
p61372
as(dp61373
g16
V100297
p61374
stp61375
a((dp61376
g2
(lp61377
VYou are trying to assign to literal integer values
p61378
aV, , etc
p61379
aVare not valid names; they are only valid integers:
p61380
aVYou probably want to use a list or dictionary instead:
p61381
aVUsing a list makes it much easier to pick a random value too:
p61382
as(dp61383
g16
V100297
p61384
stp61385
a((dp61386
g2
(lp61387
VIn your first example, you were creating a new generator each time:
p61388
aVThis starts the generator from the top, so the first statement
p61389
aVWhen , the exception is raised, otherwise the generator just yields and pauses
p61390
aVWhen you assigned your generator later on, the global  started at , the code then continued from where it left of until it ends or comes across another  statement, then ended
p61391
aVWhen a generator function ends, it raises
p61392
aVLet's break this down into steps:
p61393
aVYou create new generator and call  on it
p61394
aVThe following code is executed:
p61395
aVThe generator is paused on the last line, and  is yielded
p61396
aVYou create a new generator and call  on it
p61397
aVis  at the start:
p61398
aVThe generator is paused on the last line, and  is yielded
p61399
aVYou create a new generator and call  on it
p61400
aVis  at the start:
p61401
aVAn exception is raised
p61402
aVYou set  again
p61403
aVYou create a new generator, store a reference in  and call  on it
p61404
aVThe following code is executed:
p61405
aVThe generator is paused on the last line, and  is yielded
p61406
aVYou call  again on the same, existing generator referenced by
p61407
aVThe code resumes at the paused point
p61408
aVThe function has no more code at that point, and returns
p61409
aVis raised
p61410
aVIf you were to use a loop instead, you'd see the difference better:
p61411
aVNote how each time I create a new generator, the loop starts from the beginning
p61412
aVStore a reference however, and you'll notice it continue instead:
p61413
aVDuring the loop, each time the  expression is executed, the code is paused; calling  continues the function where it left of the previous time
p61414
aVThe  exception is entirely normal; it is how generators communicate that they are done
p61415
aVA  loop looks for this exception to end the loop:
p61416
as(dp61417
g16
V100297
p61418
stp61419
a((dp61420
g2
(lp61421
VThe output is returned as a byte string, and Python will print such strings as ASCII characters whenever possible:
p61422
aVNote the quote at the start, that's ASCII codepoint 34:
p61423
aVIf you expected the ordering to be reversed, then you may need to indicate a byte order:
p61424
aVwhere  indicates big-endian alignment
p61425
as(dp61426
g16
V100297
p61427
stp61428
a((dp61429
g2
(lp61430
VIn  you refer to  but never defined it
p61431
aVYour  function does return a value  but that name is not then automatically available to the caller
p61432
aVThe names in the  function are local; they don't automatically reflect the names returned from the functions in any case
p61433
aVHere is a fixed  function that just happens to use the same names as the functions for returned values:
p61434
aVI removed ; it'll always be  because  doesn't return anything
p61435
aVYou can still use different names in ;  is a perfectly valid local name (even though I personally would use  style for local names, always), but you then should not expect  to exist, you'd use  everywhere in  instead
p61436
as(dp61437
g16
V100297
p61438
stp61439
a((dp61440
g2
(lp61441
VBecause you should not rely on the implementation details of another module
p61442
aVIf the other module stops using , then your first module is now broken
p61443
aVImporting merely creates a reference in the current namespace
p61444
aVYou are not loading the module into memory twice when using the , so importing a module in two different locations doesn't cost you anything
p61445
as(dp61446
g16
V100297
p61447
stp61448
a((dp61449
g2
(lp61450
VInstead of picking random integers, shuffle a list and pick the first two items:
p61451
aVBecause we shuffled a list of possible choices first, then picked the first two, you can guarantee that  and  are never equal to one another
p61452
aVUsing  leaves the option open to do something with the remaining choices; you only have 1 here, but in a larger set you can continue to pick items that have so far not been picked:
p61453
aVwould give you 100 random numbers without repeating
p61454
aVIf all you need is a random sample of 2, use  instead:
p61455
as(dp61456
g16
V100297
p61457
stp61458
a((dp61459
g2
(lp61460
VYou are first replacing all s with s before then replacing all s with s again (including those you just replaced s with
p61461
ag4212
aVUse a translation map instead, fed to :
p61462
aVThe  method requires a dictionary mapping codepoints (integers) to replacement characters (either a single character or a codepoint), or  (to delete the codepoint from the input string)
p61463
aVThe  function gives us those codepoints for the given 'from' letters
p61464
aVThis looks up characters in , one by one in C code, in the translation map, instead of replacing all s followed by all s
p61465
aVhas the added advantage of being much faster than a series of  calls
p61466
aVDemo:
p61467
as(dp61468
g16
V100297
p61469
stp61470
a((dp61471
g2
(lp61472
V does not take regular expressions
p61473
aVYou are trying to replace the literal text
p61474
aVUse  to create a date format without zero-padding instead:
p61475
aVand avoid having to replace the zeros
p61476
aVDemo:
p61477
aVIf Python was compiled with the  library, then you could also use dashes in the format to suppress the padding:
p61478
aVbut that is not nearly as portable
p61479
as(dp61480
g16
V100297
p61481
stp61482
a((dp61483
g2
(lp61484
VWrap the file object in  to decode the pipe on the fly:
p61485
as(dp61486
g16
V100297
p61487
stp61488
a((dp61489
g2
(lp61490
VIf all you need is the  output, then take a look at  (added in Python 2
p61491
aV7):
p61492
aVBecause you were using , you'd have to set  to get the same behaviour
p61493
aVYou do want to heed the big red warning message about passing untrusted arguments to your shell
p61494
aVIf you need to capture  as well, simply add  to the call:
p61495
aVto redirect the error output to the default output stream
p61496
as(dp61497
g16
V100297
p61498
stp61499
a((dp61500
g2
(lp61501
VYou can catch the keyboard interrupt in Python with an exception handler:
p61502
as(dp61503
g16
V100297
p61504
stp61505
a((dp61506
g2
(lp61507
VThe direct translation, working on  objects only, would be:
p61508
aVThis appears to expand ranges in the form of  into :
p61509
aVYou can use regular expressions to do the same:
p61510
aVor, for unicode strings (type ) instead:
p61511
as(dp61512
g16
V100297
p61513
stp61514
a((dp61515
g2
(lp61516
VYou are returning the first device you match
p61517
aVBuild a list instead and return that list:
p61518
aVA  statement immediately ends the function; by putting a  in your loop, you exit the function at that point and end the loop prematurely
p61519
aVThe alternative is to make this a generator function, by using a  statement to produce your matches; you can then loop over the result of  once only, but you'll be producing device files on demand instead:
p61520
aVGenerators are a more advanced technique however
p61521
as(dp61522
g16
V100297
p61523
stp61524
a((dp61525
g2
(lp61526
VYou didn't apply the decorators; call the return value of `view_config(), passing in the item to decorate:
p61527
aVThe  syntax takes the return value of the expression and calls it with the next object (function or output of another decorator) defined below it in the source, with the return value replacing the object-to-decorate
p61528
aVIn other words, the following:
p61529
aVbecomes:
p61530
aVbut the Pyramid view decorators are themselves callables that return a decorator function
p61531
as(dp61532
g16
V100297
p61533
stp61534
a((dp61535
g2
(lp61536
VYou need to collect your matches in a list, then send that list of matches to your chatbot:
p61537
aVThe  call joins the found names together with commas to make for a nicer and more readable format for the names
p61538
as(dp61539
g16
V100297
p61540
stp61541
a((dp61542
g2
(lp61543
VDon't use a regular expression
p61544
aVUse a stack instead:
p61545
aVDemo:
p61546
as(dp61547
g16
V100297
p61548
stp61549
a((dp61550
g2
(lp61551
V creates a reference in the importing module global namespace to the imported object
p61552
aVIf that is an immutable, that means you now have to monkeypatch the value in the module that imported it
p61553
aVYour only hope is to be the first to import constants and monkeypatch the names in that module
p61554
aVSubsequent imports will then use your monkeypatched values
p61555
aVTo patch the original module early, the following is enough:
p61556
as(dp61557
g16
V100297
p61558
stp61559
a((dp61560
g2
(lp61561
VUse  and call  on the returned process object:
p61562
as(dp61563
g16
V100297
p61564
stp61565
a((dp61566
g2
(lp61567
VYou are storing the result of , which is the number of rows
p61568
aVYou are never actually fetching any of the results
p61569
aVUse  to get all result rows or iterate over the cursor after executing:
p61570
as(dp61571
g16
V100297
p61572
stp61573
a((dp61574
g2
(lp61575
V objects have a  attribute:
p61576
aVDemo:
p61577
aVYou can get the same attribute from  objects:
p61578
aVYou can also get the year from the  module; the  structure has a  attribute; the structure is a return value for several functions:
p61579
as(dp61580
g16
V100297
p61581
stp61582
a((dp61583
g2
(lp61584
VYou are cutting off the last two characters, not just the last one:
p61585
aVshould be:
p61586
aVThis accounts for your accuracy problem:
p61587
aVSince slicing counts from the end, slicing to  cuts of both the unit and the last digit:
p61588
as(dp61589
g16
V100297
p61590
stp61591
a((dp61592
g2
(lp61593
VYou have whitespace in your input:
p61594
aVWhitespace is stripped when converting to , hence the confusing error message; note how there is nothing between the quotes in the exception message (Python 3 has fixed this)
p61595
aVStrip spaces:
p61596
aVor avoid turning them to integers:
p61597
as(dp61598
g16
V100297
p61599
stp61600
a((dp61601
g2
(lp61602
V is a string (you just tested if it is equal to  in the first  statement)
p61603
aVDid you meant to test against  instead
p61604
aVThe line:
p61605
aVwill throw an error, but perhaps you wanted:
p61606
aVinstead
p61607
aVMoreover, the lines:
p61608
aVdon't do what you think they do
p61609
aVYou probably wanted to test if  is equal to  for the second block:
p61610
as(dp61611
g16
V100297
p61612
stp61613
a((dp61614
g2
(lp61615
VYou need to verify either your network or the URL you are trying to retrieve; Python will read from the result socket until EOF is reached so if you got less data than expected, you either were sent an incomplete response, the network cut the response short (proxy server, firewall, what-have-you), or your assumption about what the server sends for that URL is wrong
p61616
aVYou also want to use  to do the reading for you:
p61617
aVThis will not only handle reading the data in chunks, but will avoid filling memory with large blobs of binary data to boot
p61618
aVThe  statement handles closing the file object for you
p61619
as(dp61620
g16
V100297
p61621
stp61622
a((dp61623
g2
(lp61624
VYou are not getting any output because you have a syntax error
p61625
aVYour function parameters are not valid; they are a) not valid Python like that, and b) incomplete:
p61626
aVThe  string is missing a closing parenthesis, but you cannot just put literal values in a function header anyway
p61627
aVRemove everything between the parenthesis:
p61628
aVThe rest of your function is fine:
p61629
as(dp61630
g16
V100297
p61631
stp61632
a((dp61633
g2
(lp61634
VUse an infinite loop:
p61635
aVThis certainly can apply to your  function as well; you can exit the loop with either , or use  to exit the function altogether, which also terminates the loop:
p61636
aVIf you were to add an option to quit as well, that could be:
p61637
aVfor example
p61638
as(dp61639
g16
V100297
p61640
stp61641
a((dp61642
g2
(lp61643
VYou are looking at a closure; the Python compiler marks  in  as a free variable because  is not assigned to
p61644
aVis a local in  and because there is a nested scope that uses that name as a free variable,  is marked as a closure
p61645
aVWhen the code runs, Python creates a closure for  immediately when creating the  function (it is recreated every time you call ; only the bytecode for the function remains unchanged, a constant attached to the  function code)
p61646
aVOnly when  is invoked does Python need to look up , which means dereferencing the closure, and from there dereferencing the current value of
p61647
aVYou can see all this in action with some introspection and disassembly of the bytecode:
p61648
aVThis builds a function with a closure and returns it without calling
p61649
aVThis allows us to introspect the  function created by
p61650
aVNote how the Python compiler has inserted a  for  at the top there
p61651
aVcreates the function object with attached closure, for
p61652
aVAll  has to do is dereference the attached closure
p61653
aVThe closure points to , and looking up the contents gives you , as expected
p61654
aVCompiled languages could do this as well; someone managed to compile Scheme to C, with preserving the closures: Compiling Scheme to C, for example
p61655
as(dp61656
g16
V100297
p61657
stp61658
a((dp61659
g2
(lp61660
VYou can use a generator expression with  to find the first match, or  if nothing matched
p61661
aVThis still requires a loop:
p61662
aVThe alternative is to use a dictionary keyed on  instead
p61663
as(dp61664
g16
V100297
p61665
stp61666
a((dp61667
g2
(lp61668
VAll objects in Python have a boolean 'value'; they are either true or false in a boolean context
p61669
aVEmpty lists are false
p61670
aVThis applies to all sequences and containers, including tuples, sets, dictionaries and strings
p61671
aVNumeric 0 is false too, so 0, 0
p61672
aV0, 0j are all false as well, as are  and of course  itself:
p61673
aVEverything else is considered true in a boolean context; so a list that is not empty is true, and two non-empty lists together with  is considered true as well
p61674
aVYou can make custom types  look like empty containers by implementing  and returning , or look like a number by implementing * and returning  when the instance is to be the boolean equivalent of numeric zero
p61675
aVJust remember that  and  shortcircuit; if the first expression locks in the result then that value is returned and the second expression is ignored altogether
p61676
aVFor , that means that in the expression ,  is ignored if  is a false value (like an empty list), because the whole expression can never be true in that case
p61677
aVFor ,  is ignored if  is a true value
p61678
aVThese rules are all covered by the Boolean operations reference documentation
p61679
aV*In Python 3, use  instead
p61680
as(dp61681
g16
V100297
p61682
stp61683
a((dp61684
g2
(lp61685
VClasses are not stored in their own namespace
p61686
aVThey are stored in the namespace they are defined in; in your case, that's the global namespace of the interpreter session
p61687
aVMethods within classes can still refer to names in that same namespace
p61688
aVPerhaps you were confused with the scope at class definition time
p61689
aVThe class body is executed as if it is a function; the local namespace of that function then forms the attributes of the resulting class
p61690
aVYou can still reach names from outer scopes from there, however:
p61691
as(dp61692
g16
V100297
p61693
stp61694
a((dp61695
g2
(lp61696
VYou are not testing for spaces, only for empty strings, which you'll never find when using straight indices on a python string
p61697
aVMoreover, you should return  if any of those 4 conditions is true, not if they are all true at the same time:
p61698
aVNext, you replace the spaces, but don't check the length again
p61699
aVWhat if I had given you 19 spaces:
p61700
aVLast, you want first collect all the digits, and check if there is a remainder:
p61701
aVand don't forget to return True if all those tests have passed:
p61702
aVat the end
p61703
aVPut that all together and you get:
p61704
as(dp61705
g16
V100297
p61706
stp61707
a((dp61708
g2
(lp61709
VThe name  is looked up as a global
p61710
aVReferences to globals do not need to be referring to anything defined until they are actually used
p61711
aVThe function  doesn't use  until it is called
p61712
aVIf  was not defined, calling  would result in a  exception:
p61713
aVPython doesn't really care what  is
p61714
aVI can make it a class too, or something that is not callable even:
p61715
aVBecause in the last example,  is now bound to a string, the  function fails when trying to call it
p61716
as(dp61717
g16
V100297
p61718
stp61719
a((dp61720
g2
(lp61721
VThe  statement goes on a separate line:
p61722
aVThe  is redundant here; I've left it off
p61723
aVThe  statement 'marks' names in a function as global; it is a distinct statement and you can only give it one or more names (separated by commas):
p61724
aVIt doesn't really matter where in the function you put them, as long as they are on a line of their own
p61725
aVThe statement applies to the whole function
p61726
aVAs such it makes sense to stick a  statement at the top, to avoid confusion
p61727
as(dp61728
g16
V100297
p61729
stp61730
a((dp61731
g2
(lp61732
VYou are dividing using the true division operator , which will always result in floating point values
p61733
aVUse floor division instead, , to get integer results:
p61734
aVYour computer hardware cannot handle float values with the required precision
p61735
aVThe alternative is to use  values, but this will result in slower arithmetic operations
p61736
aVIn Python 2, the  operator is the floor division operator, but when applied to integers only
p61737
aVTo get the same behaviour in Python 2, add:
p61738
aVThe behaviour was changed because the difference between using only integer operators and using at least one float argument was confusing
p61739
aVIn other words, the standard Python 2  operator is a different beast from the Python 3  division operator
p61740
aVWhen applied to two integer operands, it acts just like the  floor division operator in Python 3
p61741
aVBut if either one of the two operands is a float instead, then it acts like the  float division operator instead
p61742
aVThe above  import swaps out the Python 2  operator for the true division operator found in Python 3
p61743
aVYou can see this when disassembling Python bytecode:
p61744
aVthe  import caused the Python compiler to use a different bytecode for the division operator, swapping  for
p61745
as(dp61746
g16
V100297
p61747
stp61748
a((dp61749
g2
(lp61750
VWhy is that
p61751
aVBecause you explicitly turn the result into an integer, removing anything beyond the decimal point:
p61752
aVHow can I fix that
p61753
aVDon't turn the  result into an integer:
p61754
aVYou should not round the  and  calculations; you should be flooring the results instead;  by itself does that for you
p61755
aVDrop the  calls for those two values
p61756
aVThe  floor division operator would give you the same result as calling  on the division result, removing the need to round or floor explicitly
p61757
aVYou can use formatting operations to then only show the values as decimals:
p61758
aVTo round a floating point value to 1 decimal but drop the  if that is what it was rounded to, you'll need to explicitly string off the :
p61759
aVThe expression  formats the  value but removes any  by first stripping  followed by stripping the remaining
p61760
aVInstead of division and subtraction, you may want to use the  function:
p61761
aVThe  function returns the result of the quotient and the remainder;  returns the number of minutes (number of times 60 fits in ), and the remainder seconds
p61762
aVApply the same function again on the number of minutes, and you get hours and a minutes remainder
p61763
as(dp61764
g16
V100297
p61765
stp61766
a((dp61767
g2
(lp61768
VThe handshake is blocking because you are wrapping the socket after binding; the socket is listening for new connections, there is no client yet to accept your connections
p61769
aVWrap the socket in when accepting a connection instead:
p61770
aVNow the handshake succeeds because there is a client on the other side to shake hands with
p61771
aVThere is no additional work necessary for the stream handler; the python  library gives you objects with the same interface as
p61772
aVYou can also wrap the socket early, but do postpone the handshake until you accept a connection:
p61773
as(dp61774
g16
V100297
p61775
stp61776
a((dp61777
g2
(lp61778
VYou have a parenthesis balance problem:
p61779
aVYou have one opening parenthesis too many, or one closing parenthesis too few
p61780
aVYou can cut back a little on all those parenthesis, the following suffices:
p61781
aVYou can chain the comparison operators:
p61782
aVwhere  is logically the same as  but  is evaluated only once; all you had to do was invert the  operators by swapping the operands
p61783
aVNote that testing for equality to  is rarely required; just drop the  from your  statements:
p61784
as(dp61785
g16
V100297
p61786
stp61787
a((dp61788
g2
(lp61789
VYou can use a generator to produce the  values; you had one unneeded generator level:
p61790
aVYou can assign that nested generator to a variable first:
p61791
aVif you want to keep things within a line length limit
p61792
aVThe generator will be consumed only once, accessing the expensive  attribute once only for each element of
p61793
aVYou can take this further if you want to replicate the reading order of the C# and Ruby code, by using separate generators for the steps:
p61794
aVbut now you are incurring an extra loop by selecting separately
p61795
as(dp61796
g16
V100297
p61797
stp61798
a((dp61799
g2
(lp61800
VYou cannot extend the built-in types, no
p61801
aVYou can only subclass them, but that only helps if you have full control over the creating and use
p61802
as(dp61803
g16
V100297
p61804
stp61805
a((dp61806
g2
(lp61807
VRemove the parenthesis around the SEO name:
p61808
aVNow the pattern will not be captured and passed on to your view
p61809
aVIf grouping is required, use a non-capturing group ( instead of ):
p61810
as(dp61811
g16
V100297
p61812
stp61813
a((dp61814
g2
(lp61815
VYou need to instanciate your validators:
p61816
aVNote the  after ; this applies to all your validators
p61817
aVThe instance is then called again to validate the input
p61818
as(dp61819
g16
V100297
p61820
stp61821
a((dp61822
g2
(lp61823
VYou'd have to add a  method:
p61824
aVThis should handle existing  hooks as well
p61825
aVThe  is used to allow  as the old value too
p61826
aVDemo:
p61827
as(dp61828
g16
V100297
p61829
stp61830
a((dp61831
g2
(lp61832
VYou are using the wrong test; use  to test for values in a line:
p61833
aVwill only be true if either the value of  is not in the line or if it is in the line at a position other than the start
p61834
aVreturns  if the value is not found, or the integer position otherwise
p61835
aVThat means that if  starts with the value of ,  is returned, and  tests as false in a boolean context such as :
p61836
aVNext, for any line in the file your test returns , you then close the file:
p61837
aVwhich will terminate the loop early; most lines will not match your test, you really don't want to close the file that quickly
p61838
aVYou also always execute the line ; you want to test if  is :
p61839
aVYou can restructure the search to use the  branch of a  loop:
p61840
aVThe  prevents the  block from running
p61841
aVThe  block takes care of closing the  file for you, using the file object as a context manager
p61842
as(dp61843
g16
V100297
p61844
stp61845
a((dp61846
g2
(lp61847
VYou are adding the string representation of the :
p61848
aVSum  and  objects, not their string representations; only create a string after summing the objects:
p61849
aVThis results in:
p61850
aVHowever, you probably want to use real timezone objects instead, I recommend you use the  library:
p61851
aVThis will take into account daylight saving time too, for example
p61852
as(dp61853
g16
V100297
p61854
stp61855
a((dp61856
g2
(lp61857
VStarting a pack always removes the  file
p61858
aVWhen there then is nothing to pack, no new  file is created in it's place
p61859
aVSee the  method; it deletes an existing  file right after acquiring the packing lock
p61860
aVThe logic goes (with some indentation and intermediary code removed):
p61861
as(dp61862
g16
V100297
p61863
stp61864
a((dp61865
g2
(lp61866
VIf your values are not hashable, then there is no point in using a set
p61867
aVJust use a  instead
p61868
aVIf all your objects can do is test for equality, then you'd have to scan each element every time to test for membership
p61869
aVdoes just that, scan the list until an equality match is found:
p61870
aVwould give you a list of 'unique' values
p61871
aVYes, this is going to be slower than a set, but sets can only achieve O(1) complexity through hashes
p61872
aVIf your strings are orderable, you could speed up operations by using the  module to bring down tests to O(log N) complexity, perhaps
p61873
aVMake sure you insert new values using the information gleaned from the bisection test to retain the order
p61874
as(dp61875
g16
V100297
p61876
stp61877
a((dp61878
g2
(lp61879
VYou need to move your test for  inside the loop:
p61880
aVor, simplified a little:
p61881
aVDemo:
p61882
aVYou could also use a  object to do the counting for you, it has a  method to return results sorted on frequency:
p61883
as(dp61884
g16
V100297
p61885
stp61886
a((dp61887
g2
(lp61888
VUse string formatting:
p61889
aVThe  function applies string formatting to values
p61890
aVobjects can be formatted like floating point values
p61891
aVYou can also use this to interpolate the formatted decimal value is a larger string:
p61892
aVSee the format string syntax documentation
p61893
aVUnless you know exactly what you are doing, expanding the number of significant digits through quantisation is not the way to go; quantisation is the privy of accountancy packages and normally has the aim to round results to fewer significant digits instead
p61894
as(dp61895
g16
V100297
p61896
stp61897
a((dp61898
g2
(lp61899
VIt is additional syntax; the compiler looks for  after a  statement:
p61900
aVThe  results in different bytecode;  instead of
p61901
aVThis is the result of the Python grammar explicitly allowing for the extended syntax:
p61902
aVAt no point does the compiler interpret the  as a right-shift operator
p61903
aVRedirecting print output with this syntax is little used; you can just write directly to the file, or reassign to  instead
p61904
aVThe simple formatting options the  statement offers can easily be replicated using (much more powerful) string formatting in any case
p61905
aVPython 3's  function accepts a  keyword argument to achieve the same functionality
p61906
as(dp61907
g16
V100297
p61908
stp61909
a((dp61910
g2
(lp61911
VUse a list comprehension with :
p61912
aVmaking  a  instead will help speed things along:
p61913
aVDemo:
p61914
as(dp61915
g16
V100297
p61916
stp61917
a((dp61918
g2
(lp61919
VUse a list comprehension:
p61920
aVThis'll have to scan through  for each entry; you could optimize that quite a bit by using a dictionary indexing from character to position; this has the added advantage we can ensure we only have strings as well:
p61921
aVIf you then need a formatted string, turn the indices to strings and join the final output:
p61922
as(dp61923
g16
V100297
p61924
stp61925
a((dp61926
g2
(lp61927
V objects have a  method as well:
p61928
as(dp61929
g16
V100297
p61930
stp61931
a((dp61932
g2
(lp61933
VMake  class a subclass of :
p61934
aVNow  is an instance of (a subclass of)
p61935
aVNote that the code you quote is not exactly best practice; I'd rewrite it to at least use new-style classes, use  to call the superclass initializer, and to avoid  statements:
p61936
as(dp61937
g16
V100297
p61938
stp61939
a((dp61940
g2
(lp61941
VUse  to seek 1 position from the end, then use  to remove the remainder of the file:
p61942
as(dp61943
g16
V100297
p61944
stp61945
a((dp61946
g2
(lp61947
VYou do not have JSON data there, you have a Python string literal there
p61948
aVUse  to get a Python object again:
p61949
aVYou need to look into how you got that string in the first place
p61950
aVI suspect you stored the  output of the  result somewhere
p61951
as(dp61952
g16
V100297
p61953
stp61954
a((dp61955
g2
(lp61956
VThe server does not report the encoding of the content, and  (or rather ) mis-guesses the content encoding
p61957
aVUse the raw bytes instead:
p61958
as(dp61959
g16
V100297
p61960
stp61961
a((dp61962
g2
(lp61963
VUse  to parse each line back into a Python list:
p61964
aVtakes a string and interprets it as Python literal values; lists and floating point values are directly supported:
p61965
as(dp61966
g16
V100297
p61967
stp61968
a((dp61969
g2
(lp61970
VUse the public API instead of internals and leave worrying about content length and reading to the library:
p61971
aVor, since , you can use the  file object:
p61972
aVor
p61973
aVIf you must have a file-like object, then  can be used (provided  is set on the request, like done above), but then just use  calls without a length to read to EOF
p61974
aVIf you are however, not querying a resource that requires you to stream (anything but a large file request, a requirement to test headers first, or a web service that is explicitly documented as a streaming service), just leave off the  and use  or  for byte or unicode response data
p61975
aVIn the end, however, it appears your server is sending chunked responses that are malformed or incomplete; a chunked transfer encoding includes length information for each chunk and the server appears to be lying about a chunk length or sending too little data for a given chunk
p61976
aVThe decode error is merely the result of incomplete data having been sent
p61977
as(dp61978
g16
V100297
p61979
stp61980
a((dp61981
g2
(lp61982
VYou are mixing Unicode and byte string values
p61983
aVUse a unicode format:
p61984
aVDemo:
p61985
aVIn Python 3, strings are unicode values by default; in Python 2,  indicates a unicode value and regular strings () are byte strings
p61986
aVMixing a byte strings and unicode value results in automatic encoding or decoding with the default codec (ASCII), and that's what happens here
p61987
aVThe  method has to encode the Unicode value to a byte string to interpolate
p61988
as(dp61989
g16
V100297
p61990
stp61991
a((dp61992
g2
(lp61993
VYou are passing in a string;  must never a JSON encoded string, always a Python dictionary
p61994
aVThe  results are deceptive; JSON encoded objects look a lot like Python dictionary representations but they are far from the same thing
p61995
aVThe  API clearly states that  must be a dictionary:
p61996
aV\u2013 (optional) Dictionary of HTTP Headers to send with the
p61997
aVJSON data is something you'd send as content to another server, not something you'd use to communicate with a Python API
p61998
as(dp61999
g16
V100297
p62000
stp62001
a((dp62002
g2
(lp62003
VThe purpose of the VHM is just to communicate from a front-end reverse proxy to Zope what domain name and initial path generated URLs must use
p62004
aVIt does not support general rewriting
p62005
aVIt certainly does not support conditions based on HTTP headers
p62006
aVYou'd have to write a Zope request event handler to alter URLs based on HTTP headers
p62007
aVThis is not going to be easy unless you are prepared to write a new Python package for your server
p62008
aVThe easier method is to install nginx and having it handle rewriting for you, proxy for Zope and protect you against improperly behaving HTTP clients instead
p62009
as(dp62010
g16
V100297
p62011
stp62012
a((dp62013
g2
(lp62014
VThe  module does not create a new instance; instead it creates an empty class, and reassigns  on that object to specifically avoid the  or  methods of the original
p62015
aVYou'll need to provide a custom  hook to return the instance unchanged instead:
p62016
aVlooks up the  method directly on the class; it is instead found on the metaclass, looking up  on the class will return a bound method, and  (expecting an unbound method) passes in the instance explicitly
p62017
aVThis means that there will be two arguments passed in to ; the first is the class (an instance of the metaclass), the second the instance of that class ( in traditional methods)
p62018
aVUnfortunately,  is looked up on the instance instead, and the metaclass method is not found
p62019
as(dp62020
g16
V100297
p62021
stp62022
a((dp62023
g2
(lp62024
VNo, ZEO was never designed for such use
p62025
aVIt is designed for scaling ZODB access across multiple processes instead, with authentication and authorisation left to the application on top of the data
p62026
aVI would not use ZEO for anything beyond a local network anyway
p62027
aVUse a different protocol to handle communication between game clients and game server instead, keeping the ZODB server side only
p62028
as(dp62029
g16
V100297
p62030
stp62031
a((dp62032
g2
(lp62033
VPut a group around the text you want to keep and refer to that group by number in the replacement pattern:
p62034
aVNote that I used a  raw string to avoid having to use too many backslashes; you didn't need to add quite so many, however
p62035
aVI also adjusted the match for the following space; it now matches either a space or the end of the string
p62036
aVDemo:
p62037
as(dp62038
g16
V100297
p62039
stp62040
a((dp62041
g2
(lp62042
VPython 3 file objects are part of the  module, test against ABC classes in that module:
p62043
aVDon't use  in Python 2; you'd use  instead
p62044
aVEven then, you would want to test for the capabilities; something the  ABCs let you do; the  function will return  for any object that implements all the methods the Abstract Base Class defines
p62045
aVDemo:
p62046
as(dp62047
g16
V100297
p62048
stp62049
a((dp62050
g2
(lp62051
VImplement the  hook to hook into  index or item access:
p62052
aVTo support item assignment, you can implement , and deletion is handled by
p62053
aVYou can also opt to support slicing; when someone uses slice notation on your custom object, the  hooks are passed a slice object, you can then return values, set values or delete values as required based on the slice indices:
p62054
as(dp62055
g16
V100297
p62056
stp62057
a((dp62058
g2
(lp62059
VJust look for  files:
p62060
aVI took the liberty of simplifying your code somewhat; using a list to collect all classpath paths first, then use  to create a final string
p62061
aVThis is faster than concatenating each new path one by one
p62062
aVIf you are using a very old Python version and  is not yet available, use a  loop:
p62063
as(dp62064
g16
V100297
p62065
stp62066
a((dp62067
g2
(lp62068
VYour problem is that you are using , which will try to interpret the expression as a Python expression
p62069
aVPython expressions can raise any number of exceptions, but  is one of the least likely
p62070
aVCatch  instead:
p62071
aVwhich is the base class for all 'regular' exceptions
p62072
aVYou can assign the exception to a local name and print out the message with your error message:
p62073
aVThe better approach would be to parse the expression and perhaps use the functions of the  module to make the calculations
p62074
aVThe  exception is raised by the  function when input is closed without any data being received:
p62075
aVUnless you pass a string containing a  or  call to the  function you will not encounter that exception
p62076
as(dp62077
g16
V100297
p62078
stp62079
a((dp62080
g2
(lp62081
VMask the hash value with :
p62082
aVThis manually cuts the hash back to size
p62083
aVYou only need to limit the result once; it's not as if those higher bits make a difference for the final result
p62084
aVDemo:
p62085
as(dp62086
g16
V100297
p62087
stp62088
a((dp62089
g2
(lp62090
VImport  from  as well:
p62091
aVJust like ,  is a name in the  module, and can be imported into the  setup
p62092
as(dp62093
g16
V100297
p62094
stp62095
a((dp62096
g2
(lp62097
VThe line before the statement is missing a closing parenthesis, or curly or square bracket
p62098
aVThe lines you keep deleting are not the problem, but Python doesn't know this until it discovers that that next line makes no sense when it was looking for a comma or closing parenthesis instead
p62099
aVDemo; there should be two closing parenthesis:
p62100
as(dp62101
g16
V100297
p62102
stp62103
a((dp62104
g2
(lp62105
VIf you have a list of strings, then strip each element of whitespace and use  to join these together with a delimiter:
p62106
aVDemo:
p62107
as(dp62108
g16
V100297
p62109
stp62110
a((dp62111
g2
(lp62112
VCall ; just add the line:
p62113
aVat the bottom of your module
p62114
as(dp62115
g16
V100297
p62116
stp62117
a((dp62118
g2
(lp62119
VUse the new wheel format;  builds on  to bundle packages into a ZIP format
p62120
aVAlternatively, you could install an egg proxy; we use Buildout together with a local egg proxy to manage package dependencies and versioning in development and production enviroments
p62121
as(dp62122
g16
V100297
p62123
stp62124
a((dp62125
g2
(lp62126
VYou are missing a closing parenthesis in your  block:
p62127
aVThis causes Python to report a syntax error on the next line
p62128
aVAll you need to do is add that one missing ; you have 3 opening parens, but only 2 closing
p62129
as(dp62130
g16
V100297
p62131
stp62132
a((dp62133
g2
(lp62134
VJust print the  of , right where you currently print the whole list:
p62135
aVbut leave it at the top level (so dedent once):
p62136
aVand remove the  call, which prints the maximum whitespace count per line
p62137
aVYour  function adds  to your  list each time a space is found; not the most efficient method
p62138
aVYou don't even need to keep a list there;  needs to be moved out of the loop and will then correctly reflect the maximum space count
p62139
aVYou also don't have to turn the sentence into a list, you can directly loop over a string:
p62140
as(dp62141
g16
V100297
p62142
stp62143
a((dp62144
g2
(lp62145
VDon't interpolate values into your query yourself
p62146
aVLeave that to the database adapter, by using SQL parameters:
p62147
aVThe standard Python-MySQL adapter uses  as parameter placeholders, other database adapters may use  instead
p62148
aVThis has the added advantage that MySQL will figure out for you how to quote each value, prevent SQL injection attacks, and gives the database the chance to cache the query plan for the query and just slot in future values
p62149
as(dp62150
g16
V100297
p62151
stp62152
a((dp62153
g2
(lp62154
VYou forgot to create an instance of the symbol in your  function; when not a number, yield , not :
p62155
aVWith that one change your code prints:
p62156
as(dp62157
g16
V100297
p62158
stp62159
a((dp62160
g2
(lp62161
VSet the name outside of the function object:
p62162
aVNote that  does not replace values in strings in-place
p62163
aVIt returns the altered string, string values themselves are immutable
p62164
aVYour initial name will have to use , since the value of  is not known at the time you call
p62165
aVI'd leave out filling in of  in the name however; the function will not return that exact calculation the next time you call it with a different
p62166
aVWithout replacing  in the name each time you call the function,  would simply be:
p62167
aVTogether with adding  at the top of your  function, with the namechange per call in place still, gives:
p62168
as(dp62169
g16
V100297
p62170
stp62171
a((dp62172
g2
(lp62173
VYou don't want to use  here; you are toggling the whole element on or off, including the contents
p62174
aVYou only want to set the class attribute:
p62175
aVThis works fine for empty strings, you'll just get an empty  element; if  is , the attribute will be omitted altogether
p62176
as(dp62177
g16
V100297
p62178
stp62179
a((dp62180
g2
(lp62181
VWhen you create a new  object, you start a new program
p62182
aVYou are not communicating with an open  shell
p62183
aVYou either have to drive  directly by setting  to , or, much easier, use  to drive the  shell:
p62184
as(dp62185
g16
V100297
p62186
stp62187
a((dp62188
g2
(lp62189
VJust subtract 7 hours:
p62190
as(dp62191
g16
V100297
p62192
stp62193
a((dp62194
g2
(lp62195
VYou stumbled on a bug in Django 1
p62196
aV5: #19954 Storing of Binary fields leads to Exceptions
p62197
aVThe committed fix was to force decode the last executed query with 'replace':
p62198
aVYou can either edit your Django source code, or apply a monkeypatch:
p62199
aVDo so as early as possible, at the top of your  module or package, for example
p62200
aVI don't think the patch was backported; it so far only made it into the 1
p62201
aV6 development line, possibly because 1
p62202
aV6 added a new Binary field type
p62203
as(dp62204
g16
V100297
p62205
stp62206
a((dp62207
g2
(lp62208
VYou can nest the list comprehension:
p62209
aVYour  function fails to add strings without quotes in them, even though your sample output indicates those should be passed through unchanged
p62210
aVDemo:
p62211
as(dp62212
g16
V100297
p62213
stp62214
a((dp62215
g2
(lp62216
VUse the excellent  library, it has no problems parsing that URL:
p62217
as(dp62218
g16
V100297
p62219
stp62220
a((dp62221
g2
(lp62222
VThe code explicitly generates tuples:
p62223
aVThat's a 2-value tuple for each list element generated
p62224
aVThe list comprehension could be re-written as:
p62225
aVReplace the parenthesis with square brackets if you wanted to generate nested lists:
p62226
as(dp62227
g16
V100297
p62228
stp62229
a((dp62230
g2
(lp62231
VYou need to use SQL parameters; the  library uses  placeholders:
p62232
aVThis has the added advantage that sqlite3 will figure out for you how to quote each value, prevent SQL injection attacks, and gives the database the chance to cache the query plan for the query and just slot in future values
p62233
aVMake sure to commit your transaction
p62234
as(dp62235
g16
V100297
p62236
stp62237
a((dp62238
g2
(lp62239
VYou don't need to have an index on the loop at all; you already have the  element in your list
p62240
aVInstead, you want to get a counter for the  loop, it appears, and avoid the (expensive)  call
p62241
aVUsing the  function gives you just that:
p62242
aVThis uses string formatting to combine the output in an efficient and compact manner
p62243
aVNow the first argument is always an integer, so you can drop the  calls in
p62244
aVYou also were slicing just one element out of , so by passing in the  index (not plus one) you can simplify your overly complex  to:
p62245
aVThis drops the need for nested comprehensions all together; I also added a default to the  call, as  will throw an exception if the normal default  is returned
p62246
aVI suspect the rest of your program could do with similar simplifications; you may want to post it on http://codereview
p62247
aVstackexchange
p62248
aVcom/ to see what else can be adjusted
p62249
as(dp62250
g16
V100297
p62251
stp62252
a((dp62253
g2
(lp62254
VThe I/O infrastructure was overhauled in Python 3, completely replacing the old Python 2 file object with a new object hierarchy
p62255
aVWhen you open a file in text mode, you get an object implementing the  interface, which wraps a  object, which in turn wraps something implemting the  interface; many methods on the former two are just proxies for methods on the object they wrap
p62256
aVNeither the  nor the  classes have docstrings on these various proxy methods
p62257
aVYou can reach down to the raw I/O object with  and get the help info on the  method there:
p62258
aVYou could also make a case that this is a bug; arguably the proxy methods should at least have a docstring that states that they pass on the call to their underlying object so you can find the original method
p62259
aVA pointer to the  attribute would be helpful, in such cases
p62260
aVFeel free to make that case over at the Python issue tracker
p62261
as(dp62262
g16
V100297
p62263
stp62264
a((dp62265
g2
(lp62266
V already includes a newline in the output
p62267
aVUse  instead, and write only one  header
p62268
aVAfter the headers, write only one more  combo
p62269
aVMost CGI implementations actually will translate regular  to  for you, so you could just print the headers without adding separators:
p62270
aVFor then streaming the proxied request, I'd use the  file object and pass it through to  with :
p62271
aVI doubt a flush is required, not if Python exits at that point and flushes  on close
p62272
as(dp62273
g16
V100297
p62274
stp62275
a((dp62276
g2
(lp62277
VYou are generating incorrect SQL; you probably want a  (with a space and  to match both criteria
p62278
aVAlso, you should not use string interpolation, use SQL parameters instead:
p62279
aVThis applies to all your queries, like:
p62280
aVand:
p62281
aVNote that the parameters are passed into the  calls as a second argument (a sequence of values)
p62282
as(dp62283
g16
V100297
p62284
stp62285
a((dp62286
g2
(lp62287
VBecause you are always replacing  with a replacement on , you overwrite any successful matching
p62288
aVEither test first if the month is in the string before replacing, or replace  with  results:
p62289
aVor, using testing:
p62290
aVThe latter still will result in  being overwritten if more than one month name is found
p62291
aVAlternatively, if there is only ever going to be one month match, use  to end the loop early:
p62292
aVCaveat: if no match is ever found,  will never have been assigned to and you'll get a  exception
p62293
as(dp62294
g16
V100297
p62295
stp62296
a((dp62297
g2
(lp62298
VYou are passing a list to , and a list is an iterator
p62299
aVWhen you do that, the iterator is seen as a sequence of strings to write to the browser, not as an object to turn into a string
p62300
aVFrom the  documentation:
p62301
aVFinally, you can pass HttpResponse an iterator rather than strings
p62302
aVIf you use this technique, the iterator should return strings
p62303
aVand, further down the page:
p62304
aVcontent should be an iterator or a string
p62305
aVIf it\u2019s an iterator, it should return strings, and those strings will be joined together to form the content of the response
p62306
aVIf it is not an iterator or a string, it will be converted to a string when accessed
p62307
aVTurn the list into a string first then publish it:
p62308
as(dp62309
g16
V100297
p62310
stp62311
a((dp62312
g2
(lp62313
VBecause  is a tuple, which is one argument
p62314
aVThe following does the same as your function and works:
p62315
aVWithout the extra parenthesis, you are calling  with four separate arguments, so the first argument is not a tuple of 4 integers but just one integer
p62316
aVThat doesn't work, because  expects the first argument to be a sequence instead
p62317
aVAn optional second argument can be used to give a different start value (default is 0), which means  takes at most 2 arguments
p62318
as(dp62319
g16
V100297
p62320
stp62321
a((dp62322
g2
(lp62323
VYou are importing  in the inner function:
p62324
aVThat makes  a local in your inner function and will never be looked up as a closure
p62325
aVDo not rename the import; instead, assign  to
p62326
aVor perhaps name the outer  to  or similar
p62327
aVNow  is never assigned to in the inner function, and remains a non-local reference to the outer scope
p62328
as(dp62329
g16
V100297
p62330
stp62331
a((dp62332
g2
(lp62333
VYou are almost there; don't make  a nested list:
p62334
aVYou are nesting the  list; you put it inside another list, which then has just one element
p62335
aVLooping over that will run once, and print the whole list object
p62336
aVIn other words,  is already a list, and the  statement will loop over it directly without any extra list syntax
p62337
as(dp62338
g16
V100297
p62339
stp62340
a((dp62341
g2
(lp62342
V is not a file object
p62343
aVIt is a string, the result of the  call:
p62344
aVThe next line, the  call, is not assigned to anything:
p62345
aVPerhaps you wanted to truncate that object
p62346
aVFor example:
p62347
aVHowever, opening a file for writing (mode set to ) already truncates the file, your  calls are entirely redundant
p62348
as(dp62349
g16
V100297
p62350
stp62351
a((dp62352
g2
(lp62353
VIn  you assign to :
p62354
aVso you need to mark that name as a global inside that function too
p62355
aVAdd a  statement in that function
p62356
aVon the other hand, never tries to assign to  and the  statement in that function can safely be removed
p62357
as(dp62358
g16
V100297
p62359
stp62360
a((dp62361
g2
(lp62362
VJust use a list comprehension:
p62363
aVDemo:
p62364
as(dp62365
g16
V100297
p62366
stp62367
a((dp62368
g2
(lp62369
VInstead of assuming the path starts with a slash, and concatenating using , use  to create the path:
p62370
aVNote that I strip , and  from the start of  to remove any accidental start characters from the user input, then use  to make sure the path is a canonical path, with any  and  entries resolved
p62371
aVYou do then need to verify that the final result is still within the users' directory and not outside of it
p62372
aVYou could test with  to see if the  path actually points to an actual file before running
p62373
as(dp62374
g16
V100297
p62375
stp62376
a((dp62377
g2
(lp62378
VHit CTRL-C and look at the traceback
p62379
aVFor example, the following code will hit a never-ending loop:
p62380
aVand when I interrupt it I see:
p62381
aVThe traceback ends in , on line 5
p62382
aVThis is where Python was busy when I interrupted the program
p62383
aVThe traceback also tells me that first  was called, which called , so I can see how we got there
p62384
aVNote that if you have a bare  handler this won't necessarily work; catching all exceptions with   catches  too
p62385
aVAlways use  at a minimum to prevent catching system exceptions
p62386
as(dp62387
g16
V100297
p62388
stp62389
a((dp62390
g2
(lp62391
VUse the  SQL function:
p62392
aVYou can update your whole   column to remove the newline characters altogether:
p62393
as(dp62394
g16
V100297
p62395
stp62396
a((dp62397
g2
(lp62398
VUse  to remove the directory and don't bother with removing the file:
p62399
aVThe  works just fine (it won't return until the file remove completes), there must be other files in that directory that the process left behind and are removed during your  call
p62400
as(dp62401
g16
V100297
p62402
stp62403
a((dp62404
g2
(lp62405
VNot out of the box, no
p62406
aVYou can either subclass  or create a generator function that maps your rows for you:
p62407
aVFor Python 3, substitute  for , as Python 3 returns dictionary views by default
p62408
aVWrap your  with that, adding conversion functions for each of your columns:
p62409
aVfor column names that don't map to a python identifier (with spaces, etc
p62410
aVpass in a dictionary with  syntax:
p62411
as(dp62412
g16
V100297
p62413
stp62414
a((dp62415
g2
(lp62416
VYour  method returns a True value, always
p62417
aVYour  is never called, as the first  is always true instead:
p62418
aVYour  method returns  in case the value does not exist in the tree, and a non-empty tuple is always True:
p62419
aVReturn simply just  instead, not a tuple:
p62420
aVor, by using the short-circuiting nature of  and the fact that  exits the function immediately:
p62421
aVWith this change your binary tree works fine:
p62422
as(dp62423
g16
V100297
p62424
stp62425
a((dp62426
g2
(lp62427
VI am missing the point why Python3 has commands are not compatible with Python2
p62428
aVBecause Python 3 is not the same language as Python 2
p62429
aVPython releases normally are mostly backwards compatible with previous versions; Python 2
p62430
aV7 is largely backwards compatible with Python 2
p62431
ag5279
aVHowever, from the start, Python 3 (or 3000 as its design project originally codenamed) was specifically different
p62432
aVQuoting from one of the design documents:
p62433
aVPython 3000 will introduce a number of backwards-incompatible changes to Python, mainly to streamline the language and to remove some previous design mistakes
p62434
aVSo, Python 3 is not backwards compatible to correct specific errors in the language that could not be corrected with backwards compatible changes
p62435
aVThe use of a statement to write to  instead of a function is one of those changes;  has been replaced by a function
p62436
aVDifferent language and software projects use different standards for what their version numbers mean
p62437
aVPython sticks to the major-minor-micro scheme; releases within the same major number are largely backwards compatible, releases within the same minor number only contain bug fixes
p62438
aVSee the Python version number FAQ:
p62439
aVPython versions are numbered  or
p62440
aVis the major version number \u2013 it is only incremented for really major changes in the language
p62441
aVis the minor version number, incremented for less earth-shattering changes
p62442
aVis the micro-level \u2013 it is incremented for each bugfix release
p62443
aVSee PEP 6 for more information about bugfix releases
p62444
aVPython is also quite a bit older than C#
p62445
aVPython development started in 1989, and version 2
p62446
aV0 came out in 2000
p62447
aVC# on the other hand has only been around since 2002; perhaps in another decade or so it too will see a backwards-incompatible change
p62448
as(dp62449
g16
V100297
p62450
stp62451
a((dp62452
g2
(lp62453
VUse a list comprehension with :
p62454
aVDemo:
p62455
aVThe  method also takes an optional  argument, the starting index from which to search (defaults to 0), so you could build a loop with the last location + 1 to collect all indices:
p62456
aVIf speed is an issue, then this last method is actually the faster option of the two:
p62457
as(dp62458
g16
V100297
p62459
stp62460
a((dp62461
g2
(lp62462
V returns a list
p62463
aVIf you wanted just one element, use  instead, which returns the first result:
p62464
aVThe square brackets are the result of you calling  on the list object
p62465
aVAlternatively, use an index to get one element out:
p62466
aVor loop over  elements
p62467
aVHowever, it looks as if you wanted to extract all text from the  element
p62468
aVDon't use a regular expression, just ask BeautifulSoup for all text content:
p62469
as(dp62470
g16
V100297
p62471
stp62472
a((dp62473
g2
(lp62474
VYou are feeding a string to ; this means that it'll generate permutations for all possible combinations of the characters:
p62475
aVYour phrase is 21 characters long, resulting in 21
p62476
aV(factorial) == 51090942171709440000 different permutations; each a tuple of 21 characters
p62477
aVOne such tuple takes, on my 64bit Mac, a total of 21 * 38 + 224 bytes = 1022 bytes of memory
p62478
aVThe characters are interned, so you really only need to memory per tuple, and can ignore the 768 bytes for the characters
p62479
aVThat's then 51090942171709440000 * 224 bytes is almost 10 zebibytes
p62480
aVThat's a whole  lotta memory
p62481
aVYou probably did not want to generate all possible 21-character permutations of the phrase
p62482
aVYou need to rethink what you want to do with your method, generate fewer outputs and only loop over the generated combinations one by one, not try to expand all of them into a list object
p62483
aVI suspect you wanted to create permutations for any of the matched words, but your regular expression doesn't give you individual matched words
p62484
aVYou cannot repeat capturing groups, you need to capture the whole, then split afterwards:
p62485
aVThe  groups are non-capturing groups, to avoid cluttering up our results
p62486
aVThis now gives two capturing groups, one with comma-separated nouns, and one with the last noun
p62487
aVSplit the first on whitespace and commas:
p62488
aVand now you can permute those nouns:
p62489
aVBecause your sample results in only 3 nouns, the 6 permutations are safe to turn into a list:
p62490
aVWe could perhaps re-combine these into sentences:
p62491
as(dp62492
g16
V100297
p62493
stp62494
a((dp62495
g2
(lp62496
VUse a list comprehension, and use  to parse your values (converted to strings):
p62497
aVDemo:
p62498
aVI used  to format the floats as a string without the decimal point for ease of parsing
p62499
as(dp62500
g16
V100297
p62501
stp62502
a((dp62503
g2
(lp62504
VThe  library produces generators, and generators can only be iterated over once
p62505
aVThen they are simply exhausted and will not produce their values again:
p62506
aVThe  version, on the other hand, produces new generator objects
p62507
aVYou could have used a list comprehension too:
p62508
aVNow each object in that list is a separate generator object, that can be iterated over independently
p62509
aVYou can test that the objects are different:
p62510
as(dp62511
g16
V100297
p62512
stp62513
a((dp62514
g2
(lp62515
VUse a list comprehension instead:
p62516
aVand retain instead of delete
p62517
aVYour filter never returned the test; so you always return  instead and that's false in a boolean context
p62518
aVThe following works just fine:
p62519
aVYour initial attempt failed because  unbinds , but the list remains unaffected
p62520
aVOnly the local name  is cleared
p62521
aVIf you want to delete an item from a list, you need to delete the index:
p62522
aVdeletes the first element from the list
p62523
aVEven if you did manage to delete indices the loop would have held some suprises:
p62524
aVThis version fails because the list iterator used by the  loop doesn't know you deleted elements from the list; deleting the value at index 0 shifts up the rest of the list, but the loop iterator looks at item 1 regardless:
p62525
aVfirst iteration,  , iterator index 0 ->
p62526
aVsecond iteration, ,    iterator index 1 ->
p62527
as(dp62528
g16
V100297
p62529
stp62530
a((dp62531
g2
(lp62532
VBeautifulSoup gives you Unicode data, which you need to encode before writing it to a file
p62533
aVIt'll be easier if you use the  library, which lets you open a file object with transparent encoding:
p62534
aVThe  statement takes care of closing the file object for you
p62535
aVI used UTF8 as the codec, but you can pick any that can handle all codepoints used in the pages you are scraping
p62536
as(dp62537
g16
V100297
p62538
stp62539
a((dp62540
g2
(lp62541
VUse string interpolation, like :
p62542
aVBut do heed the warnings on the  documentation about executing untrusted commands in your shell
p62543
as(dp62544
g16
V100297
p62545
stp62546
a((dp62547
g2
(lp62548
VDictionary keys must be unique
p62549
aVYou have only one unique key in that file
p62550
aVYou are in essence assigning different values to the same key, and only the last value is visible as the previous values are overwritten:
p62551
aVTo store the largest value, use:
p62552
as(dp62553
g16
V100297
p62554
stp62555
a((dp62556
g2
(lp62557
VYou are looking to monkeypatch
p62558
aVDon't create a subclass, replace the  method directly on :
p62559
aVReplacing the whole class is possible too, but needs to be done early (before other modules have imported the class):
p62560
as(dp62561
g16
V100297
p62562
stp62563
a((dp62564
g2
(lp62565
VPython int types can outrun your platform word size with ease, but floating point values are tied to the hardware
p62566
aVDon't mix long int and floating point values
p62567
aVIn your first sample, the size of the first integer number far outstrips the maxim precision of floating point numbers
p62568
aVOn a 64bit Mac, the maximum number of decimal digits that a float can represent is 15:
p62569
aVbut your integers use 20 digits
p62570
aVTo match the exponent the 16
p62571
aV0 float has to be truncated to 15 significant digits and that means it is basically rounded to 0
p62572
aVIf you have to use floating point arithmetic with long integers, use the  type, it is not limited by hardware:
p62573
as(dp62574
g16
V100297
p62575
stp62576
a((dp62577
g2
(lp62578
VInstead of using , use the  library; it sets the TCP Keep-Alive option letting you detect ISP disconnects
p62579
aVYou may need to set additional socket options; the  library uses  to detect if sockets are still available, and sets timeouts, but adding an explicit KEEPALIVE option to the socket should make detection a little smoother still:
p62580
as(dp62581
g16
V100297
p62582
stp62583
a((dp62584
g2
(lp62585
VYou could append empty lists until you have enough to access the index you have data for:
p62586
aVHowever, you may want to use a dictionary instead, letting you implement a sparse object instead
p62587
aVA  object is especially useful here:
p62588
aVnow has keys  and , each a list with one element
p62589
aVNo entries for , , , or  exist yet
p62590
as(dp62591
g16
V100297
p62592
stp62593
a((dp62594
g2
(lp62595
VYou'll need to pin  to use a version before version 2
p62596
ag2391
aVThat version introduced syntax that requires Python 2
p62597
aV6 or newer (to make the package work on Python 3 as well)
p62598
aVIn your buildout versions section, add:
p62599
as(dp62600
g16
V100297
p62601
stp62602
a((dp62603
g2
(lp62604
VYou already have a list; the commas are put there by Python to delimit the values only when printing the list
p62605
aVJust access element 2 directly:
p62606
aVThis prints:
p62607
aVEach of the entries in  (so ) is a list of two float values, so you can address each of those with index 0 and 1:
p62608
aVTo get a list of all the second values, you could use a list comprehension:
p62609
as(dp62610
g16
V100297
p62611
stp62612
a((dp62613
g2
(lp62614
VYour source input is wrong
p62615
aVHowever you entered your  and  literals, Python did not read the right unicode codepoints
p62616
aVInstead, I strongly suspect something like the  variable has been set with the error handler set to
p62617
aVThis causes Python to replace all codepoints that it does not recognize with question marks
p62618
aVAll cyrillic input is treated as not-recognized
p62619
aVAs a result, the only codepoint in your translation map is 63, the question mark, mapped to the last character in  (which is expected behaviour for the dictionary comprehension with only one unique key):
p62620
aVThe same problem applies to your  unicode string; it too consists of only question marks
p62621
aVThe translation mapping replaces each with the letter :
p62622
aVYou need to either avoid entering Cyrillic literal characters or fix your input method
p62623
aVIn the terminal, this is a function of the codec your terminal (or windows console) supports
p62624
aVConfigure the correct codepage (windows) or locale (POSIX systems) to input and output an encoding that supports Cyrillic (UTF-8 would be best)
p62625
aVIn a Python source file, tell Python about the encoding used for string literals with a codec comment at the top of the file
p62626
aVAvoiding literals means using Unicode escape sequences:
p62627
as(dp62628
g16
V100297
p62629
stp62630
a((dp62631
g2
(lp62632
VUse concatenation:
p62633
aVIn other words, generate a sublist that either has the optional element in it, or is empty
p62634
aVDemo:
p62635
aVThis concept works for more elements too, of course:
p62636
as(dp62637
g16
V100297
p62638
stp62639
a((dp62640
g2
(lp62641
VStick it at the top of the loop:
p62642
aVNow it'll skip any directory that is not named  or
p62643
as(dp62644
g16
V100297
p62645
stp62646
a((dp62647
g2
(lp62648
VUsing the  module:
p62649
aVDemo:
p62650
aVAdding the time is trivial; use  instead of
p62651
as(dp62652
g16
V100297
p62653
stp62654
a((dp62655
g2
(lp62656
VTranslating the  module  to a standalone version:
p62657
aVThis does without the  package dependency as well
p62658
aVDemo:
p62659
as(dp62660
g16
V100297
p62661
stp62662
a((dp62663
g2
(lp62664
VTo determine what specific character that is, you can use  or  to get (in Python 2) a ASCII-printable representation of the character:
p62665
as(dp62666
g16
V100297
p62667
stp62668
a((dp62669
g2
(lp62670
VThat's because SQLAlchemy filters are one of the few places where  actually makes sense
p62671
aVEverywhere else you should not use it
p62672
aVAdd a  comment to the line and be done with it
p62673
aVOr you can use :
p62674
aVwhere  returns the right value for your session SQL dialect
p62675
aVThere is a matching
p62676
as(dp62677
g16
V100297
p62678
stp62679
a((dp62680
g2
(lp62681
V is just a list of dictionaries, so you can access the  key directly:
p62682
aVYou can check if any item in  matches with :
p62683
aVor you can search for the matching product with a loop:
p62684
aVwhich matches multiple  entries and gives you the matching dictionary
p62685
aVThis does all get inefficient fast; you are looping over both lists, creating N*M loops
p62686
aVYou can reduce that by turning your initial  list into a dictionary for fast O(1) constant time lookups:
p62687
aVThis does assume that product names are unique
p62688
aVNow you can just look up the product name directly:
p62689
as(dp62690
g16
V100297
p62691
stp62692
a((dp62693
g2
(lp62694
VThe  connection context manager manages transactions, not the connection
p62695
aVThe  handler commits or rolls back, it does not close the connection
p62696
aVSee Using the connection as a context manager:
p62697
aVConnection objects can be used as context managers that automatically commit or rollback transactions
p62698
aVIn the event of an exception, the transaction is rolled back; otherwise, the transaction is committed
p62699
aVYou'll have to explicitly close the connection yourself, or use the  context manager:
p62700
as(dp62701
g16
V100297
p62702
stp62703
a((dp62704
g2
(lp62705
VYou can't, I am afraid
p62706
aVThe schema fieldsets are always merged in reverse interface resolution order; base before derived interface
p62707
aVDeclaring the fieldset again on the  schema will only result in the fieldset being listed twice
p62708
aVIf you have to control fieldset order, don't derive from the base schema but re-declare it
p62709
as(dp62710
g16
V100297
p62711
stp62712
a((dp62713
g2
(lp62714
VLoop through the keys and values using the  or  methods; the latter lets you iterate without building an intermediary list of key-value pairs:
p62715
aVLooping directly over dictionaries gives you keys instead; you can still access the values by using subscription:
p62716
as(dp62717
g16
V100297
p62718
stp62719
a((dp62720
g2
(lp62721
V returns a string value
p62722
aVTurn it into an integer first:
p62723
aVSince Python 2 sorts numbers before strings, always, your  test will always return True, no matter what was entered:
p62724
aVPython 3 rectifies this:
p62725
aVNote that if the user does not enter a valid number,  will throw a :
p62726
aVYou may want to explicitly handle that:
p62727
as(dp62728
g16
V100297
p62729
stp62730
a((dp62731
g2
(lp62732
VBecause your data is not sorted, use a  object to materialize a list for new keys, then key by film title:
p62733
aVThe  value is used to group the films
p62734
aVYou would have to create a canonical version of that key if you wanted to use more sophisticated title grouping
p62735
aVDemo:
p62736
aVUsing SoundEx to group films would be as simple as:
p62737
aVresulting in:
p62738
as(dp62739
g16
V100297
p62740
stp62741
a((dp62742
g2
(lp62743
VYou have no objects
p62744
aVYou have only got functions, and the  name is a local variable
p62745
aVYou do return a tuple of both  and , but you ignore that return
p62746
aVUse tuple assignment to capture both:
p62747
as(dp62748
g16
V100297
p62749
stp62750
a((dp62751
g2
(lp62752
VYou cannot pass strings into
p62753
aVIt requires you pass in  or  objects
p62754
aVYour JSON data contains ISO8601 format timestamps, which is the the most parsable format available
p62755
aVYou already have the  library, just use that to parse the strings first:
p62756
aVDemo:
p62757
as(dp62758
g16
V100297
p62759
stp62760
a((dp62761
g2
(lp62762
VBecause Windows environment variables are case insensitive, but a Python dictionary is case sensitive
p62763
aVFrom the
p62764
aVBy uppercasing all entries, you ensure that you'll always be able to match entries
p62765
aVQuoting from the Python  source code:
p62766
aVNote that the  object translates all access to uppercase, including searches:
p62767
aVThis means that if a program fails to find , then the value is not set
p62768
aVIf you have to have access to the original values, grab them from the  module:
p62769
aVThat's the raw initial dictionary as passed in by the OS, unaltered:
p62770
as(dp62771
g16
V100297
p62772
stp62773
a((dp62774
g2
(lp62775
VYou can always delete names from the global namespace again:
p62776
aVbut really, use functions to fill specific tasks
p62777
aVIt will make your code more maintainable and easier to read
p62778
as(dp62779
g16
V100297
p62780
stp62781
a((dp62782
g2
(lp62783
VYou are comparing strings to floating point values
p62784
aVThey'll never be the same because they are not the same basic type
p62785
aVCompare with strings:
p62786
aVor convert ,  and  to floats first
p62787
aVDo note that floating point comparisons are also fraught with problems as floating point numbers have a finite limit to their precision
p62788
aVSee floating point equality in Python and in general for example
p62789
as(dp62790
g16
V100297
p62791
stp62792
a((dp62793
g2
(lp62794
VYou need to import the  object in your module:
p62795
aVat the top of
p62796
aVIn your interpreter session you probably already imported the object
p62797
aVYour whole module will then look like:
p62798
aVwhere I replaced  with , since that is the name of the actual argument to the function
p62799
aVNote that the  module contains a  class, which is the only thing imported here
p62800
aVIf you need access to the  and  classes as well, import these explicitly () or import just the module and refer to the contents as attributes (, then  and , etc
p62801
as(dp62802
g16
V100297
p62803
stp62804
a((dp62805
g2
(lp62806
VThe label initializer, like all Python methods, has a  first arguments
p62807
aVIt accepts only up to two additional positional arguments (the master and  arguments), but you are giving 3:
p62808
aVYou probably wanted to concatenate those two strings; you'll have to pass this in explicitly as the  keyword argument:
p62809
as(dp62810
g16
V100297
p62811
stp62812
a((dp62813
g2
(lp62814
VYou are calling  on the class itself:
p62815
aVThis is an unbound function, so  will not be filled in for you
p62816
aVYou also create an instance somewhere:
p62817
aVPerhaps you meant to call  instead
p62818
as(dp62819
g16
V100297
p62820
stp62821
a((dp62822
g2
(lp62823
V is a string, so  fails
p62824
aVYou'll have to convert it to an  first, before subtracting 1:
p62825
as(dp62826
g16
V100297
p62827
stp62828
a((dp62829
g2
(lp62830
VYou would add the  variable to the environment variables; the arguments are extre elements of the argument list:
p62831
as(dp62832
g16
V100297
p62833
stp62834
a((dp62835
g2
(lp62836
VYour line parsing code doesn't match the format of the file
p62837
aVYou are trying to interpret the whole line as an integer, but the line contains more
p62838
aVPerhaps you wanted to split the line first
p62839
aVThat one line contains all elements of the record:
p62840
aVYou can override the original  method by subclassing the class in your own code:
p62841
aVThen use  instead of
p62842
as(dp62843
g16
V100297
p62844
stp62845
a((dp62846
g2
(lp62847
VThe first version will still run the  suite even when the  handler raises a new exception
p62848
aVIn the second version, the final  will not be executed in that case:
p62849
aVNote that the first thing printed in  is ; no such text is printed for
p62850
aVYou never need to explicitly execute a  suite; it is always run, even if you were to exit the function early with , or break out of a loop with  or use  to skip the rest of the loop body:
p62851
aVQuoting from the  statement documentation:
p62852
aVIf  is present, it specifies a \u2018cleanup\u2019 handler
p62853
aVThe  clause is executed, including any  and  clauses
p62854
aVIf an exception occurs in any of the clauses and is not handled, the exception is temporarily saved
p62855
aVThe  clause is executed
p62856
aVIf there is a saved exception it is re-raised at the end of the  clause
p62857
aVand
p62858
aVWhen a ,  or  statement is executed in the  suite of a
p62859
aVstatement, the  clause is also executed \u2018on the way out
p62860
aV\u2019
p62861
as(dp62862
g16
V100297
p62863
stp62864
a((dp62865
g2
(lp62866
VTry out the components for 9:
p62867
aVNumeric 0 is false in a boolean context, and any other number is considered true
p62868
aVis therefor true
p62869
aVFor any other number, the combination never returns true values for both tests:
p62870
aVIn other words, only numbers that are not divisible by 2 but are divisible by 3 are picked
p62871
aVTo simplify understanding, you could explicitly test for numeric 0 instead:
p62872
as(dp62873
g16
V100297
p62874
stp62875
a((dp62876
g2
(lp62877
VYou misunderstand the pattern
p62878
aVThere is no group around the joint list of nouns, so the first  is part of the  option, the  and  options have no spaces, and the  option includes the final  meta character
p62879
aVYou want to put a group around the nouns to delimit what the  option applies to:
p62880
aVThe non-capturing group here () puts a limit on what the  options apply to
p62881
aVThe  spaces are now outside of the group and are thus not part of the 4 choices
p62882
aVYou need to use a non-capturing group because if you were to use a regular (capturing) group  would return just the noun, not the spaces
p62883
aVDemo:
p62884
aVNow both spaces are part of the output
p62885
as(dp62886
g16
V100297
p62887
stp62888
a((dp62889
g2
(lp62890
VYou need to use SQL parameters for each value
p62891
aVFor the  statement, that means you need to generate the parameters:
p62892
aVwhere I assume that  is a list of values to test  against
p62893
aVIf  is 3 elements (like ) then the generated SQL will look like:
p62894
aVThen pass those paramaters to the  call:
p62895
aVI used the  named SQL parameter style here as that is what the  uses
p62896
aVConsult your database connector documentation for the exact supported parameter styles
p62897
aVThe  named SQL parameter style requires that you pass in parameters as a dictionary, so the above code generates the right keys for the  items
p62898
as(dp62899
g16
V100297
p62900
stp62901
a((dp62902
g2
(lp62903
VYou are looking at the old SVN repository; Python has since moved to mercurial
p62904
aVI'd look at he 2
p62905
aV7 version of ; the source has an  object
p62906
aVWhen you call  you create a new instance of that object, so  is called
p62907
aVWith 3 arguments,  in the C struct is set to ,  to
p62908
aVis left as ,  is set to
p62909
aVMost importantly,  is set to
p62910
aVThen the object is returned
p62911
aVAll the iteration work is done in , where  is iterated over according to the next, stop and step values
p62912
aVis incremented and  is called as needed to advance the object until  is equal or greater to ; after that, for each call to  an item is yielded while  and  are incremented until  is reached
p62913
as(dp62914
g16
V100297
p62915
stp62916
a((dp62917
g2
(lp62918
VUse the  function to test each value:
p62919
aVwhere I renamed  to   to avoid masking the built-in type
p62920
aVwill only advance the generator expression passed to it until a  value is returned; this means only the first 3 options are tested for your example
p62921
aVYou could use  here:
p62922
aVto limit matches to only those that end with any of the special characters
p62923
as(dp62924
g16
V100297
p62925
stp62926
a((dp62927
g2
(lp62928
VUse  with a generator expression to generate the inversions:
p62929
aVThe  generator expression produces 3 arguments to , each a tuple consisting of both a sublist and the inversion of that sub list of :
p62930
as(dp62931
g16
V100297
p62932
stp62933
a((dp62934
g2
(lp62935
VWhen you import , all code at the top level is executed
p62936
aVThat includes parsing  values
p62937
aVMove whatever should only be executed when running the module as a script to a block guarded by a test for the module name; if the name is  then your code is run as a script, otherwise it was imported as a module:
p62938
aVNow, when you import , only the  class will be defined; the rest of the code will not be run
p62939
as(dp62940
g16
V100297
p62941
stp62942
a((dp62943
g2
(lp62944
VThere is a huge difference
p62945
aVraises a  exception, which Python always catches and turns into a program exit code
p62946
aVRaising , if uncaught, triggers the  handler, after which Python exits
p62947
aVThe default except hook prints the traceback of the exception to , after which Python exits with an exit code of 1
p62948
aVThe  function is never called for , so you cannot customize the handling of that exception, but you can handle the handling of  and other exceptions
p62949
as(dp62950
g16
V100297
p62951
stp62952
a((dp62953
g2
(lp62954
VYou are creating a circular import
p62955
aVimports  which tries to import
p62956
aVDon't do this
p62957
aVBy the time  imports , that module has not completed executing all the code; the function is not yet defined:
p62958
aVis compiled and executed, and an empty module object is added to
p62959
aVThe line  is run
p62960
aVis compiled and executed, and an empty module object is added to
p62961
aVThe line  is run
p62962
aVis already present as a module in , this object is returned and bound to the name
p62963
aVA next line tries to run
p62964
aVNo such name exists in
p62965
aVAn exception is raised
p62966
aVThe lines defining  are never executed, because an exception was raised
p62967
aVRemove the  line, and run  directly, and importing the function will work fine:
p62968
as(dp62969
g16
V100297
p62970
stp62971
a((dp62972
g2
(lp62973
VWhen you create an instance of the  class, it'll do the parsing for you and store the results in an instance attribute,
p62974
aVSimply access that attribute:
p62975
as(dp62976
g16
V100297
p62977
stp62978
a((dp62979
g2
(lp62980
VYou have UTF-8 encoded data (there is no such thing as UNICODE encoded data)
p62981
aVEncode the unicode value to Latin-1, then decode from UTF8:
p62982
aVLatin 1 maps the first 255 unicode points one-on-one to bytes
p62983
aVDemo:
p62984
as(dp62985
g16
V100297
p62986
stp62987
a((dp62988
g2
(lp62989
VThe  response is not a string:
p62990
aVbut ElementTree will turn it into text
p62991
aVThe claimed encoding is UTF16 however:
p62992
aVTurn this response into text by  explicitly encoding it to UTF-16:
p62993
as(dp62994
g16
V100297
p62995
stp62996
a((dp62997
g2
(lp62998
VYou are encoding your data to JSON twice
p62999
aVis already JSON encoded, but you encode it again by dumping the JSON string to
p63000
aVJust write it out without encoding again:
p63001
aVDo remove the  option, as  will then produce unicode values, which would require you to encode them to a suitable codec (read, one of the UTF variants) as you write to the file
p63002
as(dp63003
g16
V100297
p63004
stp63005
a((dp63006
g2
(lp63007
VYou'd normally close the connection to the ZODB between tests, to make sure the tests are isolated
p63008
aVClosing a ZODB connection with an active transaction will raise an exception:
p63009
as(dp63010
g16
V100297
p63011
stp63012
a((dp63013
g2
(lp63014
VStore a set of  iterables in a dictionary, to keep a counter per unique column value
p63015
aVIf you use , you can have the count start at 1 automatically whenever you encounter a new unique value
p63016
aVYour data is already sorted, so all you need to do is replace the 10th column:
p63017
aVThat's it
p63018
aVis the 10th column; it'll be filled with numbers starting at 1 for each unique value found in  (the 3rd column)
p63019
aVQuick demo of the counters dictionary:
p63020
aVRunning the above code on your sample data set results in:
p63021
as(dp63022
g16
V100297
p63023
stp63024
a((dp63025
g2
(lp63026
VYou are running code written for Python 3, with Python 2
p63027
aVThis won't work
p63028
aVis a classmethod on the  built-in type, but only in Python 3
p63029
aVIn Python 2,  is an alias for , but that type does not have that method:
p63030
aVRun your code with Python 3 instead, or translate all code in this project to Python 2; the latter requires in-depth knowledge of how Python 2 and 3 differ and is likely a major undertaking
p63031
aVJust the illustrated function, translated to Python 2, would be:
p63032
as(dp63033
g16
V100297
p63034
stp63035
a((dp63036
g2
(lp63037
VStandard Python  objects do not have a timezone object attached to them
p63038
aVThe system time is taken as is
p63039
aVYou'll need to install Python timezone support in the form of the  package; timezone definitions change too frequently to be bundled with Python itself
p63040
aVdoes not tell you what timezone your machine has been configured with
p63041
aVYou can use the  module for that; it has a  function that returns the timezone currently in use
p63042
aVThis is much more reliable than what Python can get from the limited C API:
p63043
as(dp63044
g16
V100297
p63045
stp63046
a((dp63047
g2
(lp63048
VYour problem has nothing to do with static methods or nested classes
p63049
aVThe exact same problem exists for global functions:
p63050
aVCalling  will still cause expensive instances of  to be created in a loop outside of
p63051
aVYou need to devise a caching strategy for creating
p63052
aVThere are too many ways of doing that to sum up here, certainly with so little information on when reusing an instance of  is acceptable over creating a new one
p63053
aVIf you wanted to reuse an instance of  just for the loop in  then pass that along as an optional argument:
p63054
aVNow the instance is cached for the duration of function
p63055
as(dp63056
g16
V100297
p63057
stp63058
a((dp63059
g2
(lp63060
VYou have an HTML escape there
p63061
aVUse the  class to unescape these:
p63062
aVDemo:
p63063
aVIn Python 3, the  module has been renamed to ; adjust the import accordingly:
p63064
as(dp63065
g16
V100297
p63066
stp63067
a((dp63068
g2
(lp63069
VYou need to mark  as a global if you are to assign to it in your function:
p63070
aVBy assigning to a given variable, you are marking it as a local name unless you explicitly mark it as a global
p63071
aVYou may want to move  into the function instead of making it a global:
p63072
aVYou don't appear to be using it elsewhere in your code, so making it a global is overkill here
p63073
aVYour next problem is that you are calling  recursively; the function is calling itself, passing in the exact same arguments
p63074
aVThe function will never return
p63075
aVI suspect you meant to call the  function instead, passing in a specific list for each student, like the  key, or  or :
p63076
as(dp63077
g16
V100297
p63078
stp63079
a((dp63080
g2
(lp63081
VYou are creating a shallow copy, because nested values are not copied, merely referenced
p63082
aVA deep copy would create copies of the values referenced by the list too
p63083
aVDemo:
p63084
aVHere the nested dictionary is not copied; it is merely referenced by both lists
p63085
aVThe new element  is not shared
p63086
aVRemember that everything in Python is an object, and names and list elements are merely references to those objects
p63087
aVA copy of a list creates a new outer list, but the new list merely receives references to the exact same objects
p63088
aVA proper deep copy creates new copies of each and every object contained in the list, recursively:
p63089
as(dp63090
g16
V100297
p63091
stp63092
a((dp63093
g2
(lp63094
VThere are several problems with your code, and it is no suprise it doesn't run
p63095
aVYou do not have to call  when using
p63096
aVThat function takes care of the  call for you
p63097
aVInstead,  returns the exit code directly
p63098
aVQuoting the  documentation:
p63099
aVRun the command described by args
p63100
aVWait for command to complete, then return the returncode attribute
p63101
aVEmphasis mine
p63102
aVMoreover, your  function doesn't return anything (let alone a command to run)
p63103
aVInstead it runs the  command using
p63104
aVRemove that call all together
p63105
aVUse  instead of
p63106
aVRewriting your code to use just  would be:
p63107
aVwhere we pass in the command to run plus its arguments as a list of strings
p63108
aVI've removed the  prefix; just run  directly; no shell is needed here
p63109
aVThe  switch even prevents the  shell from closing
p63110
aVThe return value of  is not necessarily the same as what  returned
p63111
as(dp63112
g16
V100297
p63113
stp63114
a((dp63115
g2
(lp63116
VYou should not be accessing  directly at all
p63117
aVUse a  method to proxy calls to the underlying  object instead:
p63118
aVI've also switched the code to best-practices; using  instead of  and using  instead of
p63119
aVFor new-style objects (inheriting from ), use  to set arbitrary attributes
p63120
aVThere is no need to use a call forwarder wrapper, however
p63121
aVYou could have taken the bound methods of  and set those directly on  too:
p63122
aVIf all you wanted was a file object that auto-closes on garbage collection, then you went through a lot of trouble for nothing
p63123
aVPython file objects already have a  handler that does exactly that
p63124
aVIt is just not exposed as an explicit  function, instead the C implementation uses a deallocation function that calls  when deallocated
p63125
aVBest practice, however, is to use file objects as context manager, using the  statement:
p63126
aVQuoting from the  documentation:
p63127
aVAs of Python 2
p63128
aV5, you can avoid having to call this method explicitly if you use the with statement
p63129
aVFor example, the following code will automatically close f when the  block is exited:
p63130
as(dp63131
g16
V100297
p63132
stp63133
a((dp63134
g2
(lp63135
VYou already have a process bound to the default port (8000)
p63136
aVIf you already ran the same module before, it is most likely that process still bound to the port
p63137
aVTry and locate the other process first:
p63138
aVThe command arguments are included, so you can spot the one running  if more than one  process is active
p63139
aVYou may want to test if  still shows a directory listing for local files
p63140
aVThe second number is the process number; stop the server by sending it a signal:
p63141
aVAlternatively, run the server on a different port, by specifying the alternative port on the command line:
p63142
aVthen access the server as ; where  can be any number from 1024 and up, provided the port is not already taken
p63143
as(dp63144
g16
V100297
p63145
stp63146
a((dp63147
g2
(lp63148
VYou never call
p63149
aVYou only test if the function object is never equal to :
p63150
aVFunction objects are never equal to
p63151
aVDon't test for equality here, just call the function:
p63152
aVNext, in  you clear the possible values whenever you loop over the values to eliminate:
p63153
aVThat sets  to an empty value for any value in the row not 0
p63154
aVYou do the same in your other 2  functions
p63155
aVYou probably wanted to use:
p63156
aVThis will clear your possibilities real fast
p63157
as(dp63158
g16
V100297
p63159
stp63160
a((dp63161
g2
(lp63162
VYou can only bind a method when there is an instance to bind to
p63163
aVYour dispatch map builds the map with just the class instead
p63164
aVBuild the map in :
p63165
aVor bind the methods explicitly in your  method:
p63166
aVThis uses the descriptor protocol to bind the method, which is what normally happens when a method is looked up on an instance
p63167
as(dp63168
g16
V100297
p63169
stp63170
a((dp63171
g2
(lp63172
VYou cannot;  only returns control when ENTER has been entered
p63173
aVRead directly from  directly instead:
p63174
as(dp63175
g16
V100297
p63176
stp63177
a((dp63178
g2
(lp63179
VSince your tuples are just repeating the same number, just use a range loop and create the tuple from scratch:
p63180
aVThere is no need to add up here
p63181
aVAlternatively, calculate  from the frame
p63182
aV30 frames in a second
p63183
aVDivide 256 by 30 to get a step size, then use the frame number:
p63184
as(dp63185
g16
V100297
p63186
stp63187
a((dp63188
g2
(lp63189
VYou cannot;  works with literal text only
p63190
aVTo replace patterns, use regular expressions:
p63191
aVDemo:
p63192
as(dp63193
g16
V100297
p63194
stp63195
a((dp63196
g2
(lp63197
VLooping helps:
p63198
aVor use nested  calls:
p63199
aVDemo:
p63200
aVIf you wanted to show the rows and columns transposed, transpose the matrix by using the  function; if you pass each row as a separate argument to the function,  recombines these value by value as tuples of columns instead
p63201
aVThe  syntax lets you apply a whole sequence of rows as separate arguments:
p63202
as(dp63203
g16
V100297
p63204
stp63205
a((dp63206
g2
(lp63207
VYou have two  lines indented to the same level:
p63208
aVDid you mean to indent everything after the first
p63209
aVIf your own editor is showing the two lines as being on different indentation levels, you need to stop mixing tabs and spaces; Python is interpreting tabs differently from your editor
p63210
aVRun your script with  to have Python tell you where you are misusing tabs
p63211
as(dp63212
g16
V100297
p63213
stp63214
a((dp63215
g2
(lp63216
V can only serve static pages, not CGI scripts
p63217
aVYou could use  instead
p63218
aVUse this only for local testing setups; these servers have hardly been battletested on the wider web and are almost certainly not secure
p63219
as(dp63220
g16
V100297
p63221
stp63222
a((dp63223
g2
(lp63224
VYou are loading your pages from the web; look for a content type header with  parameter to see if the webserver already told you about the encoding:
p63225
aVIf no such parameter is present,  is set to  and BeautifulSoup will fall back to guessing
p63226
aVYou can also try out different parsers; if the HTML is malformed, different parsers will repair the HTML in different ways, perhaps allowing BeautifulSoup to detect the encoding better
p63227
as(dp63228
g16
V100297
p63229
stp63230
a((dp63231
g2
(lp63232
VThere are a multitude of options beyond the  statement and expression you used
p63233
aVUse subtraction:
p63234
aVUse  (XOR):
p63235
aVThis toggles between 0 and 1:
p63236
aVYou could use :
p63237
aVis especially useful for swapping between more than one value, especially when there is no easy mathematical or logical relationship between them:
p63238
aVBut to figure out which works best for you, pick a metric and stick to that
p63239
aVFor performance, use the  module for comparative trials
p63240
aVUsing  is by far faster than  or your expression, for example:
p63241
aVThe Python compiler interprets code pretty straightforward, mostly
p63242
aVYour  version would not be optimized, for example
p63243
aVUse the  function to see a disassembly of the compiler output:
p63244
aVAs you can see the full branching structure is still there
p63245
aVUsing an expression leads to very different bytecode:
p63246
as(dp63247
g16
V100297
p63248
stp63249
a((dp63250
g2
(lp63251
VA  object is not a sequence
p63252
aVYou cannot access rows by index
p63253
aVYou'd have to 'slurp' the whole iterable into a list for that:
p63254
aVThis is generally not a good idea
p63255
aVYou can instead ask for the next value from the iterator with the  function:
p63256
as(dp63257
g16
V100297
p63258
stp63259
a((dp63260
g2
(lp63261
VThe  callable returns  (usually because you didn't include a  statement)
p63262
aVFix that method to return a numeric value instead
p63263
as(dp63264
g16
V100297
p63265
stp63266
a((dp63267
g2
(lp63268
VThe only constraint set is that the return values should be comparable; they should support , , ,  and  tests
p63269
aVIn Python 2, everything is comparable with everything else, making the restriction rather moot
p63270
aVIn Python 3, there are more restrictions on what makes values comparable; comparisons between objects of different types are not supported, for example, so you don't want to return a mix types
p63271
aVNote that this is not anything special to the  function; the same restrictions apply to the values being sorted, see the Comparisons documentation
p63272
aVAll that the  function does is let you provide a 'stand-in' value to sort on instead of the actual value at a given position
p63273
as(dp63274
g16
V100297
p63275
stp63276
a((dp63277
g2
(lp63278
VBecause a  loop in Python is really a for each loop; you need to give it an iterable to loop over; you are not looping for a certain number of iterations, you are iterating over elements, one element after another
p63279
aVIf you were to try to loop over just the length, you'd get an exception:
p63280
aVFor your specific example, you don't need to use  either, I'd use the  function instead:
p63281
aVor, combined with a list comprehension:
p63282
aVor using  to just sum all values in each zipped tuple:
p63283
aVtakes elements from each of the argument iterables and pairs up the elements, one by one;  and  becomes
p63284
aVMore input arguments mean more elements in the output tuples
p63285
as(dp63286
g16
V100297
p63287
stp63288
a((dp63289
g2
(lp63290
VUse a simple loop:
p63291
aVHere  ranges from 1 to 8 inclusive, and multiplying that by 10 gives us 10, 20, 30, 40, etc
p63292
aVFor every ,  ranges from 0 to 3 inclusive, and multiplying that by 20 gives 0, 20, 40, and 60
p63293
aVAdding 10 or 20 gives you your range of 10 - 70 or 20 - 80
p63294
aVUsing  would let you eliminate one loop:
p63295
aVQuick demo just printing the coordinates used:
p63296
as(dp63297
g16
V100297
p63298
stp63299
a((dp63300
g2
(lp63301
VBecause you exit the function with a  statement after processing only the first value:
p63302
aVMove that  statement out of the loop
p63303
aVYou should also just loop over the  call, no need to use induces here:
p63304
as(dp63305
g16
V100297
p63306
stp63307
a((dp63308
g2
(lp63309
VIn Python 3, using the  division operator always returns a  value:
p63310
aVUse floor division instead, the  operator:
p63311
aVThe  operator always returns an integer, flooring the result:
p63312
aVPerhaps you coded your functions from an example in Python 2; in Python 2 the  operator is an ambiguous operator; it'll act like the floor division operator when both operands are integers, but if either operand is a float, then suddenly it behaves differently and returns floating point division results instead
p63313
aVBecause both operands in your code are integers, in Python 2 your code would not have thrown that exception
p63314
aVYour next problem is that  does not return anything, so when you use  in  you'll return
p63315
aVI suspect that the  there is a mistake
p63316
as(dp63317
g16
V100297
p63318
stp63319
a((dp63320
g2
(lp63321
VYou misunderstand how classes work
p63322
aVYou put your call inside the class definition body; there is no instance at that time, there is no
p63323
aVCall the method on the instance:
p63324
aVNow the  method is bound, there is an instance for  to refer to
p63325
aVIf you need  to be called when you create an instance, give the class an  method
p63326
aVThis method (the initializer) is called whenever you create an instance:
p63327
as(dp63328
g16
V100297
p63329
stp63330
a((dp63331
g2
(lp63332
VYou are looking for the  module; a heap lets you keep the top N items, efficiently, as you go along
p63333
aVThere is even a dedicated function for your exact usecase:
p63334
aVThis passes in a generator expression, taking care of the loop efficiently
p63335
aVUnder the hood, this method:
p63336
aVtakes the first 15 elements and creates a heap from that
p63337
aVcalls  on the heap for all the following items; this adds the item to the heap, then removes the smallest item
p63338
aVAs a result the heap only ever contains the 15 largest items
p63339
aVwhen the iterable is done, the heap list is sorted
p63340
as(dp63341
g16
V100297
p63342
stp63343
a((dp63344
g2
(lp63345
VBy applying indexing on the nested list:
p63346
aVThe first index returns the object at that position; that object happens to be a list as well, so you can immediately apply another index to that result
p63347
aVThis extends to dictionaries and attributes as well
p63348
aVYou can use list methods on those same nested lists:
p63349
aVfor example
p63350
aVIf it helps understanding, imagine assigning the result of the first indexing operation to a temporary variable:
p63351
as(dp63352
g16
V100297
p63353
stp63354
a((dp63355
g2
(lp63356
VYour shell removes the quotes before invoking Python
p63357
aVThis is not something Python can control
p63358
aVAdd more quotes:
p63359
aVwhich can also be placed anywhere in the argument:
p63360
aVor you could use backslash escapes:
p63361
aVto preserve them
p63362
aVThis does depend on the exact shell you are using to run the command
p63363
aVDemo on :
p63364
as(dp63365
g16
V100297
p63366
stp63367
a((dp63368
g2
(lp63369
VIf you want to build lists, then concatenate the lists onto existing values:
p63370
aVDemo:
p63371
as(dp63372
g16
V100297
p63373
stp63374
a((dp63375
g2
(lp63376
VYou need to import  from the  module before you can use it in your module:
p63377
aVThe  tutorial imports everything in one go from that module with the syntax:
p63378
aVThis all assumes you are using the VPython IDE, downloaded from the project website
p63379
as(dp63380
g16
V100297
p63381
stp63382
a((dp63383
g2
(lp63384
VYou need to test against strings; you are now testing against variable names:
p63385
aVbut you can simplify the case where both players picked the same option by testing if they are equal:
p63386
aVNext, I'd use a mapping, a dictionary, to codify what beats what:
p63387
aVNow your game can be tested in just 2 tests
p63388
aVAll put together:
p63389
as(dp63390
g16
V100297
p63391
stp63392
a((dp63393
g2
(lp63394
VYou can use set operations on the dictionary keys view:
p63395
aVIn Python 3, use  instead
p63396
aVDemo of the different outcomes of the set operation:
p63397
aVIn other words, the  set intersection gives you a set of all keys present in both sets; both in the dictionary and in your explicit set literal
p63398
aVOnly if one and only one of the named keys is present is the length of the intersection going to be 1
p63399
aVIf you do not want to allow any other keyword arguments besides  and , then you can also use proper subset tests
p63400
aVUsing  with two sets is only True if the left-hand set is strictly smaller than the right-hand set; it only has fewer keys than the other set and no extra keys:
p63401
aVOn Python 3, that can be spelled as:
p63402
aVinstead
p63403
aVDemo:
p63404
aVNote that now the  key is no longer acceptable
p63405
as(dp63406
g16
V100297
p63407
stp63408
a((dp63409
g2
(lp63410
VBecause you can use a dynamic variable too:
p63411
aVYou can't do that with regular attribute access syntax
p63412
aVNote that  also takes an optional default value, to be returned if the attribute is missing:
p63413
aVUsing  you can pull the attribute name from something else, not a literal:
p63414
aVor you can use  to set dynamic attributes:
p63415
as(dp63416
g16
V100297
p63417
stp63418
a((dp63419
g2
(lp63420
VNodeJS is encoding the UTF-8 representation of the string
p63421
aVPython is encoding the byte string
p63422
aVIn Python, you'd have to do:
p63423
aVto get the same output
p63424
aVYou created the buffer using a default encoding, which means it interpreted  as UTF-8 to begin with
p63425
aVYou need to tell  to treat  as binary instead:
p63426
as(dp63427
g16
V100297
p63428
stp63429
a((dp63430
g2
(lp63431
VYou want to access the function object, but you are instead accessing a method
p63432
aVPython treats functions on instances and classes as descriptors, returning bound methods at lookup time
p63433
aVUse:
p63434
aVto reach the wrapped function object
p63435
aVIn Python 3, you can also access the function object on the class:
p63436
aVIn Python 2 that'd still return an unbound method object (a method without an instance attached)
p63437
aVOf course, just because you can do this, does not necessarily make it a good idea
p63438
aVWith a method you have a class, giving you an alternative location to store that counter
p63439
aVYou could put it on either  or on , where the latter would give you a counter per subclass
p63440
as(dp63441
g16
V100297
p63442
stp63443
a((dp63444
g2
(lp63445
VYou are looking for a component architecture and adaptation
p63446
aVThe Zope Component Architecture lets you register interfaces and adapters; a central registry to look up converters from one type to another
p63447
aVAs long as an adapter exists to convert a value to the target type, you can pass any object into your API
p63448
aVYou start by defining what interface the target type requires:
p63449
aVAny class can then implement that interface (instances of such a class would provide the interface)
p63450
aVFor your RGB class, you then register an adapter; it helps if you have an  interface, but it is not required:
p63451
aVNow your API just needs to 'cast' your values to :
p63452
aVThat's it
p63453
aVIf the  value directly provides the  interface, it is returned unchanged
p63454
aVIf it is a  instance, an adapter is found in the registry; the adapter is created ( is called) and will act just like a  object
p63455
aVYou can also have your adapter return an actual  object; the above example returns a proxy object instead, but the principle is the same
p63456
aVPython's Abstract Base Classes approach interfaces from a different direction, namely ducktyping
p63457
aVYou can test if a given object conforms to the ABCs methods and attributes
p63458
aVIt does not offer adaptation however
p63459
as(dp63460
g16
V100297
p63461
stp63462
a((dp63463
g2
(lp63464
VSubtract the  from  to count 'backwards':
p63465
as(dp63466
g16
V100297
p63467
stp63468
a((dp63469
g2
(lp63470
V calls the  hook on the object passed in
p63471
aVThat hook should return an integer
p63472
aVBecause Python  are only limited in size by memory, theoretically there is no real upper limit to the values that  can return
p63473
aVIf you want to trace how Python objects implement this, search for the  slot in the  directory, or look for the  function calls to see how the value of those slots is used by sets and  dictionaries and other code
p63474
aVCPython long integer objects themselves limit the return value to a C long int
p63475
aVInterally, the CPython   function will cast any value returned from a Python  function that is greater that falls outside the range for a C long int to the Python long int hash for that value; so a hash value greater than  will be transformed by calling  on that value again
p63476
aVSo in practice,  should return values limited to
p63477
aVIn Python 3, a new type was introduced, ; C long is, on some 64-bit platforms, still limited to only 32 bits, but  is the same size as a pointer, giving you 64 bits on any 64-bit platform
p63478
aVOn Python 3, the  value reflects the maximum correctly; it returns the maximum value a pointer on your platform can hold
p63479
as(dp63480
g16
V100297
p63481
stp63482
a((dp63483
g2
(lp63484
VYour data uses a different line separator convention from what you are expecting
p63485
aVThis is not a UTF-8 specific problem, really
p63486
aVYou can split your lines using ; it'll recognize  as line separators
p63487
aVOptionally, you can rejoin your lines with :
p63488
as(dp63489
g16
V100297
p63490
stp63491
a((dp63492
g2
(lp63493
VUse a  object, write that straight to the output file:
p63494
aVA sequence of integers is interpreted by a  as a sequence of byte values
p63495
aVIn Python 3, you can use a  type as well, with the same input; you are not mutating the values after creation, after all
p63496
as(dp63497
g16
V100297
p63498
stp63499
a((dp63500
g2
(lp63501
V creates a Python list object
p63502
aVGiven an iterable, all elements of the iterable are copied over to the resulting list:
p63503
aVReturn a list whose items are the same and in the same order as iterable\u2018s items
p63504
aVThe expression  creates an iterable that results in 10  objects, whose name starts with  (with a case insensitive match)
p63505
aVThis simply creates a local copy of the query result, perhaps so the code can index directly into the list without re-issuing a new query each time
p63506
aVThis is specifically documented on the Django  documentation:
p63507
aVForce evaluation of a  by calling  on it
p63508
aVFor example:
p63509
aVBe warned, though, that this could have a large memory overhead, because Django will load each element of the list into memory
p63510
aVIn contrast, iterating over a  will take advantage of your database to load data and instantiate objects only as you need them
p63511
as(dp63512
g16
V100297
p63513
stp63514
a((dp63515
g2
(lp63516
VZip the good and bad lists, map each resulting tuple to a set and feed that to :
p63517
aVDemo:
p63518
aVThis will take any size of inputs; not just  and , but you can add in  as well:
p63519
aVGeneralized to a function:
p63520
aVBecause a  is used to produce unique values from each combined set of inputs, the output order is not the same as the order of the inputs
p63521
aVIf order is important, you can replace  with a dupe-removing order-preserving function instead:
p63522
aVwhich produces output ordered according to the order of the inputs:
p63523
as(dp63524
g16
V100297
p63525
stp63526
a((dp63527
g2
(lp63528
V is a unicode value;  is always unicode
p63529
aVYou are trying to force that value into a string without explicitly providing an encoding
p63530
aVAs a result Python is trying to encode it for you with the default ASCII codec
p63531
aVThat encoding is failing
p63532
aVEncode your Unicode values to strings explicitly instead
p63533
aVFor a SHA 256 hash, UTF-8 is probably fine
p63534
aVor use string templating:
p63535
as(dp63536
g16
V100297
p63537
stp63538
a((dp63539
g2
(lp63540
VYou can slice strings (or any other sequence) using a stride; you can select every 3rd character with that:
p63541
aVTo reverse the trend, slice up the ciphertext into three chunks and use  to recombine them again:
p63542
aVDemo:
p63543
aVThe last part without  would be:
p63544
as(dp63545
g16
V100297
p63546
stp63547
a((dp63548
g2
(lp63549
VWithin  you are calling the function recursively without altering the arguments:
p63550
aVThis cannot but lead to infinite recursion
p63551
aVPerhaps you wanted to limit the upper index instead:
p63552
as(dp63553
g16
V100297
p63554
stp63555
a((dp63556
g2
(lp63557
VYour JSON contains a list, with one dictionary in it; there are two square brackets,  and , around the dictionary
p63558
aVSelect the first element:
p63559
aVQuick demo:
p63560
aVNote that you could have spotted this yourself with a quick print of just
p63561
aVIf this was a list of multiple courses and you need to count per-student, set up a dictionary keyed on students, containing integers
p63562
aVUsing  makes that a little easier:
p63563
as(dp63564
g16
V100297
p63565
stp63566
a((dp63567
g2
(lp63568
VRefer to attribute names instead, and use the  function to store a new value on :
p63569
aVlets you set attributes based on a variable, here taking from ; there is also a companion  function to retrieve attributes dynamically
p63570
as(dp63571
g16
V100297
p63572
stp63573
a((dp63574
g2
(lp63575
VUse a stride slice:
p63576
aVSequence slicing not only supports specifying a start and end value, but also a stride (or step);  selects every second value starting from 0,  every value starting from 1
p63577
aVDemo:
p63578
as(dp63579
g16
V100297
p63580
stp63581
a((dp63582
g2
(lp63583
VYou don't need to use  at all here:
p63584
aVand even if you did, you'd call it on the string object, not the open file:
p63585
aVNote that  is re-bound in your loop more than once if multiple  values match your  test, you'll only be passing the last match to
p63586
aVIf no values match you run the risk of  never having been bound at all and you'll get a  exception instead
p63587
aVUse  to pick the first match, and use  on the  loop to detect that no match was made:
p63588
as(dp63589
g16
V100297
p63590
stp63591
a((dp63592
g2
(lp63593
VYou return a string early on:
p63594
aVPerhaps you wanted to raise an exception instead here, or at the very least, return an empty dictionary or use  as a flag value
p63595
aVIf you use  do test for it:
p63596
as(dp63597
g16
V100297
p63598
stp63599
a((dp63600
g2
(lp63601
VIt's called a sentinel, and you can use any unique object for it:
p63602
aVHere I used a simple  instance instead of a custom class
p63603
aVA custom class does have the advantage that it is perhaps more self-documenting; if your API has to pass the object to users of the API (which can be code), then an explicit class is better
p63604
aVFor use just in the black box of the API,  is just fine
p63605
aVYou may want to consider just raising the exception at the point where you now return the sentinel
p63606
aVYou can always catch the exception again
p63607
as(dp63608
g16
V100297
p63609
stp63610
a((dp63611
g2
(lp63612
VThe index error is for indexing into , not the  call
p63613
aVYour  does not have 10 elements, yet you try to index that many:
p63614
aVYou only ever appended 9 elements to  (you ignored ), so your assumptions already fall apart there
p63615
aVAs a result, provided  doesn't lose any more elements,  is 9 elements long, so:
p63616
aVwill fail
p63617
aVEven if it doesn't, you ignore  and
p63618
aVsuffers from the same problem; there are 9 elements in that list, not 10, provided  doesn't drop any elements
p63619
as(dp63620
g16
V100297
p63621
stp63622
a((dp63623
g2
(lp63624
VYou have a dictionary, not a list
p63625
aVDictionaries map keys to values; in your case the keys are strings
p63626
aVJust supply the key; a string literal will do fine here:
p63627
aVI strongly suggest you go read up on Python dictionaries in the Python tutorial
p63628
as(dp63629
g16
V100297
p63630
stp63631
a((dp63632
g2
(lp63633
VYou can only do that if you store the output of  first:
p63634
aVNow you can refer to  after importing
p63635
aVdoesn't store anything; all it does is turn the expressions that follow it into strings and write those strings to the standard output
p63636
aVTechnically, you could try and replace , but then you'd only capture strings, not actual original values
p63637
aVIt sounds, however, as if you want to expose some kind of API to a 3rd party that will import both  and your 3rd module
p63638
aVIn that case, have the user of your API call a hook method in your 3rd library instead, or have it set a value:
p63639
aVThis neatly avoids circular imports too
p63640
aVAnother option is for  to be made responsible for updating ; at the end of  add code to update :
p63641
as(dp63642
g16
V100297
p63643
stp63644
a((dp63645
g2
(lp63646
VYou can simplify and optimize your operation with set intersections; as of Python 2
p63647
aV7 dictionaries can represent keys as sets using the  method, or  in Python 3:
p63648
aVThis can be turned into a dict comprehension even:
p63649
aVI am assuming here you wanted one resulting dictionary, not a new dictionary per shared key
p63650
aVDemo on your sample input:
p63651
aVNote that both  and  are shared with dictionaries in , but in both cases, the resulting key is
p63652
aVOnly one of these wins (the last match), but since both values in  are exactly the same anyway that doesn't make any odds in this case
p63653
aVIf you wanted separate dictionaries per dictionary in , simply move the  loop out:
p63654
aVIf you really wanted one dictionary per shared key, move another loop out:
p63655
as(dp63656
g16
V100297
p63657
stp63658
a((dp63659
g2
(lp63660
V returns the exit code of the process, not the result of the  commands
p63661
aVThis is always an integer
p63662
aVIn the meantime, the output of the process itself is not redirected, so it writes to  directly (bypassing Python)
p63663
aVYou cannot iterate over over an integer
p63664
aVYou should use the  function instead if you wanted to retrieve the stdout output of the command
p63665
aVIn this case, you'd be better off using  and code the whole search in Python instead:
p63666
aVI've interpreted the  command as filtering out filenames that start with ; adjust as needed
p63667
as(dp63668
g16
V100297
p63669
stp63670
a((dp63671
g2
(lp63672
VYour test method is ignored because it takes an argument
p63673
aVTest methods never take an argument
p63674
aVThis is quite beside the fact that Python won't ever magically pass a local variable name into a function as an argument; you'd have to explicitly pass it in
p63675
aVIntegrate your url loading into the test itself instead:
p63676
aVor create test methods dynamically:
p63677
as(dp63678
g16
V100297
p63679
stp63680
a((dp63681
g2
(lp63682
VYou are interpolating the value twice:
p63683
aVJust once will do:
p63684
aVThe nice thing about the  function is that you can tell it to format your number to a certain number of decimals:
p63685
aVwhere it'll use 5 decimals
p63686
aVThat number can be parameterized too:
p63687
aVDemo:
p63688
aVI'll leave using  and  to ask for an integer number of decimals from the user up to you
p63689
as(dp63690
g16
V100297
p63691
stp63692
a((dp63693
g2
(lp63694
VThe returned value is a list, so index it:
p63695
as(dp63696
g16
V100297
p63697
stp63698
a((dp63699
g2
(lp63700
VYou replaced  with a method:
p63701
aVThis'll never match either  or  because it is no longer a string
p63702
aVCall the method instead:
p63703
aVNote that your test for  can just be dropped, there is little point in testing for a string then just ing
p63704
aVUsing  instead of  otherwise works just fine:
p63705
as(dp63706
g16
V100297
p63707
stp63708
a((dp63709
g2
(lp63710
VYour main project package indeed doesn't have a  attribute
p63711
aVmeans: import  from the  module, and you don't have such an object in
p63712
aVYou probably want to refer to  instead
p63713
aVThat object does exist
p63714
aVBest practice is to define a  function, and use that as an entry point:
p63715
aVNow you can add more to  as needed
p63716
aVNote that the  test will always be false when the  module is imported by the script generated by setuptools
p63717
aVThe file is not run directly
p63718
as(dp63719
g16
V100297
p63720
stp63721
a((dp63722
g2
(lp63723
VYou probably have more whitespace in one of the files than just a newline
p63724
aVYou could loop over either  and , printing the representation of that line with  or  to make it easier to spot how the lines differ
p63725
aVI'd strip the lines entirely
p63726
aVAlso, use a  for the lines of one file, testing will be much more efficient:
p63727
aVLooping directly over the file itself reads the file line by line, letting you handle file lines without having to read the whole file into memory
p63728
aVNote also the use of  statements here; file objects are context managers, and when the context closes (the  block ends) the file object is automatically closed for you
p63729
aVWith Katakana, there is also the possibility that one of your files uses decomposition for the  ZI character while the other does not; you can either express it as  or as ; (SI + COMBINING KATAKANA-HIRAGANA VOICED SOUND MARK):
p63730
aVYou can use  to normalize all your lines to either composed or decomposed forms
p63731
aVHere I force all data to use composed forms:
p63732
as(dp63733
g16
V100297
p63734
stp63735
a((dp63736
g2
(lp63737
VStart with not using ; you want the data, not a file
p63738
aVNext, use a HTML parser
p63739
aVBeautifulSoup is great for extracting text from HTML
p63740
aVRetrieving the page with  would be:
p63741
aVthen read the data into BeautifulSoup:
p63742
aVThe  part there will tell BeautifulSoup what encoding the web server told you to use for the page; if the web server did not specify this then BeautifulSoup will make an educated guess for you
p63743
aVNow you can search for your data:
p63744
aVFor your demo HTML snippet that gives:
p63745
as(dp63746
g16
V100297
p63747
stp63748
a((dp63749
g2
(lp63750
VUse  to create your quote string, using name and value pairs:
p63751
aVThis encodes your ampersands correctly:
p63752
as(dp63753
g16
V100297
p63754
stp63755
a((dp63756
g2
(lp63757
VUse :
p63758
aVThis splits the string once on  then takes the last element of the resulting list
p63759
aVThis has the advantage that you still get a result even if no at-sign was present in the input string
p63760
aVDemo:
p63761
as(dp63762
g16
V100297
p63763
stp63764
a((dp63765
g2
(lp63766
VYou are reading a text file that uses a different newline convention from your system;  where probably your system expects either  or
p63767
aVYou can open the file using universal newline support instead with the  mode:
p63768
aVThe smarter way to skip that first line is to use the file as an iterator; loop over it directly
p63769
aVThe  method lets you grab one line at a time, giving you a method to skip the first line:
p63770
aVHowever, if this a CSV file, use the  module to read the data:
p63771
aVThe CSV module handles splitting the lines into lists for you:
p63772
as(dp63773
g16
V100297
p63774
stp63775
a((dp63776
g2
(lp63777
VAs far as Python is concerned, you appear to be missing some commas in your  definition:
p63778
aVbecause the first string ends when the first  is encountered at ; a raw string does not preclude you from escaping embedded quotes
p63779
aVIf you wanted to produce a list of arguments, just make it a list directly, saves you interpolating the filename too:
p63780
aVNote the single quotes around the 3rd argument to preserve the quotes in the command line argument
p63781
aVThis eliminates the need to split as well and preserves whitespace in the filename
p63782
as(dp63783
g16
V100297
p63784
stp63785
a((dp63786
g2
(lp63787
VYou'll need a lookup table to determine the values per  tuple
p63788
aVYou'll need to add all possible level lookups to the sort key:
p63789
aVThe sort function generates a list of values to sort on, starting with the value at their own level (filling in  for any lower levels) plus the values for the same ID at higher levels
p63790
aVFor example, for the  and  tuples, the sort function outputs:
p63791
aVwhere only the last value differs and determines the final sort order
p63792
aVFor this to work, you need to know the minimum and maximum levels in the input list first, hence the more elaborate map building loop
p63793
aVDemo:
p63794
as(dp63795
g16
V100297
p63796
stp63797
a((dp63798
g2
(lp63799
VUse a sort key function to look up the month:
p63800
aVThe sort function can be expressed as a lambda too, just make sure it takes an argument:
p63801
aVDemo:
p63802
as(dp63803
g16
V100297
p63804
stp63805
a((dp63806
g2
(lp63807
VYou swapped the  and  in your loop:
p63808
aVgives you  tuples
p63809
aVReworking your code a little to remove redundacies:
p63810
aVYou already calculated the intersection of the two dictionaries, which gives you keys only present in both, but you do need to loop over that intersection itself, not
p63811
aVI used  to get a set-like object directly, which can be intersected with another iterable, like the  dictionary, very efficiently, without intermediary results
p63812
as(dp63813
g16
V100297
p63814
stp63815
a((dp63816
g2
(lp63817
VTest for the length;  is just a list, really:
p63818
as(dp63819
g16
V100297
p63820
stp63821
a((dp63822
g2
(lp63823
V is a shorter name for , not
p63824
aVYou'll need to use the full name, , instead:
p63825
as(dp63826
g16
V100297
p63827
stp63828
a((dp63829
g2
(lp63830
VYou have a small typo; you are testing for equality, not assigning:
p63831
aVshould be:
p63832
aVHowever, you already have a number between 1 and 6, why not make that into an index into the results list
p63833
aVThat way you don't have to use so many  statements
p63834
aVKeep your data out of your variable names:
p63835
as(dp63836
g16
V100297
p63837
stp63838
a((dp63839
g2
(lp63840
VThey are not needed, they just make it easier to produce a multi-line string
p63841
aVThe alternative would be:
p63842
aVNote that Python lets you take your pick of  and  style quotes, whatever better suits your string contents
p63843
as(dp63844
g16
V100297
p63845
stp63846
a((dp63847
g2
(lp63848
VThere is little point in this code
p63849
aVIt'll indeed just capture any and all exceptions, then re-raise them again
p63850
aVThe traceback and exception are maintained, so the re-raise may as well not be there as far as other Python code is concerned
p63851
aVIt could be that the code once did more than this but the author wanted to minimize the VCS change by keeping indentation the same
p63852
aVOr perhaps thought it'd be a handy point to insert logging or debugging code in case of an exception
p63853
as(dp63854
g16
V100297
p63855
stp63856
a((dp63857
g2
(lp63858
VYou need to just count the characters, so use a  object:
p63859
aVDemo:
p63860
aVYour  loop iterates over each character in  one by one, which means that in the string  it'll come across the character  three times, and each time you count it
p63861
aVAt the very least, use a dictionary to track counts for each letter
p63862
aVThe  object is a subclass of the Python dictionary type, with some extra behaviour to make counting easier
p63863
as(dp63864
g16
V100297
p63865
stp63866
a((dp63867
g2
(lp63868
VIt is not your  module that is importing ; it is  that does
p63869
aVYour  is also a top-level module
p63870
aVOther Python code has no means to distinguish between your module and the standard library version
p63871
aVYou could alter the  order and make sure standard library modules are found first, but really you should just rename your module
p63872
aVIt is easy enough to give it a different name
p63873
as(dp63874
g16
V100297
p63875
stp63876
a((dp63877
g2
(lp63878
VYou have the  syntax wrong, use:
p63879
aVUse ; you are updating just one row, not several, and  contains just the values for one update
p63880
aVSee the  documentation
p63881
as(dp63882
g16
V100297
p63883
stp63884
a((dp63885
g2
(lp63886
VThere is no need to create a dynamic number of arguments
p63887
aVUse one instead; it is assigned the whole row and you can then use indexes to access items:
p63888
as(dp63889
g16
V100297
p63890
stp63891
a((dp63892
g2
(lp63893
V is itself a row object, in your case (judging by the claimed  output), a dictionary (you probably configured a dict-like cursor subclass); simply access the  key:
p63894
aVBecause you used  only one row is returned, not a list of rows
p63895
aVIf you are not using a dict(-like) row cursor, rows are tuples and the count value is the first value:
p63896
as(dp63897
g16
V100297
p63898
stp63899
a((dp63900
g2
(lp63901
VThe  module already imports  if available
p63902
aVIt is the C-optimized version of the  module, and is used transparently
p63903
aVFrom the  source code:
p63904
aVand from the  module documentation:
p63905
aVThe  module has an transparent optimizer () written in C
p63906
aVIt is used whenever available
p63907
aVOtherwise the pure Python implementation is used
p63908
aVIn Python 2,  was known as , but has been updated to allow the transparent use as an implementation detail
p63909
as(dp63910
g16
V100297
p63911
stp63912
a((dp63913
g2
(lp63914
VYou are confusing the module with the type
p63915
aVUse either:
p63916
aVor use:
p63917
ag7233
ag1298
aVeither reference the  type in the  module, or import that type into your namespace from the module
p63918
aVIf you use the latter form and need other types from that module, don't forget to import those too:
p63919
aVDemo of the first form:
p63920
as(dp63921
g16
V100297
p63922
stp63923
a((dp63924
g2
(lp63925
VYou can put parenthesis around the whole expression:
p63926
aVor you could still use  to continue the expression, just use separate string literals:
p63927
aVNote that there is no need to put  between the strings; Python automatically joins consecutive string literals into one:
p63928
aVI prefer parenthesis myself
p63929
aVThe  calls are redundant;  does that for you by default
p63930
as(dp63931
g16
V100297
p63932
stp63933
a((dp63934
g2
(lp63935
VThe  character does not match newlines by default
p63936
aVYou need to enable that by setting the  flag
p63937
aVNote that there is a blank line between; you'd need to include the newline after  too:
p63938
aVAs an alternative to , you could also use two opposing character classes together:
p63939
aVHere  and  together capture all characters, including newlines, without the  flag being set
p63940
aVYou may want to make your match non-greedy
p63941
aVIf you have two sets of  and  lines in your input, then the  will match all text from the first  all the way to the last :
p63942
aVNote how  is gone too
p63943
aVAlter the  by adding a question mark, making it non-greedy:
p63944
as(dp63945
g16
V100297
p63946
stp63947
a((dp63948
g2
(lp63949
VUse  to allow for 0 or more arguments:
p63950
aVThe help output now is:
p63951
aVand when no arguments are given,  is used
p63952
aVIf you want to require at least one  argument, use  instead, but then the default is ignored, so you may as well drop that:
p63953
aVNow not specifying a command-line argument gives:
p63954
aVYou can always specify  still by passing in  as an argument:
p63955
as(dp63956
g16
V100297
p63957
stp63958
a((dp63959
g2
(lp63960
VYou named the argument  but use the name  in the function body
p63961
aVFix one or the other
p63962
aVDemo, fixing the name used in the body of the function to match the argument:
p63963
aVDo note that both this function and  are not consistent with the docstring; there they are named as  and
p63964
aVYour  function uses , not , so you'll have to correct that as well; one direction or the other
p63965
as(dp63966
g16
V100297
p63967
stp63968
a((dp63969
g2
(lp63970
VBreak out of the  loop when you find a match, then give the loop an  suite
p63971
aVThat suite will only be executed when the loop was not broken out of:
p63972
aVNote that you can loop over  and  directly, no need to create an index first
p63973
aVHaving the index, however, helps match against , but creating the index in addition is easier with
p63974
aVDemo:
p63975
as(dp63976
g16
V100297
p63977
stp63978
a((dp63979
g2
(lp63980
VUse the  library to mock out the  function
p63981
aVAs of Python 3
p63982
aV3, you can import that module as :
p63983
as(dp63984
g16
V100297
p63985
stp63986
a((dp63987
g2
(lp63988
VWhen  is 4, the next minimum is  again, but  finds the first  at position 3 instead
p63989
aVStart searching for the miminum from ; the  method takes a second argument , from where to start searching:
p63990
aVNote that Python can assign to two targets in place, no need to use a temporary intermediate
p63991
aVwith just one argument starts from 0:
p63992
aVDemo:
p63993
as(dp63994
g16
V100297
p63995
stp63996
a((dp63997
g2
(lp63998
VIf you need to use a loop and cannot use the  function, then you are stuck with assigning at the very least the index pointing at the maximum found so far:
p63999
aVWhen the loop completes,  points to the (first occurrence of) the maximum value in
p64000
aVis a more compact and efficient method of generating indices in a loop, together with the values iterated over
p64001
aVThe more efficient method would be to use the  function with a key:
p64002
aVThis will return the (first) index of the maximum value in list ; given a list of indices (), it'll find the index for which  returns the highest value
p64003
as(dp64004
g16
V100297
p64005
stp64006
a((dp64007
g2
(lp64008
VYou forgot to return the  return value when you call it:
p64009
aVAdd a  there:
p64010
aVNote that  already gives you either  or , so you can just return that directly:
p64011
aVAnother way of would be to use ; lists are  when empty,  otherwise
p64012
aVSimplifying :
p64013
aVwhich sounds to me as if you wanted to make sure  is only at the start of the list, or not present at all
p64014
aVIf so, this is easier:
p64015
as(dp64016
g16
V100297
p64017
stp64018
a((dp64019
g2
(lp64020
VThat's tuple assignment; you can assign to multiple targets
p64021
aVThe right-hand expression is evaluated first, and then each value in that sequence is assigned to the names on left-hand side one by one, from left to right
p64022
aVThus,  assigns  to  and  to
p64023
aVSee the assigment statements documentation:
p64024
aVIf the target list is a comma-separated list of targets: The object must be an iterable with the same number of items as there are targets in the target list, and the items are assigned, from left to right, to the corresponding targets
p64025
aVBecause the right-hand side portion is executed first, the line  assigns  to  after calculating , which is assigned to
p64026
aVIf  was  before that line, then after that line  is , and  is 6
p64027
as(dp64028
g16
V100297
p64029
stp64030
a((dp64031
g2
(lp64032
VUse a  object to auto-instantiate nested dictionaries:
p64033
aVI used  to generate the line count here; much simpler than keeping a separate counter going
p64034
aVEven without a , you can let the outer dictionary keep the reference to the nested dictionary, and retrieve it again by using ; there is no need to keep the  reference around:
p64035
aVAll the  then does is keep us from having to test if we already created that nested dictionary
p64036
aVInstead of:
p64037
aVwe simply omit the  test as  will create a new dictionary for us if the key was not yet present
p64038
as(dp64039
g16
V100297
p64040
stp64041
a((dp64042
g2
(lp64043
V always returns a list; perhaps you wanted to turn that into a string:
p64044
aVAlternatively, print only the first element:
p64045
aVParsing HTML is easier with an HTML parser; BeautifulSoup would be a better tool:
p64046
aVA quick demo:
p64047
as(dp64048
g16
V100297
p64049
stp64050
a((dp64051
g2
(lp64052
VYou are not updating ; make sure you roll again in the loop:
p64053
aVOnce you assigned  to , it does not by itself 're-roll' the dice after each loop
p64054
as(dp64055
g16
V100297
p64056
stp64057
a((dp64058
g2
(lp64059
VYou are creating a circular import
p64060
aVDon't
p64061
aVPerhaps you wanted to pass the  instance to the  method instead
p64062
aVor perhaps pass it in when you create the  instance:
p64063
as(dp64064
g16
V100297
p64065
stp64066
a((dp64067
g2
(lp64068
VUse  instead of :
p64069
aVYou should not use a  loop for simple condition;  is far more suitable there
p64070
aVYou could use a  loop instead of the  loop though:
p64071
aVThis has the added bonus that you now accept spaces, dots and dashes in the credit card number too
p64072
as(dp64073
g16
V100297
p64074
stp64075
a((dp64076
g2
(lp64077
VList elements are just references to other Python values
p64078
aVYou've stored a reference to the list itself inside the list
p64079
aVThe list representation reflects this; instead of throwing an error or filling your terminal with endlessly nested representations of the same list, Python shows  to indicate a recursive structure
p64080
aVThe same applies to dictionaries:
p64081
aVor any mix of standard container types
p64082
aVIt is not limited to just one level or a single reference either:
p64083
aVThe  or  reference just indicates that printing the contents would lead to recursion
p64084
as(dp64085
g16
V100297
p64086
stp64087
a((dp64088
g2
(lp64089
VYes, you can
p64090
aVJust pass in the function object:
p64091
aVPython functions are first-class objects, they are assigned to whatever name they are defined as to begin with but you can bind them to other names too
p64092
aVYou can, for example, store them in a mapping, then look up functions in the mapping based on another variable altogether:
p64093
aVWithin ,  is then bound to whatever function object you passed in
p64094
aVAdding  after the name invokes the function
p64095
aVYou can pass in arguments too, but then all functions you pass in have to have the same signature
p64096
aVYou could wrap the function in a  or other function object to pass in extra arguments, or take a look at  to generate callables with pre-defined arguments
p64097
as(dp64098
g16
V100297
p64099
stp64100
a((dp64101
g2
(lp64102
VYour code works just fine:
p64103
aVPerhaps your running code uses  by accident
p64104
aVYou want to use  as the key though:
p64105
aVThis produces the desired output:
p64106
aVYou can also loop over the string as an iterator, 'remembering' the previous character:
p64107
aVIt is much easier to track the previous value(s), looking behind, than it is to look ahead; you already passed over the previous values, after all
p64108
as(dp64109
g16
V100297
p64110
stp64111
a((dp64112
g2
(lp64113
VUse the  function:
p64114
aVSee the Format Specification Mini-Language for the specific formatting options; prepending a number format with  makes it include a plus for positive numbers,  for negative
p64115
aVThe last example formats the number to use 3 decimals, for example
p64116
aVIf you need to remove the negative sign, you'd have to do so explicitly using :
p64117
aVbut that'd be quite confusing a specification to read, in my opinion
p64118
aV:-)
p64119
as(dp64120
g16
V100297
p64121
stp64122
a((dp64123
g2
(lp64124
VYou need to return the recursive result:
p64125
aVotherwise the function simply ends after executing that statement, resulting in  being returned
p64126
aVYou probably want to drop the  and always return at the end:
p64127
aVbecause if  is  then you end your function without a  as well
p64128
aVIf recursing in that case is not the right option, but returning  is not, you need to handle that edgecase too
p64129
as(dp64130
g16
V100297
p64131
stp64132
a((dp64133
g2
(lp64134
V is indeed a C module; the object implements the C-API mapping protocol instead
p64135
aVSee the source code for the  structure with function pointers
p64136
aVYou could use  to access the keys:
p64137
aVYou could wrap  in  to make it an efficient callable with one argument:
p64138
aVAs  and  are implemented in C, this combo will always be faster than custom objects, functions or lambdas to wrap the access
p64139
as(dp64140
g16
V100297
p64141
stp64142
a((dp64143
g2
(lp64144
VURLs are not only encoded as UTF-8; they are also URL encoded
p64145
aVDecode that too, using the  function:
p64146
aVDemo:
p64147
as(dp64148
g16
V100297
p64149
stp64150
a((dp64151
g2
(lp64152
VUse a nested list comprehension, retaining elements instead:
p64153
aVDemo:
p64154
aVYour mistake was to remove  from  instead, but even if you removed the elements from  you'd end up with modifying the list in place while iterating over it, which means that further iteration will skip elements:
p64155
aVThat's because the list iterator moves to the next index regardless of later additions or deletions from the list; when removing the first  at index 1 the loop moves on to index 2 in a list where everything past index 1 has moved down a spot
p64156
as(dp64157
g16
V100297
p64158
stp64159
a((dp64160
g2
(lp64161
VJust concatenate the lists:
p64162
aVThe first argument must be a list of strings; simply build that list from two separate lists
p64163
as(dp64164
g16
V100297
p64165
stp64166
a((dp64167
g2
(lp64168
VSubclass :
p64169
aVThis will not automatically create nested instances of itself; you'll need to loop over the input dictionary and create nested objects yourself
p64170
aVBut it does offer attribute access and default values:
p64171
aVTo build your tree from an existing dictionary, use the  class method:
p64172
aVNote that keys on the dictionary can mask methods; keep that in mind when inserting keys that match dictionary methods:
p64173
as(dp64174
g16
V100297
p64175
stp64176
a((dp64177
g2
(lp64178
VFor Python 2, you need to test both if the object is a method, and if  points to the class (for regular methods it'll be  when retrieved from the class):
p64179
aVIn Python 3, regular methods show up as functions (unbound methods have been done away with)
p64180
aVCombine this with  for a fail-safe method to detect a class method in both Python 2 and 3:
p64181
aVThe  attribute was added in Python 2
p64182
aV6 to be consistent with Python 3
p64183
aVIn Python 2
p64184
aV6 and 2
p64185
aV7 it is an alias of
p64186
as(dp64187
g16
V100297
p64188
stp64189
a((dp64190
g2
(lp64191
VYou could sort the keys:
p64192
aVOtherwise, dictionaries have no set order
p64193
aVYou could use  instead though; it  maintains items in insertion order; if  is inserted before  then it'll also be listed first when iterating over the dictionary
p64194
aVIf all you have are otherwise equal items, only differing in order (so just , , etc
p64195
aVyou may as well just use a list instead
p64196
aVEven if you had different types of items, you could also group those items by type;
p64197
as(dp64198
g16
V100297
p64199
stp64200
a((dp64201
g2
(lp64202
VFormat the  manually:
p64203
aVDemo:
p64204
aVThis method does ignore the  attribute
p64205
aVIf you have timedeltas with more than 24 hours, use:
p64206
aVDemo:
p64207
as(dp64208
g16
V100297
p64209
stp64210
a((dp64211
g2
(lp64212
VDon't use tuples as your intermediary variables; just print the whole thing:
p64213
aVand you may want to use a -based loop instead of :
p64214
aVNote that there is no need to call  so many times; use it only on the return value of , which is a string otherwise
p64215
as(dp64216
g16
V100297
p64217
stp64218
a((dp64219
g2
(lp64220
VYou are turning any number into either  or  with
p64221
aVYou may as well just print
p64222
aVYou need to use integer division instead, and test separately for even or odd
p64223
aVEven better, you could just append the output of the modulus test, as string, to :
p64224
aVDemo with the code simplified a bit:
p64225
aVYou could also bitshift the value; the  operator moves the bits to the right for you by a given number of steps;  shifts the bits in  one step over, essentially dividing by two
p64226
aVYou could also look into the  function (returns the value as a binary string, starting with ), and the  function, together with the  method, which lets you format values as binary strings as well using the  output format
p64227
aVPrinting your values in a loop could be as simple as:
p64228
aVLast but not least, you are simply producing the product of the digits 0 and 1,  times
p64229
aVYou could express that with  as well:
p64230
aVbut that could be seen as cheating
p64231
aV:-)
p64232
as(dp64233
g16
V100297
p64234
stp64235
a((dp64236
g2
(lp64237
VNo,  can only return  or
p64238
aVAll values in Python have boolean meaning
p64239
aVIf the value is not an empty container, numeric 0,  or ,  returns
p64240
aVNote that  will use the ,  (Python 2) and  (Python 3) special methods if present; if these throw an exception  will not catch it
p64241
as(dp64242
g16
V100297
p64243
stp64244
a((dp64245
g2
(lp64246
VUse the  operator:
p64247
aVDemo:
p64248
aVYou really want to start reading the Python tutorial, the section on dictionaries covers this very subject
p64249
as(dp64250
g16
V100297
p64251
stp64252
a((dp64253
g2
(lp64254
VYou'd have to generate the indices, then use a list comprehension to select all values not matching those indices
p64255
aVUse a  object for an efficient method to test for indices ( in python 2):
p64256
aVThe  object in Python 3 ( in Python 2) only holds the start, end, and step values,  tests simply do a quick calculation if the tested value is part of the range
p64257
aVDemo:
p64258
aVYes, this still requires using an  statement, but the test is cheap and can be incorporated in a generator expression as needed:
p64259
as(dp64260
g16
V100297
p64261
stp64262
a((dp64263
g2
(lp64264
VReturn your lists as a tuple instead:
p64265
aVPython does not execute all three  statements, only the first
p64266
aVIf you are trying to sort your items into different categories, you'd normally use a dictionary:
p64267
aVYou can then still extract those three lists into 3 variables, but you may as well reference the buckets directly
p64268
aVInstead of , you'd refer to , for example
p64269
as(dp64270
g16
V100297
p64271
stp64272
a((dp64273
g2
(lp64274
VYou already have a Unicode value, so trying to decode it forces an encode first, using the default codec
p64275
aVIt looks like you received malformed JSON instead; JSON values are already unicode
p64276
aVIf you have UTF-8 data in your Unicode values, the only way to recover is to encode to Latin-1 (which maps the first 255 codepoints to bytes one-on-one), then decode from that as UTF8:
p64277
aVThe better solution is to fix the JSON source, however; it should not doubly-encode to UTF-8
p64278
aVThe correct representation would be:
p64279
as(dp64280
g16
V100297
p64281
stp64282
a((dp64283
g2
(lp64284
VThe raw string notation is just that, a notation to specify a string value
p64285
aVThe notation results in different string values when it comes to backslash escapes recognized by the normal string notation
p64286
aVBecause regular expressions also attach meaning to the backslash character, raw string notation is quite handy as it avoids having to use excessive escaping
p64287
aVQuoting from the Python Regular Expression HOWTO:
p64288
aVThe solution is to use Python\u2019s raw string notation for regular expressions; backslashes are not handled in any special way in a string literal prefixed with , so  is a two-character string containing  and , while  is a one-character string containing a newline
p64289
aVRegular expressions will often be written in Python code using this raw string notation
p64290
aVThe  combination has no special meaning in regular python strings, so there is no difference, at all between the result of  and ; you can use either:
p64291
aVRaw strings only make a difference when the backslash + other characters do have special meaning in regular string notation:
p64292
aVThe  combination has special meaning; in a regular string it is interpreted as the backspace character
p64293
aVBut regular expressions see  as a word boundary anchor, so you'd have to use  in your Python string every time you wanted to use this in a regular expression
p64294
aVUsing  instead makes it much easier to read and write your expressions
p64295
aVThe regular expression functions are passed string values; the result of Python interpreting your string literal
p64296
aVThe functions do not know if you used raw or normal string literal syntax
p64297
as(dp64298
g16
V100297
p64299
stp64300
a((dp64301
g2
(lp64302
VNamed tuples are immutable, so you cannot manipulate them in the  initializer
p64303
aVYour only option is to override the  method:
p64304
aVNote that because  is a factory method for new instances, you do need to return the newly created instance
p64305
aVIf you do not use  in the  method, the default return value is , which gives you your error
p64306
aVDemo with an object with  and  attributes:
p64307
aVPython does not support method overloading; generally you either use optional keyword arguments or extra class methods as factory methods
p64308
aVThe  module, for example, has several such factory methods to let you create objects  that do not fit the standard constructor
p64309
aVcreates a  instance from a single numeric value, and so does ; except that they interpret the number in different ways
p64310
aVIf you wanted to support variable arguments, do:
p64311
aVHere,  is an optional argument, defaulting to  if not supplied by the caller:
p64312
aVThe alternative, using a class method, would be:
p64313
aVNow there are two factory methods; one default and one named:
p64314
as(dp64315
g16
V100297
p64316
stp64317
a((dp64318
g2
(lp64319
V always returns  unless there is an element in the sequence that is
p64320
aVYour loop produces 0 items, so  is returned
p64321
aVThis is documented:
p64322
aVReturn  if all elements of the iterable are true (or if the iterable is empty)
p64323
aVEmphasis mine
p64324
aVSimilarly,  will always return , unless an element in the sequence is , so for empty sequences,  returns the default:
p64325
as(dp64326
g16
V100297
p64327
stp64328
a((dp64329
g2
(lp64330
VYou need to use raw strings or double the backslashes:
p64331
aVor
p64332
aVIn a regular Python string literal,  is interpreted as an octal character code instead:
p64333
aVwhile the backslash has no special meaning in a raw string literal:
p64334
aVRaw string literals are just a notation, not a type
p64335
aVBoth  and  produce strings, and only differ in how they interpret backslashes in source code
p64336
aVNote that since group 1 and group3 match literal text, you don't need to use substitutions at all; simply use:
p64337
aVor use look-behind and lookahead and forgo having to repeat the literals:
p64338
aVDemo:
p64339
as(dp64340
g16
V100297
p64341
stp64342
a((dp64343
g2
(lp64344
VYou need to divide the length, not the list:
p64345
aVThis uses the floor division () operator to ensure the result is an integer
p64346
aVYour next problem is that you refer to  in several locations, but named your argument just ; fix those references and your function works:
p64347
aVYour function can be simplified somewhat; you do not need a  variable as Python lets you swap values in-place:
p64348
aVAlso note that you are reversing the list in place; there is no real need to return the resulting list object here:
p64349
as(dp64350
g16
V100297
p64351
stp64352
a((dp64353
g2
(lp64354
VIf you have to avoid using /, use:
p64355
aVas a test; this matches almost all string values that  will accept as a base-10 number:
p64356
aVIn normal code, we use /, however:
p64357
as(dp64358
g16
V100297
p64359
stp64360
a((dp64361
g2
(lp64362
V must be a sequence, but you are passing in the string:
p64363
aVAdd a comma:
p64364
aVYou need at least one comma to make a tuple; in many contexts the parenthesis are optional:
p64365
aVWithout the comma, you are passing in a sequence of 29 individual characters to the  function
p64366
as(dp64367
g16
V100297
p64368
stp64369
a((dp64370
g2
(lp64371
VThe package is trying to download a public suffix list from a URL that currently does not work:
p64372
aVThis is due to a DDOS attack on that URL, Mozilla has blocked the URL for now
p64373
aVThis has already been reported to the project, and a fix has been proposed albeit that the latter only works if you already have a cached copy of the public suffix list
p64374
aVIn the meantime, use the  package instead; it bundles the data in the package itself and does not require a URL request
p64375
aVUpdate: Mozilla now host the file at https://publicsuffix
p64376
aVorg/list/effective_tld_names
p64377
aVdat and any access to the MXR source repository without a mxr
p64378
aVmozilla
p64379
aVorg Referer header redirects you to that new location
p64380
as(dp64381
g16
V100297
p64382
stp64383
a((dp64384
g2
(lp64385
VYou can replace functions dynamically in Python:
p64386
aVWhen  is then called it will use the replacement function; the lookup for  is done when  is called, not when the module is loaded
p64387
as(dp64388
g16
V100297
p64389
stp64390
a((dp64391
g2
(lp64392
VDon't use  as it scans through your list for each element
p64393
aVMoreover, it'll add items to the output multiple times if they appear 3 or more times in the input
p64394
aVYou'd be better off using a generator function here that only yields items it has seen before, but only once:
p64395
aVThis iterates just once through each list (unlike using a )
p64396
aVThis method is far faster:
p64397
aVThat's about 8 times faster than the  method, 2
p64398
aV2 times the  method
p64399
aVJon's one-dictionary-plus-counter method is faster still, though
p64400
aVHowever, if you just needed to eliminate values that appear only once but keep the rest intact including repeats, then you'd use (borrowing from Jon):
p64401
aVThis produces:
p64402
aVThat's almost twice the speed of the  solution proposed by FMc, but it doesn't retain order as precisely:
p64403
as(dp64404
g16
V100297
p64405
stp64406
a((dp64407
g2
(lp64408
VOld-style classes do not support a  method:
p64409
aVis a new-style class feature only
p64410
as(dp64411
g16
V100297
p64412
stp64413
a((dp64414
g2
(lp64415
VYou are using an older Python version; the error message has since been updated:
p64416
aVPython will only complain about  not supporting arguments if neither  nor  have been overridden; e
p64417
ag1298
aVwhen you inherit both from
p64418
aVfits that case,  does not because it has an  method
p64419
aVThis is to support implementing immutable types that don't have a use for  (which would be inherited from  in that case), and mutable types, where  should not care about what arguments  expects (which usually would be more arguments)
p64420
aVSee issue 1683368 where Guido van Rossum explains his motivations for this
p64421
aVThe  source code has this to say:
p64422
aVYou may wonder why  only complains about arguments
p64423
aVwhen  is not overridden, and vice versa
p64424
aVConsider the use cases:
p64425
aVWhen neither is overridden, we want to hear complaints about
p64426
aVexcess (i
p64427
ag7233
aV, any) arguments, since their presence could
p64428
aVindicate there's a bug
p64429
aVWhen defining an Immutable type, we are likely to override only
p64430
aV, since  is called too late to initialize an
p64431
aVImmutable object
p64432
aVSince  defines the signature for the
p64433
aVtype, it would be a pain to have to override  just to
p64434
aVstop it from complaining about excess arguments
p64435
aVWhen defining a Mutable type, we are likely to override only
p64436
aVSo here the converse reasoning applies: we don't
p64437
aVwant to have to override  just to stop it from
p64438
aVcomplaining
p64439
aVWhen  is overridden, and the subclass  calls
p64440
aV, the latter should complain about excess
p64441
aVarguments; ditto for
p64442
aVUse cases 2 and 3 make it unattractive to unconditionally check for
p64443
aVexcess arguments
p64444
aVThe best solution that addresses all four use
p64445
aVcases is as follows:  complains about excess arguments
p64446
aVunless  is overridden and  is not overridden
p64447
aV(IOW, if  is overridden or  is not overridden);
p64448
aVsymmetrically,  complains about excess arguments unless
p64449
aVis overridden and  is not overridden
p64450
aV(IOW, if  is overridden or  is not overridden)
p64451
aVHowever, for backwards compatibility, this breaks too much code
p64452
aVTherefore, in 2
p64453
aV6, we'll warn about excess arguments when both
p64454
aVmethods are overridden; for all other cases we'll use the above
p64455
aVrules
p64456
aVNote that the  method itself will still complain
p64457
aVWhen you create an instance, both  and  are called; your code only calls  directly and does not invoke
p64458
aVCreating an instance of  and  both fails if you pass in arguments:
p64459
aVThe only difference is that for  it is the default methods for  that complain instead a specific error for the custom
p64460
as(dp64461
g16
V100297
p64462
stp64463
a((dp64464
g2
(lp64465
VYou never returned  back; Python passes objects by reference, but you are rebinding the reference in the function:
p64466
aVThat assigns a new value only to the local name ; the original reference is not updated
p64467
aVThe best way to deal with this is by returning the new value:
p64468
aVNow the function returns the new health value, and you can assign that value back to the  or  globals
p64469
as(dp64470
g16
V100297
p64471
stp64472
a((dp64473
g2
(lp64474
VCustom python classes can be parsed using the  format:
p64475
aV(object) [PyObject *]
p64476
aVStore a Python object (without any conversion) in a C object pointer
p64477
aVThe C program thus receives the actual object that was passed
p64478
aVThe object\u2019s reference count is not increased
p64479
aVThe pointer stored is not NULL
p64480
as(dp64481
g16
V100297
p64482
stp64483
a((dp64484
g2
(lp64485
VFor subtraction you could loop yourself and subtract:
p64486
aVThis presumes that you want to start with the first number and subtract all the other numbers from that first value
p64487
aVYou could still use  but then you'd have to  all but the first number to negative:
p64488
aVThe  function negates numbers, and we make use of the second argument to  to provide a start value
p64489
aVDemo:
p64490
as(dp64491
g16
V100297
p64492
stp64493
a((dp64494
g2
(lp64495
VIn Python 2,  is already encoded
p64496
aVBecause you are trying to encode an already encoded value, Python tries to decode it to  for you first using the default ASCII codec, and that fails
p64497
aVThe encoding of the  value depends on how you entered the string literal
p64498
aVIn the terminal, it'll use the terminal codec
p64499
aVIn a source file, it depends on your editor what codec was used to save the file
p64500
aVIf loaded from another source (an external file, stream or network socket) it very much depends on standards for that communication channel what codec has been used, and whether or not your program can retrieve the exact codec used
p64501
aVSometimes it is not known and not reliably extractable
p64502
aVYou cannot detect the difference between a 'normal'  and encoded data, because all  values are encoded data
p64503
aVYou'd normally look for  values and use  on those to get  values:
p64504
as(dp64505
g16
V100297
p64506
stp64507
a((dp64508
g2
(lp64509
VYou can use the  and  values
p64510
aVThese provide:
p64511
aVThe offset of the local (non-DST) timezone, in seconds west of UTC (negative in most of Western Europe, positive in the US, zero in the UK)
p64512
aVand
p64513
aVThe offset of the local DST timezone, in seconds west of UTC, if one is defined
p64514
aVThis is negative if the local DST timezone is east of UTC (as in Western Europe, including the UK)
p64515
aVOnly use this if  is nonzero
p64516
aVAs the documentation for  explains, use the latter when  is non-zero, but only if the current time is in summer time:
p64517
aVUsing seconds as a base and  there should be no rounding errors here
p64518
aVFor my British summertime location, that gives:
p64519
as(dp64520
g16
V100297
p64521
stp64522
a((dp64523
g2
(lp64524
VYou need to add  as well to handle the reverse case:
p64525
aVand note that you should not raise an exception; return the  singleton instead
p64526
aVThat way the other object could still try to support  or  for your object and would be given a chance to implement addition too
p64527
aVWhen you try to add two types  and , Python first tries to call ; if that call returns ,  is attempted instead
p64528
aVDemo:
p64529
as(dp64530
g16
V100297
p64531
stp64532
a((dp64533
g2
(lp64534
VYou are mixing tabs and spaces
p64535
aVPython 3 explicitly disallows this
p64536
aVUse spaces only for indentation
p64537
aVQuoting from the Python Style Guide (PEP 8):
p64538
aVSpaces are the preferred indentation method
p64539
aVTabs should be used solely to remain consistent with code that is already indented with tabs
p64540
aVPython 3 disallows mixing the use of tabs and spaces for indentation
p64541
aVEmphasis mine
p64542
aVAlmost all editors can be configured to replace tabs with spaces when typing, as well as do a search and replace operation that replaces existing tabs with spaces
p64543
as(dp64544
g16
V100297
p64545
stp64546
a((dp64547
g2
(lp64548
VYou need to import that object, you haven't done so in your code
p64549
aVSimply add  to your existing  line:
p64550
aVThe same applies to ; you need to explicitly import it, it is not a Python built-in
p64551
as(dp64552
g16
V100297
p64553
stp64554
a((dp64555
g2
(lp64556
VYes, the loop automatically calls
p64557
aVThe  loop does this to the given object:
p64558
aVThe  function calls , and the  function calls ; these functions offer some extra functionality and are the proper way of calling into the iterator API
p64559
aVSo, in each loop iteration,  is assigned the value that the  method returned
p64560
aVYou can also see that  is its own iterator;  returns
p64561
aVOther types can return a dedicated iterator object; lists do, for example:
p64562
aVReturning dedicated iterators lets you create multiple 'views' on an object where each iterator maintains its own position, like nested loops:
p64563
aVor you can explicitly reuse the iterator:
p64564
as(dp64565
g16
V100297
p64566
stp64567
a((dp64568
g2
(lp64569
VPython creates a separate namespace for the main module,
p64570
aVYou test for this namespace in :
p64571
aVHowever, when  uses , a new namespace is created,
p64572
aVBoth these namespaces have a separate copy of
p64573
aVWhen you print , you are printing , while  refers to , which is a different object
p64574
aVFor , you are importing  from , so both  and  refer to  there
p64575
as(dp64576
g16
V100297
p64577
stp64578
a((dp64579
g2
(lp64580
VYou can use the  function to turn position in the  into a sort key:
p64581
aVYou may want to turn your  into a dictionary however, for faster mapping:
p64582
aVDictionary lookups take constant time,  time is directly proportional to the length of the list
p64583
aVAnother advantage is that with a dictionary, you can return a default value for entries not found in the dictionary ( in this example);  will raise a  exception instead
p64584
aVDemo:
p64585
as(dp64586
g16
V100297
p64587
stp64588
a((dp64589
g2
(lp64590
VAdapting Generate a list of datetimes between an interval in python to your needs:
p64591
aVThis yields a  tuple that is constrained to the  date for the last segment:
p64592
aVNote that the last result covers only 2 days
p64593
as(dp64594
g16
V100297
p64595
stp64596
a((dp64597
g2
(lp64598
VNo, there is no such feature in Python 2; names are constricted to using ASCII letters and digits only
p64599
aVSee the Identifiers and Keywords section of the reference manual:
p64600
aVIdentifiers (also referred to as names) are described by the following
p64601
aVlexical definitions:
p64602
aVIt was PEP 3131 that expanded the range of possible characters for Python 3
p64603
aVThere is little point in porting this to the 2
p64604
aVx branch; it would remain a niche 'feature' that requires everyone running your code to install a specially patched and compiled interpreter
p64605
aVNote that the change is not trivial; Python 2 identifiers are byte strings, not unicode values
p64606
aVYou'd have to find all locations in the interpreter that handle identifiers and verify that these can handle non-ASCII values or retool these for unicode strings instead
p64607
aVThis goes way beyond the compiler
p64608
as(dp64609
g16
V100297
p64610
stp64611
a((dp64612
g2
(lp64613
VYou can store information keyed by column 2 in a dictionary for easy lookup; for each unique column value keep a list of entries to match against later on
p64614
aVA  object makes the first part easy
p64615
aVI'd use  to give each column a meaningful name; instead of mentally having to map each column number to a meaning, the columns then have names, much easier to track:
p64616
aVThis just matches your first scenario, but the other scenarios are just as easy to match
p64617
aVThis should be efficient enough if the number of entries per unique class indicator is low
p64618
aVIf you run into hundreds (or worse) of rows per indicator, you need to start looking into efficient matching structures per scenario (as they match in different ways), to speed up lookups
p64619
aVThis will probably require more memory, trading memory for increased speed
p64620
aVTesting the above against your input dataset prints:
p64621
aVAdjusting the code to support unique  tuples:
p64622
as(dp64623
g16
V100297
p64624
stp64625
a((dp64626
g2
(lp64627
VIf you want to just join each CSV row based on ID, then don't use a
p64628
aVDictionary keys must be unique, but you are producing rows with multiple  and , etc
p64629
aVcolumns
p64630
aVMoreover, how will you handle ids where one or two of the input CSV files has no input
p64631
aVUse regular readers and store each row keyed by filename
p64632
aVMake  a list as well:
p64633
aVThis code stores rows per filename, so that you can later build a whole row from each file but still fill in blanks if the row was missing in that file
p64634
aVThe alternative would be to make column names unique by appending a number or filename to each; that way your  approach could work too
p64635
aVThe above gives:
p64636
aVIf you need to base your order on one of the input files, then omit that input file from the first reading loop; instead, read that file while writing the output loop and use its first column to look up the other file data:
p64637
aVThis does mean that any  values extra in the other two files are ignored
p64638
aVIf you wanted to preserve all s then I'd use ; new s found in the later files will be tacked onto the end:
p64639
aVThe  maintains entries in insertion order; so  sets the order for all keys, but any  ids not found in the first file are appended to the dictionary at the end, and so on
p64640
aVFor Python versions < 2
p64641
aV7, either install a backport (see OrderedDict for older versions of python) or track the ID order manually with:
p64642
as(dp64643
g16
V100297
p64644
stp64645
a((dp64646
g2
(lp64647
VYou are changing the length of the list while looping over a range that goes up to the starting length of the list; remove one item from the list and the last index is no longer valid
p64648
aVMoveover, because items are removed from the list at the current index, the rest of the list indices shift; what was at index  is now at index  and your loop index is no longer useful
p64649
aVLast but not least, you are looping until the very last index of , but then try to access  still; that index does not exist even if you were not removing elements from the list
p64650
aVYou could use a  loop to achieve what you want to do:
p64651
aVNow  is tested against the new length each loop iteration, and we only increment  if no element was removed
p64652
aVNote that the loop is limited to the length minus 1 because you want to test for  each iteration
p64653
aVNote that I use ; no need to scan through the list searching for that the value-to-remove again; this could lead to subtle bugs as well if values appear multiple times in the list but only later instances should be removed; e
p64654
ag1298
aVshould result in , not , which is what  would result in
p64655
aVDemo:
p64656
aVYou could use a list comprehension to avoid the shrinking list problem:
p64657
aVBoth approaches require only one loop through the input list
p64658
as(dp64659
g16
V100297
p64660
stp64661
a((dp64662
g2
(lp64663
VYou are not writing CSV data
p64664
aVYou are writing Python string representations of lists
p64665
aVYou are writing the whole  and  lists each iteration of your loop, instead of writing  and , and Excel sees the comma in the Python string representation:
p64666
aVwhile you wanted to write:
p64667
aVUse the  module to produce CSV files:
p64668
aVNote the  statement; it takes care of closing the open file object for you
p64669
aVThe  module also makes sure everything is converted to strings
p64670
aVIf you want to write something only on the first row, keep a counter with your items;  makes that easy:
p64671
as(dp64672
g16
V100297
p64673
stp64674
a((dp64675
g2
(lp64676
VYou don't need to call  directly; call the class:
p64677
aVThe  initializer method will then be called automatically
p64678
as(dp64679
g16
V100297
p64680
stp64681
a((dp64682
g2
(lp64683
VDisable  quoting and add the quotes yourself:
p64684
aVBy setting both  and  to empty strings you avoid the module quoting your already-quoted values
p64685
aVThe above works as long as you don't use the delimiter in the csv values
p64686
aVNote that by this time it would just be easier to write comma-delimited lines yourself:
p64687
as(dp64688
g16
V100297
p64689
stp64690
a((dp64691
g2
(lp64692
VUsing  is perhaps easiest:
p64693
aVDemo:
p64694
aVYou can also use a  object, which has a  method:
p64695
aVThis misses the timezone  marker; you could just add that
p64696
as(dp64697
g16
V100297
p64698
stp64699
a((dp64700
g2
(lp64701
VYou want to return the result from the function; add a statement at the end:
p64702
aVAlso, you rebind  to an empty list at the start of the function; remove that line alltogether; otherwise you are ignoring the  argument passed to the function:
p64703
aVYou could simplify the loop to using a list comprehension:
p64704
as(dp64705
g16
V100297
p64706
stp64707
a((dp64708
g2
(lp64709
VYour lost byte is right there;  is character 10 in the ASCII table:
p64710
aVInstead of displaying it as  it is displayed as a Python string literal escape code; other known escapes are also shown that way
p64711
aVPrintable ASCII characters are shown as characters:
p64712
aVIt might help to use  to convert your bytes to hexadecimal characters:
p64713
as(dp64714
g16
V100297
p64715
stp64716
a((dp64717
g2
(lp64718
VYour generator is easily adapted:
p64719
aVThis counts down from  to 1:
p64720
aVIf you want to count down to 0, test for
p64721
as(dp64722
g16
V100297
p64723
stp64724
a((dp64725
g2
(lp64726
VIf you call  on the reader you get one row at at a time; use that to copy over the headers
p64727
aVCopying the email column is easy enough:
p64728
aVThis code splits the email address on the first  sign, takes the first part of the split and adds  after it:
p64729
aVThe above produces:
p64730
aVfor your sample input
p64731
as(dp64732
g16
V100297
p64733
stp64734
a((dp64735
g2
(lp64736
VMake the  newlines part of the string:
p64737
aVYou really want to use some string formatting here, together with a triple-quoted raw string to cut down on all those backslashes:
p64738
as(dp64739
g16
V100297
p64740
stp64741
a((dp64742
g2
(lp64743
VYou need to concatenate the strings when opening the file, or use string formatting;  does not work like , it won't guess what arguments should be concatenated:
p64744
aVNext, you have CSV files, so use the  module to read them:
p64745
aVNext I'd use a  to track name counts:
p64746
aVNow you have a per-name-and-sex count, and can ask for the top 20:
p64747
as(dp64748
g16
V100297
p64749
stp64750
a((dp64751
g2
(lp64752
VTrack the schema version in the database with the  PRAGMA, and keep a sequence of upgrade steps:
p64753
as(dp64754
g16
V100297
p64755
stp64756
a((dp64757
g2
(lp64758
VYou cannot do what you want to do; sqlite cannot parse Python for you and 'understand' what your  script does with MySQL
p64759
aVYour  script doesn't contain the MySQL tables either; it at most contains SQL statements that instruct MySQL to create those tables
p64760
aVYou'll have to translate those SQL statements to sqlite instead; each database brand uses their own dialect of SQL
p64761
aVIt'll be similar but not the same, as MySQL and sqlite have different philosophies about how databases ought to store and treat data
p64762
aVIf you were using a ORM like SQLAlchemy, then you need to configure the ORM to connect to sqlite instead of MySQL; a good ORM can translate the table structures expressed in Python code to different database SQL dialects for you
p64763
as(dp64764
g16
V100297
p64765
stp64766
a((dp64767
g2
(lp64768
VYou can assign roles to groups directly, both globally and in a given context
p64769
aVSimply design your workflow around roles, not groups
p64770
aVThrough group membership, users will have the correct roles in the correct context
p64771
aVSo, in the group folder, assign the editor role to the corresponding  group, and the reviewer role to the appropriate  group
p64772
aVWhen the group leader is removed from the  group, and another user added to that group, roles automatically follow
p64773
as(dp64774
g16
V100297
p64775
stp64776
a((dp64777
g2
(lp64778
VYou need to use keyword arguments when calling:
p64779
aVThe  object that proxies the API request does not know how to translate positional arguments to URL parameters; it carries no mapping from argument at position 0 to parameter  in the query
p64780
aVThe  keyword, however, is special; the  library assumes that to be part of the URL;  should be used when the API call requires a  query parameter instead
p64781
aVThe PyPI page doesn't render the readme very well; you may want to refer to the GitHub project page instead as the examples are more readable there
p64782
aVThat page gives, among others, the following example:
p64783
aVFor completeness sake, the counter example is when to use ; the API URL  becomes:
p64784
aVYes, that's two forms that both work, but not all valid id values are valid Python attribute names
p64785
as(dp64786
g16
V100297
p64787
stp64788
a((dp64789
g2
(lp64790
VYes, CPython will
p64791
aVFile objects close automatically when their reference count drops to 0
p64792
aVA local scope being cleaned up means that the refcount drops, and if the local scope was the only reference then the file object refcount drops to 0 and is closed
p64793
aVHowever, it is better to use the file object as a context manager in a  statement and have it closed automatically that way; don't count on the specific garbage handling implementation of CPython:
p64794
aVNote that  is a hook for custom Python classes; file objects are implemented in C and fill the  slot instead
p64795
aVThe  function closes the file object
p64796
aVIf you want to hold a file object open for longer, make sure there is still a reference to it
p64797
aVStore a reference to it somewhere else too
p64798
aVReturn it from the function and store the return value, for example, or make it a global, etc
p64799
as(dp64800
g16
V100297
p64801
stp64802
a((dp64803
g2
(lp64804
VYou generally want to use a tool like  or  to handle the installation of packages for you
p64805
aVThe  script takes commands; it can do different things for you, including installing in you Python site-packages location, but you do need to tell it what command to execute
p64806
aVTo see the available commands, use:
p64807
aVbut for installing, you probably wanted:
p64808
as(dp64809
g16
V100297
p64810
stp64811
a((dp64812
g2
(lp64813
VYou created a circular import; your  module imports  which imports the  module
p64814
aVYou end up with incomplete modules that way, don't do that
p64815
aVRemove the  line from ; you are not using  in that module
p64816
aVAlso, another module cannot read your globals; you need to pass those in as arguments:
p64817
aVthen call that with:
p64818
aVNote that you are not limited to one-letter variable names
p64819
aVUsing longer, descriptive names makes your code more readable
p64820
as(dp64821
g16
V100297
p64822
stp64823
a((dp64824
g2
(lp64825
VYou are looking at the default representation of a function object
p64826
aVIt provides you with a name and a unique id, which in CPython happens to be a memory address
p64827
aVYou cannot access it using the address; the memory address is only used to help you distinguish between function objects
p64828
aVIn other words, if you have two function objects which were originally named , you can still see that they are different:
p64829
as(dp64830
g16
V100297
p64831
stp64832
a((dp64833
g2
(lp64834
VSplit on commas, then map to integers:
p64835
aVOr use a list comprehension:
p64836
aVThe latter works better on Python 3 if you want a list result
p64837
aVThis works because  tolerates whitespace:
p64838
aVSplitting on just a comma also is more tolerant of variable input; it doesn't matter if 0, 1 or 10 spaces are used between values
p64839
as(dp64840
g16
V100297
p64841
stp64842
a((dp64843
g2
(lp64844
VBecause 's intention has nothing to do with privacy (it is not a limit on what is exported, it is a tool to delimit wildcard importing) no tool in the Python ecosystem exists that takes that interpretation and tracks usage of names that are not listed in
p64845
aVIn other words;  was never intended as a means to bless only parts of the exported names as public, just as  leading underscores are just private by convention and not enforced
p64846
as(dp64847
g16
V100297
p64848
stp64849
a((dp64850
g2
(lp64851
VYou can use the  calling syntax to apply a dictionary as keyword arguments:
p64852
aVIf the dictionary has a  key, it'll be passed to the  method as a keyword argument
p64853
aVIf it does not, then  is set to the default specified in the method signature
p64854
aVDemo:
p64855
aVThere is a mirror syntax to this for function signatures;  in the argument list captures keyword arguments not explicitly named:
p64856
aVAny additional keyword arguments beyond  and  end up in the dictionary  that way
p64857
aVYou can use it to support arbitrary arguments, or to ignore additional keyword arguments passed in without exceptions being thrown
p64858
as(dp64859
g16
V100297
p64860
stp64861
a((dp64862
g2
(lp64863
VNo, the  statement is not executed
p64864
aVYou need to call the function for it to run:
p64865
aVNote the , the parenthesis invoke (call) the function
p64866
aVThe above can be better expressed as:
p64867
aVPython functions are first-class objects;  is just a reference to the function object, and does not invoke it
p64868
aVFunction objects, like most objects in Python, are considered  in a boolean context:
p64869
aVso even if you had changed  to be  in your function (so ) your code would still have printed
p64870
as(dp64871
g16
V100297
p64872
stp64873
a((dp64874
g2
(lp64875
VYou are trying to loop over the expression , which returns a boolean ( is true-ish, so  returns , which will either be  or )
p64876
aVThat doesn't work
p64877
aVStick to just an iterable, like  on its own
p64878
aVIf you wanted to incorporate a test for , make that a separate  statement:
p64879
aVNote that  won't work either;  expects a sequence of values, not one value
p64880
aVTo add  to , you first need to set  to an initial value then use  to sum, or  to add in-place:
p64881
aVLast but not least, you are ignoring and masking the  argument to your function; in the loop,  is re-bound to next loop value making the function argument redundant
p64882
as(dp64883
g16
V100297
p64884
stp64885
a((dp64886
g2
(lp64887
VYou do close files:
p64888
aVso in the next iteration of your  loop you pass in:
p64889
aVand  is a closed file
p64890
aVdoes not remove the file object from
p64891
aVYou clear , but  is retained between loop iterations
p64892
as(dp64893
g16
V100297
p64894
stp64895
a((dp64896
g2
(lp64897
VJust use the  module and tell it to use  as a delimiter:
p64898
aVA correctly configured  object will read your pipe-separated files just fine
p64899
as(dp64900
g16
V100297
p64901
stp64902
a((dp64903
g2
(lp64904
VYou are misreading the operator; it's  (lower than)  (negative sixtyfour)
p64905
aVThe line you show is a perfect example why the Python Style Guide requires spaces around operators; the following is much clearer:
p64906
aVOr, using chaining:
p64907
as(dp64908
g16
V100297
p64909
stp64910
a((dp64911
g2
(lp64912
VAdd  and  methods to your class:
p64913
aVDemo:
p64914
aVThe  method is called automatically when your object is converted to a string, like the  function does
p64915
aVThe  method is used for  representations and when your object is displayed in lists and other containers
p64916
as(dp64917
g16
V100297
p64918
stp64919
a((dp64920
g2
(lp64921
VYou are constantly reassigning  in the loop:
p64922
aVYou are not building a final list of all entries
p64923
aVYou need a separate list object for that:
p64924
aVNote that you need to return the sorted list too
p64925
aVThis will still not do what you expect, because your last element (at index 2) is still a string
p64926
aVwill sort before  because strings are sorted lexagraphically
p64927
aVMake that a number instead:
p64928
as(dp64929
g16
V100297
p64930
stp64931
a((dp64932
g2
(lp64933
VYou can use the  function in loops to generate numbers:
p64934
aVThe  start value instructs  to start at 1 instead of the default 0
p64935
as(dp64936
g16
V100297
p64937
stp64938
a((dp64939
g2
(lp64940
V is a local name in the function ; it stays local because you don't return it
p64941
aVReturn the variable from the function and store the return value:
p64942
as(dp64943
g16
V100297
p64944
stp64945
a((dp64946
g2
(lp64947
VYou forgot to include the URL scheme:
p64948
aVNote the  there, that is important
p64949
aVWithout it, the URL is not parsed correctly:
p64950
aVSee how the  parameter is empty when no  is included; you end up trying to connect to your own machine instead, and you are not running a webserver so the connection is refused
p64951
as(dp64952
g16
V100297
p64953
stp64954
a((dp64955
g2
(lp64956
VThe  module only supports the keys ,  and ; your  key is entirely ignored
p64957
aVThe  key does let you specify a custom formatter, so your best option is to subclass  and have that subclass set the converter:
p64958
aVthen refer to that class in your YAML:
p64959
as(dp64960
g16
V100297
p64961
stp64962
a((dp64963
g2
(lp64964
VDo not use string interpolation to build your SQL; you'll introduce errors and open yourself up for SQL injection attacks
p64965
aVUse SQL parameters instead and let the database adapter take care of escaping the values for you:
p64966
as(dp64967
g16
V100297
p64968
stp64969
a((dp64970
g2
(lp64971
VUse a dispatch dictionary mapping domain to function:
p64972
aVPython functions are first-class objects and can be stored as values in a dictionary just like any other object
p64973
as(dp64974
g16
V100297
p64975
stp64976
a((dp64977
g2
(lp64978
VUse the  format:
p64979
aVThis tells Python to apply each element of  as a separate argument to the  method
p64980
aVDo note your  format could end up with too many or too few elements if you hardcode the count; perhaps use the length of  instead:
p64981
aVor use  to eliminate that last space:
p64982
aVDemo:
p64983
as(dp64984
g16
V100297
p64985
stp64986
a((dp64987
g2
(lp64988
VUse a factory function instead of a default value:
p64989
aVand pass in callables (like functions or lambdas, or default types):
p64990
aVreturns ,  returns a new empty list
p64991
aVThis is what the standard library  type does as well, for example
p64992
aVDemo:
p64993
as(dp64994
g16
V100297
p64995
stp64996
a((dp64997
g2
(lp64998
VUse the  module to handle this instead
p64999
aVThat module parses this file format ( called the Windows INI format ) directly
p65000
as(dp65001
g16
V100297
p65002
stp65003
a((dp65004
g2
(lp65005
VThe function looks at each character and only returns  if all are digits:
p65006
aVOr make use of string comparisons:
p65007
aVYour function is, unfortunately, way off
p65008
aVYou don't define , nor do you loop over the characters of
p65009
aVis a type; strings (even individual characters) are not integers; and a string like  can be converted to an integer but  returns  because '-' is not a digit
p65010
as(dp65011
g16
V100297
p65012
stp65013
a((dp65014
g2
(lp65015
VIf catch-all exception handling is not catching this, then either you are not running this code, or the exception in production happens outside of the try block
p65016
aVThe 500 could even be due to an error completely outside python
p65017
aVIntroduce a deliberate error in this section of code and see if you see a change in behaviour in production
p65018
aVThat at least lets you rule out the possibility of running stale code
p65019
as(dp65020
g16
V100297
p65021
stp65022
a((dp65023
g2
(lp65024
VThere are loads of examples
p65025
aVAny project that defines console scripts uses them, for example
p65026
aVA quick search on GitHub gives you plenty to browse through
p65027
aVI'll focus on one specific example (one that is not on GitHub): Babel
p65028
aVBabel uses both  for both console scripts and to define extension points for translatable text extraction
p65029
aVSee their  source:
p65030
aVTools like  and  use the  entry point to create commandline scripts (one called , running the  callable in the  module)
p65031
aVThe  entry points defines additional commands you can use when running ; these can be used in your own projects to invoke Babel command-line utilities right from your setup script
p65032
aVLast, but not least, it registers its own checkers and extractors
p65033
aVThe  entry point is loaded by the  function, using the   module, giving access to all installed Python projects that registered that entry point
p65034
aVThe following code looks for a specific extractor in those entries:
p65035
aVThis lets any project register additional extractors; simply add an entry point in your  and Babel can make use of it
p65036
as(dp65037
g16
V100297
p65038
stp65039
a((dp65040
g2
(lp65041
VYour problem has nothing to do with file handles and everything with trying to create variables dynamically
p65042
aVThe answer to that is: don't do that
p65043
aVKeep your data out of your variable names
p65044
aVUse a dictionary or list instead; the following list comprehension creates a list of open file objects:
p65045
aVNow you can address ,  and better still, loop over this list to access all open file objects  gives you easy access to the last file object, etc
p65046
aVetc
p65047
aVYour loop looks a lot simpler now too, because now you can use 0-based indexing:
p65048
as(dp65049
g16
V100297
p65050
stp65051
a((dp65052
g2
(lp65053
VYou do not need to call  explicitly
p65054
aVIt is already called when you create your object;  invokes  for you
p65055
aVLater on, in  you call  explicitly, but wrapped in a  call
p65056
aVBecause  doesn't have an explicit  statement (which it should not have),  prints the default return value for functions,
p65057
aVThe following code would come closer to what you expected:
p65058
as(dp65059
g16
V100297
p65060
stp65061
a((dp65062
g2
(lp65063
V is a subclass of , which is documented to behave this way:
p65064
aVAll option names are passed through the  method
p65065
aVIts default implementation converts option names to lower case
p65066
aVThat's because this module parses Windows INI files which are expected to be parsed case-insensitively
p65067
aVYou can disable this behaviour by replacing the  function:
p65068
aVpasses through the options unchanged
p65069
as(dp65070
g16
V100297
p65071
stp65072
a((dp65073
g2
(lp65074
VYou can generate a dictionary with a dict comprehension:
p65075
aVThis produces a dictionary with N keys, keys named , ,
p65076
aV,  with values in the same order as the input  elements
p65077
aVThis syntax requires Python 2
p65078
aV7 or newer; for older versions, you can use the  constructor with a generator expression producing (key, value) pairs:
p65079
aVDemo:
p65080
aVTake into account dictionaries have no set order; the fact that  is listed after the other two keys in the sample output is simply due to the implementation details of the underlying hash table used for
p65081
as(dp65082
g16
V100297
p65083
stp65084
a((dp65085
g2
(lp65086
VUse a simple list comprehension:
p65087
aVDemo:
p65088
aVNote the  test to match the  singleton
p65089
as(dp65090
g16
V100297
p65091
stp65092
a((dp65093
g2
(lp65094
VYou've misunderstood something here
p65095
aVThere is no problem here at all
p65096
aVSyntax errors only apply to source code
p65097
aVString values are not source code
p65098
aVIf your source code uses string literals, Python parses those and produces a string value
p65099
aVThe string literal can have a syntax error in it, but if without errors, it will produce a string value that is just that, a value
p65100
aVIn the Python interpreter such string values are represented using the same format as a string literal, for ease of debugging and copying back into the interpreter
p65101
aVRest assured that the Python interpreter knows how to escape quotes in such values correctly:
p65102
aVI used triple-quoted literal syntax there, but Python echos alternatives that use the minimum quoting style required, and escapes quote symbols as needed
p65103
as(dp65104
g16
V100297
p65105
stp65106
a((dp65107
g2
(lp65108
VYou could sum the scores directly, as you loop:
p65109
aVThe alternative is to use a list and append each new value to it, then sum the lot:
p65110
as(dp65111
g16
V100297
p65112
stp65113
a((dp65114
g2
(lp65115
VFlask-restful is already encoding your data to JSON for you
p65116
aVYou returned a JSON string, and Flask encoded it to JSON again
p65117
aVReturn a list instead:
p65118
as(dp65119
g16
V100297
p65120
stp65121
a((dp65122
g2
(lp65123
VYou are passing a Python object instead of JSON
p65124
aVOn the Python side, convert this to JSON first:
p65125
aVDemo:
p65126
aVThe latter you can load into JavaScript with
p65127
as(dp65128
g16
V100297
p65129
stp65130
a((dp65131
g2
(lp65132
VIf all that was updated in the package was the addition of an entry point, that'd be an irresponsible release; if any feature changes in a package, you need to update the version number
p65133
aVHow else will you know that you have the right feature set installed
p65134
aVIf you are using eggs from a VCS, then pip already takes care of updating the egg info for you
p65135
aVJust run  again; it'll update the package and re-generate the egg info for you:
p65136
aVNote the second invokation; instead of 'cloning', the second run states  is 'updating' the VCS clone, after which  is run again
p65137
aVThe egg info metadata is entirely generated from source; only commit the source to the VCS and leave the egg info out of it entirely
p65138
aVThat way you can still generate platform-specific dependencies as well, for example
p65139
as(dp65140
g16
V100297
p65141
stp65142
a((dp65143
g2
(lp65144
VYou need to restart the Apache server for Django to pick up changes
p65145
aVPython loads source files just once, when a module is imported
p65146
aVThe compiled bytecode is then kept in memory
p65147
aVAt import time, Python also caches the bytecode, in a  file next to the original source file, you can verify that a new import has taken place by comparing timestamps on the  and corresponding  files
p65148
aVA graceful restart should suffice; run  as root on your server
p65149
aVIn future, you may want to get yourself a development setup; running the same code (from a VCS, of course), but using the built-in Django development server:
p65150
aVThe Django development server does its best to reload code when you change it
p65151
aVThis is a development feature only (watching files for changes costs performance)
p65152
aVLast but not least, try to avoid altering third-party libraries
p65153
aVUse subclassing or monkeypatching instead, and perhaps the upstream author would be willing to implement new features for you or accept patches
p65154
aVThat way you don't have to maintain those changes yourself across versions either
p65155
as(dp65156
g16
V100297
p65157
stp65158
a((dp65159
g2
(lp65160
VPython containers always use the representation of contained objects
p65161
aVImplement a  method too and that'll be used when printing the list; you can make it an alias for  if you wish:
p65162
aVor explicitly print each element in your list:
p65163
as(dp65164
g16
V100297
p65165
stp65166
a((dp65167
g2
(lp65168
VYou'd use it when you have a pool of jobs to process in no particular order
p65169
aVJobs should only be executed once, but once executed can be added again:
p65170
aVwhere  potentially adds more jobs to the pile
p65171
aVOnce all jobs have been processed, the set will be empty and the loop is done
p65172
aVOr, for a less contrived, real-world example, see the  method from the  library (used by , for example), which uses a  set to track distribution providers that still need processing
p65173
aVThe method is a mirror of the  method, which explicitly mentions set algorithms:
p65174
aVis useful to destructively iterate over a dictionary, as often used in set algorithms
p65175
aVBefore  was added to the language, you'd use a dictionary with  values to emulate  a set
p65176
as(dp65177
g16
V100297
p65178
stp65179
a((dp65180
g2
(lp65181
VWhen you execute a select statement,  is set to the number of results retrieved
p65182
aVAlso, there is no real need to call ; looping over the cursor directly is easier:
p65183
aVNote that I also switched your code to use SQL parameters; there is no need to use string interpolation here, leave that to the database adapter
p65184
aVThe  placeholder is replaced for you by a correctly quoted value taken from the second argument to , a sequence of values (here a tuple of one element)
p65185
aVUsing SQL parameters also lets a good database reuse the query plan for the select statement, and leaving the quoting up to the database adapter prevents SQL injection attacks
p65186
as(dp65187
g16
V100297
p65188
stp65189
a((dp65190
g2
(lp65191
VApply all your substitutions in one go on the current line:
p65192
aVNote that opening a file with  sounds awfully much as if you are treating that file as a sequence of lines; you could just loop over the file:
p65193
as(dp65194
g16
V100297
p65195
stp65196
a((dp65197
g2
(lp65198
VYou are printing a newline every loop iteration right after you printed something without a newline:
p65199
aVMove that print statement out of the loop:
p65200
as(dp65201
g16
V100297
p65202
stp65203
a((dp65204
g2
(lp65205
V returns a string but you are comparing  and  with integers
p65206
aVTurn  into a integer before comparing:
p65207
aVYou can simplify your comparison a little with chaining, letting you inline the  call:
p65208
as(dp65209
g16
V100297
p65210
stp65211
a((dp65212
g2
(lp65213
VYou can't, because at the time your decorator on a method is run, the class is yet to be created
p65214
aVAn example illustrates this a little better:
p65215
aVWhen  is invoked to produce a decorated function, we are inside the pseudo-function  that Python runs to define the class body
p65216
aVOnly when that pseudo-function is done executing, is the local namespace of that function turned into the class body and the actual class object itself is created
p65217
aVThat means that there is no  class object yet at the time  is run
p65218
aVInstead, create a class decorator:
p65219
aVNow  is passed the whole, complete  class giving you access to both the class and the methods
p65220
aVIf you need to mark specific methods on the class for decoration, you could use a marker decorator that sets attributes on the function:
p65221
aVUse this decorator in the class body on methods that you want decorated, then use the class decorator to pick out those methods:
p65222
as(dp65223
g16
V100297
p65224
stp65225
a((dp65226
g2
(lp65227
VYou are testing for object identity:
p65228
aVyou really want to use equality instead:
p65229
aVtests if two object references are pointing to the same object
p65230
aVtests if the values of two objects is equivalent
p65231
aVTwo strings that have the same contents (are equal), are not necessarily one and the same object:
p65232
aVCPython does use some tricks to save memory and improve performance, where small integers and some strings are interned; every time you try to create a new string or integer that is interned, instead of a new object, you get an already cached value
p65233
aVIn those cases  tests return  only because you indeed have the same object, reused for you by the interpreter
p65234
aVNote that the equality test can still be incorrect
p65235
aVThere could be extra whitespace around the values, or other characters that are not immediately obvious when printed to the screen:
p65236
as(dp65237
g16
V100297
p65238
stp65239
a((dp65240
g2
(lp65241
VYes, provided you compiled your Python with wide-unicode support
p65242
aVBy default, Python is built with narrow unicode support only
p65243
aVEnable wide support with:
p65244
aVYou can verify what configuration was used by testing :
p65245
aVA wide build will use UCS4 characters for all unicode values, doubling memory usage for these
p65246
aVPython 3
p65247
aV3 switched to variable width values; only enough bytes are used to represent all characters in the current value
p65248
aVQuick demo showing that a wide build handles your sample Unicode string correctly:
p65249
as(dp65250
g16
V100297
p65251
stp65252
a((dp65253
g2
(lp65254
VYou want the  attribute; access tag attributes using mapping syntax:
p65255
aVDemo:
p65256
as(dp65257
g16
V100297
p65258
stp65259
a((dp65260
g2
(lp65261
VInstead of trying to parse the directory listing output, use the PyPI API
p65262
aVThere are:
p65263
aVa JSON API
p65264
aVa XML-RPC interface
p65265
aVand a HTTP API
p65266
aVwhich give you parsed access to that information
p65267
aVFor example, the JSON link for ipython release 0
p65268
aV10
p65269
aV1 gives you ISO8601 dates:
p65270
aVwhich can be parsed into  objects:
p65271
aVThat said, the date format in your sample listing can be parsed with:
p65272
aVbut the behavior of the  placeholder is dependent on your locale; it'll only work correctly here when that is set to C or english
p65273
aVThe best way to parse arbitrary dates then, is to use the  package (an add-on install), as it's parser is very robust:
p65274
as(dp65275
g16
V100297
p65276
stp65277
a((dp65278
g2
(lp65279
VYou are creating images in , or Luminance mode
p65280
aVThat means they are greyscale images, one band of colour
p65281
aVYou need to use the  mode instead:
p65282
aVThis does require you to use tuples of  values when specifying pixels, not a simple integer
p65283
aVThe  module does support setting colours using strings as well ( and related)
p65284
aVYou don't show us how you define  in your code, so it is hard to state if you are using the correct format for an RGB image
p65285
as(dp65286
g16
V100297
p65287
stp65288
a((dp65289
g2
(lp65290
VYour boolean logic is incorrect; the if statement executes as:
p65291
aVbecause  has a lower precedence than  (see the documented precedence order)
p65292
aVBecause your string is not empty,  is , and the second part of the expression isn't even evaluated anymore
p65293
aVThe test can be simplified and made correct with:
p65294
aVbecause  never is True for empty strings
p65295
aVIn the above expression,  removes all whitespace from the start and the end of the string, leaving an empty string if there was only whitespace in it
p65296
as(dp65297
g16
V100297
p65298
stp65299
a((dp65300
g2
(lp65301
V does not return the result
p65302
aVYou need to explicitly fetch rows
p65303
aVYou only have one row here (a count) so use :
p65304
as(dp65305
g16
V100297
p65306
stp65307
a((dp65308
g2
(lp65309
VHow about:
p65310
aVIf all values in  and  are strings already, then you can remove the  call:
p65311
as(dp65312
g16
V100297
p65313
stp65314
a((dp65315
g2
(lp65316
VBecause  is an integer
p65317
aVTurn it into a string too:
p65318
aVHowever, it'd be much better to use  string formatting:
p65319
aVString formatting converts inputs for you; see the Format String Syntax documentation for more details on what formatting options you have
p65320
as(dp65321
g16
V100297
p65322
stp65323
a((dp65324
g2
(lp65325
VBy accessing the descriptor on  you invoked  already
p65326
aVThe value  is being returned
p65327
aVFor any attribute access, Python will look to the type of the object (so  here) to see if there is a descriptor object there (an object with a  method, for example), and will then invoke that descriptor
p65328
aVThat's how methods work; a function object is found, which has a  method, which is invoked and returns a method object bound to self
p65329
aVIf you wanted to access the descriptor directly, you'd have to bypass this mechanism; access  in the  dictionary of :
p65330
aVThis behaviour is documented right above where you saw the  direct call:
p65331
aVThe default behavior for attribute access is to get, set, or delete the attribute from an object\u2019s dictionary
p65332
aVFor instance,  has a lookup chain starting with , then , and continuing through the base classes of  excluding metaclasses
p65333
aVThe Direct Call scenario in the documentation only applies when you have a direct reference to the descriptor object (not invoked); the  expression is such a reference
p65334
aVYour code on the other hand, is an example of the Instance Binding scenario:
p65335
aVInstance Binding
p65336
aVIf binding to an object instance,  is transformed into the call:
p65337
as(dp65338
g16
V100297
p65339
stp65340
a((dp65341
g2
(lp65342
VA python script can figure out its own path with:
p65343
aVafter which you can open the source file and run it through
p65344
aVA script file has no compiled bytecode file; only modules do
p65345
aVNote that in Python 2, the  path uses the extension of the file that was actually loaded; for modules this is  or  only if there was a cached bytecode file ready to be reused
p65346
aVIt is  if Python had to compile the bytecode, either because no bytecode file was present or because the bytecode file was stale
p65347
aVYou'll have to take into account that your code was invoked with command line switches that alter what bytecode Python loads; if a  or  switch is given, or the  environment flag is set, Python will load or compile to a  file instead
p65348
as(dp65349
g16
V100297
p65350
stp65351
a((dp65352
g2
(lp65353
VIt is not clear what you are looking for, exactly
p65354
aVSyntactically the same code is going to result in the same instructions being executed, certainly
p65355
aVBut even syntactically equivalent python files can generate different  cached bytecode files
p65356
aVAdding or removing newlines will result in different line offsets:
p65357
aVNote the different values in the left-hand column; the interpreter will still behave exactly the same, but the offsets differ
p65358
aVThe bytecode and offsets can be accessed separately leaving what the interpreter executes equal:
p65359
as(dp65360
g16
V100297
p65361
stp65362
a((dp65363
g2
(lp65364
VYou can't remove nodes without knowing the parent, but the  package doesn't give you any way to access a parent from a given node
p65365
aVThe only way around this is matching the parent node instead:
p65366
aVIf you switch to the  library (which implements the same API, but with additional enhancements), you can retrieve the parent node from any given node:
p65367
as(dp65368
g16
V100297
p65369
stp65370
a((dp65371
g2
(lp65372
VIf these values are meant to be attributes on the instance, then set them on :
p65373
aVIf you needed them as globals, then you'd have to mark them as such, with  in the method itself
p65374
aVThe latter part of the code, where you define a connection to the database, is executed when the class is loaded
p65375
aVThat code runs before any scraping has taken place, and  is still defined as an empty string at that point
p65376
aVMove that code to the  method instead
p65377
aVThat's the point the spider is being closed and you actually record the stop time:
p65378
as(dp65379
g16
V100297
p65380
stp65381
a((dp65382
g2
(lp65383
VThere is no way for you to mark a  literal as having using a different encoding from the rest of the source file, no
p65384
aVInstead, you'd manually decode the literal from a bytestring instead:
p65385
aVor using escape sequences:
p65386
aVThe whole point of the source-code codec line is to support using an arbitrary codec in your editor
p65387
aVSource code should never use mixed encodings, really
p65388
as(dp65389
g16
V100297
p65390
stp65391
a((dp65392
g2
(lp65393
VUse  to transpose your output to two separate lists:
p65394
aVTo get just the integer portion of the values in  you'd need to interpret them as floats first then map those back to just the rounded values:
p65395
aVDemo:
p65396
as(dp65397
g16
V100297
p65398
stp65399
a((dp65400
g2
(lp65401
VYour  loop does not do the same thing as your  loop; the  loop starts at 1 and always increments
p65402
aVMove the  before the even test:
p65403
aVbecause  is , so you always continue, skipping the  and  statements
p65404
as(dp65405
g16
V100297
p65406
stp65407
a((dp65408
g2
(lp65409
VIf all your variables are uppercase names, and you didn't import any other such strings from elsewhere, you could use:
p65410
aVThis will concatenate all unicode strings bound to uppercase names in the current module global namespace
p65411
aVI switched to using  here as that's a little less verbose than looping over ; you cannot loop with a list comprehension over  itself as list comprehension variables are injected into the global namespace during the loop, changing the size of the  dictionary during iteration
p65412
as(dp65413
g16
V100297
p65414
stp65415
a((dp65416
g2
(lp65417
VYou can detect that your value is not of type :
p65418
aVOnly in Python 3 is  of type
p65419
aVNote the  method as well, instead of , which would work in both Python 2 and 3
p65420
as(dp65421
g16
V100297
p65422
stp65423
a((dp65424
g2
(lp65425
VThe Python  and  operators evaluate their expressions lazily, allowing you to use expressions like:
p65426
aVsafely
p65427
aVThis disqualifies them for a  treatment, because you'd have to evaluate the expressions before passing them to the function
p65428
aVIn the above examples that means the  expression cannot be expressed using a  function; if  is false-y it is probably not callable either, and if  is true-thy, you don't want to invoke the expensive function call
p65429
aVIt's easy enough to create your own functions if lazy evaluation is not required:
p65430
as(dp65431
g16
V100297
p65432
stp65433
a((dp65434
g2
(lp65435
VThere is; it is called , surprisingly
p65436
aVIt is implemented exactly as you describe, albeit in C
p65437
aVQuoting the docs:
p65438
aVReturn  if all elements of the iterable are true (or if the
p65439
aViterable is empty)
p65440
aVEquivalent to:
p65441
aVNew in version 2
p65442
ag2176
aVThis is not limited to just booleans
p65443
aVNote that this takes an iterable; passing in a generator expression means only enough of the generator expression is going to be evaluated to test the hypothesis:
p65444
aVThere is an equivalent  function as well
p65445
as(dp65446
g16
V100297
p65447
stp65448
a((dp65449
g2
(lp65450
VYou passed a string to ; sure it is a filename, but  does not open filenames for you
p65451
aVIt operates on strings or open file-objects only
p65452
aVOpen the file first;  will read file objects if you pass those in:
p65453
aVSee Making the soup
p65454
as(dp65455
g16
V100297
p65456
stp65457
a((dp65458
g2
(lp65459
VPython strings are sequences; looping over them gives you individual characters
p65460
aVIf any character is a digit (test with ), turn it into an integer using  and  those:
p65461
aVDemo:
p65462
as(dp65463
g16
V100297
p65464
stp65465
a((dp65466
g2
(lp65467
VThis changed in Python 2
p65468
aV6:
p65469
aVDue to an implementation accident, if you passed a file path to the built-in  function, it would actually import the specified file
p65470
aVThis was never intended to work, however, and the implementation now explicitly checks for this case and raises an
p65471
aVYour  list contains filenames instead of module names
p65472
as(dp65473
g16
V100297
p65474
stp65475
a((dp65476
g2
(lp65477
VUse a list comprehension to generate new tuples:
p65478
aVThis comes down to the same as your version, but avoids the repeated  calls and builds the list in one go
p65479
as(dp65480
g16
V100297
p65481
stp65482
a((dp65483
g2
(lp65484
VYou want a sample; use  to pick a list of 3 elements:
p65485
aVDemo:
p65486
aVIf you needed a sublist, then you are stuck with picking a random start index between 0 and the length minus 3:
p65487
aVwhich works like this:
p65488
as(dp65489
g16
V100297
p65490
stp65491
a((dp65492
g2
(lp65493
VReading the list is not that hard:
p65494
aVThis produces dictionaries from your input file
p65495
aVFrom this you can produce CSV output using the  module, specifically the  class:
p65496
aVAny header keys missing from a record will leave that column empty for that record
p65497
aVAny extra headers you missed will raise an exception; either add those to the  tuple, or set the  keyword to the  constructor to
p65498
as(dp65499
g16
V100297
p65500
stp65501
a((dp65502
g2
(lp65503
VIt is basically a namespaced global
p65504
aVYour function  is a global object, and attributes on that object are no less global
p65505
aVIt is only marginally better than a regular global variable; namespaces in general are a good idea, after all
p65506
as(dp65507
g16
V100297
p65508
stp65509
a((dp65510
g2
(lp65511
VSimply multiply the string version:
p65512
aVOutput:
p65513
aVIf you have to use a nested loop, tell the  function to not print a newline in the inner loop by setting the  option to an empty string; an empty  call in the outer loop then suffices to add the necessary newline:
p65514
as(dp65515
g16
V100297
p65516
stp65517
a((dp65518
g2
(lp65519
V writes a newline to stdout after writing the desired text
p65520
aVWrite the line with  instead:
p65521
as(dp65522
g16
V100297
p65523
stp65524
a((dp65525
g2
(lp65526
VYou applied the  decorator in the class definition; it is there that you pass in the  argument:
p65527
aVIf  should be something else, you need to pass that value in there
p65528
aVThe  object is created in the  line, then called
p65529
aVYou could also rewrite the code to read:
p65530
aVas that is what Python does when it handles a decorator
p65531
aVIt is the return value of the  method that replaces , you can no longer specify arguments to the  object at that time
p65532
aVis now the nested  function your decorator returned
p65533
aVIf you wanted to specify  when calling the decorated method, you'd need to alter the  signature to accept an (optional) extra  argument
p65534
aVBecause you already support , your only option is to add a  catch-all argument to support optional keyword arguments:
p65535
aVHere, instead of using  directly, a  keyword argument to the wrapper overrides the  value set on the decorator class:
p65536
aVYou may want to pass on any keyword arguments to the wrapped function as well; in that case, I'd use:
p65537
aVHere, the  keyword argument is removed before passing on the remaining keyword arguments to the wrapped function
p65538
as(dp65539
g16
V100297
p65540
stp65541
a((dp65542
g2
(lp65543
VCheck your message catalog entry
p65544
aVThe  call replaces your unicode value with one from the message catalog (if available), and it is that message that throws this exception
p65545
aVSwapping the  and the preceding space would do this, for example:
p65546
as(dp65547
g16
V100297
p65548
stp65549
a((dp65550
g2
(lp65551
VThe conflicts are indeed caused because two requests are trying to change a  at the same time
p65552
aVOne of these is then forced to retry the commit
p65553
aVUse these entries to pinpoint bottlenecks in your application; perhaps replace the specific mapping with a  which minimizes conflicts by spreading key-value pairs out over separate persistent buckets
p65554
aVWithout traffic data and what that specific  holds or what your application does with it, it is impossible to say if 78 conflicts in 4 days is a lot or a little, and if it is worth your while switching to a different container
p65555
as(dp65556
g16
V100297
p65557
stp65558
a((dp65559
g2
(lp65560
VYou need to loop over just one of the dictionaries, and use mapping access to print the values:
p65561
aVThe above, however, will raise a  if there are keys in  that are not present in the  dictionary
p65562
aVTo ensure that the keys exist in both dictionaries, you can use dictionary views to get a set intersection between the two dictionary key sets:
p65563
aVThis will loop over only those keys that are present in both dictionaries
p65564
as(dp65565
g16
V100297
p65566
stp65567
a((dp65568
g2
(lp65569
VPython comes with batteries included;  will run Python scripts using the CGI standard:
p65570
aVThe  module defines a request-handler class, interface compatible with  and inherits behavior from  but can also run CGI scripts
p65571
aVIt'll run Python scripts as long as they have a  or  extension, and are executable; other paths mapping to files are treated as regular files and have their content served instead
p65572
aVYou may be interested in the  and  modules as well, to help ease CGI script development
p65573
as(dp65574
g16
V100297
p65575
stp65576
a((dp65577
g2
(lp65578
VIt'd be better to decode byte strings to unicode
p65579
aVUnicode data is the canonical representation; encoded bytes differ based on what encoding was used
p65580
aVYou always want to work with Unicode within your program, then encode back to bytes as needed to send over the network or write data to files
p65581
aVCompare this to using date/time values; you'd convert those to  objects as soon as possible too
p65582
aVOr images; loading an image from PNG or JPG you'd want to get a representation that lets you manipulate the colours and individual pixels, something that is much harder when working with the compressed image format on disk
p65583
as(dp65584
g16
V100297
p65585
stp65586
a((dp65587
g2
(lp65588
VIf you have an integer value and you want to test that it is not 100 and not 101, you can use an  membership test with a tuple:
p65589
aVYou should not use identity tests ( and ) with integers
p65590
aVThe fact that identity tests work with small integers (between -5 and 255) is a CPython optimization detail
p65591
aVIdentity is not the same thing as having the same value; two objects can have the same value but are not necessarily the same reference:
p65592
as(dp65593
g16
V100297
p65594
stp65595
a((dp65596
g2
(lp65597
VYou are mixing equality tests with assignment:
p65598
aVNote how both lines use  to test for equality
p65599
aVAssignment, on the other hand, uses one :
p65600
aVYou are doing this throughout your code; if you want to assign, use a single equals symbol
p65601
aVAlso, to loop over your matrix, you can loop directly
p65602
aVYou can include an index when you need to assign to the inner lists:
p65603
aVIf you were to use a mapping, the whole nested loop can be replaced by a list comprehension:
p65604
as(dp65605
g16
V100297
p65606
stp65607
a((dp65608
g2
(lp65609
VOn my Mac OS X 10
p65610
ag1140
aV5 64-bit laptop, a  object requires:
p65611
aVso 350 megabytes of memory
p65612
aVHere,  returns the memory footprint of the given Python objects not counting contained values
p65613
aVSo, for a list, it is just the memory a list structure requires; bookkeeping information plus 11 million 64-bit pointers
p65614
aVIn addition, that many empty dictionaries take:
p65615
aV3 gigabytes of memory
p65616
aV11 million times 280 bytes is a lot space
p65617
aVTogether with other overhead (most likely garbage collection cycle detection, the Python process itself and memoized values), that means you hit your machine's 4GB per-process memory limit
p65618
aVIf you are running a 32-bit binary, sizes will be smaller as you'd only need room for 32-bit pointers, but you also only get 2GB of addressable memory to fit all your objects into
p65619
as(dp65620
g16
V100297
p65621
stp65622
a((dp65623
g2
(lp65624
VThere are two errors in that section of code
p65625
aVFirst, you are missing a closing parenthesis:
p65626
aVWithout that closing parenthesis, Python does not know when that expression is supposed to end
p65627
aVThe next line then doesn't make sense and raises a  exception
p65628
aVYour next line has a stray colon:
p65629
aVwhich you need to remove
p65630
aVYou also do not store the result of that call, you could just omit that line
p65631
aVThe following is correct Python
p65632
as(dp65633
g16
V100297
p65634
stp65635
a((dp65636
g2
(lp65637
VYou are running this on an older Python version that doesn't yet support dict comprehensions
p65638
aVThe  syntax is only available in Python 2
p65639
aV7 and newer:
p65640
aVReplace the line with a dictionary constructor and a generator expression:
p65641
aVYou do want to avoid reading the email message for every key-item pair in  though; read it once per outer loop:
p65642
as(dp65643
g16
V100297
p65644
stp65645
a((dp65646
g2
(lp65647
VYou are comparing a string to an integer:
p65648
aVIn Python 2, a string is always larger than a number
p65649
aVUse numbers instead:
p65650
aVIn Python 3, comparing strings with integers like that raises an error instead:
p65651
aVgiving you a clearer message about what you are doing wrong
p65652
as(dp65653
g16
V100297
p65654
stp65655
a((dp65656
g2
(lp65657
VUpgrade to BeautifulSoup 4, and install the  parser
p65658
aVThis combination handles XML correctly:
p65659
aVInstall both projects with:
p65660
as(dp65661
g16
V100297
p65662
stp65663
a((dp65664
g2
(lp65665
VLeave of the ; that's Vim search-and-replace syntax
p65666
aVVim also uses metacharacters differently, do not escape the  parenthesis of a group, but do escape literal  parenthesis
p65667
aVis a nice shortcut for , and  will do for ,  for , using  where  was used:
p65668
aVI've adjusted the greedyness of the  pattern before the digits groups to prevent these from swallowing too many digits too
p65669
aVDemo:
p65670
as(dp65671
g16
V100297
p65672
stp65673
a((dp65674
g2
(lp65675
VYou are (ab)using conditional expressions, and they must be of the form
p65676
aVThese expressions always produce a value, unlike an  compound statement
p65677
aVNote that you should not test for ; boolean expressions are already true or false without that test
p65678
aVDon't use  either, that operator has been deprecated and has removed from Python 3 altogether
p65679
aVWhen testing for , a singleton, you'd use  however
p65680
aVYou are testing against  results; that looks like you want to use  tests instead
p65681
aVYou are also using  on values, then calling  on the result
p65682
aVThere is no  method, so those calls will fail with an
p65683
aVThe following is closer to working just fine, unless there are more types than , ,  or :
p65684
aVHowever, I'd farm out the conversion to filter function instead:
p65685
aVthen use that in a list comprehension:
p65686
as(dp65687
g16
V100297
p65688
stp65689
a((dp65690
g2
(lp65691
VYou are mixing tabs and spaces (your copied post here certainly does)
p65692
aVRun your code with  and fix any problems that finds
p65693
aVPreferably, replace all tabs with spaces and configure your editor to do so automatically
p65694
as(dp65695
g16
V100297
p65696
stp65697
a((dp65698
g2
(lp65699
VYou need to loop over all values to determine the maximum; keep track of the maximum so far and return that after completing the loop:
p65700
aVHere,  is a number guaranteed to be lower than any other number, making it a great starting point
p65701
aVThe  construct takes care of all the looping; you do that directly over the elements of ,  is assigned each element of the sequence, one by one
p65702
aVYour code forgets to loop, tests the whole list against  and returns the whole list if the test failed
p65703
as(dp65704
g16
V100297
p65705
stp65706
a((dp65707
g2
(lp65708
VNest the generator expressions:
p65709
aVDemo:
p65710
as(dp65711
g16
V100297
p65712
stp65713
a((dp65714
g2
(lp65715
VYou are comparing stings; these are compared lexicographically, not as numbers
p65716
aVsorts before , regardless of what follows, just like  is sorted before , because  comes before , regardless of what other characters follow
p65717
aVCompare numbers instead:
p65718
aVNote: you are using Python 2 (or  would not be available), so  is a statement, not a function
p65719
as(dp65720
g16
V100297
p65721
stp65722
a((dp65723
g2
(lp65724
VThe  is not recognized as a timezone offset
p65725
aVIn fact, you have milliseconds and a timezone ( is UTC), and officially,  parser cannot handle milliseconds
p65726
aVOn some platforms  will parse the microsecond portion, then discard the information
p65727
aVThe  class method, however, can, but not the timezone, however; parse the  as a literal and it works:
p65728
aVDemo:
p65729
aVNote that on my Mac OS X laptop,  works for ; it is not guaranteed to work everywhere, however
p65730
aVConverting a  object to a time tuple can be done with the  method
p65731
as(dp65732
g16
V100297
p65733
stp65734
a((dp65735
g2
(lp65736
VUse a  object instead:
p65737
aVWhenever you try to access a key in a  that does not yet exist, the default factory is called to produce a value for that key, transparently
p65738
aVIn the above code the default factory is , which produces another  with the same factory, letting you build up a nested set of dictionaries merely by accessing the keys
p65739
aVDemo:
p65740
aVA  is a subclass of the standard Python dictionary and apart from materializing values for keys automatically, behaves exactly like a regular dictionary
p65741
as(dp65742
g16
V100297
p65743
stp65744
a((dp65745
g2
(lp65746
V is just a value that commonly is used to signify 'empty', or 'no value here'
p65747
aVIt is a signal object; it only has meaning because the Python documentation says it has that meaning
p65748
aVThere is only one copy of that object in a given Python interpreter session
p65749
aVIf you write a function, and that function doesn't use an explicit  statement,  is returned instead, for example
p65750
aVThat way, programming with functions is much simplified; a function always returns something, even if it is only that one  object
p65751
aVYou can test for it explicitly:
p65752
aVAnother use is to give optional parameters to functions an 'empty' default:
p65753
aVThe function  has a optional argument; if you call  without specifying it, the default value  is given to it, making it easy to detect if the function was called with an argument or not
p65754
aVOther languages have similar concepts
p65755
aVSQL has ; JavaScript has  and , etc
p65756
aVNote that in Python, variables exist by virtue of being used
p65757
aVYou don't need to declare a variable first, so there are no really empty variables in Python
p65758
aVSetting a variable to  is then not the same thing as setting it to a default empty value;  is a value too, albeit one that is often used to signal emptyness
p65759
aVThe book you are reading is misleading on that point
p65760
as(dp65761
g16
V100297
p65762
stp65763
a((dp65764
g2
(lp65765
VYou passed in two items; each a list of parameters
p65766
aVEither use  (which does expect a sequence of sequences), or loop over  to give  one set of bind values:
p65767
as(dp65768
g16
V100297
p65769
stp65770
a((dp65771
g2
(lp65772
VYes, using :
p65773
aVapplies all nested lists in  as separate arguments to the  function, as if you typed ;  takes input sequences and outputs new sequences per column
p65774
aVDemo:
p65775
aVThe output uses nested tuples; if you require nested lists, transform them after the fact with:
p65776
aVor
p65777
as(dp65778
g16
V100297
p65779
stp65780
a((dp65781
g2
(lp65782
VThere are many uses
p65783
aVJust in the standard library we have:
p65784
aV; using the connection as a context manager translates to committing or aborting the transaction
p65785
aV; using  as a context manager lets you assert an exception is raised, then test aspects of the exception
p65786
aV;  manages decimal number precision, rounding, and other aspects
p65787
aVobjects such as locks, semaphores and conditions are context managers too; letting you obtain a lock for a set of statements, etc
p65788
aVthe  module gives you a context manager to temporarily catch warnings
p65789
aVmany libraries offer closing behaviour, just like the default file object
p65790
aVThese include the  and the  modules
p65791
aVPython's own  module uses several context managers, to check for specific warnings, capture , ignore specific exceptions and temporarily set environment variables
p65792
aVAny time you want to detect when a block of code starts and / or ends, you want to use a context manager
p65793
aVWhere before you'd use  with a  suite to guarantee a cleanup, use a context manager instead
p65794
as(dp65795
g16
V100297
p65796
stp65797
a((dp65798
g2
(lp65799
VYou are calling  recursively, but with the exact same arguments
p65800
aVThis can only lead to problems
p65801
aVYour recursive call is removing entries from the same list, and when it returns, those entries will still be gone
p65802
aVBut because you loop over a copy of the list, your outer call won't be updated and try to remove comments the inner recursive call removed already
p65803
aVPerhaps you wanted to call  for a different set of comments when recursing
p65804
aVI suspect you meant to call it for  instead
p65805
aVAnother problem your code has is that you ignore the return value of the recursive call:
p65806
aVThis adds the list  and the return value of the recursive call, creating a new list, which you then drop to the floor by not assigning it to a variable
p65807
aVYou probably want to use:
p65808
aVinstead
p65809
as(dp65810
g16
V100297
p65811
stp65812
a((dp65813
g2
(lp65814
VYou need to set your locale correctly for Apache; without a correct locale, Python falls back to using  for filenames
p65815
aVSet the  environment variable to  to the Apache  file
p65816
aVOn Debian and Ubuntu systems, you find that in , on RedHat, in
p65817
aVAdd the line:
p65818
aVIf you have trouble locating the  file, see this question on ServerFault for some more hints about how to find that file
p65819
as(dp65820
g16
V100297
p65821
stp65822
a((dp65823
g2
(lp65824
VUse the  call; it works just like  but doesn't follow symlinks:
p65825
as(dp65826
g16
V100297
p65827
stp65828
a((dp65829
g2
(lp65830
V in Python 2 already applies
p65831
aVPython 3  is Python 2's , renamed
p65832
aVIn Python 2,  is the same thing as :
p65833
aVHowever, the better alternative is to use  instead; it only allows Python literals, while  allows arbitrary Python expressions
p65834
aVFor taking a list input with numbers,  is plenty and not open to security issues:
p65835
aVNote that you still need to pass in valid Python literals; use , not ; just  without quotes is not a valid Python string literal
p65836
as(dp65837
g16
V100297
p65838
stp65839
a((dp65840
g2
(lp65841
V only works for new-style classes; add  to the base classes for :
p65842
aVYou may want to adjust your  call as well
p65843
aVYou need to give the current class, not the  class to start searching from, and  and  are still set to  by the time your  is called, but you seem to want to pass on the  and  arguments:
p65844
aVWith these changes, the code works:
p65845
as(dp65846
g16
V100297
p65847
stp65848
a((dp65849
g2
(lp65850
VThere is no one way to determine the repo of a package listed on PyPI
p65851
aVIt is up to the author to document this for you
p65852
aVWhen you use , you instruct  to load the PyPI-registered project , located at , which should be your first port of call if you are looking for repository information
p65853
aVThe  PyPI page documents a homepage: https://github
p65854
aVcom/simplegeo/python-oauth2
p65855
aVThis is the link provided in the  metadata for this project, and that's as far as you get with examining this
p65856
aVIf the author put in the wrong link, then there is little you can do to verify this
p65857
aVTo me, there is no doubt that  is the source code you'd install when you run
p65858
as(dp65859
g16
V100297
p65860
stp65861
a((dp65862
g2
(lp65863
VDo not use  here; it introduces the quotes because you are asking for the Python literal form of the strings
p65864
aVThe  is entirely redundant too as that is the default
p65865
aVGrouping the format strings in parenthesis would do what you want:
p65866
aVor justifying before interpolating:
p65867
aVYou perhaps would do better studying  and use that to format and justify your text:
p65868
aVHere the  and  right-justify the value in a field 24 and 18 characters wide (the latter is 17 + the extra space  adds when printing multiple arguments):
p65869
as(dp65870
g16
V100297
p65871
stp65872
a((dp65873
g2
(lp65874
V is a  command to print values (short for ), and Python expects an argument to that command
p65875
aVIt is not interpreted as the name
p65876
aVUse either:
p65877
aVto tell  to print the object , or escape the reference:
p65878
as(dp65879
g16
V100297
p65880
stp65881
a((dp65882
g2
(lp65883
VYou need to join  into a comma-separated string:
p65884
aVYou are instead interpolating the list representation, which is not what you want here (note that a list representation includes quoted string values as well)
p65885
as(dp65886
g16
V100297
p65887
stp65888
a((dp65889
g2
(lp65890
VThe caveats in the comments on that answer only apply for the reverse operation
p65891
aVFor all unsigned 16-bit integers  and , packing to bytes then unpacking as float will work without problems
p65892
aVIf you have the time, you can verify this yourself for all 4294+ million combinations with:
p65893
aVOr, just take my word for it
p65894
as(dp65895
g16
V100297
p65896
stp65897
a((dp65898
g2
(lp65899
VYou are testing every element of each list against every element of the other list, finding all combinations that are
p65900
aVApart from inefficient, this is also the incorrect approach
p65901
aVUse membership testing instead, and see all these tests are  with the  function:
p65902
aVreturns  if each element of the iterable you give it is ,  otherwise
p65903
aVThis won't quite test if the lists are equivalent; you need to test for the length as well:
p65904
aVTo make this a little more efficient for longer  lists; create a  from that list first:
p65905
aVThis still doesn't deal with duplicate numbers very well;  is equivalent to  with this approach
p65906
aVYou underspecified what should happen in such cornercases; the only strict equivalent test would be to sort both inputs:
p65907
aVwhere we first test for length to avoid having to sort in case the lengths differ
p65908
aVIf duplicates are allowed, whatever the length of the input, you can forgo loops altogether and just use sets:
p65909
aVto test if they have the same unique elements
p65910
as(dp65911
g16
V100297
p65912
stp65913
a((dp65914
g2
(lp65915
V was an alias for , which has been removed in Python 3
p65916
aVYou can use  instead, but  has a better option: the [ factory type]:
p65917
as(dp65918
g16
V100297
p65919
stp65920
a((dp65921
g2
(lp65922
V is the reference itself, it is not a relationship manager
p65923
aVJust assign:
p65924
aVNote that this assumes there is only one  per user
p65925
as(dp65926
g16
V100297
p65927
stp65928
a((dp65929
g2
(lp65930
VBy default, the  module logs to
p65931
aVCapture stream 2,  instead:
p65932
aVYou can also redirect both  and  to the same file:
p65933
aVHere  is sent to the same output  (output 1) is directed to
p65934
aVThis is assuming you already set the logging level to allow for level  messages
p65935
aVLast but not least, you can tell  to log to a different stream instead of :
p65936
aVor you can give it a filename, that way no redirection is needed:
p65937
as(dp65938
g16
V100297
p65939
stp65940
a((dp65941
g2
(lp65942
VYes, or you just use a regular loop:
p65943
aVA list or set or dictionary comprehension should be used to create one object; avoid trying to create side effects too
p65944
aVAnd don't discount the utility of a regular loop
p65945
aVAlso, don't hesitate to use a function instead of a lambda:
p65946
as(dp65947
g16
V100297
p65948
stp65949
a((dp65950
g2
(lp65951
VUse  to repeat some information
p65952
aVYou can use  to pair your repeating column with whatever produces values for your first column too:
p65953
aVNow each  is an element from , paired with either ,  or , cycling on until  is exhausted
p65954
as(dp65955
g16
V100297
p65956
stp65957
a((dp65958
g2
(lp65959
VUse  to test the sublists:
p65960
aVThis tests each  but exits the generator expression loop early if a match is found
p65961
aVThis does not, however, return the specific sublist that matched
p65962
aVYou could use  with a generator expression to find the first match:
p65963
aVwhere  is a default returned if the generator expression raises a  exception, or you can omit the default and use exception handling instead:
p65964
as(dp65965
g16
V100297
p65966
stp65967
a((dp65968
g2
(lp65969
VYour first statement logic is incorrect
p65970
aVUnless  is 1 or smaller, that statement is always True; 200 is greater than 1 as well
p65971
aVUse  instead, and include  in the acceptable values:
p65972
aVYou could use chaining as well:
p65973
aVFor numbers of 20 or larger, use  to get both the number of tens and the remainder:
p65974
aVDemo:
p65975
aVthen use those values to build your number from the parts:
p65976
aVAll put together:
p65977
as(dp65978
g16
V100297
p65979
stp65980
a((dp65981
g2
(lp65982
VYour loop  iterates over the values of , not the indices
p65983
aVIf you need indices, use the  function to add these; you get both the index and the value in your loop:
p65984
aVYou do not need to test for the end of the loop here either, nor turn the result into a float; it is already a float
p65985
as(dp65986
g16
V100297
p65987
stp65988
a((dp65989
g2
(lp65990
VJust create an argument group:
p65991
as(dp65992
g16
V100297
p65993
stp65994
a((dp65995
g2
(lp65996
VPython methods can return only one result at a time
p65997
aVThat one result can be a list of lists; just return a larger list, and loop over the result:
p65998
aVand:
p65999
aVA more advanced technique would be to turn your method into a generator function, and yield the rows, one by one
p66000
aVYou'd still loop over the method
p66001
aVTo make the function a generator, use a  expression; you can no longer use   with a value once you make it a generator:
p66002
aVYou still have to loop over the output:
p66003
aVonly now  returns a generator object instead of a list, and you can loop over that object only once
p66004
as(dp66005
g16
V100297
p66006
stp66007
a((dp66008
g2
(lp66009
VA Python module is an object
p66010
aVworks just fine on that
p66011
aVDemo:
p66012
aVIf you have a string with the module name, then you can look up the module object in the  mapping:
p66013
as(dp66014
g16
V100297
p66015
stp66016
a((dp66017
g2
(lp66018
VNo, there is not
p66019
aVNote that the datetime module implements the Gregorian calendar (first introduced 1582) which does not have a year 0
p66020
aVIt does not take into account calendar rearrangements throughout history either, so you cannot track dates accurately over centuries time anyway
p66021
as(dp66022
g16
V100297
p66023
stp66024
a((dp66025
g2
(lp66026
VWhy do you need to limit what is listed for a module
p66027
aVis a debugging tool, mostly
p66028
aVMagic methods are normally looked up on the type of the object, so for instances,  looks for
p66029
aVYour function is not on the  type, but on the module instance instead
p66030
aVYou cannot extend the  type, however, so you cannot give modules a custom  method
p66031
aVIf you wanted to limit what  imports, then use  instead; it is expected to be a list, not a function
p66032
aVSee the  statement documentation for details
p66033
as(dp66034
g16
V100297
p66035
stp66036
a((dp66037
g2
(lp66038
VOn Python 2, the  function creates a full list of integers:
p66039
aVOn a 64-bit machine just the 70368735789056 integers needed for that list would require almost 1
p66040
aV5 petabytes of memory, not even counting the list object with that many 64-bit pointers
p66041
aVIt is no wonder you ran out of memory
p66042
aVNormally, you'd use the  function instead to produce a sparse range iterable, but that object cannot handle long numbers
p66043
aVA  loop would suffice here:
p66044
as(dp66045
g16
V100297
p66046
stp66047
a((dp66048
g2
(lp66049
V gives you the memory footprint of just the object, and not of any other values referenced by that object
p66050
aVYou'd need to recurse over the object to find the total size of all attributes too, and anything those attributes hold, etc
p66051
aVPickling is a serialization format
p66052
aVSerialization needs to store metadata as well as the contents of the object
p66053
aVMemory size and pickle size only have a rough correlation
p66054
aVPickles are byte streams, if you need to have a more compact bytestream, use compression
p66055
aVIf you are storing your pickles in a ZIP file, your data will already be compressed; compressing the pickle before storing it in the ZIP will not help in that case as already compressed data runs the risk to become bigger after additional ZIP compression instead due to metadata overhead and lack of duplicate data in typical compressed data
p66056
as(dp66057
g16
V100297
p66058
stp66059
a((dp66060
g2
(lp66061
VSee the  function; object types implement a  hook function
p66062
aVNo, you cannot make it accept s, but subclasses of  could be made to work
p66063
aVDo take into account that not keeping the hash and equality tests stable for keys will break your dictionary
p66064
aVYou'd be better off storing s as keys, however
p66065
aVTurning a list into a tuple is trivial enough:
p66066
as(dp66067
g16
V100297
p66068
stp66069
a((dp66070
g2
(lp66071
VYour absolute path still contains a filename, so remove that with  to obtain just the directory
p66072
aVThen join the two and apply  to the result:
p66073
aVnormalizes a path with relative references in it;  becomes , for example
p66074
aVDemo:
p66075
as(dp66076
g16
V100297
p66077
stp66078
a((dp66079
g2
(lp66080
VThe  equality and  membership operators are both comparison operators, and these can be chained
p66081
aVChaining takes the form of , which is interpreted as  but the middle  is only evaluated once
p66082
aVSo, your examples are really:
p66083
aVand  is never equal to a boolean value
p66084
aVNote that you should really never compare to  or
p66085
aVLeave that to  or  to test for you
p66086
as(dp66087
g16
V100297
p66088
stp66089
a((dp66090
g2
(lp66091
VPython is also echoing the return value of  call, which is the number of bytes written:
p66092
aVHere the next prompt follows the  written without a newline
p66093
aVOr, as a different way of demoing, writting 0 bytes in a loop prints  that many times:
p66094
as(dp66095
g16
V100297
p66096
stp66097
a((dp66098
g2
(lp66099
VYou cannot influence that, not with the Python  module
p66100
aVWhat is downloaded and what is displayed in the browser is a preference set in the browser itself
p66101
aVYou could try and set those preferences using Selenium, see Set chrome
p66102
aVprefs with python binding for selenium in chromedriver
p66103
aVThis is not going to be simple; you'll need to figure out the exact preference strings to alter
p66104
aVPerhaps the Chromium prefences list can be used as a guide there
p66105
as(dp66106
g16
V100297
p66107
stp66108
a((dp66109
g2
(lp66110
VNo, the project has not been deprecated
p66111
aVLike many open source software projects there is a natural cycle in interest and activity, with the only difference being the speed in which the cycle progresses
p66112
aVDeprecation is an explicit choice by the maintainers; no such choice has been made
p66113
aVIt's just that most interest in the project has moved on elsewhere
p66114
as(dp66115
g16
V100297
p66116
stp66117
a((dp66118
g2
(lp66119
V returns  when an object was not found
p66120
aVEvidently some pages do not have the elements that you are looking for
p66121
aVTest for it explicitly if you want to prevent attribute errors:
p66122
as(dp66123
g16
V100297
p66124
stp66125
a((dp66126
g2
(lp66127
VYou have a  class with no
p66128
aVYou created it from an empty line in your file:
p66129
aVAn empty line results in an empty list:
p66130
aVwhich leads to  being called, so a  instance was created with no arguments, leaving the default
p66131
aVSkip empty lines:
p66132
aVYou may also want to default to empty strings, or specifically test for  values before treating attributes as strings:
p66133
aVHere  returns  for empty or  values, giving you a quick  return value when there is no first name to match against:
p66134
as(dp66135
g16
V100297
p66136
stp66137
a((dp66138
g2
(lp66139
VYou need to store the results of  if you want to display it; the count is not added to the list:
p66140
aVor
p66141
aVYou cannot call  on a list, it is a method of strings instead
p66142
aVGiven a string to join with, pass in a list
p66143
aVAgain, the return value needs to be captured:
p66144
as(dp66145
g16
V100297
p66146
stp66147
a((dp66148
g2
(lp66149
V takes a filename (or a file object instead of a string), not the XML to parse
p66150
aVUse  instead:
p66151
aVNote that unless you are already familiar with the XML DOM standard, you probably do not want to use the  package; as the documentation states:
p66152
aVUsers who are not already proficient with the DOM should consider using the  module for their XML processing instead
p66153
aVThe DOM is, due to its cross-language nature, very verbose and does not make use of Python's strengths
p66154
aVUse the ElementTree API instead if you can; either with the standard library  module, or with the (faster and more comprehensive) external  library
p66155
as(dp66156
g16
V100297
p66157
stp66158
a((dp66159
g2
(lp66160
VThere must be at least one value for  that doesn't contain any of the characters to split on
p66161
aVTo debug, catch the  and print  and / or  to see what is going on:
p66162
aVIf this is the header, skip it with :
p66163
aVNote that in theory, it could also still be the previous line that is throwing this exception; you didn't share the traceback in your post
p66164
aVA blank line or a line with fewer columns would lead to an  for
p66165
aVA blank line gives an empty list, for example
p66166
as(dp66167
g16
V100297
p66168
stp66169
a((dp66170
g2
(lp66171
VYou are looping over bytes, which gives you integers
p66172
aVConvert back to bytes to write to a binary file:
p66173
aVThe modulo 256 is required here to limit the resulting int value to a permissible value
p66174
aVYou could also cap the value at 255 with :
p66175
aVor you could write two bytes if your doubling results in an overflow:
p66176
aVor always produce 2 bytes regardless, where the first byte is either  or :
p66177
aVYou'll need to decide what you want your 'doubling' to mean in terms of output
p66178
as(dp66179
g16
V100297
p66180
stp66181
a((dp66182
g2
(lp66183
VNo, because you are not evaluating user input as Python expressions; request parameters are always Python objects (strings in this case)
p66184
aVOnly if you were to interpret request parameters as some form of code (pickles, SQL, python expressions with  or ) or allow another program to interpret the parameters (HTML in a browser, values interpolated into JavaScript, etc
p66185
aVdo you need to worry about escaping
p66186
as(dp66187
g16
V100297
p66188
stp66189
a((dp66190
g2
(lp66191
VThe mental model you have is thus only useful to positive stride values, but it doesn't help when using negative strides
p66192
aVUse the following picture instead:
p66193
aVwhere you label the indices, not the boundaries
p66194
aVThe boundary model is nice, but only for making it easier to forget about the fact that the end index is not included in the resulting value
p66195
aVBy just numbering the indices instead and omitting the end index, you can see how both positive and negative strides work
p66196
aVFor the nitty gritty details, take a look at the official documentation for the way Python calculates slices; from the sequence type notes (note 5):
p66197
aVThe slice of  from  to  with step  is defined as the sequence of items with index  such that
p66198
aVIn other words, the indices are , , ,  and so on, stopping when  is reached (but never including )
p66199
aVIf  or  is greater than , use
p66200
aVIf  or  are omitted or , they become \u201cend\u201d values (which end depends on the sign of )
p66201
aVNote,  cannot be zero
p66202
aVIf  is , it is treated like
p66203
aVSo, for your negative stride, the values become:
p66204
aVwhere  is the 'end', here -1 as that is the point where you ran out of string in a negative step
p66205
aVThen the indices become:
p66206
aVgiving you 3 indices
p66207
as(dp66208
g16
V100297
p66209
stp66210
a((dp66211
g2
(lp66212
VGrouping the tuples on the first element; use  (with  for ease of creating a key
p66213
aVThen filter each group separately:
p66214
aVDemo:
p66215
as(dp66216
g16
V100297
p66217
stp66218
a((dp66219
g2
(lp66220
VYou are looking for a thousands-separator
p66221
aVFormat your number with the  function to using commas as the thousands separator, then replace the commas with dots:
p66222
aVHere the  format signals that the decimal number should be formatted with a thousands-separator (see the Format Specification Mini-language)
p66223
aVThe same can be achieved in a wider string format with the  method, where placeholders in the template are replaced with values:
p66224
aVbut then you run the risk of accidentally replacing other full stops in the output string too
p66225
aVYour other option would be to use the locale-dependent  format, but that requires your machine to be configured for a locale that sets the right  options
p66226
as(dp66227
g16
V100297
p66228
stp66229
a((dp66230
g2
(lp66231
VUse a list comprehension selecting the key you need, passing the values to the  function:
p66232
aVDemo:
p66233
aVHere, a list comprehension is faster than a generator expression:
p66234
aVrequires a list to sort, so either you give it a list or it'll build a list from the iterable
p66235
aVBuilding a list from a generator expression is (a lot) less efficient than giving it a list in the first place
p66236
as(dp66237
g16
V100297
p66238
stp66239
a((dp66240
g2
(lp66241
VLeave creating parameters to the  framework instead:
p66242
as(dp66243
g16
V100297
p66244
stp66245
a((dp66246
g2
(lp66247
VIt is both; importing a Python module is a process that loads Python code from a file, compiles it (or loads cached bytecode), then executes the bytecode to form a module object with attributes
p66248
aVLoading from a file is input
p66249
aVAnd it is neither; a process can also refer to a distinct program managed by the OS, each with its own Process ID, and input could refer to the interaction with the program after the modules have been imported, strictly limited to keyboard and mouse input
p66250
aVYou need to be clear what your terminology means; define "input" and "process" more clearly and you can figure out the answer from that
p66251
as(dp66252
g16
V100297
p66253
stp66254
a((dp66255
g2
(lp66256
VYou need to use the  parameter to post data:
p66257
aVThe  keyword is for  parameters only
p66258
aVYou must use a publicly reachable callback URL;  is not a URL Instagram can reach
p66259
as(dp66260
g16
V100297
p66261
stp66262
a((dp66263
g2
(lp66264
VYou'd need to either omit the start and end, or reverse the start and end:
p66265
aVThe end point is not included, so slicing with  only returns three elements
p66266
aVThe last example uses a negative value to be subtracted from the length of the tuple to end up with endpoint
p66267
aVUsing a negative stride means Python wants to count backwards, and starting at 0 you'll never get to 4
p66268
aVNote that the Python slice syntax applies to more than just tuples; strings and lists support the exact same syntax
p66269
as(dp66270
g16
V100297
p66271
stp66272
a((dp66273
g2
(lp66274
VYou are using assignment (one ) instead of equality testing (double ):
p66275
aVand
p66276
aVDouble the  to :
p66277
aVand
p66278
aVYou are also missing a closing parenthesis:
p66279
aVAdd the missing  at the end
p66280
as(dp66281
g16
V100297
p66282
stp66283
a((dp66284
g2
(lp66285
VYou put  in the body of the class, making it a method
p66286
aVYou'll either need to move it out of the class body, or make it a proper method by giving it a  parameter, and then calling it on the instance with:
p66287
aVSince your  function has little to do with the rest of the class, you can move it out:
p66288
as(dp66289
g16
V100297
p66290
stp66291
a((dp66292
g2
(lp66293
VYour outer list  has  entries, each a nested list with  entries, each containing lists of  entries
p66294
aVReverse your indices:
p66295
aVor invert the way you are creating your  list:
p66296
aVor more compact still using list comprehensions:
p66297
as(dp66298
g16
V100297
p66299
stp66300
a((dp66301
g2
(lp66302
VGet rid of those tests; they are next to useless:
p66303
aVThis tests if the Python implementation of  is working
p66304
aVPython itself already tests for this; focus on the project codebase instead
p66305
aVIf Python fails to render a dictionary representation correctly it's not your project's job to fix that
p66306
aVPython dictionaries have no fixed ordering; testing if their representation matches a given string is not going to be stable
p66307
aVMoreover, Python 3
p66308
aV3 introduces hash randomization, meaning that the order of a given dictionary will change from invocation to invocation
p66309
aVSee
p66310
aVIf you are testing the result of a project API calll, test for dictionary equality using  instead; it'll use  to give you meaningful error messages if the two dictionaries do not match
p66311
aVSince Python 3
p66312
aV3 interprets  as a literal for type , comparing output against  will work across Python 2
p66313
aV6, 2
p66314
aV7 and 3
p66315
aV3 and newer
p66316
as(dp66317
g16
V100297
p66318
stp66319
a((dp66320
g2
(lp66321
VThe numbers before the bytecodes are offsets into the original binary bytecodes:
p66322
aVSome bytecodes come with additional information (arguments) that influence how each bytecode works, the offset tells you at what position in the bytestream the bytecode was found
p66323
aVThe  bytecode (ASCII , hex 64) is followed by two additional bytes encoding a reference to a constant associated with the bytecode, for example
p66324
aVAs a result, the  opcode (ASCII , hex 7D) is found at index 3
p66325
aVThe  module documentation lists what each instruction means
p66326
aVFor , it says:
p66327
aVPushes  onto the stack
p66328
aVwhich refers to the  structure that is always present with a code object; the compiler constructs that:
p66329
aVThe opcode loads index 1 from that structure (the 01 00 bytes in the bytecode encode a 1), and  has looked that up for you; it is the value
p66330
aVThe next instruction,  is described as:
p66331
aVStores TOS into the local
p66332
aVHere TOS refers to Top Of Stack; note that the  just pushed something onto the stack, the  value
p66333
aVis another structure; it references local variable names, the opcode references index 0:
p66334
aVlooked that up too, and the name you used in your code is
p66335
aVThus, this opcode stored  into
p66336
aVAnother  loads  onto the stack from index 0, followed by :
p66337
aVReturns with TOS to the caller of the function
p66338
aVso this instruction takes the top of the stack (with the  constant) and returns from this code block
p66339
aVis the default return value for functions without an explicit  statement
p66340
aVYou omitted something from the  output, the line numbers:
p66341
aVNote the  on the first line; that's the line number in the original source that contains the Python code that was used for these instructions
p66342
aVPython code objects have  and  attributes that let you map bytecodes back to line numbers in the original source
p66343
aVdoes this for you when displaying a disassembly
p66344
as(dp66345
g16
V100297
p66346
stp66347
a((dp66348
g2
(lp66349
VAdd a keyword argument:
p66350
aVHere  defaults to  if not explicitly given:
p66351
aVNote that the function signature is created once; defaults are stored on the function object
p66352
aVA common mistake is to assume that defaults are evaluated each time you call a function, and that can lead to some surprises:
p66353
aVHere  will be fixed to the moment  was imported and Python created the function object:
p66354
aVIt gets more surprising still when the default value is mutable:
p66355
aVRepeatedly calling  will result in the  list growing, adding a new value  to the list each time you call it:
p66356
aVSee "Least Astonishment" in Python: The Mutable Default Argument for a longer discussion about this
p66357
as(dp66358
g16
V100297
p66359
stp66360
a((dp66361
g2
(lp66362
VUse  to generate indices for you in the loop:
p66363
as(dp66364
g16
V100297
p66365
stp66366
a((dp66367
g2
(lp66368
VWrap your initial node in list or tuple:
p66369
aVto not have it interpreted as a sequence of values
p66370
aVThe  constructor interprets the argument as an iterable and will take all values in that iterable to add to the set; from the documentation:
p66371
aVclass :
p66372
aVReturn a new set or frozenset object whose elements are taken from
p66373
aVDemo:
p66374
aVAlternatively, create an empty set and use  exclusively:
p66375
as(dp66376
g16
V100297
p66377
stp66378
a((dp66379
g2
(lp66380
VUse the  method on the query to have the Google datastore sort your records for you:
p66381
aVNote that the  object itself gives you access to the query too:
p66382
aVYou can turn the query into a list simply by calling  on it:
p66383
as(dp66384
g16
V100297
p66385
stp66386
a((dp66387
g2
(lp66388
VA list comprehension gives you all matching records:
p66389
aVDemo:
p66390
aVThat's 4 matching records, with ids 2, 24, 2 and 24 (it appears you doubled your example)
p66391
aVIf you need unique entries, then you need to track what you already have seen; a  can do that for you:
p66392
aVThis checks for the right employee id, checks the record id wasn't seen before, and adds unseen ids to the set
p66393
aVNow only two entries are found:
p66394
aVNote that this iterates through the whole dataset each time you search
p66395
aVYou may be better off creating a permanent dictionary instead:
p66396
aVThis builds a dictionary mapping employee ids to a list of unique records
p66397
aVNow querying this is a one-step cheap lookup:
p66398
aVDemo:
p66399
as(dp66400
g16
V100297
p66401
stp66402
a((dp66403
g2
(lp66404
VNo, there are no additional methods to test if an index exists
p66405
aVDictionary keys are not easily predicted; you have to have a membership test to determine if a key exists efficiently, as scanning through all keys would be inefficient
p66406
aVLists do not suffer from that problem;  is cheap (the length is cached on the list object), so  is the way to test if an index exists, with exception handling a great fallback if you expect the index to be within the list boundaries most of the time
p66407
as(dp66408
g16
V100297
p66409
stp66410
a((dp66411
g2
(lp66412
VAll your code does, apart from negate the value, is call the parent class , which is exactly what would happen without your  method
p66413
aVSo the short answer is: Sure you can define a
p66414
aVWhat you cannot do is redefine  to use , because instances of a class with slots do not have a  attribute
p66415
aVBut such instances do have a  attribute, it's contents are just not stored in a dictionary on the instance
p66416
aVInstead, slot values are stored in the same location a  instance dictionary would otherwise be stored; on the object heap
p66417
aVSpace is reserved for  references, and descriptors on the class access these references on your behalf
p66418
aVSo, in a  hook, you can just call those descriptors directly instead:
p66419
aVInteresting detour: yes, on classes without a  attribute, there is a descriptor that would give you access to the  object of instances:
p66420
aVwhich is how normal instances can look up
p66421
aVWhich makes you wonder where the  object is found
p66422
aVIn Python, it is turtles all the way down, you'd look that object up on the  object of course:
p66423
as(dp66424
g16
V100297
p66425
stp66426
a((dp66427
g2
(lp66428
VYou passed in just one argument (the whole tuple ), so only  exists; if you meant the tuple values to be separate arguments, apply them with the  call syntax:
p66429
aVThe alternative is to not use the  catchall argument in your function definition:
p66430
aVNow your function has two normal positional arguments,  and
p66431
aVYou can only pass in one argument, and if that is your tuple,  and  will work as expected
p66432
as(dp66433
g16
V100297
p66434
stp66435
a((dp66436
g2
(lp66437
VIf we assume that the format gives only hours and minutes, you can use  to parse these out, and return a  object from the result:
p66438
as(dp66439
g16
V100297
p66440
stp66441
a((dp66442
g2
(lp66443
VYour loop doesn't do much looping
p66444
aVYou return after testing only the first entry
p66445
aVMove the second  out of the loop:
p66446
aVNow you loop until you find a matching network, and only if you tested all entries, and no match was found do you return with
p66447
as(dp66448
g16
V100297
p66449
stp66450
a((dp66451
g2
(lp66452
VConcatenate the sequences:
p66453
aVI built a list here as it is easier to concatenate lists and lists than it is to concatenate tuples and lists (you'd have to convert  to a tuple first)
p66454
aVNote that I used  instead of ;  is translated to a SQL  by Python database adapters
p66455
as(dp66456
g16
V100297
p66457
stp66458
a((dp66459
g2
(lp66460
VYour  method doesn't return anything:
p66461
aVThe default is to return  in that case
p66462
aVSince you pass the result of  to your template, you end up with
p66463
aVIf you need to set  on the  instance only after calling a method on it, then do so in that method:
p66464
aVwhere, for a  field, you need to bind the field to the form before you can use it
p66465
aVNormally, the framework takes care of this for you
p66466
aVThen call that method separately:
p66467
as(dp66468
g16
V100297
p66469
stp66470
a((dp66471
g2
(lp66472
VYou need to call the  function, and pass in the current class () and :
p66473
aVMore importantly, you need to base  on  to make it a new-style class;  does not work with old-style classes:
p66474
aVWith these changes the call works:
p66475
aVIn Python 3, old-style classes have been removed; everything is new-style, and you can omit the class and  parameters from
p66476
aVIn old-style classes, the only way to call the original method is by referring directly to the unbound method on the parent class and manually pass in :
p66477
as(dp66478
g16
V100297
p66479
stp66480
a((dp66481
g2
(lp66482
V uses a separate thread to save command history
p66483
aVBecause  patches threading methods, that pre-existing separate thread triggers the gevent 'single thread' exception
p66484
aVI would not use gevent in ;  is not compatible with gevent
p66485
aVAt the very least, try to patch out fewer things; try  and see if fewer things in  break
p66486
as(dp66487
g16
V100297
p66488
stp66489
a((dp66490
g2
(lp66491
VYou need to pass actual module objects to
p66492
aVIf you only have the module name, look up the module object in the  mapping:
p66493
aVThis only works on modules that have already been imported; if some of your entries are not imported yet, at the very least catch the  skip these:
p66494
aVOptionally, you could use  to load such modules instead
p66495
as(dp66496
g16
V100297
p66497
stp66498
a((dp66499
g2
(lp66500
VBeautifulSoup uses the regular expression to search for matching elements
p66501
aVThat whole text node matches your search
p66502
aVYou still then have to extract the part you want; BeautifulSoup does not do this for you
p66503
aVYou could just reuse your regex here:
p66504
as(dp66505
g16
V100297
p66506
stp66507
a((dp66508
g2
(lp66509
VTake a look at the Python debugger; instead of  you'd use:
p66510
aVand the debugger stops execution and lets you investigate the state of your program
p66511
as(dp66512
g16
V100297
p66513
stp66514
a((dp66515
g2
(lp66516
V in your first example is a global function
p66517
aVThe fact that you call it recursively, does not change that you still first need to look up the function object to be able to call it
p66518
aVIn other words, the current function being called is not in any way special
p66519
aVis still a name that needs to be dereferenced, and it doesn't matter that that name happens to reference to the function being executed
p66520
aVThus, in your second example, where  is instead a method, there is no global reference to that method
p66521
aVInstead, you find it like any other method on the class, through the  reference
p66522
aVWhen you define a function, Python stores a reference to that new function object in the name you gave it, in the current scope
p66523
aVIn a global scope that means that  becomes a global name  bound to a function object
p66524
aVYou can break recursion by removing that name:
p66525
aVNote the  here; I deleted  from the global namespace, but still have a reference in , which I can call
p66526
aVBut the function itself, when executed, cannot find the global name
p66527
aVPython functions otherwise, have no reference to themselves
p66528
aVFrom inside the function, you cannot retrieve the function object itself, not reliably
p66529
aVThe best you can do is get the original function name:
p66530
aVbut that does not give you a guarantee that you can still access that function object through that name
p66531
as(dp66532
g16
V100297
p66533
stp66534
a((dp66535
g2
(lp66536
V and  are not related;  is entirely a separate instance of the base class
p66537
aVIf you want to invoke the overridden initializer (), then use the  proxy object to access it:
p66538
aVNote that you still need to pass in an argument to the initializer of the parent class
p66539
aVIn the above example, I pass in a constant value 1 for the  parameter of the parent initializer
p66540
aVNote that I used Python 3 specific syntax here;  without arguments won't work in Python 2, where you also need to use  as a parent for the  class to make it a new-style class
p66541
as(dp66542
g16
V100297
p66543
stp66544
a((dp66545
g2
(lp66546
VThis is trivial with the  module:
p66547
aVYou already have the header in  as the first row; you can write all rows in one go with the  method
p66548
aVThat's all there is to it, really
p66549
as(dp66550
g16
V100297
p66551
stp66552
a((dp66553
g2
(lp66554
VUse:
p66555
aVto configure the source to build with UCS4 support
p66556
aVFrom the  output:
p66557
as(dp66558
g16
V100297
p66559
stp66560
a((dp66561
g2
(lp66562
VDownload and install Python 3 from the Python releases page; Mac OS X installers are available
p66563
aVSublime Text 3 uses Python 3 internally, but that is an embedded Python not suitable for installing your own packages into
p66564
aVYou ran the default system Python, on OS X 10
p66565
aV8 that is still version 2
p66566
ag4892
aVIf you have installed Python 3, make sure you start it with
p66567
as(dp66568
g16
V100297
p66569
stp66570
a((dp66571
g2
(lp66572
VThe most efficient way to get just the even lines is to use  and select only every 2nd item:
p66573
aVUsing your method works just fine too, provided you write the line in the loop:
p66574
as(dp66575
g16
V100297
p66576
stp66577
a((dp66578
g2
(lp66579
VTest for membership with :
p66580
aVNote that you could use a  loop with a  call instead of a  loop here, to loop  times:
p66581
as(dp66582
g16
V100297
p66583
stp66584
a((dp66585
g2
(lp66586
VThis is a buggy interaction between IDLE and BeautifulSoup's  objects (which subclass )
p66587
aVSee issue 1757057; it's been around for a while
p66588
aVThe work-around is to convert the object to a plain unicode value first:
p66589
as(dp66590
g16
V100297
p66591
stp66592
a((dp66593
g2
(lp66594
VAdd an empty print after the loop:
p66595
aVThis will print the extra newline you need
p66596
aVAlternatively, use ,  and  to create a new space-separated string from the numbers, printing that with the newline:
p66597
aVand
p66598
as(dp66599
g16
V100297
p66600
stp66601
a((dp66602
g2
(lp66603
VYou are still printing nested lists
p66604
aVJoin the nested lists too:
p66605
aVor, perhaps a little simpler to follow:
p66606
aVDemo:
p66607
as(dp66608
g16
V100297
p66609
stp66610
a((dp66611
g2
(lp66612
VYou have your indices mixed up
p66613
aVYou built the table with  outer lists, with the very inner lists having  elements
p66614
aVYou then try to address the innermost elements with a loop over  and the outermost list with
p66615
aVPython list comprehensions should be read from left to right as if they are nested; you even formatted your list comprehension that way:
p66616
aVBut your second nested  loops and indices don't match that structure; replicate it when assigning
p66617
aVMove the  range loop out and adjust how you use  to reference cells:
p66618
aVNote how now the nesting matches;  (), then  (), then  ()
p66619
as(dp66620
g16
V100297
p66621
stp66622
a((dp66623
g2
(lp66624
VIf you need to add padding, you have the wrong string
p66625
aVDo make sure you are parsing the data URI correctly; the  section is metadata about the encoded value, only the part after the comma is the actual Base64 value
p66626
aVThe actual data portion is 223548 characters long:
p66627
aVIf your URI still includes the  prefix, do parse that out:
p66628
aVThis then lets you make some more informed decisions about what extension to use for image URLs, for example, as you now have the mimetype parsed out as well
p66629
as(dp66630
g16
V100297
p66631
stp66632
a((dp66633
g2
(lp66634
VBecause running a command in the shell is not the same thing as running it with ; the shell expanded the  wildcard
p66635
aVEither expand the list of files with  or the  module yourself, or run the command through the shell from Python; with the  argument to  (but make the first argument a whitespace-separated string)
p66636
aVUsing  is probably the best option here:
p66637
as(dp66638
g16
V100297
p66639
stp66640
a((dp66641
g2
(lp66642
VIn a global function, you can refer directly to the function object by looking up the name
p66643
aVThis does not work in a method; you'd have to look the method up on the class instead:
p66644
aVThis still won't do what you want, however, because you'd get a unbound method object at that moment:
p66645
aVMethod objects are created on demand (because functions are descriptors), and creating an attribute on a method object is futile; they generally only live for a short while
p66646
aVYou'd need to access the function instead:
p66647
aVbut you can do the same thing on :
p66648
aVNow you can add a attribute:
p66649
aVBut it would be much easier to just store that attribute on the class instead:
p66650
as(dp66651
g16
V100297
p66652
stp66653
a((dp66654
g2
(lp66655
VIf you omit the third parameter, then the first value from  is used as the initializer
p66656
aVOr, to put it a different way,  places the optional 3rd parameter before the values of the second argument, if present
p66657
aVMoreover, that means that if the second argument is an empty sequence, that third argument serves as the default, just as a second argument with only one element (and no explicit initializer argument), would be the default return value
p66658
aVThe  documentation includes a Python version of the function:
p66659
aVNote how the , when not , is used as the first value instead of a first value from
p66660
as(dp66661
g16
V100297
p66662
stp66663
a((dp66664
g2
(lp66665
VYou could change the default value to a sentinel:
p66666
aVor by accessing it directly in the  tuple:
p66667
aVbut don't actually use that; that'll just serve to confuse those not familiar with standard function object attributes
p66668
aVYes, the  object is introspectable and can be obtained still by a determined developer, but then again that same developer could just monkeypatch your function as well
p66669
aV:-)
p66670
as(dp66671
g16
V100297
p66672
stp66673
a((dp66674
g2
(lp66675
VJust add your new egg to the buildout, and run buildout with :
p66676
aVThis means eggs will not be upgraded
p66677
aVYou may want to pin your egg versions; add a  section where you name all your egg versions, and add a  entry in the  section
p66678
aVAdd  and  as well to enforce the policy and require that all eggs have an entry in the versions section:
p66679
aVRunning with  results in an error every time buildout comes across an egg you did not pin yet; keep adding eggs to the  section until all eggs are pinned
p66680
as(dp66681
g16
V100297
p66682
stp66683
a((dp66684
g2
(lp66685
VInstead of strip, select for the numbers with a regular expression:
p66686
aVDemo:
p66687
aVThis returns a list of all matches; this lets you find multiple numbers in a string too:
p66688
as(dp66689
g16
V100297
p66690
stp66691
a((dp66692
g2
(lp66693
VUse the  function with a list comprehension to keep entries with numbers instead:
p66694
aVThe  function here returns  if there is any value in the iterable (a generator expression here) that is ,  otherwise
p66695
aVIf the expression  only yields  then that  will not be included in the new list
p66696
aVDemo:
p66697
as(dp66698
g16
V100297
p66699
stp66700
a((dp66701
g2
(lp66702
VGenerating the last midnight is easy:
p66703
aVThat combines today's date, together with  to form a  object at midnight
p66704
aVWith a  you can calculate the previous midnight:
p66705
aVNow all you need to do is test if your timestamp is in between these two points:
p66706
aVCombined into one function:
p66707
as(dp66708
g16
V100297
p66709
stp66710
a((dp66711
g2
(lp66712
VYou are trying to iterate over just the values, not key-value pairs
p66713
aVUse  instead:
p66714
aVNext, when writing integers (or anything else not a string) to files, convert these to strings first:
p66715
aVBut making use of string formatting would make your task far easier:
p66716
aVas string formatting allows you to add static strings and define how values are converted to strings
p66717
as(dp66718
g16
V100297
p66719
stp66720
a((dp66721
g2
(lp66722
VYour posted data contains doubly encoded JSON data:
p66723
aVWhatever produced this structure first encoded each  entry, then encoded the whole structure
p66724
aVTry to avoid this, as decoding now requires two steps
p66725
aVIn Python, you can repair this with:
p66726
aVbut ideally, you should fix the JS code that creates the nested structure
p66727
as(dp66728
g16
V100297
p66729
stp66730
a((dp66731
g2
(lp66732
VYes, it can really be this easy
p66733
aVThe  baseclass overrides the  hook to detect when changes have been made that need to be committed to the database
p66734
aVChanges to mutable attributes, such as a list, do not use the  hook and are thus not detected
p66735
aVIt's easiest to show this with a demo class:
p66736
aVNote how the  call did not result in printed output; the  call works directly on the list, not on the parent  instance
p66737
aVReassignment, on the other hand, is detected:
p66738
aVAnother way to signal to  that something changed is by setting the  flag directly:
p66739
aVIf you are ever in doubt that your change is being detected, you can also test that flag:
p66740
aVAn  will be raised if  is  (or perhaps ); which is only the case if no changes were detected since the beginning of the current transaction
p66741
as(dp66742
g16
V100297
p66743
stp66744
a((dp66745
g2
(lp66746
VYour list is empty; it'll be empty if  is lower than :
p66747
aVbecause then generated  results in an empty list:
p66748
aVYou'll need to test for that in your loop; if the player lied and stated that the guess is too high, while it was really correct or too low, then you can end up with  being lower than
p66749
aVNote that instead of  you could just use  to pick one value from a sequence:
p66750
aVbut if it is a value in a range anyway, just use :
p66751
aVThe nice thing is that  includes the end value in the possible values to pick from, so you don't have to use  here
p66752
aVSimplifying your  function with a little, eliminating  altogether, and adding in tests for  and :
p66753
as(dp66754
g16
V100297
p66755
stp66756
a((dp66757
g2
(lp66758
VYou cannot have both a function and another variable named
p66759
aVRename one or the other
p66760
aVAs it stands, you first bind  to a float value
p66761
aVYou then rebind it by defining a  function
p66762
aVLast but not least, by calling  you rebind  again, back to a float number:
p66763
aVBy the time you try to execute ,  is bound to a floating point value and not a function anymore
p66764
as(dp66765
g16
V100297
p66766
stp66767
a((dp66768
g2
(lp66769
VThe option is merely used to control when a warning is issued:
p66770
aVWhen data records are large, a warning is issued to try to prevent new
p66771
aVusers from shooting themselves in the foot
p66772
aVThe  is used to set the threshold, the default is , or 1GB
p66773
aVOver this size, you should either use ZODB Blobs or split up the data into smaller persistent records, as changes to large homogeneous records will lead to huge churn when committed
p66774
aVSee a previous answer of mine: when to commit data in ZODB
p66775
aVThe warning is issued for your  because it stores all keys and values in one record
p66776
aVIt is not the individual sizes of the text documents that count here, it is the size of (the pickles of) all text documents added together that triggers the warning here
p66777
aVEither store your text documents in the  as a subclass of  (so that values get their own record in the ZODB), or use a  object
p66778
aVSee Advanced ZODB for Python Programmers
p66779
as(dp66780
g16
V100297
p66781
stp66782
a((dp66783
g2
(lp66784
VYou can only loop over iterators once;  is an iterator that once scanned through for  cannot be iterated over again to search for
p66785
aVDon't use list comprehensions here
p66786
aVLoop over  once, inspecting each entry for both  and :
p66787
aVThe alternatives would be to:
p66788
aVrecreate the  object for the  list:
p66789
aVThis does double work; you loop over the full dataset twice
p66790
aVuse  to 'clone' the iterator:
p66791
aVThis ends up caching all of  in the  buffer, requiring twice the memory for the same task, until  empties out the buffer again
p66792
as(dp66793
g16
V100297
p66794
stp66795
a((dp66796
g2
(lp66797
V is a special exception; like ,  and , it does not derive from the base  class
p66798
aVCatching just  is thus not enough; you'd normally catch it explicitly:
p66799
aVHowever, you are also trying to catch exceptions in threads; threads have their own separate stack; you cannot just go and catch exceptions thrown in those stack in your main thread
p66800
aVYou'd have to catch exceptions in that thread:
p66801
aVTo handle this in a generic way and 'pass' exceptions to the main thread, you'd need some sort of inter-thread communication
p66802
aVSee Catch a thread's exception in the caller thread in Python for a full solution to that
p66803
as(dp66804
g16
V100297
p66805
stp66806
a((dp66807
g2
(lp66808
VI urge you to start reading up on Unicode first:
p66809
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p66810
aVby Joel Spolsky
p66811
aVThe Python Unicode HOWTO
p66812
aVPragmatic Unicode by Ned Batchelder
p66813
aVbefore you continue
p66814
aVYou need to encode  values using a specific encoding;  uses the default encoding ASCII, which fails for some of your values
p66815
aVExplicit encoding can be done with the  method:
p66816
aVbut you need to pick an encoding that works for your problem domain
p66817
as(dp66818
g16
V100297
p66819
stp66820
a((dp66821
g2
(lp66822
VIf you want an immutable object, use the  factory to create a class for you:
p66823
aVDemo:
p66824
aVNote that the whole object is immutable; you cannot change  after the fact either:
p66825
as(dp66826
g16
V100297
p66827
stp66828
a((dp66829
g2
(lp66830
VThe new magic  behaviour was added to avoid violating the DRY (Don't Repeat Yourself) principle, see PEP 3135
p66831
aVHaving to explicitly name the class by referencing it as a global is also prone to the same rebinding issues you discovered with  itself:
p66832
aVThe same applies to using class decorators where the decorator returns a new object, which rebinds the class name:
p66833
aVThe magic   cell sidesteps these issues nicely by giving you access to the original class object
p66834
aVThe PEP was kicked off by Guido, who initially envisioned  becoming a keyword, and the idea of using a cell to look up the current class was also his
p66835
aVCertainly, the idea to make it a keyword was part of the first draft of the PEP
p66836
aVHowever, it was in fact Guido himself who then stepped away from the keyword idea as 'too magical', proposing the current implementation instead
p66837
aVHe anticipated that using a different name for  could be a problem:
p66838
aVMy patch uses an intermediate solution: it assumes you need
p66839
aVwhenever you use a variable named
p66840
aVThus, if you (globally)
p66841
aVrename  to  and use  but not , it won't work
p66842
aVwithout arguments (but it will still work if you pass it either
p66843
aVor the actual class object); if you have an unrelated
p66844
aVvariable named , things will work but the method will use the
p66845
aVslightly slower call path used for cell variables
p66846
aVSo, in the end, it was Guido himself that proclaimed that using a  keyword did not feel right, and that providing a magic  cell was an acceptable compromise
p66847
aVI agree that the magic, implicit behaviour of the implementation is somewhat surprising, but  is one of the most mis-applied functions in the language
p66848
aVJust take a look at all the misapplied  or   invocations found on Ohlo Code; if any of that code was ever called from a derived class you'd end up with an infinite recursion exception
p66849
aVAt the very least the simplified  call, without arguments, avoids that problem
p66850
aVAs for the renamed ; just reference  in your method as well and it'll work again
p66851
aVThe cell is created if you use  or use  in your method:
p66852
as(dp66853
g16
V100297
p66854
stp66855
a((dp66856
g2
(lp66857
V takes a size argument:
p66858
aVRead at most size bytes from the file (less if the read hits EOF before obtaining  bytes)
p66859
aVIf the  argument is negative or omitted, read all data until EOF is reached
p66860
aVYou can use that in a loop, combined with the  function (with the second argument set to  as a sentinel), and  for efficiency:
p66861
aVThe alternative would be to use a  loop:
p66862
aVIf you already tried  and got an empty string back, your file was already at EOF at the time
p66863
as(dp66864
g16
V100297
p66865
stp66866
a((dp66867
g2
(lp66868
VThose are HTTP headers; quoting the API documentation:
p66869
aVSecure access to D&B; Direct services is managed through the use of an Authentication Token, which can be obtained by sending an HTTP POST request to Authentication Service URL, passing a valid username and password in the HTTP header
p66870
aVAdd them as such:
p66871
aVThis works for me, albeit that I get a 401 response (as I don't have any valid credentials):
p66872
aVentirely as documented
p66873
as(dp66874
g16
V100297
p66875
stp66876
a((dp66877
g2
(lp66878
VYour  function returns a tuple:
p66879
aVHere  returns a tuple of two values
p66880
aVNote that it's the comma that makes that expression a tuple; parenthesis are optional in most contexts
p66881
aVYou assign this return value to :
p66882
aVmaking  a tuple here
p66883
aVThen when you try to add  to it again, the error occurs
p66884
aVYou don't change  within the function, so there is no point in returning the value here; remove it from the  statement:
p66885
as(dp66886
g16
V100297
p66887
stp66888
a((dp66889
g2
(lp66890
VThe  module gives you as string; simply split than column on the dash with , and map to :
p66891
aVNow you have two integer values to calculate with:
p66892
as(dp66893
g16
V100297
p66894
stp66895
a((dp66896
g2
(lp66897
VPython opens  in line-buffering mode, so you won't see voltages printed in columns until a flush, when not printing newlines
p66898
aVManually flush the buffer with:
p66899
as(dp66900
g16
V100297
p66901
stp66902
a((dp66903
g2
(lp66904
VThe two statements do not contradict one another
p66905
aVYou can use  more than once during one test
p66906
aVYou can log in, and the cookie handling in the test client will 'remember' your session, for subsequent requests
p66907
aVOnly when the test is done, is that state cleared
p66908
aVYou do not need to log out, because that's a client state stored with cookies, and that state is cleared when the test is done
p66909
aVOnly use  if you wanted to test what happens after a user has logged in but their session has expired, or similar scenarios
p66910
as(dp66911
g16
V100297
p66912
stp66913
a((dp66914
g2
(lp66915
VYou have a CSV file; use the  module:
p66916
aVNew each  object is a list of strings; each string representing a column in your file
p66917
aVSay the  column is column 8, then you'd use (with Python using 0-based indexing):
p66918
aVNow you have a floating point number from that string, and you can test against it:
p66919
as(dp66920
g16
V100297
p66921
stp66922
a((dp66923
g2
(lp66924
VDon't use formatting for SQL queries
p66925
aVUse SQL parameters instead
p66926
aVYour database adapter then takes care of the escaping for you, provided it can handle binary data
p66927
aVHow exactly you format SQL parameters depends on the database used; sqlite3 uses  placeholder:
p66928
aVand you'd pass in the list of values as the second argument to the  method:
p66929
aVYou'll need to verify in your database adapter documentation what style of SQL parameters are supported (one or more of , , ,  or ) and how it handles binary values
p66930
aVIf binary values are not handled at all, you'd need to decode that binary value to a unicode value instead; use base64 encoding perhaps, or decode from Latin-1 to get a one-on-one translation into Unicode codepoints
p66931
as(dp66932
g16
V100297
p66933
stp66934
a((dp66935
g2
(lp66936
VYou could test for contained lists before flattening:
p66937
aVDemo:
p66938
aVThis tries to be as efficient as can be under the circumstances;  only needs to test until a list is found, not all elements
p66939
as(dp66940
g16
V100297
p66941
stp66942
a((dp66943
g2
(lp66944
V is a mechanism to configure the log level for you based on a file; you can dynamically change it at any time in your program
p66945
aVCall  on the logging object for which you want to change the log level
p66946
aVUsually you'd do that on the root:
p66947
as(dp66948
g16
V100297
p66949
stp66950
a((dp66951
g2
(lp66952
VTo address a nested list, use separate indices for the outer and inner lists:
p66953
aVforms a tuple (the comma makes it a tuple, not parenthesis)
p66954
aVYou could just loop directly over the matrix lists, using the  function to generate the indices for the  index calculation:
p66955
as(dp66956
g16
V100297
p66957
stp66958
a((dp66959
g2
(lp66960
VDon't
p66961
aVThere is no need to remove the line break
p66962
aVUse the  module to read the CSV file, it'll handle the linebreak correctly:
p66963
aVwill print:
p66964
aVfor that row
p66965
aVThis works because that column is correctly quoted
p66966
as(dp66967
g16
V100297
p66968
stp66969
a((dp66970
g2
(lp66971
VPython does not have a unary numeric incrementation operator
p66972
aVsimply means 'apply the  operator to '
p66973
aVThe unary  operator returns it's numeric value unchanged:
p66974
aVIt exists to mirror the unary  operator, which returns the value negated:
p66975
aVIt does not mean 'add 1 to 4'
p66976
aVIf instead you meant to test for greater than or equality, then do so:
p66977
aVonly means 'greater than' and clearly, 4 is not greater than 4
p66978
as(dp66979
g16
V100297
p66980
stp66981
a((dp66982
g2
(lp66983
VYou always add  after ever record; this leads to an empty record being read, as there is nothing but whitespace after the last such line:
p66984
aVNote the  entry at the end
p66985
aVThat leads to an empty dictionary with no  key:
p66986
aVTest for empty dictionaries:
p66987
as(dp66988
g16
V100297
p66989
stp66990
a((dp66991
g2
(lp66992
VBoth CPython and IronPython come with the  module, which lets you load DLLs directly:
p66993
aVDo read the module documentation carefully, it includes a tutorial on how to pass in various C types correctly
p66994
as(dp66995
g16
V100297
p66996
stp66997
a((dp66998
g2
(lp66999
VYou'll have to loop over  manually, sets are the wrong tool here
p67000
aVYou can find 'missing' items with dictionary views, which do use set operations:
p67001
aVThis produces a set of filenames to back up
p67002
aVIn Python 3, use  instead of
p67003
aVIn Python 2
p67004
aV6 and older, use  instead of
p67005
aVDemo:
p67006
as(dp67007
g16
V100297
p67008
stp67009
a((dp67010
g2
(lp67011
VThe  format always uses strings to look up the name in the dictionary
p67012
aVUse the newer  method instead:
p67013
as(dp67014
g16
V100297
p67015
stp67016
a((dp67017
g2
(lp67018
VUse the  method to test if a string is uppercase
p67019
aVYou can use indexing to select just the first character
p67020
aVThus, to test if the first character is uppercase, use:
p67021
aVIf you want a fast and pythonic approach, use a  object to do the counting, and split on all whitespace to remove newlines:
p67022
aVHere,  without arguments splits on all whitespace, removing any whitespace at the start and end of the line (including the newline)
p67023
as(dp67024
g16
V100297
p67025
stp67026
a((dp67027
g2
(lp67028
VThe built-in  is implemented in C code, and  can only show you Python code:
p67029
aVThe  type is always implemented in C
p67030
aVThe code for this function comes from the  source file; the  function delegates to the  utility function in the same source file
p67031
as(dp67032
g16
V100297
p67033
stp67034
a((dp67035
g2
(lp67036
VWhen you use , the input file is renamed, and any output your code produces on  is written to a newly created file with the original filename
p67037
aVthus has to rename the original file first, by adding  to the name
p67038
aVHowever, it appears there already is such a file present
p67039
aVProbably you had a bug in your code before and the backup file was never deleted
p67040
aVVerify that  does not contain anything you want to keep, then delete it or move it back to
p67041
aVIf, however, you keep running into this then Python has problems deleting the backup files automatically
p67042
aVOn Windows this is usually because another process keeps opening files for their own purposes in the background
p67043
aVYou could try deleting the backup file after a timeout:
p67044
aVIf your files are read-only, make them writable first:
p67045
as(dp67046
g16
V100297
p67047
stp67048
a((dp67049
g2
(lp67050
VReturn a JSON response instead, using the  library:
p67051
aVIn jQuery, make sure you tell it to receive JSON:
p67052
as(dp67053
g16
V100297
p67054
stp67055
a((dp67056
g2
(lp67057
VDon't use  an a binary file with multi-byte lines
p67058
aVIn UTF-16, little-endian, a newline is encoded as two bytes,  (in ASCII a newline) and  (a NULL)
p67059
aVsplits on the first of those two bytes, leaving you with incomplete data to decode
p67060
aVReopen the file with the  library for ease of decoding:
p67061
aVTo replace specific unicode codepoints with ASCII-friendly characters, use a dictionary mapping codepoint to codepoint or unicode string and call  first:
p67062
aVI used hexadecimal integer literals to define the unicode codepoints to map from here
p67063
aVThe value in the dictionary must be a unicode string, an integer (a codepoint) or  to delete that codepoint altogether
p67064
as(dp67065
g16
V100297
p67066
stp67067
a((dp67068
g2
(lp67069
VYou are looking for a list rotation; this is easiest accomplished with some list slices:
p67070
aVThis takes the first element of the list and places it at the end of a new list:
p67071
aVYour version simply returned just  (so everything but the first element); a  statement ends the function there and then, it does not return multiple times when placed in a loop
p67072
as(dp67073
g16
V100297
p67074
stp67075
a((dp67076
g2
(lp67077
VEasiest is to use a set comprehension instead of a list comp:
p67078
aVAll I did was replace the square brackets with curly braces
p67079
aVThis works in Python 2
p67080
aV7 and up
p67081
aVFor Python 2
p67082
aV6 and earlier, you'd use the  callable with a generator expression instead:
p67083
aVLast, but not least, you can replace the comprehension syntax altogether by producing the letters from all sequences by chaining the strings together, treat them all like one long sequence, with ; you give that a sequence of sequences and it'll give you back one long sequence:
p67084
as(dp67085
g16
V100297
p67086
stp67087
a((dp67088
g2
(lp67089
VPython 3 switches to absolute imports by default, and disallows unqualified relative imports
p67090
aVThe  line is such an import
p67091
aVPython 3 will only look for top-level modules; you don't have a  top-level module, only
p67092
aVUse a full module path, or use relative qualifiers:
p67093
aVThe  at the start tells Python 3 to import starting from the current package
p67094
aVYou can enable the same behaviour in Python 2 by adding:
p67095
aVThis is a change introduced by PEP 328, and the  import is available from Python 2
p67096
aV5 onwards
p67097
as(dp67098
g16
V100297
p67099
stp67100
a((dp67101
g2
(lp67102
VUse the  module to dynamically import modules, then use  to retrieve a specific name from that module:
p67103
as(dp67104
g16
V100297
p67105
stp67106
a((dp67107
g2
(lp67108
V is a local variable to the  function
p67109
aVFunction locals are entirely separate from module globals
p67110
aVPython marks a name as a local if you assign to it within a scope
p67111
aVis assigned to within
p67112
aVis also assigned to in , but in that function  is not
p67113
aVThat makes , in , a global
p67114
aVThat's how python lets you find built-ins, functions and other objects declared in your module or imported from another module
p67115
aVIf you want to assign to a name in a function and for it to be treated as a global still, you need to explicitly override Python and tell it to treat the name as a global:
p67116
aVYou can place the  statement anywhere in the function, it'll make that specific name global for the whole function
p67117
as(dp67118
g16
V100297
p67119
stp67120
a((dp67121
g2
(lp67122
V returns the index of a given value in the list:
p67123
aVbut raises a  when the item is not found in the list:
p67124
aVIf you have indices instead, just use indexing on the list:
p67125
aVIf you wanted to pair up elements of two lists, use the  function instead:
p67126
as(dp67127
g16
V100297
p67128
stp67129
a((dp67130
g2
(lp67131
VIt is easier to use , then use some iteration magic to produce the desired output:
p67132
aVThis produces:
p67133
aVwith no key function groups on equality; you get groups of the same repeated number
p67134
aVThus, you first get the s in a group, then the s, etc
p67135
aVWe then zip up each group with a cycling iterable of the group number followed by enough  values to replace the rest of the count
p67136
aVThe length of the group determines how often we cycle;  stops when the shortest iterable (, the group) is done
p67137
aVThus,  paired with a cycling  becomes
p67138
as(dp67139
g16
V100297
p67140
stp67141
a((dp67142
g2
(lp67143
VUse a unicode value; preferably with a unicode escape sequence:
p67144
aVPython on Windows will use the correct Windows API for listing UTF16 files when you give it a unicode path
p67145
aVFor more information on how Python alters behaviour with unicode vs
p67146
aVbytestring file paths, see the Python Unicode HOWTO
p67147
as(dp67148
g16
V100297
p67149
stp67150
a((dp67151
g2
(lp67152
VYes, use the  attribute on the file object
p67153
aVDemo:
p67154
as(dp67155
g16
V100297
p67156
stp67157
a((dp67158
g2
(lp67159
VYou could take a look at the source for the  method, where you can see how the output is generated from the  list:
p67160
aVIf you want to work with just the string output, then use  to get separate lines again:
p67161
as(dp67162
g16
V100297
p67163
stp67164
a((dp67165
g2
(lp67166
VBy not using  plus a comma; the comma will insert a space instead of a newline in this case
p67167
aVUse  to get more control:
p67168
aVjust writes to  for you, albeit that it also handles multiple arguments, converts values to strings first and adds a newline unless you end the expression with a comma
p67169
aVYou could also use the Python 3  function in Python 2 and ask it not to print a newline:
p67170
aVAlternatively, join the strings first with :
p67171
as(dp67172
g16
V100297
p67173
stp67174
a((dp67175
g2
(lp67176
V is just a single number, but the  argument expansion syntax requires that you pass in a sequence (like a ,  or , for example)
p67177
aVEither remove the  (and make your function work for just single arguments), or use  in the function signature to make  a tuple of 0 or more captured arguments:
p67178
aVor
p67179
aVThe latter now works for functions with more than one argument too:
p67180
aVIf you added a  argument to the signature, then keyword arguments could be handled too:
p67181
aVHere I renamed  to  to better reflect its purpose
p67182
as(dp67183
g16
V100297
p67184
stp67185
a((dp67186
g2
(lp67187
VThere are two things wrong here:
p67188
aVmatches a position between a word and a non-word character, so between any letter, digit or underscore, and a character that doesn't match that set
p67189
aVYou are trying to match the boundary between a  and a space; both are non-word characters and the  anchor would never match there
p67190
aVYou are handing  a , which means 'match a  and any other character'
p67191
aVYou'd need to escape the dot by using  to match a literal
p67192
aVThe following works better:
p67193
aVNow it'll match your input literally, and look for a following space or the end of the string
p67194
aVThe  creates a non-capturing group (always a good idea unless you specifically need to capture sections of the match); inside the group there is a  pipe to give two alternatives; either match  (whitespace) or match  (end of a line)
p67195
aVYou can expand this as needed
p67196
aVDemo:
p67197
as(dp67198
g16
V100297
p67199
stp67200
a((dp67201
g2
(lp67202
VYou reuse a mutable object in your loop:
p67203
aVCreate a new copy in the loop instead:
p67204
as(dp67205
g16
V100297
p67206
stp67207
a((dp67208
g2
(lp67209
VRead your lines into a list of tuples with the score converted to an integer for ease of sorting numerically, then sort the list:
p67210
aVThat said, your lines, with the -padded integers at the front, will sort lexicographically as well:
p67211
as(dp67212
g16
V100297
p67213
stp67214
a((dp67215
g2
(lp67216
VYour  expression results in a  value, and you are trying to concatenate that to a string with
p67217
aVYou cannot do that, as that would require an implicit conversion of the value to a string
p67218
aVEither use a comma when printing:
p67219
aVand have the  function convert this for you, or use string formatting (which gives you more control over how the float is formatted):
p67220
aVor, applying that to the full program:
p67221
aVNote that it's the formatting that rounds of the numbers now to 2 decimal positions
p67222
aVI've also corrected the formula; presumably the 'profit' is the Buy-it-now price minus the eBay and PayPal fees, not the fees combined minus the BIN
p67223
as(dp67224
g16
V100297
p67225
stp67226
a((dp67227
g2
(lp67228
VYou are looking at a string representation that can be pasted back into Python; the backslashes are doubled to make sure the values are not interpreted as escape sequences (such as , meaning a newline, or , meaning the byte with value 254, hex FE)
p67229
aVIf you are building new string values, you also need to use those doubled backslashes to prevent Python from seeing escape sequences where there are none, or use raw string literals:
p67230
aVFor this specific example, not handling the backslashes properly actually results in an exception:
p67231
aVbecause Python expects to find two hex digits after a  escape
p67232
as(dp67233
g16
V100297
p67234
stp67235
a((dp67236
g2
(lp67237
VThis should do it:
p67238
aVThis replaces  with the first value of a split on  (which could be just one element if there are no commas present)
p67239
aVThen the dictionary is updated with a sequence of key-value pairs, generated from the rest of the words and their indices (starting at 1)
p67240
as(dp67241
g16
V100297
p67242
stp67243
a((dp67244
g2
(lp67245
VYou'll need to catch the  or  here to be able to assign to :
p67246
aVor, better still, :
p67247
aVThe blanket  will catch the same exceptions as , catching just  will ignore , , and
p67248
aVNot catching these there is generally a good idea
p67249
aVFor details, see the exceptions documentation
p67250
as(dp67251
g16
V100297
p67252
stp67253
a((dp67254
g2
(lp67255
VYour first line is missing the format placeholders:
p67256
aVIt is the  placeholders that  fills
p67257
aVNote that you only need one string, with placeholders where the arguments to  are to be filled in
p67258
aVDemo output:
p67259
as(dp67260
g16
V100297
p67261
stp67262
a((dp67263
g2
(lp67264
VUse the  function to pause execution for a given time:
p67265
aVtakes an numeric argument, the number of seconds to 'sleep'
p67266
as(dp67267
g16
V100297
p67268
stp67269
a((dp67270
g2
(lp67271
VPut the comma at the end:
p67272
aVYou are using a conditional expression, of the form , and the part before the  () is part of that expression
p67273
aVyou are printing the outcome of that expression
p67274
as(dp67275
g16
V100297
p67276
stp67277
a((dp67278
g2
(lp67279
VPlenty of reasons not to use a :
p67280
aVif your values are not homogenous and thus cannot be generated by a simple factory function
p67281
aVif you need missing keys to raise an exception instead of creating a new value for you automatically
p67282
aVIf all your default values require more context than the factory function receives; the factory function has no access to the key being inserted, for example
p67283
aVfills a specialized use-case, where you want values to be auto-created for you when a key is missing, and those values can be generated with a factory function without access to key being inserted
p67284
aVNote that exceptions are not just there to flag programmer error
p67285
aVExceptions are a tremendously powerful part of the Python language useful for far more than just coding errors
p67286
aVIf your data is usually not going to need a new key, then using exception handling (asking for forgiveness) is faster than testing for the key each time (asking for permission)
p67287
aVSee Python Forgiveness vs
p67288
aVPermission and Duck Typing over on Progammers for a comparison
p67289
as(dp67290
g16
V100297
p67291
stp67292
a((dp67293
g2
(lp67294
VYou need to use a backslash to escape the  operator and match a literal :
p67295
aVYour code looked for a literal forward slash and any other character except a newline
p67296
aVDemo:
p67297
as(dp67298
g16
V100297
p67299
stp67300
a((dp67301
g2
(lp67302
VYou have a CSV file, use the  module to read it:
p67303
aVThis still gives you data by row, but with the  function you can transpose this to columns instead:
p67304
aVDo be careful with the latter; the whole file will be read into memory in one go, and a large CSV file could eat up all your available memory in the process
p67305
as(dp67306
g16
V100297
p67307
stp67308
a((dp67309
g2
(lp67310
VPython 2
p67311
aV6 and before (as well as Python 3
p67312
aV0) require that you number the placeholders:
p67313
aVThe numbering, if omitted in Python 2
p67314
aV7 and Python 3
p67315
aV1 and up, is implicit, see the documentation:
p67316
aVChanged in version 2
p67317
aV7: The positional argument specifiers can be omitted, so  is equivalent to
p67318
aVThe implicit numbering is popular; a lot of examples here on Stack Overflow use it as it is easier to whip up a quick format string that way
p67319
aVI have forgotten to include them more than once when working on projects that must support 2
p67320
aV6 still
p67321
as(dp67322
g16
V100297
p67323
stp67324
a((dp67325
g2
(lp67326
VYou need to get the string of each individual link, not of the whole result set
p67327
aVLoop over the set and fetch  per element:
p67328
as(dp67329
g16
V100297
p67330
stp67331
a((dp67332
g2
(lp67333
VYour recursive call ignores what is returned
p67334
aVAdd the return value:
p67335
aVNote that the outer list is ignored in the count, so the call returns 5, not 6
p67336
aVFurthermore, you should use  to test if an object is of a given type
p67337
aVIf you want to see , count the current list in the function, and leave counting nested lists to the recursive call:
p67338
as(dp67339
g16
V100297
p67340
stp67341
a((dp67342
g2
(lp67343
VUse the  argument expansion syntax:
p67344
aVThe  (splash) tells Python to take each element in an iterable and apply it as a separate argument to the function
p67345
aVDemo:
p67346
as(dp67347
g16
V100297
p67348
stp67349
a((dp67350
g2
(lp67351
VYou would at least use  with a generator expression to create the total number of seconds:
p67352
aVDemo:
p67353
as(dp67354
g16
V100297
p67355
stp67356
a((dp67357
g2
(lp67358
VI'd use a  object:
p67359
aVThe lists maintain order here, and you end up with your desired structure: values per key, stored in an ordered list by order of webpages visited
p67360
as(dp67361
g16
V100297
p67362
stp67363
a((dp67364
g2
(lp67365
VUse  to access the original :
p67366
aVDemo:
p67367
aVYou probably want to support slicing as well:
p67368
aVand if you wanted to support assignment to arbitrary indices as well, add a  method:
p67369
aVbut then you could move the default-value creation out to a helper method:
p67370
as(dp67371
g16
V100297
p67372
stp67373
a((dp67374
g2
(lp67375
VUse the  module to track which list to pick the next sorted value from:
p67376
aVThis pushes all lists unto a heap, kept sorted by their next value
p67377
aVEvery time this yields the lowest value, the heap is updated with the next value from the iterable used and reorders the heap again
p67378
aVThis in essence keeps a list of  lists, and these are sorted efficiently by
p67379
aVUsage:
p67380
aVor
p67381
aVto create a new big list with all values sorted, efficiently
p67382
aVThis exact implementation was added to the  module as the  function so you can just do:
p67383
as(dp67384
g16
V100297
p67385
stp67386
a((dp67387
g2
(lp67388
VJinja 2 is listed as an optional dependency, see the iPython quickstart
p67389
aVYou must install optional dependencies separately:
p67390
aVAlternatively, install all optional dependencies with:
p67391
as(dp67392
g16
V100297
p67393
stp67394
a((dp67395
g2
(lp67396
VYes, use the  constructor:
p67397
aVtakes any iterable and adds its values to a newly created list object
p67398
aVHowever, if you need a sorted list, you may as well use  directly:
p67399
as(dp67400
g16
V100297
p67401
stp67402
a((dp67403
g2
(lp67404
VTreat the data like CSV data (albeit separated by a pipe), with the  module:
p67405
aVThe  gives you an iterator yielding a list for each row; your sample line would result in:
p67406
aVIndices start at 0, so the column with the  text is ; the second column number is in
p67407
aVThe above code tests if there are enough columns in the current row and if , when lowercased, starts with the word
p67408
aVThe above assumes Python 2; for Python 3 it looks subtly different:
p67409
as(dp67410
g16
V100297
p67411
stp67412
a((dp67413
g2
(lp67414
VThis feature of the Python 3 compiler has not been backported to Python 2
p67415
ag1205
aVThere is no magic  switch to enable it, your only option is to upgrade to Python 3
p67416
ag1205
aVYour second function could instead be defined as:
p67417
aVto be Python 2 compatible
p67418
as(dp67419
g16
V100297
p67420
stp67421
a((dp67422
g2
(lp67423
VSimply loop over the output of the  function:
p67424
aVThis uses tuple unpacking;  produces tuples of two items each, and Python assigns these to the two names
p67425
aVThe first combination produced is , but the loop assigns these to  (set to  and  (set to ) respectively
p67426
aVQuick demo just printing:
p67427
as(dp67428
g16
V100297
p67429
stp67430
a((dp67431
g2
(lp67432
VYes, pin the version in a  section:
p67433
aVIt is generally a good idea to pin versions, and set  in the  section to force an error for any egg you didn't yet pin
p67434
as(dp67435
g16
V100297
p67436
stp67437
a((dp67438
g2
(lp67439
VUse  to pick out the highest codepoint used, then match that against your ranges:
p67440
aVDemo:
p67441
as(dp67442
g16
V100297
p67443
stp67444
a((dp67445
g2
(lp67446
VUnfortunately, that answer there is correct for that question, but subtly wrong for yours
p67447
aVAlthough a top-level function instead of a lambda is great and indeed would make pickle a lot happier, the function should return the default value to be used, which for your case is not another  object
p67448
aVSimply return the same value your  returns:
p67449
aVEvery time you try to access a key in the  instance that doesn't yet exist,  is called
p67450
aVThe other post then returns another  instance, that one set to use  as a default, which matches the lambda shown in the other question
p67451
as(dp67452
g16
V100297
p67453
stp67454
a((dp67455
g2
(lp67456
V is a  tag with text
p67457
aVYou cannot have BeautifulSoup break up that text any further, the whole text is one unit:
p67458
aVUse string methods to get the part you want:
p67459
aVThe  syntax would give you access to HTML attributes on a tag, but the  has no attributes at all
p67460
as(dp67461
g16
V100297
p67462
stp67463
a((dp67464
g2
(lp67465
VYou've opened the file in text mode, which will encode data for you
p67466
aVJust write the string directly without encoding:
p67467
aVThe default encoding for text files is UTF-8, but you can give the  call a different encoding if you so wish
p67468
aVAlternatively, open the file in binary mode with  instead of , encode manually like you did and write byte objects
p67469
as(dp67470
g16
V100297
p67471
stp67472
a((dp67473
g2
(lp67474
VA namedtuple instance has a  method:
p67475
aVbut if the namedtuple attributes are in the same order as the arguments of the function, you could just apply it as a sequence instead:
p67476
aVHere the two values of the namedtuple are applied, in order, to the keyword arguments in the function
p67477
aVThose two arguments can be addressed as positional arguments still, after all
p67478
aVFor your sample function, both work:
p67479
as(dp67480
g16
V100297
p67481
stp67482
a((dp67483
g2
(lp67484
VUse the  function to get access to the calling frame
p67485
aVFrame objects have a  attribute giving you access to the local variables of that frame:
p67486
as(dp67487
g16
V100297
p67488
stp67489
a((dp67490
g2
(lp67491
VIf the  statement does not match, the  line is not executed and the code continues to the second  statement
p67492
aVIf the second return statement was not present, the function would just end and the default return value  would be returned instead
p67493
aVThe function can be simplified though; the expression used in the  statement itself is already evaluating to either  or :
p67494
aVThe  statement and two returns are entirely redundant here
p67495
as(dp67496
g16
V100297
p67497
stp67498
a((dp67499
g2
(lp67500
VUse  to combine the lists into columns, filter the columns, then use  again to transpose back to rows:
p67501
aVDemo:
p67502
aVThis creates a list of tuples
p67503
aVShould you absolutely need lists, map to lists:
p67504
aVor, in Python 3, use a list comprehension:
p67505
as(dp67506
g16
V100297
p67507
stp67508
a((dp67509
g2
(lp67510
VYou can add to a list with , but you need to capture user input into a separate variable:
p67511
aVApart from using separate variables for the list of names and for the name the user has just entered, I also started the list entirely empty
p67512
aVYou can avoid using two  calls by changing the  loop to an infinite loop and instead break out of the loop when  has been entered:
p67513
aVYou may also need to test if there are enough employees entered before you print the second employee:
p67514
as(dp67515
g16
V100297
p67516
stp67517
a((dp67518
g2
(lp67519
VYou only set  in one of the top / statement
p67520
aVIf  is , you don't set  at all
p67521
aVSet  at the top of the function (to  or whatever else you want it to be)
p67522
aVThis applies to all the digit variables, , , etc
p67523
aVWhat you really should do, instead, is use a list of digits, and append either a 0 or a 1 to that list every time you divide the number by a factor
p67524
aVYou may want to take a look at the  function; it returns both the quotient and the remainder
p67525
aVYou could also do with some looping here to slash the number of  statements needed here:
p67526
as(dp67527
g16
V100297
p67528
stp67529
a((dp67530
g2
(lp67531
VThe original, primary use for savepoints is to be able to roll back parts of a transaction
p67532
aVSay you wanted to accept a large number of log entries, but need to process these in batches into the database:
p67533
aVNow the transaction has been committed, except the last batch has been rolled back
p67534
aVThat was the original reason to use savepoints
p67535
aVSetting a savepoint has the side-effect of triggering a ZODB cache garbagecollection run
p67536
aVThe ZODB holds a cache of objects recently accessed
p67537
aVThis includes objects that don't actually change during the current transaction; you just retrieved them from the database, used their data, and then stopped directly referencing them
p67538
aVThe ZODB stores an object graph; one object references other objects, which in turn reference other objects
p67539
aVEach of those objects, if they inherit from the  base class, are separate ZODB records
p67540
aVWhen you traverse the graph, these objects are all loaded into memory
p67541
aVThe GC run clears them from memory again, provided they haven't changed
p67542
aVTraversing the object graph again would load them into memory again, but clearing them during a savepoint saves memory
p67543
aVSavepoint data itself is stored on disk in a  file, in your  directory
p67544
aVThis uses a  object, which for security reasons is created in an unlinked state; the file exists, but the directory entry is cleared immediately on creation
p67545
aVYou therefor cannot see this file from outside the ZODB process
p67546
aVA full commit moves the data into the actual ZODB database and finalises the transaction
p67547
as(dp67548
g16
V100297
p67549
stp67550
a((dp67551
g2
(lp67552
VKeep your data out of your variable names
p67553
aVUse a dictionary to store your items, creating dynamic keys instead:
p67554
as(dp67555
g16
V100297
p67556
stp67557
a((dp67558
g2
(lp67559
VIt is really up to the custom  method to not pass on arguments it itself used and needed
p67560
aVIf neither ,  or  need arguments, then the fact that  raises an exception is entirely correct
p67561
aVNote that as soon as you have a custom  as well, then  won't raise the exception either
p67562
aVThat's because now there is somewhere to hand those remaining arguments to:
p67563
aVIt does appear that this behaviour changed in Python 3
p67564
aVYou can test to see what  method is returned:
p67565
as(dp67566
g16
V100297
p67567
stp67568
a((dp67569
g2
(lp67570
VFirst of all, your first line of code gives you one string element:
p67571
aVThe easiest method to turn a string with hex characters into bytes is to use :
p67572
aVor, using a list:
p67573
aVThis is one set of bytes, not a list, but turning that into a list is as simple as calling  on  that if you insist:
p67574
aVNote that the  there is just Python representing that byte as a ASCII printable character; it is still just the same byte:
p67575
aVThis is nothing to worry about, it's just a byte representation
p67576
as(dp67577
g16
V100297
p67578
stp67579
a((dp67580
g2
(lp67581
VAlways try to check in the source, not the result of running a process
p67582
aVA virtualenv is rather platform specific; a Windows virtualenv may require different binaries than one created on Linux
p67583
aVThe paths in the script files will almost certainly use absolute paths, not relative paths tying a virtualenv to a specific location on your harddisk
p67584
aVInstead, check in instructions on how to recreate a virtualenv
p67585
aVInclude the commands, and use tools like  or  to let others recreate the right environment for their platform
p67586
aVlets you install packages into a virtualenv with a  file
p67587
aVYou'd commit that file
p67588
aVlets you define complex build configurations in  files
p67589
aVCommit those
p67590
as(dp67591
g16
V100297
p67592
stp67593
a((dp67594
g2
(lp67595
VYou'd need to mark a column as  or  to get auto-incrementation behaviour
p67596
aVThe difference between those two types is subtle; the latter form will never reuse IDs
p67597
aVSee the ROWID and the INTEGER PRIMARY KEY documentation
p67598
as(dp67599
g16
V100297
p67600
stp67601
a((dp67602
g2
(lp67603
VThree different things can happen:
p67604
aVthread A and B read  before it is changed, then
p67605
aVthread A writes its result (13), and
p67606
aVthread B writes its result (14),
p67607
aVand the second thread to write wins
p67608
aVthread A or B reads  first, and writes before the other thread reads
p67609
aVResult: 15, as either A reads 12, adds one and writes 13, then B reads 13 and writes 15, or vice-versa
p67610
as(dp67611
g16
V100297
p67612
stp67613
a((dp67614
g2
(lp67615
VMultiplication of strings is not the same things as multiplication of numbers
p67616
aVString multiplication does not implicitly convert to numbers, even if the string could be interpreted as such
p67617
aVInstead, the string is repeated, by the integer number given:
p67618
aVIf your method needs to multiply numbers, then make sure you get only numbers; use  or  to convert strings to numbers first
p67619
as(dp67620
g16
V100297
p67621
stp67622
a((dp67623
g2
(lp67624
VThe second argument determines the socket type;  is UDP,  is a TCP socket
p67625
aVThis all provided you are using a  or  socket family
p67626
aVBefore you continue, perhaps you wanted to go and read the Python socket programming HOWTO, as well as other socket programming tutorials
p67627
aVThe difference between UDP and TCP sockets is rather big, but the differences translate across programming languages
p67628
aVSome information on sockets on the Python Wiki:
p67629
aVUDP Communication
p67630
aVTCP Communication
p67631
as(dp67632
g16
V100297
p67633
stp67634
a((dp67635
g2
(lp67636
VI am assuming you are using CPython here
p67637
aVProvided there is no custom  or  hook dropping back into Python or the values you test against contained in the list use custom  hooks implemented in Python code, the  operator can be handled entirely in C, and is just one opcode
p67638
aVThis makes the operation entirely thread-safe; Python threads only switch between opcodes; the GIL (global interpreter lock) normally only unlocks between opcodes
p67639
aVThat said, if you use  on a custom C type that unlocks the GIL when testing containment would not be thread-safe
p67640
aVIn other words: the  bytecode test is locked, but if the operator needs to call Python code (through , iterating with  when no  implementation is available, or the values are test against  hooks implemented in Python), then the operation is not thread safe
p67641
aVFor other Python implementations, how threading is handled can vary widely
p67642
aVCertainly, Jython and IronPython have no GIL, and you should assume the operation is not thread safe
p67643
as(dp67644
g16
V100297
p67645
stp67646
a((dp67647
g2
(lp67648
VYou forgot the colon:
p67649
as(dp67650
g16
V100297
p67651
stp67652
a((dp67653
g2
(lp67654
VYou can assign to a slice:
p67655
aVDemo:
p67656
aVEssentially,  is an assignment to the  slice
p67657
aVYou can 'insert' another list at any position, just address the empty slice at that location:
p67658
as(dp67659
g16
V100297
p67660
stp67661
a((dp67662
g2
(lp67663
VUse the  module to extract specific information such as line numbers:
p67664
as(dp67665
g16
V100297
p67666
stp67667
a((dp67668
g2
(lp67669
VThe Python 2 CSV module does not handle Unicode input
p67670
aVOpen the file in binary mode, and decode after parsing it as CSV
p67671
aVThis is safe for the UTF-8 codec as newlines, delimiters and quotes all encode to 1 byte
p67672
aVThe  module documentation includes a  wrapper class in the example section that will do the decoding for you; it is easily adapted to the  class:
p67673
aVUse this with the file opened in binary mode:
p67674
as(dp67675
g16
V100297
p67676
stp67677
a((dp67678
g2
(lp67679
VThe  function in Python returns an integer result for integer inputs:
p67680
aVThis is not the same function as what  gives you, which uses floating point results:
p67681
aVThe equivalent function in Python is :
p67682
aVand suffers from the same limitations, albeit subtly different in actual result:
p67683
aVJavaScript only has the Number type, which limits JS arithmetic to float precision, always, while Python's support for a memory-bound integer type gives it more scope for precision
p67684
as(dp67685
g16
V100297
p67686
stp67687
a((dp67688
g2
(lp67689
VYou are comparing different types
p67690
aVIn Python 2, types are ordered relative to one another by their name, and numeric types are always ordered before everything else
p67691
aVThis was introduced to allow sorting of heterogeneous lists, containing different types of data
p67692
aVPython 3 rectifies this somewhat surprising behaviour, there comparing types (to numbers or to one another) is always an error unless specifically allowed by custom comparison hooks:
p67693
as(dp67694
g16
V100297
p67695
stp67696
a((dp67697
g2
(lp67698
VThe  syntax captures any number of arguments; the lambdas accept 0 or more arguments and all return a constant value, regardless
p67699
aVEssentially, these lambdas ignore any and all arguments passed in
p67700
aVThe syntax can be used in functions as well, and there is also a keyword argument equivalent in the form of , resulting in a mapping
p67701
aVQuick demo:
p67702
aVhere returns whatever  captured; a tuple of 0 or more values that were the arguments to the call
p67703
as(dp67704
g16
V100297
p67705
stp67706
a((dp67707
g2
(lp67708
VDon't confuse variables with values
p67709
aVThe name  references a value, and you just return that from your function
p67710
aVWhere you call the function, you assign the returned value to a local variable, and use that  reference to pass it into the next function call:
p67711
aVHere the  returns something, that is stored in , and then passed to the second call
p67712
aVThe return value of the second function call is again stored (using the same name here), and passed to the third call
p67713
aVAnd so on
p67714
as(dp67715
g16
V100297
p67716
stp67717
a((dp67718
g2
(lp67719
VYour  expression already results in a boolean value; it is either  or
p67720
aVYou can return it directly:
p67721
aVThis is essentially what  tests for; take your expression, pass it to  and see if it is either  or
p67722
aVThe  is not needed here as comparison operators (  and ) themselves already return  or :
p67723
as(dp67724
g16
V100297
p67725
stp67726
a((dp67727
g2
(lp67728
VSplit once on the  sign and take the last element:
p67729
aVThis works even if there is no  sign in the input string
p67730
as(dp67731
g16
V100297
p67732
stp67733
a((dp67734
g2
(lp67735
VIntegers and strings are immutable and  won't change  in-place for you
p67736
aVYou need to assign the resulting value of  back to :
p67737
aVOr just print the output of the function instead of :
p67738
aVThis will print the decimal value of the codepoint
p67739
aVIf you wanted hexadecimal output, you'd need to format the integer return value of  as such, probably with some spaces in between:
p67740
aVThis uses the  function to format an integer as a lower-cased hexadecimal number by usitng the  format specification
p67741
aVNow you get:
p67742
as(dp67743
g16
V100297
p67744
stp67745
a((dp67746
g2
(lp67747
VYou need to collect all converted characters in your function in a list, and return that:
p67748
aVexits the function immediately, so your version only returns the first encoded value
p67749
as(dp67750
g16
V100297
p67751
stp67752
a((dp67753
g2
(lp67754
VPython special methods use two underscores at the start and end; you need to name the initializer , not :
p67755
aVUnderscore characters are usually shown connecting up forming a longer line, but there are two underscores before , and two after
p67756
as(dp67757
g16
V100297
p67758
stp67759
a((dp67760
g2
(lp67761
VYou misspelled the  header:
p67762
aVCorrect the spelling of :
p67763
as(dp67764
g16
V100297
p67765
stp67766
a((dp67767
g2
(lp67768
VUse key assignment:
p67769
aVThis loops over the file object directly, no need for  calls here, and removes the newline
p67770
aVYou appear to have CSV data; you could also use the  module here:
p67771
aVor even a dict comprehension:
p67772
aVHere the  module takes care of the splitting and removing newlines
p67773
aVThe syntax error stems from trying close the opening  with a  instead of :
p67774
aVIf you need to collect multiple entries per  value, collect these in a list; a  instance makes that easier:
p67775
as(dp67776
g16
V100297
p67777
stp67778
a((dp67779
g2
(lp67780
VYou probably have at least one empty line in your file (usually the last line); explicitly test for that:
p67781
aVYou may want to look at the  module to read your student records with instead; you'd still need to skip empty lines but the comma-splitting is handled for you
p67782
as(dp67783
g16
V100297
p67784
stp67785
a((dp67786
g2
(lp67787
VThe SQL  clause usually requires 0 or more values listed between parenthesis, not square brackets
p67788
aVYou are generating invalid SQL
p67789
aVYou need to generate the appropriate number of SQL parameters instead of passing in a list here:
p67790
aVwhere  is the list of values you want to test  against, and pass in those parameters as elements of the  list:
p67791
aVThe above query adjustment now generates  for two values,  for just one, and the parameters will be handled correctly by MySQL from that point on
p67792
as(dp67793
g16
V100297
p67794
stp67795
a((dp67796
g2
(lp67797
VYou are running into comparison operator chaining;  does not mean
p67798
aVRather, comparisons are chained and the expression really means:
p67799
aVBecause  is already false, the second half of the chained expression is ignored altogether (since  returns  whatever the value of  would be)
p67800
aVSee the comparisons expressions documentation:
p67801
aVComparisons can be chained arbitrarily, e
p67802
ag1298
aV,  is equivalent to , except that  is evaluated only once (but in both cases  is not evaluated at all when  is found to be false)
p67803
aVFor the record, , , , , , , , ,  and  are all comparison operators (as is the deprecated )
p67804
aVIn general, don't compare against booleans; just test the expression itself
p67805
aVIf you have to test against a boolean literal, at least use parenthesis and the  operator,  and  are singletons, just like :
p67806
aVThis gets more confusing still when integers are involved
p67807
aVThe Python  type is a subclass of 1
p67808
aVAs such,  is true, as is
p67809
aVYou therefor can conceivably create chained operations that almost look sane:
p67810
aVis true because  and  are both true
p67811
aVBut the expression:
p67812
aVis false, because  is false
p67813
aV1  is a subclass of  for historic reasons; Python didn't always have a  type and overloaded integers with boolean meaning just like C does
p67814
aVMaking  a subclass kept older code working
p67815
as(dp67816
g16
V100297
p67817
stp67818
a((dp67819
g2
(lp67820
VThat class takes care of handling new sessions entirely transparently
p67821
aVThe only way you can detect if a session is new is by storing something in the session and test for that:
p67822
aVbecause a new session is always empty, but only if you set values will returning sessions not be empty
p67823
as(dp67824
g16
V100297
p67825
stp67826
a((dp67827
g2
(lp67828
VRemove the  from your code
p67829
aVUse  only to create debug output; you are turning a unicode value into a string that can be pasted back into the interpreter
p67830
aVThis means your line from the file is now stored as:
p67831
aVNote the double backslashes (escaped unicode escapes) and the first string starts with  and the last string ends with
p67832
aVThese values are obviously never equal
p67833
aVRemove the , and use  without arguments to remove the trailing whitespace too:
p67834
aVand your code will work:
p67835
aVYou may need to normalize the input first; some characters can be expressed either as one unicode codepoint or as two combining codepoints
p67836
aVNormalizing moves all such characters to a composed or decomposed state
p67837
aVSee Normalizing Unicode
p67838
as(dp67839
g16
V100297
p67840
stp67841
a((dp67842
g2
(lp67843
VIn Python 3,  returns an iterator type, and like all iterators, can only be iterated over just once
p67844
aVThe  iterator filters values on demand, it doesn't hold any filtered values in memory itself
p67845
aVYou can do the same with the list iterator, returned by :
p67846
aVThis happens because the  method of iterators are expected to raise  once exhausted, then must always raise  from there on out:
p67847
aVOnce an iterator\u2019s  method raises , it must continue to do so on subsequent calls
p67848
aVImplementations that do not obey this property are deemed broken
p67849
aVdoes this correctly:
p67850
aVHere the  function calls the  iterator method, and propagates the exception raised;  on the other hand iterates until , catches that exception and returns a list of whatever elements it managed to receive
p67851
aVFor completeness sake, in Python 2,  (as well as many other built-in functions and methods) returns a , often wasting memory and cycles on building an intermediary list object that was then discarded again after iteration
p67852
aVBy returning an iterator instead, the choice to materialize a list is up to the programmer instead
p67853
as(dp67854
g16
V100297
p67855
stp67856
a((dp67857
g2
(lp67858
VYou'd test for a multiple of 100:
p67859
aVor even just
p67860
aVsince numeric 0 is false in a boolean context
p67861
aVYou can avoid calculating the remainder twice:
p67862
aVThis uses the  operator, which gives you the remainder, a much more efficient method than your  round-about method:
p67863
as(dp67864
g16
V100297
p67865
stp67866
a((dp67867
g2
(lp67868
VYou have set the  of your pig to a string, then when you call  you are trying to add an integer to a string:
p67869
aVThis raises an exception as Python strings are not implicitly converted to numbers, even when their value could be interpreted as a number:
p67870
aVWhen creating the , make sure  in an integer, always
p67871
aVPerhaps you need to explicitly convert in the initializer:
p67872
aVor just make sure your inputs are integers
p67873
as(dp67874
g16
V100297
p67875
stp67876
a((dp67877
g2
(lp67878
VYou are looking for the remainder; use the  operator:
p67879
as(dp67880
g16
V100297
p67881
stp67882
a((dp67883
g2
(lp67884
VYou'd normally keep those values in lists or dictionaries instead:
p67885
aVand keep information like their location with the  objects:
p67886
aVYou can look up variables dynamically, using either the  or  results (both return a mapping) but generally speaking you should avoid such behaviour
p67887
aVIt certainly shouldn't be needed here
p67888
as(dp67889
g16
V100297
p67890
stp67891
a((dp67892
g2
(lp67893
VJust use a list with the possible values of :
p67894
aVThis raises an  exception if  is out of bounds, so greater than 4:
p67895
aVNegative indices would count from the end of the list;  being the last element:
p67896
as(dp67897
g16
V100297
p67898
stp67899
a((dp67900
g2
(lp67901
VYou are writing the string representation of the list to the file
p67902
aVString representations of Python containers use the representation of the contents, not directly write strings
p67903
aVUse the  function to write a sequence of strings:
p67904
aVor write each line separately:
p67905
aVor join the lines into one long string:
p67906
aVThe latter also allows you to add the newlines at the time of writing, by using  as the joining string:
p67907
aVwhere  contains strings without newlines
p67908
as(dp67909
g16
V100297
p67910
stp67911
a((dp67912
g2
(lp67913
VYou would use similar syntax when calling the function:
p67914
aVHere the  before the  list expands the list into separate arguments
p67915
aVThe  list itself contains all arguments found on the command line, including the script name; slicing it from the second item onwards gives you all the options passed in without the script name
p67916
as(dp67917
g16
V100297
p67918
stp67919
a((dp67920
g2
(lp67921
VYou cannot use assignment in an expression
p67922
aVAssignment is itself a statement, and you cannot combine Python statements
p67923
aVThis is an explicit choice made by the language designers; it is all too easy to accidentally use one  and assign, where you meant to use two  and test for equality
p67924
aVMove the assignment into the loop, or assign before the loop, and assign new values in the loop itself
p67925
aVFor your specific example, the Python  module gives you a higher-level API and you'd be looping over the  instead:
p67926
aVI rarely, if ever, need to assign in a loop construct
p67927
aVUsually there is a (much) better way of solving the problem at hand
p67928
as(dp67929
g16
V100297
p67930
stp67931
a((dp67932
g2
(lp67933
VMembership means that a value is in the set:
p67934
aVis True if  is indeed a member of the set
p67935
aVThe term is a mathematical one and basically is synonimous with 'element', which is what most people use when talking about membership in lists and tuples
p67936
aVThe  operator tests for membership, whatever the container you are testing against:
p67937
aVThe operators  and  test for collection membership
p67938
as(dp67939
g16
V100297
p67940
stp67941
a((dp67942
g2
(lp67943
VYou are printing encoded data to your console, without altering the encoding
p67944
aVThe content-type header states the data is encoded in UTF-8, but you are printing it to a console using a Latin codec instead
p67945
aVDecode the data to Unicode first:
p67946
aVYou may not be able to print the resulting Unicode value to your console; if it cannot encode the specific codepoints then you'll get  exceptions
p67947
aVThis is not a problem with the content, but with your console
p67948
as(dp67949
g16
V100297
p67950
stp67951
a((dp67952
g2
(lp67953
VYou need to pass in a dictionary with configuration values, making that one argument:
p67954
aVSee the  documentation
p67955
as(dp67956
g16
V100297
p67957
stp67958
a((dp67959
g2
(lp67960
VNo, the codec at the top only informs Python how to interpret the source code, and uses that codec to interpret Unicode literals
p67961
aVIt does not turn literal bytestrings into unicode values
p67962
aVAs PEP 263 states:
p67963
aVThis PEP proposes to introduce a syntax to declare the encoding of
p67964
aVa Python source file
p67965
aVThe encoding information is then used by the
p67966
aVPython parser to interpret the file using the given encoding
p67967
aVMost
p67968
aVnotably this enhances the interpretation of Unicode literals in
p67969
aVthe source code and makes it possible to write Unicode literals
p67970
aVusing e
p67971
ag1298
aVUTF-8 directly in an Unicode aware editor
p67972
aVEmphasis mine
p67973
aVWithout the codec declaration, Python has no idea how to interpret non-ASCII characters:
p67974
aVIf Python behaved the way you expect it to, you would not be able to literal bytestring values that contain non-ASCII byte values either
p67975
aVIf your terminal is configured to display UTF-8 values, then printing a UTF-8 encoded byte string will look 'correct', but only by virtue of luck that the encodings match
p67976
aVThe correct way to get unicode values, is by using unicode literals or by otherwise producing unicode (decoding from byte strings, converting integer codepoints to unicode characters, etc
p67977
ag4212
aVIn Python 3, the codec also applies to how variable names are interpreted, as you can use letters and digits outside of the ASCII range in names
p67978
aVThe default codec in Python 3 is UTF-8, as opposed to ASCII in Python 2
p67979
as(dp67980
g16
V100297
p67981
stp67982
a((dp67983
g2
(lp67984
VThe  module accepts unicode string values and returns a unicode string in Python 3
p67985
aVYou are giving it binary data instead
p67986
aVDecode to unicode or open the input text file in textmode, and encode the result to ASCII before writing it to a file, or open the output text file in text mode
p67987
aVQuoting from the module documentation:
p67988
aVThe module exports a single function that takes an Unicode object (Python 2
p67989
aVx) or string (Python 3
p67990
aVx) and returns a string (that can be encoded to ASCII bytes in Python 3
p67991
aVx)
p67992
aVEmphasis mine
p67993
aVThis should work:
p67994
aVThis opens the inputfile in text modus (using UTF8 encoding, which judging by your sample line is correct) and writes in text modus (encoding to ASCII)
p67995
aVYou do need to explicitly specify the encoding of the file you are opening; if you omit the encoding the current system locale is used (the result of a  call), which usually won't be the correct codec if your code needs to be portable
p67996
as(dp67997
g16
V100297
p67998
stp67999
a((dp68000
g2
(lp68001
V is a method on list objects, not on dictionaries
p68002
aVTo add a value to a dictionary, you need to assign it to a key:
p68003
aVThere is no Python library that lets you use  on a dictionary
p68004
aVIf  is meant to be a list as well, then make it a list:
p68005
aVbut note that  alters the list in-place, and returns ; trying to print the return value of  will not print the new list
p68006
aVAlso note that  will append the  list as one value, resulting in a nested list
p68007
aVIf you wanted to add the elements of  to , use :
p68008
as(dp68009
g16
V100297
p68010
stp68011
a((dp68012
g2
(lp68013
VYou are using the wrong method to attach the timezone to the  object
p68014
aVAs documented on the  page you want to call that method on the  object, not on the class:
p68015
aVThis works only for already localized  objects (with, say, UTC as the timezone)
p68016
aVAs the same documentation points out, you are better of using the  method on the timezone object:
p68017
aVThis works on naive  objects, and does the correct thing for timezones with historical data too
p68018
aVIf you have mixed data, some with and some without timezones, then you should test for the timezone already being there:
p68019
aVTimestamps that already have a timezone attached will result in timezone-aware  objects and don't need to recast into another timezone
p68020
as(dp68021
g16
V100297
p68022
stp68023
a((dp68024
g2
(lp68025
VFirst of all, you are not writing to a file using a list comprehension
p68026
aVYou are using list comprehensions to build lists of full filepaths instead
p68027
aVThe first list comprehension is applied per directory found by the  method
p68028
aVDepending on how many directories there are below the main  path, it'll be called several times
p68029
aVThe second list comprehension is applied for all directories and files
p68030
aVIt'll be called only once, and build a list of all files in the whole of the   file system structure
p68031
aVIf you wanted the first to give the same result, you'd need to extend a list object:
p68032
aVNow you are not discarding all but the last result of that list comprehension
p68033
as(dp68034
g16
V100297
p68035
stp68036
a((dp68037
g2
(lp68038
VYou cannot select on specific values (or types of values)
p68039
aVYou'd either make a reverse index (map numbers back to (lists of) keys) or you have to loop through all values every time
p68040
aVIf you are processing numbers in arbitrary order anyway, you may as well loop through all items:
p68041
aVotherwise I'd go with the reverse index:
p68042
aVNow you can look up keys by value:
p68043
as(dp68044
g16
V100297
p68045
stp68046
a((dp68047
g2
(lp68048
VThe  function documentation specifically states that absolute paths cause preceding paths to be discarded:
p68049
aVIf any component is an absolute path, all previous components (on Windows, including the previous drive letter, if there was one) are thrown away, and joining continues
p68050
aVYou are joining multiple paths that start with
p68051
aVRemove the initial path separator from anything but the first path element:
p68052
as(dp68053
g16
V100297
p68054
stp68055
a((dp68056
g2
(lp68057
VYou can:
p68058
aVUse a flag variable; you are already using one, just reuse it here:
p68059
aVReturn from a function:
p68060
aVRaise an exception:
p68061
as(dp68062
g16
V100297
p68063
stp68064
a((dp68065
g2
(lp68066
VYou should not use  or  when calling
p68067
aVIn Python 3, a call to  without arguments is equivalent to  (within methods on class ); note the explicit naming of the class
p68068
aVThe Python compiler adds a  closure cell to methods that use  without arguments (see Why is Python 3
p68069
aVx's super() magic
p68070
aVthat references the current class being defined
p68071
aVIf you use  or , you will hit an infinite recursion exception when a subclass tries to call that method; at that time  is the derived class, not the original
p68072
aVSee When calling super() in a derived class, can I pass in self
p68073
aV__class__
p68074
aVSo, to summarize, in Python 3:
p68075
aVis equal to:
p68076
aVbut you should use the former, as it saves you repeating yourself
p68077
aVIn Python 2, you are stuck with the second form only
p68078
aVFor your  method, you'll have to pass in an explicit class from which to search the MRO from, as the Python compiler cannot determine here what class is used when you bind the new replacement :
p68079
aVYou could use  (no ) to have Python provide you with the closure cell, but that'd be a reference to , not  here
p68080
aVWhen you are binding the new , you want the search for overridden methods in the MRO to start searching at  instead
p68081
aVNote that if you now create a class , subclassing from , things will go wrong again, because now you are calling  and in turn call  with , not , as the starting point
p68082
aVYour best bet then is to call  with an explicit class reference
p68083
aVHere  (no ) will do nicely:
p68084
aVNow you have the same behaviour as using  without arguments, a reference to the current class, the one in which you are defining the method , is passed to , making the  behave as if it was defined directly in the class definition of
p68085
aVNote that there is no point in calling  on  here; you didn't override it here, so you can just call  instead
p68086
as(dp68087
g16
V100297
p68088
stp68089
a((dp68090
g2
(lp68091
VLoop over the returned list too (looping directly over a dictionary gives you keys as well):
p68092
aVor more directly using :
p68093
aVList comprehensions let you nest loops; read the above loops as if they are nested in the same order:
p68094
aVOr use :
p68095
aVThe latter takes a sequence of sequences and lets you loop over them as if they were one big list
p68096
aVgives you a sequence of lists, and  puts them together for   to iterate over and build one big list out of them
p68097
aVIf all you are doing is testing for membership among all the values, then what you really want is to a simple way to loop over all the values, and testing your value against each until you find a match
p68098
aVThe  function together with a suitable generator expression does just that:
p68099
aVThis will return  as soon as any value in  has  listed, and stop looping over  early
p68100
as(dp68101
g16
V100297
p68102
stp68103
a((dp68104
g2
(lp68105
VYou are being confused by the behaviour of the  operator; it returns the first expression that only if it is a true value; neither  nor  is true so the second value is returned:
p68106
aVAny value that is not numerical 0, an empty container,  or  is considered true (custom classes can alter that by implementing a  method (python 3),  (python 2) or  (length 0 is empty)
p68107
aVThe second expression is not even evaluated if the first is :
p68108
aVThe  expression would raise a  exception, but is not even evaluated by Python
p68109
aVThis is documented in the boolean operators documentation:
p68110
aVThe expression  first evaluates ; if  is true, its value is returned; otherwise,  is evaluated and the resulting value is returned
p68111
aVSimilarly,  returns the first expression if it is , otherwise the second expression is returned
p68112
as(dp68113
g16
V100297
p68114
stp68115
a((dp68116
g2
(lp68117
VYou cannot refer to a class that doesn't yet exist
p68118
aVWithin the class definition body, the  class is not yet created
p68119
aVAdd the attribute after the class has been created:
p68120
aVNote that you also need to alter the  static method; the class body doesn't form a scope, so you cannot reach  as a non-local from
p68121
aVYou are now, however, repeating yourself a lot
p68122
aVReduce repetition a little by making  a classmethod instead:
p68123
aVor create the default on first call:
p68124
as(dp68125
g16
V100297
p68126
stp68127
a((dp68128
g2
(lp68129
VSince you need to return the remaining list, you should not delete but filter instead:
p68130
aVThis creates a list with all the odd numbers:
p68131
as(dp68132
g16
V100297
p68133
stp68134
a((dp68135
g2
(lp68136
VYou are searching for each list of information separately, there is little question as to why you see each type of information listed separately
p68137
aVYour code is also full of redundancies; you only need to import one version of BeautifulSoup (the first import is shadowed by the second), and you don't need to re-parse the elements 2 times either
p68138
aVYou import two different URL loading libraries then ignore both by loading a local file instead
p68139
aVSearch for the table rows containing the title information instead, then per table row, parse out the information contained
p68140
aVFor this page, with its more complex (and frankly, disorganized) layout with multiple tables, it'd be easiest just to go up to the table row per title link found:
p68141
aVThe  call loops over a generator expression that goes over each parent of the title link until a  element is found
p68142
aVNow you have all the information grouped per title
p68143
as(dp68144
g16
V100297
p68145
stp68146
a((dp68147
g2
(lp68148
VYour  directory is not a package, so you cannot use relative import paths beyond it
p68149
aVYou could add the  directory to your Python module search path, using a relative path from your current script:
p68150
aVNow imports look for modules in the  directory first, so use:
p68151
aVBecause your directory name itself is using only digits, you cannot make that a package anyway; package names must stick to Python identifier rules, which cannot start with a digit
p68152
aVEven if you renamed the directory, and added a  file, you still cannot use it is as package when you run a file within the directory as a script; scripts are always considered to live outside a package
p68153
aVYou'd have to have a top-level 'shim' script that imports the real code from a package:
p68154
as(dp68155
g16
V100297
p68156
stp68157
a((dp68158
g2
(lp68159
VYour error has very little to do with ; the exception is raised because you are trying to concatenate a  GUI object with a string:
p68160
aVis not a string here, it's a  object:
p68161
aVCall  on a  to get the current value instead:
p68162
aVNote that the parenthesis are not needed here, at all
p68163
aVYou also need to set the variable correctly, in :
p68164
as(dp68165
g16
V100297
p68166
stp68167
a((dp68168
g2
(lp68169
VRemove the square brackets; you are not matching a character class:
p68170
aVDemo:
p68171
aVThe one-but last example has no space preceding the opening parenthesis () and thus doesn't match
p68172
aVYou could make the space optional if you need that pattern to work too:
p68173
aVPerhaps matching anything that isn't a closing parenthesis would work for you as well:
p68174
aVThis matches a wider range of characters than just
p68175
aVIn a regular expression, square brackets, , denote a character class; a set of characters to match once
p68176
aVThe class  means: match one character, if it matches the set including a space, an opening parenthesis, all characters of the  class, a  plus, or a closing parenthesis
p68177
as(dp68178
g16
V100297
p68179
stp68180
a((dp68181
g2
(lp68182
VNo, regular expression patterns cannot be 'symbolized'
p68183
aVYou can always do so in Python, of course
p68184
aVthen use string formatting to build the larger pattern:
p68185
as(dp68186
g16
V100297
p68187
stp68188
a((dp68189
g2
(lp68190
VUse the  module to produce JSON output:
p68191
aVThis writes the JSON result directly to the file (replacing any previous content if the file already existed)
p68192
aVIf you need the JSON result string in Python itself, use  (added , for 'string'):
p68193
aVThe  is just Python syntax for a long integer value; the  library knows how to handle those values, no  will be written
p68194
aVDemo string output:
p68195
as(dp68196
g16
V100297
p68197
stp68198
a((dp68199
g2
(lp68200
VYour code to calculate the total skips over the first value; just loop over the list of numbers directly, no need to create a range here:
p68201
aVYou can do this without resorting to sorting; you already have to loop over all the numbers:
p68202
aVI replaced  with  as it comes down to the same thing for numbers
p68203
aVI also started  and  off with the first value in the list of values; the loop will then find any lower or higher values as it goes along
p68204
as(dp68205
g16
V100297
p68206
stp68207
a((dp68208
g2
(lp68209
VYou are enclosing the tablename in quotes; that makes it a string literal in SQL, not a table reference
p68210
aVPerhaps you wanted to use double quotes, backticks or square brackets instead
p68211
aVSee SQL As Understood By SQLite on the SQLite website for a quick overview of the difference:
p68212
aVA keyword in single quotes is a string literal
p68213
aVA keyword in double-quotes is an identifier
p68214
aVA keyword enclosed in square brackets is an identifier
p68215
aVThis is not standard SQL
p68216
aVThis quoting mechanism is used by MS Access and SQL Server and is included in SQLite for compatibility
p68217
aVA keyword enclosed in grave accents (ASCII code 96) is an identifier
p68218
aVThis is not standard SQL
p68219
aVThis quoting mechanism is used by MySQL and is included in SQLite for compatibility
p68220
aVThe following, using string formatting instead of concatenation, should work:
p68221
aVThere is no need to loop over the result rows;  does this for you
p68222
as(dp68223
g16
V100297
p68224
stp68225
a((dp68226
g2
(lp68227
VYou are receiving a JSON value without any newlines; you'll have to manually insert newlines yourself:
p68228
aVI replaced 'html' with 'json' in your code and improved the file handling a little (in the above code the  statement auto-closes the file object for you)
p68229
aVThe code uses string replacement to replace all  strings with , effectively adding in extra newlines the original response did not have
p68230
as(dp68231
g16
V100297
p68232
stp68233
a((dp68234
g2
(lp68235
VThe upcoming 4
p68236
aV0 release of Supervisord will support Python 2 and 3 (3
p68237
aV2 and up)
p68238
aVUntil then, you could use the  fork
p68239
aVOr simply run  with Python 2; your Python 3 codebase is otherwise unaffected, as  is an independent process
p68240
as(dp68241
g16
V100297
p68242
stp68243
a((dp68244
g2
(lp68245
VYou are ignoring the return value of recursive calls
p68246
aVAdd  statements for those:
p68247
aVWithout those s, the  function just ends without returning anything explicitly, resulting in the default return value being returned anyway
p68248
as(dp68249
g16
V100297
p68250
stp68251
a((dp68252
g2
(lp68253
VAre you looking for the product of  with itself, 57 times
p68254
aVdoes that for you:
p68255
aVThis will take a while to print all output, however
p68256
aVIt'll eventually print all 3 ** 57 == 1570042899082081611640534563 possible combinations
p68257
aVDon't try and create a single list with all possible combinations, however
p68258
aVOn a 64-bit machine one of these lists takes 528 bytes, so all lists together take roughly 685719 zetabytes (1 zetabyte is 1024 ** 8 bytes) of memory
p68259
aVTechnology isn't that far along yet
p68260
as(dp68261
g16
V100297
p68262
stp68263
a((dp68264
g2
(lp68265
VYou assigned a float value to :
p68266
aVand then try to use that value as a function with :
p68267
aVThere is more wrong with that line, but lets focus on the  first
p68268
aVIf you meant to use that as a multiplication, do so:
p68269
aVThe parenthesis only serve to confuse here; use them only when you need to group expressions
p68270
aVNote that  is a test for equality; if you wanted to assign then use single  equals:
p68271
aVIf  and  are tuples, you need to apply this to each element of the tuples separately:
p68272
aVwhich for your stated values of ,  gives:
p68273
aVI am not too familiar with how you'd calculate the rotation matrix here; I've paired the  and  tuple elements up for each calculation; but I suspect the calculation is more involved
p68274
aVThe point is more that you cannot just multiply a float with a tuple and hope that the right calculations materialize
p68275
as(dp68276
g16
V100297
p68277
stp68278
a((dp68279
g2
(lp68280
VThere are several problems in your code:
p68281
aVYou can end up trying to access  because  might be true, but you then add 1 before using it as an index
p68282
aVwon't work because  is a string
p68283
aVJust loop over the string directly instead of using a  loop, add up the digits in the loop:
p68284
aVThis handles edge-cases as well:
p68285
as(dp68286
g16
V100297
p68287
stp68288
a((dp68289
g2
(lp68290
VPass in the list of cards as one argument:
p68291
aVDo not use the  syntax;  would apply each card as a separate argument
p68292
aVYou may want to call  just once, and take into account it could be at the end of the list:
p68293
as(dp68294
g16
V100297
p68295
stp68296
a((dp68297
g2
(lp68298
VYou need to generate binary representations that are 8 bits wide;  does not give you that
p68299
aVThe better way to produce these results is to use ; this produces 8-character wide binary representations, padded with 0
p68300
aVMoreover;  would be a much more direct way to get the integer codepoint for a given character:
p68301
aVor, put together using :
p68302
as(dp68303
g16
V100297
p68304
stp68305
a((dp68306
g2
(lp68307
VPut the string in a  object:
p68308
aVAll PIL needs is a file-like object;  provides this source the actual data from the given string
p68309
aVIn the other direction, have  write to a  object, but you do need to specify the format used:
p68310
as(dp68311
g16
V100297
p68312
stp68313
a((dp68314
g2
(lp68315
VUse a conditional expression:
p68316
aVor inverted:
p68317
aVLike , not all expressions are evaluated; in the form , either  or  is entirely ignored (not executed) depending on the outcome of
p68318
aVThis lets you test for specific pre-conditions before calling a method that doesn't exist, for example:
p68319
aVIt does not let you test-and-assign without calling the complicated expression twice, no; you still have to use two statements, and there is no way around that
p68320
as(dp68321
g16
V100297
p68322
stp68323
a((dp68324
g2
(lp68325
VPython presents you with a representation of the byte string that you can copy and paste into a Python interpreter again
p68326
aVIn order to make it readable and survive pasting into something that doesn't handle raw bytes, anything that isn't printable is escaped using a Python byte escape code, , representing the hexademical value for a byte
p68327
aVAnything that is printable, is represented as the ASCII character directly
p68328
aVA hex byte 0x41 is the letter  (capital) in ASCII, and printed as such:
p68329
aVThus,  is hex 2A,  is hex 2F:
p68330
aVYou could use  to generate an all-hexadecimal representation of your bytes:
p68331
aVThat said, you would be better off installing Pillow (the modernized fork of the Python Image Library) and have it handle JPEG images, including extracting EXIF information, for you
p68332
as(dp68333
g16
V100297
p68334
stp68335
a((dp68336
g2
(lp68337
V is exactly what you need here, combined with a generator expression:
p68338
aVThis will stop iterating for the first value where  returns a true value
p68339
aVAs soon as a  value is found, you've proven that there is a value that is true in the input sequence ("is there any value that is true
p68340
aV-> yup, we found at least one)
p68341
aVFor , you'd use  instead:
p68342
aVwhich will return  the moment a  falsey value is found
p68343
aVIf one false value is found, then you have proven that there is at least one value that is not true, so they cannot all be true
p68344
aVNote that these two functions are given a generator expression:
p68345
aVThis is evaluated lazily; every time you ask for the next value of a generator expression, it'll evaluate the loop and execute the  expression once
p68346
aVIt will not produce the whole list at once, it'll produce items one by one
p68347
aVYour  expression has to build the whole input list before it can call
p68348
aVThe  method will process the whole input list, it will not short-circuit, because it has no knowledge of what operation is being applied to the input values
p68349
aVYou could give  a generator expression as well, but it won't stop iterating once the outcome is set (on the first true value for  or the first false value for ), again because  has no specialist knowledge of the operation being performed
p68350
as(dp68351
g16
V100297
p68352
stp68353
a((dp68354
g2
(lp68355
V reverses the list in place and returns
p68356
aVDon't assign the return value back to :
p68357
aVIf you don't want  to be changed in-place, use a negative slice to get a new copy of the list in reverse order:
p68358
aVThis still will result in various problems; your approach won't work as you are altering the list in-place in the  loop
p68359
aVAs you add and remove elements to the list, the iterator does not get updated and the list behaviour will not be what you expect
p68360
aVSay you have a list  after reversal, the pivot being
p68361
aVIn the loop, the iterator used by the  loop looks at , and you'd move  to the end of the list by appending and removing
p68362
aVNow the list looks like  and the loop advances to , so to the  value
p68363
aVhas been skipped altogether
p68364
as(dp68365
g16
V100297
p68366
stp68367
a((dp68368
g2
(lp68369
VYou can use the  renderer here:
p68370
aVUsing the renderer  (a template or a static renderer), render the value (or set of values) using the result of the renderer's  method (usually a string or Unicode) as the response body
p68371
aVFor your code that'd be:
p68372
aVor perhaps:
p68373
as(dp68374
g16
V100297
p68375
stp68376
a((dp68377
g2
(lp68378
VNo, there is no such thing as per-instance properties; like all descriptors, properties are always looked up on the class
p68379
aVSee the descriptor HOWTO for exactly how that works
p68380
aVYou can implement dynamic attributes using a  hook instead, which can check for instance attributes dynamically:
p68381
aVThese attributes are not really dynamic though; you could just set these directly on the instance:
p68382
as(dp68383
g16
V100297
p68384
stp68385
a((dp68386
g2
(lp68387
VYou are splitting  on single spaces, and this can lead to empty values:
p68388
aVIt is the extra empty strings here that cause  to throw an exception:
p68389
aVUse  with no argument instead; extra whitespace is then stripped:
p68390
aVYou have some other problems as well in your code
p68391
aVTake a good look at:
p68392
aVHere,  is not the number of lines in the file
p68393
aVIt is the number of characters in ; both values happen to be , but add or remove some lines from that file and the number will be wrong for the rest of your code
p68394
aVIf you are supposed to keep these numbers together with the names and write out the calculations again, you'll have to do some work keeping the names together
p68395
aVHere is an alternative version to solve the same task:
p68396
as(dp68397
g16
V100297
p68398
stp68399
a((dp68400
g2
(lp68401
V can only work with integers, but dividing with the  operator always results in a float value:
p68402
aVMake the value an integer again:
p68403
aVor use the  floor division operator:
p68404
as(dp68405
g16
V100297
p68406
stp68407
a((dp68408
g2
(lp68409
VYes, the GC is calling the  cleanup hook of the generator, which in turn raises a  in the generator function to exit the generator (by calling )
p68410
aVThis means the context manager  hook will be called whenever a generator function is cleared from memory
p68411
aVYou can manually close the generator yourself first, with :
p68412
as(dp68413
g16
V100297
p68414
stp68415
a((dp68416
g2
(lp68417
VSure, just generate the string in your view:
p68418
as(dp68419
g16
V100297
p68420
stp68421
a((dp68422
g2
(lp68423
VYou are confusing the string representation with the string value
p68424
aVThe double backslash is there to make the string round-trippable; you can paste the value back into Python again
p68425
aVThe actual string itself has just one backslash
p68426
aVTake a look at:
p68427
aVPython escapes the backslash in string literal representations to prevent it from being interpreted as an escape code
p68428
as(dp68429
g16
V100297
p68430
stp68431
a((dp68432
g2
(lp68433
VYou need to encode Unicode explicitly before writing to a file, otherwise Python does it for you with the default ASCII codec
p68434
aVPick an encoding and stick with it:
p68435
aVor use  to create a file object that'll encode for you as you write to the file:
p68436
aVYou may want to read:
p68437
aVThe Python Unicode HOWTO
p68438
aVPragmatic Unicode by Ned Batchelder
p68439
aVThe Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses
p68440
aVby Joel Spolsky
p68441
aVbefore continuing
p68442
as(dp68443
g16
V100297
p68444
stp68445
a((dp68446
g2
(lp68447
VCollect all list values in the dictionary into a set:
p68448
aVthen filter your list on that:
p68449
aVDemo:
p68450
as(dp68451
g16
V100297
p68452
stp68453
a((dp68454
g2
(lp68455
VUse  to interpret strings containing Python literals:
p68456
aVThis is safer that using  as it will refuse to interpret anything that is not a literal value:
p68457
as(dp68458
g16
V100297
p68459
stp68460
a((dp68461
g2
(lp68462
VUse the  or  functions to generate a sequence of integer values based on the tuple length:
p68463
aVThis will loop 3 times, generating the numbers ,  and , which can then be used to generate filenames, etc
p68464
aVgenerates numbers on demand,  generates a list with the numbers first; the former is more memory efficient, the latter gives you a list for further manipulation
p68465
as(dp68466
g16
V100297
p68467
stp68468
a((dp68469
g2
(lp68470
VYou created a class attribute, not an instance attribute
p68471
aVThe dictionary is mutable, you can alter it from instances or on the class directly, but class attributes are by definition shared among all instances
p68472
aVCreate a new empty dictionary in the  method instead:
p68473
as(dp68474
g16
V100297
p68475
stp68476
a((dp68477
g2
(lp68478
VPython lets you unpack sequences on assignment:
p68479
aVThe same can be done in a  loop:
p68480
aVwould print
p68481
aVThe  function produces tuples of two values, the index, and value from the sequence passed in as an argument:
p68482
as(dp68483
g16
V100297
p68484
stp68485
a((dp68486
g2
(lp68487
VNo,  is only the same thing as  itself
p68488
aVEmpty strings are not the same thing:
p68489
aVis a special singleton value (there is only one copy of it in a Python session) signifying 'emptyness', or the lack of a 'proper' value
p68490
aVAs such it is a flag or signal value; Python uses it by convention to signal that a process didn't return anything, for example
p68491
aVBoth  and the empty string are considered false in a boolean context:
p68492
aVas are all empty containers (such as an empty tuple, list or set) and numeric 0 (be it integer, floating point or a complex number)
p68493
aVBeing considered false doesn't make them equal, however
p68494
aVIf you wanted to test for any value that is false, use:
p68495
aVas  interprets the operand in a boolean context and returns the inverse value:
p68496
as(dp68497
g16
V100297
p68498
stp68499
a((dp68500
g2
(lp68501
VUse a list comprehension with a conditional expression:
p68502
aVDemo:
p68503
aVif  is large, you should make it a set instead:
p68504
aVto speed up the membership testing
p68505
aVon a list has linear cost (the more elements need to be scanned, the longer it takes), while the same test against a set takes constant cost (independent of the number of values in the set)
p68506
aVFor your specific example, using a set is already faster:
p68507
aVbut if  ratios  are different and the sizes are small:
p68508
aVThat said, in the general case it is worth your while using sets
p68509
as(dp68510
g16
V100297
p68511
stp68512
a((dp68513
g2
(lp68514
VYou are using conditional expressions without an  part; that's a syntax error
p68515
aVThe correct translation is:
p68516
ag7233
ag1298
aVfilter out anything that doesn't match your two conditions first, and select between the two branches for values that do result in something added to the output
p68517
aVI simplified the conditions; there was some redundant testing in the second expression ( is always true for a loop over  and if  is not  then the inverse  is certainly  as well and doesn't need to be tested for again
p68518
aVPersonally, I find the explicit  loop more readable, but you can at least simplify it in the same manner:
p68519
as(dp68520
g16
V100297
p68521
stp68522
a((dp68523
g2
(lp68524
VThe  method did not find a matching tag, and returned
p68525
aVThe  item access syntax looks for a  method, which is the source of the  here:
p68526
aVTest for  explicitly:
p68527
aVYour exception handling would work too, provided you use parenthesis to group the exceptions:
p68528
aVWithout parenthesis you are telling Python to catch  exceptions and assign the resulting exception object to the local name
p68529
aVThis  syntax has been deprecated because it can lead to exactly your situation, where you think you are catching two exceptions
p68530
aVHowever, your code here should not throw a  exception; that'd be a separate problem better solved by instantiating your variables properly; the following would work just as well here:
p68531
as(dp68532
g16
V100297
p68533
stp68534
a((dp68535
g2
(lp68536
VA  instance has a  method that returns an ordered dictionary:
p68537
aVThis gives you an ordered dictionary with keys and values corresponding to the contents
p68538
aVHowever, it is not clear to me what you are trying to achieve; what exactly is wrong with just selecting the right field directly
p68539
aVor picking out specific fields with :
p68540
as(dp68541
g16
V100297
p68542
stp68543
a((dp68544
g2
(lp68545
VYou created an infinite recursion:
p68546
aVcalls
p68547
aVSee the  there
p68548
aVBut  calls , and nowhere in your code do you break out of that loop
p68549
aVYou need to remove one or the other call here, or determine what the recursive call is supposed to achieve and create conditions where one of the two methods does not call the other
p68550
aVMost likely you don't have to recreate the  from scratch each time you push something on the stack
p68551
aVAlso, if you meant  to be called when the  is clicked (and not when you connect up the action to the button), you need to not call it directly:
p68552
aVNote that now the  method is connected, not the return value
p68553
aVThere is no reason to pass  to  here; that method can access  without the  argument too
p68554
as(dp68555
g16
V100297
p68556
stp68557
a((dp68558
g2
(lp68559
VThis is entirely by design
p68560
aVMethods on classes are attributes on the class too (albeit enhanced by being descriptors as well)
p68561
aVThis is how  would be located too
p68562
aVPython searches attributes first on the instance, then the class, then the base classes of the class
p68563
aVNote that setting  will still set the value on the instance, thereby masking the class attribute
p68564
aVThis lets classes specify default values for attributes, to be replaced by values on the instance later on
p68565
aVThis all doesn't preclude you from accessing  directly and bypass the instance dictionary
p68566
aVIf you wanted to change the shared value, you'd have to assign directly to  for the above reason
p68567
as(dp68568
g16
V100297
p68569
stp68570
a((dp68571
g2
(lp68572
VSQL parameters can only apply to insert data, not table names
p68573
aVThat means parameters are not even parsed for DDL statements
p68574
aVFor that you'll have to use string formatting:
p68575
as(dp68576
g16
V100297
p68577
stp68578
a((dp68579
g2
(lp68580
VYou can use  string formatting instead:
p68581
aVor even just concatenation:
p68582
aVThe  module itself was already present in 2
p68583
ag5740
aVNote that you probably want to use  on the string to make sure that any meta characters are escaped:
p68584
as(dp68585
g16
V100297
p68586
stp68587
a((dp68588
g2
(lp68589
VYou have one large JSON object
p68590
aVParse it in one with :
p68591
aVYour code tries to treat each line as a JSON value; that won't work because  (the first line) is not a complete JSON value, nor would combining the next few lines be
p68592
as(dp68593
g16
V100297
p68594
stp68595
a((dp68596
g2
(lp68597
VYour recursive function returns  for the case where  is not empty and  is
p68598
aVYou'll need to get rid of the  here however, as you are going to end up adding to that value whatever you return from recursive calls
p68599
aVThat'll only lead to doubling the value
p68600
aVAt most, make  a parameter to the function to pass along the value to recursive calls
p68601
aVYou didn't provide us with sample input and output, so it is very hard to determine what you are trying to achieve with the function
p68602
aVLast, but not least, the  branch will never be executed, as one of  and  will always be
p68603
as(dp68604
g16
V100297
p68605
stp68606
a((dp68607
g2
(lp68608
VIf you are getting a 401 response from Google, authorization failed
p68609
aVThe documented authorization troubleshooting page states the following reasons for such a failure:
p68610
aVAuthorization header missing or with invalid syntax
p68611
aVInvalid project number sent as key
p68612
aVKey valid but with GCM service disabled
p68613
aVRequest originated from a server not whitelisted in the Server Key IPs
p68614
aVMake sure that your key is valid, enabled, and that your IP address(es) are correctly whitelisted
p68615
aVThe IP address is the address the Google services see when your Django server contacts the API
p68616
as(dp68617
g16
V100297
p68618
stp68619
a((dp68620
g2
(lp68621
VThe most efficient way is to use  to turn a sequence of characters into a new string:
p68622
aVThis avoids creating a new string object every iteration of the loop; instead, the new string is created once
p68623
as(dp68624
g16
V100297
p68625
stp68626
a((dp68627
g2
(lp68628
VYou would use  to combine  and , and  and , together with  to generate new sequences:
p68629
aVDemo:
p68630
aVIf ,  and  are particularly large, or if for certain values of  times 10 lead to a lot of repetitions and you only need to process these values one by one (e
p68631
ag1298
aVyou don't need to materialize the whole  and  lists in memory), you could use more  functions here:
p68632
aVNote the lack of  here; now each stage is handled by iterators producing only enough to satisfy one step at a time, saving on memory
p68633
aVUse this if you need if you only need to iterate over the output once; if your plot library takes a general iterable for plotting these should work just fine
p68634
as(dp68635
g16
V100297
p68636
stp68637
a((dp68638
g2
(lp68639
VThe  function only works for objects that support the buffer protocol:
p68640
aVThe object argument must be an object that supports the buffer call interface (such as strings, arrays, and buffers)
p68641
aVNote that the function is actually deprecated; it has been largely replaced by , returning a   type
p68642
aVThis still will not give you insight into the internal structure of a Python long integer however, as that function only works with objects supporting the buffer protocol still
p68643
aVThe Python 3 documentation contains more information about the buffer protocol in the C API documentation:
p68644
aVCertain objects available in Python wrap access to an underlying memory array or buffer
p68645
ag15438
aVWhile each of these types have their own semantics, they share the common characteristic of being backed by a possibly large memory buffer
p68646
aVIt is then desirable, in some situations, to access that buffer directly and without intermediate copying
p68647
aVSo these functions are meant to make access to larger chunks of data efficient, not to give you insight into underlying C structures
p68648
as(dp68649
g16
V100297
p68650
stp68651
a((dp68652
g2
(lp68653
VYou need to call the original ; using  calls the top-level  and creates an infinite recursion
p68654
aVDo this:
p68655
aVNote that the built-in Python  type already has support for your use-case; if you define a  method it'll be called automatically:
p68656
aVThis is what  does, provide a  method that calls a provided factory method:
p68657
as(dp68658
g16
V100297
p68659
stp68660
a((dp68661
g2
(lp68662
VYou need to make the  non greedy by adding a  to the  quantifier:
p68663
aVNow the  matches the minimum number of characters that satisfies the pattern, rather than the default maximum
p68664
aVNot sure why you use string interpolation here, though; for static characters, just use:
p68665
aVYou could also capture all characters that do not match the end character:
p68666
aVHere  forms a character class matching any character that is not in the class; so any character that is not  would qualify
p68667
as(dp68668
g16
V100297
p68669
stp68670
a((dp68671
g2
(lp68672
VIf  is  then the  line would not be executed
p68673
aVProvided there is no other code following the code you posted, Python will exit normally, which means the exit code will be , the same as if  had been called without an argument
p68674
aVExit code meanings are a convention; 0 means success, anything else usually means there was a problem
p68675
aVExplicitly exiting the program with  simply means the program adheres to that convention; it is signalling something to whatever started the script, namely that things didn't work out
p68676
aVSome programs use exit codes for more than just failure communication; exit codes can be used to communicate a range of states, but that is entirely up to the program
p68677
aVCheck the documentation to be sure what status codes mean, status codes are not really standardized, it is all more of a
p68678
aVguideline
p68679
aVTLDR: the default exit code for most programs is , meaning succes, and Python is no exception
p68680
as(dp68681
g16
V100297
p68682
stp68683
a((dp68684
g2
(lp68685
VYou can set the default to :
p68686
aVHere the default for  is , and  is set to  if left to the default value
p68687
aVIf you need to accept  as well, pick a different, unique default to act as a sentinel
p68688
aVA singleton instance of  is an oft-used convention:
p68689
aVNow you can call  and  will be set to , call it without specifying  (e
p68690
ag1298
aVor , and  will be set to whatever  was set to
p68691
aVUnless a parameter has a default (e
p68692
ag1298
aVis a keyword parameter), they are required
p68693
as(dp68694
g16
V100297
p68695
stp68696
a((dp68697
g2
(lp68698
VNot with  formatting, no, that is not expandable
p68699
aVYou can specify different formatting options when using the newer format string syntax defined for  and
p68700
aVCustom types can implement a  method, and that will be called with the format specification used in the template string:
p68701
aVThis does require that you use a custom type for your strings:
p68702
aVFor most cases, it is easier just to format the string before handing it to the template, or use a dedicated HTML templating library such as Chameleon, Mako or Jinja2; these handle HTML escaping for you
p68703
as(dp68704
g16
V100297
p68705
stp68706
a((dp68707
g2
(lp68708
VThere will be 5 copies
p68709
aVThe  call returns the one copy of the string, it doesn't magically make all future strings with the same content interned
p68710
aVI would not use interning for file data, however
p68711
aVThe biggest advantage of interning strings is in performance-critical sections, where you need your dictionary lookups to be as fast as can be
p68712
aVInterning allows you to skip the equality test when pointer arithmetic can be used instead
p68713
aVInterning has a performance penalty too; each time you call  the string is tested against an internal dictionary to see if the string was already interned
p68714
aVThis requires a hash call and 0 or more equality tests (0 if the string wasn't interned before and there are no hash collisions, more than one in case there are collisions)
p68715
aVCalling  for each and every line in a string is going to be slowed down by these operations, and only if you have a massive amount of repetition I don't think the memory gains will be all that great
p68716
as(dp68717
g16
V100297
p68718
stp68719
a((dp68720
g2
(lp68721
VPython Script can use a special function  to work around the restrictions set on types:
p68722
aVwhere we use the literal empty list notation, not the  type itself (since that has been reassigned)
p68723
as(dp68724
g16
V100297
p68725
stp68726
a((dp68727
g2
(lp68728
VYou are giving your function default parameters:
p68729
aVThese are evaluated when the function object is created, but at that time you have no  object yet
p68730
aVYou don't have to give these parameters default values, and you don't appear to use the values you do give
p68731
aVIf you don't need default values, use:
p68732
aVIf you do need a default value for , move the parameter to the end:
p68733
aVand adjust your function call accordingly:
p68734
aVNote that you don't have to name parameters either; positional parameters work by position, and in this case  is optional too
p68735
as(dp68736
g16
V100297
p68737
stp68738
a((dp68739
g2
(lp68740
VYou were almost there; you are printing the number  over and over again, instead of using , which ranges from 0 through to 4 in the first loop, 0 to 3 in the second, etc
p68741
aVYou want to print  itself, but either add one or adjust the range in which it loops to run from 1 to :
p68742
aVor use:
p68743
aVDemo:
p68744
aVThe other approach would be to use a string  and indexing into that;  is , etc:
p68745
aVbut then you can just use slicing and get rid of the nested loop altogether:
p68746
aVbecause  returns the first 3 characters of the string, printing
p68747
as(dp68748
g16
V100297
p68749
stp68750
a((dp68751
g2
(lp68752
VYou can use a dictionary and list comprehension combined:
p68753
aVThis creates a new dictionary with each key and value copied, but the values filtered to only contain values that are not empty strings:
p68754
aVIf you are using Python 2, you may want to use  instead for a more efficient loop
p68755
aVYour loop was almost there, you just forgot to assign back to a dictionary:
p68756
as(dp68757
g16
V100297
p68758
stp68759
a((dp68760
g2
(lp68761
VNo, this package is not Python 3 compatible
p68762
aVIt is using relative imports:
p68763
aVwhere the second  is meant to be
p68764
aVInstead, Python 3 sees it as an absolute package and the recursive import fails to find the  name
p68765
as(dp68766
g16
V100297
p68767
stp68768
a((dp68769
g2
(lp68770
VYou need to subtract the hours before formatting the time
p68771
aVThis is much easier using the  package:
p68772
aVbut you can do it with the  module too, provided you subtract seconds:
p68773
as(dp68774
g16
V100297
p68775
stp68776
a((dp68777
g2
(lp68778
VYou need to use string formatting to show positive signs, or explicitly use  in the string:
p68779
aV(which leaves the values as floats but formats without the decimal point), or
p68780
aVThe  only shows because negative values are always printed with their sign
p68781
as(dp68782
g16
V100297
p68783
stp68784
a((dp68785
g2
(lp68786
VYou are not closing the file; you are merely referring to the close method
p68787
aVCall it:
p68788
aVWithout closing the file buffers won't be flushed until Python exits
p68789
aVA better way to handle file closing is to use the  statement:
p68790
aVNow the file is closed automatically
p68791
as(dp68792
g16
V100297
p68793
stp68794
a((dp68795
g2
(lp68796
VThe  package is closely tied to specific versions of Django; the latest package requires Django 1
p68797
ag400
aV2 or newer and that is stated in the requirements:
p68798
aVand on the PyPI page:
p68799
aVThe current version of the Debug Toolbar is 0
p68800
aV11
p68801
ag2391
aVIt works on Django 1
p68802
aV4, 1
p68803
aV5 and 1
p68804
ag5279
aVYou need to install an older version of the package; 0
p68805
aV10
p68806
aV0 upgraded the minimum version requirement from Django 1
p68807
aV3 to 1
p68808
aV4, so 0
p68809
ag2392
aV4 is the most recent version that still works with your older Django setup:
p68810
as(dp68811
g16
V100297
p68812
stp68813
a((dp68814
g2
(lp68815
VThe  list should contain fully qualified host names, not urls
p68816
aVLeave of the port and the protocol
p68817
aVI'd add  too:
p68818
aVYou could also use  to match any host:
p68819
aVQuoting the documentation:
p68820
aVValues in this list can be fully qualified names (e
p68821
ag1298
aV), in which case they will be matched against the request\u2019s  header exactly (case-insensitive, not including port)
p68822
aVA value beginning with a period can be used as a subdomain wildcard:  will match , , and any other subdomain of
p68823
aVA value of  will match anything; in this case you are responsible to provide your own validation of the  header (perhaps in a middleware; if so this middleware must be listed first in )
p68824
aVBold emphasis mine
p68825
aVThe status 400 response is due to a  exception being raised when your host header doesn't match any values in that list
p68826
as(dp68827
g16
V100297
p68828
stp68829
a((dp68830
g2
(lp68831
V is always bytes only, as are URLs and query strings
p68832
aVYou need to decode such information in your own code:
p68833
aVThis is fundamental to how streams (network connections, files, pipes, etc
p68834
aVwork; they always contain bytes
p68835
aVThose bytes can be interpreted in different ways, if you they contain Unicode values, you need to explicitly decode them
p68836
as(dp68837
g16
V100297
p68838
stp68839
a((dp68840
g2
(lp68841
VYour key is  or a similar value; an object with no ordering of its own
p68842
aVmake sure that  is an orderable type (such as an integer or string)
p68843
as(dp68844
g16
V100297
p68845
stp68846
a((dp68847
g2
(lp68848
VPython 3 renamed the  type to , the old  type has been replaced by
p68849
aVYou may want to read the Python 3 porting HOWTO for more such details
p68850
aVThere is also Lennart Regebro's Porting to Python 3: An in-depth guide, free online
p68851
aVLast but not least, you could just try to use the  tool to see how that translates the code for you
p68852
as(dp68853
g16
V100297
p68854
stp68855
a((dp68856
g2
(lp68857
V is not a valid column identifier
p68858
aVEither put the name in double quotes, square brackets or backticks, or remove the :
p68859
aVshould all work
p68860
as(dp68861
g16
V100297
p68862
stp68863
a((dp68864
g2
(lp68865
VUse :
p68866
aVYou can only assign an iterable to a slice; something with 0 or more values, not one specific value
p68867
aVI'd not pre-build the list then replace everything; just do:
p68868
aVand extend the list with  using  with a generator:
p68869
aVNow you have a list of length
p68870
as(dp68871
g16
V100297
p68872
stp68873
a((dp68874
g2
(lp68875
VYou re-open the file for writing each loop iteration, which clears the file each time
p68876
aVMove the file opening out of the loop:
p68877
aVOpening a file in  mode explicitly truncates it (removes all data)
p68878
aVQuoting the  function documentation:
p68879
aVOther common values are  for writing (truncating the file if it already exists) [
p68880
aVIf you have to open a file for each iteration, at the very least open the file for appending instead, using :
p68881
as(dp68882
g16
V100297
p68883
stp68884
a((dp68885
g2
(lp68886
V is a list of dictionaries, not one dictionary
p68887
aVBy using  you keep adding new dictionaries to that list
p68888
aVMake it a dictionary instead, then assign to keys on that dictionary:
p68889
aVNote that there is no point in looping over the whole  keys to see if a key is in it when you can just use , a much faster method
p68890
aVThe  expression at the end replaces the  expression in your code
p68891
as(dp68892
g16
V100297
p68893
stp68894
a((dp68895
g2
(lp68896
VYou'll have to capture the return values first, then append:
p68897
aVYou appear to be returning lists here, are you certain you don't mean to use  instead
p68898
aVIf you were extending  and , you could use slice assignments:
p68899
aVbut this is a) surprising to newcomers and b) rather unreadable in my opinion
p68900
aVI'd still use the separate assignment, then extend calls:
p68901
as(dp68902
g16
V100297
p68903
stp68904
a((dp68905
g2
(lp68906
V is the same thing as :
p68907
aVYou probably want to decode your input to unicode and insert that instead
p68908
aVIf your data is encoded to Latin 1 then decode:
p68909
aVcan handle unicode just fine, and by decoding you make sure you are handling text values, not byte values, which can differ from codec to codec
p68910
as(dp68911
g16
V100297
p68912
stp68913
a((dp68914
g2
(lp68915
VIt is ; there are no nested loops here
p68916
aVThis can be reduced to the cost for the larger number; asymptotically, the smaller loop is not going to matter, making it
p68917
aVFirst you loop over  elements ( iterations), then separately you loop over  elements
p68918
as(dp68919
g16
V100297
p68920
stp68921
a((dp68922
g2
(lp68923
V takes an element name, not an expression
p68924
aVIt is highly unlikely that there are tags in the page you are loading that contain  tags
p68925
aVIf you are loading HTML, use a HTML parser instead, like BeautifulSoup
p68926
aVFor XML, using the ElementTree API is a lot easier than using the (archaic and very verbose) DOM API
p68927
aVNeither approach requires that you first save the source to disk, both APIs can parse directly from the response object returned by
p68928
aVor
p68929
as(dp68930
g16
V100297
p68931
stp68932
a((dp68933
g2
(lp68934
VPython operators are not objects
p68935
aVThey are syntax
p68936
aVYou cannot refer to them with variables, and you cannot compare them from within Python
p68937
aVYou'd read the operator precedence documentation instead
p68938
aVPrecedence is fixed by the compiler, not a dynamic aspect of the language
p68939
aVProgramming language operator precedence has been largely standardized; Python adheres to the PEMDAS order, for example
p68940
as(dp68941
g16
V100297
p68942
stp68943
a((dp68944
g2
(lp68945
V is the exponent operator
p68946
aVshifts bits to the left
p68947
aVBecause of the nature of binary numbers, for ever step shifting bits to the left doubles the number
p68948
aVAs such you can express the same operation as 2 to the power number-of-shifts minus one:
p68949
aVThe exponent operator serves to produce exponents of more than just the number 2, however:
p68950
aVNote however that  is still two, but shifting to once to the left () is equivalent to :
p68951
as(dp68952
g16
V100297
p68953
stp68954
a((dp68955
g2
(lp68956
VInstead of reinventing the wheel, use the  package instead
p68957
aVLike libgdx, it implements the UBJSON standard, in Python
p68958
aVIf you are curious how it implements the binary format, the source code is available on GitHub for you to study
p68959
as(dp68960
g16
V100297
p68961
stp68962
a((dp68963
g2
(lp68964
VYou forgot to call the  method:
p68965
aVNote the  after ;  is not an attribute, it is a method
p68966
aVUsing a  is an excellent method to turn data already in dictionary format into CSV data
p68967
as(dp68968
g16
V100297
p68969
stp68970
a((dp68971
g2
(lp68972
VUse the  module to turn the Python data into JSON data; JSON is a subset of JavaScript and does fine as a JavaScript literal:
p68973
aVand render the  in the template
p68974
as(dp68975
g16
V100297
p68976
stp68977
a((dp68978
g2
(lp68979
VUse :
p68980
aVThe  call makes sure all values are strings first
p68981
aVDemo:
p68982
as(dp68983
g16
V100297
p68984
stp68985
a((dp68986
g2
(lp68987
VYou set  to the length of the line; but indexing goes to , because Python uses 0-based indexing
p68988
aVSubtract 1:
p68989
aVThis will still throw an  if there are more than 5 elements in  as  only has 5 characters
p68990
aVIt'd be easier if you used ,  and a  loop:
p68991
aVNow you are guaranteed to not run into indexing problems
p68992
as(dp68993
g16
V100297
p68994
stp68995
a((dp68996
g2
(lp68997
VFirst of all: your algorithm is fundamentally flawed; you cannot sort the list this way
p68998
aVYou are going to skip elements as you process the list, for two reasons:
p68999
aVYou discard the previous value of  without ever appending it
p69000
aVThis is why you skip
p69001
aVYou are altering the list while iterating
p69002
aVWhen processing , you remove it from the list
p69003
aVThe loop was looking at the second item in the list, but removing  alters the list from  to  after which the loop continues to the third item, now
p69004
aVYou skipped  there
p69005
aVAs to why your algorithm won't work: think about how your algorithm would handle a list with the smallest value already at start, like
p69006
as(dp69007
g16
V100297
p69008
stp69009
a((dp69010
g2
(lp69011
VUse the right tool for the job; parse a query string using the  module:
p69012
aVThis sets  to  if there was no  element in the url query string, the URL value otherwise
p69013
aVDemo:
p69014
as(dp69015
g16
V100297
p69016
stp69017
a((dp69018
g2
(lp69019
VYou need to read the tutorial more thoroughly
p69020
aVis a template placeholder, it is not itself JSON (and nowhere close to valid)
p69021
aVFurther in the tutorial the placeholder is filled in when rendering the template:
p69022
aVThe  key in the  dictionary provides the value to be filled in; the  method generates the JSON value:
p69023
aVThe method returns a JSON value, which replaces the  placeholder string
p69024
as(dp69025
g16
V100297
p69026
stp69027
a((dp69028
g2
(lp69029
VYour class is called  (note the capitalisation), not
p69030
aVEither fix your import:
p69031
aVor the classname:
p69032
as(dp69033
g16
V100297
p69034
stp69035
a((dp69036
g2
(lp69037
VUse the  module for CSV files:
p69038
aVwhere the  class automatically uses the first row of headers as keys for the rest of the file
p69039
aVOr use:
p69040
aVif all you have are 3 columns, country, area and population, in that order
p69041
as(dp69042
g16
V100297
p69043
stp69044
a((dp69045
g2
(lp69046
VYou misspelled your function name:
p69047
aVshould be:
p69048
aVYou transposed the  and
p69049
aVYou did so again in your question title and comment, where you spelled  (note the  at the start instead of a )
p69050
aVNote that  is a local variable in  and won't be accessible outside of the function
p69051
aVUse  to return it instead and assign the returned value or print it directly
p69052
aVGive your function parameters too, that is a better practice than to treat ,  and  as globals:
p69053
as(dp69054
g16
V100297
p69055
stp69056
a((dp69057
g2
(lp69058
VYou need to pass on  to recursive calls; local variables do not magically transfer to new function invocations:
p69059
aVI addressed various other issues with the code:
p69060
aVUse descriptive function and argument names
p69061
aVis not a great name
p69062
aVUse a list to build up elements of a string, then use ; it is faster than building up strings by concatenation
p69063
aVOnly increment the depth counter when recursing, not for every element in current level of the list
p69064
aVUse  to test for specific types
p69065
aVString formatting makes it a little easier to build strings together with constant elements, such as a space and a newline
p69066
aVDemo:
p69067
as(dp69068
g16
V100297
p69069
stp69070
a((dp69071
g2
(lp69072
VYou forgot to add the last closing parenthesis on the preceding line:
p69073
aVAlso, you didn't define the function
p69074
aVNot that it is needed,  returns a string already
p69075
aVAfter that, I see an error for , but presumably you have that list defined outside of the code posted here
p69076
as(dp69077
g16
V100297
p69078
stp69079
a((dp69080
g2
(lp69081
VYou are printing  objects
p69082
aVDecode them to strings:
p69083
aVor decode the HTML page you retrieved:
p69084
aVand use a unicode string regular expression:
p69085
aVMany webpages do not send a proper charset parameter in the content-type header, or set it wrong, so even the 'sensible default' can be wrong from time to time
p69086
aVA HTML parsing library like BeautifulSoup would do a better job of codec detection still, it includes some more heuristics to make an educated guess:
p69087
as(dp69088
g16
V100297
p69089
stp69090
a((dp69091
g2
(lp69092
VRebinding is not the same thing as clearing a mutable value
p69093
aVYou will have to clear the dictionary and give it new keys and values:
p69094
aVNames (variables) are just references to objects, and assigning a new dictionary to the local name  rebinds the name to the new object; the previous object is always unaffected
p69095
aVYou could make  a global, so that you'd rebind the global name to a new dictionary, but any other, remaining references would still point to an unaltered original dictionary
p69096
aVClearing the actual dictionary object would work regardless of the number of references pointing to it
p69097
as(dp69098
g16
V100297
p69099
stp69100
a((dp69101
g2
(lp69102
VYou can store the result of  in a local name:
p69103
as(dp69104
g16
V100297
p69105
stp69106
a((dp69107
g2
(lp69108
VYou can use a regular expression to remove all non-vowels at the start of a word:
p69109
aVDemo:
p69110
aVThe  negative class matches anything that is not a vowel (with the  flag making sure it'll ignore case)
p69111
aVThe  anchor matches the position in a string just before or after a word
p69112
aVThe  makes the  In the example above,  matches the start, and the negative class matches the  characters, as they are not in the class
p69113
as(dp69114
g16
V100297
p69115
stp69116
a((dp69117
g2
(lp69118
VYou are not comparing
p69119
aVYou are comparing:
p69120
aVNote the names, you are indexing into the same structure here
p69121
aVIf  that is guaranteed to be comparing the same object even, but it'll be True for any repeated hash values
p69122
aVPerhaps you instead meant:
p69123
aVIf all you do is increment  and  at the same time and they remain equal, you could just as well use  here:
p69124
as(dp69125
g16
V100297
p69126
stp69127
a((dp69128
g2
(lp69129
VWhenever your first variable changes, the trace is triggered, but the second value is still empty
p69130
aVAn empty string is not an integer, and the exception is thrown
p69131
aVIn this case, I'd catch that exception and simply return, until both variables hold proper integers:
p69132
as(dp69133
g16
V100297
p69134
stp69135
a((dp69136
g2
(lp69137
VTurn it around; remove the urls:
p69138
aVDemo:
p69139
aVThe expression looks for anything that starts with  or , and removes that anything after that is not a hash or space, including an optional hash
p69140
as(dp69141
g16
V100297
p69142
stp69143
a((dp69144
g2
(lp69145
VThey indeed do the same thing, but you cannot use a variable with the attribute setting syntax, while you can do that with
p69146
aVIn other words, this works:
p69147
aVbut this doesn't:
p69148
aVUse  for dynamic attribute setting, where the name of the attribute is taken from a variable
p69149
aVUse  for static attributes, where you know the name beforehand
p69150
aVIn addition, the attribute access syntax is limited to proper Python identifiers, while  can use any string
p69151
aVThis means that you can use:
p69152
aVwhere attempting that with static attributes will not work because Python identifiers do not allow for spaces, and cannot start with digits
p69153
as(dp69154
g16
V100297
p69155
stp69156
a((dp69157
g2
(lp69158
VNo, your diagnosis is not correct, there is not infinite exception loop here
p69159
aVEach URL is an entirely separate exception
p69160
aVThe  variable won't update whenever you have an exception, perhaps that is giving you the impression that you end up in a exception loop
p69161
aVEither move the  line out of the  statement, or use  to generate a counter for you
p69162
aVThat said, why are you trying to parse multiple HTML pages with one parser instance
p69163
aVMost likely the exception you keep getting is that a specific page is malformed and put the parser into a state it cannot continue from
p69164
as(dp69165
g16
V100297
p69166
stp69167
a((dp69168
g2
(lp69169
VYou were so close:
p69170
aVYou need to multiply the  value, not the return value of the  function
p69171
as(dp69172
g16
V100297
p69173
stp69174
a((dp69175
g2
(lp69176
VYou cannot call the nested functions
p69177
aVThey are local to  only
p69178
aVEither move their definition out of  to make them global names, call them inside of , or return them so that anyone calling  can obtain references to the function objects
p69179
aVFunction objects inside another function are like any other local variable, private to the function only
p69180
aVAs globals:
p69181
as(dp69182
g16
V100297
p69183
stp69184
a((dp69185
g2
(lp69186
VNo, the order of attributes is normally not guaranteed, as Python stores attributes in a dictionary
p69187
aVInstead,  uses special tricks to detect in what order fields were defined, that work around this
p69188
aVEvery time you create a  object, a counter is incremented and a unique number is assigned to the field instance
p69189
aVThis makes the objects orderable:
p69190
aVSo the  instances have a  value that is incremented each time a new field is added to a form
p69191
aVThe  class then uses that value on the fields to sort them in the correct order:
p69192
as(dp69193
g16
V100297
p69194
stp69195
a((dp69196
g2
(lp69197
VYou have a directory named  in your path somewhere
p69198
aVRemove or rename this directory, it is masking the actual pygame package
p69199
aVIf you use  it'll tell you where the directory was found; in the above example it was found relative to the current directory ()
p69200
as(dp69201
g16
V100297
p69202
stp69203
a((dp69204
g2
(lp69205
VYes, Python evaluates expressions from left to right
p69206
aVThe functions will be called in the same order
p69207
aVFrom the reference documentation:
p69208
aVPython evaluates expressions from left to right
p69209
aVMoreover,  will not be called if  returned a false value, both when using  and when nesting  expressions
p69210
aVQuoting the boolean operations documentation:
p69211
aVThe expression  first evaluates ; if  is false, its value is returned; otherwise,  is evaluated and the resulting value is returned
p69212
aVBecause in the expression ,  will not be evaluated if  returned a false value,  is not called at all
p69213
aVYou could use a third alternative here using the  function:
p69214
aVwhich would again only call functions as long as the preceding function returned a true value and call the functions in order
p69215
aVThe  approach does require that , , , and  are all actually defined before you call , while the nested  or  expression approaches only require functions to be defined as long as the preceding function returned a true value
p69216
as(dp69217
g16
V100297
p69218
stp69219
a((dp69220
g2
(lp69221
VNo, unicode values are not allowed in , because in Python 2 names are strings, not unicode values
p69222
aVYour indeed have to encode all strings in  or not use unicode literals
p69223
aVYou could do so as a separate step:
p69224
aVIn Python 3, variable names are unicode values too, so there  is expected to have unicode strings
p69225
as(dp69226
g16
V100297
p69227
stp69228
a((dp69229
g2
(lp69230
VYou switch the wrong lights; you are using , not , the loop counter, so you are always switching the wrong lights
p69231
aVYou need to start counting at 1, and count up to  (so range to `n + 1)
p69232
aVYour indentation is wrong; you return too early
p69233
aVUnindent the  statement to not be part of the loop
p69234
aVI'd also make the  value part of the function itself, don't use a global here, as it'll be mutated each time you call the function, making it harder to test the function itself
p69235
aVLast but not least, there is no need to increment  manually, that's what the  loop is already doing for you:
p69236
aVNow this works as expected:
p69237
as(dp69238
g16
V100297
p69239
stp69240
a((dp69241
g2
(lp69242
V matches letters and digits (as well as underscores)
p69243
aVUse  if you want to match only letters:
p69244
aVwhich matches a letter or digit (or an underscore), then a letter, then 3 digits
p69245
aVDemo:
p69246
aVIf the underscore is a problem, use:
p69247
as(dp69248
g16
V100297
p69249
stp69250
a((dp69251
g2
(lp69252
VThe caught exception is assigned to the name
p69253
aVYou can pick any valid Python identifier:
p69254
aVThis lets you use the caught exception; perhaps to print the error message, or use attributes of the exception for other purposes
p69255
aVSee the Handling Exceptions chapter of the Python tutorial
p69256
aVThe  syntax has been deprecated in favor of:
p69257
aVwhich is much more readable and avoids the confusion with the syntax to catch multiple exception types:
p69258
aVSince the function you posted otherwise doesn't use , it can be safely removed altogether:
p69259
as(dp69260
g16
V100297
p69261
stp69262
a((dp69263
g2
(lp69264
VYou are calling a function that does not return anything explicitly
p69265
aVThe default return value of such a function is
p69266
aVSimply don't print the return value of the function:
p69267
as(dp69268
g16
V100297
p69269
stp69270
a((dp69271
g2
(lp69272
VThe  directory is a cache for byte-compiled files and will be re-built when you import the package
p69273
aVThe  file on the other hand is what makes a directory a module
p69274
aVIf it was initially empty, simply recreate it in the  directory for the imports to work again
p69275
aVNote that  would not have been inside the  directory
p69276
aVIf  was more than just an empty 'make this a package' file, then you have to recreate that code from scratch or restore the file from a backup
p69277
as(dp69278
g16
V100297
p69279
stp69280
a((dp69281
g2
(lp69282
VYou could use  to create columns:
p69283
aVDemo:
p69284
aVThis does assume that the value lists are all of equal length; if not the shortest row will determine the maximum number of rows printed
p69285
aVUse  to print more:
p69286
aVDemo:
p69287
aVYou may want to use  to align the columns along tab stops
p69288
as(dp69289
g16
V100297
p69290
stp69291
a((dp69292
g2
(lp69293
VFor at least one  tag found,  is a  object, not text
p69294
aVFor the specific URL you found, it's a  tag:
p69295
aVWhy not use  instead of
p69296
as(dp69297
g16
V100297
p69298
stp69299
a((dp69300
g2
(lp69301
VBy using the same syntax when applying the  sequence:
p69302
aVThe  syntax here is closely related to the  function parameter syntax; instead of capturing an arbitrary number of arguments, using  in a call expands the sequence to separate arguments
p69303
aVYou may be interested to know that there is a  syntax too, to capture and apply keyword arguments:
p69304
as(dp69305
g16
V100297
p69306
stp69307
a((dp69308
g2
(lp69309
VYou are trying to use  as an integer:
p69310
aVby adding  to it, but you made it a string:
p69311
aVMake all your inputs integers instead:
p69312
aVNext, your  loop clobbers the  variable:
p69313
aVIt isn't clear what you want to do in the loop, but the sum of , ,  and  is now lost as  is used as a loop variable too
p69314
aVIf you wanted to have decimals, you can use  instead of , but note that  can only work with integers
p69315
aVIf you wanted to print the 4 numbers in a loop, then create a list first and loop directly over the list:
p69316
aVor combine looping with asking for the number and printing it:
p69317
aVThis asks for a number four times, prints the given number, and then adds that number to a list for later use
p69318
as(dp69319
g16
V100297
p69320
stp69321
a((dp69322
g2
(lp69323
VYou are not passing in your variables correctly
p69324
aVcreates two new keyword arguments; effectively setting the  argument of the  method to:
p69325
aVwith the  value being a set, not a dictionary
p69326
aVIn the  method you are using the default values for  and  instead, because you never gave specific arguments for those two values
p69327
aVUse:
p69328
aVto create your thread subclass instances, passing in the  and  values to the keyword arguments explicitly
p69329
aVIf you don't plan on specifying the rest of the  arguments, you can leave those out altogether, as the  class itself already has defaults for these:
p69330
aVNote that the  is not required here either
p69331
aVYou can always add arguments back in, or just use:
p69332
aVto pass any extra keyword arguments on to the  method, allowing you to create a new  instance adding in keyword arguments such as  or  as needed
p69333
as(dp69334
g16
V100297
p69335
stp69336
a((dp69337
g2
(lp69338
VYou can use a list comprehension to create new list of lists with all the sentences split:
p69339
aVNow you can loop through this and find the list matching a condition:
p69340
aVor searching case insensitively, use  and a generator expression; this will the minimum number of words to find a match:
p69341
as(dp69342
g16
V100297
p69343
stp69344
a((dp69345
g2
(lp69346
VYou gave Django a top-level module, where it expects models to be part of a package
p69347
aVThe error is the result of Django looking for the package name, and it doesn't exist here
p69348
aVDo not add the package your  file lives in to the PYTHONPATH; only add directory where the parent package lives, here
p69349
as(dp69350
g16
V100297
p69351
stp69352
a((dp69353
g2
(lp69354
VYou will have to pass in a reference to the  instance:
p69355
aVYou could store the  reference on the  instance too:
p69356
as(dp69357
g16
V100297
p69358
stp69359
a((dp69360
g2
(lp69361
VPresumably you meant  to be a string:
p69362
aVThis won't work because  is not a Python literal
p69363
aVIt is a representation of a Python  object, and  does not handle arbitrary types
p69364
aVOnly Python literal values ( for dictionaries or sets,  for lists,  for tuples, digits to numbers and string literals such as  and  and  with the various quote variations) are handled
p69365
aVSee the Literals section of the Python expressions documentation and the  documentation itself:
p69366
aVThe string or node provided may only consist of the following Python literal structures: strings, numbers, tuples, lists, dicts, booleans, and
p69367
as(dp69368
g16
V100297
p69369
stp69370
a((dp69371
g2
(lp69372
VYou can use  to pair up the elements of several lists:
p69373
aVThis does assume that your key is at least as long as the input string
p69374
aVIf your input key is of a fixed length and you want to repeat using it, you can use the  function to repeatedly loop over the key and pair up the key values with the string, until you run out of characters in the string:
p69375
aVDemo:
p69376
aVHere the key values repeat as they are paired up with the ordinals of the input string
p69377
as(dp69378
g16
V100297
p69379
stp69380
a((dp69381
g2
(lp69382
VYou see unprintable characters because  have meaning in a regular python string too, as octal escape codes:
p69383
aVThey never make it to the  function as written
p69384
aVUse a raw string literal instead:
p69385
aVNote the  string
p69386
aVIn a raw string literal  escape codes are not interpreted, leaving the back-references in place for the  module to use:
p69387
aVThe alternative would be to double the backslashes, escaping the escape:
p69388
aVEither way, your replacement pattern now works as expected:
p69389
as(dp69390
g16
V100297
p69391
stp69392
a((dp69393
g2
(lp69394
VPass in the  list using the  splat syntax to expand the values to separate arguments:
p69395
aVDemo:
p69396
as(dp69397
g16
V100297
p69398
stp69399
a((dp69400
g2
(lp69401
VYour values are lists, so add a list comprehension:
p69402
aVDemo:
p69403
as(dp69404
g16
V100297
p69405
stp69406
a((dp69407
g2
(lp69408
VWith BeautifulSoup, use the  iterable to get to text following a tag:
p69409
aVThis finds all text elements following the  element and joins them into one string
p69410
as(dp69411
g16
V100297
p69412
stp69413
a((dp69414
g2
(lp69415
VYou are looking for  calls in a list comprehension:
p69416
aVThis produces a list of the same length as the input list, but the values can repeat
p69417
aVDemo:
p69418
as(dp69419
g16
V100297
p69420
stp69421
a((dp69422
g2
(lp69423
VIf  and  are  objects, then subtracting them gives you a  result
p69424
aVA  object deals in days, seconds and microseconds, but with  method you can have the number of seconds as a float value
p69425
aVSimply divide by 60 for the minute count:
p69426
aVIf you wanted the remainder seconds as well, use the  function:
p69427
aVDemo:
p69428
as(dp69429
g16
V100297
p69430
stp69431
a((dp69432
g2
(lp69433
VYour Java application is using the opposite endianess; you are writing little-endian, but Java interpreted the value as big endian:
p69434
aVWrite big-endian and Java will read the values correctly:
p69435
aVIf that doesn't work there are other reasons that your output is not interpreted correctly
p69436
aVThe UBJSON specification is quite clear about endianess, it should all be encoded big-endian
p69437
as(dp69438
g16
V100297
p69439
stp69440
a((dp69441
g2
(lp69442
VWhy not create a dictionary without  values in the first place
p69443
as(dp69444
g16
V100297
p69445
stp69446
a((dp69447
g2
(lp69448
VYour  is a set of single values; your  function returns a list of strings, not of tuples with 3 values:
p69449
as(dp69450
g16
V100297
p69451
stp69452
a((dp69453
g2
(lp69454
VYou started a string value with the  triple quote
p69455
aVUse CTRL-C or CTRL-D to break out of the input loop, or close the opening quotes and parenthesis with :
p69456
as(dp69457
g16
V100297
p69458
stp69459
a((dp69460
g2
(lp69461
VYou are ending a string with 3 quotes, plus one extra
p69462
aVThis works:
p69463
aVIn other words, Python sees 3 quotes, then the string ends at the next 3 quotes
p69464
aVAnything that follows after that is not part of the string anymore
p69465
aVPython also concatenates strings that are placed one after the other:
p69466
aVso  means  really; the first string starts right after the opening 3 quotes until it finds 3 closing quotes
p69467
aVThose three closing quotes are then followed by two more quotes forming a separate but empty string:
p69468
aVMoral of the story: Python only supports triple or single quoting
p69469
aVAnything deviating from that can only lead to pain
p69470
as(dp69471
g16
V100297
p69472
stp69473
a((dp69474
g2
(lp69475
VYou are receiving gzipped content; test for the Content-Encoding header and decompress:
p69476
aVAlternatively, use the excellent  library which will handle sessions for you, but also will transparently decompress gzip and deflate responses for you
p69477
as(dp69478
g16
V100297
p69479
stp69480
a((dp69481
g2
(lp69482
VLoop over the list and print each item on a new line:
p69483
aVor convert your integers to strings before joining:
p69484
aVor tell  to use newlines as separators and pass in the list as separate arguments with the  splat syntax:
p69485
aVDemo:
p69486
as(dp69487
g16
V100297
p69488
stp69489
a((dp69490
g2
(lp69491
VOpen the file once, before looping, and add data to it in the loop as you find it:
p69492
aVEvery time you open a file in  write mode, it is truncated
p69493
aVAny previous data is removed to make place for the new data you are about to write
p69494
aVThe trick then is to open the file only once, at the start, and keep it open to write everything you need to while keeping it open
p69495
aVThe  statement here closes the file for you when the outer  loop is done
p69496
aVThe  passes any character set given by the server headers to  so it won't have to guess as hard; for the given URL BeautifulSoup is actually guessing wrong if you don't add that keyword parameter
p69497
aVI removed the newline you were adding to each row; the  class takes care of newlines for you
p69498
aVI also changed the blanket  to  to catch just the exceptions that are actually being thrown here, not everything
p69499
aVThe text is cleaned up to write each text entry to separate columns
p69500
aVThis produces output like this:
p69501
as(dp69502
g16
V100297
p69503
stp69504
a((dp69505
g2
(lp69506
VWith Python, use  to group rows on the second column, and a counter provided by :
p69507
aVThis writes a new CSV file with the same data, except the second column is replaced by a counter (starting at 1) that increments every time the original value in column 2 changes
p69508
as(dp69509
g16
V100297
p69510
stp69511
a((dp69512
g2
(lp69513
VYou are getting a  on here:
p69514
aVbecause you have no names  and  defined
p69515
aVPerhaps you meant to use  and  instead
p69516
as(dp69517
g16
V100297
p69518
stp69519
a((dp69520
g2
(lp69521
VParse out the JSON with the  module, which gives you a Python data structure
p69522
aVThen loop over the  key and dump each dictionary in that list to a new JSON file:
p69523
aVYou can further filter the entries as needed, or use data from the entries to generate a filename;  is the name value of each entry, for example
p69524
as(dp69525
g16
V100297
p69526
stp69527
a((dp69528
g2
(lp69529
VYou have a  in your  loop that is always executed:
p69530
aVRemove it or move it into an  statement
p69531
aVYour next problem is that you never re-roll the dice in your loop
p69532
aVYou'll need to keep assigning new random values to  and  for each round of the game
p69533
as(dp69534
g16
V100297
p69535
stp69536
a((dp69537
g2
(lp69538
VIf you are using Python 2, then either  or  is bound to
p69539
aVCheck the rest of your code for assignments to either name
p69540
aVNote that instead of  you can use  to get the same output
p69541
aVIf you are using Python 3, then the  method does not support  as a first argument:
p69542
aVand you certainly want to use  there:
p69543
as(dp69544
g16
V100297
p69545
stp69546
a((dp69547
g2
(lp69548
VYou are testing against the string minus the last character:
p69549
aVNote how the last character, the , is not part of the output of the slice
p69550
aVI think you wanted just to test against the last character; use  to slice for just the last element
p69551
aVHowever, there is no need to slice here; just use  and  directly
p69552
as(dp69553
g16
V100297
p69554
stp69555
a((dp69556
g2
(lp69557
VYou are trying to use assignment on an expression:
p69558
aVThis doesn't work; there is no name to assign to here
p69559
aVPerhaps you wanted to test for equality here
p69560
aVNow you have a valid expression, but the result ( or ) is ignored
p69561
aVYour editor is also showing that you are using a name you didn't define;  is seen as a name, not the value , so it is warning you that a  will likely be raised there
p69562
aVI think you wanted to show the result of the sum:
p69563
as(dp69564
g16
V100297
p69565
stp69566
a((dp69567
g2
(lp69568
V adds newlines for you
p69569
aVWriting to a file does not
p69570
aVEither add the newline explitily:
p69571
aVor use the  function for writing to the file:
p69572
aVThis all assumes you are using Python 3; in Python 2, you can still replace the  statement with the same  function on a module-by-module basis by adding:
p69573
aVat the top of the module
p69574
as(dp69575
g16
V100297
p69576
stp69577
a((dp69578
g2
(lp69579
V removes one item from the set, but you pass in a whole set object
p69580
aVYou need to remove the element itself, not another set with the element inside:
p69581
aVDemo:
p69582
aVNote how  was removed, but  remained in the set
p69583
aVIt would be easier to just loop over the set difference here:
p69584
aV(where I assume that  is a tuple of two values, you can just test for direct equality here)
p69585
aVYou don't need to store  on  all the time; using local names suffices and is not even needed here
p69586
as(dp69587
g16
V100297
p69588
stp69589
a((dp69590
g2
(lp69591
V is a command line tool, not Python syntax
p69592
aVIn other words, run the command in your console, not in the Python interpreter:
p69593
aVYou may have to use the full path:
p69594
aVor even
p69595
aVWindows will then execute the  program and that will use Python to install the package
p69596
as(dp69597
g16
V100297
p69598
stp69599
a((dp69600
g2
(lp69601
VPIL image objects do not support item assignment;  is your PIL  object
p69602
aVDid you mean to assign to the numpy  instead
p69603
aVIf so, use:
p69604
aVwhere I replaced the  objects with slice notation (much more efficient)
p69605
as(dp69606
g16
V100297
p69607
stp69608
a((dp69609
g2
(lp69610
VThe  module registers an  shutdown hook closing all handlers
p69611
aVThis closes the open  file object when Python exits
p69612
aVHowever, your  class has a  method, which is also called when Python exits
p69613
aVPython calls  before globals are cleaned up, so the exact order of operations here is:
p69614
aVs  hook is called, file is closed
p69615
aVis called, which calls
p69616
aVThis reopens the closed file handler to log, truncating the file
p69617
aVTo prevent this, explicitly close your connector before exiting Python:
p69618
as(dp69619
g16
V100297
p69620
stp69621
a((dp69622
g2
(lp69623
VNo, operators are applied to the value of an attribute (be it supplied by a property or taken from the  mapping or a slot), never the attribute itself
p69624
aVYou will have to return a special wrapper implementing  and return that, I am afraid
p69625
as(dp69626
g16
V100297
p69627
stp69628
a((dp69629
g2
(lp69630
VYou need to add parenthesis to group the  arithmetic together:
p69631
aVbecause the  operator has a lower precedence than the  operator:
p69632
aVIn the first form, Python evaluated  first and then you end up adding a string and a  object
p69633
aVYou could just use  here:
p69634
as(dp69635
g16
V100297
p69636
stp69637
a((dp69638
g2
(lp69639
VYou are trying to match encoded values, as bytes, with a regular expression that most likely won't match unless your Python source encoding exactly matches that of the input files, and then only if you are not using a multi-byte encoding such as UTF-8
p69640
aVYou need to decode the input files to Unicode values, and use a Unicode regular expression
p69641
aVThis means you need to know the codecs used for the input files
p69642
aVIt's easiest to use  to handle decoding and encoding:
p69643
aVNote the  raw unicode strings to define the regular expression patterns; now these are Unicode patterns and match codepoints, not bytes
p69644
aVThe  call makes sure you read , and when you write  values to the the output files the data is automatically encoded to UTF-8
p69645
aVI picked UTF-8 for the input file as well, but you need to check what the correct codec is for that file and stick to that
p69646
aVI've used a  statement here to have the files close automatically, used  as an iterable (no need to read all lines into memory in one go), and pre-compiled the regular expressions
p69647
as(dp69648
g16
V100297
p69649
stp69650
a((dp69651
g2
(lp69652
VYour first attempt works just fine, but you probably forgot to call the  decorator factory
p69653
aVIn other words, your first error occurs if you do this:
p69654
aVinstead of:
p69655
aVYou also really want to use  on decorators used in Django, especially if you want to mix this with other Django decorators such as :
p69656
aVThis ensures that any attributes set on the to-be-wrapped function are copied over correctly to the wrapper
p69657
as(dp69658
g16
V100297
p69659
stp69660
a((dp69661
g2
(lp69662
V is an empty dictionary, not a set
p69663
aVUse  to create an empty set
p69664
aVHowever, I think you are misinterpreting how  works here;  is the previous return value of the , and  is the next value from the sequence
p69665
aVBecause you return a set,  is always a set here, and you cannot use that as a key to
p69666
aVIf you want the union of all nodes in the graph, use  and :
p69667
aVThis creates one set from each of the  calls
p69668
aVTo use  you'd have to take into account that the first argument is always a set:
p69669
aVI am assuming here that  is iterable (yielding keys) just like a regular dictionary; if not, use
p69670
aVA quick demo with a regular dictionary:
p69671
as(dp69672
g16
V100297
p69673
stp69674
a((dp69675
g2
(lp69676
VCodepoints outside of the BMP use  (so uppercase  and 8 hex characters)
p69677
aVYou are using , which only take four hex characters, the  is not part of the unicode codepoint:
p69678
aVYou need to use a  pattern here:
p69679
aVDemo:
p69680
aVYou need to use a UCS4 Python build, otherwise non-BMP codepoints are implemented using UTF16 surrogate pairs, which won't work very well with regular expressions
p69681
aVIf  returns 2 then you are using a narrow UCS2 build instead, or you can look at ; a wide build returns 1114111, a narrow build 65535
p69682
aVOn a UCS2 system, for this specific case, you could match the UTF16 surrogates with an expression as well:
p69683
aVThis matches the UTF-16 surrogate pairs that make up the same range as , but on narrow builds:
p69684
as(dp69685
g16
V100297
p69686
stp69687
a((dp69688
g2
(lp69689
VYou can ignore  here, you are using the camel case naming convention exactly right
p69690
aVYou can suppress the warning:
p69691
aVis a class factory, so use the naming conventions for a class
p69692
as(dp69693
g16
V100297
p69694
stp69695
a((dp69696
g2
(lp69697
V is not an instance method; it is a static method that is passed the class object (making it not quite a class method either)
p69698
aVFrom the  documentation:
p69699
aVis a static method (special-cased so you need not declare it as such) that takes the class of which an instance was requested as its first argument
p69700
aVAs such, even when using  to look up the next  method in the MRO, you still need to pass in  explicitly
p69701
aVSpecial methods with double-underscores are normally looked up on the type, so on the metaclass of the class (which is  by default)
p69702
aVThat wouldn't work for  because you declared it directly on the class itself
p69703
aVAs such no descriptor protocol can be applied either (which is what normally turns a function into a bound method, for class and instance methods)
p69704
aVThus the  hook had to be special-cased and is never bound
p69705
as(dp69706
g16
V100297
p69707
stp69708
a((dp69709
g2
(lp69710
VYou are importing a different module; on your path you have a different  (or  cached bytecode) file
p69711
aVPrint out the  attribute to see what is imported instead:
p69712
aVand rename that or move it somewhere else
p69713
as(dp69714
g16
V100297
p69715
stp69716
a((dp69717
g2
(lp69718
VLooking through the source code, using  ends up with calling , while  is used for
p69719
aVThese differ in how the tokenizer is set up
p69720
aVWith  the tokenizer starts with an empty buffer, and calls are made to the  function to fill the tokenizer buffer, and this can trigger the exception you've seen (if the tokenizer saw no encoding declaration and a non-ASCII character has been seen)
p69721
aVFile contents are then recoded to UTF8 and handled as such by the tokenizer, for ease of tokenizing
p69722
aVTokens are later re-encoded to the original codec
p69723
aVWhen using  then the buffer is set to the string passed in
p69724
aVThe string is checked for a BOM and for a PEP 263-compliant comment, just as a file would be on reading, but if no such codec was set, the string is just handled as is by the tokenizer and no re-encoding takes place
p69725
aVThe  field of the tokenizer is left empty in that case, just as it would be for an ASCII file
p69726
aVWith the buffer initialized, and no fileobject, no calls to  are made and the exception is never raised
p69727
aVBecause of these differences, there is no way to force  to behave exactly like
p69728
aVYou'll have to do the same tests manually:
p69729
aVCheck for a BOM in the first bytes; test against the  constants
p69730
aVCheck for the  comment in the first two lines
p69731
aVIf these are missing, try to decode from ASCII and throw the  exception manually if the decode fails
p69732
as(dp69733
g16
V100297
p69734
stp69735
a((dp69736
g2
(lp69737
VThe 503 errors you see are probably due to the server rate limiting you, hit the server less frequently
p69738
aVThe loop is incorrect; loop over the  objects directly
p69739
aVYou can limit the search to only those  links that have a  attribute too:
p69740
as(dp69741
g16
V100297
p69742
stp69743
a((dp69744
g2
(lp69745
VThe statement:
p69746
aVworks just fine for SQLite, it does remove newlines from the end of a string
p69747
aVIf this doesn't work for you, your values do not have newlines at the end, or you didn't commit your transaction
p69748
aVAlternatives that give the same results:
p69749
aVYou could pass in the newlines as parameters:
p69750
aVUse  to specify a BLOB literal, using hexadecimal notation:
p69751
as(dp69752
g16
V100297
p69753
stp69754
a((dp69755
g2
(lp69756
VYou are passing in two values to format with, but specify only one slot
p69757
aVThe slot count and number of parameters must match
p69758
aVEither add a slot for  or remove it from the tuple:
p69759
aVAlternatively, use named slots and a dictionary:
p69760
aVwhich won't complain about unused keys
p69761
as(dp69762
g16
V100297
p69763
stp69764
a((dp69765
g2
(lp69766
VYou are trying to use the  module object as a class
p69767
aVYou need to use the class object from the module:
p69768
aVor import the class into the global namespace from the module:
p69769
as(dp69770
g16
V100297
p69771
stp69772
a((dp69773
g2
(lp69774
VMultiply the list:
p69775
aVThis calls  once, then references that same value 20 times to build a list of 20 entries
p69776
aVIf you wanted 20 different random values, use a list comprehension:
p69777
as(dp69778
g16
V100297
p69779
stp69780
a((dp69781
g2
(lp69782
VYou could test the range, if you don't mind the loss of a little precision (see Alfe's answer):
p69783
aVor invert to test for single precision:
p69784
aVThese would prevent raising an  exception, the alternative is to just catch that
p69785
aVDo note that , , ,  and  will test as double with these tests; if you want these to be stored in 4 bytes rather than 8, test for these explicitly
p69786
as(dp69787
g16
V100297
p69788
stp69789
a((dp69790
g2
(lp69791
VThe  module maintains the heap invariant, which is not the same thing as maintaining the actual list object in sorted order
p69792
aVQuoting from the  documentation:
p69793
aVHeaps are binary trees for which every parent node has a value less than or equal to any of its children
p69794
aVThis implementation uses arrays for which  and  for all , counting elements from zero
p69795
aVFor the sake of comparison, non-existing elements are considered to be infinite
p69796
aVThe interesting property of a heap is that its smallest element is always the root,
p69797
aVThis means that it is very efficient to find the smallest element (just take ), which is great for a priority queue
p69798
aVAfter that, the next 2 values will be larger (or equal) than the 1st, and the next 4 after that are going to be larger than the first 3, then the next 8 are larger, etc
p69799
aVYou can read more about the theory behind the datastructure in the Theory section of the documentation
p69800
aVYou can also watch this lecture from the MIT OpenCourseWare Introduction to Algorithms course, which explains the algorithm in general terms
p69801
aVA heap can be turned back into a sorted list very efficiently:
p69802
aVby just popping the next element from the heap
p69803
aVUsing  should be faster still, however, as the TimSort will take advantage of the partial ordering already present in a heap
p69804
aVYou'd use a heap if you are only interested in the smallest value, or the first  smallest values, especially if you are interested in those values on an ongoing basis; adding new items and removing the smallest is very efficient indeed, more so than resorting the list each time you added a value
p69805
as(dp69806
g16
V100297
p69807
stp69808
a((dp69809
g2
(lp69810
VYou are comparing strings and integers
p69811
aVConvert one or the other:
p69812
aVor
p69813
aVor make  a string to begin with:
p69814
aVNote that  and  (string and integer values) print the same:
p69815
aVUse  to make the difference clear:
p69816
as(dp69817
g16
V100297
p69818
stp69819
a((dp69820
g2
(lp69821
VYou need to use  or the class object to access class attributes:
p69822
aVor
p69823
aVThe latter form is really only needed if you want to bypass an instance attribute with the same name:
p69824
aVHere  is an instance attribute (setting always happens on the object directly)
p69825
aVBut  because there is no  instance attribute,  finds the class attribute instead
p69826
as(dp69827
g16
V100297
p69828
stp69829
a((dp69830
g2
(lp69831
VYou first read the list with :
p69832
aVthen try to read it again:
p69833
aVThis won't work; the file pointer is now at the end of the file
p69834
aVRewind or reopen the file:
p69835
aVNot that you need to check for the file contents here; let  do that for you
p69836
aVNext you read the file line by line:
p69837
aVThis doesn't work; the pickle format is binary, not line oriented, and you are reading by using iteration, then reading again by passing in the file object
p69838
aVLeave reading the file to the  module altogether:
p69839
aVYou also mention in your code:
p69840
aVPickle has no problems with any list size, there is no reason to break up your players list into chunks of five
p69841
aVYou didn't state what problem you encountered, but the number of items in the list cannot have been the cause:
p69842
aVThis stored and re-loaded a list of 1000 integers
p69843
as(dp69844
g16
V100297
p69845
stp69846
a((dp69847
g2
(lp69848
VYou are writing dictionaries to the CSV file, while  expects lists with singular values that are turned into strings on writing
p69849
aVDon't write dictionaries, these are turned into string representations, as you've discovered
p69850
aVYou need to determine how the keys and / or values of each dictionary are to be turned into columns, where each column is a single primitive value
p69851
aVIf, for example, you only want to write the  key (if present) then do so:
p69852
aVwhere it is assumed that the value associated with the  key is always a list of values
p69853
aVIf you wanted to persist dictionaries with Unicode values, then you are using the wrong tool
p69854
aVCSV is a flat data format, just rows and primitive columns
p69855
aVUse a tool that can preserve the right amount of information instead
p69856
aVFor dictionaries with string keys, lists, numbers and unicode text, you can use JSON, or you can use  if more complex and custom data types are involved
p69857
aVWhen using JSON, you do want to either decode from byte strings to Python Unicode values, or always use UTF-8-encoded byte strings, or state how the  library should handle string encoding for you with the  keyword:
p69858
aVbecause JSON strings are always unicode values
p69859
aVThe default for  is  but I added it here for clarity
p69860
aVLoading the data again:
p69861
aVNote that this will return unicode strings, not strings encoded to UTF8
p69862
aVThe  module works much the same way, but the data format is not human-readable:
p69863
aVwill return your data exactly as you stored it
p69864
aVByte strings remain byte strings, unicode values would be restored as unicode
p69865
as(dp69866
g16
V100297
p69867
stp69868
a((dp69869
g2
(lp69870
VYour  function doesn't always return anything
p69871
aVWhen a function ends without a  statement,  is returned instead
p69872
aVWhen you recurse (with a  or , you forget to return the recursive call result
p69873
aVYou'd return the recursive call like:
p69874
aVwhere I combined both exceptions into one handler
p69875
aVNotice the  on the  call; just because a nested call returns a value, doesn't mean that the function call itself passes on that result automatically
p69876
aVBut using a loop would be better:
p69877
aVwhere the  will end the loop as well as the function
p69878
aVI removed the  exception,  always returns a string and  will only ever raise  when passed a string that cannot be parsed into a floating point number
p69879
aVs are only raised if the argument is of a type that cannot be converted to , such as a dictionary or custom object
p69880
as(dp69881
g16
V100297
p69882
stp69883
a((dp69884
g2
(lp69885
VIf you need to exit a function early, use :
p69886
aVThis will break out of the loop and skip the stuff at the end
p69887
as(dp69888
g16
V100297
p69889
stp69890
a((dp69891
g2
(lp69892
VYou can define a global name , set to a list or tuple of names, to limit what is imported and what documentation tools generally will list:
p69893
aVThe  name limits what  will import, and is also used by documentation tools to limit what is listed as public API for a given module
p69894
aVSee the  statement documentation:
p69895
aVThe public names defined by a module are determined by checking the module\u2019s namespace for a variable named ; if defined, it must be a sequence of strings which are names defined or imported by that module
p69896
aVThe names given in  are all considered public and are required to exist
p69897
aVIf  is not defined, the set of public names includes all names found in the module\u2019s namespace which do not begin with an underscore character ()
p69898
aVshould contain the entire public API
p69899
aVIt is intended to avoid accidentally exporting items that are not part of the API (such as library modules which were imported and used within the module)
p69900
aVThe  modules you inspected will almost certainly define  sequences
p69901
aVYou can also delete names again from your module, provided your functions do not need access to the global names later:
p69902
aVThe IPython autocompletion otherwise uses all names that do not start with an underscore; the autocompletion ignores the  list, but will ignore names like
p69903
aVThe  module (before version 1
p69904
ag1140
aV0) itself deletes names from the global namespace again:
p69905
aVbut here  is bound as  and IPython would ignore that name even if it wasn't deleted
p69906
aValso builds up an  list in that module
p69907
aVIn  version 1
p69908
ag1140
aV0 and newer, a  statement was added to that file and IPython offers it for autocompletion, because it is still part of the global namespace
p69909
as(dp69910
g16
V100297
p69911
stp69912
a((dp69913
g2
(lp69914
V is a built-in function, but you are trying to use it as a sequence:
p69915
aVCall the function instead:
p69916
aVNote the shape change there, indexing is done with square brackets, calling is done with round parentheses
p69917
as(dp69918
g16
V100297
p69919
stp69920
a((dp69921
g2
(lp69922
VColons are reserved characters in Windows filesystem (see How would I go about creating a filename with invalid characters such as :
p69923
aV>
p69924
aV, so the name was replaced with an auto-generated on instead
p69925
aVTo be clear, this is not a Python issue
p69926
aVDon't use colons or other reserved characters in filenames if you don't want this to happen
p69927
as(dp69928
g16
V100297
p69929
stp69930
a((dp69931
g2
(lp69932
VYou swapped your operations here
p69933
aVYour code creates an empty  list, adds one entry, then saves that list
p69934
aVAfter that you load the file again, so you load just the new list you just created
p69935
aVYou need to first load the previous scores, append the new scores, then save the data:
p69936
as(dp69937
g16
V100297
p69938
stp69939
a((dp69940
g2
(lp69941
VYou need to set the request content type to  for the  property to work; it'll be  otherwise
p69942
aVSee the Flask  documentation:
p69943
aVIf the mimetype is  this will contain the parsed JSON data
p69944
aVOtherwise this will be
p69945
aVFlask 0
p69946
aV10 added the  method, and you should use that method instead of the  property
p69947
aVYou can tell the method to skip the content type requirement by setting
p69948
as(dp69949
g16
V100297
p69950
stp69951
a((dp69952
g2
(lp69953
VYou have to either find the index, or filter the list
p69954
aVFinding the index:
p69955
aVOr, you could just remove the value:
p69956
aVwhere  is documented as being equilalent to the  version above
p69957
aVEither of these can raise an  if  is not part of the list
p69958
aVIf there is more than one copy of the value in the list, only the first such copy is removed
p69959
aVFiltering would remove all such copies:
p69960
aVThis will not raise an exception; it builds an entirely new list of values that are not equal to
p69961
as(dp69962
g16
V100297
p69963
stp69964
a((dp69965
g2
(lp69966
VIf you need the first 1000 bytes then you need to encode the Unicode value first, as the number of bytes varies with the encoding picked
p69967
aVThen just slice the first 1000 bytes:
p69968
aVAs it happens, the Plivo Send Message API requires exactly that; 1000 bytes of UTF-8 encoded data
p69969
aVYou probably want to truncate the data further to not cut off multi-byte UTF-8 characters:
p69970
as(dp69971
g16
V100297
p69972
stp69973
a((dp69974
g2
(lp69975
VInstead of using , use the  operator:
p69976
aVor use a regular expression with the  pipe operator:
p69977
aVThe  list comprehension first escapes each word (making sure that meta characters are matched literally, and are not interpreted as regular expression patterns)
p69978
aVFor the list  this creates the pattern:
p69979
aVmatching any string that contains either word
p69980
as(dp69981
g16
V100297
p69982
stp69983
a((dp69984
g2
(lp69985
VYou swapped the arguments to
p69986
aVThe first argument is the pattern, not the string to match:
p69987
aVYour pattern is also overly wide;  matches everything between  (uppercase) and  (lowercase) too
p69988
aVThe correct pattern is:
p69989
aVwhere  is the default, so I omitted that
p69990
aVIf you are matching this against filenames, you probably do not want to use the start or end anchors, that would limit matches to exact strings only:
p69991
aVAnd you want to use  to get the matched portion, not  (which is the original input string):
p69992
aVIf you only wanted the numbers, you need to add a group, and pick that
p69993
aVYou create a capturing group with parenthesis:
p69994
aVThis selects the first group (), which is the parenthesis around the 2 digits portion
p69995
as(dp69996
g16
V100297
p69997
stp69998
a((dp69999
g2
(lp70000
VYou can try to convert the string to a number using , catching the exception:
p70001
aVThis returns  only if the string can be converted to an integer number
p70002
as(dp70003
g16
V100297
p70004
stp70005
a((dp70006
g2
(lp70007
V will look through the class MRO to look for the next  method, starting the search one step on from the location of :
p70008
aVSo it'll look at all the other classes to see where the next  is defined, the code then calls that
p70009
aVUltimately, that'll be , where Python's C code creates the actual C structures that form the number object:
p70010
aVThe stated purpose of the  method is to create a new instance
p70011
aVAnd because numbers are indeed immutable, that is the point where you want to hook in to be able to customize how the instance is created, because once it exists, it cannot be altered anymore
p70012
aVThe name  is just a local name
p70013
aVIt matches the convention used by methods, but  is not an ordinary bound method as there is nothing to bind to when creating a new instance
p70014
aVYou can replace that name throughout the function with something entirely different (, , etc
p70015
aVand the code would still work the same
p70016
aVin other functions is not affected by it
p70017
aVAs it happens,  instances are mutable; the class defines  and  slots, which can still be rebound after the instance has been created
p70018
aVThe  factory method actually does this; it assigns new values to those attributes
p70019
aVAfter adjusting these attributes,  is returned, thus fulfilling the contract of the  method, to return the new instance
p70020
aVIn principle, setting the  and  attributes could all have been done in an  method too
p70021
aVThe Python developers have however decided to stick to the convention for immutable types as the class is meant to be treated as immutable:
p70022
aVbut as you can see, if you know about the mutable attributes, you can still mutate the instance from the outside
p70023
as(dp70024
g16
V100297
p70025
stp70026
a((dp70027
g2
(lp70028
VJust assign directly to those two index pairs, indexing from the outer list to the inner (the last list is , the middle list is ), so the first element of the last list is at :
p70029
aVThis assigns two values (one taken from , the other the literal  integer) to the two positions in the nested lists
p70030
aVIf you wanted to swap those two positions (taking the  from ), then do so with the same syntax:
p70031
aVbecause the right-hand side expression is evaluated before assigning the two values to the left-hand side targets:
p70032
as(dp70033
g16
V100297
p70034
stp70035
a((dp70036
g2
(lp70037
VYou are catching the exception in the wrong location
p70038
aVThe  call throws the exception, as shown by the first lines of your traceback:
p70039
aVCatch it there:
p70040
as(dp70041
g16
V100297
p70042
stp70043
a((dp70044
g2
(lp70045
VYou can set  to  explicitly, first:
p70046
aVbut in this case it would be easier to just assign  to begin with:
p70047
as(dp70048
g16
V100297
p70049
stp70050
a((dp70051
g2
(lp70052
VEmpty lines contain newlines; replace the  too
p70053
aVIf you find that you are end up removing all newlines, then split on newlines and remove any empty string values:
p70054
aVThis removes any empty lines, rejoining the remaining non-empty lines with fresh newlines
p70055
aVIf instead you are producing the output line by line by printing or writing to a file, simply not print or write when the line is empty:
p70056
aVThe  statement tests for a line that contains more than just whitespace
p70057
as(dp70058
g16
V100297
p70059
stp70060
a((dp70061
g2
(lp70062
VThe  method prints the output:
p70063
aVPrinting writes data to , which is redirected to the log when running a WSGI server
p70064
aVYou want to return  instead:
p70065
aVWithout a  statement, the default return value is , and  results in an empty page
p70066
aVWith the  the caller of the  function actually receives that list
p70067
as(dp70068
g16
V100297
p70069
stp70070
a((dp70071
g2
(lp70072
VYou can match a file case insensitively by using  and a generator expression:
p70073
aVHowever, you still need to indent the  loop to fall within the  statement, because if your looked-for filename is not there, you still need to not read the file:
p70074
as(dp70075
g16
V100297
p70076
stp70077
a((dp70078
g2
(lp70079
VI'd build an inverse index:
p70080
aVNow you can find any value that is shared between keys:
p70081
aVDemo:
p70082
aVIf you want to test two keys, use:
p70083
aVDemo:
p70084
aVor, returning the common values:
p70085
aVDemo:
p70086
as(dp70087
g16
V100297
p70088
stp70089
a((dp70090
g2
(lp70091
V alters the list in place, and returns
p70092
aVBy assigning you assigned that return value to , not the list you wanted to build
p70093
aVThis is a standard Python idiom; methods that alter the mutable object never return the altered object, always
p70094
aVSeparate the two steps:
p70095
aVThis adds  to the end; if you need the  at the start, use:
p70096
aVor you can use , again as a separate call:
p70097
aVbut the latter has to shift up all elements one step and creating a new list by concatenation is the faster option for shorter lists, insertion wins on longer lists:
p70098
as(dp70099
g16
V100297
p70100
stp70101
a((dp70102
g2
(lp70103
VUse the  keyword to make your upload, not
p70104
aVDon't set the content-type header either; the form is posted as multipart form data, and requests should use the correct content type for that for you:
p70105
aVand put the rest of the form fields in a mapping in
p70106
aVIf you want to upload more than one file, use a sequence of tuples, not a dictionary, each a pair of :
p70107
as(dp70108
g16
V100297
p70109
stp70110
a((dp70111
g2
(lp70112
VBy using  you end up with floating point values, but the method you are calling wants integers only
p70113
aVCall  on the values before passing them to :
p70114
as(dp70115
g16
V100297
p70116
stp70117
a((dp70118
g2
(lp70119
VDon't interpolate data into SQL statements yourself; leave proper escaping to the database adapter by using SQL parameters:
p70120
aVThe database adapter then ensures that each value is properly escaped, including handling of embedded quotes in the value
p70121
as(dp70122
g16
V100297
p70123
stp70124
a((dp70125
g2
(lp70126
VPython asks the terminal what encoding is being used, and encodes unicode strings to bytes when printing
p70127
aVYour Ubuntu server is not configured for UTF-8 display, your Mac terminal is
p70128
aVSee http://askubuntu
p70129
aVcom/questions/87227/switch-encoding-of-terminal-with-a-command for help with switching your terminal locale
p70130
aVAny locale that can handle the specific codepoints you are trying to print is fine, but UTF8 can handle all of Unicode
p70131
aVYou can see what Python detected by printing :
p70132
as(dp70133
g16
V100297
p70134
stp70135
a((dp70136
g2
(lp70137
VYou already have a list:
p70138
aVAll you have to do now is loop over that list:
p70139
aVThis lets you drop the loop with  calls too
p70140
aVSee how much easier that is
p70141
aVJust Keep data out of your variable names
p70142
aVWhenever you find you want to generate dynamic variables, generate a list or dictionary instead, they are far easier to handle
p70143
as(dp70144
g16
V100297
p70145
stp70146
a((dp70147
g2
(lp70148
V is a string value, but your dictionary keys are integers
p70149
aVIntegers and strings cotaining only digits print the same, but are not the same type and unlike JavaScript, Python does not consider them equal or coerces between integers and strings
p70150
aVExplicitly convert your string to an integer first:
p70151
aVTo see the difference between different types properly, use  when printing:
p70152
aVNote the quotes around the string value
p70153
aVThe Python interactive shell uses  by default when echoing values (everything except  is echoed):
p70154
as(dp70155
g16
V100297
p70156
stp70157
a((dp70158
g2
(lp70159
VYou can use slicing on  objects:
p70160
aVWhen handling these frames, however, you probably also want to know about  objects; these let you interpret the bytes as C datatypes without any extra work on your part, simply by casting a 'view' on the underlying bytes:
p70161
aVThe  object is now a memory view interpreting every 2 bytes as an unsigned short; so it now has length 3 and each index is an integer value, based on the underlying bytes
p70162
as(dp70163
g16
V100297
p70164
stp70165
a((dp70166
g2
(lp70167
VYou are using the  function as if indexing into a sequence, using square brackets:
p70168
aVMake that a proper function call:
p70169
aVYou will have to retool your program, however, to replace the loop over  to an infinite loop, asking for input each loop iteration and treating that input as a token instead:
p70170
aVYou probably want to look for an  or  token to break out of the loop and program
p70171
as(dp70172
g16
V100297
p70173
stp70174
a((dp70175
g2
(lp70176
VYou were so close:
p70177
aVor use a list comprehension:
p70178
aVDemo of the one-liner:
p70179
as(dp70180
g16
V100297
p70181
stp70182
a((dp70183
g2
(lp70184
VYou are mixing syntax here
p70185
aVThere are two different concepts at play here:
p70186
aVList comprehension syntax
p70187
aVHere  acts as a filter; include a value in the iteration or not
p70188
aVThere is no , as that is the 'don't include' case already
p70189
aVA conditional expression
p70190
aVThis must always return a value, either the outcome of the 'true' or the 'false' expression
p70191
as(dp70192
g16
V100297
p70193
stp70194
a((dp70195
g2
(lp70196
VUse  to create lists of numbers quickly:
p70197
aVor, using a list comprehension:
p70198
aVIf you are using Python 3, turn the iterator returned by  into a list first:
p70199
aVQuick demo:
p70200
as(dp70201
g16
V100297
p70202
stp70203
a((dp70204
g2
(lp70205
VThe  module reads the header for you, which is why it can tell you how many channels there are, and what the sample width is
p70206
aVReading frames gives you direct access to the raw sample data, but because the WAV format is a bit of a mixed, confused beast it depends on the sample width and channel count how you need to interpret each frame
p70207
aVSee this article for a good in-depth discussion on that
p70208
as(dp70209
g16
V100297
p70210
stp70211
a((dp70212
g2
(lp70213
VYou have an outer wrapping to traverse here; your  object is a dictionary with one key , referencing a dictionary value which has a  key, and that is a list of dictionaries, and there we find a dictionary with the  key finally:
p70214
aVDemo:
p70215
as(dp70216
g16
V100297
p70217
stp70218
a((dp70219
g2
(lp70220
VYou don't need  here, at all
p70221
aVUse:
p70222
aVThe  method returns  if all letters in the string are lower-cased
p70223
aVDemo:
p70224
aVUse  to find lowercased text in a larger string, not in a list:
p70225
as(dp70226
g16
V100297
p70227
stp70228
a((dp70229
g2
(lp70230
VYou are accessing a  request; don't send JSON but URL parameters:
p70231
aVThis sends the state as a GET parameter
p70232
aVThe  keyword parameter is entirely ignored when using  anyway, so the parameter never made it to the GitHub server and it defaulted to  in absence of a specific value
p70233
as(dp70234
g16
V100297
p70235
stp70236
a((dp70237
g2
(lp70238
VYou are using the wrong name
p70239
aVThere is already a module named  in the standard library, and that module is probably already imported by other code you are using
p70240
aVYou are even using  in the code you posted here, which would otherwise create a circular import
p70241
aVThe best option is to rename this module to something else
p70242
aVIf you are using Python 3, and placed  inside a package, you can qualify the import to be within the current package:
p70243
aVNote the
p70244
aVThis would allow you to retain the current name; Python 3 switched to using absolute imports by default and a  module inside a package won't conflict with the global  module
p70245
aVYou are also using invalid Python syntax in your module
p70246
aVPython uses , not  for boolean logic:
p70247
aVshould be
p70248
as(dp70249
g16
V100297
p70250
stp70251
a((dp70252
g2
(lp70253
VYou have floating point values, not integers
p70254
aVUse  instead if you want to support such numbers
p70255
as(dp70256
g16
V100297
p70257
stp70258
a((dp70259
g2
(lp70260
VYou set  to an empty string, before calling the template:
p70261
aVSo within the template,  is set to , the empty string
p70262
aVUse a different name for the dictionary; , perhaps:
p70263
as(dp70264
g16
V100297
p70265
stp70266
a((dp70267
g2
(lp70268
VYou cannot, because during class definition, the class does not yet exist
p70269
aVYou can apply the decorator after the class has been created:
p70270
aVor you can swap the order of the two method definitions and refer to  as a local name still:
p70271
aVIn both cases you are passing in a callable  that is not bound to an instance
p70272
aVNo  will be passed in, so you need to add that yourself, in the decorator:
p70273
aVIf you didn't expect  to be bound (it acting as a static method instead), you could just use a normal function instead here
p70274
aVGenerally speaking, creating a decorator to call another method on the same instance is somewhat pointless; why not just call  from within , directly
p70275
as(dp70276
g16
V100297
p70277
stp70278
a((dp70279
g2
(lp70280
VList comprehensions and dict comprehensions do the work for you:
p70281
aVand
p70282
aVor, as a function:
p70283
aVUse  instead of  if you are using Python 3
p70284
aVDemo:
p70285
as(dp70286
g16
V100297
p70287
stp70288
a((dp70289
g2
(lp70290
VYou are not passing in two strings; you are passing in one string with no whitespace between
p70291
aVPython automatically concatenates adjacent strings with nothing but whitespace in between:
p70292
aVNote how there is no space between  and
p70293
aVPut the two strings in a list:
p70294
aVNow  will handle passing in correctly quoted strings to the underlying OS as one command
p70295
as(dp70296
g16
V100297
p70297
stp70298
a((dp70299
g2
(lp70300
VPut your 4 lists in another list:
p70301
aVNow you can address them with indexing:
p70302
as(dp70303
g16
V100297
p70304
stp70305
a((dp70306
g2
(lp70307
VYou need to strip away the spaces, and then you can split on the  non-breaking space:
p70308
aVDemo:
p70309
aVThis uses a list comprehension to loop over the values, with  to remove the whitespace (all the tabs and carriage returns) and  to split the remaining string on whitespace (where  is whitespace too)
p70310
as(dp70311
g16
V100297
p70312
stp70313
a((dp70314
g2
(lp70315
VAn iterator is an object that provides values one by one, and does this just once
p70316
aVYou can loop over an iterator, or ask for the next value with the  function, but you cannot index into an iterator (ask for elements in specific locations in the sequence), for example
p70317
aVYou can collect all those values into a list simply by calling  on the iterator:
p70318
as(dp70319
g16
V100297
p70320
stp70321
a((dp70322
g2
(lp70323
VNo, they should not
p70324
aVA raw string literal does let you escape quotes, but the backslashes will  be included:
p70325
aVwhere Python echoes the resulting string as a string literal with the backslash escaped
p70326
aVThis is explicitly documented behaviour of the raw string literal syntax:
p70327
aVWhen an  or  prefix is present, a character following a backslash is included in the string without change, and all backslashes are left in the string
p70328
aVFor example, the string literal  consists of two characters: a backslash and a lowercase
p70329
aVString quotes can be escaped with a backslash, but the backslash remains in the string; for example,  is a valid string literal consisting of two characters: a backslash and a double quote;  is not a valid string literal (even a raw string cannot end in an odd number of backslashes)
p70330
aVIf you didn't use a raw string literal for the second parameter, Python would interpret the  combination as octal byte values:
p70331
aVYou can construct the same string without raw string literals with doubling the backslash:
p70332
as(dp70333
g16
V100297
p70334
stp70335
a((dp70336
g2
(lp70337
VYou are using a regular expression, and matching HTML with such expressions get too complicated, too fast
p70338
aVUse a HTML parser instead, Python has several to choose from
p70339
aVI recommend you use BeautifulSoup, a popular 3rd party library
p70340
aVBeautifulSoup example:
p70341
aVSince a  tag itself doesn't contain other tags, you can get away with a regular expression here, but as soon as you try to parse nested tags, you will run into hugely complex issues
p70342
aVYour specific problem can be solved by matching additional characters within the  tag, optionally:
p70343
aVThis matches 0 or more characters that are not the closing  bracket
p70344
aVThe '0 or more' here lets you match both extra attributes and the plain  tag
p70345
as(dp70346
g16
V100297
p70347
stp70348
a((dp70349
g2
(lp70350
VNo, the shell command will only return when the commands have finished
p70351
aVBut the PostgreSQL server may still be finalizing the commit by the time the command line utilities have completed
p70352
aVIt is running as a separate process and by the time Python connects to the database it could be that the transaction is not yet visible to other connections
p70353
aVWithout knowing more about the imported data it is hard to give you a one-size-fits-all solution on how to detect if the import transaction has committed yet
p70354
aVPausing the Python process (with ) could be a work-around, or you can test for specific data in the database, and loop until that data appears
p70355
as(dp70356
g16
V100297
p70357
stp70358
a((dp70359
g2
(lp70360
VUse the  function to look up attributes dynamically:
p70361
aVwill look up the attribute named in  on the object
p70362
as(dp70363
g16
V100297
p70364
stp70365
a((dp70366
g2
(lp70367
VThe Python interpreter ignores  return values, so doctests do the same
p70368
aVTest for  instead:
p70369
as(dp70370
g16
V100297
p70371
stp70372
a((dp70373
g2
(lp70374
VThis is indeed fine; the  name is entirely local to the  function scope
p70375
aVThe instances will not be shared between calls to that route
p70376
as(dp70377
g16
V100297
p70378
stp70379
a((dp70380
g2
(lp70381
VPython 3 switched to using more efficient data structures and methods throughout; you can get the same dictionary view objects in Python 2 with using ,  and
p70382
aVIf you have to have a list, simply use  to turn collect all values in the view into a list:
p70383
aVFor just the keys, you can also call  on the dictionary, directly:
p70384
as(dp70385
g16
V100297
p70386
stp70387
a((dp70388
g2
(lp70389
VIf you are not using the return value of a call, there is little point in assigning it to a local name
p70390
aVThe returned response object will then not be referenced anywhere and freed two bytecodes earlier than if you assigned it to a name, and ignored that name before returning from the function
p70391
as(dp70392
g16
V100297
p70393
stp70394
a((dp70395
g2
(lp70396
VYou'll need to tell bootstrap what version to pick, explicitly:
p70397
aVto match the version named in your
p70398
aVBootstrap does not look in  to honour version pins; you'd have to re-implement a large chunk of buildout itself to be able to parse the full configuration format (including includes)
p70399
as(dp70400
g16
V100297
p70401
stp70402
a((dp70403
g2
(lp70404
VYou are assigning to the  name in the first nested function, making it a local variable
p70405
aVIn the second example, you never assign to  directly, making it a free variable, which the compiler rightly connected to the  in the parent function
p70406
aVYou never rebind the name, you are only altering the list  refers to
p70407
aVUse the  keyword to mark  as a free variable:
p70408
as(dp70409
g16
V100297
p70410
stp70411
a((dp70412
g2
(lp70413
VYou mistyped the slash:
p70414
aVshould be:
p70415
aVHTML uses a forward slash in closing tags
p70416
aVThat said, don't use regular expressions to parse HTML
p70417
aVMatching HTML with such expressions get too complicated, too fast
p70418
aVUse a HTML parser instead, Python has several to choose from
p70419
aVI recommend you use BeautifulSoup, a popular 3rd party library
p70420
aVBeautifulSoup example:
p70421
as(dp70422
g16
V100297
p70423
stp70424
a((dp70425
g2
(lp70426
VUse a  object for ease:
p70427
aVYour first attempty will overwrite keys; a dict comprehension would not merge the values
p70428
aVThe second attempt seems to treat the lists in the  list as dictonaries, so that wouldn't work at all
p70429
aVDemo:
p70430
as(dp70431
g16
V100297
p70432
stp70433
a((dp70434
g2
(lp70435
VDon't use ; it'll wait for the process to complete
p70436
aVUse the  class directly, without waiting:
p70437
aVYou can redirect its output to the bit bin, if desired:
p70438
aVIf all you want do do is spawn a browser with a given URL, take a look at the  module; it uses the same call under the hood to spawn a browser process in the background (including the redirection to )
p70439
aVAlthough Google Chrome is not listed on the documentation page, the 2
p70440
ag4892
aV5 source code of the module does list  and  as recognized browser strings
p70441
as(dp70442
g16
V100297
p70443
stp70444
a((dp70445
g2
(lp70446
VYou would have to format each integer before printing:
p70447
aVor use:
p70448
aVwithout first converting all the strings to integers
p70449
aVDemo:
p70450
aVNote that if your  strings are meant to be binary values, you'd need to interpret them as such:
p70451
aVThis converts a string of zeros and ones into an integer by interpreting the digits as binary, and converts an integer number back into a binary string representation using 4 digits and 0-padding
p70452
as(dp70453
g16
V100297
p70454
stp70455
a((dp70456
g2
(lp70457
VWell,  is not defined at that line, so the error is not surprising
p70458
aVYou don't actually define it until the next statement:
p70459
aVYou need to move that last line to before the line where you use
p70460
aVYou can combine the test with the other  test below it:
p70461
aVNote that I altered how  is lower-cased here; there is no point in testing  against a list of lower-case extensions otherwise;  without lowercasing will not be in  unless it already is lowercase
p70462
as(dp70463
g16
V100297
p70464
stp70465
a((dp70466
g2
(lp70467
V returns an iterable, so loop over that while producing the list:
p70468
aVThis produces one list, the list of all combinations that match the criteria
p70469
aVDemo:
p70470
aVThe alternative would be to produce  combinations of  with  removed, then adding  back in (using  to avoid having to sort afterwards):
p70471
aVthen loop over that generator:
p70472
aVThis won't produce as many combinations for filtering to discard again
p70473
aVIt may well be that for larger values of  and guaranteed numbers, just using  is going to beat repeated  calls
p70474
as(dp70475
g16
V100297
p70476
stp70477
a((dp70478
g2
(lp70479
VUnless the new line is exactly as long as the old line, you best option would be to rewrite the file, anyway
p70480
aVThe easiest way to do so is to use the  module:
p70481
aVThis creates a backup of the file, and output goes to a new file replacing the old
p70482
aVWriting to  writes to than new file (the alternative is to use  but  still includes the newline)
p70483
as(dp70484
g16
V100297
p70485
stp70486
a((dp70487
g2
(lp70488
VFollow the ball closely:
p70489
aVinitially is an integer
p70490
aVhowever, returns a list, which you then pass to  again:
p70491
aVIn that recursive call in ,  is now a list
p70492
aVYou then pass  to  again, but now it is a list, and the code fails
p70493
aVThe code fails because a list of numbers, like  turned into a string includes the character , and that is not an integer
p70494
as(dp70495
g16
V100297
p70496
stp70497
a((dp70498
g2
(lp70499
VYou have a list comprehension with nested loops
p70500
aVIt can be translated to:
p70501
aVIt could be simplified further though, by looping over  and  directly:
p70502
aVor you can use  to replace the nested loops:
p70503
as(dp70504
g16
V100297
p70505
stp70506
a((dp70507
g2
(lp70508
VThe one thing you could test for is code object equality:
p70509
aVHere the bytecode for both functions is the same
p70510
aVYou'll perhaps need to verify more aspects of the code objects (closures spring to mind), but equal bytecode should equal the same execution path
p70511
aVThere are of course ways to create functions that return the same value for the same input, but with different bytecode; there are always more ways to skin a fish
p70512
as(dp70513
g16
V100297
p70514
stp70515
a((dp70516
g2
(lp70517
VYou did not define a class, you defined a function:
p70518
aVMake that a class:
p70519
aVNext exception then is that you cannot assign to a set:
p70520
aVyou probably wanted  to be a dictionary:
p70521
as(dp70522
g16
V100297
p70523
stp70524
a((dp70525
g2
(lp70526
VYou can tell Flask-Principal that you want to raise a specific HTTP error code instead:
p70527
aVNow  will be called instead of raising
p70528
aVFor the 403 error code you can then register an error handler:
p70529
aVwhere  would return the route URL for a login page
p70530
as(dp70531
g16
V100297
p70532
stp70533
a((dp70534
g2
(lp70535
VYou can use  to write rows of data to another CSV file, or use  to write dictionaries with row data
p70536
aVThe latter does require that you specify fieldnames up front
p70537
aVCopying across CSV rows could best be done straight when reading:
p70538
aVHere  takes an iterable of rows; a  object happens to be an iterable, so this copies data straight across
p70539
aVYou can add additional dialect parameters t othe  and  constructors to change the format; say you read with  (tab separated) and write out the default comma-separated format
p70540
aVIf you want to process each row in between, use a loop:
p70541
aVThe  (singular) method takes one row at a time to write out
p70542
aVTo copy across dictionary rows, you need to specify the fields
p70543
aVUse a  object to produce the dictionaries, it'll handle fieldnames from the first CSV row for you:
p70544
aVHere, the  parameter is taken straight from the  attribute
p70545
aVAgain, process rows in a loop as required, same as with a regular  /  pair
p70546
as(dp70547
g16
V100297
p70548
stp70549
a((dp70550
g2
(lp70551
VYou can nest dictionaries:
p70552
aVor you can use tuple keys instead:
p70553
aVNesting would make it easier to list all known versions for a given model:
p70554
aVCreating a nested dictionary setup can be simplified a little by using :
p70555
aVHere trying to access  automatically creates a new dictionary value
p70556
as(dp70557
g16
V100297
p70558
stp70559
a((dp70560
g2
(lp70561
VA generator object needs to be looped over:
p70562
aVAlternatively, you can use the  function on a generator to get one value from it
p70563
aVYour first example had a syntax error, because you misspelled
p70564
aVYour exception handler tries to , but the function doesnt actually define that name
p70565
aVNote that neither of your solutions flattens the lists, you are still 'summing' tuples
p70566
aVWorking example:
p70567
aVIf instead you wanted to flatten the lists, flatten them first, then  the flattened results together to sum:
p70568
aVDemo:
p70569
as(dp70570
g16
V100297
p70571
stp70572
a((dp70573
g2
(lp70574
V takes only one argument, not more
p70575
aVOnly the  function handles more than one argument for you
p70576
aVYou need to format your string to one argument instead of trying to 'format' the return value of the  function:
p70577
aVor use the  function to add the newlines and the separators:
p70578
aVas function is the default in Python 3; if you are using Python 2 you can turn  the statement into  the function by adding:
p70579
aVat the start of your module
p70580
aVNote that the original excercise code writes the lines to the file without spaces in between
p70581
as(dp70582
g16
V100297
p70583
stp70584
a((dp70585
g2
(lp70586
VYes, that works with any date in that format, because they are:
p70587
aVusing the same length, zero-padded numbers
p70588
aVin the same order
p70589
aVordered by most significant to least significant; year, month, day, hour, minute, second
p70590
aVThis makes them lexicographically orderable, which is exactly the order sorting would apply
p70591
as(dp70592
g16
V100297
p70593
stp70594
a((dp70595
g2
(lp70596
VYou are muddling up the syntax; you were almost there
p70597
aVThis works:
p70598
ag7233
ag1298
aVcall the  function, and pass in the list to sort as the first argument
p70599
aVThe other two arguments are keyword arguments (, and )
p70600
aVDemo:
p70601
aVYou can also sort the list in-place:
p70602
aVwith the same two keyword arguments
p70603
as(dp70604
g16
V100297
p70605
stp70606
a((dp70607
g2
(lp70608
VYou are testing for an integer, put are passing in a string
p70609
aVThey may print the same, but integers and strings never test as equal in Python
p70610
aVTest for the string instead:
p70611
aVBecause your  fails for , your function never reaches a  statement, leaving Python to return the default  instead
p70612
as(dp70613
g16
V100297
p70614
stp70615
a((dp70616
g2
(lp70617
VYou want to access the second element of the tuple to sum; not  (the string):
p70618
aVbut make that the first  statement, not the second
p70619
aVYou can turn the whole loop into a list comprehension, using tuple unpacking to give easier to follow names to the two elements of each tuple:
p70620
aVDemo:
p70621
as(dp70622
g16
V100297
p70623
stp70624
a((dp70625
g2
(lp70626
VYou are comparing strings with an integer:
p70627
aVIn Python 2, strings always sort after numbers:
p70628
aVAs a result,  remains just the initial value, the integer
p70629
aVIf your loop had worked, you would have had an error telling you you cannot concatenate integers and strings
p70630
aVCompare against a string instead, and start  as an empty string, and if you want  to be included, test for lower or equal:
p70631
aVor, much simpler, just concatenate the first 6 values in your list; your list contains the digits from  through to  in sorted order:
p70632
as(dp70633
g16
V100297
p70634
stp70635
a((dp70636
g2
(lp70637
VThat's because instances of  are not a simple type
p70638
aVBecause you gave  a  method, the instance is printed as it's JSON representation, but it is not itself a supported JSON type
p70639
aVRemove the  method and the traceback is much less confusing:
p70640
aVUse the  keyword argument to encode custom objects:
p70641
aVDemo:
p70642
as(dp70643
g16
V100297
p70644
stp70645
a((dp70646
g2
(lp70647
VYou added the Django top-level package to your :
p70648
aVRemove that entry, and don't add top-level packages to your path
p70649
aVPython finds the  top-level package in that directory first, so you are now effectively importing the  package, which does not have a  module
p70650
aVYou should only add the parent directory of a package to your path
p70651
aVand  are both already listed, so you do not need any of the following:
p70652
as(dp70653
g16
V100297
p70654
stp70655
a((dp70656
g2
(lp70657
VYour  expression is filtering, removing anything non-ASCII; you could use a conditional expression instead:
p70658
aVThis handles characters one by one and would still use one space per character replaced
p70659
aVYour regular expression should just replace consecutive non-ASCII characters with a space:
p70660
aVNote the  there
p70661
as(dp70662
g16
V100297
p70663
stp70664
a((dp70665
g2
(lp70666
VTo write out the data to CSV, simply use the  module and give it one row; constructing the row is not that hard:
p70667
aVThis produces:
p70668
as(dp70669
g16
V100297
p70670
stp70671
a((dp70672
g2
(lp70673
VYou are removing the  and  local names, and are not touching the dictionary
p70674
aVTo delete from a dictionary, you need to apply  to the key:
p70675
aVYou may want to use some more descriptive names:
p70676
aVand, because testing your code is always a good idea, a demo:
p70677
aVIf your values are lists and you need to remove just one of the values, then you need to use , or use a list comprehension
p70678
aVFirst the  option, which removes just one value
p70679
aVIf the value is repeated, only the first occurrence is removed:
p70680
aVThe list comprehension will remove all copies of the value:
p70681
aVDemo of :
p70682
aVDemo of the list comprehension:
p70683
as(dp70684
g16
V100297
p70685
stp70686
a((dp70687
g2
(lp70688
VI believe you are trying to append items from  to the nested list values in  until all value  are used, cycling over  from the start if there are fewer nested lists than initial values to append
p70689
aVUse  to pair up nested lists with  items:
p70690
aVThe  function here ensures that all values from  are used;  stops at the shortest list, which will always be  here
p70691
aVDemo with an initial list of 10 values (integers  through to ) and a nested list with 4 empty sublists:
p70692
aVNot using cycling would require you to keep a counter and append to
p70693
aVThe counter can be generated with the  function:
p70694
as(dp70695
g16
V100297
p70696
stp70697
a((dp70698
g2
(lp70699
VIn Python 3, you need to use  (with a bytes value) to simulate an uploaded file:
p70700
aVNote the  string defining a  literal
p70701
aVIn the Python 2 test examples, the  object holds a byte string, not a  value, and in Python 3,  is the equivalent
p70702
as(dp70703
g16
V100297
p70704
stp70705
a((dp70706
g2
(lp70707
VJust chain the item syntax:
p70708
aVIf all you have is  you'd have to search:
p70709
aVThis loops over all nested dictionaries (the values of ) and if  is present in it, it'll return that value
p70710
aVIf multiple dictionaries have the same key, which key is picked is undefined, as Python dictionaries do not promise a specific ordering
p70711
as(dp70712
g16
V100297
p70713
stp70714
a((dp70715
g2
(lp70716
VYou need to test against a sequence or set using a membership test ():
p70717
aVor, more compact in a list comprehension:
p70718
aVThis lists all keys in  whose value is not listed in the set
p70719
aVIf loop efficiency is of the utmost importance and you are using a Python version before 3
p70720
aV3, then store the set in a local variable first and use that in the loops:
p70721
aVor the list comp version:
p70722
aVPython 3
p70723
aV3 recognizes  or  syntax (with a set) and optimizes the code to use a local  constant for the set literal
p70724
as(dp70725
g16
V100297
p70726
stp70727
a((dp70728
g2
(lp70729
VYou need to store the returned input:
p70730
aVNow you have a variable you can work with
p70731
aVYou'd need to return that from the function:
p70732
aVand when store the return value of the function call:
p70733
as(dp70734
g16
V100297
p70735
stp70736
a((dp70737
g2
(lp70738
VBy installing it in a location that is listed earlier in
p70739
aVThe directory your project is in, for example, is always listed first in  and other packages in the same directory will be found before system locations
p70740
aVIn other words, put  in the same folder as your script and it'll Just Work
p70741
aVYou can also add entries to  by listing them in the  environment variable; these will be inserted into  before system locations
p70742
as(dp70743
g16
V100297
p70744
stp70745
a((dp70746
g2
(lp70747
VUse :
p70748
aVIf the key is not present, this returns the default , which is a falsey value
p70749
aVYou could give it a default value :
p70750
aVbut that's redundant in this context, really
p70751
as(dp70752
g16
V100297
p70753
stp70754
a((dp70755
g2
(lp70756
VYou can generate the query with a little string magic:
p70757
aVand then just pass  as a parameter to the  call:
p70758
aVFor your list of 5 elements, this produces:
p70759
as(dp70760
g16
V100297
p70761
stp70762
a((dp70763
g2
(lp70764
VNo, you cannot change the representation of a function object; if you wanted to add documentation, you'd add a docstring:
p70765
aVand access that with  or
p70766
aVYou can create a callable object with a custom , which acts just like a function:
p70767
aVDemo:
p70768
as(dp70769
g16
V100297
p70770
stp70771
a((dp70772
g2
(lp70773
V extends a list in place
p70774
aVPython standard library methods that alter objects in-place always return  (the default); your list comprehension executed  twice and thus the resulting list consists of two  return values
p70775
aVYour  calls otherwise worked just fine; if you were to print  it would show:
p70776
aVYou don't see the  return value in the Python interpreter, because the interpreter never echoes  results
p70777
aVYou could test for that explicitly:
p70778
as(dp70779
g16
V100297
p70780
stp70781
a((dp70782
g2
(lp70783
VNo, using a dict comprehension creates separate instances
p70784
aVThat is the point of a dict comprehension; the left-hand side expressions for key and value are evaluated each iteration
p70785
aVDemo:
p70786
aVHere separate lists are created
p70787
aVIf you were to use, say,  then you would be sharing the same value:
p70788
aVBecause your dict comprehension uses a literal dict expression for the  keyword, the dict you pass to the  instance is unique and not shared between values in the resulting dictionary
p70789
aVJust stick to your dict comprehension, it is working just fine
p70790
as(dp70791
g16
V100297
p70792
stp70793
a((dp70794
g2
(lp70795
VIf the  call succeeded,  is already a number
p70796
aVYou can only call  (the correct name) on a string:
p70797
aVThe alternative is to use exception handling; if a  is thrown, the input was not a number:
p70798
aVInstead of using the  function and removing the starting , you could also use the  function, using the  format, to format an integer as a binary string, without the leading text:
p70799
aVThe  function makes it easy to add leading zeros:
p70800
as(dp70801
g16
V100297
p70802
stp70803
a((dp70804
g2
(lp70805
VYou can put a function definition anywhere
p70806
aVWhat counts is the visibility of the name
p70807
aVA  compound statement includes an implicit  assignment; the name  is bound to a new function object
p70808
aVWhenever you want to use  (call it, or otherwise refer to it), the name must be visible
p70809
aVThat means you can define functions in any order, as long as they are reachable when called
p70810
aVFor example:
p70811
aVworks, because  is not called until the end
p70812
aVIt uses the name , which is a global, and  is bound to the result of , after  was defined but before  was called
p70813
aVIn  we defined a function , and returned it
p70814
aVis a local variable inside of , not visible outside of that function, but because we returned the function object, we can assign it to a global name
p70815
aVIn other words, functions follow the same rules as regular variables in Python; mostly, you define them as globals, but you can create them inside functions too
p70816
as(dp70817
g16
V100297
p70818
stp70819
a((dp70820
g2
(lp70821
VA  is nothing but a class generated with a factory function:
p70822
aVHere  is a class object (a subclass of ), and calling it will create instances of the class:
p70823
aVIf you wanted to have a list of these results, you need to explicitly build that list:
p70824
as(dp70825
g16
V100297
p70826
stp70827
a((dp70828
g2
(lp70829
VYou can improve a little on your attempt by using a compound key:
p70830
aVThe alternative would be to sort  and use , but because of the sort that is more costly
p70831
as(dp70832
g16
V100297
p70833
stp70834
a((dp70835
g2
(lp70836
VThe  module is always part of a package
p70837
aVInclude the package name when importing:
p70838
aVDemo:
p70839
as(dp70840
g16
V100297
p70841
stp70842
a((dp70843
g2
(lp70844
VDon't print your newlines, write them to the file instead:
p70845
aVYou could use some tuple unpacking to make it a little clearer what you are enumerating, and you can drop the  list comprehension and use a generator expression instead (saves some memory and processing):
p70846
aVI also gave the  function a second argument, the start value, so you don't have to  each number, and added the space in the file output in the string formatting
p70847
aVYou would normally write the newline after writing a line; and if you wanted a counter per line, add another enumerate::
p70848
aVor, by using  you can create a whole line in one go, using formatting to include the prefix and newline in one formatting operation:
p70849
aVwhich neatly avoids a trailing space as well
p70850
as(dp70851
g16
V100297
p70852
stp70853
a((dp70854
g2
(lp70855
VText content in XML (character data) must escape the , and  characters using pre-defined XML entities
p70856
aVPython code is no exception:
p70857
aVwhere  is replaced with  and  with
p70858
aVA proper XML parser will return text content un-escaped, replacing such entities with the original characters
p70859
as(dp70860
g16
V100297
p70861
stp70862
a((dp70863
g2
(lp70864
VUse  to return a default value if the key is not present:
p70865
aVHere,  returns the value associated with  if present in the dictionary, otherwise it'll return
p70866
aVCombine this with a loop and  and you can add all those keys to the list in one line:
p70867
as(dp70868
g16
V100297
p70869
stp70870
a((dp70871
g2
(lp70872
VThis'll do it:
p70873
aVThis first tests if the file exists; if it does not an empty dictionary is returned
p70874
aVIf there are spaces between the names, use ; this'll split on the last whitespace within the line only:
p70875
aVwhich will turn:
p70876
aVinto
p70877
aVNote the  statement here also
p70878
aVThis uses the file object as a context manager, meaning that as soon as the block exits (using , due to an exception or simply because the block ends) then the file is automatically closed for you
p70879
aVYour  line on the other hand will never be executed as it is placed after the  statement
p70880
aVThe above, of course, gives us strings for values
p70881
aVLets expand this to produce integer values instead:
p70882
aVThis produces:
p70883
aVfor my sample input
p70884
as(dp70885
g16
V100297
p70886
stp70887
a((dp70888
g2
(lp70889
VIf you want to join your strings with separators, then use :
p70890
aVbut you really want to use the  module to write CSV files:
p70891
aVNote that  expects a list of columns, so if each string in your input list is one row, wrap it in a list
p70892
aVThe CSV module uses  as the line separator by default:
p70893
aVIf you are trying to write every two values from your list as one row, then do so:
p70894
aVfor a simple method, or generate your list to have a nested structure:
p70895
aVor write the rows as you produce them
p70896
as(dp70897
g16
V100297
p70898
stp70899
a((dp70900
g2
(lp70901
VYou forgot the :
p70902
aVbut  is not excessive, really
p70903
aVYou should always allow for subclasses, it'll make your life easier at some point
p70904
aVWhy close the door on that option
p70905
as(dp70906
g16
V100297
p70907
stp70908
a((dp70909
g2
(lp70910
VStore the output in a variable first:
p70911
as(dp70912
g16
V100297
p70913
stp70914
a((dp70915
g2
(lp70916
VIf the lines are not sorted, track the maxima using a dictionary or  to track the maximum values:
p70917
aVA regular dictionary would work too; you'd use  and  instead
p70918
aVIn the above sample code I use  to split on the last whitespace in the line that separates two words; this ensures that we grab just the integer value at the end of the line
p70919
aVThe rest of the line is used as the key
p70920
aVIf the 'key' is only taken from part of the line, then split out the line further, and store both the maximum and the line
p70921
aVIf the values are really floats, you may want to start out with  as the 'maximum' for that key so far:
p70922
aVNow both the maximum value and the whole line with that maximum are stored, per key
p70923
aVWhat you pick for a key is up to you; I picked the first two columns
p70924
as(dp70925
g16
V100297
p70926
stp70927
a((dp70928
g2
(lp70929
VUse a list comprehension with  and a generator expression:
p70930
aVDemo:
p70931
as(dp70932
g16
V100297
p70933
stp70934
a((dp70935
g2
(lp70936
VYour recursive function doesn't return a value for
p70937
aVReturn something from your function for those cases, otherwise  is returned instead
p70938
aVMost likely you want to return  in all cases:
p70939
aVThis then works:
p70940
as(dp70941
g16
V100297
p70942
stp70943
a((dp70944
g2
(lp70945
VUse a dict comprehension to produce your new output:
p70946
aVwhere  is the key to search on
p70947
aVDemo:
p70948
aVTo sum all values by color, use a  to sum the values:
p70949
aVwhich gives:
p70950
as(dp70951
g16
V100297
p70952
stp70953
a((dp70954
g2
(lp70955
VNo, the function does not know where it is being called from or whom holds references to it
p70956
aVAt best you can access the parent calling frame (with ), but that is not necessarily a decorator
p70957
aVGenerally, if your function needs access to a value from the calling frame, it is best to just pass it in
p70958
aVHave the  decorator call the wrapped function with an extra argument, for example
p70959
as(dp70960
g16
V100297
p70961
stp70962
a((dp70963
g2
(lp70964
VGet the first value with the  function:
p70965
aVThis assumes the iterable is finite
p70966
aVFor an empty iterable,  and  are set to
p70967
aVFor an iterable with just one element,  and  will both refer to that one element
p70968
aVFor any other finite iterable,  will have the first element,  the very last
p70969
as(dp70970
g16
V100297
p70971
stp70972
a((dp70973
g2
(lp70974
VYou need to make sure that the indentation is correct:
p70975
aVwould be correct, but in your case the indentation is really:
p70976
aVwhich means that  is now referring to the last line
p70977
aVYou probably are mixing tabs and spaces; don't do that
p70978
aVRun your script with  to detect any inconsistent tabbing and replace all tabs with spaces in your editor
p70979
as(dp70980
g16
V100297
p70981
stp70982
a((dp70983
g2
(lp70984
VThere is no  module
p70985
aVis an attribute of the  module:
p70986
aVor use:
p70987
aVThis assumes that you are passing exactly 3 command-line arguments to your script
p70988
as(dp70989
g16
V100297
p70990
stp70991
a((dp70992
g2
(lp70993
VNo,  and  only work with attributes on an object
p70994
aVWhat you are trying to access are local variables instead
p70995
aVYou can use  to access a dictionary of local names:
p70996
aVbut it'd be better just to name the lists directly, there is no need to go through such trouble here:
p70997
as(dp70998
g16
V100297
p70999
stp71000
a((dp71001
g2
(lp71002
VUse  instead:
p71003
aVor, for your specific varargs version:
p71004
aVor map the results to lists if tuples won't do:
p71005
aVAs a replacement for your function:
p71006
as(dp71007
g16
V100297
p71008
stp71009
a((dp71010
g2
(lp71011
VUse  to split a string into words, counting from the right
p71012
aVIf you pass in  it'll split on arbitrary-width whitespace, giving you neat stripped strings, and a count, letting you keep whitespace in the first column
p71013
aVShort demo of what that means:
p71014
aVHere the spaces in the name are preserved, but the two numbers at the end are now separate elements in a list
p71015
aVThe newline at the end is gone
p71016
aVIf you loop over an open file object, you get separate lines, giving you a method to parse a file line by line:
p71017
as(dp71018
g16
V100297
p71019
stp71020
a((dp71021
g2
(lp71022
VYou are loading the wrong URL
p71023
aVThe form has an  attribute:
p71024
aVso you must post your login information to:
p71025
aVinstead of posting back to the login page
p71026
aVPOST to  instead:
p71027
aVYour code is handling cookies just fine; I can see that  holds a cookie after requesting the login form, for example
p71028
aVIf this still doesn't work (a 404 is returned), then the server is using additional techniques to detect scripts vs
p71029
aVreal browsers
p71030
aVUsually this is done by parsing the request headers
p71031
aVLook at your browser headers and replicate those
p71032
aVIt may just be the  header that they parse, but  headers and  can also play a role
p71033
as(dp71034
g16
V100297
p71035
stp71036
a((dp71037
g2
(lp71038
VIf you provide a custom  method I believe you can still use pickling
p71039
aVNormally, when pickling, the class import path is stored, plus instance state
p71040
aVOn unpickling, the class is imported, and a new instance is created using the stored state
p71041
aVThis is why pickling cannot work with dynamic classes, there is nothing to import
p71042
aVThe  method lets you store a different instance factory
p71043
aVThe callable returned by this function is stored (again by import path), and called with specified arguments to produce an instance
p71044
aVThis instance is then used to apply state to, in the same way a regular instance would be unpickled:
p71045
aVHere  returns a function, the arguments for the function, and the instance state
p71046
aVAll you need to do then, is provide the right arguments to the factory function to recreate the class, and return an instance of that class
p71047
aVIt'll be used instead of importing the class directly
p71048
as(dp71049
g16
V100297
p71050
stp71051
a((dp71052
g2
(lp71053
VYou cannot tell how an object is going to used in the  hook, at all
p71054
aVYou can access methods without calling them, store them in a variable, and later call them, for example
p71055
aVReturn an object with a  method, it'll be invoked when called:
p71056
aVbut instances of this will not be the same thing as a string or a list at the same time
p71057
aVDemo:
p71058
as(dp71059
g16
V100297
p71060
stp71061
a((dp71062
g2
(lp71063
VWhen you access a method on a class, it is wrapped at that moment; methods act as descriptors here
p71064
aVYou may want to unwrap the method again, returning a wrapped wrapper:
p71065
aVNow the returned decorator is itself a class method, and wrapping works:
p71066
as(dp71067
g16
V100297
p71068
stp71069
a((dp71070
g2
(lp71071
VUse the  module to simplify fractions:
p71072
aVFrom the  function:
p71073
aVFinds and returns the closest  to  that has denominator at most max_denominator
p71074
aVThis method is useful for finding rational approximations to a given floating-point number
p71075
aVFloating point numbers are limited in precision and cannot represent many numbers exactly; what you see is a rounded representation, but the real number is:
p71076
aVbecause a floating point number is represented as a sum of binary fractions; 1/5 can only be represented by adding up 1/8 + 1/16 + 1/128 + more binary fractions for increasing exponents of two
p71077
as(dp71078
g16
V100297
p71079
stp71080
a((dp71081
g2
(lp71082
VThe line comes from the  value
p71083
aVIf you symlink the python executable, and run Python from that symlink,  would use the new path
p71084
aVUpdating or reinstalling the tool would reflect the changed executable path, yes
p71085
aVI am not aware of any method to make  and friends use  instead
p71086
aVThat'd be a bad idea, really, as that would make it harder to use the correct Python all the time, the one where the installed packages can be found needed to run the command-line script
p71087
as(dp71088
g16
V100297
p71089
stp71090
a((dp71091
g2
(lp71092
VAll you need to do is sum the number of characters in each line ():
p71093
as(dp71094
g16
V100297
p71095
stp71096
a((dp71097
g2
(lp71098
VYou appended  to , then popped it off again and appended  to
p71099
aVHere is what happens step by step:
p71100
aVadds  as a single value to ;  is now:
p71101
aVnote the nested list;  adds the argument as a single entry in the target list
p71102
aVYou then test if  is in ; it is not, it is in a nested list:
p71103
aVThe  branch uses  to remove the last element, which is a whole nested list, and appends  to it;  still refers to that last list:
p71104
aVYou probably wanted to extend  instead, adding just the elements of  to :
p71105
aVNow  is , and  is not going to be affected
p71106
as(dp71107
g16
V100297
p71108
stp71109
a((dp71110
g2
(lp71111
VYou can put the assignments on one line:
p71112
aVYou can pick the source list in one line too:
p71113
aVThis updates  or  if either of them had elements through slice assignment
p71114
aVDemo:
p71115
aVThat said, I think you should stick to your original version
p71116
aVIt is more efficient ( or  on a  expands the existing  object, the above code always builds an entirely new object, even when  and  are both empty), and is clear and simple, so more readable
p71117
aVIt's great that we get to show off our Python fu from time to time, but this may not be the place, actually
p71118
aV:-)
p71119
as(dp71120
g16
V100297
p71121
stp71122
a((dp71123
g2
(lp71124
VYou created a , not a dictionary
p71125
aVYou need to specify key-value pairs:
p71126
aVor specify the nested dictionary in literal notation in-place:
p71127
aVThe  syntax (no keys) is the set literal notation
p71128
as(dp71129
g16
V100297
p71130
stp71131
a((dp71132
g2
(lp71133
VYou can use a list comprehension to generate the dictionaries based on each tuple in :
p71134
aVYou could also use tuple assignment to produce more meaningful names in the loop
p71135
aVYou can do this in an explicit for loop too, but the list comprehension will be faster
p71136
aVThe explicit loop version:
p71137
aVHere  is the name used by convention for a loop variable that we are ignoring
p71138
aVIt simply signifies that we won't use  any further, but needed an assignment target
p71139
as(dp71140
g16
V100297
p71141
stp71142
a((dp71143
g2
(lp71144
VList the three criteria in your key:
p71145
aVNow you are sorting each element first by the length, then by comparing the first element directly (which in only used when the first element is of equal length), then by the value of the last integer
p71146
aVPython sorts tuples and lists like these lexicographically; compare the first element, and only if that doesn't differ, compare the second element, etc
p71147
aVThe second element here is  which will only be used if both compared entries have nested lists of equal length
p71148
aVThese are again compared lexicographically, so pairing up elements until a pair differs
p71149
as(dp71150
g16
V100297
p71151
stp71152
a((dp71153
g2
(lp71154
VAdd another level, with a tuple (just the comma):
p71155
aVor with a list:
p71156
aVor pick out the first element:
p71157
aVThe first two have the added advantage that they throw an exception if your dictionary has more than one key
p71158
aVDemo:
p71159
as(dp71160
g16
V100297
p71161
stp71162
a((dp71163
g2
(lp71164
VYou are using the wrong attribute name:
p71165
aVThe correct attribute is , not :
p71166
as(dp71167
g16
V100297
p71168
stp71169
a((dp71170
g2
(lp71171
VThe return value of the wrapped function is passed (as one argument) to ; anything that a normal Flask view can return is acceptable
p71172
aVThe decorator is essentially the same as this Flask snippet
p71173
aVBecause the Flask-restful  is a subclass of  you should really not put decorators directly on the methods here
p71174
aVAs documented in Decorating Views you should list view decorators in a special class attribute,  which is a list:
p71175
aVand Flask will apply the view to the actual view method returned by , which is what Flask actually calls when dispatching the route to the view
p71176
aVApplying them directly to the methods will only server to confuse the  dispatcher as it is expecting methods to return python datastructures suitable for encoding to JSON, which is not what  returns anyway
p71177
as(dp71178
g16
V100297
p71179
stp71180
a((dp71181
g2
(lp71182
VUse sets instead of lists:
p71183
aVNow you can use set operations:
p71184
aVYou can still turn each list in  and  into a set in the generator expression passed to , but that'd be a waste of CPU cycles
p71185
aVDemo:
p71186
as(dp71187
g16
V100297
p71188
stp71189
a((dp71190
g2
(lp71191
VSimple:
p71192
aVThe  caret matches the start of the string,  a tab character, of which there should be zero or more ()
p71193
aVThe parenthesis capture the matched tabs for use in the replacement string, where  inserts them again in front of the string you need adding
p71194
aVDemo:
p71195
as(dp71196
g16
V100297
p71197
stp71198
a((dp71199
g2
(lp71200
VYou are sorting your keys lexicographically (i
p71201
ag7233
aValphabetically), not by length
p71202
aVYou are also sorting them way too often
p71203
aVSort just once, on length:
p71204
aVBecause a dictionary, when iterated over, produces just the keys, you don't even need to call  here
p71205
aVDemo:
p71206
aVIf you need all words of the same length as the first:
p71207
aVor a little more advanced, using :
p71208
as(dp71209
g16
V100297
p71210
stp71211
a((dp71212
g2
(lp71213
VUse the  class and have it do the work for you:
p71214
aVTo simplify fractions yourself, calculate the greatest common divisor:
p71215
as(dp71216
g16
V100297
p71217
stp71218
a((dp71219
g2
(lp71220
VYou need to call your functions:
p71221
aVJust referring to a function object means your first  will match, as most Python objects are considered true in a boolean context
p71222
aVYou can return early, simplifying your function a little:
p71223
as(dp71224
g16
V100297
p71225
stp71226
a((dp71227
g2
(lp71228
V is empty
p71229
aVThere is no  when a list is empty
p71230
aVYou could test for this edgecase, perhaps:
p71231
as(dp71232
g16
V100297
p71233
stp71234
a((dp71235
g2
(lp71236
VThe following nested dict and list comprehensions will do it for you:
p71237
aVDemo:
p71238
aVI am actually surprised you didn't want to have one dictionary per value:
p71239
aVwhich produces:
p71240
as(dp71241
g16
V100297
p71242
stp71243
a((dp71244
g2
(lp71245
VYou are trying to use  as a function:
p71246
aVInsert a  to multiply:
p71247
aVor as a full expression:
p71248
as(dp71249
g16
V100297
p71250
stp71251
a((dp71252
g2
(lp71253
VIt removes all empty strings from a list, inefficiently
p71254
aVtests if  is a member of ; it'll loop over  to scan for the value
p71255
aVscans through  to find the first element in the list that is equal to  and remove it from the list:
p71256
aVSo, the code repeatedly scans  for empty strings, and each time one is found, another scan is performed to remove that one empty string
p71257
aVwould be a different, more efficient way of accomplishing the same task
p71258
aVThis uses a list comprehension; loop over all values in  and build a new list object from those values, provided they are not equal to the empty string
p71259
as(dp71260
g16
V100297
p71261
stp71262
a((dp71263
g2
(lp71264
VLocal variables in a function are not visible as attributes on that function
p71265
aVFor a nested scope, just use the name directly:
p71266
aVHere  will be attached to  as a closure, and Python will attach the parent scope  to the function for later dereferencing
p71267
aVYou do need to store the returned value; I guessed that you wanted to assign it to  here
p71268
as(dp71269
g16
V100297
p71270
stp71271
a((dp71272
g2
(lp71273
VYes, as you don't have any other reference to the class from within a static method
p71274
aVYou could make these class methods instead, using the  decorator:
p71275
aVA class method does have a reference to the class
p71276
as(dp71277
g16
V100297
p71278
stp71279
a((dp71280
g2
(lp71281
VUse  to produce pairs, which you can then append to your output:
p71282
aVor you can nest the loops:
p71283
as(dp71284
g16
V100297
p71285
stp71286
a((dp71287
g2
(lp71288
V is an error code in the C code, and no hash function can return it lest it signal a C code error instead
p71289
aVC doesn't have exceptions, so the Python developers had to reserve one return value for signalling an error
p71290
aVA dictionary doesn't use just a hash; it also tests for equality
p71291
aVNote that a hash table is small compared to the number of possible hash values, even when hash values are not equal they can still end up mapping to the same slot
p71292
aVIf a hash value maps to the same slot and the keys are not equal, the hash is perturbed and a new slot is found
p71293
aVBecause , Python still keeps both keys apart
p71294
aVSee Overriding Python's Hashing Function in Dictionary and Why the order in Python dictionaries is arbitrary
p71295
aVfor some more details on how Python's dictionary uses a hash
p71296
as(dp71297
g16
V100297
p71298
stp71299
a((dp71300
g2
(lp71301
VTo turn integers, representing bits, into 8-bit bytes (still as integers), use bit shifting:
p71302
aVor with :
p71303
aVThis can be turned into a binary string with , optionally with width and  prefixed to pad with zeros to a certain length
p71304
aVDemo:
p71305
aVIf you need to go straight to the binary string, just map the bits to strings and join:
p71306
aVPadding this further to 64 characters could be done with :
p71307
as(dp71308
g16
V100297
p71309
stp71310
a((dp71311
g2
(lp71312
VThe response you get from a server depens both on the exact protocol and server configuration
p71313
aVHTTP has a  header for example, but many server out on the internet lies about what server is responding, to throw off malicious hackers trying to exploit server-specific flaws
p71314
aVMoreover, the server remains silent until the client has sent a request; your code has to send something before there is any response
p71315
aVThe best you can do is try out different protocols and see if the other side responds sensibly
p71316
aVTrying to send an SSH handshake to a HTTP port is likely to result in a  response, for example
p71317
aVIn other words, there is no ready-made solution for this, you'll have to create your own heuristics based on what protocols you are trying to detect
p71318
as(dp71319
g16
V100297
p71320
stp71321
a((dp71322
g2
(lp71323
VYou could use  and :
p71324
aVDemo:
p71325
aVThis uses no additional memory, but requires your groups to be distinct and sorted; if there are two runs of , then each run is numbered separately
p71326
as(dp71327
g16
V100297
p71328
stp71329
a((dp71330
g2
(lp71331
VYou are manipulating paths, so use  to split and rejoin:
p71332
as(dp71333
g16
V100297
p71334
stp71335
a((dp71336
g2
(lp71337
VWhen Python 3 opens a text file, it sticks to the default encoding for your system when trying to decode the file, in order to give you full unicode text (the  type is fully unicode aware)
p71338
aVIt does the same when writing out such unicode text values
p71339
aVYou already solved the input side; you specified an encoding when reading
p71340
aVDo the same when writing: specify an codec to use to write out the file that can handle all of unicode, including the non-breaking whitespace character at codepoint U+FEFF
p71341
aVUTF-8 is usually a good default choice:
p71342
aVYou can use the  statement when writing too, and save yourself the  call:
p71343
as(dp71344
g16
V100297
p71345
stp71346
a((dp71347
g2
(lp71348
VUse , passing in a sequence of words to count:
p71349
as(dp71350
g16
V100297
p71351
stp71352
a((dp71353
g2
(lp71354
VAdd the  decorator to your view function:
p71355
aVThis decorator marks a view as being exempt from the protection ensured by the middleware
p71356
aVExample:
p71357
as(dp71358
g16
V100297
p71359
stp71360
a((dp71361
g2
(lp71362
VYou should use  directly on :
p71363
aVYou were trying to set keys to empty dictionaries, then calling  on those with just the value; this requires that that value is iterable; if one ofyour values is  that'd lead to your specific exception:
p71364
aVYour version could be 'repaired' by using simple item assignment:
p71365
aVbut using  like shown in my version is going to be more efficient
p71366
aVIf you have to have all values preserved in a list per key, then use:
p71367
aVHere,  will return the value for key , but if  is not yet present sets a default value (here a list)
p71368
as(dp71369
g16
V100297
p71370
stp71371
a((dp71372
g2
(lp71373
VReturn the first key instead (in reverse sorted order):
p71374
aVTry to avoid naming your variables ; this masks the built-in type and serves only to confuse
p71375
aVUse  instead, for example
p71376
aVHere is a simpler version:
p71377
aVNote that this version does away with sorting altogether
p71378
aVInstead, we update  as we go along with counting
p71379
aVYou also need to remember to split your sentence into words first:
p71380
as(dp71381
g16
V100297
p71382
stp71383
a((dp71384
g2
(lp71385
VYou loop over the dictionary keys, and increment  at the same time
p71386
aVThis means that for 3 keys,  loops from 0 to 2, but there are only ever 2 items in each value (0 and 1)
p71387
aVThis leads to your index error
p71388
aVInstead, use  to loop over the two lists, record the indices to keep, then apply that to all values in the whole dictionary:
p71389
aVThe last line builds a new dictionary using a dict comprehension (); basically a loop that builds keys and values for a dictionary
p71390
aVIt takes the keys from the  but alters the values
p71391
aVEach value is built using a list comprehension; another loop
p71392
aVHere we take all original values only when their index is in the set
p71393
aVWithout comprehensions, it'd look like this:
p71394
aVDemo:
p71395
as(dp71396
g16
V100297
p71397
stp71398
a((dp71399
g2
(lp71400
VThe code is meant to be used on unicode values; e
p71401
ag1298
aVyou need to decode your data to  before passing it in to the replacement reader
p71402
aVUse  read the data as Unicode:
p71403
aVThis basically temporarily encodes unicode to UTF8 for the CSV module to handle
p71404
aVBecause your data is already encoded to UTF8, you could get away with:
p71405
aVas well; so directly decode your row cells from UTF8 without decoding to Unicode first, then encoding again to UTF8 bytes then decoding again
p71406
as(dp71407
g16
V100297
p71408
stp71409
a((dp71410
g2
(lp71411
VYou are probably looking for , combined with  to test for all conditions:
p71412
aVHere  pairs up files and boxes, loops over each pair, and  returns  only if all the pairs match
p71413
aVQuick demos of what  and  do:
p71414
aVwhere  only needs to test enough of the generator expression to determine that there is one  value for it to return  as well
p71415
as(dp71416
g16
V100297
p71417
stp71418
a((dp71419
g2
(lp71420
VThe condition is executed before the repeat; you'd normally nest the statements to put the condition on a tag contained in the repeat
p71421
aVHowever, to put a conditional attribute, use  instead:
p71422
aVSetting an attribute to  removes it from the tag
p71423
as(dp71424
g16
V100297
p71425
stp71426
a((dp71427
g2
(lp71428
VYou missed a closing parenthesis:
p71429
aVbut that's not a correct statement still as  takes one string argument with optional encoding
p71430
aVIt'll be easier to use  to add a count, and pass in two arguments to :
p71431
as(dp71432
g16
V100297
p71433
stp71434
a((dp71435
g2
(lp71436
VCalling  on a dictionary returns just a list of the keys in sorted order
p71437
aVDictionaries themselves have no inherent order, you cannot sort those
p71438
aVBecause you re-assigned the output of  back to , you've now lost your reference to the original
p71439
as(dp71440
g16
V100297
p71441
stp71442
a((dp71443
g2
(lp71444
VNo, python applies positional arguments to all named arguments first;  is the third positional argument in the function signature and thus only argument positions 4 and over are captured by
p71445
aVInstead, use a  argument catching arbitrary keyword arguments and look  up in that:
p71446
aVYou'll now have to name  explicitly when calling :
p71447
as(dp71448
g16
V100297
p71449
stp71450
a((dp71451
g2
(lp71452
VQuoting from PEP 255, the proposal that introduced generators to Python, where Guido van Rossum (the Benevolent Dictator for Life, BDFL) explains why there is no separate keyword:
p71453
aVIssue:  Introduce another new keyword (say,  or ) in place of , or otherwise alter the syntax, to distinguish generator-functions from non-generator functions
p71454
aVCon:  In practice (how you think about them), generators are functions, but with the twist that they're resumable
p71455
aVThe mechanics of how they're set up is a comparatively minor technical issue, and introducing a new keyword would unhelpfully overemphasize the mechanics of how generators get started (a vital but tiny part of a generator's life)
p71456
aVPro:  In reality (how you think about them), generator-functions are actually factory functions that produce generator-iterators as if by magic
p71457
aVIn this respect they're radically different from non-generator functions, acting more like a constructor than a function, so reusing  is at best confusing
p71458
aVA  statement buried in the body is not enough warning that the semantics are so different
p71459
aVBDFL:   it stays
p71460
aVNo argument on either side is totally convincing, so I have consulted my language designer's intuition
p71461
aVIt tells me that the syntax proposed in the PEP is exactly right - not too hot, not too cold
p71462
aVBut, like the Oracle at Delphi in Greek mythology, it doesn't tell me why, so I don't have a rebuttal for the arguments against the PEP syntax
p71463
aVThe best I can come up with (apart from agreeing with the rebuttals
p71464
aValready made) is "FUD"
p71465
aVIf this had been part of the language from day one, I very much doubt it would have made Andrew Kuchling's "Python Warts" page
p71466
aVIn essence, a generator function produces a generator, it is not a generator itself
p71467
as(dp71468
g16
V100297
p71469
stp71470
a((dp71471
g2
(lp71472
VYou can loop within the loop, getting the next lines until you are at the end:
p71473
aVNote that  isn't needed;  gives you a dictionary object, with the row already split out into values already
p71474
aVis also a list of dictionaries, no need to put those through  again
p71475
aVAnd since you are already looping over that section of your input file, why not just directly in that loop do your work
p71476
aVSo, instead of a separate loop over  at the end, replace  with whatever work you need to do with the row:
p71477
as(dp71478
g16
V100297
p71479
stp71480
a((dp71481
g2
(lp71482
V returns a string, which is an entirely different object from  which is a Python dictionary
p71483
aVIf you wanted  to be treated as JSON, first parse it as such:
p71484
aVor parse it as a Python literal expression:
p71485
as(dp71486
g16
V100297
p71487
stp71488
a((dp71489
g2
(lp71490
VUse dictionary assignment:
p71491
aVor ever replace the whole code with a dict comprehension:
p71492
aVor
p71493
aVIf each  has a fixed number of entries, you can use tuple assignment:
p71494
aVor
p71495
aVto make a loop more readable
p71496
ag6579
ag1298
aVYour code instead creates a new set object (just unique values, no keys) each loop, replacing the previous one
p71497
as(dp71498
g16
V100297
p71499
stp71500
a((dp71501
g2
(lp71502
VIf  gives you an encoding exception, then it was already Unicode:
p71503
aVbecause Python 2 implicitly first tries to encode (with the default ASCII codec) when trying to 'decode' Unicode values
p71504
as(dp71505
g16
V100297
p71506
stp71507
a((dp71508
g2
(lp71509
VYou are reshuffling  while iterating over it, and appending references to the same list to  each time
p71510
aVThat means there is now  references to the same list added to
p71511
aVAs a result of the constant reshuffling, your are adding duplicates to  as well, which is why your resulting dictionary has fewer than 63 keys
p71512
aVIf you wanted to create 63 randomized copies of , plus 64th single list of the same list, use this instead:
p71513
aVThis creates a dictionary with  keys, each a randomized copy of
p71514
aVDictionaries have no ordering, so the input for that dict comprehension needs no shuffling itself
p71515
aVtakes a key function to determine how to compare values, by using  the returned list is in random order
p71516
aVThis produces:
p71517
as(dp71518
g16
V100297
p71519
stp71520
a((dp71521
g2
(lp71522
VYou are importing  instead of , remove the underscore
p71523
aVRemove the underscore from the  line too
p71524
aVIn general, do not use modules that start with an underscore, they are an internal implementation detail
p71525
as(dp71526
g16
V100297
p71527
stp71528
a((dp71529
g2
(lp71530
VIf you want to group on the first item of each tuple, you can do so with :
p71531
aVThe  returns the first element of each tuple, which  then gives you iterables for each group based on that value
p71532
aVLooping over each individual  result will then give you a sequence of tuples with just , then , etc
p71533
as(dp71534
g16
V100297
p71535
stp71536
a((dp71537
g2
(lp71538
VYou are dynamically importing a top level module , which is a different module from
p71539
aVBecause  doesn't include ,  is not found from , which is trying to import a top-level module  at that moment
p71540
aVThe  module, on the other hand tries to find first a top-level module , then a local
p71541
aVInstead, import :
p71542
as(dp71543
g16
V100297
p71544
stp71545
a((dp71546
g2
(lp71547
VJust loop and print:
p71548
aVStrictly speaking, because you return , you do not have a dictionary but a list of tuples instead
p71549
as(dp71550
g16
V100297
p71551
stp71552
a((dp71553
g2
(lp71554
VThere is a  function, as well as the  negative-stride slice:
p71555
aVBoth get the job done admirably when combined with the  method, but of the two, the negative stride slice is the faster method:
p71556
aVThis is because  really wants a list, to pass over the strings in the input list twice (once for allocating space, the second time for copying the character data), and a negative slice returns a list directly, while  returns an iterator instead
p71557
as(dp71558
g16
V100297
p71559
stp71560
a((dp71561
g2
(lp71562
VYou reached the limits of your platform's  support, probably after :
p71563
aVSee  for the exact limitations, but you are unlikely to run into a current CPU and OS combination that'll give you 100 significant digits in any case; my MacBook Pro with 64-bit OS X will only support 15
p71564
aVUse the  module to go beyond your hardware limitations
p71565
as(dp71566
g16
V100297
p71567
stp71568
a((dp71569
g2
(lp71570
V was removed because the  attribute to  and  is superior in most cases
p71571
aVIt was a hold-over from C more than anything, and was confusing to boot
p71572
aVHaving to implement a separate  method next to the rich comparison operators (, , etc
p71573
aVwas befuddling and unhelpful
p71574
aVYou can always use  to adapt an existing  function
p71575
aVYour specific example could have been implemented without a  function, of course, as integers are already orderable; just add
p71576
aVFor custom classes, use the  decorator to expand a  and one comparison operator method (e
p71577
ag1298
aV, or , etc
p71578
aVinto a full ordering implementation
p71579
as(dp71580
g16
V100297
p71581
stp71582
a((dp71583
g2
(lp71584
VUse the  module to read your format; it is after all comma-separated
p71585
aVPython uses 0-based indexing, so the count is the column at index 2, not 3
p71586
aVA  is the most efficient method of tracking the top N values of a given sequence
p71587
as(dp71588
g16
V100297
p71589
stp71590
a((dp71591
g2
(lp71592
VYou need to send data back;  just writes to your terminal
p71593
aVUse the  to send strings back to the client
p71594
aVSee the For the Programmers section of the README
p71595
aV: send some text or binary data to the client endpoint
p71596
aVsending a buffer as  will send a text based WebSocket frame otherwise a binary frame
p71597
as(dp71598
g16
V100297
p71599
stp71600
a((dp71601
g2
(lp71602
V needs to return  when adding in-place:
p71603
aVneeds to return the resulting object; for immutable types the new object, for mutable types,
p71604
aVQuoting the in-place operator hooks documentation:
p71605
aVThese methods should attempt to do the operation in-place (modifying ) and return the result (which could be, but does not have to be, )
p71606
as(dp71607
g16
V100297
p71608
stp71609
a((dp71610
g2
(lp71611
VThis line is invalid:
p71612
aVThere needs to be a value there:
p71613
as(dp71614
g16
V100297
p71615
stp71616
a((dp71617
g2
(lp71618
VYou are encoding twice:
p71619
aVNow each entry in  is a string representing a JSON object
p71620
aVRemove the  call:
p71621
aVor use  with a :
p71622
aVThis lets you use your  handler on the cursor objects still
p71623
as(dp71624
g16
V100297
p71625
stp71626
a((dp71627
g2
(lp71628
VYou are popping the item from the element, not the outer list
p71629
aVIf your elements are not lists, then don't try to treat them as such
p71630
aVYou cannot, however, remove items from the outer list while at the same time looping over it, and expect the loop to not jump items
p71631
aVIf you want to see if an item occurs more than once in the list, compare the length of the  of the list instead:
p71632
aVThis only works for hashable values, which nested lists are not, but at the very least does not alter the list in place, as your code would do
p71633
aVYou could still use a list scan, but then at least use  to limit the search to a start index beyond the current position:
p71634
aVHowever, this assumes you wanted to only test the outer list for duplicates
p71635
aVSupporting a nested structure and flat structures in the same code without more details on what you expect to happen in each case is much more complicated
p71636
as(dp71637
g16
V100297
p71638
stp71639
a((dp71640
g2
(lp71641
VYou are looping over each line in the file, so there will never be a line with both key and value
p71642
aVUse the  function to get the next line for a given key instead:
p71643
aVor, more compact with a dict comprehension:
p71644
as(dp71645
g16
V100297
p71646
stp71647
a((dp71648
g2
(lp71649
VJust test the length of ; if it is more than 2 you have an extra argument:
p71650
as(dp71651
g16
V100297
p71652
stp71653
a((dp71654
g2
(lp71655
VAll content types have a  attribute (the type id as listed in the  tool), as well as a  attribute (the type title)
p71656
aVThese are present even when listing content from the catalog
p71657
as(dp71658
g16
V100297
p71659
stp71660
a((dp71661
g2
(lp71662
VYou are trying to assign to the result of the  call, which is not going to work all too well
p71663
aVUse  and  directly; you only need the  call results to compare the student names:
p71664
aVTo swap two items in your list, just use multiple assignment (no need for an extra temporary variable):
p71665
aVWithout some more thought into the sorting algorithm, your simple loop will not, of course, result in a full sort
p71666
as(dp71667
g16
V100297
p71668
stp71669
a((dp71670
g2
(lp71671
VThis is not how globals in Python work
p71672
aVGlobals are limited to the module they are defined in
p71673
aVYou'll have to pass in your variables as arguments to  instead:
p71674
aVand
p71675
aVNote that you imported the module, so you need to refer to the function as an attribute of that module:
p71676
aVAlternatively, import just the function into your module namespace:
p71677
as(dp71678
g16
V100297
p71679
stp71680
a((dp71681
g2
(lp71682
V is a list with one element in it, and that element is a unicode string
p71683
aVIt is not a unicode string itself
p71684
aVThe  are a big hint there
p71685
aVGet the element out, slice, and put it back in a list:
p71686
aVEvidently the  function can return more than one match; you could also just pick the first one if you are expecting just one match:
p71687
aVIf your XPath queries do not always return a result, test for an empty list first:
p71688
as(dp71689
g16
V100297
p71690
stp71691
a((dp71692
g2
(lp71693
VYou are re-registering the  handler each time your loop iterates
p71694
aVPython calls the function as many times as it has been registered
p71695
aVRegister the function just once
p71696
aVYou don't need to call  in your  function either, you are already exiting your program
p71697
aVCorrected program:
p71698
aVAlternatively, catch the  and clean up in the exception handler:
p71699
aVThe  block calls  regardless of what exception occurred, the  just silences the keyboard interrupt exception
p71700
aVNote that the traceback was never in the  function, it is the reason the program is exiting and why  is called at all
p71701
aVIn other words, the exception preceeds the  function call
p71702
as(dp71703
g16
V100297
p71704
stp71705
a((dp71706
g2
(lp71707
VYes,  can return something else than the new instance:
p71708
aVDemo:
p71709
aVNote that  is not called if the returned object is not the same type (so  is ); that means that a custom  is never going to be called here
p71710
aVCall it explicitly:
p71711
as(dp71712
g16
V100297
p71713
stp71714
a((dp71715
g2
(lp71716
VYou are just building a string with no relationship to actual  query objects; start with the first  instance and add more:
p71717
as(dp71718
g16
V100297
p71719
stp71720
a((dp71721
g2
(lp71722
VIn Python 3, you'd use , which is easy enough to backport to older versions (Python 2, or Python 3
p71723
aV0 or 3
p71724
aV1):
p71725
aVQuick demo with  instead of  (whatever that may produce):
p71726
as(dp71727
g16
V100297
p71728
stp71729
a((dp71730
g2
(lp71731
VYou are removing elements from  while looping over it
p71732
aVThe  loop iterator does not update its index when you do that:
p71733
aVHere  was skipped because the iterator first processed , then moved to  which by that time was from a list with  in it, not
p71734
aVUse a  loop instead:
p71735
aVNow you control directly what index you are processing, and only increment  when not removing an element
p71736
as(dp71737
g16
V100297
p71738
stp71739
a((dp71740
g2
(lp71741
VUse a dictionary;  would be easiest:
p71742
aVThis assumes that you wanted the indices ordered by value sort order
p71743
as(dp71744
g16
V100297
p71745
stp71746
a((dp71747
g2
(lp71748
VUse the  API:
p71749
aVReturn the version of this Python interpreter
p71750
aVThis is a string that looks something like
p71751
aVThe first word (up to the first space character) is the current Python version; the first three characters are the major and minor version separated by a period
p71752
aVThe returned string points into static storage; the caller should not modify its value
p71753
aVThe value is available to Python code as
p71754
as(dp71755
g16
V100297
p71756
stp71757
a((dp71758
g2
(lp71759
VYou'd loop over  directly and use :
p71760
aVThere is no need to use recursion here; the above needs no globals either
p71761
aVTry to avoid global state, as that easily leads to hard-to-debug problems when you start using functions in multiple locations
p71762
as(dp71763
g16
V100297
p71764
stp71765
a((dp71766
g2
(lp71767
VInstead of trying to trace the origin of , test for its behaviour:
p71768
as(dp71769
g16
V100297
p71770
stp71771
a((dp71772
g2
(lp71773
VYou need to wait for the threads to finish; call  on each thread:
p71774
aVThe  method blocks until the thread has completed, or you can specify a timeout
p71775
as(dp71776
g16
V100297
p71777
stp71778
a((dp71779
g2
(lp71780
VYou cannot add columns to an existing CSV file; you'll have to rewrite the whole file, I'm afraid
p71781
aVYou can use the following context manager to make replacing a file a little easier:
p71782
aVUse this with the  module to add columns:
p71783
as(dp71784
g16
V100297
p71785
stp71786
a((dp71787
g2
(lp71788
VIt tells Python to ignore the newline directly following the backslash
p71789
aVThe resulting string starts with , not with :
p71790
aVNote how the two results differ; the first has no  newline character at the start, the other does
p71791
as(dp71792
g16
V100297
p71793
stp71794
a((dp71795
g2
(lp71796
VThe loop generates an index between  and , using that index both on  and
p71797
aVAs such,  is expected to be the same length
p71798
aVTo follow this through:
p71799
aVAs long as  is smaller than , keep looping
p71800
aVprint , with a space after it, no newline
p71801
aVloop from  to
p71802
aVThis'll loop  times
p71803
aVIn this  loop, print  with no newline, resulting in the character being printed  times
p71804
aVPrint a newline
p71805
aVIncrement
p71806
aVThe first iteration,  is , which is smaller than
p71807
aVis ,  is 3, so after printing ,  is printed 3 times
p71808
aVThe second iteration,  is , which is smaller than
p71809
aVis ,  is 4, so after printing ,  is printed 4 times
p71810
aVetc
p71811
aVuntil  is , at which point the  loop ends
p71812
aVThe code could be simplified to:
p71813
as(dp71814
g16
V100297
p71815
stp71816
a((dp71817
g2
(lp71818
VWithout the exact widget you used  for, it is hard to say exactly what arguments TKInter is trying to pass to it
p71819
aVYou can always give a callback a variable arguments parameter:
p71820
aVFrom this document you can see that a  callback is passed three arguments:
p71821
aVThe name of the Tk variable
p71822
aVThis is not the Tk variable object itself, but you can use the name to get or set the value via  and
p71823
aVUnfortunately, I have not found any way to obtain the actual Tk variable object from its name;  does not seem to work for Tk variables
p71824
aVThe variable index, if the Tk variable is an array, else an empty string
p71825
aVI have no idea how to create a Tk variable array in Tkinter (but it is easy in Tk)
p71826
aVIf you figure it out, you can then determine if the index is a string representation of an integer, or an integer (my guess is it's a string)
p71827
aVThe access mode, one of "w", "r" or "u"
p71828
aVYou do not need to call  each and every time  is called, however
p71829
as(dp71830
g16
V100297
p71831
stp71832
a((dp71833
g2
(lp71834
VIn my answer, I replaced  with  to not mask the built-in function
p71835
aVSorted keys by inverse value, then by key in ascending order:
p71836
aVBy turning the value into a negative number, this sorts on value in reverse, while keys are sorted in ascending order
p71837
aVDemo:
p71838
aVTiming comparisons:
p71839
as(dp71840
g16
V100297
p71841
stp71842
a((dp71843
g2
(lp71844
VIf the HTML is broken, reconstructing a workable element tree is not always possible
p71845
aVHowever, you can try using different backend parsers
p71846
aVNot all parsers can treat broken HTML the same
p71847
aVThe  parser is especially adept at dealing with broken HTML, handling such input the same as most browsers would:
p71848
aVYou can also try  here
p71849
aVBoth libraries are separate installs
p71850
as(dp71851
g16
V100297
p71852
stp71853
a((dp71854
g2
(lp71855
VRemove the  decorator, this only applies to function decorators
p71856
aVWith a newstyle class your decorator fails with:
p71857
aVWithout the  line your decorator works just fine:
p71858
as(dp71859
g16
V100297
p71860
stp71861
a((dp71862
g2
(lp71863
VUse the  function with a generator expression:
p71864
aVNote that this tests for greater than or equal to 30, otherwise  would not pass the test either
p71865
aVIf you wanted to do this in a function, you'd use:
p71866
ag7233
ag1298
aVas soon as you find a value that proves that there is a value below 30, you return , and return  if you found no evidence to the contrary
p71867
as(dp71868
g16
V100297
p71869
stp71870
a((dp71871
g2
(lp71872
VAt the very least, split out the values and keys into separate lists, then process just the values before reconstituting your dictionary, and use a short loop to pick an index for start and end trimming:
p71873
aVI'd use a utility function to remove a common prefix from a sequence of sequences, then pass in reversed sequences to remove trailing parts:
p71874
aVThis handles both your input and names of uneven length:
p71875
as(dp71876
g16
V100297
p71877
stp71878
a((dp71879
g2
(lp71880
VYes, move the  code to , then call  on your tree or pass it to the  statement
p71881
aVRemember to use  in the recursive calls too:
p71882
aVDemo:
p71883
as(dp71884
g16
V100297
p71885
stp71886
a((dp71887
g2
(lp71888
VYou are not building 4 lists, you are building one list, referenced 4 times:
p71889
aVMultiplying a list does not create copies of the values; instead only the reference is copied; appending to  will be reflected in all other references to the same list
p71890
aVUse a list comprehension:
p71891
aVIt'll be easiest to use slicing:
p71892
as(dp71893
g16
V100297
p71894
stp71895
a((dp71896
g2
(lp71897
VWhat representation is used is determined by the request, the  header mime type
p71898
aVA request of  will be responded to by using your  function
p71899
aVIf you need a specific response type from an API method, then you'll have to use  to return a 'pre-baked' response object:
p71900
as(dp71901
g16
V100297
p71902
stp71903
a((dp71904
g2
(lp71905
VYou need to bind  to a keyword argument when defining the :
p71906
aVNow  is a local (bound as an argument) instead of a global name
p71907
aVDemo:
p71908
as(dp71909
g16
V100297
p71910
stp71911
a((dp71912
g2
(lp71913
VWhen you use the  notation, then  is always a dictionary
p71914
aVCalling that function with  means you now have a dictionary with:
p71915
aVThe syntax is meant to accept arbitrary keyword parameters, illustrated by the  keyword argument above
p71916
aVEither remove the  or test for an empty dictionary, and don't set  when calling :
p71917
aVand:
p71918
aVNote that your  function has no  statement, which means that  will be set to  (the default return value for functions)
p71919
aVAdd  if you meant to return the connection object so that it can be iterated over
p71920
as(dp71921
g16
V100297
p71922
stp71923
a((dp71924
g2
(lp71925
VIf you make each file specification a tuple, you can specify the mime type as a third parameter:
p71926
aVYou can give a 4th parameter as well, which must be a dictionary with additional headers for each part
p71927
as(dp71928
g16
V100297
p71929
stp71930
a((dp71931
g2
(lp71932
VIn an ideal world, you'd be right and some of the inconsistencies you found would be wrong
p71933
aVHowever, CPython has optimized some scenarios, specifically function locals
p71934
aVThese optimizations, together with how the compiler and evaluation loop interact and historical precedent, lead to the confusion
p71935
aVPython translates code to bytecodes, and those are then interpreted by a interpreter loop
p71936
aVThe 'regular' opcode for accessing a name is , which looks up a variable name as you would in a dictionary
p71937
aVwill first look up a name as a local, and if that fails, looks for a global
p71938
aVthrows a  exception when the name is not found
p71939
aVFor nested scopes, looking up names outside of the current scope is implemented using closures; if a name is not assigned to but is available in a nested (not global) scope, then such values are handled as a closure
p71940
aVThis is needed because a parent scope can hold different values for a given name at different times; two calls to a parent function can lead to different closure values
p71941
aVSo Python has ,  and  opcodes for that situation; the first two opcodes are used in loading and creating a closure for a nested scope, and the  will load the closed-over value when the nested scope needs it
p71942
aVNow,  is relatively slow; it will consult two dictionaries, which means it has to hash the key first and run a few equality tests (if the name wasn't interned)
p71943
aVIf the name isn't local, then it has to do this again for a global
p71944
aVFor functions, that can potentially be called tens of thousands of times, this can get tedious fast
p71945
aVSo function locals have special opcodes
p71946
aVLoading a local name is implemented by , which looks up local variables by index in a special local names array
p71947
aVThis is much faster, but it does require that the compiler first has to see if a name is a local and not global
p71948
aVTo still be able to look up global names, another opcode  is used
p71949
aVThe compiler explicitly optimizes for this case to generate the special opcodes
p71950
aVwill throw an  exception when there is not yet a value for the name
p71951
aVClass definition bodies on the other hand, although they are treated much like a function, do not get this optimization step
p71952
aVClass definitions are not meant to be called all that often; most modules create classes once, when imported
p71953
aVClass scopes don't count when nesting either, so the rules are simpler
p71954
aVAs a result, class definition bodies do not act like functions when you start mixing scopes up a little
p71955
aVSo, for non-function scopes,  and  are used for locals and globals, and for closures, respectively
p71956
aVFor functions, ,  and  are used instead
p71957
aVNote that class bodies are executed as soon as Python executes the  line
p71958
aVSo in example 1,  inside  is executed as soon as  is executed, which is when you import the module
p71959
aVIn example 2,  is not executed until  is called, not before
p71960
aVLets walk through your examples:
p71961
aVYou have nested a class  in a class
p71962
aVClass bodies do not form nested scopes, so even though the  class body is executed when class  is executed, the compiler will use  to look up
p71963
aVis a function (bound to the  instance as a method), so it uses  to load
p71964
aVWe'll ignore attribute access here, that's a very well defined name pattern
p71965
aVHere  is at class scope, so the function  will skip the  scope and look at the  scope instead, using
p71966
aVHere  was determined to be a local by the compiler because you assign to it within the scope
p71967
aVFunctions are optimized, so  is used to look up the local and an exception is thrown
p71968
aVNow things get a little weird
p71969
aVis executed at class scope, so  is being used
p71970
aVwas deleted from the locals dictionary for the scope, so the second access to  results in the global  being found instead;  looked for a local first and didn't find it there, falling back to the global lookup
p71971
aVYes, this appears inconsistent with the documentation
p71972
aVPython-the-language and CPython-the implementation are clashing a little here
p71973
aVYou are, however, pushing the boundaries of what is possible and practical in a dynamic language; checking if  should have been a local in  would be possible but takes precious execution time for a corner case that most developers will never run into
p71974
aVNow you are confusing the compiler
p71975
aVYou used  in the class scope, and thus you are setting a local from a name outside of the scope
p71976
aVThe compiler finds  is a local here (you assign to it), so it never considers that it could also be a scoped name
p71977
aVThe compiler uses  for all references to  in this scope, because this is not an optimized function body
p71978
aVWhen executing the class definition,  first requires you to look up , so it uses  to do so
p71979
aVNo  is defined,  doesn't find a local, so the global  is found
p71980
aVThe resulting value is stored as a local, which happens to be named  as well
p71981
aVuses  again, and now finds the new local  value
p71982
aVHere you did not confuse the compiler
p71983
aVYou are creating a local ,  is not local, so the compiler recognizes it as a scoped name from parent function
p71984
aVis looked up with  from the closure, and stored in
p71985
aVYou could see the confusion between 5 and 6 as a bug, albeit one that is not worth fixing in my opinion
p71986
aVIt was certainly filed as such, see issue 532860 in the Python bug tracker, it has been there for over 10 years now
p71987
aVThe compiler could check for a scoped name  even when  is also a local, for that first assignment in example 5
p71988
aVOr  could check if the name is meant to be a local, really, and throw an  if no local was found, at the expense of more performance
p71989
aVHad this been in a function scope,  would have been used for example 5, and an  would be thrown immediately
p71990
aVHowever, as the referenced bug shows, for historical reasons the behaviour is retained
p71991
aVThere probably is code out there today that'll break were this bug fixed
p71992
as(dp71993
g16
V100297
p71994
stp71995
a((dp71996
g2
(lp71997
VThe  method doesn't give you a direct method to handle missing keys or replace values
p71998
aVYou can add a layer of indirection; pass in a mapping that handles missing and  values, and alter the format to use just that argument:
p71999
aVNow all slots refer to positional argument , which is treated like a dictionary, but key lookups always succeed and both missing values and  are replaced by a placeholder value
p72000
aVHere the  ensures that regardless of what the format spec gives, the value can be interpolated into the format
p72001
aVThis makes  work, for example
p72002
aVBy wrapping any  values and having  handle item access, the above can also handle failure to provide nested keys or whole dictionaries:
p72003
as(dp72004
g16
V100297
p72005
stp72006
a((dp72007
g2
(lp72008
VThat site appears to give you data with HTML entities
p72009
aVDecode the HTML entities with:
p72010
aVDemo:
p72011
as(dp72012
g16
V100297
p72013
stp72014
a((dp72015
g2
(lp72016
VYou cannot read and write the same file at the same time; you'd either have to read everything into memory, or use a separate output file
p72017
aVThe easiest way would be to not rename the file, but to write to the new filename instead, and then delete the old file:
p72018
aVNote that this doesn't necessarily create the new file with the same permissions
p72019
as(dp72020
g16
V100297
p72021
stp72022
a((dp72023
g2
(lp72024
VMake  a set, and use a dict and list comprehension combo:
p72025
aVUsing a set makes this more efficient, as the  membership test is a lot faster for sets than it is for lists
p72026
as(dp72027
g16
V100297
p72028
stp72029
a((dp72030
g2
(lp72031
VYou could match three alternatives: , but this does require that you capture 4 different groups; two for the  and  case, and one each for the  or  cases
p72032
aVYour code extracting the captured groups will have to take this into account:
p72033
aVand you'd have to look for  or  and  or  in the captured groups
p72034
as(dp72035
g16
V100297
p72036
stp72037
a((dp72038
g2
(lp72039
VNames starting with a double underscore are mangled to protect them when inherited
p72040
aVSubclasses can define their own  method and these will not clash
p72041
aVMangling is done by prepending the name with an extra underscore and the class name
p72042
aVThe following will work:
p72043
aVSee the documentation on names:
p72044
aVPrivate name mangling: When an identifier that textually occurs in a class definition begins with two or more underscore characters and does not end in two or more underscores, it is considered a private name of that class
p72045
aVPrivate names are transformed to a longer form before code is generated for them
p72046
aVThe transformation inserts the class name, with leading underscores removed and a single underscore inserted, in front of the name
p72047
aVFor example, the identifier  occurring in a class named Ham will be transformed to
p72048
aVThis transformation is independent of the syntactical context in which the identifier is used
p72049
aVIf the transformed name is extremely long (longer than 255 characters), implementation defined truncation may happen
p72050
aVIf the class name consists only of underscores, no transformation is done
p72051
as(dp72052
g16
V100297
p72053
stp72054
a((dp72055
g2
(lp72056
VYou want a dictionary, not an 'argument list'
p72057
aVYou also would be better off using  to evaluate just Python literals:
p72058
aVBefore you go this route, make sure you've explored other options for marshalling options first, such as  for command-line options, or JSON for network or file-based transfer or persistence
p72059
as(dp72060
g16
V100297
p72061
stp72062
a((dp72063
g2
(lp72064
VFor the middle section, add some spacing:
p72065
aVor use:
p72066
aVNote that you need to loop  times too, the top and bottom lines should not be part of the count here
p72067
aVThe  loop is entirely redundant; that just prints nothing
p72068
aVComplete function:
p72069
aVQuick demo:
p72070
as(dp72071
g16
V100297
p72072
stp72073
a((dp72074
g2
(lp72075
VNeither of your functions returns anything
p72076
aVThe default then is to return , resulting in your error
p72077
aVAdd  statements to your functions instead of printing the results
p72078
aVYou are gathering lists of links, so you'll need to alter your code to return the lists and concatenate the two lists, or write them to the output file separately:
p72079
aVIf you need to skip links you found before, you'll have to read in the links, preferably into a set, to test against when scanning again:
p72080
aVand in the two functions reading links, filter out any link already present in , using  tests
p72081
as(dp72082
g16
V100297
p72083
stp72084
a((dp72085
g2
(lp72086
VDon't use
p72087
aVUse the  module instead:
p72088
aVThis redirects  to , effectively silencing errors
p72089
aVis still redirected to your temporary file
p72090
aVYou may want to pipe this instead, using , to read the output straight into your Python script
p72091
aVYou'd still use  to silence the error output
p72092
aVwas added in Python 3
p72093
ag35
aVIf you are using an earlier version of Python, use:
p72094
as(dp72095
g16
V100297
p72096
stp72097
a((dp72098
g2
(lp72099
VMap your values to :
p72100
aVcalls the first argument for each value in the second value, effectively returning a list of float values
p72101
aVThe  here is needed to turn your format to one that  recognizes
p72102
aVDemo:
p72103
aVIf you are using Python 3, or just want to use a list comprehension anyway, use:
p72104
aVHere the  is applied to each split item instead
p72105
as(dp72106
g16
V100297
p72107
stp72108
a((dp72109
g2
(lp72110
VYou are not changing the values in the list
p72111
aVYou are assigning the result of  to a local variable  only, rebinding that variable
p72112
aVTo change elements in the list you need to assign back to the list indices:
p72113
aVAlternatively, generate a new list with a list comprehension; I'm using  here to parse the input instead of using string splitting and :
p72114
aVYou can replace all elements of  with the output with:
p72115
as(dp72116
g16
V100297
p72117
stp72118
a((dp72119
g2
(lp72120
VIf you are extending both  and  with  being two-value tuples, you can use:
p72121
aVIf  and  were empty to start with, I'd just return the output of  and let the caller of the function sort this out:
p72122
as(dp72123
g16
V100297
p72124
stp72125
a((dp72126
g2
(lp72127
VPython lists don't grow automatically; addressing indexes that don't exist does not work
p72128
aVYou'd normally use  for that:
p72129
aVNote that you don't need to create indices anymore; you can loop directly over  and  and use the values in the formula
p72130
aVThe alternative would be to create an empty structure with placeholder values; like :
p72131
aVHere I used  to add an index to each loop; this lets you have your cake and eat it; access a value from an input sequence and its location in the sequence
p72132
aVHowever, your nested lists can most simply be generated with a nested set of list comprehensions:
p72133
aVHere  executes the expression on the left-hand side for each iteration of the loop
p72134
aVThe outer loop over  generates a new list for each  in the loop
p72135
aVThat new list is itself a list comprehension, looping over  and generating new values (your formula) for each element
p72136
aVNote that now we no longer need to generate indices or use  each loop iteration
p72137
aVThe lists are built in-place
p72138
as(dp72139
g16
V100297
p72140
stp72141
a((dp72142
g2
(lp72143
V only skips the rest of the body of the loop, it does not exit the loop
p72144
aVAs such, when  is true, you send Python back up to  (note, the parenthesis around  are entirely redundant here and can be omitted)
p72145
aVUse  to exit the loop
p72146
aVThe  statement at the end of the loop will then not be executed, you may want to remove  there and un-indent the  line
p72147
as(dp72148
g16
V100297
p72149
stp72150
a((dp72151
g2
(lp72152
VA Python file object is an iterable, you can ask it for the next line while looping:
p72153
aVThis uses the  function to retrieve the next two items from the  file object and add them to the current line
p72154
aVThe outer loop will continue with the line after that
p72155
aVTo illustrate, look at the output of this iterator loop:
p72156
aVHere  advanced the  iterable to the next item, and the outer  loop then continued with the next value after that
p72157
aVYour next problem is rewriting the file in-place; you cannot read and write to the same file at the same time, and hope to replace just the right parts
p72158
aVBuffering and different line lengths get in the way
p72159
aVUse the  module to handle replacing the contents of a file:
p72160
aVor use my in-place file rewriting context manager
p72161
as(dp72162
g16
V100297
p72163
stp72164
a((dp72165
g2
(lp72166
VYou need to call  on the inner list then:
p72167
aVYour outer  contains more list objects
p72168
aVIf you want to pop an item from one of those lists, call  directly on such a list
p72169
aVA quick demo:
p72170
as(dp72171
g16
V100297
p72172
stp72173
a((dp72174
g2
(lp72175
VIf you wanted  to return a string, then do so:
p72176
aVHere we use  to put  and  together into a new string, which is returned
p72177
aVNote that you need to explicitly refer to  here
p72178
aVYou could also use string concatenation, like in your own code:
p72179
aVbut again, you need to refer to  explicitly
p72180
aVDemo:
p72181
as(dp72182
g16
V100297
p72183
stp72184
a((dp72185
g2
(lp72186
VKeep your values in a list:
p72187
aVNow the task is a simple one:
p72188
aVFor your input, that'd give:
p72189
aVThis assumes you are using Python 3; in Python 2, the  operator on integers gives integer output, so you want to use:
p72190
aVjust to make one of the operands a floating point number
p72191
aVOtherwise you'll end up with  instead
p72192
aVThe rest of your code can just use the numbers in  with indexing:
p72193
aVor you can assign the values back to the original names with sequence assignment:
p72194
aVbut generally you want to keep your data out of your variable names
p72195
as(dp72196
g16
V100297
p72197
stp72198
a((dp72199
g2
(lp72200
VYou need to give  a  parameter, and create an instance of  by calling it:
p72201
aVThere is no point in storing the return value, you don't return anything here
p72202
aVI note that you don't actually use anything in your function that requires a class
p72203
aVYou could just as well leave the class out here and not lose anything
p72204
aVIf you wanted to put your formula in a namespace, put it in a separate module instead; put  in a file  and import that as
p72205
aVNo point in making  a  here, really
p72206
as(dp72207
g16
V100297
p72208
stp72209
a((dp72210
g2
(lp72211
VYou need to split your line differently, then assign the parts without index and slice assignments:
p72212
aVThis retains the spaces in the  field
p72213
aVThe first call splits only 3 times, giving you the first three fields, and a remainder
p72214
aVThe remainder in  is then split from the right, once, to give you  and
p72215
aVDemo:
p72216
as(dp72217
g16
V100297
p72218
stp72219
a((dp72220
g2
(lp72221
VThe following would match a hex RGB string:
p72222
aVThis only returns  if a string starting with  followed by exactly 6 hex digits is passed in
p72223
aVDemo:
p72224
aVIf you want to support the 3-digit CSS format as well, update the pattern:
p72225
aVThis matches a hash followed by 3 hex digits, plus an optional 3 extra digits
p72226
as(dp72227
g16
V100297
p72228
stp72229
a((dp72230
g2
(lp72231
VBuild a key that reflects the structure; split on comma and reverse:
p72232
aVThis sorts the last component alphabetically, then for the same region, sorts the country alphabetically, etc
p72233
aVThe  mapping is needed to remove the extra spaces
p72234
aVDemo:
p72235
as(dp72236
g16
V100297
p72237
stp72238
a((dp72239
g2
(lp72240
VYou set  and  just once, at the top
p72241
aVIf you wanted to measure particular moments in time in your game, you need to call  at that moment
p72242
aVReferring to  won't do that:
p72243
as(dp72244
g16
V100297
p72245
stp72246
a((dp72247
g2
(lp72248
VYour weave function drops the last element of ; you need to use  here:
p72249
aVNote that you need to return, not print, your output
p72250
aVThe  call adds  placeholders, which we need to remove again from the  output after zipping
p72251
aVNow you can simply weave in a 3rd list into the output of the previous two:
p72252
aVDemo:
p72253
as(dp72254
g16
V100297
p72255
stp72256
a((dp72257
g2
(lp72258
VPut your objects in a dictionary:
p72259
aVYou can also access the module globals with the  function, which gives you a dictionary too, but most of the time you want to use a dedicated dictionary instead
p72260
as(dp72261
g16
V100297
p72262
stp72263
a((dp72264
g2
(lp72265
VYes, yes you can do something like that
p72266
aVExactly that, actually
p72267
aVAssign the argument you want to ignore to a name you then simply not use anywhere else
p72268
aVThe  name is often used:
p72269
aVThe  name is just a convention, but most Python developers understand it to mean 'this variable will be ignored by the rest of the code, it is just there to fulfill a tuple assignment'
p72270
aVAlternatively, index or slice the output:
p72271
aVor for a function with more than two return values:
p72272
aVbut if you wanted to ignore an argument in the middle somewhere, the  assignment is best
p72273
aVYou can use it multiple times without penalty:
p72274
as(dp72275
g16
V100297
p72276
stp72277
a((dp72278
g2
(lp72279
VBecause the lifetime and visibility of both is entirely different
p72280
aVClass attributes are accessible by anything that can access the class
p72281
aVClass attributes also have to play with inheritance; what if I wrote code like this:
p72282
aVBy your logic, why should  be visible in  but not in
p72283
aVFunction locals are only accessible to the function and anything nested within the function
p72284
aVCall the function again and you get a fresh set of variables
p72285
aVSo when you create a class instance and call a method on that instance, the class attributes could have been changed by other code in the meantime
p72286
aVFunction closures (locals accessed in a nested scope) cannot be changed from outside the function
p72287
aVYou cannot treat the two scopes as the same at all
p72288
as(dp72289
g16
V100297
p72290
stp72291
a((dp72292
g2
(lp72293
VUse a tuple:
p72294
aVQuoting the reference  statement documentation:
p72295
aVWhen an exception occurs in the  suite, a search for an exception handler is started
p72296
aVThis search inspects the except clauses in turn until one is found that matches the exception
p72297
ag15438
aVFor an except clause with an expression, that expression is evaluated, and the clause matches the exception if the resulting object is \u201ccompatible\u201d with the exception
p72298
aVAn object is compatible with an exception if it is the class or a base class of the exception object or a tuple containing an item compatible with the exception
p72299
aVEmphasis mine
p72300
as(dp72301
g16
V100297
p72302
stp72303
a((dp72304
g2
(lp72305
VAdd a  method to your  class:
p72306
aVDemo:
p72307
aVNote that you can simply delegate the actual adding to the  class here; all we need to do is convert the result back to a  instance
p72308
as(dp72309
g16
V100297
p72310
stp72311
a((dp72312
g2
(lp72313
VJust test against  right where you are testing if the move is valid:
p72314
aVYou really want to use a mapping here to translate position to index:
p72315
aVHere we use the gameboard to see if a move is still available; if there is a naught or cross there already, the move is obviously not a valid one
p72316
aVThe  mapping gets rid of the 9  statements in one go
p72317
as(dp72318
g16
V100297
p72319
stp72320
a((dp72321
g2
(lp72322
VUse :
p72323
aVor  and :
p72324
aVDemo:
p72325
as(dp72326
g16
V100297
p72327
stp72328
a((dp72329
g2
(lp72330
VYou can create a prepared request:
p72331
as(dp72332
g16
V100297
p72333
stp72334
a((dp72335
g2
(lp72336
V doesn't take a list or generator, it'd only take a string, and even then won't do what you want
p72337
aVThe method replaces one whole sequence of characters with another, so even  would only replace whole occurrences of the  string in  with one dash
p72338
aVUse  and  instead:
p72339
aVDemo:
p72340
aVis hands-down the fastest method to map characters to other characters, or delete characters from a string
p72341
aVOn Python 3,  (or in Python 2, ) takes a mapping instead:
p72342
as(dp72343
g16
V100297
p72344
stp72345
a((dp72346
g2
(lp72347
VUse the  function:
p72348
aVHere  divides the minutes by 60, returning the number of hours and the remainder, in one
p72349
aVDemo:
p72350
as(dp72351
g16
V100297
p72352
stp72353
a((dp72354
g2
(lp72355
VEither sum them manually in the loop:
p72356
aVor use :
p72357
as(dp72358
g16
V100297
p72359
stp72360
a((dp72361
g2
(lp72362
VYou have both a  variable and a  function
p72363
aVYou cannot have both, you need to rename one or the other
p72364
aVPython functions are first-class objects
p72365
aVThey are bound to names just like values are
p72366
aVThey don't live in a separate namespace from your other variables
p72367
aVRename the function to  perhaps:
p72368
aVand call that:
p72369
aVwhere you do need to pass in an argument; your function expects one ()
p72370
aVThis applies to  and  as well
p72371
as(dp72372
g16
V100297
p72373
stp72374
a((dp72375
g2
(lp72376
VUse  to turn rows into columns, then make those into dictionary keys and values:
p72377
aVA quick demo of the last line:
p72378
aVwhere  stands in for the  object
p72379
aVtakes all elements in an iterable and transforms it like a matrix; columns become rows as each nested value is paired up with values from the other rows at the same position:
p72380
aVand the dict comprehension  produces a dictionary, where in the above code each first element in a column becomes the key, and the rest forms the value
p72381
as(dp72382
g16
V100297
p72383
stp72384
a((dp72385
g2
(lp72386
VThey create two different  functions
p72387
aVThe first takes two arguments, the second only takes one argument
p72388
aVThe  is just a name to indicate (by convention) that the value will be ignored
p72389
aVThe Python language does not assign any special meaning to it
p72390
aVIt looks as if the  was designed to be passed to an API that requires a callable with two arguments
p72391
as(dp72392
g16
V100297
p72393
stp72394
a((dp72395
g2
(lp72396
VLoop over the nested lists and test those; the  function makes this efficient:
p72397
aVThis assumes  is nested to one level only
p72398
aVIf recursion is required, you could use:
p72399
aVI used a simplified test for  and  only to avoid 'flattening' strings
p72400
as(dp72401
g16
V100297
p72402
stp72403
a((dp72404
g2
(lp72405
VLoop over the input in pairs; you can use a map string to convert to characters from there
p72406
aVDemo:
p72407
as(dp72408
g16
V100297
p72409
stp72410
a((dp72411
g2
(lp72412
VIf you are using Cork, catch the  exception raised only if you didn't set the   keyword; you can then just catch that exception:
p72413
as(dp72414
g16
V100297
p72415
stp72416
a((dp72417
g2
(lp72418
VStick to what you have now
p72419
aVYou could convert the function to a generator expression but it'd be an unreadable mess
p72420
aVGenerator expressions need another iterable to loop over, which your generator function doesn't have
p72421
aVGenerator expressions also don't really have access to any other variables; there is just the expression and the loop, with optional  filters and more loops
p72422
aVHere is what a generator expression would look like:
p72423
aVwhere we abuse  as a 'variable'
p72424
as(dp72425
g16
V100297
p72426
stp72427
a((dp72428
g2
(lp72429
VThere is no difference; Python recognizes all 3
p72430
aVIt looks for the pattern:
p72431
aVon the first two lines of the file (which also must start with a )
p72432
aVThat's the literal text 'coding', followed by either a colon or an equals sign, followed by optional whitespace
p72433
aVAny word, dash or dot characters following that pattern are read as the codec
p72434
aVThe  is an Emacs-specific syntax; letting the text editor know what encoding to use
p72435
aVIt makes the comment useful to two tools
p72436
aVVIM supports similar syntax
p72437
aVSee PEP 263: Defining Python Source Code Encodings
p72438
as(dp72439
g16
V100297
p72440
stp72441
a((dp72442
g2
(lp72443
VThe underscore is part of the  character group
p72444
aVUse this instead:
p72445
aVwhich is the same as  but minus the underscore
p72446
as(dp72447
g16
V100297
p72448
stp72449
a((dp72450
g2
(lp72451
V only takes valid Python expressions
p72452
aVis not a valid Python expression
p72453
aVEither require that the numbers are separated by a comma () or use a different method of parsing the date input
p72454
aVTry to avoid  for parsing input; a user with less friendly intent could enter arbitrary code to mess up your program and hijack the process when you do that
p72455
aVThe following line would work just as well for your purposes:
p72456
as(dp72457
g16
V100297
p72458
stp72459
a((dp72460
g2
(lp72461
VThe builtin  function does not look up the  attribute
p72462
aVIt looks up the  pointer, which in turn has a  attribute
p72463
aVThe  attribute on built-in objects is indirectly mapped to the same slot, and it is that indirection (plus the attribute lookup) that takes more time
p72464
aVFor Python-defined classes, the  object looks up the  method when the  is requested
p72465
as(dp72466
g16
V100297
p72467
stp72468
a((dp72469
g2
(lp72470
V returns a copy of a list
p72471
aVThe next  applies to whatever the previous expression returned, and  is still the second element of that list
p72472
aVIf you wanted to have every second item, use a list comprehension:
p72473
aVDemo:
p72474
as(dp72475
g16
V100297
p72476
stp72477
a((dp72478
g2
(lp72479
VJust read from each file, writing out to the output file and adding in the 'missing' column:
p72480
aVThe  lines do all the work; a generator expression loops over the rows in each , either appending a column or inserting a column in the middle
p72481
aVThis works with whatever size of input CSVs you have, as only some read and write buffers are held in memory
p72482
aVRows are processed in iterative fashion without ever needing to hold all of the input or output files in memory
p72483
as(dp72484
g16
V100297
p72485
stp72486
a((dp72487
g2
(lp72488
VThe  variable is not expanded by Python for you
p72489
aVEither use an absolute path to the application data folder, or retrieve the  variable from the system and concatenate that with
p72490
aVSee How do I find the Windows common application data folder using Python
p72491
aVfor methods to retrieve system paths like
p72492
aVIf you use the environment option, that'd be:
p72493
as(dp72494
g16
V100297
p72495
stp72496
a((dp72497
g2
(lp72498
VBuild a set of matching indices (produced with , then select those indices when producing a new dictionary:
p72499
aVDemo:
p72500
as(dp72501
g16
V100297
p72502
stp72503
a((dp72504
g2
(lp72505
VYour code uses  to end the per-line loop, skipping any words following a duplicated word in a line
p72506
aVYou probably wanted to use  instead
p72507
aVYour code is needlessly complicated, however
p72508
aVUse  to number the lines, and  for ease, and a  to track words already counted:
p72509
aVDemo:
p72510
as(dp72511
g16
V100297
p72512
stp72513
a((dp72514
g2
(lp72515
VMost exceptions are actually more applicable to C-code than Python code using the buffer protocol; see the C API buffer protocol
p72516
aVFrom the 3
p72517
aV3 source code, I see the following error messages being used for :
p72518
ag4212
aVunderlying buffer is not writable for a read-only buffer
p72519
aVwritable contiguous buffer requested for a non-contiguous object
p72520
aVfor a memory view that is not using the right contiguous format
p72521
aVmemoryview has %zd exported buffer%s on release; this would, IIRC, indicate that the reference count off
p72522
aVmemoryview: underlying buffer is not writable when creating a writable  from a read-only buffer
p72523
aVShould not happen from Python code
p72524
aVmemoryview: underlying buffer is not C-contiguous when passing in a non-contiguous buffer object but flags requested one
p72525
aVIf strides are used and the buffer is not C-contiguous, this exception is also thrown
p72526
aVmemoryview: underlying buffer is not Fortran contiguous, ditto
p72527
aVmemoryview: underlying buffer is not contiguous, ditto
p72528
aVmemoryview: underlying buffer requires suboffsets: flags indicate that a suboffset buffer is required but the buffer passed is not
p72529
aVmemoryview: cannot cast to unsigned bytes if the format flag is present: unsigned bytes and a specified format do not mix
p72530
ag4212
aVExisting exports of data: object cannot be re-sized: attempting to resize a  that has other views on it
p72531
aVThere is also a undocumented  C-API method that'll throw this exception with destination is too small to receive data from source if the destination buffer is too small
p72532
as(dp72533
g16
V100297
p72534
stp72535
a((dp72536
g2
(lp72537
VYou are saving a file with no path information
p72538
aVThis means it'll be saved in the current working directory, wherever that may be for the Apache process
p72539
aVYou do not have write permissions there
p72540
aVThis working directory is almost certainly not the same place as where your project code is stored
p72541
aVSpecify a path for the file
p72542
aVYou could use a directory based on the current module ( is the directory of the current module), or configure a destination path for your application
p72543
aVYou may want to study the Uploading Files pattern in this context
p72544
as(dp72545
g16
V100297
p72546
stp72547
a((dp72548
g2
(lp72549
VHow tabs are handled depends on the terminal or console
p72550
aVOften, they indent to specific tab stops; predefined columns regardless of where the tab was printed
p72551
ag6579
ag1298
aVif there are tab stops every 8 spaces, printing a tab at column 12 means the cursor skips to column 16, and does not skip 8 spaces to column 20
p72552
aVWith the addition of a space you made the tab fill out to the next tab stop at position 24:
p72553
as(dp72554
g16
V100297
p72555
stp72556
a((dp72557
g2
(lp72558
VEither decode the downloaded HTML to unicode text, or use a  bytes regular expression:
p72559
aVor:
p72560
aVHowever, you are using a regular expression, and matching HTML with such expressions get too complicated, too fast
p72561
aVUse a HTML parser instead, Python has several to choose from
p72562
aVI recommend you use BeautifulSoup, a popular 3rd party library
p72563
aVBeautifulSoup example:
p72564
aVSince a  tag itself doesn't contain other tags, you can get away with a regular expression here, but as soon as you try to parse nested tags, you will run into hugely complex issues
p72565
as(dp72566
g16
V100297
p72567
stp72568
a((dp72569
g2
(lp72570
VYou'll need to open the output file once and keep writing to it as you process input lines
p72571
aVIt'd also be much easier if you used the  module to handle input and output:
p72572
as(dp72573
g16
V100297
p72574
stp72575
a((dp72576
g2
(lp72577
VYou need to call the  function:
p72578
aVotherwise you are trying to compare the function object itself
p72579
as(dp72580
g16
V100297
p72581
stp72582
a((dp72583
g2
(lp72584
VThat's what a logical statement is for:
p72585
aVIf you have a variable number of elements to test, you could use :
p72586
aVor with a generator expression:
p72587
aVAny of these expressions can be stored in a variable first:
p72588
aVbut then you lose the short-circuiting behaviour of the  operand; all 3 condition expressions will be evaluated to build , while  won't evaluate the right-hand expression if the left-hand expression resolved to a false value
p72589
aVLast, but not least, there is the conditional expression, which returns the outcome of one of two expressions based on an boolean test:
p72590
aVand only one of  or  will actually be evaluated based on the outcome of
p72591
as(dp72592
g16
V100297
p72593
stp72594
a((dp72595
g2
(lp72596
VUse  here:
p72597
aVThe  call adds  placeholders (similar to your own attempt to add  characters), which we need to remove again from the  output after zipping
p72598
aVDemo:
p72599
as(dp72600
g16
V100297
p72601
stp72602
a((dp72603
g2
(lp72604
VUse :
p72605
aVor better still, using :
p72606
aVDemo:
p72607
aVPython 3 moved the  function out of the built-ins and into
p72608
as(dp72609
g16
V100297
p72610
stp72611
a((dp72612
g2
(lp72613
VInstead of splitting, count the ends:
p72614
aVOr subtract 1 to account for the empty line after the last sentence split:
p72615
aVor return a filtered list, removing empty items:
p72616
aVor, when using Python 3 (where  returns a generator):
p72617
as(dp72618
g16
V100297
p72619
stp72620
a((dp72621
g2
(lp72622
VYou can use any iterable producing lines, it doesn't just have to be a file object
p72623
aVYou can split your string into a list of lines with :
p72624
aVDemo:
p72625
as(dp72626
g16
V100297
p72627
stp72628
a((dp72629
g2
(lp72630
VYou are trying to call  directly on the file object
p72631
aVYou'd normally do that on the read lines instead
p72632
aVFor JSON, however, you don't need to do this
p72633
aVThe  library handles this for you
p72634
aVUse  (no ) to load directly from the file object:
p72635
aVNext, you need to address the  key with:
p72636
aVYour JSON also needs to be fixed, so that your source_include is an array, rather than a dictionary:
p72637
aVNext, you loop over filenames with , which are strings (relative filenames with no path)
p72638
aVStrings do not have a  attribute, if you wanted to read out file timestamps you'll have to use  calls instead:
p72639
as(dp72640
g16
V100297
p72641
stp72642
a((dp72643
g2
(lp72644
VYou have to parse all of the input string, you cannot just ignore part
p72645
aVHere, we compare the date to today's date by using more  objects instead of trying to use strings
p72646
as(dp72647
g16
V100297
p72648
stp72649
a((dp72650
g2
(lp72651
VPython uses  (Python 2  function) or  (Python 3 and ) internally when opening files, neither of which allow for specifying any sharing flags
p72652
aVSharing is thus set to a default, and what that default is does not appear to be documented
p72653
aVIf you want to set the sharing mode yourself, you'll have to use the  if you want to open files specifying a sharing mode
p72654
aVThere is a patch in the Python issue tracker that implements a  module, illustrating how to do this
p72655
aVJust the opener from that patch, somewhat simplified, is:
p72656
as(dp72657
g16
V100297
p72658
stp72659
a((dp72660
g2
(lp72661
VPython file objects do not support  membership testing, no
p72662
aVRead the file into a dictionary, then test against that:
p72663
aVNote that you need to open the file in append mode to add lines;  will first clear the opened file
p72664
as(dp72665
g16
V100297
p72666
stp72667
a((dp72668
g2
(lp72669
VThe  function returns
p72670
aVRemove the  call, put that on a separate line instead:
p72671
aVor leave it out altogether
p72672
aVThe  function itself already prints the question for you
p72673
as(dp72674
g16
V100297
p72675
stp72676
a((dp72677
g2
(lp72678
V is a local variable in ; Assigning  as a default value for a keyword argument won't make it any less a local
p72679
aVIf you wanted it to be a global, mark it as such:
p72680
aVbut you probably just wanted to pass in the value as an argument instead:
p72681
as(dp72682
g16
V100297
p72683
stp72684
a((dp72685
g2
(lp72686
VWhen importing from a module with  names starting with underscores are indeed skipped
p72687
aVHowever, a module rarely contains only public API objects
p72688
aVUsually you've made imports to support the code as well, and those names are global in the module as well
p72689
aVWithout , those names would be part of the import too
p72690
aVIn other words, unless you want to 'export'  in the following example you should use :
p72691
aVbecause without the  list, Python cannot distinguish between  and  here and divine which one should not be imported when using
p72692
aVYou could work around this by renaming all your imports, so , but that'd just make your code less readable
p72693
aVAnd an explicit export list is always nice
p72694
aVExplicit is better than implicit, as the Zen of Python tells you
p72695
as(dp72696
g16
V100297
p72697
stp72698
a((dp72699
g2
(lp72700
VYou need to add a  keyword to the  call, and leave out the  argument:
p72701
aVNow the subparser name is included as :
p72702
aVDo read the sub-commands documentation more carefully though; there are better options, including associating a function to call with each sub-parser, so that you don't have to explicitly track the name of the subparser like this
p72703
as(dp72704
g16
V100297
p72705
stp72706
a((dp72707
g2
(lp72708
V creates an  file in the  directory, which points back to the location of the project files
p72709
aVThe same path is also added to the  file in the same location
p72710
aVUninstalling with  removes that link file again
p72711
aVDo note that any  dependencies not yet present are also installed, as regular eggs (they are -ed)
p72712
aVThose dependencies are not uninstalled when uninstalling the development egg
p72713
as(dp72714
g16
V100297
p72715
stp72716
a((dp72717
g2
(lp72718
VUse :
p72719
aVThe  syntax applies each element in  as a separate argument to the  function; as if you called
p72720
aVDemo:
p72721
aVYou could reduce your nested lists to strings for the same output:
p72722
aVor, for consistency's sake, make the last element a list:
p72723
aVbut it'll work with the mixed sequences too
p72724
as(dp72725
g16
V100297
p72726
stp72727
a((dp72728
g2
(lp72729
VUse  instead:
p72730
aVDemo:
p72731
as(dp72732
g16
V100297
p72733
stp72734
a((dp72735
g2
(lp72736
VWhy do you want to do this
p72737
aVExplicit is better than implicit
p72738
aVImport everything your API wants to expose in  then let people use  instead
p72739
aVUse  to explicitly list what should be exported that way
p72740
aVIn , use:
p72741
aVand leave importing everything to your users
p72742
aVThey should have the choice, not have the modules forced upon them
p72743
aVOr, if you meant items from the nested modules to be visible in , import those explicitly, or use  there too (but do add an  list to such modules):
p72744
aVAdding items to  means you made the names visible everywhere, not just to whatever imported your
p72745
aVRarely is there a need to mess with built-ins
p72746
as(dp72747
g16
V100297
p72748
stp72749
a((dp72750
g2
(lp72751
VUse just the  pattern;  includes underscores:
p72752
aVor use the inverse of ,  in a negative character set with  added:
p72753
aVThe latter has the advantage of working correctly even when using  or , where  matches a wider range of characters
p72754
aVDemo:
p72755
as(dp72756
g16
V100297
p72757
stp72758
a((dp72759
g2
(lp72760
VThe  class expects dictionaries for each row
p72761
aVIf all you wanted to do was write an initial header, use a regular  and pass in a simple row for the header:
p72762
aVThe alternative would be to generate dictionaries when copying across your data:
p72763
as(dp72764
g16
V100297
p72765
stp72766
a((dp72767
g2
(lp72768
VYou cannot materialize an object from a non-existing reference
p72769
aVPython names have to exist for them to work
p72770
aVInstead, give the  keyword a default, then when the keyword is not specified, create the instance:
p72771
aVNow you can create instances of  with a default new instance for :
p72772
aVBecause we used a sentinel default value, you can still set  to  as well:
p72773
aVA mutable list on the class can hold all instances; just set the list as a class attribute and append new instances to that:
p72774
aVand you can list all instances with
p72775
aVDo note that this creates circular references, keeping instances alive even when you no longer use them anywhere else
p72776
aVUse the  module if you want to prevent this
p72777
as(dp72778
g16
V100297
p72779
stp72780
a((dp72781
g2
(lp72782
VUse a list comprehension to remove the last 4 characters:
p72783
aVIf only some of the names contain  at the end, use a conditional expression:
p72784
as(dp72785
g16
V100297
p72786
stp72787
a((dp72788
g2
(lp72789
VThe  argument is not the problem here;  is a required argument
p72790
aVIf you should be able to call your program without naming a project, make  optional by adding :
p72791
aVIf it is an error to not specify a project name when other command-line switches are used, do so explicitly after parsing:
p72792
aVCalling  prints the error message, the help text and exits with return code 2:
p72793
as(dp72794
g16
V100297
p72795
stp72796
a((dp72797
g2
(lp72798
VInstead of the built-in  function, use
p72799
aVThis gives you more control over how newlines are handled with the  argument:
p72800
aVSetting  to the empty string, leaves universal newline support enabled but returns line endings untranslated; you can still use  to find lines terminated with any of the legal line terminators but the data returned is exactly that found in the file:
p72801
aVOn input, if newline is , universal newlines mode is enabled
p72802
aVLines in the input can end in , , or , and these are translated into  before being returned to the caller
p72803
aVIf it is , universal newlines mode is enabled, but line endings are returned to the caller untranslated
p72804
aVEmphasis mine
p72805
aVThis is different from opening the file in binary mode, where  will only split the file on  characters
p72806
aVFor a file with  line endings or mixed line endings, this means that lines are not going to be split correctly
p72807
aVDemo:
p72808
aVNote that  also decodes file contents to unicode values
p72809
as(dp72810
g16
V100297
p72811
stp72812
a((dp72813
g2
(lp72814
VYou don't have a list of dictionaries, you have a list of instances of a custom class instead
p72815
aVTo extract a specific attribute from each into a tuple, use:
p72816
as(dp72817
g16
V100297
p72818
stp72819
a((dp72820
g2
(lp72821
V reads the all data in the file, in one go
p72822
aVThere are no more lines to read after the first call
p72823
aVYou probably wanted to use  (no , singular) instead:
p72824
aVNote that because  returns a list already, you don't need to loop over the items
p72825
aVYou could also just use  to read in the remainder of the file:
p72826
aVAlternatively, treat the file object as an iterable, and using  slice the iterable to skip the first five lines:
p72827
aVThis does produce lines, not one large string, but if you are processing the input file line by line, that usually is preferable anyway
p72828
aVYou can loop directly over the slice and handle lines:
p72829
aVDon't mix using a file object as an iterable and ; the iteration protocol as implemented by file objects uses an internal buffer to ensure efficiency that  doesn't know about; using  after iteration is liable to return data further on in the file than you expect
p72830
as(dp72831
g16
V100297
p72832
stp72833
a((dp72834
g2
(lp72835
VYou are passing in a default value for the  function to return if the generator expression raises a  exception
p72836
aVThe  is the default value returned here:
p72837
aVRetrieve the next item from the iterator by calling its  method
p72838
aVIf default is given, it is returned if the iterator is exhausted, otherwise  is raised
p72839
aVRaising  is how iterators communicate that they are done and can no longer be used to produce results
p72840
aVGenerators are a specialised type of iterator
p72841
aVYou don't have to pass in ; any valid Python value will do
p72842
aVIf you omit the default argument, you can also omit the generator parenthesis:
p72843
as(dp72844
g16
V100297
p72845
stp72846
a((dp72847
g2
(lp72848
VYou are printing your text, not writing it to the file object
p72849
aVUse  to write lines to the file:
p72850
aVAlternatively, use the (more obscure and little-used)  print redirection syntax:
p72851
aVIn both cases, I open the file here in append mode, to add new information rather than replace the file contents
p72852
aVAlternatively, move the file opening outside of the  loops to truncate it just once, then write lines to the file each loop iteration before closing it once after the loop has completed
p72853
aVThe  statement takes care of closing the file object for you when the  block completes or is exited
p72854
as(dp72855
g16
V100297
p72856
stp72857
a((dp72858
g2
(lp72859
VYou are using a relative path in the  call; this means the exact location of the database file depends on the current working directory
p72860
aVIf you execute the script from a different location, the database file will be re-created
p72861
aVUse an absolute path instead; you can base it of the location of the module with:
p72862
aVthen:
p72863
as(dp72864
g16
V100297
p72865
stp72866
a((dp72867
g2
(lp72868
VThere are three options why the error you see is raised:
p72869
aVYou bound  to a unicode value
p72870
aVYou bound  to a unicode value
p72871
aVYou bound  to a unicode value
p72872
aVOf the three, the last one is the most likely
p72873
aVEither don't assign to  elsewhere in your code, or delete the  global masking the built-in with:
p72874
aVPython documentation recommends that you use the  function instead
p72875
aVI'd also use  (no ) to load the file contents directly, as well as a  statement to ensure that the file object is closed automatically:
p72876
as(dp72877
g16
V100297
p72878
stp72879
a((dp72880
g2
(lp72881
VWhen nothing is found,  returns an empty list
p72882
aVTest for that first:
p72883
aVsuffices, as empty containers test as false in a boolean context
p72884
as(dp72885
g16
V100297
p72886
stp72887
a((dp72888
g2
(lp72889
VIf you meant to query for matching  rows in the database, use the  attribute to create a query set:
p72890
aVSee Making queries in the Django documentation
p72891
aVAlternatively, if there is a foreign key relationship between the  and  objects, use the related objects manager instead:
p72892
as(dp72893
g16
V100297
p72894
stp72895
a((dp72896
g2
(lp72897
VLoop over the  method output:
p72898
aVThis will output rolls from most common to least
p72899
aVYou could also loop over the sorted keys:
p72900
aVThis outputs rolls in numerical order instead
p72901
as(dp72902
g16
V100297
p72903
stp72904
a((dp72905
g2
(lp72906
VYou are calling ; Python 2 strings are already encoded, so Python tries to do the right thing and first decode to  so it can then encode the value back to a bytestring for you
p72907
aVThis implicit decode is done with the default codec, :
p72908
aVNote that I called  but the exception is ; Python was decoding here first
p72909
aVHowever, because  already wants UTF-8 encoded bytes, you do not need to recode the value at all
p72910
aVIf you see problems with parsing the string value, make sure you saved your Python source code using the right codec, UTF8, from your text editor
p72911
as(dp72912
g16
V100297
p72913
stp72914
a((dp72915
g2
(lp72916
VMove your  within the loop, and ignore the exception by using  as the exception handler:
p72917
aVYou won't hit a  here unless any  is a type of object that  cannot handle; e
p72918
ag1298
aVanything not a number or a string:
p72919
as(dp72920
g16
V100297
p72921
stp72922
a((dp72923
g2
(lp72924
VUse the  function to create an iterable instead:
p72925
aVcalls  to obtain an iterable object for  to loop over, which could be the  object itself
p72926
aVIterators are very efficient otherwise, this approach is just the right way to handle any iterable or sequence
p72927
as(dp72928
g16
V100297
p72929
stp72930
a((dp72931
g2
(lp72932
VFunction docstrings are writable; just assign to ; here is a decorator that adds a string to the docstring of all methods on a class:
p72933
aVUse this like so:
p72934
aVThe decorator works in both Python 2 and 3 and will only affect methods defined directly on the class, not on any base classes
p72935
as(dp72936
g16
V100297
p72937
stp72938
a((dp72939
g2
(lp72940
VYou already have a reference to the correct class: :
p72941
aVThe class method is bound to the class object it is being called on
p72942
aVFor ,  is not bound to parent class but to  itself
p72943
as(dp72944
g16
V100297
p72945
stp72946
a((dp72947
g2
(lp72948
V is the name under which the current module was imported
p72949
aVIf the module was imported with ,  reflects that directly
p72950
aVIf you sometimes see  then your module was imported using that name, and there are two copies of your module loaded in memory; Python sees the two as separate
p72951
aVYou should avoid importing nested modules; use only the top-level name
p72952
aVStick to either  or , but if the latter must be used, make sure  is not a package and is not itself listed on the python module search path
p72953
as(dp72954
g16
V100297
p72955
stp72956
a((dp72957
g2
(lp72958
VYou must make  inherit from  or leave out  altogether
p72959
aVBy making  inherit from  you are mixing old-style and new-style class hierarchies and that is breaking
p72960
aVfound  here, not
p72961
aVWhen you move  up to  it works:
p72962
aVand
p72963
aVIf you remove  altogether, you cannot use ; name the base class directly:
p72964
as(dp72965
g16
V100297
p72966
stp72967
a((dp72968
g2
(lp72969
VIf the default is expensive, test for the key:
p72970
aVor if  could be empty:
p72971
aVBoth  and a conditional expression evaluate lazily
p72972
aVYou can still make this a one-liner, but I am not sure you should
p72973
aVThe above does match your original code
p72974
aVNote that this does not add  to
p72975
aVYou could do that too:
p72976
aVor
p72977
aVwhere you pick the first if  is usually not found in , the latter if  only occasionally not found in
p72978
aVYour next option is to subclass  and add a  method:
p72979
aVthen use that as :
p72980
aVPython will call  whenever you try to access a key that's not yet there
p72981
aVDemo:
p72982
as(dp72983
g16
V100297
p72984
stp72985
a((dp72986
g2
(lp72987
VIf an external application is stubbornly POST-ing with an alternative mime-type, you can force Flask to treat the data as JSON anyway by using the  method instead, setting the  argument to :
p72988
aVDon't try to treat a JSON payload as form data, that'll never work
p72989
as(dp72990
g16
V100297
p72991
stp72992
a((dp72993
g2
(lp72994
VYou need to pass the mode parameter to the  call, not to :
p72995
aVTo load from an open file, use :
p72996
aVYou don't need the  module and calls here at all
p72997
aVRemove those
p72998
aVYou probably want to use the files as context managers here, closing them automatically:
p72999
aVand
p73000
aVYou cannot add just add unstructured additional information to the file after opening; add the new information to  before pickling  to the file:
p73001
aVYour  function should probably return the read information, or you should make  an explicit :
p73002
aVBy returning from the function, you can then assign it back to  or print it:
p73003
as(dp73004
g16
V100297
p73005
stp73006
a((dp73007
g2
(lp73008
VDon't pass in  at all; if you don't pass in the  argument to  it'll use , skipping :
p73009
aVFrom the  source code:
p73010
as(dp73011
g16
V100297
p73012
stp73013
a((dp73014
g2
(lp73015
V does not take regular expressions
p73016
aVYou are trying to split your text on literal  characters:
p73017
aVIf you wanted to use a regular expression to split on, use the  module:
p73018
aVThe  flag ensures that  matches after every newline, not just at the start of the string
p73019
aVNote that this assumes you want to split where there are three consecutive newlines
p73020
aVDemo:
p73021
aVIf two newlines are enough, use  instead:
p73022
as(dp73023
g16
V100297
p73024
stp73025
a((dp73026
g2
(lp73027
VOnce you call , it returns a number
p73028
aVIt is that number that is passed into the function, not the function
p73029
aVIn other words, you only call the function once and reuse the output, over and over again
p73030
aVYour  loops, on the other hand, re-execute the loop body each iteration, so in that case the  function or  function is called for each iteration of the  loop and thus input a new number
p73031
aVIf you wanted a function called each time you go through the loop, pass in the function and arguments instead:
p73032
aVand call this with:
p73033
aVNow either  (with no arguments) is called each time in the recursive function, or  is called with the arguments  and
p73034
aVDemo:
p73035
as(dp73036
g16
V100297
p73037
stp73038
a((dp73039
g2
(lp73040
VTrack a total:
p73041
aVOrdering won't be affected; only new keys would add to the ordering
p73042
aVDemo:
p73043
as(dp73044
g16
V100297
p73045
stp73046
a((dp73047
g2
(lp73048
VUse dictionary view objects:
p73049
aVThe expression  uses a set intersection to list just the keys that both dictionaries have in common
p73050
aVThe  gives us a view into the dictionary that acts like a set without creating a whole new set object
p73051
aVThis makes the above expression more efficient than creating two sets and intersecting those, especially when dealing with large dictionaries
p73052
as(dp73053
g16
V100297
p73054
stp73055
a((dp73056
g2
(lp73057
VInstead of , read all words into a list and use :
p73058
aVis guaranteed to pick 12 different words from your input list
p73059
aVBecause your wordlist is small (just 100 words), reading them all into a list in memory is more than fine
p73060
aVIf your input file is larger (megabytes to gigabytes), you may want to move to an algorithm that can pick a uniform sample out of any iterable regardless of size, only requiring memory for the output sample size
p73061
aVIf you need to find 12 random words that are not yet present in  from a previous run, you need to read those into a set first:
p73062
aVHere, I open the  file with  for appending instead, to add the new 12 words we had not yet seen before
p73063
as(dp73064
g16
V100297
p73065
stp73066
a((dp73067
g2
(lp73068
V is a tuple, with two references to the same list objects that the  and  names refer to
p73069
aVWhen you appended  to , you added another reference to that list to
p73070
aVNow you have 3 references to that list object
p73071
aVOne in , another in  and a third in
p73072
aVWhenever you manipulate a list or dictionary or any other mutable object type in Python, all references to that object will reflect those changes, because you are dealing with just one object
p73073
aVPicture objects as balloons, and names are labels, tied to the balloons with thread
p73074
aVThe threads are references
p73075
aVYou can tie multiple labels to a balloon, but you'd still have only one balloon, and if you popped the balloon all labels would be tied to the same piece of lifeless rubber
p73076
aVLists and tuples are just balloons with numbered labels taped onto them; those labels are tied to other objects
p73077
aVSo  is a balloon with two labels taped on, numbered 0 and 1
p73078
aVThose labels are tied to the same balloons  and  are tied to as well
p73079
as(dp73080
g16
V100297
p73081
stp73082
a((dp73083
g2
(lp73084
VYou have a file that already had a newline at the end:
p73085
aVand you wrote a newline plus the additional line:
p73086
aVWrite your additional line with the newline at the end:
p73087
aVso that you end up with:
p73088
as(dp73089
g16
V100297
p73090
stp73091
a((dp73092
g2
(lp73093
VWhen you redirect output from the terminal to a file, the buffering mode changes from line buffered to using a fixed-size buffer instead
p73094
aVThis means that newlines no longer trigger a flush
p73095
aVYour  outputs are therefore being buffered, but the tests you are running with  have their buffers flushed when the process completes
p73096
aVThe solution is to explicitly flush after your  statements, just before you run :
p73097
as(dp73098
g16
V100297
p73099
stp73100
a((dp73101
g2
(lp73102
V expects a sequence of rows; the entries in the list must themselves be sequences of parameters, even when the inserted rows consist of just one value each:
p73103
aVor use lists:
p73104
aVThe reason it works with just the flat list of strings minus the  entry is because strings are sequences too, but  is a sequence of length two
p73105
aVThus, the last entry tries to insert two parameters,  and , but your query only expects one parameter
p73106
aVIf some API gives you just a flat list, you can convert the flat list to a nested sequence with a list comprehension on insertion:
p73107
aVI haven't tested this with , but some database adapters also accept an iterable, so a generator expression might be more efficient:
p73108
aVbut it could be that  demands a sequence
p73109
as(dp73110
g16
V100297
p73111
stp73112
a((dp73113
g2
(lp73114
VYour  object must be mixed into your  class for the methods to be part of that class:
p73115
aVJust importing the  class is not enough
p73116
as(dp73117
g16
V100297
p73118
stp73119
a((dp73120
g2
(lp73121
VLoad 6 extra lines instead, and pass the string to :
p73122
aVwill slurp up more than just the next object in the file, and  would read only the first 7 lines, rather than read the file in 7-line blocks
p73123
aVYou can wrap reading a file in blocks of size N in a generator:
p73124
aVthen use that to chunk up your input file:
p73125
aVAlternatively, if your blocks turn out to be of variable length, read until you have something that parses:
p73126
as(dp73127
g16
V100297
p73128
stp73129
a((dp73130
g2
(lp73131
VYou can search for text in just the body text with BeautifulSoup, by converting  into a regular expression:
p73132
aVHowever, to narrow this down further to exclude navigation, footers, etc
p73133
aV, you'll need to apply some heuristics
p73134
aVEach site is different and detecting what part of the page makes up the main text is not a straightforward task
p73135
aVInstead of re-inventing that wheel, you may want to look at the Readability API instead; they've already built a large library of heuristics to parse out the 'main' part of a site for you
p73136
as(dp73137
g16
V100297
p73138
stp73139
a((dp73140
g2
(lp73141
VLeave of the :
p73142
aVotherwise you are looping over the keys of the first entry in the  list
p73143
aVAlternatively, if there is only ever one entry in that list, don't loop, but directly assign:
p73144
as(dp73145
g16
V100297
p73146
stp73147
a((dp73148
g2
(lp73149
VUse the  function to test multiple related conditions:
p73150
aVand
p73151
aVLike the nested  statements,  will short-circuit; return  as soon as any of the tests fails
p73152
aVIn addition, loop over lists directly, instead of generating a range of indices
p73153
aVIf you are using , you don't need to use  either, removing another level of indentation
p73154
aVYou can remove another level by filtering :
p73155
aVTogether, this reduces your nesting to:
p73156
aVPresumably your  statements actual use exceptions ( and , ), as a regular  would only stop the current loop
p73157
aVIf you are continuously adding further lists and nesting, you probably want use a list to hold all those nested lists, then simply add to the outer list:
p73158
aVand suddenly all the nesting has gone; instead you moved the nesting to a  list of lists
p73159
aVNote that I don't know what the outer-most loop looks like in your code, I just took an educated stab in the dark at it, but the idea should be roughly correct
p73160
as(dp73161
g16
V100297
p73162
stp73163
a((dp73164
g2
(lp73165
VYou are multiplying a string with an integer, and that always means repetition
p73166
aVPython won't ever auto-coerce a string to an integer, and  is always a list of strings
p73167
aVIf you wanted integer arithmetic, convert the  string to an integer first:
p73168
as(dp73169
g16
V100297
p73170
stp73171
a((dp73172
g2
(lp73173
VThree options:
p73174
aVYou could sum the nested lists;  takes a second argument, a starting value, set that to an empty list:
p73175
aVThis works because  is essentially implemented as a loop:
p73176
aVwhich works with list concatenation, provided the start value is a list object itself
p73177
aVwould not work, but  works just fine
p73178
aVYou could use  with , which is essentially the same as , minus the requirement to give a start value:
p73179
aVcould be replaced with  or with  if imports are to be avoided at all cost
p73180
aVAs the nested input list grows,  (in-place add, for lists the equivalent of ) will rapidly become a faster option:
p73181
aVbut this does need an empty list to start with
p73182
aVYou could chain the lists using :
p73183
aVAll three solutions require that you use indexing to remove the outermost list, although you can also pass the one element in  as a single argument to  with  as well
p73184
aVOf these options,  is the fastest:
p73185
aVand comparing  versus :
p73186
aVYou could use recursion to avoid using a loop, to make this work for arbitrarily nested lists:
p73187
aVDemo:
p73188
as(dp73189
g16
V100297
p73190
stp73191
a((dp73192
g2
(lp73193
VIf  is only ever going to be reused for all pairings, just use a list comprehension:
p73194
aVIf  is a string of characters, and you wanted to cycle through them when pairing (like  would for the shortest length sequence), use :
p73195
aVNote how the characters of the string  are reused to pair up with the numbers  and ; they'll continue to be cycled to match any length list (which must be finite)
p73196
as(dp73197
g16
V100297
p73198
stp73199
a((dp73200
g2
(lp73201
VYou can call the super-class implementation in :
p73202
aVHere  will search the class hierarchy in MRO (method resolution order), from class  onwards for the next  method, bind it to  and let you call it
p73203
aVThis will invoke the original  first, executing  and , and your overridden version can then add new operations to follow
p73204
aVYou could also call  first, then invoke the base implementation
p73205
aVYou can also look up the parent method directly on class , but that method will then be unbound
p73206
aVPass in  explicitly:
p73207
aVThis bypasses searching the class inheritance hierarchy making your class less flexible
p73208
aVSee Raymond Hettinger's blog post on  for some excellent practical advice on when to use
p73209
as(dp73210
g16
V100297
p73211
stp73212
a((dp73213
g2
(lp73214
VFirst of all, this is a bad idea
p73215
aVcontains much more than just ,  and ; the  module is also a global in your module
p73216
aVMoreover, the  mapping also holds a reference to the  object, where all the Python built-ins live, including the  function itself
p73217
aVYou don't need to pickle any of these
p73218
aVStick to pickling just what you need to persist:
p73219
aVand load again with:
p73220
aVYou tried to treat , the built-in function, as a reference to the dictionary; you'd have to call the function to get access to the mapping for pickling instead
p73221
as(dp73222
g16
V100297
p73223
stp73224
a((dp73225
g2
(lp73226
VYou are only fetching the first such a
p73227
aVUse  again to find all such spans:
p73228
aVThis produces:
p73229
aVNote that I also tell  what encoding to use, taken from the response  header; this is important for this page because without it BeautifulSoup guesses wrong
p73230
as(dp73231
g16
V100297
p73232
stp73233
a((dp73234
g2
(lp73235
V is the matched string
p73236
aVDemo:
p73237
aVYou can also omit the argument,  is the default
p73238
as(dp73239
g16
V100297
p73240
stp73241
a((dp73242
g2
(lp73243
VYou are trying to treat a string as a callable
p73244
aVIf you want to return a new instance of the class, then call the class:
p73245
aVNote that this does require that your class has a  method
p73246
aVIf you wanted to return a string you have to use string formatting instead:
p73247
as(dp73248
g16
V100297
p73249
stp73250
a((dp73251
g2
(lp73252
VYou can filter 'empty' values:
p73253
aVor you can use a list comprehension
p73254
aVOn Python 3,  returns a generator; the list comprehension returns a list on either Python 2 or 3:
p73255
aVIf your list contains more than just tuples, you could test for empty tuples explicitly:
p73256
aVPython 2 demo:
p73257
aVOf these options, the  function is fastest:
p73258
aVOn Python 3, stick to the list comprehension instead:
p73259
as(dp73260
g16
V100297
p73261
stp73262
a((dp73263
g2
(lp73264
VYour  value is larger than will fit in  hex digits, so the resulting string contains an odd number of hex digits here
p73265
aVYou'd need to handle that overflow
p73266
aVExample with just 2 hex digits and the value 256 (hex 100):
p73267
aVI am not familiar with how RSA decryption works, so I cannot say if the problem is with the calculation of  or that you should mask the value to fit the chunk size
p73268
aVTo fit the chunk size, you could mask the  value with:
p73269
aVI'd use  here instead of old-style string formatting with ; you can incorporate the width more easily:
p73270
aVEncoding to bytes is optional,  accepts strings too, at least on Python 3
p73271
ag35
as(dp73272
g16
V100297
p73273
stp73274
a((dp73275
g2
(lp73276
VI'd collect keys only for the first object, then assume that the rest of the format is consistent
p73277
aVThe following code also limits the nested object to just one; you did not specify what should happen when there is more than one
p73278
aVHaving two or more nested structures of equal length could work (you'd 'zip' those together), but if you have structures of differing length you need to make an explicit choice how to handle those; zip with empty columns to pad, or to write out the product of those entries (A x B rows, repeating information from A each time you find a B entry)
p73279
aVFor your sample input, this produces:
p73280
as(dp73281
g16
V100297
p73282
stp73283
a((dp73284
g2
(lp73285
VYour individual regular expressions can match within a column, but your joined expression won't
p73286
aVFor example, the input:
p73287
aVmatches your individual expressions, but when joined with tabs in between no longer matches the  pattern
p73288
aVAdd  as 'padding' into your expressions to allow for extra not-tab characters around the tabs:
p73289
aVDemo:
p73290
aVIf you wanted your regular expressions to validate the whole column, then either:
p73291
aVtest each column with  and anchors ( and ):
p73292
aVwhere  only returns  if all expressions matched and the anchors make sure the expression covers the whole column, not just a subset
p73293
aVor join the columns with , but do add anchors as well:
p73294
aVDemo:
p73295
as(dp73296
g16
V100297
p73297
stp73298
a((dp73299
g2
(lp73300
VGenerate indices for width - 1 by height - 1;  can do this for us
p73301
aVTest 4 coordinates for each generated index using  to only test as many as needed to disprove a square exists
p73302
aVUse  with a generator to count the number of squares found; faster than manually counting with a list or a counter
p73303
aVTogether with lambda to test for squares, this then becomes:
p73304
aVDemo:
p73305
as(dp73306
g16
V100297
p73307
stp73308
a((dp73309
g2
(lp73310
VNo, Python lists do not auto-materialize indices
p73311
aVIf you want a dynamic programming scratchboard, set up the full lists:
p73312
aVor use :
p73313
aVHere I used  loops over  instead of a  loop to range through  and
p73314
as(dp73315
g16
V100297
p73316
stp73317
a((dp73318
g2
(lp73319
VPut all items you want to print in the parenthesis of the  function call:
p73320
aVand
p73321
aVetc
p73322
aVWhere you build your strings, it'd be easier to do so in the  function
p73323
aVInstead of
p73324
aV(where you forgot to replace the last comma with ), do this:
p73325
aVand so on for the other options
p73326
as(dp73327
g16
V100297
p73328
stp73329
a((dp73330
g2
(lp73331
VOpen the file in append mode and write a new line (including a  line separator):
p73332
aVThis adds the line at the end of the file after all the other contents
p73333
as(dp73334
g16
V100297
p73335
stp73336
a((dp73337
g2
(lp73338
VA solution that loops just once:
p73339
aVhas to loop through the whole list once, and a list comprehension picking out items of matching length has to loop through the list again
p73340
aVThe above version loops through the input list just once
p73341
aVIf your input list is not a sequence but an iterator, this algorithm will still work while anything that has to use  won't; it'd have exhausted the iterator just to find the maximum length
p73342
aVTiming comparison on 100 random words between length 1 and 9, repeated 1 million times:
p73343
aVReplacing  with a cached  outside the  loop shaves off another 2 seconds:
p73344
aVAnd by popular request, a  version:
p73345
aVMore fun still, a completely different tack: sorting on length:
p73346
aVThese work by sorting by length, then picking out the first group of words with equal length
p73347
aVFor  we need to sort in reverse, then re-reverse the result
p73348
aVSorting has a O(NlogN) cost, making this less efficient than the O(2N) solutions in other answers here or my O(N) solution above:
p73349
aVStill, the sorting approach gives you a fun one-liner
p73350
as(dp73351
g16
V100297
p73352
stp73353
a((dp73354
g2
(lp73355
VYour Python 2 solution relied on old style class behaviour
p73356
aVYour Python 2 code would fail in the same manner as Python 3 were you to make your class inherit from :
p73357
aVThis is because special methods are looked up on the type, not the object itself, for new-style classes
p73358
aVThis behaviour change fixed several corner cases with the old model
p73359
aVIn practice this means that methods like  are looked up directly on  itself, not as attributes on instances of , and the  hook is not consulted
p73360
aVUnfortunately, special method lookups also bypass any  or  hooks
p73361
aVSee the documentation on Special Method lookups:
p73362
aVIn addition to bypassing any instance attributes in the interest of correctness, implicit special method lookup generally also bypasses the  method even of the object\u2019s metaclass:
p73363
ag15438
aVBypassing the  machinery in this fashion provides significant scope for speed optimisations within the interpreter, at the cost of some flexibility in the handling of special methods (the special method must be set on the class object itself in order to be consistently invoked by the interpreter)
p73364
aVYour only option then, is to set all special methods dynamically on your class
p73365
aVA class decorator would do fine here:
p73366
aVI updated the proxy function to handle multiple arguments correctly, and to auto-coerce back to your custom class if  is returned
p73367
as(dp73368
g16
V100297
p73369
stp73370
a((dp73371
g2
(lp73372
VThis means the  module is missing and failed to import
p73373
aVThe GAE SDK does not itself come with the MySQLdb client library; install MySQLdb (as instructed in the SDK documentation):
p73374
aVor use your OS package manager to install MySQLdb in your system python
p73375
aVThe error is caused by the Google  module, acting as a stub, not having a  attribute when  fails
p73376
aVA stub  function is provided that'll raise a more helpful exception, but due to an unfortunate interaction with SQLAlchemy the error there is a lot less informative
p73377
as(dp73378
g16
V100297
p73379
stp73380
a((dp73381
g2
(lp73382
VSure, it is possible
p73383
aVBut note that this depends on the precise implementation and python version
p73384
aVwill pop the first key-value pair in the dictionary hash table
p73385
aVBecause of hash collisions, reinserting the same key does not guarantee that it'll end up in the same slot again
p73386
aVThis is easily demonstrated in CPython 2
p73387
aV7, using integer keys:
p73388
aVIn CPython (for versions before 3
p73389
aV3), a small dictionary starts with just a few slots in the hash table (as a dictionary grows more space is created dynamically), and  and  happen to hash to the same slot
p73390
aVThe first time I popped an item out of the dictionary there,  was returned, but reinserting  now leaves  as the first key and it is returned instead
p73391
aV(Python 3
p73392
aV3 introduced a randomized hash seed, making hash collisions unpredictable)
p73393
aVBut of course, it is perfectly possible to end up with a key that'll be inserted and removed over and over again, if only because it is the last key in the dictionary:
p73394
aVYou just cannot easily predict this will happen
p73395
aVNote that regardless of what key is popped out next, if you keep re-inserting keys into the dictionary, your dataset doesn't shrink and you end up with an infinite loop anyway
p73396
aVIt doesn't matter if that loop processes one key each time or a repeating series of keys
p73397
aVPerhaps you were looking for a queue instead
p73398
aVThere is a helpful and efficient  double-ended queue implementation available:
p73399
aVYou still can end up with an infinite loop (if your  statement always re-inserts the same key-value pair, for example), but you at least you can guarantee that you'll first looked at all key-value pairs before you start looping
p73400
as(dp73401
g16
V100297
p73402
stp73403
a((dp73404
g2
(lp73405
VWhat you are looking for is a LRU cache; only most-recently used items are cached, limiting memory usage to balance invocation cost with memory requirements
p73406
aVAs your costly function is invoked with different values for , up to a number of return values (per unique  value) is cached, with the least-recently used cache results discarded when the cache is full
p73407
aVAs of Python 3
p73408
aV2, the standard library comes with a decorator implementation: :
p73409
aVA backport is available for earlier versions, or pick one of the other available libraries that can handle LRU caches avaible on PyPI
p73410
aVIf you only ever need to cache one most recent item, create your own decorator:
p73411
aVThis simpler decorator has less overhead than the more featureful
p73412
as(dp73413
g16
V100297
p73414
stp73415
a((dp73416
g2
(lp73417
VThe  loop will run to completion first before the  gets a chance to test
p73418
aVBreak out of the  loop instead:
p73419
aVYou can use  to generate the count:
p73420
aVLast, but not least, there is :
p73421
as(dp73422
g16
V100297
p73423
stp73424
a((dp73425
g2
(lp73426
VYou'll have to use a custom widget for this case; subclass the widget of your choice with:
p73427
aVThis translates any keyword argument starting with  to a keyword argument starting with , ensuring the right HTML attributes can be added
p73428
aVUse this as a  attribute on your field:
p73429
aVand now you can use this is your template with:
p73430
aVand the attributes will be added as  in the rendered HTML:
p73431
as(dp73432
g16
V100297
p73433
stp73434
a((dp73435
g2
(lp73436
VYou are using Python 3; use  instead
p73437
aVThe Python 2  methods have been renamed in Python 3, where  returns a dictionary view instead of a list by default now
p73438
aVDictionary views act as iterables in the same way  do in Python 2
p73439
aVFrom the Python 3 What's New documentation:
p73440
aVmethods ,  and  return \u201cviews\u201d instead of lists
p73441
aVFor example, this no longer works:
p73442
aVUse  instead (this works in Python 2
p73443
aV5 too and is just as efficient)
p73444
aVAlso, the ,  and  methods are no longer supported
p73445
aVAlso, the  method has been renamed to , but dictionary views are not iterators
p73446
aVThe line  would have to be translated instead, to:
p73447
aVwhich uses  to turn the items view into an iterable and  to get the next value from that iterable
p73448
aVYou'll also have to rename the  variable in the  loop; using that replaces the built-in  function which you need here
p73449
aVUse  instead
p73450
aVThe next problem is that you are trying to use  as a key in , but  is a tuple of an integer and a list of integers, making the whole value not hashable
p73451
aVI think you wanted to get just the next key instead, in which case  would give you that:
p73452
aVThis then produces some output:
p73453
as(dp73454
g16
V100297
p73455
stp73456
a((dp73457
g2
(lp73458
VThat is a  exception
p73459
aVYou can see this in the source of , where that same exception is caught and assigned to  to be re-raised later
p73460
as(dp73461
g16
V100297
p73462
stp73463
a((dp73464
g2
(lp73465
VBecause the line  is not part of the  function
p73466
aVThe line has not been indented at all, so Python sees it as a separate line of code following the  function, and executes it immediately when you run this script
p73467
aVIndent that line to match the  line, and don't forget to call :
p73468
as(dp73469
g16
V100297
p73470
stp73471
a((dp73472
g2
(lp73473
VYou can use the  module to analyse the code
p73474
aVproduces
p73475
as(dp73476
g16
V100297
p73477
stp73478
a((dp73479
g2
(lp73480
VYou need to use nesting order in comprehensions
p73481
aVList your loops in the same order they would be in when nesting a regular loop
p73482
aVThe  expression returns a sequence of two items, but each of those items is not a tuple of a key and a value; instead there is only ever one element being iterated over
p73483
aVWrap the split in a tuple so you have a 'sequence' of  items being yielded to assign the two results to two items:
p73484
aVThis is the equivalent of:
p73485
aVwhere the nested loop is only needed because you cannot do:
p73486
aVInstead of a dictionary comprehension, use the  constructor, since it wants two-element sequences, simplifying the whole operation:
p73487
as(dp73488
g16
V100297
p73489
stp73490
a((dp73491
g2
(lp73492
VPython 3 dictionaries only have a  method,  has been removed
p73493
aVworks just fine
p73494
aVHowever, it would be much more efficient to use  here:
p73495
aVDemo:
p73496
as(dp73497
g16
V100297
p73498
stp73499
a((dp73500
g2
(lp73501
VThis is not a database problem; you are trying to interpolate Unicode values into a byte string, triggering an implicit encoding
p73502
aVDon't use string formatting here, use SQL parameters instead:
p73503
aVHere the  tell  where to expect SQL parameters, and you pass in the parameters as a separate list to
p73504
aVDo remember to tell the database connection that you want to use UTF-8 for Unicode values:
p73505
as(dp73506
g16
V100297
p73507
stp73508
a((dp73509
g2
(lp73510
VDon't use  (which returns a list, which is never 'larger than 0'), use :
p73511
aVreturns  if there is nothing to fetch, and testing against  gives you a handy boolean value to return directly
p73512
as(dp73513
g16
V100297
p73514
stp73515
a((dp73516
g2
(lp73517
VThe first argument takes a list; just build that list dynamically:
p73518
aVAppending additional command line switches is just a question of appending more values to
p73519
as(dp73520
g16
V100297
p73521
stp73522
a((dp73523
g2
(lp73524
VYou are splitting a string of length 18 in two:
p73525
aVso the division makes perfect sense
p73526
aVEven without the newline at the end, making it length 17, would still work:
p73527
aVYou are not dividing the string in half based on the number of groups of digits here, you are splitting purely on the number of string characters
p73528
aVIf you wanted to do that, split the line first:
p73529
as(dp73530
g16
V100297
p73531
stp73532
a((dp73533
g2
(lp73534
V (Python 3) and  (Python 2) always return strings
p73535
aVConvert the result to integer explicitly with
p73536
aVPro tip: semi-colons are not needed in Python
p73537
as(dp73538
g16
V100297
p73539
stp73540
a((dp73541
g2
(lp73542
VUse the  function to pair up the lists, then a list comprehension to only keep values where the reference value does not match :
p73543
aVDemo:
p73544
aVIf you need to update  as well, return two lists:
p73545
aVDemo:
p73546
as(dp73547
g16
V100297
p73548
stp73549
a((dp73550
g2
(lp73551
VJust use a  object and treat it like a regular file; write JSON objects line by line, and read them line by line
p73552
aVThe object takes care of compression transparently, and will buffer reads, decompressing chucks as needed
p73553
aVThis has the added advantage that the compression algorithm can make use of repetition across objects for compression ratios
p73554
as(dp73555
g16
V100297
p73556
stp73557
a((dp73558
g2
(lp73559
V is not the binary data
p73560
aVThat attribute gives you the decoded text, a Unicode value
p73561
aVYou'd want to use  instead, or stream the image to a file setting  and copying from the  file object
p73562
as(dp73563
g16
V100297
p73564
stp73565
a((dp73566
g2
(lp73567
V looks for  instances in the current module
p73568
aVYour module has no such testcases; it only has a  global
p73569
aVBest practice is to run the tests themselves
p73570
aVAdd the  section there to the  file:
p73571
aVand run  instead
p73572
aVAlternatively, pass in the imported  module into
p73573
aVYou may want to move the  line down into , because you have a circular import too
p73574
aVThat is fine in your case,  doesn't use any globals from  outside of the test cases, but it is better to be explicit about this
p73575
as(dp73576
g16
V100297
p73577
stp73578
a((dp73579
g2
(lp73580
VYour function works just fine, it is returning a dictionary of parsed items
p73581
aVIf you wanted to print those items on separate lines, you need to loop through the dictionary:
p73582
aVWhat you are seeing is the dictionary string representation:
p73583
as(dp73584
g16
V100297
p73585
stp73586
a((dp73587
g2
(lp73588
VYou need to make the whole value a regular expression object:
p73589
aVIn your version, you are still looking for a literal string, not a regular expression, because you converted the regular expression object into a string instead
p73590
aVThe literal string has a very strange value:
p73591
aVThis value of course is never found in your HTML document
p73592
as(dp73593
g16
V100297
p73594
stp73595
a((dp73596
g2
(lp73597
VYou are making two mistakes:
p73598
aVYou reuse the  name in your  loop:
p73599
aVThis replaces the old value (a list) with each line in the list, in turn
p73600
aVAfter the last iteration that means  has been replaced by the last line
p73601
aVUse a different name for in the loop:
p73602
aVYou'll need to use another loop to replace text in the lines:
p73603
aVThis will obscure your words just for printing, in the iteration, and not alter the original strings contained in
p73604
as(dp73605
g16
V100297
p73606
stp73607
a((dp73608
g2
(lp73609
V is never changed, so there is no difference in creating a copy or creating a new instance
p73610
aVSo to create a new instance of  that holds new, separate instances of , just create a new instance:
p73611
aVAny variations between instances can be created directly on this new instance
p73612
aVIf creation of such an object is expensive, use caching strategies to avoid repeated calculations
p73613
as(dp73614
g16
V100297
p73615
stp73616
a((dp73617
g2
(lp73618
VDon't try to look forward when backwards will do:
p73619
aVYou need to wrap the  itself in the  iterator (with an adjusted condition); otherwise you'll be skipping a line at the start that the  reader will never see
p73620
aVThe  object holds 2 previous lines at all times, letting you peek at those lines as you go through the CSV file
p73621
aVis the previous line,  the line before that
p73622
aVIf  column 1 is in , your condition is matched
p73623
as(dp73624
g16
V100297
p73625
stp73626
a((dp73627
g2
(lp73628
VYes, functions are first-class objects, and can be passed around as arguments
p73629
aVShort demo:
p73630
aVNote how I assigned  to a new name , then called it both from  and passed it to another function, where the parameter  is called as a function
p73631
aVLambdas are just a short-form notation to create function objects
p73632
aVFrom Python's perspective, there is little difference:
p73633
aVBoth the  lambda and the preceding  function are function objects
p73634
as(dp73635
g16
V100297
p73636
stp73637
a((dp73638
g2
(lp73639
VUse  if you want to find just one match:
p73640
aVor loop over all matches:
p73641
aVThe latter part can also be expressed as:
p73642
aVwhere the  part only matches elements that have a  attribute, which means that you won't have to use  because the attribute will be there (alternatively, no  link is found and  will be )
p73643
aVFor the given URL in your question, there is only one such link, so  is probably most convenient
p73644
aVIt may even be possible to just use:
p73645
aVwith no need to find the surrounding
p73646
aVThe  attribute looks enough for your specific needs
p73647
aVAs an extra tip: make use of the response headers to tell BeautifulSoup what encoding to use for a page; the  response object can tell you what, if any, character set the server thinks the HTML page is encoded in:
p73648
aVQuick demo of all the parts:
p73649
as(dp73650
g16
V100297
p73651
stp73652
a((dp73653
g2
(lp73654
VYou forgot to some closing parenthesis on the previous line:
p73655
aVYou need to add two  characters at the end there, to close both the  and  calls:
p73656
aVThat is still wrong, however, because the  string is not convertible to an integer
p73657
aVYou probably want to invert the two calls to:
p73658
aVto turn the return value of  (the user input) into an integer
p73659
aVOther notes:
p73660
aVYou don't need to convert number literals into  and :
p73661
aVYour  function doesn't return anything
p73662
aVReturn the  from the function to use later on
p73663
aVUse a loop to keep asking for the number until you have a valid number:
p73664
aVand then at the end use:
p73665
as(dp73666
g16
V100297
p73667
stp73668
a((dp73669
g2
(lp73670
VTest it with :
p73671
aVSo floor division is only a faster by a small margin
p73672
aVNote that these values are very close, and I had to crank up the loop repeat count to iron out random influences on my machine
p73673
aVEven with such a high count, you need to repeat the experiments a few times to see how much the numbers still vary and what comes out faster most of the time
p73674
aVThis is logical, as  requires a global lookup and a function call (so state is pushed and popped):
p73675
aVIt is the  and  opcodes that are slower than the  and  opcodes;  is a simple array lookup,  needs to do a dictionary lookup instead
p73676
aVBinding  to a local name can make a small difference, giving it the edge again (as it has to do less work than  floor division):
p73677
aVAgain, you need to run this with 10 million loops to see the differences consistently
p73678
aVThat said,  is a lot more explicit and unless you are doing this in a time-critical loop,  wins it in readability over
p73679
aVThe timing differences are too small to make the cognitive cost of having to work out what  does here worthwhile
p73680
as(dp73681
g16
V100297
p73682
stp73683
a((dp73684
g2
(lp73685
VYou could use  here to extract multiple items:
p73686
aVwith multiple indices will return a tuple of values found at those indices:
p73687
aVThe limit to  makes the split more efficient as it won't have to do more work than you absolutely need
p73688
aVFor retrieving just two indices, this doesn't make much of a speed difference:
p73689
aVwhere
p73690
aV935 and
p73691
aV944 are too close to declare a winner
p73692
aVWith more indices to retrieve the single function call will win out however:
p73693
as(dp73694
g16
V100297
p73695
stp73696
a((dp73697
g2
(lp73698
VBuild a context first with , and perhaps a request object:
p73699
aVThis does require that you open a ZODB connection yourself and traverse to the site object yourself
p73700
aVHowever, it is not clear how you are accessing the Plone site from your scheduler
p73701
aVInstead of running a full new Zope process, consider calling a URL from your scheduling job
p73702
aVIf you integrated APScheduler into your Zope process, you'd have to create a new ZODB connection in the job, traverse to the Plone site from the root, and use the above method to set up the site hooks (needed for a lot of local components anyway)
p73703
as(dp73704
g16
V100297
p73705
stp73706
a((dp73707
g2
(lp73708
VYou can import a module into your namespace like you can any object:
p73709
aVso from an API perspective there is no difference between using a class with static methods, or a module here
p73710
aVThe difference is only in the writing and maintenance
p73711
aVHere, stick to modules over static class methods
p73712
aVUse classes only for when you have some actual state to share
p73713
aVIf you were to use classes to group these methods, you do create an expectation that the class objects themselves have some meaning beyond facilitating a namespace grouping
p73714
as(dp73715
g16
V100297
p73716
stp73717
a((dp73718
g2
(lp73719
VYou are running the python interpreter in interactive mode, which echos values back at you
p73720
aVExpressions are evaluated and if they return something other than , the interpreter does the equivalent of:
p73721
aVThat is the  you see printed
p73722
aVon the other hand, writes directly to your terminal output, after converting the value to a string (the result of the  function, but for a string value, there is no difference as it already is a string object)
p73723
aVThis is different from running the Python code in a script; there there is no prompt, and if you put just  on one line, the Python interpreter would just ignore that line as it doesn't alter any state
p73724
aVon the other hand still would write the string to your console or terminal
p73725
aVThe interactive mode is there to help you figure out what python expressions do, and by using  you can distinguish between different types of objects
p73726
aVTry print  and , so an integer number, and a string with the digit  in it:
p73727
aVYou cannot tell the difference between these two
p73728
aVBut their representation does differ:
p73729
aVRepresentations for most Python standard types will use a notation that can be reused in your Python code, as-is
p73730
as(dp73731
g16
V100297
p73732
stp73733
a((dp73734
g2
(lp73735
V and  start out as references to the same value as  and , not to the same memory position
p73736
aVOnce you assign new values to  and , the other two references won't follow
p73737
aVPython values are like balloons, and variable names are like labels
p73738
aVYou can tie a thread between the label (name) and the balloon (value), and you can tie multiple labels to a given balloon
p73739
aVBut assignment means you tied a new balloon to a given label
p73740
aVThe other labels are not re-tied as well, they still are tied to the original balloon
p73741
aVPython integers are immutable; they remain the same balloon throughout
p73742
aVIncrementing  by adding  with the in-place addition operator () still has to find another balloon with the result of , and tie  to the new integer result
p73743
aVIf  was tied to a balloon representing  before, it'll be replaced by a new balloon representing the value , and  will be retied to that
p73744
aVYou cannot take a marker to the integer balloon and erase the  to replace it with
p73745
as(dp73746
g16
V100297
p73747
stp73748
a((dp73749
g2
(lp73750
VYou want to transform your data from rows into columns
p73751
aVUse  for that, and the  module to read the file:
p73752
aVNo list comprehensions required
p73753
as(dp73754
g16
V100297
p73755
stp73756
a((dp73757
g2
(lp73758
VYou are looking for the request history
p73759
aVThe  attribute is a list of responses that led to the final URL, which can be found in
p73760
aVDemo:
p73761
as(dp73762
g16
V100297
p73763
stp73764
a((dp73765
g2
(lp73766
VDo use loops, anyway
p73767
aVHere is a generator to produce your output:
p73768
aVNow you can loop over the generator, or convert the output to a list:
p73769
aVDemo:
p73770
as(dp73771
g16
V100297
p73772
stp73773
a((dp73774
g2
(lp73775
VThat looks like a python unicode string literal; decode this from
p73776
aVDemo:
p73777
aVYou can either decode the data as you read it from the file (using a binary mode), or you can use  in Python 2, or regular  in Python 3 to have data decoded on the fly:
p73778
aVNote that JSON strings use the same escape syntax;  denotes a Unicode codepoint using just ASCII characters
p73779
as(dp73780
g16
V100297
p73781
stp73782
a((dp73783
g2
(lp73784
VDon't use concatenation, use SQL parameters:
p73785
aVYour code tried to concatenate a whole list with a string; you can only concatenate strings to strings
p73786
aVBut to insert multiple rows for each value, you need to run an  statement per entry in
p73787
aVUsing SQL parameters here has several advantages:
p73788
aVYou leave quoting the value up to the database, avoiding SQL injection attacks
p73789
aVThe database can reuse the query plan for the SQL statement, optimizing database performance
p73790
aVYou can use  to run the same query with different values, all with one call
p73791
aVThe  call here takes each 'row' found in the second argument, taking the values from each row to run a separate  statement
p73792
as(dp73793
g16
V100297
p73794
stp73795
a((dp73796
g2
(lp73797
VUse a list comprehension and :
p73798
aVUse  in Python 3
p73799
aVonly returns  if there are any non-empty values in the input list
p73800
aVBy using  we test the minimal number of values in the dictionary to prove there is a non-empty value among them
p73801
aVDemo:
p73802
aVIf any values other than the empty strings could be tested as false as well (such as  or ), you can use an explicit test as well:
p73803
as(dp73804
g16
V100297
p73805
stp73806
a((dp73807
g2
(lp73808
VGroup on the first item in the string:
p73809
aVDemo:
p73810
aVYou asked:
p73811
aVCan you give me an explanation in laymens term of how the formula
p73812
aVworks
p73813
aVThis all pivots around the  function;  takes each value from  and only looks at the output of that function
p73814
aVsplits the card string on whitespace and only the first element is returned, so  or , etc
p73815
aVSo  then produces groups where the first character is equal; the first element, second element, third element and fourth element of your list all have  as the first thing in their strings
p73816
aVwill be set to  (but I ignore it here), and group is an iterable producing those 4 elements; we pass that value to  to make a new string to print
p73817
aVI always picture iterables as bucket-brigades; rows of people passing along buckets of water from a river or well or pump
p73818
aVDoesn't matter where the buckets come from, you have no idea how many will still come, but all you can do is take the next bucket
p73819
aVis like someone organizing new mini bucket brigades for you giving you just a few of the buckets it handles
p73820
aVSo you ask  to group buckets by how many fishes were caught with the water
p73821
aVHe'll first give you a person that says: I only give you buckets with 2 fishes in them
p73822
aVYou keep asking for buckets, and at some point that person says: nope, out of buckets, I have no more for you
p73823
aVAnd you go back to the  arbiter, who says, here, a new person, and he'll only pass on buckets with 4 fishes
p73824
aVAnd then you talk to just the 4-fishes-bucket guy for a while
p73825
aVIn my answer,  is the well (it'll run out of water at some point),  doesn't count fishes but only looks at the first part of the string, and  is the person giving you buckets that all have the same first part of the string
p73826
aVBecause this is a bucket brigade,  has no idea what'll come next, so if there is a bunch of buckets with 2 fishes, then followed by a bunch with 3 fishes, then another bunch with just 2 fishes again, you'll get 3 different people handing you 3 different groups of buckets
p73827
aVGroups are formed when the outcome of the  (the second argument to ) changes from bucket to bucket
p73828
aVAlso, if you don't take all the buckets from the  person, then  will toss away buckets
p73829
aVEmpty them right onto the ground
p73830
aVIf you were taking a 2-fishes group of buckets, but went back to the  arbiter to ask for a new group person, the arbiter would toss out all buckets with 2 fishes in them until it found a bucket with a different number of fishes before giving you a new person to talk to
p73831
aVYou cannot then go back to the 2-fishes-group person and ask for more buckets, those buckets have all been emptied out on the street now
p73832
as(dp73833
g16
V100297
p73834
stp73835
a((dp73836
g2
(lp73837
VYou named your view  as well:
p73838
aVThis is found when you refer to  in your view, not the  instance
p73839
aVRename the view or rename the reference to the  object
p73840
aVRename your view to  for example:
p73841
as(dp73842
g16
V100297
p73843
stp73844
a((dp73845
g2
(lp73846
V is not in
p73847
aVIt is in a nested list contained inside of
p73848
aVYou'll have to search for it with a loop:
p73849
aVHere  creates a running index for us while looping over  so we can print the index where it was found
p73850
aVIf what you wanted to do was print the other value we don't need the index:
p73851
aVBut it'd be easier to use a dictionary here:
p73852
as(dp73853
g16
V100297
p73854
stp73855
a((dp73856
g2
(lp73857
VUse a list comprehension:
p73858
aVor, on Python 2, for speed, use :
p73859
aVWhen you loop over a list in Python, you don't get indexes, you get the values themselves, so  is not an integer but a string value ( in the first iteration)
p73860
aVYou'd have to use  to generate indices for you, together with the actual values:
p73861
aVor use  to only produce indices
p73862
aVBut the list comprehension and  options are better anyway
p73863
as(dp73864
g16
V100297
p73865
stp73866
a((dp73867
g2
(lp73868
VUse  to end a loop, and use  with a :
p73869
aVThe  branch of a  loop is only executed when you did not use  to end the loop
p73870
aVDemo:
p73871
as(dp73872
g16
V100297
p73873
stp73874
a((dp73875
g2
(lp73876
VYou can test for existing keys and values with :
p73877
aVFor the letters, you'll have to test against all values in the dictionary:
p73878
aVYou could combine the two:
p73879
as(dp73880
g16
V100297
p73881
stp73882
a((dp73883
g2
(lp73884
VAny  in  is seen as a formatting placeholder
p73885
aVDouble any that are not a placeholder:
p73886
aVOtherwise the  at the end of the  line is seen together with the  newline as a formatting character, hence the exception with an embedded newline
p73887
as(dp73888
g16
V100297
p73889
stp73890
a((dp73891
g2
(lp73892
VYou just give your lambda or function an explicit first argument:
p73893
aVThis fits with the Zen of Python:
p73894
aVExplicit is better than implicit
p73895
as(dp73896
g16
V100297
p73897
stp73898
a((dp73899
g2
(lp73900
VYou are redefining the class locally; that won't change the original class or affect anyone using it elsewhere
p73901
aVYou can monkeypatch the method on the class:
p73902
aVNow any code that tries to call  on instances of  anywhere in your Python interpreter will find and call your  method instead
p73903
as(dp73904
g16
V100297
p73905
stp73906
a((dp73907
g2
(lp73908
VYou could interpret the input as Python literals with :
p73909
aVThis function will accept any input that look like Python literals, such as integers, lists, dictionaries and strings:
p73910
as(dp73911
g16
V100297
p73912
stp73913
a((dp73914
g2
(lp73915
VYes, it is safe enough to remove imports that your code doesn't use in the current module, or that do not themselves have side effects
p73916
aVPython imports modules once and stores them in  for future reference; subsequent imports will re-use the already imported module object
p73917
aVModules that have side effects make use of that, but they still have to be imported that one time
p73918
aVFor 'regular' modules, all you have is an extra reference to the module object or to objects within that module
p73919
aVThat takes a modicum of extra memory (apart from the module object itself), so the cost isn't that high
p73920
aVBut you then do have to track what modules you have used, and what global names therefore can be in use in your code that could lead to bugs
p73921
as(dp73922
g16
V100297
p73923
stp73924
a((dp73925
g2
(lp73926
VLooping over a dictionary only yields the keys
p73927
aVUse  to loop over both keys and values:
p73928
aVThe  exception you see is not a dict comprehension problem, nor is it limited to Python 3; you'd see the same problem in Python 2 or with a regular  loop:
p73929
aVbecause each iteration there is only one item being yielded
p73930
aVWithout a transformation,  is just a verbose and costly ; use a dict comprehension only when you do a little more with the keys or values, or use conditions or a more complex loop construct
p73931
as(dp73932
g16
V100297
p73933
stp73934
a((dp73935
g2
(lp73936
VYou can add initialisation code to the script generated with the  entry:
p73937
aVHere we interpolated the buildout  directory to be prepended to the  environment variable
p73938
as(dp73939
g16
V100297
p73940
stp73941
a((dp73942
g2
(lp73943
VI found the exact source code you appear to be looking at
p73944
aVThat decorator is defined in the  module as:
p73945
aVso all it does is set a  attribute
p73946
aVI found a  function that then uses this attribute to skip any class that has  set to
p73947
aVAt a glance, the decorator appears to be used for any base classes; classes used by the actual test case classes
p73948
as(dp73949
g16
V100297
p73950
stp73951
a((dp73952
g2
(lp73953
VStart with under what conditions the  branch would not match
p73954
aVIt'd be one of , or , or , so you would need to use  and  here to express when the  branch of your original code would be picked:
p73955
aVYou could then bring the  into the parenthesis by applying one of De Morgan's laws, expressing the preceding test more verbosely as:
p73956
aVwhich could then be further expanded to:
p73957
aVwhich is what you yourself already expanded to
p73958
aVBut I'd find the first version to be more readable
p73959
as(dp73960
g16
V100297
p73961
stp73962
a((dp73963
g2
(lp73964
VYou would escape the quotes or use a different quoting style
p73965
aVSingle quotes would do here, for example
p73966
aVUsing single quotes:
p73967
aVUsing escaping:
p73968
aVor you can use triple quotes (one of  or ); these allow for easy multi-line strings as newlines are allowed and included in the final string value:
p73969
as(dp73970
g16
V100297
p73971
stp73972
a((dp73973
g2
(lp73974
VYour  value is not a Unicode value; you already have encoded byte string there
p73975
aVTrying to encode a byte string tells Python that it should first decode the value to Unicode before encoding again
p73976
aVThis causes your exception:
p73977
aVFor the  function, you want to use Unicode values
p73978
aVIf  contains UTF-8 data, use :
p73979
as(dp73980
g16
V100297
p73981
stp73982
a((dp73983
g2
(lp73984
VUse a negative lookbehind assertion:
p73985
aVI've included a negative lookahead as well at the end
p73986
aVNegative lookbehind and lookahead assertions only match a position in text where the text preceding or following such a position does not match a pattern
p73987
aVThis is like the  and  anchors, in that they too match specific positions, not characters themselves
p73988
aVIn the text  the start of the string as well as positions after ,  and  all match the  negative lookbehind, because at those positions the preceding character is not a digit (where there is no character at all at the start)
p73989
aVUsing these makes your pattern match only if there is no digit right before it, and no digit right after the pattern; the start and end of a string qualify here as well
p73990
aVQuick demo:
p73991
as(dp73992
g16
V100297
p73993
stp73994
a((dp73995
g2
(lp73996
VBy listening to the error message and passing only one argument to :
p73997
aVor use string formatting:
p73998
aVOnly the  function supports a variable number of arguments
p73999
as(dp74000
g16
V100297
p74001
stp74002
a((dp74003
g2
(lp74004
VNames in functions are local; reuse them as you see fit
p74005
aVIn other words, the names in one function have no relationship to names in another function
p74006
aVUse good, readable variable names and don't worry about names clashing
p74007
as(dp74008
g16
V100297
p74009
stp74010
a((dp74011
g2
(lp74012
VYou If you want to match the optional decimal value with an optional group:
p74013
aVwhere  will match a comma followed by a digit if present
p74014
aVNote that I limit the digit matching to values between 0 and 29; matching an optional  or  first, followed by
p74015
aVDemo:
p74016
as(dp74017
g16
V100297
p74018
stp74019
a((dp74020
g2
(lp74021
VYou can start by using an offset to pick out the elements; all but  need a formula applied too:
p74022
aVThis returns a consistent number of values; if calculating the square root for  is not possible, I'd return  for the total:
p74023
as(dp74024
g16
V100297
p74025
stp74026
a((dp74027
g2
(lp74028
VImplement a  special method instead:
p74029
aVNow you can just use:
p74030
aVand Python will automatically use the  special method to test for equality
p74031
aVIn my version I retained the ability to pass in a limited set of attributes:
p74032
aVbut using  to make sure we only test as much as is needed
p74033
aVNote that we return , a special singleton object to signal that the comparison is not supported; Python will ask the other object if it perhaps supports equality testing instead for that case
p74034
as(dp74035
g16
V100297
p74036
stp74037
a((dp74038
g2
(lp74039
VBest practice is to use the  library, and leave everything to that library
p74040
aVEach module uses its own logger:
p74041
aVand configure logging in the main module; you can configure one log file, or direct output from specific modules to specific files if so desired
p74042
aVBy default loggers propagate everything on to the root logger, but using separate loggers per module gives you flexibility in the future when you want to set up more complex logging configurations
p74043
aVYou can adjust formatting and direct logging to other backends as needed
p74044
aVThe formatter has a lot of options to adjust the generated message, make sure to include the logger name
p74045
aVThe configuration options for formatting, filtering and handling are almost endless
p74046
aVThe point is that how many log files you have and what goes into those files is a matter of configuration
p74047
aVAdjust the configuration as your needs change
p74048
aVStart off with something simple; log everything to one file, and progress from there
p74049
aVBy giving each module their own logging object, you can configure each logger separately, or stick to the default and leave everything to propagate to the root handler
p74050
as(dp74051
g16
V100297
p74052
stp74053
a((dp74054
g2
(lp74055
V is a tuple, not a string
p74056
aVYou want to call  on the last element here, which is a string object:
p74057
as(dp74058
g16
V100297
p74059
stp74060
a((dp74061
g2
(lp74062
VYou could use the  function:
p74063
aVor you could accept a command-line argument;  gives you a list of command-line parameters, where index  is the script name, and anything beyond that are values the user put on the command line:
p74064
aVThe Python standard library includes a  module to make handling command line interfaces more flexible and powerful
p74065
as(dp74066
g16
V100297
p74067
stp74068
a((dp74069
g2
(lp74070
VUse  to add a counter to your loop:
p74071
aVThe alternative would be to keep a manual count:
p74072
aVor use  to generate sequence of indices:
p74073
aVbut  is more concise and faster
p74074
as(dp74075
g16
V100297
p74076
stp74077
a((dp74078
g2
(lp74079
VCombining Select random k elements from a list whose elements have weights with How can I make a random selection from an inversely-weighted list
p74080
aVand applied to your dictionary:
p74081
aVI condensed Jason's Python implementation a little, and inverted your weights by using multiplication (shifting all weights up by 1 to allow for the division trick)
p74082
aVApplying this to your dictionary:
p74083
aVwhere  and  show up more often than  and
p74084
as(dp74085
g16
V100297
p74086
stp74087
a((dp74088
g2
(lp74089
VThe  result already includes the  entry
p74090
aVBy including it in  and in the  mapping,  is supplied that keyword twice
p74091
aVYou could remove it from the  call (line 31):
p74092
aVI see that the author of the package added the  line explicitly 4 years ago; I strongly suspect that the NumPy behaviour has since changed
p74093
aVYou should probably file a another issue with the project
p74094
as(dp74095
g16
V100297
p74096
stp74097
a((dp74098
g2
(lp74099
VYou could use operator chaining and test against both extremes of your range:
p74100
aVThis test matches if  is in the range  (both ends inclusive)
p74101
aVIf you wanted to see how close a value is to something else, you could use :
p74102
aVA whole series of such tests are going to be tedious; you can print messages based on how close they are with a sequence of tests:
p74103
as(dp74104
g16
V100297
p74105
stp74106
a((dp74107
g2
(lp74108
VYou indented the  line too far, now your decorator returns a  value
p74109
aVUnindent the last line:
p74110
aVThe exception points to the  line because the next decorator,  throws the exception as it is applied to the output of
p74111
aVThe  exception is thrown explicitly because the route decorator was passed a  value for the function
p74112
as(dp74113
g16
V100297
p74114
stp74115
a((dp74116
g2
(lp74117
VYou are trying to use the string stored in  as a function
p74118
aVWith nothing but spaces between  and the parenthesis around , Python sees that as a function call
p74119
aVYou probably wanted to test if it was equal to  instead:
p74120
as(dp74121
g16
V100297
p74122
stp74123
a((dp74124
g2
(lp74125
VThis is not a problem you should solve with a list comprehension
p74126
aVYou can improve on your existing code using some set operations:
p74127
aVThis'll achieve the same effect; add keys from  that are missing, as empty strings
p74128
aVFor Python 3, replace  with
p74129
aVThis makes use of dictionary view objects to give us a set-like views on the dictionary keys; in Python 3 this behaviour is now the default
p74130
aVIf I read your question wrong and  is not a dictionary as well, make it an explicit set to get the same benefits:
p74131
aVUsing set operations makes the code more readable and efficient, pushing any loops to determine the set difference into optimized C routines
p74132
as(dp74133
g16
V100297
p74134
stp74135
a((dp74136
g2
(lp74137
VYou'll need to test against every element in ; using membership on lists requires that the whole string is present in the list
p74138
aVHere the  function, combined with a generator expression, at least stops searching as soon as a match has been found
p74139
as(dp74140
g16
V100297
p74141
stp74142
a((dp74143
g2
(lp74144
VUse equality and item access; negative indices give you items counting from the end:
p74145
aVThis expression is  when the last item in  and the value referenced by   are equal
p74146
aVDemo:
p74147
aVIf  could be in the list more than once and you only want  if it is the very last item in the list, and doesn't occur anywhere else, then test for that explicitly:
p74148
aVThis works because if there is more than one occurrence of  in , the  method would find a lower index than
p74149
aVThe expression strikes a balance between performance and the requirement to scan for other occurrences; there is no need to scan the whole list if the  test failed
p74150
as(dp74151
g16
V100297
p74152
stp74153
a((dp74154
g2
(lp74155
VThe expression  never worked in Python, not in the way you think it works
p74156
aVThat expresion catches two types of exception;  or whatever the global  refers to
p74157
aVYour code breaks when there is no global name
p74158
aVThe correct expression for Python 3 and Python 2
p74159
aV6 and newer is:
p74160
aVPython 2 also supports the syntax:
p74161
aVwithout parenthesis, or:
p74162
aVto catch more than one type
p74163
aVThe syntax was very confusing, as you yourself discovered here
p74164
aVThe change was added in Python 2
p74165
aV6 and up, see PEP 3110 - Catching Exceptions in Python 3000 and the Exception-handling changes section of the 2
p74166
aV6 What's New document
p74167
aVAs for an exception for ; you didn't import , so that is a  as well
p74168
as(dp74169
g16
V100297
p74170
stp74171
a((dp74172
g2
(lp74173
VYou are trying to insert Unicode values into a  column, which can only handle encoded byte strings
p74174
aVcx_Oracle is trying to encode your Unicode values for you to fit the column type, and does so with the default codec for your connection
p74175
aVEither encode your values to a suitable encoding manually or make your columns use  instead
p74176
aVThe latter has the added advantage that column lengths are expressed in characters, not bytes; UTF-8 data can use up to 4 bytes per character, so a  column could, in a worst-case scenario, fit only 250 actual characters
p74177
as(dp74178
g16
V100297
p74179
stp74180
a((dp74181
g2
(lp74182
VThat's how most databases work; sequences only ever produce new values and not reuse old values
p74183
aVThis is both more efficient (not having to search for free ids) and a good idea
p74184
aVImagine a system that integrates multiple parts, including your database
p74185
aVThen the User ID you just deleted could still be referenced in other systems as well
p74186
aVIf your database would reuse the ID when creating a new user, suddenly those external systems are referring to a new user, leading to hard-to-untangle bugs
p74187
aVIf you must reuse numbers, then you'll have to specify an id to use explicitly instead of having the database pick one for you
p74188
aVYou'll have to find your own 'missing' numbers in that case, which will be difficult if you are using the database from more than one thread or process
p74189
aVAlso see the SQLite auto-incrementation documentation for some more detail on how you can influence how new values are picked; you either get monotonically increasing numbers (which can produce gaps) or, if you add the  keyword, a value to be guaranteed to be 'highest value ever used plus 1'
p74190
aVNote that the default behaviour is to automatically generate a  that is 1 higher than the values currently in use:
p74191
aVIf no  is specified on the insert, or if the specified  has a value of , then an appropriate  is created automatically
p74192
aVThe usual algorithm is to give the newly created row a  that is one larger than the largest  in the table prior to the insert
p74193
aVThe normal  selection algorithm described above will generate monotonically increasing unique  as long as you never use the maximum ROWID value and you never delete the entry in the table with the largest
p74194
aVIf you ever delete rows or if you ever create a row with the maximum possible , then  from previously deleted rows might be reused when creating new rows and newly created s might not be in strictly ascending order
p74195
aVEmphasis mine
p74196
as(dp74197
g16
V100297
p74198
stp74199
a((dp74200
g2
(lp74201
VYou need to seek back to the start if you want to read the same data back again:
p74202
aVFile objects are linear, like a tape, and have a 'current position'
p74203
aVWhen you write to a file, the current position moves along, so that new writes take place at that position, moving the position onwards again
p74204
aVThe same applies to reading
p74205
aVSo, after writing, the file position is right at the end of the file
p74206
aVTrying to read without moving the file position means no more data will be found
p74207
aVmoves the current file position elsewhere;  moves it back to the start of the file
p74208
as(dp74209
g16
V100297
p74210
stp74211
a((dp74212
g2
(lp74213
VString conversions using backticks are a shorthand notation for calling  on a value
p74214
aVFor integers, the resulting output of  and  happens to be the same, but it is not the same operation:
p74215
aVThe backticks syntax was removed from Python 3; I wouldn't use it, an an explicit  or  call is far clearer in its intent
p74216
aVNote that you have more options to convert integers to strings; you can use  or old style string formatting operations to interpolate an integer into a larger string:
p74217
aVwhich is much more powerful than using string concatenation
p74218
as(dp74219
g16
V100297
p74220
stp74221
a((dp74222
g2
(lp74223
VYou cannot use a context manager to 'skip' code blocks, that is what conditional are for
p74224
aVAll a context manager can do is hook in to the block enter and exit signals, not control if the block is entered in the first place
p74225
aVI'd use:
p74226
aVThis has the advantage of being readable and simple
p74227
aVAny shenanigans with generators or context managers would increase the surprise for new maintainers of your code
p74228
aVAnd remember: you are a new maintainer after a year or two away from a codebase too
p74229
as(dp74230
g16
V100297
p74231
stp74232
a((dp74233
g2
(lp74234
VPython methods have one extra argument,
p74235
aVThe  method takes  plus five other arguments
p74236
aVYou are passing in six, plus the bound method first argument  makes seven
p74237
aVNote that the exception occurs for the  method, not for your custom  method (which does take 7 arguments); note the difference in the method names here
p74238
aVJudging by the unaltered project documentation, you altered  as well, it normally takes only 4 arguments (not counting )
p74239
as(dp74240
g16
V100297
p74241
stp74242
a((dp74243
g2
(lp74244
VYou are using , which returns filenames without a path
p74245
aVYou'll need to add the path to these:
p74246
aVotherwise python will try and look for  in the current directory, and not in the  sub-directory where the files really are located
p74247
as(dp74248
g16
V100297
p74249
stp74250
a((dp74251
g2
(lp74252
VYou already read the network data; you cannot read it twice
p74253
aVAnd you are rebinding  to the network-read data, replacing the module reference
p74254
aVDon't use  for that reference
p74255
aVRemove the  statement, use  for the string reference and it'll work
p74256
aVWorking code:
p74257
aVwhere we also make use of any  parameter on the response to ensure we use the right codec to decode the response data
p74258
aVFor the  url above, this produces:
p74259
as(dp74260
g16
V100297
p74261
stp74262
a((dp74263
g2
(lp74264
V is only assigned to in a loop:
p74265
aVIf  is empty or contains more than 128 items, the assignment line is never reached, and  remains unbound
p74266
aVAssign something to  outside of that loop if you want to guarantee it is bound
p74267
aVGlancing over that code, you probably do not want to create a new, empty  for each  entry either
p74268
as(dp74269
g16
V100297
p74270
stp74271
a((dp74272
g2
(lp74273
VEither  or  would do this job for you, better, faster and more robustly:
p74274
aVUse one or the other depending on how much you need to support keys appearing multiple times in the query string
p74275
aVBut you really wanted to do this yourself with a dict comprehension, you need to nest the  call into a tuple:
p74276
aVbut the same parse is just easier without a dict comprehension; using a generator expression instead to produce a sequence of key-value pairs for the  factory instead:
p74277
aVDemo:
p74278
as(dp74279
g16
V100297
p74280
stp74281
a((dp74282
g2
(lp74283
VYour last example doesn't work because it does not start with either  or
p74284
aVIf that is optional you need to mark it as such:
p74285
aVNote that neither does your second example match; it doesn't start with  or  either
p74286
aVDemo:
p74287
as(dp74288
g16
V100297
p74289
stp74290
a((dp74291
g2
(lp74292
VInstead of returning immediately, collect your responses in a list, then return that list at the end:
p74293
as(dp74294
g16
V100297
p74295
stp74296
a((dp74297
g2
(lp74298
VPython has the  module to convert bytes back to  values:
p74299
aVHere  signifies that a double value is expected (in native endianess, as 8 bytes)
p74300
aVSee the module documentation for more options, including specifying endianess
p74301
aVAnother option is to turn your  value into an  object; you'd use this is if you had a homogenous sequence of doubles:
p74302
aVwhere every 8 bytes is interpreted as a double value, making  a sequence of doubles, addressable by index
p74303
aVTo support a different endianess, you can swap the byte order with
p74304
as(dp74305
g16
V100297
p74306
stp74307
a((dp74308
g2
(lp74309
VYou are passing in a single string as second parameter to the  call; strings are sequences too, with a length equal to the number of characters in the string
p74310
aVYou want to make it a tuple instead, and you tried to, but forgot a comma:
p74311
aVshould be
p74312
aV(and similar errors in several places)
p74313
aVNext, your queries actually take two parameters; you must pass in a value for the  part of your queries as well
p74314
aVSee your first query, for example:
p74315
aVHere you take a type and a name, but only pass in a value for the type:
p74316
aVYou need to add in a value for the name parameter too:
p74317
aVwhere  should be added as a parameter to your functions, and you should pass in  as an argument to your  function; don't use globals here:
p74318
aVI've moved out question to do anything else out to the menu, using a loop instead of recursion
p74319
as(dp74320
g16
V100297
p74321
stp74322
a((dp74323
g2
(lp74324
VNo, there is no syntax to import nested items as local names like that
p74325
aVYou could import the different modules, then assign to local names:
p74326
aVbut that's no more readable or concise
p74327
as(dp74328
g16
V100297
p74329
stp74330
a((dp74331
g2
(lp74332
V against a generator expression will make use of the  method and iterate the expression until a match is found, making it more efficient in the general case than the list comprehension, which produces the whole list first before scanning the result for a match
p74333
aVThe alternative for your specific example would be to use , to make the test more explicit
p74334
aVI find this to be a tad more readable:
p74335
aVYou do have to take into account that  does forward the generator; you cannot use this method if you need to use the generator elsewhere as well
p74336
aVAs for your specific timing tests; your 'short' tests are fatally flawed
p74337
aVThe first iteration the  generator will be entirely exhausted, making the other 9999 iterations test against an empty generator
p74338
aVYou are testing the difference between creating an empty list and an empty generator there, amplifying the creation cost difference
p74339
aVMoreover, you should use the  module to run tests, making sure that the test is repeatable
p74340
aVThis means you have to create a new  object each iteration too; now the contrast is much larger:
p74341
aVand on Python 3:
p74342
aVIn all cases, the generator variant is far faster; you have to shorten the 'short' version to just 8 tuples for the list comprehension to start to win:
p74343
aVOn Python 3, where the implementations of generator expressions and list comprehensions were brought closer, you have to go down to 4 items before the list comprehension wins:
p74344
as(dp74345
g16
V100297
p74346
stp74347
a((dp74348
g2
(lp74349
VUse  to turn those strings into Python lists:
p74350
aVDemo:
p74351
aVYou might want to use the file object as a context manager, to have Python close it again explicitly:
p74352
aVThis uses the file object as an iterator as well, the loop will be given one line at a time from the file
p74353
as(dp74354
g16
V100297
p74355
stp74356
a((dp74357
g2
(lp74358
VYou were almost there; you want to loop over the dictionary values:
p74359
aVAlternatively, when looping of the items of a dictionary, make use of the fact that each item is a tuple with :
p74360
aVSo, yes, you can store instances in dictionaries (most of python makes use of this fact)
p74361
aVNote that getters and setters are not really needed in Python; you can simplify your code :
p74362
aVand then use:
p74363
ag7233
ag1298
aVaccess the  attribute directly
p74364
as(dp74365
g16
V100297
p74366
stp74367
a((dp74368
g2
(lp74369
VYour format looks like a fixed-column format, where each column is of a fixed width
p74370
aVIf so, use slicing instead:
p74371
aVto slice off the first 4 characters
p74372
aVAlternatively, split on whitespace once, with the  argument to :
p74373
aVskips whitespace at the start of the string and splits on the first sequence of whitespace characters after the first column
p74374
aVtakes the last element; even if there is no more than one column on the line you'll get a result
p74375
aVDemo:
p74376
as(dp74377
g16
V100297
p74378
stp74379
a((dp74380
g2
(lp74381
VThe simplest way would be to add a keyword argument to your recursive function, and returning the resulting sigma:
p74382
aVThis at least makes  'local' to the recursive call
p74383
aVA better approach is to make a class:
p74384
aVand use it like:
p74385
as(dp74386
g16
V100297
p74387
stp74388
a((dp74389
g2
(lp74390
VAlways use  as SQL parameter placeholders, and don't apply quoting yourself:
p74391
aVSQL parameter placeholders are not the same thing as Python string formatting placeholders; they happen to use similar syntax
p74392
aVYou also need to build up your items per row, not per column:
p74393
aVor using a list comprehension:
p74394
as(dp74395
g16
V100297
p74396
stp74397
a((dp74398
g2
(lp74399
VYou are listing each file, removing the extension, then trying to move that filename
p74400
aVThe extension is part of the filename, don't remove it
p74401
aVWindows Exlorer hides the extension only when displaying files
p74402
aVYou also don't need to call  on the filename; just skip that step:
p74403
as(dp74404
g16
V100297
p74405
stp74406
a((dp74407
g2
(lp74408
VTest if the file exists:
p74409
as(dp74410
g16
V100297
p74411
stp74412
a((dp74413
g2
(lp74414
VThere is no more idiomatic method to get the current module object from  than what you used
p74415
aVis set by Python on import, essentially doing:
p74416
aVso the  reference is exactly what you want to use here
p74417
as(dp74418
g16
V100297
p74419
stp74420
a((dp74421
g2
(lp74422
VDon't use ; use  here:
p74423
aVevaluates the input as a Python expression
p74424
aVIf you typed  at the prompt, Python tries to look that up as a variable name
p74425
aVgives you just a string, nothing else
p74426
as(dp74427
g16
V100297
p74428
stp74429
a((dp74430
g2
(lp74431
VYou need to remove the  and  parts here, and use  for back references
p74432
aVUsing raw strings makes this workable:
p74433
aVThese replacements are 'global' by default (what the  flag does); add a integer count as a 4th argument if you need to limit this:
p74434
as(dp74435
g16
V100297
p74436
stp74437
a((dp74438
g2
(lp74439
VYou are passing in  for the first parameter; don't do this
p74440
aVRemove  from the argument list and your call will work:
p74441
aVgives you a bound method,  is already being passed in for you (it is taken from the second argument to )
p74442
aVSince  is the first positional parameter in the  method signature (after ), Python is applying your surplus  argument to the  parameter, and then finds an explicit  argument as well
p74443
as(dp74444
g16
V100297
p74445
stp74446
a((dp74447
g2
(lp74448
VYou have one open parenthesis too many on this line:
p74449
aVRemove one at the start:
p74450
aVotherwise Python won't know until the next line that something is missing
p74451
aVYou make the same mistake another two times:
p74452
aVand
p74453
aVThe next problem is that you are trying to use the same name for both a  function and a local variable:
p74454
aVThis won't work; Python now sees the string result from  when referencing
p74455
aVGive the result from the  function a different name:
p74456
aVAgain, this applies to the other two functions as well
p74457
aVNext problem is when you are asking if the user wants to move forward some more:
p74458
aVYou are comparing against the global  variable there, not the string
p74459
aVYou probably don't want to use recursion here either; better make that a loop:
p74460
as(dp74461
g16
V100297
p74462
stp74463
a((dp74464
g2
(lp74465
VPython directly supports what you want to do:
p74466
aVAny module with that line at the top will treat the  statement as a function instead, making the code compatible with both Python 2 and 3
p74467
aVThis applies just to the  statement; you cannot override other statements
p74468
aVThis does mean you then have to use  as a function everywhere in that module, but you can then also provide your own implementation if you so desire:
p74469
aVAnother option is to use a context manager to capture printed statements, directing the output away from  into a in-memory file object of your choosing:
p74470
aVand wrap any blocks that you want to capture  output for with the context manager
p74471
aVHere is an example prefixing printed lines:
p74472
aVor even provide a wrapper:
p74473
aVand use as:
p74474
aVbut take into account that  statements usually write data to  in separate chunks; the newline at the end is a separate write
p74475
as(dp74476
g16
V100297
p74477
stp74478
a((dp74479
g2
(lp74480
VYou cannot use  within a decorated class in this way
p74481
aVis looked up as a global, and the global  is rebound to , so you are telling Python to look in the class MRO for  starting from  which is , which calls , looking up  as a global, which is bound to , etc
p74482
aVThe easiest work-around is to not use  here:
p74483
aVThis is one of the reasons why in Python 3 the argument-less version of  was introduced, giving methods a  cell instead
p74484
aVYou could jump through some (very tricky) hoops to re-compile the   method to give it a  closure bound to the original undecorated class object instead, but for a unittest, I would not bother
p74485
as(dp74486
g16
V100297
p74487
stp74488
a((dp74489
g2
(lp74490
VPick a random index from the list (minus 1)
p74491
aVNow you can print  and test if the player guessed right by comparing to :
p74492
aVIf you want to pick names one by one, randomly, then you need to create a shuffled list of indices:
p74493
aVThis creates a list of integers that can index all but the last name, and uses  to give you that list in a random order; no index will be picked twice this way
p74494
as(dp74495
g16
V100297
p74496
stp74497
a((dp74498
g2
(lp74499
VThis is a RDBMS-specific feature, not something SQLAlchemy needs to concern itself with
p74500
aVUsually databases will use monotonically incrementing ids (new values being higher than preceding values, usually by +1 but larger steps are possible)
p74501
aVThe only real exception here is SQLite; it will give you the highest currently used value plus one
p74502
aVThat means that if you delete  from a table, then that id is likely to be reused for a future row insertion
p74503
aVSee the SQLite autoincrement documentation
p74504
aVNote that the behaviour you claim in your post does not actually ever happen; either  is picked, or  is used instead
p74505
aVYou can switch to proper auto-incrementation (where values are never reused) by setting  for a table
p74506
aVSee the specific dialect documentation
p74507
aVIf you are planning to use Oracle as a backend, you also need to explicitly add a  to a column that needs to auto-increment
p74508
as(dp74509
g16
V100297
p74510
stp74511
a((dp74512
g2
(lp74513
VYou need to add the foreign key to the  table instead; for a one-to-many relationship it is the 'many' side that records the foreign key
p74514
aVIf you wanted listings to be handled by multiple agents (in a many-to-many relationship), you'll have to add a linking table:
p74515
as(dp74516
g16
V100297
p74517
stp74518
a((dp74519
g2
(lp74520
VBy assigning  to , you did not create a copy of the list
p74521
aVYou merely created another reference to the same list object
p74522
aVIf you wanted  to be a copy of the list, you need to create such a copy explicitly:
p74523
aVor
p74524
as(dp74525
g16
V100297
p74526
stp74527
a.